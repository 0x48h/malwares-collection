<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Dover.Worm.Code - WORM.H.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">/* Magic numbers the program uses to identify other copies of itself. */</span><span class="sc0">

</span><span class="sc9">#define REPORT_PORT 0x2c5d
#define MAGIC_1 0x00148898
#define MAGIC_2 0x00874697
</span><span class="sc16">extern</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">pleasequit</span><span class="sc10">;</span><span class="sc0">      </span><span class="sc1">/* This stops the program after one
                 * complete pass if set.  It is incremented
                 * inside of checkother if contact with another
                 * happens. */</span><span class="sc0">

</span><span class="sc1">/* There are pieces of "stub" code, presumably from something like this to
   get rid of error messages */</span><span class="sc0">
</span><span class="sc9">#define error()
</span><span class="sc0">
</span><span class="sc1">/* This appears to be a structure unique to this program.  It doesn't seem that
 * the blank slots are really an array of characters for the hostname, but
 * maybe they are.
 */</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hst</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">hostname</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">l4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">l8</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">l12</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">l16</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">l20</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">l24</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">o28</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">o32</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">o36</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">o40</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">o44</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">o48</span><span class="sc10">[</span><span class="sc4">6</span><span class="sc10">];</span><span class="sc0">                 </span><span class="sc1">/* used */</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">flag</span><span class="sc10">;</span><span class="sc0">                   </span><span class="sc1">/* used */</span><span class="sc0">
</span><span class="sc9">#define HST_HOSTEQUIV   8
#define HST_HOSTFOUR    4
#define HST_HOSTTWO 2
</span><span class="sc0">    </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hst</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">next</span><span class="sc10">;</span><span class="sc0">               </span><span class="sc1">/* o76 */</span><span class="sc0">
</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">name</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">size</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">buf</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc11">object</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">extern</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">ifses</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">if_l0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">if_l4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">if_l8</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">if_l12</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc1">/* unused */</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">if_l16</span><span class="sc10">;</span><span class="sc0">         </span><span class="sc1">/* used */</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">if_l20</span><span class="sc10">;</span><span class="sc0">         </span><span class="sc1">/* unused */</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">if_l24</span><span class="sc10">;</span><span class="sc0">         </span><span class="sc1">/* used */</span><span class="sc0">
    </span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">if_l28</span><span class="sc10">;</span><span class="sc0">       </span><span class="sc1">/* unused */</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc11">ifs</span><span class="sc10">[];</span><span class="sc0">
</span><span class="sc16">extern</span><span class="sc0"> </span><span class="sc11">nifs</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">extern</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">ngateways</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">extern</span><span class="sc0"> </span><span class="sc11">object</span><span class="sc0"> </span><span class="sc11">objects</span><span class="sc10">[],</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">getobjectbyname</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">extern</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nobjects</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc1">/* Only used for a2in().  Why?  I don't know. */</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">bar</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">baz</span><span class="sc10">;};</span><span class="sc0">
</span><span class="sc16">extern</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">bar</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">a2in</span><span class="sc10">();</span><span class="sc0">

</span></div></body>
</html>
