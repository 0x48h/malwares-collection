	<h1 cEmail-Worm.Win32.MTX - Description.html</h1>
	
<span klmark="virus:22667">

<p>

<table class="enc_ttl" border="0" cellpadding="3" cellspacing="0" width="100%"><tbody><tr><td klmark="loc_msg:vir_aliases"><b>Aliases</b></td></tr></tbody></table>
<b>Email-Worm.Win32.MTX</b>&nbsp;(<a klmark="loc_msg:kl_url" href="http://www.kaspersky.com/">Kaspersky Lab</a>)
is also known as:
I-Worm.MTX&nbsp;(<a href="http://www.kaspersky.com/" target="_blank">Kaspersky Lab</a>),
W95/MTX.gen@M&nbsp;(<a href="http://www.mcafee.com/" target="_blank">McAfee</a>),&nbsp;&nbsp; W95.MTX&nbsp;(<a href="http://www.symantec.com/" target="_blank">Symantec</a>),&nbsp;&nbsp; Win95.Matrix.9245&nbsp;(<a href="http://www.drweb.com/" target="_blank">Doctor&nbsp;Web</a>),&nbsp;&nbsp; W32/Apology-B&nbsp;(<a href="http://www.sophos.com/" target="_blank">Sophos</a>),&nbsp;&nbsp; Win32/MTX.A@m&nbsp;(<a href="http://www.ravantivirus.com/" target="_blank">RAV</a>),&nbsp;&nbsp; PE_Mtx.A&nbsp;(<a href="http://www.trendmicro.com/" target="_blank">Trend&nbsp;Micro</a>),&nbsp;&nbsp; W95/MTX&nbsp;(<a href="http://www.antivir.de/" target="_blank">H+BEDV</a>),&nbsp;&nbsp; W32/MTX.9244.A&nbsp;(<a href="http://www.f-prot.com/" target="_blank">FRISK</a>),&nbsp;&nbsp; Win32:MTX-B&nbsp;(<a href="http://www.avast.com/" target="_blank">ALWIL</a>),&nbsp;&nbsp; I-Worm/MTX.E&nbsp;(<a href="http://www.grisoft.com/" target="_blank">Grisoft</a>),&nbsp;&nbsp; I-Worm.MTX&nbsp;(<a href="http://www.bitdefender.com/" target="_blank">SOFTWIN</a>),&nbsp;&nbsp; Trojan.IWorm.MTX&nbsp;(<a href="http://www.clamav.net/" target="_blank">ClamAV</a>),&nbsp;&nbsp; W32/MTX&nbsp;(<a href="http://www.pandasoftware.com/" target="_blank">Panda</a>),&nbsp;&nbsp; Win32/MTX.A&nbsp;(<a href="http://www.nod32.com/" target="_blank">Eset</a>)


<table class="enc_tbl" border="0" cellpadding="3" cellspacing="0" width="100%">
<tbody><tr>
<td class="enc_row_1" nowrap="nowrap"><b>Description added</b></td>
<td class="enc_row_2" width="80%">Jan 18 2002</td>
</tr>


<tr>
<td class="enc_row_1" klmark="loc_msg:vir_fields" nowrap="nowrap"><b>Behavior</b></td>
<td class="enc_row_2" width="80%"><a href="virusesdescribed?chapter=152540408#email">Email Worm</a></td>
</tr>
</tbody></table>

<table class="enc_ttl" border="0" cellpadding="3" cellspacing="0" width="100%"><tbody><tr><td klmark="virus_doctype:1"><b><a name="doc1">Technical details</a></b></td></tr></tbody></table>
</p><p>This is a virus-worm spreading under Win32 systems. The virus infects Win32
executable files, attempts to send e-mail messages with infected attached files,
as well as installs a backdoor component to download and spawn "plugins" on
an affected system. The worm caused a global epidemic from September--October
2000.
</p>

<p>The virus has an unusual structure. It consists of three different components
that are run as stand-alone programs (Virus, e-mail Worm and Backdoor). The
virus is the main component, and it keeps the worm and backdoor programs in
its code in compressed form. While infecting the system, the virus extracts
and spawns them:</p>

<h4>  Virus structure</h4>
  
<pre>ã===============-
 ƒ The virus     ƒ --&gt; installs Worm and Backdoor to the system,
 ƒ installation  ƒ     then finds and infects Win32 executable files
 ƒ and infection ƒ
 ƒ routines      ƒ
 ƒ---------------ƒ
 ƒ Worm code     ƒ --&gt; is extracted to file and run as stand-alone program
 ƒ (compressed)  ƒ
 ƒ---------------ƒ
 ƒ Backdoor code ƒ --&gt; is extracted to file and run as stand-alone program
 ƒ (compresses)  ƒ
 L===============-

</pre>

<h4>Infected EXE file</h4>
  
<pre> ã===============-
 ƒ File code     ƒ
 ƒ and data      ƒ
 ƒ               ƒ
 ƒ===============ƒ
 ƒ Virus code:   ƒ
 ƒ---------------ƒ
 ƒƒ Installationƒƒ
 ƒƒand infectionƒƒ
 ƒ+-------------+ƒ
 ƒƒ Worm        ƒƒ
 ƒ+-------------+ƒ
 ƒƒ Backdoor    ƒƒ
 ƒL--------------ƒ
 L===============-
</pre>
 

<p>The worm code does not contain all the necessary routines to infect the system,
being sent as attach in an infected e-mail message (see below). The worm needs"help"
from the virus component, and is sent as being infected by the virus (the worm
file is infected by the virus as an ordinary file and then sent). The reason
for such a method is unclear, but probably the components were written by different
people.</p>

<p>The Virus component contains the text strings:</p>

<blockquote>
 SABIÁ.b ViRuS<br>

 Software provide by [MATRiX] VX TeAm: Ultras, Mort, Nbk, LOrd DArk, Del_Armg0,
Anaktos<br>
 Greetz: All VX guy in #virus and Vecna for help us<br>
 Visit us at:<br>
 http://www.coderz.net/matrix
</blockquote>

<p>The worm component contains the text strings:</p>

<blockquote>

 Software provide by [MATRiX] VX team:<br>
 Ultras, Mort, Nbk, LOrd DArk, Del_Armg0, Anaktos<br>
 Greetz:<br>
 All VX guy on #virus channel and Vecna<br>
 Visit us: www.coderz.net/matrix
</blockquote>

<p>The Backdoor contains the text:</p>

<blockquote>
 Software provide by [MATRiX] team:<br>
 Ultras, Mort, Nbk, LOrd DArk, Del_Armg0, Anaktos<br>
 Greetz:<br>
 Vecna 4 source codes and ideas
</blockquote>

<h4>The Virus Component</h4>

 
<p>The virus uses "Entry Point Obscuring" technology while infecting a file.
That means the virus does not affect the file at its entry code, but places
a "Jump Virus" instruction somewhere in the middle of the file code section
to make detection and disinfection procedures more complex. As a result, the
virus is activated only in case a corresponding affected program's branch receives
control.</p>

<p>The virus is also encrypted, so first of all, it decrypts itself when its
code gains control. The virus then looks for the necessary Win32 API functions
by scanning the Win32 kernel.  To do this, the virus tries the Win9x, WinNT
and Win2000 addresses.</p>

<p>The virus then looks for anti-virus programs active in the system and exits
in case any of them are detected. The list of anti-virus programs the virus
pays attention to appears as follows:</p>

<blockquote>
 AntiViral Toolkit Pro<br>
 AVP Monitor<br>

 Vsstat<br>
 Webscanx<br>
 Avconsol<br>
 McAfee VirusScan<br>
 Vshwin32<br>
 Central do McAfee VirusScan

</blockquote>

<p>Next, the virus installs its components to the system. They are decompressed
installed to the Windows directory and then spawned. There are three files created,
and they have a hidden attribute set and the following names:</p>

<blockquote>
 IE_PACK.EXE   - pure Worm code<br>
 WIN32.DLL     - Worm code infected by the virus (as "Infected File" above)<br>
MTX_.EXE      - Backdoor code
</blockquote>

<p>The virus then infects Win32 executable PE EXE files in current, temporary,
and Windows directories, and then exits.</p>

<h4> Worm</h4>

<p>To send infected messages, the worm uses technology that for the first time
was found in the <a href="http://www.viruslist.com/eng/viruslist.asp?id=3888&amp;key=00001000130000100005">"Happy"</a>
Internet worm (a.k.a. Happy99, a.k.a. SKA).</p>

<p>The worm affects the WSOCK32.DLL file in the Windows system directory by appending
a component of its code to the end of the file and hooking the "send" WSOCK32.DLL
routine. As a result, the worm then monitors all data that are sent from an
affected computer to the Internet.</p>

<p>Usually the WSOCK32.DLL file is in use at the moment the worm starts, and
it is locked for writing. To avoid this, the worm uses a standard method: it
creates a copy of the original WSOCK32.DLL with a WSOCK32.MTX name, affects
that copy and then writes "replace original file with infected" to the WININIT.INI
file:</p>

<blockquote>
 NUL=C:\WINDOWS\SYSTEM\WSOCK32.DLL<br>
 C:\WINDOWS\SYSTEM\WSOCK32.DLL=D:\WINDOWS\SYSTEM\WSOCK32.MTX
</blockquote>

<p>where "C:\WINDOWS\SYSTEM" is the name of the Windows system directory and
may differ depending on the name of the Windows directory installed.</p>

<p>Upon the next reboot, the infected WSOCK32 replaces the original one, and
the worm gains access to data that are sent from the infected machine. The worm
pays attention to Internet sites (Web, ftp) that are visited as well as to e-mail
messages that are sent from a computer.</p>

<p>The very visible behavior of the virus is due to the fact that it prevents
the ability of visiting several Internet sites, as well as disables sending
messages to the same domains (they are anti-virus domain names). The virus detects
them by four-letter combinations that appear as follows:</p>

<blockquote>
 nii.<br>
 nai.<br>
 avp.<br>
 f-se<br>
 mapl<br>
 pand<br>

 soph<br>
 ndmi<br>
 afee<br>
 yenn<br>
 lywa<br>
 tbav<br>

 yman
</blockquote>

<p>The worm also does not allow sending e-mail messages to these domains:</p>

<blockquote>
 wildlist.o*<br>
 il.esafe.c*<br>
 perfectsup*<br>

 complex.is*<br>
 HiServ.com*<br>
 hiserv.com*<br>
 metro.ch*<br>
 beyond.com*<br>
 mcafee.com*<br>

 pandasoftw*<br>
 earthlink.*<br>
 inexar.com*<br>
 comkom.co.*<br>
 meditrade.*<br>
 mabex.com *<br>

 cellco.com*<br>
 symantec.c*<br>
 successful*<br>
 inforamp.n*<br>
 newell.com*<br>
 singnet.co*<br>

 bmcd.com.a*<br>
 bca.com.nz*<br>
 trendmicro*<br>
 sophos.com*<br>
 maple.com.*<br>
 netsales.n*<br>

 f-secure.c*
</blockquote>

<p>The worm also intercepts e-mail messages that are sent and attempts to send
a duplicate message with an infected attachment to the same address (the same
as "Happy" worm does). As a result, a victim address should receive two messages:
first, is the original message, written by a sender; second, comes a message
with an empty subject and text and an attached file that has one of the names
that are selected by the worm depending on the current date:</p>

<blockquote>
 README.TXT.pif<br>
 I_wanna_see_YOU.TXT.pif<br>
 MATRiX_Screen_Saver.SCR<br>

 LOVE_LETTER_FOR_YOU.TXT.pif<br>
 NEW_playboy_Screen_saver.SCR<br>
 BILL_GATES_PIECE.JPG.pif<br>
 TIAZINHA.JPG.pif<br>
 FEITICEIRA_NUA.JPG.pif<br>
 Geocities_Free_sites.TXT.pif<br>

 NEW_NAPSTER_site.TXT.pif<br>
 METALLICA_SONG.MP3.pif<br>
 ANTI_CIH.EXE<br>
 INTERNET_SECURITY_FORUM.DOC.pif<br>
 ALANIS_Screen_Saver.SCR<br>
 READER_DIGEST_LETTER.TXT.pif<br>

 WIN_$100_NOW.DOC.pif<br>
 IS_LINUX_GOOD_ENOUGH!.TXT.pif<br>
 QI_TEST.EXE<br>
 AVP_Updates.EXE<br>
 SEICHO-NO-IE.EXE<br>
 YOU_are_FAT!.TXT.pif<br>

 FREE_xxx_sites.TXT.pif<br>
 I_am_sorry.DOC.pif<br>
 Me_nude.AVI.pif<br>
 Sorry_about_yesterday.DOC.pif<br>
 Protect_your_credit.HTML.pif<br>
 JIMI_HMNDRIX.MP3.pif<br>

 HANSON.SCR<br>
 FUCKING_WITH_DOGS.SCR<br>
 MATRiX_2_is_OUT.SCR<br>
 zipped_files.EXE<br>
 BLINK_182.MP3.pif
</blockquote>

<p>As an attached file, the worm uses the WIN32.DLL file that has been dropped
by the virus component.</p>

<p>Note: the worm does not drop the WIN32.DLL file, but uses that file to attach
it to messages that are sent. So the "pure worm" is not able to spread more
than once: being run on a victim machine, the worm will infect WSOCK32.DLL,
but will not be able to send its copies further. To "fix this problem," the
worm sends its infected copy (WIN32.DLL is a worm component infected by a virus
component, see above).</p>

<p>The known worm modification has a bug in its spreading routine and email server
in many cases fails to receive affected messages from infected machine. Despite
on that if the system has Dial-up connection, or mail server is fast enough,
the worm sends its copies with no problems.</p>

<h4>Backdoor</h4>
 
<p>Being run, a Backdoor component creates a new key in the system registry that
indicates the machine is already infected:</p>

<blockquote>
 HKLM\Software\[MATRIX]
</blockquote>

<p>In case this key exists, the Backdoor skips the installation procedure. Otherwise,
it registers itself in the auto-run section:</p>

<blockquote>
 HKLM\Software\Microsoft\Windows\CurrentVersion\Run<br>
  SystemBackup=%WinDir%\MTX_.EXE
</blockquote>

<p>where %WinDir% is Windows directory.</p>

<p>The Backdoor then stays active in Windows as a hidden application (service)
and runs a routine that connects to some Internet server, obtains files from
there and spawns them in the system. So, the Backdoor can infect the system
with other viruses or install Trojan programs or more functional backdoors.</p>

<p>This component in the known virus version also has a bug that causes standard
a Windows message about an error in application when a backdoor tries to access
an Internet site.</p>