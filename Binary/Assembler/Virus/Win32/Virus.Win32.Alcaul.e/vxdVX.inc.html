<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Virus.Win32.Alcaul.e - vxdVX.inc.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc9 {
	color: #0080FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;Some ring-0 constants &amp; macroses.</span><span class="sc0">
</span><span class="sc1">;==============================================================================</span><span class="sc0">

</span><span class="sc5">VxDcall</span><span class="sc0">          </span><span class="sc9">macro</span><span class="sc0"> </span><span class="sc5">VxD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Service</span><span class="sc0">
                 </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0CDh</span><span class="sc0">
                 </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">020h</span><span class="sc0">
                 </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">Service</span><span class="sc0">
                 </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">VxD</span><span class="sc0">
                 </span><span class="sc9">endm</span><span class="sc0">

</span><span class="sc5">VMMcall</span><span class="sc0">          </span><span class="sc9">macro</span><span class="sc0">   </span><span class="sc5">Service</span><span class="sc0">
                 </span><span class="sc5">VxDcall</span><span class="sc0"> </span><span class="sc5">VMM</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Service</span><span class="sc0">
                 </span><span class="sc9">endm</span><span class="sc0">


</span><span class="sc5">IFSMgr</span><span class="sc0">                   </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0040h</span><span class="sc0">
</span><span class="sc5">VMM</span><span class="sc0">              </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0001h</span><span class="sc0">

</span><span class="sc5">GetHeap</span><span class="sc0">                  </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">000dh</span><span class="sc0"> 
</span><span class="sc5">InstallFileSystemAPIhook</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0067h</span><span class="sc0">
</span><span class="sc5">UniToBCSPath</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0041h</span><span class="sc0">
</span><span class="sc5">Ring0_FileIO</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0032h</span><span class="sc0">

</span><span class="sc5">HeapAllocate</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">79</span><span class="sc0">
</span><span class="sc5">PageAllocate</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">83</span><span class="sc0">
</span><span class="sc5">PageModifyPermissions</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0133h</span><span class="sc0">
</span><span class="sc5">Set_PM_Int_Vector</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">69</span><span class="sc0">
</span><span class="sc5">Set_V86_Int_Vector</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">67</span><span class="sc0">
</span><span class="sc5">Simulate_Int</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">70</span><span class="sc0">
</span><span class="sc5">Hook_V86_Int_Chain</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">65</span><span class="sc0">
</span><span class="sc5">Install_IO_Handler</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">150</span><span class="sc0">

</span><span class="sc5">HEAPZEROINIT</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0001h</span><span class="sc0">
</span><span class="sc5">PG_SYS</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0001h</span><span class="sc0">
</span><span class="sc5">PAGELOCKED</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0080h</span><span class="sc0">


</span><span class="sc5">PC_WRITEABLE</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">00020000h</span><span class="sc0">
</span><span class="sc5">PC_USER</span><span class="sc0">                  </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">00040000h</span><span class="sc0">
</span><span class="sc5">PC_STATIC</span><span class="sc0">                </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">20000000h</span><span class="sc0">


</span><span class="sc5">R0_OPENCREATFILE</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0d500h</span><span class="sc0">
</span><span class="sc5">R0_OPENCREAT_IN_CONTEXT</span><span class="sc0">  </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0d501h</span><span class="sc0">
</span><span class="sc5">R0_READFILE</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0d600h</span><span class="sc0">
</span><span class="sc5">R0_WRITEFILE</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0d601h</span><span class="sc0">
</span><span class="sc5">R0_READFILE_IN_CONTEXT</span><span class="sc0">   </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0d602h</span><span class="sc0">
</span><span class="sc5">R0_WRITEFILE_IN_CONTEXT</span><span class="sc0">  </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0d603h</span><span class="sc0">
</span><span class="sc5">R0_CLOSEFILE</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0d700h</span><span class="sc0">
</span><span class="sc5">R0_GETFILESIZE</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0d800h</span><span class="sc0">
</span><span class="sc5">R0_FINDFIRSTFILE</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">04e00h</span><span class="sc0">
</span><span class="sc5">R0_FINDNEXTFILE</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">04f00h</span><span class="sc0">
</span><span class="sc5">R0_FINDCLOSEFILE</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0dc00h</span><span class="sc0">
</span><span class="sc5">R0_FILEATTRIBUTES</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">04300h</span><span class="sc0">
</span><span class="sc5">R0_RENAMEFILE</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">05600h</span><span class="sc0">
</span><span class="sc5">R0_DELETEFILE</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">04100h</span><span class="sc0">
</span><span class="sc5">R0_LOCKFILE</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">05c00h</span><span class="sc0">
</span><span class="sc5">R0_GETDISKFREESPACE</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">03600h</span><span class="sc0">
</span><span class="sc5">R0_READABSOLUTEDISK</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0dd00h</span><span class="sc0">
</span><span class="sc5">R0_WRITEABSOLUTEDISK</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0de00h</span><span class="sc0">
</span><span class="sc5">R0_HANDLETOPATH</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0ec00h</span><span class="sc0">
</span><span class="sc5">R0_MAPCACHEBLOCK</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0ed00h</span><span class="sc0">
</span><span class="sc5">R0_GETVOLLOCKLEVEL</span><span class="sc0">   </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0ee00h</span><span class="sc0">

</span><span class="sc5">IFSFN_READ</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">IFSFN_WRITE</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">IFSFN_FINDNEXT</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">IFSFN_FCNNEXT</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">IFSFN_SEEK</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
</span><span class="sc5">IFSFN_CLOSE</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">11</span><span class="sc0">
</span><span class="sc5">IFSFN_COMMIT</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">IFSFN_FILELOCKS</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc0">
</span><span class="sc5">IFSFN_FILETIMES</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc0">
</span><span class="sc5">IFSFN_PIPEREQUEST</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc0">
</span><span class="sc5">IFSFN_HANDLEINFO</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
</span><span class="sc5">IFSFN_ENUMHANDLE</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">17</span><span class="sc0">
</span><span class="sc5">IFSFN_FINDCLOSE</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc0">
</span><span class="sc5">IFSFN_FCNCLOSE</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">19</span><span class="sc0">
</span><span class="sc5">IFSFN_CONNECT</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">30</span><span class="sc0">
</span><span class="sc5">IFSFN_DELETE</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">31</span><span class="sc0">
</span><span class="sc5">IFSFN_DIR</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">32</span><span class="sc0">
</span><span class="sc5">IFSFN_FILEATTRIB</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">33</span><span class="sc0">
</span><span class="sc5">IFSFN_FLUSH</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">34</span><span class="sc0">
</span><span class="sc5">IFSFN_GETDISKINFO</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">35</span><span class="sc0">
</span><span class="sc5">IFSFN_OPEN</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">36</span><span class="sc0">
</span><span class="sc5">IFSFN_RENAME</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">37</span><span class="sc0">
</span><span class="sc5">IFSFN_SEARCH</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">38</span><span class="sc0">
</span><span class="sc5">IFSFN_QUERY</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">39</span><span class="sc0">
</span><span class="sc5">IFSFN_DISCONNECT</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">40</span><span class="sc0">
</span><span class="sc5">IFSFN_UNCPIPEREQ</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">41</span><span class="sc0">
</span><span class="sc5">IFSFN_IOCTL16DRIVE</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">42</span><span class="sc0">
</span><span class="sc5">IFSFN_GETDISKPARMS</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">43</span><span class="sc0">
</span><span class="sc5">IFSFN_FINDOPEN</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">44</span><span class="sc0">
</span><span class="sc5">IFSFN_DASDIO</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">45</span></div></body>
</html>
