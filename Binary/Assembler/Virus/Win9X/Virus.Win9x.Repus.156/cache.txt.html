<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">
case A: There was no pending cache writes.

  case A-1: Before infection...


           VRP                       CacheBlock
           имммммммммм╩&lt;ддд©         имммммммм╩
           ╨          ╨    Ё         ╨        ╨
           ╨          ╨    Ё         ╨        ╨
           ╨дддддддддд╨    юдддддддддд BLK+0C ╨=VRP
       1F4=╨ VRP+x-04 ╨              ╨ BLK+10 дддддддд&gt; Buffer
           ╨дддддддддд╨              ╨        ╨
 NULL=List=╨ VRP+x+00 ╨              ╨ BLK+1C ╨=?
           ╨дддддддддд╨              ╨ BLK+20 ╨=? 
           ╨          ╨              ╨        ╨
           ╨          ╨              ╨        ╨ 
           ╨дддддддддд╨              ╨ BLK+32 ╨=00
     drive=╨ VRP+x+30 ╨              ╨        ╨
           ╨дддддддддд╨              хмммммммм╪  
           ╨          ╨ 
           ╨          ╨ 
           ╨          ╨ 
           хмммммммммм╪ 



  case A-2: After infection...
 

       VRP                               CacheBlock
       имммммммммм╩&lt;ддд©   зд&gt;дбд&gt;дбдддд&gt;имммммммм╩
       ╨          ╨    Ё   Ё   Ё   Ё     ╨        ╨
       ╨          ╨    Ё   Ё   Ё   Ё     ╨        ╨
       ╨дддддддддд╨    юдддЁдддЁдддЁдддддд BLK+0C ╨=VRP
   1F4=╨ VRP+x-04 ╨        Ё   Ё   Ё     ╨ BLK+10 дддддддд&gt; Infected Buffer
       ╨дддддддддд╨        Ё   ^   ^     ╨        ╨
  List=╨ VRP+x+00 ддддддддды   Ё   юдддддд BLK+1C ╨=List-&gt;Next
       ╨дддддддддд╨            юдддддддддд BLK+20 ╨=List-&gt;Previous
       ╨          ╨                      ╨        ╨
       ╨          ╨                      ╨        ╨ 
       ╨дддддддддд╨                      ╨ BLK+32 ╨=FF
 drive=╨ VRP+x+30 ╨                      ╨        ╨
       ╨дддддддддд╨                      хмммммммм╪  
       ╨          ╨
       ╨          ╨
       ╨          ╨ 
       хмммммммммм╪ 









case B: There was some pending cache writes.
 
  case B-1: Before infection...


       VRP                CacheBlock 
       имммммммммм╩&lt;дд©   имммммммм╩ 
       ╨          ╨   юдддд BLK+0C ╨=VRP
       ╨          ╨       ╨ BLK+10 дддддддд&gt; Buffer 
       ╨дддддддддд╨       ╨ BLK+1C ╨=?  
   1F4=╨ VRP+x-04 ╨       ╨ BLK+20 ╨=?  
       ╨дддддддддд╨       ╨ BLK+32 ╨=00 
  List=╨ VRP+x+00 ддд©    хмммммммм╪  
       ╨дддддддддд╨  Ё       
       ╨          ╨  v       
       ╨          ╨  Ё      BLK0        BLK1           BLKn      
       ╨дддддддддд╨  юдбддд&gt;имм╩&lt;д© здд&gt;имм╩&lt;д©      д&gt;имм╩&lt;д©     
 drive=╨ VRP+x+30 ╨    Ё    ╨  ддддды   ╨  ддддд&gt; ...  ╨  дддЁдд©  
       ╨дддддддддд╨    ^  здд  ╨  юдддддд  ╨  юдд    &lt;дд  ╨  Ё  Ё  
       ╨          ╨    Ё  v хмм╪        хмм╪           хмм╪  Ё  v  
       ╨          ╨    Ё  Ё                                  Ё  Ё  
       ╨          ╨    юдддддддддддддддддддддд&lt;ддддддддддддддЁдды  
       хмммммммммм╪       юдддддддддддддддддддддд&gt;ддддддддддды     



   case B-2: After infection...


       VRP                           CacheBlock
       имммммммммм╩&lt;дд©    здддддддд&gt;имммммммм╩
       ╨          ╨   юддддЁдддддддддд BLK+0C ╨=VRP                 
       ╨          ╨        Ё         ╨ BLK+10 дддддддд&gt; Infected Buffer                      
       ╨дддддддддд╨        Ё  здNextдд BLK+1C ╨                     
   1F4=╨ VRP+x-04 ╨        ^  Ё      ╨ BLK+20 ддPreviousдддд&gt;дддд©  
       ╨дддддддддд╨        Ё  Ё      ╨ BLK+32 ╨=FF               Ё  
  List=╨ VRP+x+00 дддд&gt;дддд╢  Ё      хмммммммм╪                  Ё  
       ╨дддддддддд╨        Ё  v                                  Ё  
       ╨          ╨        Ё  Ё                                  v  
       ╨          ╨        Ё  Ё                                  Ё  
       ╨дддддддддд╨        ^  Ё  BLK0       BLK1           BLKn  Ё  
 drive=╨ VRP+x+30 ╨        Ё  юд&gt;имм╩&lt;д© зд&gt;имм╩&lt;д©      д&gt;имм╩&lt;ды  
       ╨дддддддддд╨        Ё     ╨  ддддды  ╨  ддддд&gt; ...  ╨  дддддд©
       ╨          ╨        цдд&lt;ддд  ╨  юддддд  ╨  юдд    &lt;дд  ╨     Ё
       ╨          ╨        Ё     хмм╪       хмм╪           хмм╪     v
       ╨          ╨        Ё                                        Ё
       хмммммммммм╪        юдддддд&lt;ддддддддддддддддддддддддддддддддды
                   
                                    


</span></div></body>
</html>
