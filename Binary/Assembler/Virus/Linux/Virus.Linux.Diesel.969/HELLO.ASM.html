<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>HELLO.ASM</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">; &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;   HELLO.ASM   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; ;</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;                                                                           ;</span><span class="sc0">
</span><span class="sc1">; This is a simple assembly program to explain you how to code in assembly  ;</span><span class="sc0">
</span><span class="sc1">; language under Linux. It must be compiled with TASM or MASM. However,     ;</span><span class="sc0">
</span><span class="sc1">; I guess it can be easily adapted to NASM. The program will display        ;</span><span class="sc0">
</span><span class="sc1">; "Hello" on the screen, and then exit with return code 42.                 ;</span><span class="sc0">
</span><span class="sc1">;                                                                           ;</span><span class="sc0">
</span><span class="sc1">; How to compile :                                                          ;</span><span class="sc0">
</span><span class="sc1">;                                                                           ;</span><span class="sc0">
</span><span class="sc1">;   TASM        HELLO.ASM                                                   ;</span><span class="sc0">
</span><span class="sc1">;   TLINK /3 /t HELLO,HELLO.                                                ;</span><span class="sc0">
</span><span class="sc1">;                                                                           ;</span><span class="sc0">
</span><span class="sc1">; Note that the Turbo Assembler (at least v3.1) can be runned under dosemu. ;</span><span class="sc0">
</span><span class="sc1">;                                                                           ;</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------------;</span><span class="sc0">

</span><span class="sc2">.386</span><span class="sc0">

</span><span class="sc10">RADIX</span><span class="sc0">        </span><span class="sc2">16</span><span class="sc0">

</span><span class="sc9">ASSUME</span><span class="sc0">       </span><span class="sc8">CS</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc4">,</span><span class="sc8">DS</span><span class="sc4">:</span><span class="sc5">CODE</span><span class="sc0">

</span><span class="sc5">CODE</span><span class="sc0">         </span><span class="sc9">SEGMENT</span><span class="sc0">

</span><span class="sc5">ELF</span><span class="sc4">:</span><span class="sc0">

             </span><span class="sc9">db</span><span class="sc0">           </span><span class="sc2">07F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'ELF'</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">     </span><span class="sc1">; Magic</span><span class="sc0">
             </span><span class="sc9">db</span><span class="sc0">           </span><span class="sc2">9</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">  
             </span><span class="sc9">dw</span><span class="sc0">           </span><span class="sc2">02</span><span class="sc0">                      </span><span class="sc1">; Executable File</span><span class="sc0">
             </span><span class="sc9">dw</span><span class="sc0">           </span><span class="sc2">03</span><span class="sc0">                      </span><span class="sc1">; Intel 80386</span><span class="sc0">
             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc2">01</span><span class="sc0">                      </span><span class="sc1">; ELF Version</span><span class="sc0">
             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc5">MemBase</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Start</span><span class="sc0">  </span><span class="sc1">; Entrypoint</span><span class="sc0">
             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Program_Header</span><span class="sc0">   </span><span class="sc1">; Program Header Offset</span><span class="sc0">
             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc2">00</span><span class="sc0">                      </span><span class="sc1">; Section Header Offset (None)</span><span class="sc0">
             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc2">00</span><span class="sc0">                      </span><span class="sc1">; Machine Flags (Unused)</span><span class="sc0">
             </span><span class="sc9">dw</span><span class="sc0">           </span><span class="sc2">34</span><span class="sc0">                      </span><span class="sc1">; ELF Header Size</span><span class="sc0">
             </span><span class="sc9">dw</span><span class="sc0">           </span><span class="sc2">20</span><span class="sc0">                      </span><span class="sc1">; Program Header Entry Size</span><span class="sc0">
             </span><span class="sc9">dw</span><span class="sc0">           </span><span class="sc2">01</span><span class="sc0">                      </span><span class="sc1">; Number of Entries</span><span class="sc0">
             </span><span class="sc9">dw</span><span class="sc0">           </span><span class="sc2">00</span><span class="sc0">                      </span><span class="sc1">; Section Header Entry Size</span><span class="sc0">
             </span><span class="sc9">dw</span><span class="sc0">           </span><span class="sc2">00</span><span class="sc0">                      </span><span class="sc1">; Number of Entries</span><span class="sc0">
             </span><span class="sc9">dw</span><span class="sc0">           </span><span class="sc2">00</span><span class="sc0">                      </span><span class="sc1">; Section Header Table Index</span><span class="sc0">

</span><span class="sc5">Program_Header</span><span class="sc4">:</span><span class="sc0">

             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc2">01</span><span class="sc0">                           </span><span class="sc1">; Loadable Segment</span><span class="sc0">
             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc2">00</span><span class="sc0">                           </span><span class="sc1">; Physical Offset</span><span class="sc0">
             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc5">MemBase</span><span class="sc0">                      </span><span class="sc1">; Image Base VAddr</span><span class="sc0">
             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc5">MemBase</span><span class="sc0">                      </span><span class="sc1">; Same (Unused)</span><span class="sc0">
             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc5">PhySize</span><span class="sc0">                      </span><span class="sc1">; Physical Size</span><span class="sc0">
             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc5">MemSize</span><span class="sc0">                      </span><span class="sc1">; Memory Size</span><span class="sc0">
             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc2">05</span><span class="sc0">                           </span><span class="sc1">; Read / Exec</span><span class="sc0">
             </span><span class="sc9">dd</span><span class="sc0">           </span><span class="sc2">1000h</span><span class="sc0">                        </span><span class="sc1">; Alignment</span><span class="sc0">

</span><span class="sc5">Start</span><span class="sc4">:</span><span class="sc0">

             </span><span class="sc6">mov</span><span class="sc0">          </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Output</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">MemBase</span><span class="sc0">  </span><span class="sc1">; Output</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">          </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">2</span><span class="sc0">                        </span><span class="sc1">; Read / Write</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">          </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">                        </span><span class="sc1">; Open</span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">          </span><span class="sc2">80</span><span class="sc0">

             </span><span class="sc6">or</span><span class="sc0">           </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                      </span><span class="sc1">; Error ?</span><span class="sc0">
             </span><span class="sc6">js</span><span class="sc0">           </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">Exit</span><span class="sc0">

             </span><span class="sc6">mov</span><span class="sc0">          </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">                      </span><span class="sc1">; File Descriptor</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">          </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">String</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">MemBase</span><span class="sc0">  </span><span class="sc1">; 'Hello'</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">          </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">                        </span><span class="sc1">; Buffer Size</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">          </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">                        </span><span class="sc1">; Write</span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">          </span><span class="sc2">80</span><span class="sc0">

             </span><span class="sc6">mov</span><span class="sc0">          </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">6</span><span class="sc0">                        </span><span class="sc1">; Close</span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">          </span><span class="sc2">80</span><span class="sc0">

</span><span class="sc5">Exit</span><span class="sc4">:</span><span class="sc0">

             </span><span class="sc6">mov</span><span class="sc0">          </span><span class="sc8">bl</span><span class="sc4">,</span><span class="sc2">42d</span><span class="sc0">
             </span><span class="sc6">mov</span><span class="sc0">          </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
             </span><span class="sc6">int</span><span class="sc0">          </span><span class="sc2">80</span><span class="sc0">

</span><span class="sc5">Output</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">           </span><span class="sc12">'/dev/stdout'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">String</span><span class="sc0">       </span><span class="sc9">db</span><span class="sc0">           </span><span class="sc12">'Hello'</span><span class="sc4">,</span><span class="sc2">0A</span><span class="sc0">

</span><span class="sc5">Phy_End</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">Mem_End</span><span class="sc4">:</span><span class="sc0">

</span><span class="sc5">PhySize</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0">          </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Phy_End</span><span class="sc0">   </span><span class="sc1">; Size of Initialized Code &amp; Data</span><span class="sc0">
</span><span class="sc5">MemSize</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0">          </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">Mem_End</span><span class="sc0">   </span><span class="sc1">; PSize + Uninitialized Data</span><span class="sc0">
</span><span class="sc5">MemBase</span><span class="sc0">      </span><span class="sc9">equ</span><span class="sc0">          </span><span class="sc2">08048000</span><span class="sc0">         </span><span class="sc1">; Start of Memory Projection</span><span class="sc0">


</span><span class="sc5">CODE</span><span class="sc0">         </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc9">END</span><span class="sc0">          </span><span class="sc5">ELF</span><span class="sc0">

</span><span class="sc1">;---------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">; &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;   How To Make A System Call Under Linux   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; ;</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------------;</span><span class="sc0">

   </span><span class="sc5">You</span><span class="sc0"> </span><span class="sc5">should</span><span class="sc0"> </span><span class="sc5">use</span><span class="sc0"> </span><span class="sc5">some</span><span class="sc0"> </span><span class="sc5">code</span><span class="sc0"> </span><span class="sc5">like</span><span class="sc0"> </span><span class="sc9">this</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc0">

      </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc2">1st</span><span class="sc0"> </span><span class="sc5">Arg</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">2nd</span><span class="sc0"> </span><span class="sc5">Arg</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc2">3rd</span><span class="sc0"> </span><span class="sc5">Arg</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc2">4th</span><span class="sc0"> </span><span class="sc5">Arg</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">5th</span><span class="sc0"> </span><span class="sc5">Arg</span><span class="sc0">
      </span><span class="sc6">mov</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc6">SysCall</span><span class="sc0"> </span><span class="sc5">Number</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">look</span><span class="sc0"> </span><span class="sc9">at</span><span class="sc0"> </span><span class="sc5">unistd.h</span><span class="sc4">)</span><span class="sc0">
      </span><span class="sc6">int</span><span class="sc0">    </span><span class="sc2">80</span><span class="sc0">

   </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc5">will</span><span class="sc0"> </span><span class="sc5">contain</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">return</span><span class="sc0"> </span><span class="sc5">value.</span><span class="sc0"> </span><span class="sc9">If</span><span class="sc0"> </span><span class="sc5">negative</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">an</span><span class="sc0"> </span><span class="sc10">error</span><span class="sc0"> </span><span class="sc5">has</span><span class="sc0"> </span><span class="sc5">occured.</span><span class="sc0">
   </span><span class="sc5">errno.h</span><span class="sc0"> </span><span class="sc5">contains</span><span class="sc0"> </span><span class="sc5">the</span><span class="sc0"> </span><span class="sc5">list</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc10">error</span><span class="sc0"> </span><span class="sc5">codes</span><span class="sc0"> </span><span class="sc5">with</span><span class="sc0"> </span><span class="sc5">their</span><span class="sc0"> </span><span class="sc5">signification.</span><span class="sc0">

   </span><span class="sc5">Here</span><span class="sc13">'s a brief list of the most used system calls numbers :
</span><span class="sc0">
      </span><span class="sc2">01</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">exit</span><span class="sc0">     </span><span class="sc2">02</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">fork</span><span class="sc0">     </span><span class="sc2">03</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">read</span><span class="sc0">     </span><span class="sc2">04</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">write</span><span class="sc0">     </span><span class="sc2">05</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">open</span><span class="sc0">
      </span><span class="sc2">06</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">close</span><span class="sc0">    </span><span class="sc2">08</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">creat</span><span class="sc0">    </span><span class="sc2">11</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">execve</span><span class="sc0">   </span><span class="sc2">12</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">chdir</span><span class="sc0">     </span><span class="sc2">15</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">chmod</span><span class="sc0">
      </span><span class="sc2">19</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">lseek</span><span class="sc0">    </span><span class="sc2">26</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">ptrace</span><span class="sc0">   </span><span class="sc2">37</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">kill</span><span class="sc0">     </span><span class="sc2">89</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">readdir</span><span class="sc0">   </span><span class="sc2">90</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">mmap</span><span class="sc0">

   </span><span class="sc5">You</span><span class="sc13">'ll find more in unistd.h
</span><span class="sc0">
   </span><span class="sc9">If</span><span class="sc0"> </span><span class="sc5">you</span><span class="sc0"> </span><span class="sc5">want</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">get</span><span class="sc0"> </span><span class="sc5">information</span><span class="sc0"> </span><span class="sc5">about</span><span class="sc0"> </span><span class="sc5">a</span><span class="sc0"> </span><span class="sc5">specific</span><span class="sc0"> </span><span class="sc5">system</span><span class="sc0"> </span><span class="sc6">call</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">like</span><span class="sc0"> </span><span class="sc5">ptrace</span><span class="sc4">,</span><span class="sc0">
   </span><span class="sc9">type</span><span class="sc4">:</span><span class="sc0">  </span><span class="sc5">man</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0"> </span><span class="sc5">ptrace</span><span class="sc0">

</span><span class="sc1">;---------------------------------------------------------------------------;</span><span class="sc0">
</span></div></body>
</html>
