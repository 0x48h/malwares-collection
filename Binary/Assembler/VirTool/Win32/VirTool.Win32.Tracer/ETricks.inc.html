<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>ETricks.inc</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;These structures are well-known ...</span><span class="sc0">

</span><span class="sc5">CONTEXT</span><span class="sc0">             </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">cx_ContextFlags</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">cx_Dr0</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;04</span><span class="sc0">
</span><span class="sc5">cx_Dr1</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;08</span><span class="sc0">
</span><span class="sc5">cx_Dr2</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;0C</span><span class="sc0">
</span><span class="sc5">cx_Dr3</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;10</span><span class="sc0">
</span><span class="sc5">cx_Dr6</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;14</span><span class="sc0">
</span><span class="sc5">cx_Dr7</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;18</span><span class="sc0">

</span><span class="sc1">;FPU</span><span class="sc0">
</span><span class="sc5">cx_ControlWord</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_StatusWord</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_TagWord</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_ErrorOffset</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_ErrorSelector</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_DataOffset</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_DataSelector</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_RegisterArea</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc2">80</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">cx_Cr0NpxState</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc5">cx_SegGs</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;8C</span><span class="sc0">
</span><span class="sc5">cx_SegFs</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;90</span><span class="sc0">
</span><span class="sc5">cx_SegEs</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;94</span><span class="sc0">
</span><span class="sc5">cx_SegDs</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;98</span><span class="sc0">

</span><span class="sc5">cx_Edi</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;9C</span><span class="sc0">
</span><span class="sc5">cx_Esi</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;A0</span><span class="sc0">
</span><span class="sc5">cx_Ebx</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;A4</span><span class="sc0">
</span><span class="sc5">cx_Edx</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;A8</span><span class="sc0">
</span><span class="sc5">cx_Ecx</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;AC</span><span class="sc0">
</span><span class="sc5">cx_Eax</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;B0</span><span class="sc0">

</span><span class="sc5">cx_Ebp</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;B4</span><span class="sc0">
</span><span class="sc5">cx_Eip</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;B8</span><span class="sc0">
</span><span class="sc5">cx_SegCs</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;BC</span><span class="sc0">
</span><span class="sc5">cx_EFlags</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;C0</span><span class="sc0">
</span><span class="sc5">cx_Esp</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;C4</span><span class="sc0">
</span><span class="sc5">cx_SegSs</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;C8</span><span class="sc0">
</span><span class="sc5">CONTEXT</span><span class="sc0">             </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">CONTEXT_i386</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000010000H</span><span class="sc0">
</span><span class="sc5">CONTEXT_i486</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000010000H</span><span class="sc0">
</span><span class="sc5">CONTEXT_CONTROL</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CONTEXT_i386</span><span class="sc4">+</span><span class="sc2">00000001H</span><span class="sc0">
</span><span class="sc5">CONTEXT_INTEGER</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CONTEXT_i386</span><span class="sc4">+</span><span class="sc2">00000002H</span><span class="sc0">
</span><span class="sc5">CONTEXT_SEGMENTS</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CONTEXT_i386</span><span class="sc4">+</span><span class="sc2">00000004H</span><span class="sc0">
</span><span class="sc5">CONTEXT_FLOATING_POINT</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CONTEXT_i386</span><span class="sc4">+</span><span class="sc2">00000008H</span><span class="sc0">
</span><span class="sc5">CONTEXT_DEBUG_REGISTERS</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CONTEXT_i386</span><span class="sc4">+</span><span class="sc2">00000010H</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">EXCEPTION_RECORD</span><span class="sc0">        </span><span class="sc9">STRUC</span><span class="sc0">
    </span><span class="sc5">ExceptionCode</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">ExceptionFlags</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">             </span><span class="sc1">; bit 0=1..uncontinuable</span><span class="sc0">
    </span><span class="sc5">EXCEPTION_RECORD_PTR</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">ExceptionAddress</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">NumberParameters</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">EXCEPTION_MAXIMUM_PARAMETERS</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc0">     </span><span class="sc1">; pro forma</span><span class="sc0">
    </span><span class="sc5">ExceptionInformation</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc5">EXCEPTION_MAXIMUM_PARAMETERS</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">EXCEPTION_RECORD</span><span class="sc0">        </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">STATUS_WAIT_0</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000000H</span><span class="sc0">
</span><span class="sc5">STATUS_ABANDONED_WAIT_0</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000080H</span><span class="sc0">
</span><span class="sc5">STATUS_USER_APC</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0000000C0H</span><span class="sc0">
</span><span class="sc5">STATUS_TIMEOUT</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000102H</span><span class="sc0">
</span><span class="sc5">STATUS_PENDING</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000103H</span><span class="sc0">
</span><span class="sc5">STATUS_SEGMENT_NOTIFICATION</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">040000005H</span><span class="sc0">
</span><span class="sc5">STATUS_GUARD_PAGE_VIOLATION</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">080000001H</span><span class="sc0">
</span><span class="sc5">STATUS_DATATYPE_MISALIGNMENT</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">080000002H</span><span class="sc0">   </span><span class="sc1">; exception 17</span><span class="sc0">
</span><span class="sc5">STATUS_BREAKPOINT</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">080000003H</span><span class="sc0">   </span><span class="sc1">; exception 3</span><span class="sc0">
</span><span class="sc5">STATUS_SINGLE_STEP</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">080000004H</span><span class="sc0">   </span><span class="sc1">; exception 1</span><span class="sc0">
</span><span class="sc5">STATUS_ACCESS_VIOLATION</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000005H</span><span class="sc0">   </span><span class="sc1">; typically exception 13</span><span class="sc0">
</span><span class="sc5">STATUS_IN_PAGE_ERROR</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000006H</span><span class="sc0">
</span><span class="sc5">STATUS_NO_MEMORY</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000017H</span><span class="sc0">
</span><span class="sc5">STATUS_ILLEGAL_INSTRUCTION</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000001DH</span><span class="sc0">
</span><span class="sc5">STATUS_NONCONTINUABLE_EXCEPTION</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000025H</span><span class="sc0">
</span><span class="sc5">STATUS_INVALID_DISPOSITION</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000026H</span><span class="sc0">
</span><span class="sc5">STATUS_ARRAY_BOUNDS_EXCEEDED</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000008CH</span><span class="sc0">   </span><span class="sc1">; exception 5</span><span class="sc0">
</span><span class="sc5">STATUS_FLOAT_DENORMAL_OPERAND</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000008DH</span><span class="sc0">
</span><span class="sc5">STATUS_FLOAT_DIVIDE_BY_ZERO</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000008EH</span><span class="sc0">
</span><span class="sc5">STATUS_FLOAT_INEXACT_RESULT</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000008FH</span><span class="sc0">
</span><span class="sc5">STATUS_FLOAT_INVALID_OPERATION</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000090H</span><span class="sc0">
</span><span class="sc5">STATUS_FLOAT_OVERFLOW</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000091H</span><span class="sc0">
</span><span class="sc5">STATUS_FLOAT_STACK_CHECK</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000092H</span><span class="sc0">
</span><span class="sc5">STATUS_FLOAT_UNDERFLOW</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000093H</span><span class="sc0">
</span><span class="sc5">STATUS_INTEGER_DIVIDE_BY_ZERO</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000094H</span><span class="sc0">   </span><span class="sc1">; exception 0</span><span class="sc0">
</span><span class="sc5">STATUS_INTEGER_OVERFLOW</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000095H</span><span class="sc0">   </span><span class="sc1">; exception 4</span><span class="sc0">
</span><span class="sc5">STATUS_PRIVILEGED_INSTRUCTION</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000096H</span><span class="sc0">   </span><span class="sc1">; typically exception 13</span><span class="sc0">
</span><span class="sc5">STATUS_STACK_OVERFLOW</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C00000FDH</span><span class="sc0">
</span><span class="sc5">STATUS_CONTROL_C_EXIT</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000013AH</span><span class="sc0">

</span><span class="sc1">;------------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">;useful constants</span><span class="sc0">

</span><span class="sc1">; for DR6</span><span class="sc0">
</span><span class="sc5">M_HIT0</span><span class="sc0">                          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">M_HIT1</span><span class="sc0">                          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">M_HIT2</span><span class="sc0">                          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0">
</span><span class="sc5">M_HIT3</span><span class="sc0">                          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
</span><span class="sc5">M_BD</span><span class="sc0">                            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">2000H</span><span class="sc0">        </span><span class="sc1">; DRX access</span><span class="sc0">
</span><span class="sc5">M_BS</span><span class="sc0">                            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">4000H</span><span class="sc0">        </span><span class="sc1">; single step</span><span class="sc0">
</span><span class="sc5">M_BT</span><span class="sc0">                            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">8000H</span><span class="sc0">        </span><span class="sc1">; task switch</span><span class="sc0">

</span><span class="sc1">; for DR7</span><span class="sc0">
</span><span class="sc5">M_DR0</span><span class="sc0">                           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc0">           </span><span class="sc1">; for multit. environ. I set only Li (=1)</span><span class="sc0">
</span><span class="sc5">M_DR1</span><span class="sc0">                           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_DR0</span><span class="sc0">    </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc0">
</span><span class="sc5">M_DR2</span><span class="sc0">                           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_DR1</span><span class="sc0">    </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc0">
</span><span class="sc5">M_DR3</span><span class="sc0">                           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_DR2</span><span class="sc0">    </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc0">

</span><span class="sc5">M_LE</span><span class="sc0">                            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc0">       </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">08</span><span class="sc0">
</span><span class="sc5">M_GE</span><span class="sc0">                            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_LE</span><span class="sc0">     </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc0">

</span><span class="sc1">;DRX access</span><span class="sc0">
</span><span class="sc5">M_GD</span><span class="sc0">                            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_BD</span><span class="sc0">

</span><span class="sc1">;instruction fetch</span><span class="sc0">
</span><span class="sc5">M_INSTR0</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">
</span><span class="sc5">M_INSTR1</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">
</span><span class="sc5">M_INSTR2</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">
</span><span class="sc5">M_INSTR3</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">

</span><span class="sc1">;memory write</span><span class="sc0">
</span><span class="sc5">M_WRITE0</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc0"> </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
</span><span class="sc5">M_WRITE1</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_WRITE0</span><span class="sc0"> </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">
</span><span class="sc5">M_WRITE2</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_WRITE1</span><span class="sc0"> </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">
</span><span class="sc5">M_WRITE3</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_WRITE2</span><span class="sc0"> </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">

</span><span class="sc1">;port watches: 586+ only and CR4 bit DE (=08) must be 1</span><span class="sc0">
</span><span class="sc5">M_PORT0</span><span class="sc0">                         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">02</span><span class="sc0"> </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
</span><span class="sc5">M_PORT1</span><span class="sc0">                         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_PORT0</span><span class="sc0">  </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">
</span><span class="sc5">M_PORT2</span><span class="sc0">                         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_PORT1</span><span class="sc0">  </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">
</span><span class="sc5">M_PORT3</span><span class="sc0">                         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_PORT2</span><span class="sc0">  </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">

</span><span class="sc1">;memory access</span><span class="sc0">
</span><span class="sc5">M_RW0</span><span class="sc0">                           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc0"> </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc0">
</span><span class="sc5">M_RW1</span><span class="sc0">                           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_RW0</span><span class="sc0">    </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">
</span><span class="sc5">M_RW2</span><span class="sc0">                           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_RW1</span><span class="sc0">    </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">
</span><span class="sc5">M_RW3</span><span class="sc0">                           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_RW2</span><span class="sc0">    </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">

</span><span class="sc1">;lengths</span><span class="sc0">
</span><span class="sc5">M_BYTE0</span><span class="sc0">                         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">           </span><span class="sc1">; use byte for instruction too</span><span class="sc0">
</span><span class="sc5">M_BYTE1</span><span class="sc0">                         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">
</span><span class="sc5">M_BYTE2</span><span class="sc0">                         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">
</span><span class="sc5">M_BYTE3</span><span class="sc0">                         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">00</span><span class="sc0">

</span><span class="sc5">M_WORD0</span><span class="sc0">                         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">01</span><span class="sc0"> </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc0">
</span><span class="sc5">M_WORD1</span><span class="sc0">                         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_WORD0</span><span class="sc0">  </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">
</span><span class="sc5">M_WORD2</span><span class="sc0">                         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_WORD1</span><span class="sc0">  </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">
</span><span class="sc5">M_WORD3</span><span class="sc0">                         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_WORD2</span><span class="sc0">  </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">

</span><span class="sc5">M_DWORD0</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">03</span><span class="sc0"> </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">18</span><span class="sc0">
</span><span class="sc5">M_DWORD1</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_DWORD0</span><span class="sc0"> </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">
</span><span class="sc5">M_DWORD2</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_DWORD1</span><span class="sc0"> </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">
</span><span class="sc5">M_DWORD3</span><span class="sc0">                        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">M_DWORD2</span><span class="sc0"> </span><span class="sc6">SHL</span><span class="sc0"> </span><span class="sc2">04</span><span class="sc0">


</span><span class="sc1">;------------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc1">; .. and these structrures I created according to softice command xframe</span><span class="sc0">
</span><span class="sc1">; and kernel analysis</span><span class="sc0">

</span><span class="sc5">xFrame_RECORD</span><span class="sc0">           </span><span class="sc9">STRUC</span><span class="sc0"> </span><span class="sc1">; aka exception_registration</span><span class="sc0">
       </span><span class="sc5">NextxFrame</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; ptr or -1 for last member</span><span class="sc0">
       </span><span class="sc5">xHandler</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; ptr</span><span class="sc0">
       </span><span class="sc5">xTable</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; ptr to xTableArray</span><span class="sc0">
       </span><span class="sc5">xScope</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; 1st index of xTable_RECORD or -1 for end</span><span class="sc0">
</span><span class="sc5">xFrame_RECORD</span><span class="sc0">           </span><span class="sc9">ENDS</span><span class="sc0">


</span><span class="sc1">; xTableArray           xTable_RECORD  MAX_xTable_RECORDs  DUP (?)</span><span class="sc0">

</span><span class="sc5">xTable_RECORD</span><span class="sc0">           </span><span class="sc9">STRUC</span><span class="sc0">
       </span><span class="sc5">NextxScope</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; index of next xTable_RECORD or -1 for end</span><span class="sc0">
       </span><span class="sc5">filter</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; ptr on code</span><span class="sc0">
       </span><span class="sc5">handler</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; ptr on code</span><span class="sc0">
</span><span class="sc5">xTable_RECORD</span><span class="sc0">           </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------------------------------------</span><span class="sc0">
</span></div></body>
</html>
