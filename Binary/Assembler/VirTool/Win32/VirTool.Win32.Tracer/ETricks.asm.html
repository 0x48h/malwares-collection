<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;@GOTO TRANSLATE</span><span class="sc0">

</span><span class="sc1">; COMMENT $</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Inspiration: CodeSafe by Zhang De Hua</span><span class="sc0">
</span><span class="sc1">;        (http://www.geocities.com/SiliconValley/Park/9031)</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; CodeSafe is one-year-old(!) very nice PE protector/compressor.</span><span class="sc0">
</span><span class="sc1">; Under other protectors you can use hardware breakpoints without problems</span><span class="sc0">
</span><span class="sc1">; (where you can't bpx, there you can bpm x or bphx, of course bpm, etc..).</span><span class="sc0">
</span><span class="sc1">; CodeSafe uses "context trick"(I call it so) before it accesses module/procedure.</span><span class="sc0">
</span><span class="sc1">; It calls CreateThread, WaitForSingleObject, TerminateThread, GetExitCodeThread</span><span class="sc0">
</span><span class="sc1">; and other protector/debugger-typical functions. First 5 bytes of every called</span><span class="sc0">
</span><span class="sc1">; function are checked for INT3 presence - it's now standard too.</span><span class="sc0">
</span><span class="sc1">; But most interesting is receiving of function address. Standard is calling</span><span class="sc0">
</span><span class="sc1">; GetProcAddress, but CodeSafe calculates adress by other way. If procedure is</span><span class="sc0">
</span><span class="sc1">; in kernel32.dll, it takes kernel32 image as beeing located at 77F00000H(NT) or</span><span class="sc0">
</span><span class="sc1">; 0BFF70000H(95), then it calculates PE header and section positions and from</span><span class="sc0">
</span><span class="sc1">; them procedure addresses.</span><span class="sc0">
</span><span class="sc1">; CodeSafe distinguishes NT and 95 according to their reaction on setting GD in</span><span class="sc0">
</span><span class="sc1">; DR7.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; I present here extensions to (and variations on theme) context trick and</span><span class="sc0">
</span><span class="sc1">; something more.</span><span class="sc0">
</span><span class="sc1">; The tricks not only destroy hardware breakpoints set by debugger but you can</span><span class="sc0">
</span><span class="sc1">; set own. Tricks are used for indirect execution flow (untraceability) too.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; All I tested under W95 and NT4 only.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Gurus don't laugh: I don't have any undocumentation.</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; ------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; Miscelaneous:</span><span class="sc0">
</span><span class="sc1">;  1) NTice detection</span><span class="sc0">
</span><span class="sc1">;  - can be used under NT only</span><span class="sc0">
</span><span class="sc1">;    a) execute INT 1 instruction (95 incompatible)</span><span class="sc0">
</span><span class="sc1">;    b) it raises exception, catch it by xHandler</span><span class="sc0">
</span><span class="sc1">;    c) check ExceptionCode: normally it should be STATUS_ACCESS_VIOLATION</span><span class="sc0">
</span><span class="sc1">;       and cx_Eip should point to INT 1 instruction</span><span class="sc0">
</span><span class="sc1">;       but when NTice is present code will be STATUS_SINGLE_STEP</span><span class="sc0">
</span><span class="sc1">;       and cx_Eip will point to instruction following INT 1</span><span class="sc0">
</span><span class="sc1">;  - it's de facto the same trick as my WinICE detection 1 (IntGate 1 has DPL=3)</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;  2) Say bye to antisoftice tricks  (BoundsChecker and CreateFile)</span><span class="sc0">
</span><span class="sc1">;  - by patching *ice files</span><span class="sc0">
</span><span class="sc1">;    a) WinICE:</span><span class="sc0">
</span><span class="sc1">;       - find string "KHCB" in winice.exe and replace it by something new</span><span class="sc0">
</span><span class="sc1">;       - find string "SICE" in winice.exe and nmtrans.dll</span><span class="sc0">
</span><span class="sc1">;   and replace it by something new</span><span class="sc0">
</span><span class="sc1">;    b) NTice:</span><span class="sc0">
</span><span class="sc1">;       - find string "KHCB" in ntice.sys and replace it by something new</span><span class="sc0">
</span><span class="sc1">;       - find UNICODE string "DosDevices\NTice" in ntice.sys (it will look</span><span class="sc0">
</span><span class="sc1">;   like "D o s D e v i ..") and change "NTice" to something new,</span><span class="sc0">
</span><span class="sc1">;   find string "NTICE" in nmtrans.dll and replace it by something new</span><span class="sc0">
</span><span class="sc1">;       - update ntice.sys's checksum</span><span class="sc0">
</span><span class="sc1">;  - of course update BoundsChecker itself</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; ------------------------------------------------------------------------------</span><span class="sc0">
</span><span class="sc1">;  $</span><span class="sc0">


</span><span class="sc2">.586P</span><span class="sc0">
</span><span class="sc9">.MODEL</span><span class="sc0"> </span><span class="sc10">FLAT</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">STDCALL</span><span class="sc0">

 </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">MessageBeep</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
 </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">

 </span><span class="sc9">INCLUDE</span><span class="sc0"> </span><span class="sc5">ETricks.INC</span><span class="sc0">

</span><span class="sc9">.CODE</span><span class="sc0">
 </span><span class="sc5">START</span><span class="sc4">:</span><span class="sc0">

 </span><span class="sc1">; when you need to distinguish platform</span><span class="sc0">
 </span><span class="sc1">; CALL  GetVersion        ; or  MOV EAX,DS</span><span class="sc0">
 </span><span class="sc1">; TEST  EAX,EAX           ;     TEST AL,4   ; No LDT under NT</span><span class="sc0">
 </span><span class="sc1">; JS    Win9XPresent      ;     SETNE Win9XPresent</span><span class="sc0">



 </span><span class="sc1">; prepare xFrame structure in stack:</span><span class="sc0">

 </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">MyxScope</span><span class="sc0">             </span><span class="sc1">; not needed usually -1, here for illustration</span><span class="sc0">
 </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">MyxTable</span><span class="sc0">      </span><span class="sc1">; not needed           , here for illustration</span><span class="sc0">
 </span><span class="sc6">SUB</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">             </span><span class="sc1">; offset 0</span><span class="sc0">
 </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">MyxHandler</span><span class="sc0">    </span><span class="sc1">; it's me</span><span class="sc0">
 </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">FS</span><span class="sc4">:[</span><span class="sc8">EAX</span><span class="sc4">]</span><span class="sc0">   </span><span class="sc1">; ptr on first xFrame structure, FS:0 very popular</span><span class="sc0">
                           </span><span class="sc1">; execute command xframe in softice ..@</span><span class="sc0">
 </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">FS</span><span class="sc4">:[</span><span class="sc8">EAX</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">ESP</span><span class="sc0">    </span><span class="sc1">; i'm in chain now</span><span class="sc0">

</span><span class="sc5">@0</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EAX</span><span class="sc4">]</span><span class="sc0">       </span><span class="sc1">; violate!</span><span class="sc0">
 </span><span class="sc1">; or you can use</span><span class="sc0">
 </span><span class="sc1">; MOV  EAX,-1         ; or another nonsens</span><span class="sc0">
 </span><span class="sc1">; MOV  GS,EAX         ; or other Sreg</span><span class="sc0">

 </span><span class="sc1">; these are (the only) "95&amp;NT common" ACCESS_VIOLATIONs</span><span class="sc0">
 </span><span class="sc1">; because under:</span><span class="sc0">
 </span><span class="sc1">; 1) Win95 are some CPL0 instructions and CLI/STI emulated/ignored and</span><span class="sc0">
 </span><span class="sc1">;    some (L?DT,LTR,cache manipulation) cause ACCESS_VIOLATION</span><span class="sc0">
 </span><span class="sc1">; 2) WinNT cause all CPL0 AND CLI/STI instructions PRIVILEGED_INSTRUCTION</span><span class="sc0">
 
 </span><span class="sc6">JMP</span><span class="sc0">  </span><span class="sc5">@0</span><span class="sc0">


</span><span class="sc5">@2</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">PUSHFD</span><span class="sc0">
 </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">JMPTable</span><span class="sc0">
</span><span class="sc5">@BPT1</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">PUSHFD</span><span class="sc0">
 </span><span class="sc6">POP</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc0">
 </span><span class="sc6">OR</span><span class="sc0">   </span><span class="sc8">AH</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
 </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
 </span><span class="sc6">POPFD</span><span class="sc0">
 </span><span class="sc1">;running line here</span><span class="sc0">

 </span><span class="sc6">POPFD</span><span class="sc0">
 </span><span class="sc6">JMP</span><span class="sc0">  </span><span class="sc5">@2</span><span class="sc0">


</span><span class="sc5">@6</span><span class="sc4">:</span><span class="sc0">
                           </span><span class="sc1">; ..@ and execute command xframe here       </span><span class="sc0">
 </span><span class="sc6">POP</span><span class="sc0">  </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">FS</span><span class="sc4">:</span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">; restore old ptr</span><span class="sc0">
 </span><span class="sc6">ADD</span><span class="sc0">  </span><span class="sc8">ESP</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">3</span><span class="sc0">          </span><span class="sc1">; pro forma restore init stack</span><span class="sc0">

 </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">MessageBeep</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">       </span><span class="sc1">; you should hear something if all was successful</span><span class="sc0">
 </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">       </span><span class="sc1">; bye Kafka</span><span class="sc0">


</span><span class="sc5">@3</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">SUB</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc8">EAX</span><span class="sc0">
 </span><span class="sc6">DIV</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc0">
 </span><span class="sc6">JMP</span><span class="sc0">  </span><span class="sc5">@3</span><span class="sc0">


</span><span class="sc5">@5</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">BOUND</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc5">Bound4</span><span class="sc0">
 </span><span class="sc6">JMP</span><span class="sc0">   </span><span class="sc5">@5</span><span class="sc0">


</span><span class="sc5">@1</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">NOP</span><span class="sc0">
</span><span class="sc5">@BPT0</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">NOP</span><span class="sc0">
 </span><span class="sc6">INT</span><span class="sc0">  </span><span class="sc2">3</span><span class="sc0">            </span><span class="sc1">; ICEBP (0F1H) I can't recommend - it's undocummented</span><span class="sc0">
 </span><span class="sc6">JMP</span><span class="sc0">  </span><span class="sc5">@1</span><span class="sc0">           </span><span class="sc1">; and handled differently by different CPUs</span><span class="sc0">


</span><span class="sc5">@4</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">INC</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc0">
 </span><span class="sc6">ROR</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc2">1</span><span class="sc0">
 </span><span class="sc6">INTO</span><span class="sc0">
 </span><span class="sc6">JMP</span><span class="sc0">  </span><span class="sc5">@4</span><span class="sc0">
</span><span class="sc1">;------------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">MyxHandler</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0"> </span><span class="sc10">C</span><span class="sc0">          </span><span class="sc1">; aka "try-except exception handler" </span><span class="sc0">
                           </span><span class="sc1">; handler of handlers</span><span class="sc0">

 </span><span class="sc10">USES</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">    </span><span class="sc1">; these registers should be preserved</span><span class="sc0">

 </span><span class="sc5">ARG</span><span class="sc0">  </span><span class="sc5">EXCEPTION_REC_ptr</span><span class="sc0">    </span><span class="sc1">; ok</span><span class="sc0">
 </span><span class="sc5">ARG</span><span class="sc0">  </span><span class="sc5">xFrame</span><span class="sc0">           </span><span class="sc1">; aka exception_registration</span><span class="sc0">
 </span><span class="sc5">ARG</span><span class="sc0">  </span><span class="sc5">CONTEXT_ptr</span><span class="sc0">      </span><span class="sc1">; ok</span><span class="sc0">
 </span><span class="sc5">ARG</span><span class="sc0">  </span><span class="sc5">DispatcherContext</span><span class="sc0">    </span><span class="sc1">; ??</span><span class="sc0">

 </span><span class="sc6">CLD</span><span class="sc0">
 </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">JMPPtr</span><span class="sc0">
 </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">EXCEPTION_REC_ptr</span><span class="sc0">
 </span><span class="sc6">IMUL</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">SIZE</span><span class="sc0"> </span><span class="sc5">HelpStruc</span><span class="sc0">
 </span><span class="sc6">INC</span><span class="sc0">       </span><span class="sc5">JMPPtr</span><span class="sc0">
 </span><span class="sc6">ADD</span><span class="sc0">  </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">JMPTable</span><span class="sc0">
 </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CONTEXT_ptr</span><span class="sc0">
 </span><span class="sc6">LODSD</span><span class="sc0">
 </span><span class="sc6">CMP</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">EBX</span><span class="sc4">]</span><span class="sc5">.ExceptionCode</span><span class="sc0"> </span><span class="sc1">; code (type) of exception</span><span class="sc0">
 </span><span class="sc6">JNE</span><span class="sc0">  </span><span class="sc5">GoUnhandled</span><span class="sc0">
 </span><span class="sc6">LODSD</span><span class="sc0">
 </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc5">.cx_ContextFlags</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">CONTEXT_CONTROL</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">CONTEXT_INTEGER</span><span class="sc0"> \
                 </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">CONTEXT_SEGMENTS</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">CONTEXT_DEBUG_REGISTERS</span><span class="sc0">
               </span><span class="sc1">; (everything but FPU, 10017H) - what will be updated</span><span class="sc0">
 </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc4">[</span><span class="sc8">EDI</span><span class="sc4">]</span><span class="sc5">.cx_Eip</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
 </span><span class="sc6">ADD</span><span class="sc0">  </span><span class="sc8">EDI</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">cx_Dr0</span><span class="sc0">
 </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc8">ECX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc2">6</span><span class="sc0">
 </span><span class="sc6">REP</span><span class="sc0">  </span><span class="sc6">MOVSD</span><span class="sc0">
 </span><span class="sc1">; CRC check here to eliminate bpx</span><span class="sc0">

 </span><span class="sc6">SUB</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc0">        </span><span class="sc1">; return code is important; 0, 1, 2</span><span class="sc0">
 </span><span class="sc6">JMP</span><span class="sc0">  </span><span class="sc5">Okay</span><span class="sc0">                 </span><span class="sc1">; 0 - ok, I handled this exception</span><span class="sc0">

                           </span><span class="sc1">; _VWIN32_Set_Thread_Context or </span><span class="sc0">
                           </span><span class="sc1">; NTCALL 13H will be called</span><span class="sc0">
                           </span><span class="sc1">; I think hooking of those services could be good </span><span class="sc0">
                           </span><span class="sc1">; idea for an intelligent debugger </span><span class="sc0">

                           </span><span class="sc1">; 1 - no I can't handle it; control is passed to the</span><span class="sc0">
                           </span><span class="sc1">; xHandler of next xFrame in chain </span><span class="sc0">
                           </span><span class="sc1">; 2 - similar to 1 </span><span class="sc0">
</span><span class="sc5">GoUnhandled</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">SUB</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc0">
 </span><span class="sc6">INC</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc0">          </span><span class="sc1">; &gt;2 INVALID_DISPOSITION?</span><span class="sc0">

</span><span class="sc5">Okay</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">RET</span><span class="sc0">
</span><span class="sc5">MyxHandler</span><span class="sc0"> </span><span class="sc9">ENDP</span><span class="sc0">

</span><span class="sc1">; for illustration</span><span class="sc0">
</span><span class="sc5">filter0</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">filter1</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">filter2</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">filter3</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">filter4</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">SUB</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
 </span><span class="sc6">DEC</span><span class="sc0">  </span><span class="sc8">EAX</span><span class="sc0">
</span><span class="sc5">handler0</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">handler1</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">handler2</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">handler3</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">handler4</span><span class="sc4">:</span><span class="sc0">
 </span><span class="sc6">RET</span><span class="sc0">
 


</span><span class="sc1">;------------------------------------------------------------------------------</span><span class="sc0">


</span><span class="sc9">.DATA</span><span class="sc0">

</span><span class="sc5">HelpStruc</span><span class="sc0">      </span><span class="sc9">STRUC</span><span class="sc0">
 </span><span class="sc5">ExcCode</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">@Label</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">_DR0</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">_DR1</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">_DR2</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">_DR3</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">_DR6</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
 </span><span class="sc5">_DR7</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">HelpStruc</span><span class="sc0">      </span><span class="sc9">ENDS</span><span class="sc0">

</span><span class="sc5">JMPPtr</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

</span><span class="sc5">JMPTable</span><span class="sc0">       </span><span class="sc9">LABEL</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0">
 </span><span class="sc5">HelpStruc</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc5">STATUS_ACCESS_VIOLATION</span><span class="sc4">,</span><span class="sc5">@1</span><span class="sc4">,\
</span><span class="sc0">        </span><span class="sc5">@BPT0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc5">M_LE</span><span class="sc4">+</span><span class="sc5">M_DR0</span><span class="sc4">+</span><span class="sc5">M_INSTR0</span><span class="sc4">&gt;</span><span class="sc0">

 </span><span class="sc5">HelpStruc</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc5">STATUS_SINGLE_STEP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">@BPT0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">    </span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">&gt;</span><span class="sc0">

 </span><span class="sc5">HelpStruc</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc5">STATUS_BREAKPOINT</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">@2</span><span class="sc4">,\
</span><span class="sc0">        </span><span class="sc5">JMPTable</span><span class="sc4">,</span><span class="sc5">START</span><span class="sc4">,</span><span class="sc5">@BPT1</span><span class="sc4">,</span><span class="sc5">MyxHandler</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc5">M_LE</span><span class="sc4">+</span><span class="sc5">M_DR0</span><span class="sc4">+</span><span class="sc5">M_DR1</span><span class="sc4">+</span><span class="sc5">M_DR2</span><span class="sc4">+</span><span class="sc5">M_DR3\
</span><span class="sc0">        </span><span class="sc4">+</span><span class="sc5">M_RW0</span><span class="sc4">+</span><span class="sc5">M_RW1</span><span class="sc4">+</span><span class="sc5">M_RW2</span><span class="sc4">+</span><span class="sc5">M_RW3</span><span class="sc4">&gt;</span><span class="sc0">  </span><span class="sc1">; &gt;&gt;ANTI-VOYEUR&lt;&lt;</span><span class="sc0">

 </span><span class="sc5">HelpStruc</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc5">STATUS_SINGLE_STEP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">@BPT1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">    </span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">&gt;</span><span class="sc0">

 </span><span class="sc5">HelpStruc</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc5">STATUS_SINGLE_STEP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">@3</span><span class="sc0">   </span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">    </span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">&gt;</span><span class="sc0">

 </span><span class="sc1">;additional</span><span class="sc0">
 </span><span class="sc5">HelpStruc</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc5">STATUS_INTEGER_DIVIDE_BY_ZERO</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">@4</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">&gt;</span><span class="sc0">
 </span><span class="sc5">HelpStruc</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc5">STATUS_INTEGER_OVERFLOW</span><span class="sc4">,</span><span class="sc0">       </span><span class="sc5">@5</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">&gt;</span><span class="sc0">
 </span><span class="sc5">HelpStruc</span><span class="sc0">     </span><span class="sc4">&lt;</span><span class="sc5">STATUS_ARRAY_BOUNDS_EXCEEDED</span><span class="sc4">,</span><span class="sc0">  </span><span class="sc5">@6</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">&gt;</span><span class="sc0">

 </span><span class="sc5">Bound4</span><span class="sc0">        </span><span class="sc9">DQ</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">

 </span><span class="sc1">; for illustration</span><span class="sc0">
 </span><span class="sc5">MyxScope</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc0">                    </span><span class="sc1">; index 2</span><span class="sc0">
 </span><span class="sc5">MyxTable</span><span class="sc0">      </span><span class="sc9">LABEL</span><span class="sc0">    </span><span class="sc5">xTable_RECORD</span><span class="sc0">   </span><span class="sc1">; array of 5 xTable_RECORDs</span><span class="sc0">
 </span><span class="sc5">xTable_RECORD</span><span class="sc0"> </span><span class="sc4">&lt;-</span><span class="sc2">1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">filter0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">handler0</span><span class="sc4">&gt;</span><span class="sc0">  </span><span class="sc1">; 0</span><span class="sc0">
 </span><span class="sc5">xTable_RECORD</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc0"> </span><span class="sc2">3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">filter1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">handler1</span><span class="sc4">&gt;</span><span class="sc0">  </span><span class="sc1">; 1</span><span class="sc0">
 </span><span class="sc5">xTable_RECORD</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">filter2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">handler2</span><span class="sc4">&gt;</span><span class="sc0">  </span><span class="sc1">; 2 MyxScope points to this</span><span class="sc0">
 </span><span class="sc5">xTable_RECORD</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">filter3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">handler3</span><span class="sc4">&gt;</span><span class="sc0">  </span><span class="sc1">; 3</span><span class="sc0">
 </span><span class="sc5">xTable_RECORD</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">filter4</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">handler4</span><span class="sc4">&gt;</span><span class="sc0">  </span><span class="sc1">; 4</span><span class="sc0">
 </span><span class="sc1">; xFrame.xScope=2 -&gt; 4 -&gt; 1 -&gt; 3 -&gt; 0</span><span class="sc0">

</span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">START</span><span class="sc0">

</span><span class="sc4">------------------------------------------------------------------------------</span><span class="sc0">









                    </span><span class="sc5">It</span><span class="sc0"> </span><span class="sc5">was</span><span class="sc0">
                  </span><span class="sc5">fILTER</span><span class="sc4">/</span><span class="sc5">W</span><span class="sc0"> #</span><span class="sc2">1</span><span class="sc0">
                      </span><span class="sc5">by</span><span class="sc0">
                                 </span><span class="sc5">elicz@email.cz</span><span class="sc0">








</span><span class="sc4">------------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc4">:</span><span class="sc5">TRANSLATE</span><span class="sc0">
</span><span class="sc5">@ECHO</span><span class="sc0"> </span><span class="sc5">OFF</span><span class="sc0">
</span><span class="sc5">TASM</span><span class="sc0">  </span><span class="sc4">/</span><span class="sc5">M</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">Q</span><span class="sc0"> </span><span class="sc4">/</span><span class="sc5">T</span><span class="sc0">  </span><span class="sc5">ETricks.BAT</span><span class="sc0">
</span><span class="sc5">REM</span><span class="sc0"> </span><span class="sc5">WLINK</span><span class="sc0"> </span><span class="sc5">FORMAT</span><span class="sc0"> </span><span class="sc5">Windows</span><span class="sc0"> </span><span class="sc5">NT</span><span class="sc0"> </span><span class="sc5">FILE</span><span class="sc0"> </span><span class="sc5">ETricks</span><span class="sc0">  </span><span class="sc5">@ETricks.IMP</span><span class="sc0">
</span><span class="sc5">REM</span><span class="sc0"> </span><span class="sc5">LINK386</span><span class="sc0">     </span><span class="sc5">ETricks</span><span class="sc4">,,,,</span><span class="sc5">ETricks</span><span class="sc0">
</span><span class="sc5">TLINK32</span><span class="sc0">         </span><span class="sc5">ETricks</span><span class="sc4">,,,,</span><span class="sc5">ETricks</span><span class="sc0">
</span><span class="sc5">DEL</span><span class="sc0">             </span><span class="sc5">ETricks.OBJ</span></div></body>
</html>
