<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>SEH.inc</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;*******************************************************************************</span><span class="sc0">


</span><span class="sc1">;this file contains information, constants and structures needed for SEH coding</span><span class="sc0">
</span><span class="sc1">;it's designed for Borland Turbo Assembler (v4.0+, MASM mode)</span><span class="sc0">

</span><span class="sc1">;Usage: INCLUDE SEH.inc</span><span class="sc0">


</span><span class="sc1">;----------------------------------documented-----------------------------------</span><span class="sc0">

</span><span class="sc5">_CONTEXT</span><span class="sc0">            </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">cx_ContextFlags</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc1">;CONTEXT_DEBUG_REGISTERS</span><span class="sc0">
</span><span class="sc5">cx_Dr0</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;04</span><span class="sc0">
</span><span class="sc5">cx_Dr1</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;08</span><span class="sc0">
</span><span class="sc5">cx_Dr2</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;0C</span><span class="sc0">
</span><span class="sc5">cx_Dr3</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;10</span><span class="sc0">
</span><span class="sc5">cx_Dr6</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;14</span><span class="sc0">
</span><span class="sc5">cx_Dr7</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;18</span><span class="sc0">

</span><span class="sc1">;CONTEXT_FLOATING_POINT</span><span class="sc0">
</span><span class="sc5">cx_ControlWord</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_StatusWord</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_TagWord</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_ErrorOffset</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_ErrorSelector</span><span class="sc0">        </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_DataOffset</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">cx_DataSelector</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
</span><span class="sc5">SIZE_OF_80387_REGISTERS</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">80</span><span class="sc0">
</span><span class="sc5">cx_RegisterArea</span><span class="sc0">         </span><span class="sc9">DB</span><span class="sc0"> </span><span class="sc5">SIZE_OF_80387_REGISTERS</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">cx_Cr0NpxState</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">

</span><span class="sc1">;CONTEXT_SEGMENTS</span><span class="sc0">
</span><span class="sc5">cx_SegGs</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;8C</span><span class="sc0">
</span><span class="sc5">cx_SegFs</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;90</span><span class="sc0">
</span><span class="sc5">cx_SegEs</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;94</span><span class="sc0">
</span><span class="sc5">cx_SegDs</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;98</span><span class="sc0">

</span><span class="sc1">;CONTEXT_INTEGER</span><span class="sc0">
</span><span class="sc5">cx_Edi</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;9C</span><span class="sc0">
</span><span class="sc5">cx_Esi</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;A0</span><span class="sc0">
</span><span class="sc5">cx_Ebx</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;A4</span><span class="sc0">
</span><span class="sc5">cx_Edx</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;A8</span><span class="sc0">
</span><span class="sc5">cx_Ecx</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;AC</span><span class="sc0">
</span><span class="sc5">cx_Eax</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;B0</span><span class="sc0">

</span><span class="sc1">;CONTEXT_CONTROL</span><span class="sc0">
</span><span class="sc5">cx_Ebp</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;B4</span><span class="sc0">
</span><span class="sc5">cx_Eip</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;B8</span><span class="sc0">
</span><span class="sc5">cx_SegCs</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;BC</span><span class="sc0">
</span><span class="sc5">cx_EFlags</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;C0</span><span class="sc0">
</span><span class="sc5">cx_Esp</span><span class="sc0">              </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;C4</span><span class="sc0">
</span><span class="sc5">cx_SegSs</span><span class="sc0">            </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">         </span><span class="sc1">;C8</span><span class="sc0">
</span><span class="sc5">_CONTEXT</span><span class="sc0">            </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">;size of CONTEXT is 0CCH bytes</span><span class="sc0">


</span><span class="sc1">;---cx_ContextFlags { used by _VWIN32_Set_Thread_Context(95) or NTCALL 13H(NT) }</span><span class="sc0">
</span><span class="sc5">CONTEXT_i386</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000010000H</span><span class="sc0">
</span><span class="sc5">CONTEXT_i486</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000010000H</span><span class="sc0">
</span><span class="sc5">CONTEXT_CONTROL</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CONTEXT_i386</span><span class="sc4">+</span><span class="sc2">00000001H</span><span class="sc0">
</span><span class="sc5">CONTEXT_INTEGER</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CONTEXT_i386</span><span class="sc4">+</span><span class="sc2">00000002H</span><span class="sc0">
</span><span class="sc5">CONTEXT_SEGMENTS</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CONTEXT_i386</span><span class="sc4">+</span><span class="sc2">00000004H</span><span class="sc0">
</span><span class="sc5">CONTEXT_FLOATING_POINT</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CONTEXT_i386</span><span class="sc4">+</span><span class="sc2">00000008H</span><span class="sc0">
</span><span class="sc5">CONTEXT_DEBUG_REGISTERS</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CONTEXT_i386</span><span class="sc4">+</span><span class="sc2">00000010H</span><span class="sc0">

</span><span class="sc1">;there is a bug (+ instead of OR) in W32Main.inc (from Walk32 package) in EQU</span><span class="sc0">
</span><span class="sc1">;for CONTEXT_FULL, so better (when you don't need to update debug registers</span><span class="sc0">
</span><span class="sc1">;and FPU) use</span><span class="sc0">
</span><span class="sc5">CONTEXT_NORMAL</span><span class="sc0">                  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CONTEXT_CONTROL</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">CONTEXT_INTEGER</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> \
                                    </span><span class="sc5">CONTEXT_SEGMENTS</span><span class="sc0">

</span><span class="sc5">CONTEXT_ALL</span><span class="sc0">                     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc5">CONTEXT_CONTROL</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">CONTEXT_INTEGER</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> \
                                    </span><span class="sc5">CONTEXT_SEGMENTS</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">CONTEXT_FLOATING_POINT</span><span class="sc0"> \
                                    </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">CONTEXT_DEBUG_REGISTERS</span><span class="sc0">  
</span><span class="sc1">;note that CONTEXT_ALL (01001FH) is in cx_ContextFlags by default!</span><span class="sc0">

</span><span class="sc1">;-------------------------------------------------------------------------------</span><span class="sc0">

</span><span class="sc5">_EXCEPTION_POINTERS</span><span class="sc0">             </span><span class="sc9">STRUC</span><span class="sc0"> </span><span class="sc1">;parameter of top-level exception handler</span><span class="sc0">
        </span><span class="sc5">ExceptionRecord</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;pointer to _EXCEPTION_RECORD</span><span class="sc0">
        </span><span class="sc5">ContextRecord</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;pointer to _CONTEXT</span><span class="sc0">
</span><span class="sc5">_EXCEPTION_POINTERS</span><span class="sc0">             </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">;size of _EXCEPTION_POINTERS is 008H bytes</span><span class="sc0">


</span><span class="sc5">_EXCEPTION_RECORD</span><span class="sc0">       </span><span class="sc9">STRUC</span><span class="sc0">
    </span><span class="sc5">ExceptionCode</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">ExceptionFlags</span><span class="sc0">      </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">             
    </span><span class="sc5">NextExceptionRecord</span><span class="sc0"> </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">;pointer (for nested exceptions)</span><span class="sc0">
    </span><span class="sc5">ExceptionAddress</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">NumberParameters</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">EXCEPTION_MAXIMUM_PARAMETERS</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">15</span><span class="sc0">     
    </span><span class="sc5">ExceptionInformation</span><span class="sc0">    </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc5">EXCEPTION_MAXIMUM_PARAMETERS</span><span class="sc0"> </span><span class="sc9">DUP</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">_EXCEPTION_RECORD</span><span class="sc0">       </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">;size of _EXCEPTION_RECORD is 014H..050H bytes</span><span class="sc0">

</span><span class="sc1">;---ExceptionInformation for EXCEPTION_ACCESS_VIOLATION</span><span class="sc0">
</span><span class="sc1">;NumberParameters = 2</span><span class="sc0">
</span><span class="sc1">;ExceptionInformation[0] = ACCESS_VIOLATION_READ or ACCESS_VIOLATION_WRITE</span><span class="sc0">
</span><span class="sc1">;ExceptionInformation[1] = virtual address of inaccessible data</span><span class="sc0">
</span><span class="sc1">;                          (Win95 usually = -1)  </span><span class="sc0">
 </span><span class="sc5">ACCESS_VIOLATION_READ</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000000H</span><span class="sc0">  </span><span class="sc1">; for CMP instruction</span><span class="sc0">
 </span><span class="sc5">ACCESS_VIOLATION_WRITE</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000001H</span><span class="sc0">
</span><span class="sc1">;of course it's true for NT only</span><span class="sc0">
</span><span class="sc1">;in 95 is all READ ! :(</span><span class="sc0">

</span><span class="sc1">;---ExceptionInformation passed by RaiseException function</span><span class="sc0">
</span><span class="sc1">;it's up to you </span><span class="sc0">

</span><span class="sc1">;RaisedExceptionCode has bit 28 set to 0 by system, hence</span><span class="sc0">
</span><span class="sc5">RaisedExceptionCodeMask</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0EFFFFFFFH</span><span class="sc0">  </span><span class="sc1">; for AND instruction</span><span class="sc0">
</span><span class="sc1">;of course it's true for NT only</span><span class="sc0">
</span><span class="sc1">;in 95 is not ExceptionCode changed ! :(</span><span class="sc0">

</span><span class="sc1">;other exceptions have some "information" too, but you can't believe it</span><span class="sc0">
</span><span class="sc1">;(for example breakpoint(in 95) has 1 parameter (usually), while</span><span class="sc0">
</span><span class="sc1">; breakpoint(in NT) has 3 parameters; they contain trash)</span><span class="sc0">


</span><span class="sc1">;---ExceptionFlags   for TEST, AND  or CMP instructions</span><span class="sc0">
</span><span class="sc5">EXCEPTION_CONTINUABLE</span><span class="sc0">              </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000000H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_NONCONTINUABLE</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000001H</span><span class="sc0">
</span><span class="sc5">UNWIND_STACK</span><span class="sc0">                       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000006H</span><span class="sc0">   </span><span class="sc1">; ? </span><span class="sc0">

</span><span class="sc1">;---ExceptionCodes   for CMP  instruction</span><span class="sc0">
</span><span class="sc5">EXCEPTION_WAIT_0</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000000H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_ABANDONED_WAIT_0</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000080H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_USER_APC</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0000000C0H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_TIMEOUT</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000102H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_PENDING</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000103H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_SEGMENT_NOTIFICATION</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">040000005H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_GUARD_PAGE_VIOLATION</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">080000001H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_DATATYPE_MISALIGNMENT</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">080000002H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_BREAKPOINT</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">080000003H</span><span class="sc0">   </span><span class="sc1">; exception 3</span><span class="sc0">
</span><span class="sc5">EXCEPTION_SINGLE_STEP</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">080000004H</span><span class="sc0">   </span><span class="sc1">; exception 1</span><span class="sc0">
</span><span class="sc5">EXCEPTION_ACCESS_VIOLATION</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000005H</span><span class="sc0">   </span><span class="sc1">; typically exception 13</span><span class="sc0">
</span><span class="sc5">EXCEPTION_IN_PAGE_ERROR</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000006H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_NO_MEMORY</span><span class="sc0">        </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000017H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_ILLEGAL_INSTRUCTION</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000001DH</span><span class="sc0">
</span><span class="sc5">EXCEPTION_NONCONTINUABLE_EXCEPTION</span><span class="sc0"> </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000025H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_INVALID_DISPOSITION</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000026H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_ARRAY_BOUNDS_EXCEEDED</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000008CH</span><span class="sc0">   </span><span class="sc1">; exception 5</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLOAT_DENORMAL_OPERAND</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000008DH</span><span class="sc0">   
</span><span class="sc5">EXCEPTION_FLT_DENORMAL_OPERAND</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000008DH</span><span class="sc0">   
</span><span class="sc5">EXCEPTION_FLOAT_DIVIDE_BY_ZERO</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000008EH</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_DIVIDE_BY_ZERO</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000008EH</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLOAT_INEXACT_RESULT</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000008FH</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_INEXACT_RESULT</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000008FH</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLOAT_INVALID_OPERATION</span><span class="sc0">  </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000090H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_INVALID_OPERATION</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000090H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLOAT_OVERFLOW</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000091H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_OVERFLOW</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000091H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLOAT_STACK_CHECK</span><span class="sc0">    </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000092H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_STACK_CHECK</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000092H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLOAT_UNDERFLOW</span><span class="sc0">      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000093H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_FLT_UNDERFLOW</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000093H</span><span class="sc0">
</span><span class="sc5">EXCEPTION_INTEGER_DIVIDE_BY_ZERO</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000094H</span><span class="sc0">   </span><span class="sc1">; exception 0</span><span class="sc0">
</span><span class="sc5">EXCEPTION_INT_DIVIDE_BY_ZERO</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000094H</span><span class="sc0">   
</span><span class="sc5">EXCEPTION_INTEGER_OVERFLOW</span><span class="sc0">     </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000095H</span><span class="sc0">   </span><span class="sc1">; exception 4</span><span class="sc0">
</span><span class="sc5">EXCEPTION_INT_OVERFLOW</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000095H</span><span class="sc0">   
</span><span class="sc5">EXCEPTION_PRIVILEGED_INSTRUCTION</span><span class="sc0">   </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000096H</span><span class="sc0">   </span><span class="sc1">; typically exception 13</span><span class="sc0">
</span><span class="sc5">EXCEPTION_PRIV_INSTRUCTION</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C0000096H</span><span class="sc0">   
</span><span class="sc5">EXCEPTION_STACK_OVERFLOW</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C00000FDH</span><span class="sc0">
</span><span class="sc5">EXCEPTION_CONTROL_C_EXIT</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0C000013AH</span><span class="sc0">

</span><span class="sc1">; there are many other STATUSes (watch code in NTice)</span><span class="sc0">


</span><span class="sc1">;---SEH API functions</span><span class="sc0">
</span><span class="sc1">; AbnormalTermination              ;doesn't exist, interpreted as C++ keyword</span><span class="sc0">
</span><span class="sc1">; GetExceptionCode                 ;doesn't exist, interpreted as C++ keyword</span><span class="sc0">
</span><span class="sc1">; GetExceptionInformation          ;doesn't exist, interpreted as C++ keyword</span><span class="sc0">
</span><span class="sc1">; UnhandledExceptionFilter         ;exists; called from kernel xFrame.filter</span><span class="sc0">

</span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc10">STDCALL</span><span class="sc0"> </span><span class="sc5">RaiseException</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">                   </span><span class="sc1">; has 4 parameters:</span><span class="sc0">
</span><span class="sc1">; 1st parameter is ExceptionCode   ;see _EXCEPTION_RECORD</span><span class="sc0">
</span><span class="sc1">; 2nd parameter is ExceptionFlags</span><span class="sc0">
</span><span class="sc1">; 3rd parameter is NumberParameters</span><span class="sc0">
</span><span class="sc1">; 4th parameter points to ExceptionInformation </span><span class="sc0">

</span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc10">STDCALL</span><span class="sc0"> </span><span class="sc5">SetUnhandledExceptionFilter</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">      </span><span class="sc1">; has 1 parameter:</span><span class="sc0">
</span><span class="sc1">; 1st parameter points to top-level exception handler</span><span class="sc0">

</span><span class="sc1">; additional:</span><span class="sc0">
</span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc10">STDCALL</span><span class="sc0"> </span><span class="sc5">SetErrorMode</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">                     </span><span class="sc1">; has 1 parameter:</span><span class="sc0">
</span><span class="sc5">SEM_FAILCRITICALERRORS</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000001H</span><span class="sc0">
</span><span class="sc5">SEM_NOGPFAULTERRORBOX</span><span class="sc0">              </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000002H</span><span class="sc0">   </span><span class="sc1">; quiet exit vs. ErrorBox</span><span class="sc0">
</span><span class="sc5">SEM_NOALIGNMENTFAULTEXCEPT</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">000000004H</span><span class="sc0">   </span><span class="sc1">; no effect on x86</span><span class="sc0">
</span><span class="sc5">SEM_NOOPENFILEERRORBOX</span><span class="sc0">             </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">080000000H</span><span class="sc0">
</span><span class="sc1">; default ErrorMode is 0 </span><span class="sc0">

</span><span class="sc1">;---return codes for top-level exception handler   (EAX)</span><span class="sc0">
</span><span class="sc5">EXCEPTION_CONTINUE_EXECUTION</span><span class="sc0">       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">EXCEPTION_CONTINUE_SEARCH</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0"> 
</span><span class="sc5">EXCEPTION_EXECUTE_HANDLER</span><span class="sc0">          </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0"> 

</span><span class="sc1">;---return codes for try-except exception handler  (EAX)</span><span class="sc0">
</span><span class="sc5">ExceptionContinueExecution</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc2">0</span><span class="sc0">
</span><span class="sc5">ExceptionContinueSearch</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">ExceptionNestedException</span><span class="sc0">           </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc2">2</span><span class="sc0">
</span><span class="sc5">ExceptionCollidedUnwind</span><span class="sc0">            </span><span class="sc9">EQU</span><span class="sc0">  </span><span class="sc2">3</span><span class="sc0">




</span><span class="sc1">;----------------------------------my research----------------------------------</span><span class="sc0">

</span><span class="sc5">_xFrame_RECORD</span><span class="sc0">          </span><span class="sc9">STRUC</span><span class="sc0"> 
       </span><span class="sc5">NextxFrame</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; pointer or -1 for last member</span><span class="sc0">
       </span><span class="sc5">xHandler</span><span class="sc0">         </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; pointer to code</span><span class="sc0">
       </span><span class="sc5">xTable</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; pointer to xTableArray</span><span class="sc0">
       </span><span class="sc5">xScope</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; 1st index of _xTable_RECORD or -1 for end</span><span class="sc0">
</span><span class="sc5">_xFrame_RECORD</span><span class="sc0">          </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">; size of _xFrame_RECORD = 010H bytes</span><span class="sc0">

</span><span class="sc1">; xTableArray           _xTable_RECORD  MAX_xTable_RECORDs  DUP (?)</span><span class="sc0">

</span><span class="sc5">_xTable_RECORD</span><span class="sc0">          </span><span class="sc9">STRUC</span><span class="sc0">
       </span><span class="sc5">NextxScope</span><span class="sc0">       </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; index of next xTable_RECORD or -1 for end</span><span class="sc0">
       </span><span class="sc5">filter</span><span class="sc0">           </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; pointer to code</span><span class="sc0">
       </span><span class="sc5">handler</span><span class="sc0">          </span><span class="sc9">DD</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">  </span><span class="sc1">; pointer to code</span><span class="sc0">
</span><span class="sc5">_xTable_RECORD</span><span class="sc0">          </span><span class="sc9">ENDS</span><span class="sc0">
</span><span class="sc1">; size of _xTable_RECORD = 00CH bytes</span><span class="sc0">

</span><span class="sc1">; xTable, xScope and _xTable_RECORD are used by kernel try-except exception</span><span class="sc0">
</span><span class="sc1">; handler only (or by C startup codes)</span><span class="sc0">

</span><span class="sc1">; for new thread is constructed NEW kernel xFrame with xScope=0; </span><span class="sc0">
</span><span class="sc1">; xTable_RECORD's filter  calls UnhandledExceptionFilter and  handler </span><span class="sc0">
</span><span class="sc1">; calls ExitProcess or ExitThread</span><span class="sc0">

</span><span class="sc1">;---constants for xScope, NextxScope and NextxFrame</span><span class="sc0">
</span><span class="sc1">;searching for filter function stops when xScope or NextxScope has this value:</span><span class="sc0">
</span><span class="sc5">xScopeEnd</span><span class="sc0">                       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">
</span><span class="sc1">; when xTable points to nonexisting region (i.e. xTable = -2)</span><span class="sc0">
</span><span class="sc1">; softice's xframe says : (local unwind) </span><span class="sc0">

</span><span class="sc1">;searching for xFrame stops when NextxFrame has this value:</span><span class="sc0">
</span><span class="sc5">xFrameEnd</span><span class="sc0">                       </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc4">-</span><span class="sc2">1</span><span class="sc0">

</span><span class="sc1">;---pointer to the 1st xFrame_RECORD</span><span class="sc0">
</span><span class="sc5">xFrameHead</span><span class="sc0">                      </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc8">FS</span><span class="sc4">:</span><span class="sc2">0</span><span class="sc0">


</span><span class="sc1">;---procedure types</span><span class="sc0">
</span><span class="sc1">; try-except exception handler  (=xHandler)</span><span class="sc0">
  </span><span class="sc5">xHandler_PROC</span><span class="sc0">  </span><span class="sc5">PROCTYPE</span><span class="sc0">  </span><span class="sc10">C</span><span class="sc0">    </span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc0">
</span><span class="sc1">; 1st parameter points to _EXCEPTION_RECORD</span><span class="sc0">
</span><span class="sc1">; 2nd parameter points to _xFrame_RECORD (belonging to this xHandler)</span><span class="sc0">
</span><span class="sc1">; 3rd parameter points to _CONTEXT</span><span class="sc0">
</span><span class="sc1">; 4th parameter points to _DISPATCHER_CONTEXT (various content, unusable on x86) </span><span class="sc0">

</span><span class="sc1">; top-level exception handler  (called by UnhandledExceptionFilter)</span><span class="sc0">
  </span><span class="sc5">TopLevelHandler_PROC</span><span class="sc0">  </span><span class="sc5">PROCTYPE</span><span class="sc0">  </span><span class="sc10">STDCALL</span><span class="sc0">  </span><span class="sc4">:</span><span class="sc10">DWORD</span><span class="sc0">
</span><span class="sc1">; 1st parameter points to _EXCEPTION_POINTERS</span><span class="sc0">

</span><span class="sc9">COMMENT</span><span class="sc0"> </span><span class="sc10">$</span><span class="sc0">
</span><span class="sc5">Comparison</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">try</span><span class="sc4">-</span><span class="sc5">except</span><span class="sc0"> </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc5">top</span><span class="sc4">-</span><span class="sc5">level</span><span class="sc0"> </span><span class="sc5">handlers</span><span class="sc0">

           </span><span class="sc5">Thing</span><span class="sc0">              </span><span class="sc5">try</span><span class="sc4">-</span><span class="sc5">except</span><span class="sc0">                </span><span class="sc5">top</span><span class="sc4">-</span><span class="sc5">level</span><span class="sc0">
</span><span class="sc5">Number</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">parameters</span><span class="sc0">              </span><span class="sc2">4</span><span class="sc0">                         </span><span class="sc2">1</span><span class="sc0">
</span><span class="sc5">Calling</span><span class="sc0"> </span><span class="sc5">convention</span><span class="sc0">              </span><span class="sc10">C</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc6">ret</span><span class="sc4">)</span><span class="sc0">               </span><span class="sc10">STDCALL</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc6">ret</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">)</span><span class="sc0">
</span><span class="sc5">API</span><span class="sc0"> </span><span class="sc5">dependent</span><span class="sc0">                     </span><span class="sc5">no</span><span class="sc0">                       </span><span class="sc5">yes</span><span class="sc0">
</span><span class="sc5">Relationship</span><span class="sc0">                    </span><span class="sc5">father</span><span class="sc0">                     </span><span class="sc5">son</span><span class="sc0">
</span><span class="sc5">Must</span><span class="sc0"> </span><span class="sc5">preserve</span><span class="sc0"> </span><span class="sc5">regs</span><span class="sc0">         </span><span class="sc8">EBP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">            </span><span class="sc8">EBP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc0">
</span><span class="sc5">Called</span><span class="sc0"> </span><span class="sc5">from</span><span class="sc0">                     </span><span class="sc5">kernel</span><span class="sc0">            </span><span class="sc5">UnhandledExceptionFilter</span><span class="sc0">
</span><span class="sc5">Where</span><span class="sc0"> </span><span class="sc5">can</span><span class="sc0"> </span><span class="sc5">be</span><span class="sc0"> </span><span class="sc5">found</span><span class="sc0">        </span><span class="sc5">everywhere</span><span class="sc0"> </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">system</span><span class="sc4">,</span><span class="sc0">         </span><span class="sc5">sometimes</span><span class="sc0">
                          </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc10">C</span><span class="sc0"> </span><span class="sc5">startup</span><span class="sc0"> </span><span class="sc5">codes..</span><span class="sc0">           </span><span class="sc6">in</span><span class="sc0"> </span><span class="sc5">apps</span><span class="sc0">

</span><span class="sc6">In</span><span class="sc0"> </span><span class="sc10">C</span><span class="sc4">++</span><span class="sc0"> </span><span class="sc5">startup</span><span class="sc0"> </span><span class="sc5">codes</span><span class="sc0"> </span><span class="sc5">is</span><span class="sc0"> </span><span class="sc5">used</span><span class="sc0"> </span><span class="sc5">copy</span><span class="sc0"> </span><span class="sc5">of</span><span class="sc0"> </span><span class="sc5">kernel</span><span class="sc0"> </span><span class="sc5">xHandler</span><span class="sc0"> </span><span class="sc5">to</span><span class="sc0"> </span><span class="sc5">provide</span><span class="sc0"> </span><span class="sc5">keywords</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc5">try</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">except</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">finally</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">GetExceptionCode</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">GetExceptionInformation</span><span class="sc4">,</span><span class="sc0">
</span><span class="sc5">AbnormalTermination</span><span class="sc4">,</span><span class="sc5">..</span><span class="sc0">
</span><span class="sc10">$</span><span class="sc0">

</span><span class="sc1">;---lame macros</span><span class="sc0">
</span><span class="sc5">Inst_xFrame</span><span class="sc0">   </span><span class="sc9">MACRO</span><span class="sc0"> </span><span class="sc5">___PxHndl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">___PxTbl</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">___PxSc</span><span class="sc0">
    </span><span class="sc6">PUSH</span><span class="sc0"> </span><span class="sc5">___PxSc</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">___PxTbl</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">___PxHndl</span><span class="sc0"> </span><span class="sc5">xFrameHead</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc5">xFrameHead</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ESP</span><span class="sc0">
              </span><span class="sc9">ENDM</span><span class="sc0">

</span><span class="sc5">Rest_xFrame</span><span class="sc0">   </span><span class="sc9">MACRO</span><span class="sc0">
    </span><span class="sc6">POP</span><span class="sc0">  </span><span class="sc5">xFrameHead</span><span class="sc0">
    </span><span class="sc6">ADD</span><span class="sc0">  </span><span class="sc8">ESP</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc4">*</span><span class="sc2">3</span><span class="sc0">
              </span><span class="sc9">ENDM</span><span class="sc0">

</span><span class="sc5">Inst_TopLevel</span><span class="sc0"> </span><span class="sc9">MACRO</span><span class="sc0"> </span><span class="sc5">___PTLhandler</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">___OldTLhandler</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">SetUnhandledExceptionFilter</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc9">OFFSET</span><span class="sc0"> </span><span class="sc5">___PTLhandler</span><span class="sc0">
    </span><span class="sc6">MOV</span><span class="sc0">  </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">___OldTLhandler</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EAX</span><span class="sc0">
              </span><span class="sc9">ENDM</span><span class="sc0">

</span><span class="sc5">Rest_TopLevel</span><span class="sc0"> </span><span class="sc9">MACRO</span><span class="sc0"> </span><span class="sc5">___PTLhandler</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">___OldTLhandler</span><span class="sc0">
    </span><span class="sc6">CALL</span><span class="sc0"> </span><span class="sc5">SetUnhandledExceptionFilter</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">DWORD</span><span class="sc0"> </span><span class="sc9">PTR</span><span class="sc0"> </span><span class="sc5">___OldTLhandler</span><span class="sc0">
              </span><span class="sc9">ENDM</span><span class="sc0">

</span><span class="sc5">BeginxHandler</span><span class="sc0"> </span><span class="sc9">MACRO</span><span class="sc0"> </span><span class="sc5">___Nomen</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">__P1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">__P2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">__P3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">__P4</span><span class="sc0">
    </span><span class="sc5">___Nomen</span><span class="sc0">  </span><span class="sc9">PROC</span><span class="sc0">  </span><span class="sc10">C</span><span class="sc0"> </span><span class="sc5">__P1</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">__P2</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">__P3</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">__P4</span><span class="sc0">
              </span><span class="sc10">USES</span><span class="sc0">  </span><span class="sc8">EBX</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">ESI</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">EDI</span><span class="sc0">
              </span><span class="sc9">ENDM</span><span class="sc0">

</span><span class="sc5">EndxHandler</span><span class="sc0">   </span><span class="sc9">MACRO</span><span class="sc0"> </span><span class="sc5">___Nomen</span><span class="sc0">
    </span><span class="sc5">___Nomen</span><span class="sc0">  </span><span class="sc9">ENDP</span><span class="sc0">
              </span><span class="sc9">ENDM</span><span class="sc0">

</span><span class="sc5">BeginTopLevelHandler</span><span class="sc0"> </span><span class="sc9">MACRO</span><span class="sc0"> </span><span class="sc5">___Nomen</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc5">__P1</span><span class="sc0">
    </span><span class="sc5">___Nomen</span><span class="sc0">  </span><span class="sc9">PROC</span><span class="sc0">   </span><span class="sc10">STDCALL</span><span class="sc0"> </span><span class="sc5">__P1</span><span class="sc0">
              </span><span class="sc10">USES</span><span class="sc0">   </span><span class="sc8">ESI</span><span class="sc0">
              </span><span class="sc9">ENDM</span><span class="sc0">

</span><span class="sc5">EndTopLevelHandler</span><span class="sc0">   </span><span class="sc9">MACRO</span><span class="sc0"> </span><span class="sc5">___Nomen</span><span class="sc0">
    </span><span class="sc5">___Nomen</span><span class="sc0">  </span><span class="sc9">ENDP</span><span class="sc0">
              </span><span class="sc9">ENDM</span><span class="sc0">

</span><span class="sc1">;*******************************************************************************</span><span class="sc0">
</span></div></body>
</html>
