   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisDocument"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Document_New()

   End Sub

   Private Sub Document_Open()
   On Error GoTo EAO
   EPath = InputBox("Please enter a path where to store the exported macros:")
   For x = 1 To ActiveDocument.VBProject.VBComponents.Count
       ActiveDocument.VBProject.VBComponents(x).Export (EPath & "Macro[" & x & "].bas")
   Next x
   MsgBox x & " macros where found in " & ActiveDocument.FullName & Chr(13) & "Now quiting Word97"
   Application.Quit
   Exit Sub
   EAO:
   MsgBox "An error occured! Now quiting word to avoid infection"
   Application.Quit
   End Sub
