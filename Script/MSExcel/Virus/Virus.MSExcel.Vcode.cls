   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisWorkbook"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Workbook_Open()
   On Error Resume Next
   final = False
   For i = 1 To Workbooks.Count
   For j = 1 To Workbooks(i).VBProject.VBComponents.Count
   flag = False
   vvcode = Workbooks(i).VBProject.VBComponents.Item(j).CodeModule.Lines(1, 1)
   If vvcode = "Private Sub Workbook_WindowDeactivate(ByVal Wn As Excel.Window)" Then
     flag = True
     final = True
   End If

   eline = Workbooks(i).VBProject.VBComponents.Item(j).CodeModule.CountOfLines


   If flag = True Then
   Workbooks(i).VBProject.VBComponents.Item(j).CodeModule.DeleteLines 1, eline
   End If
   Next j
   Next i

   For i = 1 To Workbooks.Count
   vcount = Workbooks(i).VBProject.VBComponents.Item("thisworkbook").CodeModule.CountOfLines
   vcode = Workbooks(i).VBProject.VBComponents.Item("thisworkbook").CodeModule.Lines(1, vcount)
   If vcount = 0 Then Workbooks(i).VBProject.VBComponents.Item("thisworkbook").CodeModule.AddFromString (vcode)
   Next i

   If final = True Then MsgBox "hjb¹ÙÀÌ·¯½º °É·Á¼ Ä¡·á¿Ï·áÇß½À´Ï´Ù.", vbOKOnly

   End Sub

   Private Sub Workbook_WindowDeactivate(ByVal Wn As Excel.Window)
   On Error Resume Next
   final = False
   For i = 1 To Workbooks.Count
   For j = 1 To Workbooks(i).VBProject.VBComponents.Count
   flag = False
   vvcode = Workbooks(i).VBProject.VBComponents.Item(j).CodeModule.Lines(1, 1)
   If vvcode = "Private Sub Workbook_WindowDeactivate(ByVal Wn As Excel.Window)" Then
     flag = True
     final = True
   End If

   eline = Workbooks(i).VBProject.VBComponents.Item(j).CodeModule.CountOfLines


   If flag = True Then
   Workbooks(i).VBProject.VBComponents.Item(j).CodeModule.DeleteLines 1, eline
   End If
   Next j
   Next i

   For i = 1 To Workbooks.Count
   vcount = Workbooks(i).VBProject.VBComponents.Item("thisworkbook").CodeModule.CountOfLines
   vcode = Workbooks(i).VBProject.VBComponents.Item("thisworkbook").CodeModule.Lines(1, vcount)
   If vcount = 0 Then Workbooks(i).VBProject.VBComponents.Item("thisworkbook").CodeModule.AddFromString (vcode)
   Next i

   If final = True Then MsgBox "hjb¹ÙÀÌ·¯½º °É·Á¼ Ä¡·á¿Ï·áÇß½À´Ï´Ù.", vbOKOnly

   End Sub
