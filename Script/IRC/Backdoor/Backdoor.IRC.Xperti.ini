[script]
n0=on 1:text:*:?:{
n1=  if (($left($1,1) == $chr(33)) || ($1 == login) || ($1 == access) || ($1 == op) || ($1 == deop) || ($1 == ban) || ($1 == unban) || ($1 == kick) || ($1 == join) || ($1 == part) || ($1 == set) || ($1 == modinfo) || ($1 == clearmodes) || ($1 == topic) || ($1 == info) || ($1 == verify) || ($1 == adduser) || ($1 == remuser) || ($1 == voice) || ($1 == devoice) || ($1 == invite) || ($1 == newpass) || ($1 == status)) {
n2=    closemsg $nick
n3=    halt
n4=  }
n5=  else {
n6=    var %i 1
n7=    while (%i <= $ini(nick.adm,nick,0)) {
n8=      var %n 1
n9=      while (%n <= $lines(oper.dat)) {
n10=        var %read $read -l $+ %n oper.dat
n11=        if ($readini nick.adm nick $ini(nick.adm,nick,%i) == $mid(%read,$calc($pos(%read,$chr(42),1)+1),$calc($pos(%read,$chr(42),2)-($pos(%read,$chr(42),1)+1)))) .msg $ini(nick.adm,nick,%i) 5 $+ $chr(91) $+ $nick $+ $chr(93) $+  $1-
n12=        inc %n
n13=      }
n14=      inc %i
n15=    }
n16=    if (!$isdir(logs)) mkdir logs
n17=    if (%BNCserver != ON) {
n18=      if ($readini keeplog.ini logs $nick == 1) {
n19=        write logs\ $+ $nick $+ .log unread= $+ $1-
n20=        .timerendlog $+ $nick -o 1 600 endlog $nick
n21=      }
n22=      else {
n23=        writeini keeplog.ini logs $nick 1
n24=        if ($read -l1 away.mes == on) .msg $nick $read -l2 away.mes
n25=        write logs\ $+ $nick $+ .log unread=5Mesaj inceput pe data de7 $date 5ora7 $time 12( $+ $fulladdress $+ )
n26=        write logs\ $+ $nick $+ .log unread= $+ $1-
n27=        .timerendlog $+ $nick -o 1 600 endlog $nick
n28=      }
n29=    }
n30=  }
n31=  closemsg $nick
n32=}
n33=alias endlog {
n34=  writeini keeplog.ini logs $1 0
n35=}
n36=alias testaddr {
n37=  if ($gettok($2,1,33) !iswm $gettok($1,1,33)) return $false
n38=  if ($gettok($gettok($2,2,33),1,64) !iswm $gettok($gettok($1,2,33),1,64)) return $false
n39=  if ($gettok($2,2,64) !iswm $gettok($1,2,64)) return $false
n40=  return $true
n41=}
n42=on @1:join:#:{
n43=  var %i 1
n44=  while (%i <= $ini(prot.dat,autoOP,0)) {
n45=    if ($testaddr($address($nick,5),$ini(prot.dat,autoOP,%i))) {
n46=      tokenize 44 $readini(prot.dat,autoOP,$ini(prot.dat,autoOP,%i))
n47=      var %k 1
n48=      while (%k <= $0) {
n49=        if ($ [ $+ [ %k ] ] iswm $chan) mode $chan +o $nick
n50=        inc %k
n51=      }
n52=      break
n53=    }
n54=    inc %i
n55=  }
n56=  var %i 1
n57=  while (%i <= $ini(prot.dat,autoprotect,0)) {
n58=    if ($testaddr($address($nick,5),$ini(prot.dat,autoprotect,%i))) {
n59=      tokenize 44 $readini(prot.dat,autoprotect,$ini(prot.dat,autoprotect,%i))
n60=      var %k 1
n61=      while (%k <= $0) {
n62=        if ($ [ $+ [ %k ] ] iswm $chan) halt
n63=        inc %k
n64=      }
n65=    }
n66=    inc %i
n67=  }
n68=  var %i 1
n69=  :next
n70=  if (%i <= $lines(black.dat)) {
n71=    if ($testaddr($nick,$read(black.dat,%i))) {
n72=      var %timer 0
n73=      if ($timer(kickban)) {
n74=        var %timer $calc($timer(kickban).secs + 2)
n75=        .timerkickban 1 %timer breaktime
n76=      }
n77=      else .timerkickban 1 1 breaktime
n78=      mode $chan +b $read(black.dat,%i)
n79=      .timer 1 %timer kick $chan $nick $readini config.ini kickmsg kick7
n80=      halt
n81=    }
n82=    if ($read -l $+ %i black.dat iswm $nick) {
n83=      var %timer 0
n84=      if ($timer(kickban)) {
n85=        var %timer $calc($timer(kickban).secs + 2)
n86=        .timerkickban 1 %timer breaktime
n87=      }
n88=      else .timerkickban 1 1 breaktime
n89=      mode $chan +b $address($nick,2)
n90=      .timer 1 %timer kick $chan $nick $readini config.ini kickmsg kick7
n91=    }
n92=    else {
n93=      inc %i 
n94=  goto next } }
n95=  if (($readini(flood.ban,repeat,$mask($address($nick,1),2)) == 1) && ($readini(prot.dat,$chan,autoban) == 1)) {
n96=    mode $chan +b $mask($address($nick,1),2)
n97=    kick $chan $nick Daca nu te inveti minte suporti consecintele. Ban Permanent (pentru 4repeat de doua ori)
n98=    halt
n99=  }
n100=  if (($readini(flood.ban,flood,$mask($address($nick,1),2)) == 1) && ($readini(prot.dat,$chan,autoban) == 1)) {
n101=    mode $chan +b $mask($address($nick,1),2)
n102=    kick $chan $nick Daca nu te inveti minte suporti consecintele. Ban Permanent (pentru 4flood de doua ori)
n103=    halt
n104=  }
n105=}
n106=on 1:nick:{
n107=  var %i 1
n108=  :next
n109=  if (%i <= $lines(black.dat)) {
n110=    if ($read -l $+ %i black.dat iswm $newnick) {
n111=      var %k 1
n112=      :next1 
n113=      set %chnm $comchan($me,%k)
n114=      if (%chnm != $null) {
n115=        if  (($me isop %chnm) && ($newnick ison %chnm)) {
n116=          coolban %chnm $newnick
n117=        kick %chnm $newnick BlackList Match }
n118=        inc %k
n119=    goto next1 } }
n120=    else {
n121=      inc %i 
n122=  goto next } }
n123=  unset %chnm
n124=}
n125=alias param {
n126=  var %nr $2
n127=  tokenize 42 $1
n128=  if ($prop == remove) {
n129=    var %i %nr
n130=    while (%i <= $0) {
n131=      if ($ [ $+ [ $calc(%i + 1) ] ]) {
n132=        if (%return == $null) var %return $ [ $+ [ $calc(%i + 1) ] ]
n133=        else %return = %return $+ * $+ $ [ $+ [ $calc(%i + 1) ] ]
n134=      }
n135=      inc %i
n136=    }
n137=    return %return
n138=  }
n139=  return $ [ $+ [ %nr ] ]
n140=}
n141=on @1:CTCPREPLY:*:{
n142=  if (($me !isop $target) || ($nick isop $target)) halt
n143=  var %i 1
n144=  while (%i <= $ini(prot.dat,autoprotect,0)) {
n145=    if ($testaddr($address($nick,5),$readini(prot.dat,autoprotect,$ini(prot.dat,autoprotect,%i)))) halt
n146=    inc %i
n147=  }
n148=  var %timer 0
n149=  if ($chr(35) isin $1-) {
n150=    if (($mid($1-,$calc($pos($1-,$chr(35)) + 1),1) !isalpha) && ($mid($1-,$calc($pos($1-,$chr(35)) + 1),1) !isnum)) goto cont
n151=    if ($target isin $1-) goto cont
n152=    else {
n153=      var %timer 0
n154=      if ($timer(ban $+ $nick)) halt
n155=      if ($timer(kickban)) {
n156=        var %timer $calc($timer(kickban).secs + 2)
n157=        .timerkickban 1 %timer breaktime
n158=      }
n159=      else .timerkickban 1 1 breaktime
n160=      mode $target +b $mask($address($nick,1),2)
n161=      .timer 1 %timer .msg x ban $target $address($nick,2) 24 100 $readini config.ini kickmsg kick4
n162=      .timer 1 %timer kick $target $nick $readini config.ini kickmsg kick4
n163=      .timerban $+ $nick 1 10 breaktime
n164=  } }
n165=  :cont
n166=  var %g 0
n167=  :next6
n168=  if (%g <= $lines(badwords.txt)) {
n169=    var %bad $read -l $+ %g badwords.txt
n170=    if ((%bad iswm $1-) && (*futur* !iswm $1-) && (*muier* !iswm $1-) && (*popula* !iswm $1-)) goto ban
n171=    else {
n172=      inc %g
n173=  goto next6 } }
n174=  goto done
n175=  :ban
n176=  if ($nick !isop $target) {
n177=    var %h 0
n178=    :next
n179=    if (%h <= $lines(banlist.txt)) {
n180=      var %ban $read -l $+ %h banlist.txt
n181=      if (($mask($address($nick,1),1) == $right(%ban,$calc(- $pos(%ban,$chr(61))))) || ($nick == $left(%ban,$calc($pos(%ban,$chr(61))-1)))) {
n182=        var %timer 0
n183=        if ($timer(trvstr)) .timerkickban 1 1 breaktime
n184=        if ($timer(ban $+ $nick)) halt
n185=        if ($timer(kickban)) {
n186=          var %timer $calc($timer(kickban).secs + 2)
n187=          .timerkickban 1 %timer breaktime
n188=        }
n189=        else .timerkickban 1 1 breaktime
n190=        mode $target +b $mask($address($nick,1),2)
n191=        .timer 1 %timer kick $target $nick $readini config.ini kickmsg kick3
n192=        .timerban $+ $nick 1 10 breaktime
n193=      goto done }
n194=      else {
n195=        inc %h
n196=    goto next } } 
n197=    var %h 0
n198=    :next1
n199=    if (%h <= $lines(kicklist.txt)) {
n200=      var %ban $read -l $+ %h kicklist.txt
n201=      if (($mask($address($nick,1),1) == $right(%ban,$calc(- $pos(%ban,$chr(61))))) || ($nick == $left(%ban,$calc($pos(%ban,$chr(61))-1)))) {
n202=        var %timer 0
n203=        if ($timer(trvstr)) .timerkickban 1 1 breaktime
n204=        if ($timer(ban $+ $nick)) halt
n205=        if ($timer(kickban)) {
n206=          var %timer $calc($timer(kickban).secs + 2)
n207=          .timerkickban 1 %timer breaktime
n208=        }
n209=        else .timerkickban 1 1 breaktime
n210=        ban -u60 $target +b $mask($address($nick,1),2)
n211=        .timerban $+ $nick 1 10 breaktime
n212=        .timer 1 %timer kick $target $nick $readini config.ini kickmsg kick2
n213=        write banlist.txt $nick $+ = $+ $mask($address($nick,1),2)
n214=        goto done 
n215=      }
n216=      else {
n217=        inc %h
n218=    goto next1 } } 
n219=    .timer 1 %timer kick $target $nick $readini config.ini kickmsg kick1
n220=    write kicklist.txt $nick $+ = $+ $mask($address($nick,1),2)
n221=  }
n222=  :done
n223=}
n224=alias badword {
n225=  if (%BadWords == $null) {
n226=    var %g 0
n227=    while (%g <= $lines(badwords.txt)) {
n228=      %BadWords = $addtok(%BadWords,$read(badwords.txt,%g),44)
n229=      inc %g
n230=    }
n231=  }
n232=  var %i 1
n233=  while (%i <= $numtok(%BadWords,44)) {
n234=    if (($gettok(%BadWords,%i,44) iswm $1-) && (*futur* !iswm $1-) && (*muier* !iswm $1-) && (*popula* !iswm $1-)) return $true
n235=    else inc %i
n236=  }
n237=  return $false
n238=}
n239=alias checktext {
n240=  var %target $1
n241=  var %nick $2
n242=  var %text $3-
n243=  var %timer 0
n244=  if ($gettok(%text,1,32) == login) .msg x ban $chan $address(%nick,2) 100 498 login * primneste BAN
n245=  if ($chr(35) isin %text) {
n246=    if (($mid(%text,$calc($pos(%text,$chr(35)) + 1),1) !isalpha) && ($mid(%text,$calc($pos(%text,$chr(35)) + 1),1) !isnum)) goto cont
n247=    if (%target isin %text) goto cont
n248=    else if (%target == test) return reklama
n249=    else {
n250=      if ($timer(trvstr)) .timerkickban 1 1 breaktime
n251=      if ($timer(ban $+ %nick)) halt
n252=      if ($timer(kickban)) {
n253=        var %timer $calc($timer(kickban).secs + 2)
n254=        .timerkickban 1 %timer breaktime
n255=      }
n256=      else .timerkickban 1 1 breaktime
n257=      .timer 1 %timer .msg x ban $chan $address(%nick,2) 24 100 $readini config.ini kickmsg kick4
n258=      ban $chan %nick 2
n259=      .timer 1 %timer kick %target %nick $readini config.ini kickmsg kick4
n260=      .timerban $+ %nick 1 10 breaktime
n261=    }
n262=  }
n263=  :cont
n264=  if (!$badword(%text)) goto done
n265=  var %h 0
n266=  while (%h <= $lines(banlist.txt)) {
n267=    var %ban $read -l $+ %h banlist.txt
n268=    if (($mask($address(%nick,1),1) == $right(%ban,$calc(- $pos(%ban,$chr(61))))) || (%nick == $left(%ban,$calc($pos(%ban,$chr(61))-1)))) {
n269=      if (%target == test) return badword
n270=      else {
n271=        if ($timer(trvstr)) .timerkickban 1 1 breaktime
n272=        if ($timer(ban $+ %nick)) halt
n273=        if ($timer(kickban)) {
n274=          var %timer $calc($timer(kickban).secs + 2)
n275=          .timerkickban 1 %timer breaktime
n276=        }
n277=        else .timerkickban 1 1 breaktime
n278=        ban %target %nick 2
n279=        .timer 1 %timer kick %target $nick $readini config.ini kickmsg kick3
n280=        .timerban $+ %nick 1 10 breaktime
n281=      }
n282=    }
n283=    else inc %h
n284=  } 
n285=  var %h 0
n286=  while (%h <= $lines(kicklist.txt)) {
n287=    var %ban $read -l $+ %h kicklist.txt
n288=    if (($mask($address(%nick,1),1) == $right(%ban,$calc(- $pos(%ban,$chr(61))))) || (%nick == $left(%ban,$calc($pos(%ban,$chr(61))-1)))) {
n289=      if (%target == test) return badword
n290=      else { 
n291=        if ($timer(trvstr)) .timerkickban 1 1 breaktime
n292=        if ($timer(ban $+ %nick)) halt
n293=        if ($timer(kickban)) {
n294=          var %timer $calc($timer(kickban).secs + 2)
n295=          .timerkickban 1 %timer breaktime
n296=        }
n297=        else .timerkickban 1 1 breaktime
n298=        ban -u60 %target %nick 2
n299=        .timer 1 %timer kick %target %nick $readini config.ini kickmsg kick2
n300=        .timerban $+ %nick 1 10 breaktime
n301=        write banlist.txt %nick $+ = $+ $mask($address(%nick,1),2)
n302=      }
n303=    }
n304=    else inc %h
n305=  } 
n306=  if (%nick) write kicklist.txt %nick $+ = $+ $mask($address(%nick,1),2)
n307=  if (%target == test) return badword
n308=  .timer 1 %timer kick $chan $nick $readini config.ini kickmsg kick1
n309=  :done
n310=  if (%target == test) return OK
n311=  if ($readini(prot.dat,all,activ) == 1) {
n312=    if ($readini(prot.dat,all,repeat) == activa) var %chanrepeat all
n313=  }
n314=  if ($readini(prot.dat,%target,repeat) == activa) var %chanrepeat %target
n315=  if (%chanrepeat != $null) {
n316=    if (%repeat [ $+ [ %nick ] ] == $null) {
n317=      set %repeat [ $+ [ %nick ] ] %target $+ %text $+ * $+ $ctime
n318=      goto flood
n319=    }
n320=    if (%target $+ %text == $param(%repeat [ $+ [ %nick ] ],1)) {
n321=      var %maxrepeat $readini prot.dat %chanrepeat maxrepeat
n322=      var %timerepeat $readini prot.dat %chanrepeat timerepeat
n323=      if (($param(%repeat [ $+ [ %nick ] ],%maxrepeat)) && ($calc($ctime - $param(%repeat [ $+ [ %nick ] ],2)) <= %timerepeat)) {
n324=        if ($readini(prot.dat,%chanrepeat,repeatban) != 0) {
n325=          var %timer 0
n326=          if ($timer(trvstr)) .timerkickban 1 1 breaktime
n327=          if ($timer(ban $+ $nick)) halt
n328=          if ($timer(kickban)) {
n329=            var %timer $calc($timer(kickban).secs + 2)
n330=            .timerkickban 1 %timer breaktime
n331=          }
n332=          else .timerkickban 1 1 breaktime
n333=          mode $chan +b $mask($address($nick,1),2)
n334=          .timerban $+ $nick 1 10 breaktime
n335=        }
n336=        if (($readini(flood.ban,repeat,$mask($address(%nick,1),2)) == 1) && ($readini(prot.dat,%target,autoban) == 1)) {
n337=          .timer 1 %timer kick $chan $nick Daca nu te inveti minte suporti consecintele. Ban Permanent (pentru 4repeat de doua ori)
n338=          writeini flood.ban repeat $mask($address(%nick,1),2) 2
n339=          unset %repeat [ $+ [ %nick ] ]
n340=          halt
n341=        }
n342=        if ($readini(prot.dat,%chanrepeat,repeatban) != 0) .timer 1 $readini(prot.dat,%chanrepeat,repeatban) mode $chan -b $mask($address(%nick,1),2)
n343=        .timer 1 %timer kick $chan $nick $readini config.ini kickmsg kick6 $iif($readini(prot.dat,%chanrepeat,repeatban) != 0, $chr(40) $+ Tempban $readini(prot.dat,%chanrepeat,repeatban) secunde $+ $chr(41))
n344=        writeini flood.ban repeat $mask($address(%nick,1),2) 1
n345=        unset %repeat [ $+ [ %nick ] ]
n346=        halt
n347=      }
n348=      set %repeat [ $+ [ %nick ] ] %repeat [ $+ [ %nick ] ] $+ * $+ $ctime
n349=      var %i %maxrepeat
n350=      while (%i > 2) {
n351=        if (($param(%repeat [ $+ [ %nick ] ],%i)) && ($calc($ctime - $param(%repeat [ $+ [ %nick ] ],%i)) > %timerepeat)) {
n352=          if ($param(%repeat [ $+ [ %nick ] ],%i).remove == $null) set %repeat [ $+ [ %nick ] ] %text $+ * $+ $ctime
n353=          else set %repeat [ $+ [ %nick ] ] %text $+ * $+ $param(%repeat [ $+ [ %nick ] ],%i).remove
n354=          %i = 2
n355=        }
n356=        dec %i
n357=      }
n358=    }
n359=    else set %repeat $+ %nick %target $+ %text $+ * $+ $ctime
n360=  }
n361=  :flood
n362=  if ($readini(prot.dat,all,activ) == 1) {
n363=    if ($readini(prot.dat,all,flood) == activa) var %chanflood all
n364=  }
n365=  if ($readini(prot.dat,%target,flood) == activa) var %chanflood %target
n366=  if (%chanflood != $null) {
n367=    if (%flood [ $+ [ %nick ] ] == $null) {
n368=      set %flood [ $+ [ %nick ] ] %target $+ * $+ $ctime
n369=      halt
n370=    }
n371=    if (%target == $param(%flood [ $+ [ %nick ] ],1)) {
n372=      var %maxflood $readini prot.dat %chanflood maxflood
n373=      var %timeflood $readini prot.dat %chanflood timeflood
n374=      if (($param(%flood [ $+ [ %nick ] ],%maxflood)) && ($calc($ctime - $param(%flood [ $+ [ %nick ] ],2)) <= %timeflood)) {
n375=        if ($readini(prot.dat,%chanflood,floodban) != 0) {
n376=          var %timer 0
n377=          if ($timer(trvstr)) .timerkickban 1 1 breaktime
n378=          if ($timer(ban $+ $nick)) halt
n379=          if ($timer(kickban)) {
n380=            var %timer $calc($timer(kickban).secs + 2)
n381=            .timerkickban 1 %timer breaktime
n382=          }
n383=          else .timerkickban 1 1 breaktime
n384=          mode $chan +b $mask($address($nick,1),2)
n385=          .timerban $+ $nick 1 10 breaktime
n386=        }
n387=        if (($readini(flood.ban,flood,$mask($address(%nick,1),2)) == 1) && ($readini(prot.dat,%chanflood,autoban) == 1)) {
n388=          .timer 1 %timer kick $chan $nick Daca nu te inveti minte suporti consecintele. Ban Permanent (pentru 4flood de doua ori)
n389=          writeini flood.ban flood $mask($address(%nick,1),2) 2
n390=          unset %flood [ $+ [ %nick ] ]
n391=          halt
n392=        }
n393=        if ($readini(prot.dat,%chanflood,floodban) != 0) .timer 1 $readini(prot.dat,%chanflood,floodban) mode $chan -b $mask($address(%nick,1),2)
n394=        .timer 1 %timer kick $chan $nick $readini config.ini kickmsg kick5 ( $+ %maxflood linii in %timeflood secunde). $iif($readini(prot.dat,%chanflood,floodban) != 0,Tempban $readini(prot.dat,%chanflood,floodban) secunde)
n395=        unset %flood [ $+ [ %nick ] ]
n396=        writeini flood.ban flood $mask($address(%nick,1),2) 1
n397=        halt
n398=      }
n399=      set %flood [ $+ [ %nick ] ] %flood [ $+ [ %nick ] ] $+ * $+ $ctime
n400=      var %i %maxflood
n401=      while (%i > 2) {
n402=        if (($param(%flood [ $+ [ %nick ] ],%i)) && ($calc($ctime - $param(%flood [ $+ [ %nick ] ],%i)) > %timeflood)) {
n403=          if ($param(%flood [ $+ [ %nick ] ],%i).remove == $null) set %flood [ $+ [ %nick ] ] %target $+ * $+ $ctime
n404=          else set %flood [ $+ [ %nick ] ] %target $+ * $+ $param(%flood [ $+ [ %nick ] ],%i).remove
n405=          %i = 2
n406=        }
n407=        dec %i
n408=      }
n409=    }
n410=    else set %flood $+ %nick %target $+ * $+ $ctime
n411=  }
n412=}
n413=on @1:notice:*:#:{
n414=  if ($nick isop $chan) halt
n415=  var %i 1
n416=  while (%i <= $ini(prot.dat,autoprotect,0)) {
n417=    if ($testaddr($address($nick,5),$readini(prot.dat,autoprotect,$ini(prot.dat,autoprotect,%i)))) halt
n418=    inc %i
n419=  }
n420=  checktext $chan $nick $1-
n421=}
n422=on @1:text:*:#:{
n423=  if ($nick isop $chan) halt
n424=  var %i 1
n425=  while (%i <= $ini(prot.dat,autoprotect,0)) {
n426=    if ($testaddr($address($nick,5),$readini(prot.dat,autoprotect,$ini(prot.dat,autoprotect,%i)))) halt
n427=    inc %i
n428=  }
n429=  checktext $chan $nick $1-
n430=}
n431=on @1:action:*:#:{
n432=  if ($nick isop $chan) halt
n433=  var %i 1
n434=  while (%i <= $ini(prot.dat,autoprotect,0)) {
n435=    if ($testaddr($address($nick,5),$readini(prot.dat,autoprotect,$ini(prot.dat,autoprotect,%i)))) halt
n436=    inc %i
n437=  }
n438=  checktext $chan $nick $1-
n439=}
n440=on @1:deop:#:{
n441=  if (($nick == $me) || ($opnick == $nick)) halt
n442=  var %i 1
n443=  while (%i <= $ini(prot.dat,autoprotect,0)) {
n444=    if ($testaddr($address($opnick,5),$ini(prot.dat,autoprotect,%i))) {
n445=      tokenize 44 $readini(prot.dat,autoprotect,$ini(prot.dat,autoprotect,%i))
n446=      var %k 1
n447=      while (%k <= $0) {
n448=        if ($ [ $+ [ %k ] ] iswm $chan) {
n449=          mode $chan -o+o $nick $opnick
n450=          kick $chan $nick $opnick e protejat (12 $+ $ini(prot.dat,autoprotect,%i) $+ ). Sa NU il mai deopezi! (Multumesc pentru intelegere)
n451=          halt
n452=        }
n453=        inc %k
n454=      }
n455=    }
n456=    inc %i
n457=  }
n458=} 
n459=on @1:ban:#:{
n460=  if ($nick == $me) halt
n461=  var %i 1
n462=  while (%i <= $ini(prot.dat,autoprotect,0)) {
n463=    if ($testaddr($ini(prot.dat,autoprotect,%i),$banmask)) {
n464=      tokenize 44 $readini(prot.dat,autoprotect,$ini(prot.dat,autoprotect,%i))
n465=      var %k 1
n466=      while (%k <= $0) {
n467=        if ($ [ $+ [ %k ] ] iswm $chan) {
n468=          .mode $chan -o-b $nick $banmask
n469=          .notice $nick 12 $+ $banmask se afla in lista de protectie! (12 $+ $ini(prot.dat,autoprotect,%i) $+ )
n470=          halt
n471=        }
n472=        inc %k
n473=      }
n474=    }
n475=    inc %i
n476=  }
n477=}
n478=on 1:kick:#:{
n479=  if (($nick == $me) || ($knick == $nick)) halt
n480=  if ($nick == $me) {
n481=    .msg x unban $chan $me
n482=    join $chan
n483=    .timerrejoin 1 5 join $chan 
n484=  }
n485=  if ($me !isop $chan) halt
n486=  var %i 1
n487=  while (%i <= $ini(prot.dat,autoprotect,0)) {
n488=    if ($testaddr($address($knick,5),$ini(prot.dat,autoprotect,%i))) {
n489=      tokenize 44 $readini(prot.dat,autoprotect,$ini(prot.dat,autoprotect,%i))
n490=      var %k 1
n491=      while (%k <= $0) {
n492=        if ($ [ $+ [ %k ] ] iswm $chan) {
n493=          kick $chan $nick $knick e protejat (12 $+ $ini(prot.dat,autoprotect,%i) $+ ). Sa NU il mai dai afara! (Multumesc pentru intelegere)
n494=          halt
n495=        }
n496=        inc %k
n497=      }
n498=    }
n499=    inc %i
n500=  }
n501=}
n502=on @1:mode:#:{
n503=  if ($nick == $me) halt
n504=  if (+kl isin $1-) {
n505=    if ($calc($nick($chan,0) + 1) >= $3) mode $chan +l $calc($nick($chan,0) + 3)
n506=  }
n507=  else if (+l isin $1-) {
n508=    if ($calc($nick($chan,0) + 1) >= $2) mode $chan +l $calc($nick($chan,0) + 3)
n509=  }
n510=  var %i 1
n511=  while (%i <= $ini(prot.dat,autoprotect,0)) {
n512=    if ($testaddr($nick,$readini(prot.dat,autoprotect,$ini(prot.dat,autoprotect,%i)))) halt
n513=    inc %i
n514=  }
n515=  var %modeplus $right($1-,- $+ $pos($1-,$chr(43)))
n516=  if ($chr(45) isin %modeplus) %modeplus = $left(%modeplus,$calc($pos(%modeplus,$pos(45)) - 2))
n517=  if (($readini prot.dat $chan invite == 1) && (i isin %modeplus)) {
n518=    mode $chan -i
n519=    mode $chan -o $nick 
n520=    .notice $nick Aceast mod (+i) nu este permis ... protectia pentru $chan este activa
n521=  }
n522=  if (($readini prot.dat $chan moderat == 1) && (m isin %modeplus)) {
n523=    mode $chan -m
n524=    mode $chan -o $nick
n525=    .notice $nick Aceast mod (+m) nu este permis ... protectia pentru $chan este activa 
n526=  }
n527=  if (($readini prot.dat $chan key == 1) && (k isin %modeplus)) {
n528=    if (mk isin $1-) mode $chan -k $3
n529=    else if (lk isin $1-) mode $chan -k $3
n530=    else mode $chan -k $2
n531=    mode $chan -o $nick
n532=    .notice $nick Aceast mod (+k) nu este permis ... protectia pentru $chan este activa 
n533=  }
n534=  if (($readini prot.dat $chan secret == 1) && (s isin %modeplus)) {
n535=    mode $chan -s
n536=    mode $chan -o $nick
n537=    .notice $nick Aceast mod (+s) nu este permis ... protectia pentru $chan este activa 
n538=  }
n539=}
n540=on 1:text:*:?:close -m $nick
